=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.11 15:37:24 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Wed Jun 11 11:22:06 2014 from 172.16.10.105
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>te
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>/FUENTEScob64 lstpath"/d/iccol/desarrollo/temporales" >/d/iccol/desarrollo/temporales>                                               /d/iccol/desarrollo/temporales>cob64 lstpath"/d/iccol/desarrollo/temporales" >/d/iccol/desarrollo/temporales>                                               /d/iccol/desarrollo/temporales>cob64 lstpath"/d/iccol/desarrollo/temporales" >/d/iccol/desarrollo/temporales>                                               /d/iccol/desarrollo/temporales>vi $FUENTES/CARGAJUR.CBL                        cob64 lstpath"/d/iccol/desarrollo/temporales" >/d/iccol/desarrollo/temporales>des-c-v CARGAJUR                               /d/iccol/desarrollo/temporales>                vi $FUENTES/CARGAJUR.CBL
"/d/iccol/desarrollo/fuentes/CARGAJUR.CBL" 1737 lines, 74096 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************"/d/iccol/desarrollo/fuentes/CARGAJUR.CBL" 1737 lines, 74096 characters[1] + Stopped (SIGTSTP)        vi $FUENTES/CARGAJUR.CBL
/d/iccol/desarrollo/temporales>^[k  /d/iccol/desarrollo/temporales>vi $FUENTES/CARGAJUR.CBLte                      . visetfg     fgfanim ./CARGAJUR














































32383239 0000-PROGRAMA-PRINCIPAL.3240Ddisplay "0000-PROGRAMA-PRINCIPAL"3241******************************************************************3242*inicializa el ambiente y abre los archivos3243perform 1000-RUTINA-INICIAL3244*procesa cada uno de los registros del archivo JURAD hasta3245*encontrar el registro "T" de totales3246perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"3247*cierra archivos y produce el reporte final3248perform 7000-RUTINA-FINAL3249goback.32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidosAnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll       InsCapsNumScroll       F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape       Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More       
              
              
              display "0000-PROGRAMA-PRINCIPAL"perform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL918919 1RUTINA-INICIAL.92display "1000-RUTINA-INICIAL"92922* Todas las operaciones que se realizan una sola vez, al comienzo923* del programa:92- obtencion de los parametros92- apertura del archivo de entrada926*   - apertura de todos los demas archivos92- eliminacion de datos existentes si es refresque completo928*   - carga en memoria de los IDs de inconsistentes929******************************************************************930* Registra hora de inicio931     accept W-hora-inicio from time932933* Obtiene informacion sobre la corrida de la linea de comando: el934* nombre del archivo de entrada (que contiene el tipo de proceso),935* el indicador de proceso real o en falso (default)936     accept P-command-line from COMMAND-LINE937Dmove "9999991000905140104.txt 2 " to P-command-line93display "Parametros: " P-command-line93unstring P-command-line delimited by all " " into94P-file-name P-proceso-real941942* El programa se anuncia en la consola943* TODO: se usa un anuncio mas vistoso?944 if PROCESO-REAL94display pgm " Carga de archivo JURAD - proceso REAL"94else94display pgm " Carga de archivo JURAD - proceso en falso"94end-if949950* El indicador de proceso real debe ser 1 o 2951 if P-proceso-real not = "1" and "2"95El indicadorproceso real es invalido"95debe ser 1 o 2"95perform 9000-CANCELAR-PROGRAMA95end-if956957* TODO: controlar los componentes del filename95evaluate P-tipo-proceso959 when "01"9601 Envio Original - Carga TOTAL 1a vez"96when "02"9602 Archivo Semanal - Carga PARCIAL"96when "03"  39183919 1000-RUTINA-INICIAL.3920Ddisplay "1000-RUTINA-INICIAL"3921******************************************************************3922* Todas las operaciones que se realizan una sola vez, al comienzo3923* del programa:3924*   - obtencion de los parametros3925*   - apertura del archivo de entrada3926*   - apertura de todos los demas archivos3927*   - eliminacion de datos existentes si es refresque completo3928*   - carga en memoria de los IDs de inconsistentes3929******************************************************************3930* Registra hora de inicio3931accept W-hora-inicio from time39323933* Obtiene informacion sobre la corrida de la linea de comando: el3934* nombre del archivo de entrada (que contiene el tipo de proceso),3935* el indicador de proceso real o en falso (default)3936accept P-command-line from COMMAND-LINE3937Dmove "9999991000905140104.txt 2 " to P-command-line3938display "Parametros: " P-command-line3939unstring P-command-line delimited by all " " into3940P-file-name P-proceso-real39413942* El programa se anuncia en la consola3943* TODO: se usa un anuncio mas vistoso?3944if PROCESO-REAL3945display pgm " Carga de archivo JURAD - proceso REAL"3946else3947display pgm " Carga de archivo JURAD - proceso en falso"3948end-if39493950* El indicador de proceso real debe ser 1 o 23951if P-proceso-real not = "1" and "2"3952display "El indicador de proceso real es invalido"3953display "debe ser 1 o 2"3954perform 9000-CANCELAR-PROGRAMA3955end-if39563957* TODO: controlar los componentes del filename3958evaluate P-tipo-proceso3959when "01"3960display "01 Envio Original - Carga TOTAL 1a vez"3961when "02"3962display "02 Archivo Semanal - Carga PARCIAL"3963when "03"AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll       F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape       Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moredisplay "1000-RUTINA-INICIAL"63when "03"64         display "03 Archivo Mensual - Carga PARCIAL"65 when "04"66         display "04 Refresque Total - Carga TOTAL"67     when other68*        valor invalido69         display "El tipo de proceso " P-tipo-proceso70         " es invalido (debe ser 01 02 03 o 04)"71         perform 9000-CANCELAR-PROGRAMA72     end-evaluate.7374* Edita la fecha de proceso DDMMAA del parametro en formato75* YYYYMMDD76string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)77P-fecha-proceso(1:2) delimited size78     into P-fecha-proceso-YYYYMMDD79     display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD8081* Calcula una fecha 50 anios posterior a la de proceso82 P-fecha-proceso-YYYYMMDD to P-fecha-proceso-5083add 50 to P-fecha-proceso-50YYYY8485* Apertura del archivo de entrada86string "$TEMPORALES/" P-file-name into P-file-path87     open input JURAD88     evaluate JURAD-fs89    when "00"90     continue91    when other92    display "Error en open del archivo JURAD "93        display "Path del archivo: " P-file-path94display "File status: " JURAD-fs95             perform 9000-CANCELAR-PROGRAMA *> no retorna96        goback97end-evaluate.9899* Apertura del archivo de errores4000string "$TEMPORALES/" P-file-name(1:19) ".errs"4001into ERRS-file-name4002     open output ERRS4003ERRS-fs4004    when "00"4005     continue4006    when other4007    display "Error en open del archivo de errores "4008        display "Nombre del archivo: " ERRS-file-name1819 1000-RUTINA-INICIAL.20Ddisplay "1000-RUTINA-INICIAL"21******************************************************************22* Todas las operaciones que se realizan una sola vez, al comienzo23* del programa:24*   - obtencion de los parametros25*   - apertura del archivo de entrada26*   - apertura de todos los demas archivos27*   - eliminacion de datos existentes si es refresque completo28*   - carga en memoria de los IDs de inconsistentes29******************************************************************30* Registra hora de inicio31accept W-hora-inicio from time3233* Obtiene informacion sobre la corrida de la linea de comando: el34* nombre del archivo de entrada (que contiene el tipo de proceso),35* el indicador de proceso real o en falso (default)36     accept P-command-line from COMMAND-LINE37D"9999991000905140104.txt 2 " to P-command-line38display "Parametros: " P-command-line39unstring P-command-line delimited by all " " into40     P-file-name P-proceso-real4142* El programa se anuncia en la consola43* TODO: se usa un anuncio mas vistoso?44if PROCESO-REAL45display pgm " Carga de archivo JURAD - proceso REAL"46else47display pgm " Carga de archivo JURAD - proceso en falso"48end-if4950* El indicador de proceso real debe ser 1 o 251if P-proceso-real not = "1" and "2"52    display "El indicador de proceso real es invalido"53display "debe ser 1 o 2"54         perform 9000-CANCELAR-PROGRAMA3955end-if39563957* TODO: controlar los componentes del filename3958P-tipo-proceso3959when "01"3960display "01 Envio Original - Carga TOTAL 1a vez"3961when "02"3962display "02 Archivo Semanal - Carga PARCIAL"3963when "03"       Exit from animator ?  Yes/No/Detach       Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More       
              
              
              display "1000-RUTINA-INICIAL"accept W-hora-inicio from timeaccept W-hora-inicio from timeaccept P-command-line from COMMAND-LINE       Exit from animator ?  Yes/No/Detach       Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More       0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL



  39183919 1000-RUTINA-INICIAL.3920Ddisplay "1000-RUTINA-INICIAL"3921******************************************************************3922* Todas las operaciones que se realizan una sola vez, al comienzo3923* del programa:3924*   - obtencion de los parametros3925*   - apertura del archivo de entrada3926*   - apertura de todos los demas archivos3927*   - eliminacion de datos existentes si es refresque completo3928*   - carga en memoria de los IDs de inconsistentes3929******************************************************************3930* Registra hora de inicio3931accept W-hora-inicio from time39323933* Obtiene informacion sobre la corrida de la linea de comando: el3934* nombre del archivo de entrada (que contiene el tipo de proceso),3935* el indicador de proceso real o en falso (default)3936accept P-command-line from COMMAND-LINE3937Dmove "9999991000905140104.txt 2 " to P-command-line3938display "Parametros: " P-command-line3939unstring P-command-line delimited by all " " into3940P-file-name P-proceso-real39413942* El programa se anuncia en la consola3943* TODO: se usa un anuncio mas vistoso?3944if PROCESO-REAL3945display pgm " Carga de archivo JURAD - proceso REAL"3946else3947display pgm " Carga de archivo JURAD - proceso en falso"3948end-if39493950* El indicador de proceso real debe ser 1 o 23951if P-proceso-real not = "1" and "2"3952display "El indicador de proceso real es invalido"3953display "debe ser 1 o 2"3954perform 9000-CANCELAR-PROGRAMA3955end-if39563957* TODO: controlar los componentes del filename3958evaluate P-tipo-proceso3959when "01"3960display "01 Envio Original - Carga TOTAL 1a vez"3961when "02"3962display "02 Archivo Semanal - Carga PARCIAL"3963when "03"AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll       F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape       Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  39183919 1000-RUTINA-INICIAL.3920Ddisplay "1000-RUTINA-INICIAL"3921******************************************************************3922* Todas las operaciones que se realizan una sola vez, al comienzo3923* del programa:3924*   - obtencion de los parametros3925*   - apertura del archivo de entrada3926*   - apertura de todos los demas archivos3927*   - eliminacion de datos existentes si es refresque completo3928*   - carga en memoria de los IDs de inconsistentes3929******************************************************************3930* Registra hora de inicio3931accept W-hora-inicio from time39323933* Obtiene informacion sobre la corrida de la linea de comando: el3934* nombre del archivo de entrada (que contiene el tipo de proceso),3935* el indicador de proceso real o en falso (default)3936accept P-command-line from COMMAND-LINE3937Dmove "9999991000905140104.txt 2 " to P-command-line3938display "Parametros: " P-command-line3939unstring P-command-line delimited by all " " into3940P-file-name P-proceso-real39413942* El programa se anuncia en la consola3943* TODO: se usa un anuncio mas vistoso?3944if PROCESO-REAL3945display pgm " Carga de archivo JURAD - proceso REAL"3946else3947display pgm " Carga de archivo JURAD - proceso en falso"3948end-if39493950* El indicador de proceso real debe ser 1 o 23951if P-proceso-real not = "1" and "2"3952display "El indicador de proceso real es invalido"3953display "debe ser 1 o 2"3954perform 9000-CANCELAR-PROGRAMA3955end-if39563957* TODO: controlar los componentes del filename3958evaluate P-tipo-proceso3959when "01"3960display "01 Envio Original - Carga TOTAL 1a vez"3961when "02"3962display "02 Archivo Semanal - Carga PARCIAL"3963when "03"AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll                                                                                                                               F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape                                                                                                                               Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moreaccept P-command-line from COMMAND-LINEmove "9999991000905140104.txt 2 " to P-command-linemove "9999991000905140104.txt 2 " to P-command-linedisplay "Parametros: " P-command-line
              
              
              display "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoif PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso en falso"
              
              
              display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-ifif P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"evaluate P-tipo-procesoevaluate P-tipo-proceso64display "03 Archivo Mensual - Carga PARCIAL"65     when "04"66     display "04 Refresque Total - Carga TOTAL"67     when other68*        valor invalido69         display "El tipo de proceso " P-tipo-proceso70         " es invalido (debe ser 01 02 03 o 04)"71         perform 9000-CANCELAR-PROGRAMA72     end-evaluate.7374* Edita la fecha de proceso DDMMAA del parametro en formato75* YYYYMMDD76     string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)77P-fecha-proceso(1:2) delimited size78into P-fecha-proceso-YYYYMMDD79     display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD8081* Calcula una fecha 50 anios posterior a la de proceso82move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-5083 add 50 to P-fecha-proceso-50YYYY8485* Apertura del archivo de entrada86string "$TEMPORALES/" P-file-name into P-file-path87open input JURAD88     evaluate JURAD-fs89         when "00"90         continue91when other92    display "Error en open del archivo JURAD "93    display "Path del archivo: " P-file-path94        display "File status: " JURAD-fs95perform 9000-CANCELAR-PROGRAMA *> no retorna96             goback97end-evaluate.9899* Apertura del archivo de errores4000string "$TEMPORALES/" P-file-name(1:19) ".errs"4001into ERRS-file-name4002open output ERRS4003     evaluate ERRS-fs4004    when "00"4005         continue4006when other4007        display "Error en open del archivo de errores "4008    display "Nombre del archivo: " ERRS-file-name4009        display "File status: " ERRS-fs
              
              
              display "04 Refresque Total - Carga TOTAL"string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
              
              
              display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDmove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYYstring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fscontinuecontinuestring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"open output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fscontinuecontinue4014* Apertura de los archivos maestros4015* TODO: falta capturar el status de estas operaciones?401open input BDIIREGI401open input BDIIDIAN4018 open input BDIIDAS.40194020* Apertura del archivo de alertas en linea402if PROCESO-REAL402    open i-o BDIIALE402else4024         open input BDIIALE4025     end-if.40264027* Si es un refresque total (codigo 04) se eliminan los registros4028* de Jurad existentes402if P-tipo-proceso = "04" and PROCESO-REAL403perform 1001-ELIMINAR-TODO4031     end-if.403240334034 1000-NOT-USED.4035D    display "1000-NOT-USED"4036******************************************************************4037* Aunque tengo instrucciones de dejar los textos de alertas en4038* blanco, me parece que se deberían cargar, aunque sea de manera4039* precaria, por si justo cae una consulta para uno de los IDs4040* involucrados. La persona que consulta va a ver <spaces>, hasta4041* que se ejecute el programa que genera los textos.4042******************************************************************4043* >>>> esto da un error de compilacion que no puedo resolver4044* >>>> por ahora esta anulado4045******************************************************************4046* Carga de los templates para armar el texto de alertas4047* TODO: por ahora los templates son literales404set LAx to 04049     move high-values to LA-templates5perform varying LAm from 1 by 15until LA-modelo(LAm) = high-values5    set LAx up by 153*    separa las partes de la linea54*unstring LA-modelo(LAm) into LA-parte(LAx, 1)55*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)56*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)57*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)58*delimited by all "&"59*prepara para omitir los espacios al final de c/parteopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.if PROCESO-REALif PROCESO-REALopen input BDIIALEopen input BDIIALEend-if.end-if.if P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REAL3244*    procesa cada uno de los registros del archivo JURAD hasta3245*    encontrar el registro "T" de totales324perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"3247*cierra archivos y produce el reporte final324perform 7000-RUTINA-FINAL324goback.32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*    lectura del proximo registro3258     read JURAD325evaluate JURAD-fs326when "00"3261D    display " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*        controla el reg y lo aplica si es OK3265     perform 4000-PROCESAR-REGISTRO-23266         move JURAD-reg to JURAD-reg-anterior3267         add 1 to REG-LEIDOS3268     when "10"3269*        fin del archivo de input:3270*        esto es un error, no se encontro el registro "T" antes3271*        de que se terminara el archivo3272         display "Falta el reg de totales del archivo JURAD "3273         display "Nombre del archivo: " P-file-name3274         display "File status: " JURAD-fs3275         display "Ultimo registro leido: " N-reg-leidos3276         display JURAD-reg-anterior3277         perform 9000-CANCELAR-PROGRAMA327when other3279*    error de lectura: cancelacion del proceso328    display "Error en lectura del archivo JURAD "328    display "Nombre del archivo: " P-file-name328display "File status: " JURAD-fs3283 display "Ultimo registro leido: " N-reg-leidos3284 display JURAD-reg-anterior3285 perform 9000-CANCELAR-PROGRAMA3286 end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.Break-pointsOn-count=unset              Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setNo such command AnimateCARGAJUR.gnt/.o/.exe              Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More       Break-pointsOn-count=unset              Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-set

perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"                 AnimateCARGAJUR.gnt/.o/.exe              Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More       perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"        display "4000-PROCESAR-REGISTRO"       

                     

                     

              display "4000-PROCESAR-REGISTRO"read JURADread JURADevaluate JURAD-fsevaluate JURAD-fsdisplay " "       

                     

                     

              display " "display " "       

                     

                     

              display " "display JURAD-reg       

                     

                     

              display JURAD-regperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-28889 4000-PROCESAR-REGISTRO-2.90Ddisplay "4000-PROCESAR-REGISTRO-2"                                91****************************************************************92* Controla los datos de un registro de JURAD y si es OK lo usa93* para actualizar el archivo de alertas en linea94* La informacion esta leida en JURAD-reg95****************************************************************96 move "NO" to E-hay-error9798*    validacion del tip movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305 move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313 move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323 if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.       43perform 1000-RUTINA-INICIAL44*    procesa cada uno de los registros del archivo JURAD hasta45*encontrar el registro "T" de totales46     perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"                 47*    cierra archivos y produce el reporte final48     perform 7000-RUTINA-FINAL49     goback.5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD255* Lectura y control del file status del archivo256****************************************************************257*lectura del proximo registro258 read JURAD259evaluate JURAD-fs260when "00"261Ddisplay " "262Ddisplay " "263D    display JURAD-reg264*controla el reg y lo aplica si es OK265    perform 4000-PROCESAR-REGISTRO-2266move JURAD-reg to JURAD-reg-anterior267     add 1 to REG-LEIDOS268when "10"269*    fin del archivo de input:270*    esto es un error, no se encontro el registro "T" antes271*de que se terminara el archivo272 display "Falta el reg de totales del archivo JURAD "273display "Nombre del archivo: " P-file-name274    display "File status: " JURAD-fs275display "Ultimo registro leido: " N-reg-leidos276     display JURAD-reg-anterior277    perform 9000-CANCELAR-PROGRAMA278when other279*error de lectura: cancelacion del proceso280display "Error en lectura del archivo JURAD "281display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285perform 9000-CANCELAR-PROGRAMA286 end-evaluate.2872888889 4000-PROCESAR-REGISTRO-2.90Ddisplay "4000-PROCESAR-REGISTRO-2"                                          91****************************************************************92* Controla los datos de un registro de JURAD y si es OK lo usa93* para actualizar el archivo de alertas en linea94* La informacion esta leida en JURAD-reg95****************************************************************96     move "NO" to E-hay-error9798*    validacion del tipo de movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301     end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305    move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316 perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323if E-hay-error = "SI"324 perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.                                                                      move "NO" to E-hay-errorReset-execution              Cursor-position Next Start Quit-performmove "NO" to E-hay-errordisplay "4000-PROCESAR-REGISTRO-2"       AnimateCARGAJUR.gnt/.o/.exe              Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More                                                                      display "4000-PROCESAR-REGISTRO-2"       move "NO" to E-hay-error0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL

Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso04 Refresque Total - Carga TOTALFecha de proceso: 201401044000-PROCESAR-REGISTRO

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720       1304114000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-2
       
  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                            3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll       F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape       Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moremove "NO" to E-hay-errorif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"add 1 to N-reg-leidosadd 1 to N-reg-leidosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALPerform-level              Exit View                                                               perform 4100-VALIDACION-FORMALif E-hay-error = "SI"AnimateCARGAJUR.gnt/.o/.exe              Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More       if EQuery-data              Cursor-name Enter-name Monitor-off Hide/Org-monitorsE-HAY-ERROR<W-S>NO                :   E-HAY-ERROR<W-S>       clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape       E-hay-error = "SI" perform 4900-GRABAR perform 4240-CONTARAnimateCARGAJUR.gnt/.o/.exe       view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape       Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More       if E-hay-error = "SI"perform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICA396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"         3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441       

                     

                     

                     move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDEperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002          4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002          4382END-IF                                 FAC0002          4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002          4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002          4385END-IFFAC0002          4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002          4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002          4388END-IF                        FAC0002          4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003          4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003          4391END-IF                                                FAC0003          4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002          4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002          4395 END-IF                       FAC0002          4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002          4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002          4398  END-IF             FAC0002          4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004          4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004          4401  END-IF                                          FAC0004          4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004          4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002          4404PERFORM 80200-VALIDAR-ID4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002        IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002        IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002        IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002        IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002        IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002        MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002        MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002        END-IFFAC0002        END-IFFAC0002   31        END-IF32     END-PERFORM.33******************************************************************34353637copy BDIIVIDE.PROC.38*BDIIVIDE.PROC.v.03.000839******************************************************************40*RUTINA DE VALIDACION DE IDENTIFICACIONES41******************************************************************42* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE43* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS44*         * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID45*             * INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID46* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.47******************************************************************48* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON49* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO50* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 251******************************************************************52* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL53* AGO.11/2004 * DIGITO DE CHEQUEO.54* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO55*        * CORRESPONDE AL RANGO.356******************************************************************357* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:358* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)359* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:360*       * ENTRE 900.000.000 Y 999.999.999 (MUISCA)361******************************************************************362* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN363* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS364* FAC006C     *365******************************************************************366* C.VELASCO   * SE VUELVE A LA VERSION ANTES DE MODIFICAR LOS367* JUL.12/2012 * RANGOS DE IDENTIFICACIONES,  LOS AJUSTES DE LA368* CAV0008 * VERSION 07, IMPACTA APERTURAS Y PROCESOS ESPEC.369******************************************************************370 80100-VALIDAR-IDENTIFICACION.371*===================================*372*80100-VALIDAR-IDENTIFICACION.373* Valida el numero de identificacion contra las bases de datos374* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI375* y verifica la coincidencia del nombre reportado376*===================================*76*===================================*77INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM78               NOMBRES-AUX-W-BDIIVIDE79INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"80IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002   81MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002   82END-IF              FAC0002   83    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002   84       MOVE ZEROS TO SW-ASGTIPID-BDIIVIDE                         FAC0002   85    END-IF                               FAC0002   86    IF SW-VALTIPID-BDIIVIDE NOT NUMERIC                           FAC0002   87       MOVE ZEROS TO SW-VALTIPID-BDIIVIDE                     FAC0002   88    END-IF                                                   FAC0002   89    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERIC            FAC0003   90 MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDE                   FAC0003   91    END-IF                                        FAC0003   92    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS93      IF SW-ASGTIPID-BDIIVIDE = 1                            FAC0002   94         PERFORM 80300-ASIGNAR-TIPO-ID                 FAC0002   95      END-IF                                                      FAC0002   96      IF SW-VALTIPID-BDIIVIDE = 1                                 FAC0002   97         PERFORM 80400-VALIDAR-TIPO-ID                      FAC0002   98      END-IF                      FAC0002   99      IF SW-DIGCHEQUEO-BDIIVIDE = 1                     FAC0004     4400 PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004     4401      END-IF                                                      FAC0004     4402      IF SW-VALTIPID-BDIIVIDE = 0 OR                              FAC0004     4403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)       FAC0002     4404       PERFORM 80200-VALIDAR-ID405 INITIALIZE NOM-VAL-BDIIVIDE406       MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407       IF SW-VERIFNOM-BDIIVIDE = 1408          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411          IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413           NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416                     MOVE 2 TO BLOQUES-INPUT-VALNOM417                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418                  END-IF419             END-IF420             PERFORM 10000-MATCH-NOMBRES-VALNOM421             IF MATCH-OK-OUT-VALNOM = 0
 NITIALIZE PARAQuery-data    Cursor-name Enter-name Monitor-off Hide/Org-monitorsPARAMETROS-SALIDA-BDIIVIDE<W-S>                                                                 000                      :   PARAMETROS-SALIDA-BDIIVIDE<W-S>  clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape  PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDE-IDE-BDIIVIDE REPLACING ALL " " BY "0"NOM-BDIIVIDE NOT NUMERIC                           F   AnimateCARGAJUR.gnt/.o/.exe  view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  END-IFFAC0002   IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003   IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003   IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF SW-ASGTIPID-BDIIVIDE = 1FAC0002   IF SW-ASGTIPID-BDIIVIDE = 1FAC0002   IF SW-VALTIPID-BDIIVIDE = 1FAC0002   IF SW-VALTIPID-BDIIVIDE = 1FAC0002   IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004   IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004   IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004   IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004   PERFORM 80200-VALIDAR-IDPERFORM 80200-VALIDAR-ID439*Dependiendo del tipo de identificacion440*===================================*441EVALUATE TIP-IDE-BDIIVIDE442   WHEN 1443     PERFORM 85010-UBICA-CEDULA444WHEN 2445     PERFORM 85020-UBICA-NIT446   WHEN 3447  PERFORM 85020-UBICA-NIT448   WHEN 4449     PERFORM 85030-UBICA-EXT450WHEN OTHER451     MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.2     4455*================================================================456*80300-ASIGNAR-TIPO-ID.               4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA     4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE     4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"     4462(NUM-IDE-BDIIVIDE-R >= 1 AND2   63NUM-IDE-BDIIVIDE-R  <= 99999999) OR  2   64   (NUM-IDE-BDIIVIDE-R >= 1000000000 AND2   65   NUM-IDE-BDIIVIDE-R  <  8000000000)3   66MOVE 1 TO TIP-IDE-BDIIVIDE                           67ELSE                     FAC0002   68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002   69    NUM-IDE-BDIIVIDE-R  <= 999999999) OR   FAC0005   70    (NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003   71 NUM-IDE-BDIIVIDE-R  <= 9999999999)         FAC0005   72 MOVE 2 TO TIP-IDE-BDIIVIDE                FAC0002   73* IF NUM-IDE-BDIIVIDE-R >= 8000000000        FAC0004   74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004   75* MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004   76*END-IF                            FAC0004   77ELSE                                                  FAC0002   78IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002   79NUM-IDE-BDIIVIDE-R  <  800000000) OR  FAC0005   80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND   FAC0002   81NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005   82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002   83ELSE MOVE 4 TO TIP-IDE-BDIIVIDE      FAC0002   84END-IF.                      FAC0002   EVALUATE TIP-IDE-BDIIVIDEPERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULA546*Arma el nombre completo en una sola variable547=============================548MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI549MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI550READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE551END-READ552IF SW-ID-BDIIVIDE = 0553 MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE554MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE555 MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE556MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE557 IF ESTADO-CIVIL-BDIIREGI = 0558   STRING559        SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",560"*" DELIMITED BY SIZE ,561             PRIMER-NOMBRE-BDIIVIDEDELIMITED BY "  ",562             "*" DELIMITED BY SIZE ,563             SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,564             ";" DELIMITED BY SIZE ,565             INTO NOM-LEIDO-BDIIVIDE566         END-IF567     IF ESTADO-CIVIL-BDIIREGI = 1568         STRING569       "DE" DELIMITED BY SIZE,570    "*"  DELIMITED BY SIZE,571    SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",572    "*"  DELIMITED BY SIZE,573    PRIMER-NOMBRDELIMITED BY "  ",574       "*"  DELIMITED BY SIZE,575     SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,576  ";"  DELIMITED BY SIZE,577  INTO NOM-LEIDO-BDIIVIDE578END-IF579IF ESTADO-CIVIL-BDIIREGI = 2580  STRING581 "VDA DE" DELIMITED BY SIZE,582 "*"      DELIMITED BY SIZE,583   SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",584     "*"DELIMITED BY SIZE,585   PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",586"*"      DELIMITED BY SIZE,587SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,588";"      DELIMITED BY SIZE,589INTO NOM-LEIDO-BDIIVIDE590END-IF591STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEYREAD BDIIREGI INVALID KEYMOVE 1 TO SW-ID-BDIIVIDEMOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002     4404       PERFORM 80200-VALIDAR-ID405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409     MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410  MOVE NOM-VALVIDENOMBOK-INPUT-VALNOM411  IF SW-ID-BDIIVIDE = 0412     IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413        NUM-BLOQUES-BDIIVIDE <> ZEROS414        MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415 ELSE IF TIP-ID-INPUT-VALNOM = 1416        MOVE 2 TO BLOQUES-INPUT-VALNOM417     ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418     END-IF419END-IF420PERFORM 10000-MATCH-NOMBRES-VALNOM421IF MATCH-OK-OUT-VALNOM = 0422   MOVE 1 TO SW-NOMBRES-BDIIVIDE423    END-IF424 END-IF425END-IF426ELSE IF SW-TID-BDIIVIDE = 1   FAC0002     4427 MOVE 1 TO SW-ID-BDIIVIDEFAC0002     4428END-IF                                        FAC0002     4429END-IF                        FAC0002     4430ELSE MOVE 1 TO SW-ID-BDIIVIDE431END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443PERFORM 85010-UBICA-CEDULA444WHEN 2445PERFORM 85020-UBICA-NIT446WHEN 3447PERFORM 85020-UBICA-NIT448WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0END-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*  es un id inválido3425  call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448 IF TIP-IDE-BDIIVIDE = 13449*        es una cédula3450MOVE 02 TO CODIGO-ERROR3451     ELSE3452*        no es una cédula3453         MOVE 01 TO CODIGO-ERROR3454     END-IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*nombre coincide: busca ID en BDIIALE3463initialize LLAVE-BDIIALE3464move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1call "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores10053 00.
10054marca al reg actual como erroneo10055move "SI" to E-hay-error1005610057*cuenta y muestra el registro de input10058 if reg-input not = reg-input-anterior10059add 1 to E-cont-regs-con-error10060    display " "10061 display reg-input10062move reg-input to reg-input-anterior10063move spaces to E-errores-reg10064move 2 to errIndex10065end-if1006610067*contabiliza el error en la tabla de errores10068set Ex to 110069search E-error varying Ex10070at end10071    display "--- falla en la tabla de errores ---" cod-error10072when E-codigo(Ex) = "00"10073add 1 to E-contador(Ex)10074         display "--- error tipo exotico: " cod-error10075     add 1 to E-contador(Ex)10076     when E-codigo(Ex) = cod-error10077         add 1 to E-contador(Ex)10078         display "Error " cod-error " " E-descripcion(Ex)10079 end-search1008010081agrega a la lista de errores del registro10082if errIndex < (300 - 59 - 3)10083    move cod-error to E-errores-reg(errIndex:2)10084 add 3 to errIndex10085move E-descripcion(Ex) to E-errores-reg(errIndex:59)10086    add 59 to errIndex10087end-if1008810089     exit program.100901009110092 end program PONERR.1009310094 end program CARGAJUR.1009510096******************************************************************10097******************************************************************10098move "SI" to E-hay-errorif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "


    


    


    display " "display reg-input


    


    


    display reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-ifset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exadd 1 to E-contador(Ex) E-codigo(Ex) = codQuery-data    Cursor-name Enter-name Monitor-off Hide/Org-monitorsCOD-ERROR<L-S>14    :   COD-ERROR<L-S>  clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape  cod-errordor(Ex) cod-error " " E-dAnimateCARGAJUR.gnt/.o/.exe  view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)


    


    


    display "Error " cod-error " " E-descripcion(Ex)if errIndex < (300 - 59 - 3)0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL

Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso04 Refresque Total - Carga TOTALFecha de proceso: 201401044000-PROCESAR-REGISTRO

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  1304114000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  130411Error 14 El numero de id no se encuentra en el archivo maestro
  
   10053 00.
10054*marca al reg actual como erroneo10055move "SI" to E-hay-error1005610057*cuenta y muestra el registro de input10058if reg-input not = reg-input-anterior10059add 1 to E-cont-regs-con-error10060display " "10061display reg-input10062move reg-input to reg-input-anterior10063move spaces to E-errores-reg10064move 2 to errIndex10065end-if1006610067*contabiliza el error en la tabla de errores10068set Ex to 110069search E-error varying Ex10070at end10071display "--- falla en la tabla de errores ---" cod-error10072when E-codigo(Ex) = "00"10073add 1 to E-contador(Ex)10074display "--- error tipo exotico: " cod-error10075add 1 to E-contador(Ex)10076when E-codigo(Ex) = cod-error10077add 1 to E-contador(Ex)10078display "Error " cod-error " " E-descripcion(Ex)10079end-search1008010081*agrega a la lista de errores del registro10082if errIndex < (300 - 59 - 3)10083move cod-error to E-errores-reg(errIndex:2)10084add 3 to errIndex10085move E-descripcion(Ex) to E-errores-reg(errIndex:59)10086add 59 to errIndex10087end-if1008810089exit program.100901009110092 end program PONERR.1009310094 end program CARGAJUR.1009510096******************************************************************10097******************************************************************10098AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll  F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moreif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program. 3425    call "PONERR" using "14" JURAD-reg E-errores
 3426    valida contra la base alterna 3427    perform 4210-VALIDACION-ID-NO-FIGURA 3428else 3429    existe id, a ver si el nombre coincide 3430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide 3431    call "PONERR" using "15" JURAD-reg E-errores 3432    display "novedad:  " JURAD-nombre 3433    display "registro: " NOM-LEIDO-BDIIVIDE 3434*    validación en base alterna 3435    perform 4220-VALIDA-NOMBRE-NO-COINCIDE 3436else 3437        perform 4222-VALIDA-NOMBRE-COINCIDE 3438end-if 3439 end-if. 3440 3441 3442 4220-VALIDA-NOMBRE-NO-COINCIDE. 3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE" 3444****************************************************************** 3445* Validación de IDs que figuran OK pero el nombre no coincide 3446****************************************************************** 3447*nombre no coincide 3448IF TIP-IDE-BDIIVIDE = 1 3449*es una cédula 3450MOVE 02 TO CODIGO-ERROR 3451ELSE 3452*no es una cédula 3453     MOVE 01 TO CODIGO-ERROR 3454END-IF. 3455 3456 3457 4222-VALIDA-NOMBRE-COINCIDE. 3458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE" 3459****************************************************************** 3460* Validación de IDs que figuran OK pero el nombre coincide 3461****************************************************************** 3462*nombre coincide: busca ID en BDIIALE 3463initialize LLAVE-BDIIALE 3464     move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE 3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE 3466     move 990003 to FUENTE-BDIIALE 3467start BDIIALE key not < LLAVE-BDIIALE INVALID KEY 3468         move 1 TO SW-BDIIALE 3469     not invalid key 3470move 0 to SW-BDIIALEperform 4210-VALIDACION-ID-NO-FIGURA540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548*valida si la identificación está en la base de datos alterna549 PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551IF TIP-IDE-BDIIVIDE = 1552*es una cédula553    MOVE 04 TO CODIGO-ERROR554    else555*no es una cédula556MOVE 03 TO CODIGO-ERROR557         END-IF558 END-IF.559560561 4300-MODIFICAR-BDIIALE.562Ddisplay "4300-MODIFICAR-BDIIALE"563******************************************************************564* Se impacta el archivo BDIIALE con una o dos inserciones,565* modificaciones o eliminaciones segun haya o no demandas y566* embargos567******************************************************************568initialize REG-BDIIALE569570*si hay demandas571if JURAD-demandas-vigentes > zero572     or JURAD-demandas-terminadas > zero573     move "J001" to LLASEC-BDIIALE574*        arma datos de demandas575         move JURAD-demandas-vigentes to D-vigentes576         move JURAD-demandas-terminadas to D-terminados577     string "20" JURAD-demandas-fecha-ultima578    delimited size into D-fecha-ultima579    perform 4300-MODIFICAR-BDIIALE-DATOS580end-if.581582*i hay embargos583if JURAD-embargos-vigentes > zero584or JURAD-embargos-terminados > zero585"J002" to LLASEC-BDIIALE
    
    
    display "4210-VALIDACION-ID-NO-FIGURA"MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCHPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSV42274228 513-VALIDA-EN-CSV.4229display "513-VALIDA-EN-CSV"                                              4230D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E4231**************************************************************4232* Valida si la identificación está en la base de datos alterna4233**************************************************************4234*hace validacion de tipo de identificacion4235 MOVE TIPOID-E TO TIP-IDE-BDIIVIDE4236MOVE NUMID-E TO NUM-IDE-BDIIVIDE4237*retorna SW-TID-BDIIVIDE=0 si el num id no está dentro4238*del rango que corresponde al tipo de id4239 display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4240" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4242 PERFORM 80400-VALIDAR-TIPO-ID4243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4246IF SW-TID-BDIIVIDE = 04247*el tipo de id es OK4248D        display "el n° de ID está dentro de su rango"4249     IF HACER-MATCH = ZEROS4250*            abre archivos y carga la tabla de direcciones4251*            estandar, solo la primera vez4252             IF OPEN-DIR = ZEROS4253D         display "carga tabla DIRESTAN"4254                 OPEN INPUT MAESTRO-DIRECC4255            OPEN INPUT BDLCLI4256OPEN INPUT SUSCRIPTOR4257             OPEN INPUT MAESTRO-CREDIT4258            OPEN INPUT MAESTRO-CHECK4259            PERFORM 06000-U-CARGAR-TABLA-DIRESTAN4260        MOVE 1 TO OPEN-DIR4261     END-IF4262*    abre archivos y carga la tabla de direcciones4263    MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH4264    MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH4265*    Se recorre toda la estructura bdacsv para la identificacion      4266*    buscada. En caso de hallar registros se procede a realizar el    4267*        match4268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4269D        " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4270D        " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4271D        " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272    PERFORM 1000-U-RECORRER-CSV-BDAMATCH  


      
      


      
      


      
      display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E  


      
      


      
      


      
    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-EMOVE TIPOID-E TO TIP-IDE-BDIIVIDE0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL

Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso04 Refresque Total - Carga TOTALFecha de proceso: 201401044000-PROCESAR-REGISTRO

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  1304114000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  130411Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000149123
  
    42274228 513-VALIDA-EN-CSV.4229Ddisplay "513-VALIDA-EN-CSV"                                              4230Ddisplay "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E4231**************************************************************4232* Valida si la identificación está en la base de datos alterna4233**************************************************************4234*hace validacion de tipo de identificacion4235MOVE TIPOID-E TO TIP-IDE-BDIIVIDE4236MOVE NUMID-E TO NUM-IDE-BDIIVIDE4237*retorna SW-TID-BDIIVIDE=0 si el num id no está dentro4238*del rango que corresponde al tipo de id4239display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4240" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4242PERFORM 80400-VALIDAR-TIPO-ID4243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4246IF SW-TID-BDIIVIDE = 04247*el tipo de id es OK4248Ddisplay "el n° de ID está dentro de su rango"4249IF HACER-MATCH = ZEROS4250*abre archivos y carga la tabla de direcciones4251*estandar, solo la primera vez4252IF OPEN-DIR = ZEROS4253Ddisplay "carga tabla DIRESTAN"4254OPEN INPUT MAESTRO-DIRECC4255OPEN INPUT BDLCLI4256OPEN INPUT SUSCRIPTOR4257OPEN INPUT MAESTRO-CREDIT4258OPEN INPUT MAESTRO-CHECK4259PERFORM 06000-U-CARGAR-TABLA-DIRESTAN4260MOVE 1 TO OPEN-DIR4261END-IF4262*abre archivos y carga la tabla de direcciones4263MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH4264MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH4265*Se recorre toda la estructura bdacsv para la identificacion      4266*buscada. En caso de hallar registros se procede a realizar el    4267*match4268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4269D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4270D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4271D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272PERFORM 1000-U-RECORRER-CSV-BDAMATCHAnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll  F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE  


      
      


      
      


      
    display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-ID0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL

Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso04 Refresque Total - Carga TOTALFecha de proceso: 201401044000-PROCESAR-REGISTRO

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  1304114000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  130411Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000149123SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
  
    42274228 513-VALIDA-EN-CSV.4229Ddisplay "513-VALIDA-EN-CSV"                                              4230Ddisplay "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E4231**************************************************************4232* Valida si la identificación está en la base de datos alterna4233**************************************************************4234*hace validacion de tipo de identificacion4235MOVE TIPOID-E TO TIP-IDE-BDIIVIDE4236MOVE NUMID-E TO NUM-IDE-BDIIVIDE4237*retorna SW-TID-BDIIVIDE=0 si el num id no está dentro4238*del rango que corresponde al tipo de id4239display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4240" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4242PERFORM 80400-VALIDAR-TIPO-ID4243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4246IF SW-TID-BDIIVIDE = 04247*el tipo de id es OK4248Ddisplay "el n° de ID está dentro de su rango"4249IF HACER-MATCH = ZEROS4250*abre archivos y carga la tabla de direcciones4251*estandar, solo la primera vez4252IF OPEN-DIR = ZEROS4253Ddisplay "carga tabla DIRESTAN"4254OPEN INPUT MAESTRO-DIRECC4255OPEN INPUT BDLCLI4256OPEN INPUT SUSCRIPTOR4257OPEN INPUT MAESTRO-CREDIT4258OPEN INPUT MAESTRO-CHECK4259PERFORM 06000-U-CARGAR-TABLA-DIRESTAN4260MOVE 1 TO OPEN-DIR4261END-IF4262*abre archivos y carga la tabla de direcciones4263MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH4264MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH4265*Se recorre toda la estructura bdacsv para la identificacion      4266*buscada. En caso de hallar registros se procede a realizar el    4267*match4268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4269D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4270D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4271D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272PERFORM 1000-U-RECORRER-CSV-BDAMATCHAnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll  F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MorePERFORM 80400-VALIDAR-TIPO-ID492*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002     4493*================================================================494    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE                         FAC0002     4495    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002     4496    EVALUATE TIP-IDE-BDIIVIDE                                 FAC0002     4497      WHEN 1                                                  FAC0002     4498       IF NUM-IDE-BDIIVIDE-R > 9999999999                     FAC0002     4499      MOVE 1 TO SW-TID-BDIIVIDE           FAC0002     4500  END-IF                         FAC0002     4501 WHEN 2                         FAC0002     4502   IF NUM-IDE-BDIIVIDE-R >  9999999999 OR             FAC006C     4503      (NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005     4504     MOVE 1 TO SW-TID-BDIIVIDE                     FAC0002     4505  END-IF                          FAC0002     4506 WHEN 3                                                FAC0002     4507  IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005     4508     MOVE 1 TO SW-TID-BDIIVIDE                     FAC0002     4509  END-IF                          FAC0002     4510END-EVALUATE.                                           FAC0002     4511512 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004     4513*================================================================514*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004     4515*Elimina el digito de chequeo y cambia el tipo de identificacion516*de acuerdo a los rangos para tipo id = 2 y 3517*================================================================518 IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND  FAC0004     4519NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005     4520(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004     4521NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005     4522MOVE 3 TO TIP-IDE-BDIIVIDE      FAC0004     4523END-IF                        FAC0004     4524IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND         FAC0004     4525NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005     4526(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004     4527 NUM-IDE-BDIIVIDE-R  <= 9999999999)               FAC0005     4528MOVE 2 TO TIP-IDE-BDIIVIDE                FAC0004     4529END-IF                                        FAC0004     4530 IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004     4531 (NUM-IDE-BDIIVIDE-R >= 10000000000) OR                   FAC0004     4532 (NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004     4533 NUM-IDE-BDIIVIDE-R <= 9999999999)) OR             FAC0005     4534 (TIP-IDE-BDIIVIDE = 3 AND                                FAC0004     4535 (NUM-IDE-BDIIVIDE-R >= 6000000000 AND           FAC0004     4536 NUM-IDE-BDIIVIDE-R <  8000000000))     FAC0005     4537MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004   INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002   INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002   INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002   EVALUATE TIP-IDE-BDIIVIDEFAC0002   EVALUATE TIP-IDE-BDIIVIDEFAC0002   IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002   IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002   241     " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE242     PERFORM 80400-VALIDAR-TIPO-ID243 display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE244 " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE245 " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE246IF SW-TID-BDIIVIDE = 0247*  el tipo de id es OK248Ddisplay "el n° de ID está dentro de su rango"249  IF HACER-MATCH = ZEROS250*       abre archivos y carga la tabla de direcciones251*      estandar, solo la primera vez252   IF OPEN-DIR = ZEROS253D       display "carga tabla DIRESTAN"254      OPEN INPUT MAESTRO-DIRECC255      OPEN INPUT BDLCLI256          OPEN INPUT SUSCRIPTOR257       OPEN INPUT MAESTRO-CREDIT258      OPEN INPUT MAESTRO-CHECK259             PERFORM 06000-U-CARGAR-TABLA-DIRESTAN260MOVE 1 TO OPEN-DIR261             END-IF262*            abre archivos y carga la tabla de direcciones263             MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH264             MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH265*            Se recorre toda la estructura bdacsv para la identificacion      4266*            buscada. En caso de hallar registros se procede a realizar el    4267*       match268D    display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH269D    " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH270D   " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH271D   " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH272       PERFORM 1000-U-RECORRER-CSV-BDAMATCH273D       display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH274D    " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH275D    " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH276D    " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH277   MOVE 1 TO HACERMATCH-LEEMSTRS278       IF IDE-TIPO-BDAMATCH = 1279           IF TIPOID-E = 1 OR 4280            INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL281            "," BY " ", ";" BY " "282       END-IF283        MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM284        MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM285       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM286       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
      

    
      

    
      

    display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEIF SW-TID-BDIIVIDE = 00000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL

Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso04 Refresque Total - Carga TOTALFecha de proceso: 201401044000-PROCESAR-REGISTRO

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  1304114000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  130411Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000149123SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
  
    4241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4242PERFORM 80400-VALIDAR-TIPO-ID4243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4246IF SW-TID-BDIIVIDE = 04247*el tipo de id es OK4248Ddisplay "el n° de ID está dentro de su rango"4249IF HACER-MATCH = ZEROS4250*abre archivos y carga la tabla de direcciones4251*estandar, solo la primera vez4252IF OPEN-DIR = ZEROS4253Ddisplay "carga tabla DIRESTAN"4254OPEN INPUT MAESTRO-DIRECC4255OPEN INPUT BDLCLI4256OPEN INPUT SUSCRIPTOR4257OPEN INPUT MAESTRO-CREDIT4258OPEN INPUT MAESTRO-CHECK4259PERFORM 06000-U-CARGAR-TABLA-DIRESTAN4260MOVE 1 TO OPEN-DIR4261END-IF4262*abre archivos y carga la tabla de direcciones4263MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH4264MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH4265*Se recorre toda la estructura bdacsv para la identificacion      4266*buscada. En caso de hallar registros se procede a realizar el    4267*match4268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4269D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4270D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4271D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272PERFORM 1000-U-RECORRER-CSV-BDAMATCH4273Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4274D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4275D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4276D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4277MOVE 1 TO HACERMATCH-LEEMSTRS4278IF IDE-TIPO-BDAMATCH = 14279IF TIPOID-E = 1 OR 44280INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL4281"," BY " ", ";" BY " "4282END-IF4283MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM4284MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM4285MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM4286MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMAnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll  F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreIF SW-TID-BDIIVIDE = 0display "el n° de ID está dentro de su rango"
      

    
      

    
      

    display "el n° de ID está dentro de su rango"IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROSIF OPEN-DIR = ZEROSdisplay "carga tabla DIRESTAN"
      

    
      

    
      

    display "carga tabla DIRESTAN"OPEN INPUT MAESTRO-DIRECCOPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLIOPEN INPUT BDLCLIOPEN INPUT SUSCRIPTOROPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANPerform-level    Exit ViewPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIRAnimateCARGAJUR.gnt/.o/.exe    Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  MOVE 1 TO OPEN-DIREND-IFEND-IFMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH  4241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4242PERFORM 80400-VALIDAR-TIPO-ID4243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4246IF SW-TID-BDIIVIDE = 04247*el tipo de id es OK4248Ddisplay "el n° de ID está dentro de su rango"4249IF HACER-MATCH = ZEROS4250*abre archivos y carga la tabla de direcciones4251*estandar, solo la primera vez4252IF OPEN-DIR = ZEROS4253Ddisplay "carga tabla DIRESTAN"4254OPEN INPUT MAESTRO-DIRECC4255OPEN INPUT BDLCLI4256OPEN INPUT SUSCRIPTOR4257OPEN INPUT MAESTRO-CREDIT4258OPEN INPUT MAESTRO-CHECK4259PERFORM 06000-U-CARGAR-TABLA-DIRESTAN4260MOVE 1 TO OPEN-DIR4261END-IF4262*abre archivos y carga la tabla de direcciones4263MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH4264MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH4265*Se recorre toda la estructura bdacsv para la identificacion                                                                                                                                   4266*buscada. En caso de hallar registros se procede a realizar el                                                                                                                                 4267*match4268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4269D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4270D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4271D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272PERFORM 1000-U-RECORRER-CSV-BDAMATCH4273Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4274D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4275D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4276D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4277MOVE 1 TO HACERMATCH-LEEMSTRS4278IF IDE-TIPO-BDAMATCH = 14279IF TIPOID-E = 1 OR 44280INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL4281"," BY " ", ";" BY " "4282END-IF4283MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM4284MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM4285MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM4286MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMAnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll                                                                                                                               F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape                                                                                                                               Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreQuery-data    Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                           Entername[+offset]orhexaddress                                                                                                          T      A      B      L      A      -      D      I      R      -      C      O      M      P      U      E      S      T      A      S      -      B      D      L      D      I      R      MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHSe recorre toda la estructura bdacsv para la identif    buscada. En caso de hallar registros se procede a re  TABLA-DIR-COMPUESTAS-BDLDIR<W-S>///////////CALLE    /////////CALLE      ////////CARRERA     ///CARRERA          ///CRA.                 //CALLE             /AV                 /AV.                  /AVDA               /CALL               :   TABLA-DIR-COMPUESTAS-BDLDIR<W-S>  F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape   MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH Se recorre toda la estructura bdacsv para la identi     buscada. En caso de hallar registros se procede a r   match display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHAnimateCARGAJUR.gnt/.o/.exe  view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NQuery-data    Cursor-name Enter-name Monitor-off Hide/Org-monitorsNo such command AnimateCARGAJUR.gnt/.o/.exe    Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  Query-data    Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUMID-E<W-S>00000149123         :   NUMID-E<W-S>  clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape  NUMID-E  TO NUM-corre toda la es    da. En caso de h  AnimateCARGAJUR.gnt/.o/.exe  view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  Query-data    Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUMID-E<W-S>00000149123         :   NUMID-E<W-S>  clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape  NUMID-E  TO NUM-corre toda la es    da. En caso de h  AnimateCARGAJUR.gnt/.o/.exe  view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  Query-data    Cursor-name Enter-name Monitor-off Hide/Org-monitorsTIPOID-E<W-S>1                  :   TIPOID-E<W-S>  clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape  TIPOID-E TO TIP-INUMID-E  TO NUM-Icorre toda la est    AnimateCARGAJUR.gnt/.o/.exe  view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape  Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More  MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHdisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
      

    
      

    
      

    display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL

Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso04 Refresque Total - Carga TOTALFecha de proceso: 201401044000-PROCESAR-REGISTRO

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  1304114000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720  130411Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000149123SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangocarga tabla DIRESTANBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:NUM-CTAS-OUTPUT:MAX-CUENTAS:0000  5
  
    50000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL

Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso04 Refresque Total - Carga TOTALFecha de proceso: 201401044000-PROCESAR-REGISTRO

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720   1304114000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720   130411Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000149123SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangocarga tabla DIRESTANBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:NUM-CTAS-OUTPUT:MAX-CUENTAS:0000   5  4241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4242PERFORM 80400-VALIDAR-TIPO-ID4243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4246IF SW-TID-BDIIVIDE = 04247*el tipo de id es OK4248Ddisplay "el n° de ID está dentro de su rango"4249IF HACER-MATCH = ZEROS4250*abre archivos y carga la tabla de direcciones4251*estandar, solo la primera vez4252IF OPEN-DIR = ZEROS4253Ddisplay "carga tabla DIRESTAN"4254OPEN INPUT MAESTRO-DIRECC4255OPEN INPUT BDLCLI4256OPEN INPUT SUSCRIPTOR4257OPEN INPUT MAESTRO-CREDIT4258OPEN INPUT MAESTRO-CHECK4259PERFORM 06000-U-CARGAR-TABLA-DIRESTAN4260MOVE 1 TO OPEN-DIR4261END-IF4262*abre archivos y carga la tabla de direcciones4263MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH4264MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH4265*Se recorre toda la estructura bdacsv para la identificacion       4266*buscada. En caso de hallar registros se procede a realizar el     4267*match4268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4269D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4270D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4271D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272PERFORM 1000-U-RECORRER-CSV-BDAMATCH4273Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4274D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4275D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4276D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4277MOVE 1 TO HACERMATCH-LEEMSTRS4278IF IDE-TIPO-BDAMATCH = 14279IF TIPOID-E = 1 OR 44280INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL4281"," BY " ", ";" BY " "4282END-IF4283MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM4284MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM4285MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM4286MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMAnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MorePERFORM 1000-U-RECORRER-CSV-BDAMATCH6963* MATCH6964******************************************************************6965MOVE 0 TO IDE-TIPO-BDAMATCH6966MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003      6967MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                   RMB0003      6968MOVE 0 TO MAX-CUENTAS-BDAMATCH.6969 IF ABIERTO-BDAMATCH  = 06970 OPEN INPUT  BDACSV6971MOVE 1 TO ABIERTO-BDAMATCH6972 END-IF.6973 INITIALIZE LLAVE-BDACSV.6974MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .6975 MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .6976MOVE 0 TO FIN-BDAMATCH .6977MOVE 0 TO PROCESAR-BDAMATCH .6978START BDACSV  KEY > LLAVE-BDACSV6979INVALID KEY6980MOVE 1 TO FIN-BDAMATCH6981NOT INVALID KEY6982READ BDACSV IGNORE LOCK NEXT RECORD6983    AT END6984        MOVE 1 TO FIN-BDAMATCH6985 END-READ6986END-START.6987 PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =6988                          NUM-IDE-INPUT-BDAMATCH  OR6989      TIPO-ID-BDACSV  NOT =6990                          TIP-IDE-INPUT6991 MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD026992 READ SUSCRIPTOR IGNORE LOCK6993 INVALID KEY6994 MOVE 0 TO PROCESAR-BDAMATCH6995 NOT INVALID KEY6996  MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004      6997 END-READ6998 IF PROCESAR-BDAMATCH = 1                 RMB0004      6999IF ESTADO-ABD02 = 1            RMB0004      7000 IF IND-BLOQUEO-BDACSV <> "B"RMB0004      7001MOVE 1 TO PROCESAR-BDAMATCHRMB0004      7002IF FUENTE-REG-BDACSV <= 01                   RMB0004      7003PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004      7004LSE  RMB0004      7005   PERFORM 1100-LLENAR-AUX-BDAMATCH RMB0004      7006END-IF                                           RMB0004      7007ELSE                                    RMB0004      70080 TO PROCESAR-BDAMATCH                      RMB0004    MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO MAX-CUENTAS-BDAMATCH.MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVOPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCHMOVE 1 TO ABIERTO-BDAMATCHEND-IF.END-IF.INITIALIZE LLAVE-BDACSV.INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .
INITIALIZE LLAVEQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsLLAVE-BDACSV<W-S>100000000014912300000000                         :   LLAVE-BDACSV<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   LLAVE-BDACSV.E-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .E-INPUT-BDAMATCH  TO NUM-ID-BDACSV .AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVSTART BDACSV  KEY > LLAVE-BDACSVREAD BDACSV IGNORE LOCK NEXT RECORDREAD BDACSV IGNORE LOCK NEXT RECORDEND-START.END-START.PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =7025        END-IFRMB0004      7026     END-PERFORM.7027IF MAX-CUENTAS-BDAMATCH > 07028   IF APELLIDO-INPUT-BDAMATCH <> SPACES AND4      7029      MAX-CUENTAS-BDAMATCH > 1      4      7030      PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004      7031      PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004      7032   PERFORM 1200-PROC-REG-CSV-BDAMATCHRMB0004      7033END-IF                    RMB0004      7034   PERFORM 9000-U-REALIZAR-BDAMATCH7035   IF NOM-OUTPUTMATCH <> SPACES ANDRMB0004      7036      (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)         RMB0004      7037      MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004      7038      PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004      7039      MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004      7040   END-IF                       RMB0004      7041IF NOM-OUTPUT-BDAMATCH <> SPACES7042MOVE 1 TO IDE-TIPO-BDAMATCH7043END-IF7044END-IF.7045 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004      7046MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQRMB0004      7047MOVE 0 TO I-MAQ  RMB0004      7048INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004      7049        INITIAL "Y/O"                                  RMB0004      7050OR"Y\O"                            RMB0004      7051OR" Y/OTRO "                     RMB0004      7052OR" Y/OTRA "                      RMB0004      7053     OR      " Y\OTRO "                 RMB0004      7054     OR      " Y\OTRA "    RMB0004      7055  OR      " Y OTRO "RMB0004      7056OR      " Y OTRA "          RMB0004      7057IF I-MAQ < 45 AND I-MAQ > 2RMB0004      7058ADD 1 TO I-MAQ                         7059MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004      7060ELSE                             7061IF I-MAQ < 45             62ADD 1 TO I-MAQ                     63MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)    64END-IF                                 65END-IF                                           66MOVE 0 TO SW-BORRAR-MAQ    67MOVE 1 TO I-MAQ.                                   68PERFORM UNTIL I-MAQ > 45    69MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ    70IF TILDE-MAQ                             IF MAX-CUENTAS-BDAMATCH > 06980      MOVE 1 TO FIN-BDAMATCH6981      NOT INVALID KEY6982         READ BDACSV IGNORE LOCK NEXT RECORD6983         AT END6984         MOVE 1 TO FIN-BDAMATCH6985   END-READ6986END-START.6987PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =6988      NUM-IDE-INPUT-BDAMATCH  OR6989                              TIPO-ID-BDACSV  NOT =6990                              TIP-IDE-INPUT-BDAMATCH6991MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD026992READ SUSCRIPTOR IGNORE LOCK6993INVALID KEY6994   MOVE 0 TO PROCESAR-BDAMATCH6995   NOT INVALID KEY6996      MOVE 1 TO PROCESAR-BDAMATCHRMB0004      6997END-READ6998IF PROCESAR-BDAMATCH = 1RMB0004      6999      IF ESTADO-ABD02 = 1RMB0004    00              IF IND-BLOQUEO-BDACSV <> "B"    01            MOVE 1 TO PROCESAR-BDAMATCH                     02            IF FUENTE-REG-BDACSV <= 01    03               PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCH        04    ELSE         05  PERFORM 1100-LLENAR-AUX-BDAMATCH    06    END-IF            07 ELSE                 08    MOVE 0 TO PROCESAR-BDAMATCH    09 END-IF               10ELSE              11 MOVE 0 TO PROCESAR-BDAMATCH    12      END-IF                   13END-IF            14IF PROCESAR-BDAMATCH = 115      PERFORM 1200-PROC-REG-CSV-BDAMATCH16END-IF17READ BDACSV IGNORE LOCK   NEXT RECORD18AT END19   MOVE 1 TO FIN-BDAMATCH20   END-READ21   IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    22      MOVE 1 TO FIN-BDAMATCH*> SE ABLIGA A TIP    23      MOVE 0 TO MAX-CUENTAS-BDAMATCH*> EFICIENCIA Y    24    MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA    25 END-IF         7025END-IF                      RMB0004      7026END-PERFORM.7027IF MAX-CUENTAS-BDAMATCH > 07028IF APELLIDO-INPUT-BDAMATCH <> SPACES ANDRMB0004      7029MAX-CUENTAS-BDAMATCH > 1       RMB0004      7030PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004      7031      PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004      7032      PERFORM 1200-PROC-REG-CSV-BDAMATCH               RMB0004      7033END-IF                            RMB0004      7034PERFORM 9000-U-REALIZAR-BDAMATCH7035IF NOM-OUTPUT-BDAMATCH <> SPACES AND                RMB0004      7036   (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)    RMB0004      7037   MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004      7038PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004      7039MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004      7040END-IF            RMB0004      7041IF NOM-OUTPUT-BDAMATCH <> SPACES7042   MOVE 1 TO IDE-TIPO-BDAMATCH7043END-IF7044END-IF.45 1100-MAQUILLAR-NOMBRE-MAQ.                   46MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ    47MOVE 0 TO I-MAQ                           48INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE    49INITIAL "Y/O"    50OR "Y\O"                              51OR      " Y/OTRO "    52OR      " Y/OTRA "    53OR      " Y\OTRO "                 54OR      " Y\OTRA "    55  OR" Y OTRO "    56OR      " Y OTRA "              57IF I-MAQ < 45 AND I-MAQ > 2    58ADD 1 TO I-MAQ    59MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004    60ELSE                                    RMB0004    61IF I-MAQ < 45RMB0004    62   ADD 1 TO I-MAQ                    RMB0004    63   MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)RMB0004    64END-IF                   RMB0004    65END-IF     RMB0004    66MOVE 0 TO SW-BORRAR-MAQ                                      67MOVE 1 TO I-MAQ.                                  68PERFORM UNTIL I-MAQ > 45                               69MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ                   70IF TILDE-MAQ    IF MAX-CUENTAS-BDAMATCH > 04271D     " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272        PERFORM 1000-U-RECORRER-CSV-BDAMATCH4273D        display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4274D     " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4275D  " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4276D  " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4277  MOVE 1 TO HACERMATCH-LEEMSTRS4278  IF IDE-TIPO-BDAMATCH = 14279         IF TIPOID-E = 1 OR 44280             INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL4281             "," BY " ", ";" BY " "4282      END-IF4283      MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM4284      MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM4285      MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM4286         MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4287         PERFORM 10000-MATCH-NOMBRES-VALNOM4288D      display "10000-MATCH-NOMBRES-VALNOM"4289D        display "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM4290D       " " NOM-OUTPUT-BDAMATCH4291                 IF MATCH-OK-OUT-VALNOM = 14292                MOVE 1 TO IDE-TIPO-BDAMATCH4293            ELSE4294               IF W-BLOQUES > 04295           MOVE 0 TO IDE-TIPO-BDAMATCH4296  END-IF4297    END-IF4298END-IF42994300IF IDE-TIPO-BDAMATCH = 14301    MOVE TIPOID-E TO TIP-VAL4302    MOVE NUMID-E TO CED-VAL4303            MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA4304         PERFORM 9800-FILTRAR-ALFABETICO4305         MOVE CADENA-SALE TO  NOM-VAL4306    MOVE ZEROS TO FEC-EXP-VAL4307         MOVE SPACES TO MUN-EXP-VAL4308      MOVE SPACES TO DEP-EXP-VAL4309      MOVE SPACES TO VIG-VAL4310         MOVE SPACES TO GENERO-VAL4311      MOVE SPACES TO EDAD-VAL4312            MOVE SPACES TO EDAD-RANGO4313            ADD 1 TO SI-EXISTE-CSV4314        END-IF4315  END-IF4316END-IF.display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH2728 513-VALIDA-EN-CSV.29display "513-VALIDA-EN-CSV"                                             30display "TIPOID-E:" TIPOID-E ID-E:" NUMID-E31**************************************************************32* Valida si la identificación está en la base de datos alterna33**************************************************************34*hace validacion de tipo de identificacion35MOVE TIPOID-E TO TIP-IDE-BDIIVIDE36MOVE NUMID-E TO NUM-IDE-BDIIVIDE37*retorna SW-TID-BDIIVIDE=0 si el num id no está dentro38*del rango que corresponde al tipo de id39display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE40" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE41" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-BDIIVIDE42PERFORM 80400-VALIDAR-TIPO-ID43display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE44 " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE45 " SW-TID:" SW-TID-BDIIVIDE " NOM:" NOM-VAL-BDIIVIDE46 IF SW-TID-BDIIVIDE = 047*el tipo de id es OK48Ddisplay "el n° de ID está dentro de su rango"49IF HACER-MATCH = ZEROS50*abre archivos y carga la tabla de direcciones51*estandar, solo la primera vez52IF OPEN-DIR = ZEROS53Ddisplay "carga tabla DIRESTAN"54    OPEN INPUT MAESTRO-DIRECC55OPEN INPUT BDLCLI256    OPEN INPUT SUSCRIPTOR257OPEN INPUT MAESTRO-CREDIT258OPEN INPUT MAESTRO-CHECK259PERFORM 06000-U-CARGAR-TABLA-DIRESTAN260MOVE 1 TO OPEN-DIR261END-IF262*abre archivos y carga la tabla de direcciones263MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH264MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH265*Se recorre toda la estructura bdacsv para la identificacion       4266*buscada. En caso de hallar registros se procede a realizar el     4267*match268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH269D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH270D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH271D    " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH272        PERFORM 1000-U-RECORRER-CSV-BDAMATCH









Reset-execution      Cursor-position Next Start Quit-performPERFORM 1000-U-RECORRER-CSV-BDAMATCHAnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 1000-U-RECORRER-CSV-BDAMATCH6963* MATCH6964******************************************************************6965 MOVE 0 TO IDE-TIPO-BDAMATCH6966 MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .        RMB0003      6967     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                     RMB0003      6968     MOVE 0 TO MAX-CUENTAS-BDAMATCH.6969     IF ABIERTO-BDAMATCH  = 06970    OPEN INPUT  BDACSV6971   MOVE 1 TO ABIERTO-BDAMATCH6972END-IF.6973 INITIALIZE LLAVE-BDACSV.6974 MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .6975MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .6976MOVE 0 TO FIN-BDAMATCH .6977MOVE 0 TO PROCESAR-BDAMATCH .6978START BDACSV  KEY > LLAVE-BDACSV6979      INVALID KEY6980         MOVE 1 TO FIN-BDAMATCH6981      NOT INVALID KEY6982         READ BDACSV IGNORE LOCK NEXT RECORD6983         AT END6984            MOVE 1 TO FIN-BDAMATCH6985     END-READ6986 END-START.6987 PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =6988                   NUM-IDE-INPUT-BDAMATCH  OR6989                      TIPO-ID-BDACSV  NOT =6990                     TIP-IDE-INPUT-BDAMATCH6991MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD026992READ SUSCRIPTOR IGNORE LOCK6993INVALID KEY6994MOVE 0 TO PROCESAR-BDAMATCH6995NOT INVALID KEY6996MOVE 1 TO PROCESAR-BDAMATCHRMB0004      6997END-READ6998 IF PROCESAR-BDAMATCH = 1                          RMB0004      6999IF ESTADO-ABD02 = 1                      RMB0004      7000 IF IND-BLOQUEO-BDACSV <> "B"          RMB0004      7001     MOVE 1 TO PROCESAR-BDAMATCH                      RMB0004      7002     IF FUENTE-REG-BDACSV <= 01                       RMB0004      7003        PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004      7004     ELSE                                       RMB0004      7005        PERFORM 1100-LLENAR-AUX-BDAMATCH              RMB0004      7006     END-IF                                  RMB0004      7007  ELSE                               RMB0004      7008    MOVE 0 TO PROCESAR-BDAMATCH     RMB0004    MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO MAX-CUENTAS-BDAMATCH.MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0IF ABIERTO-BDAMATCH  = 0INITIALIZE LLAVE-BDACSV.INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVSTART BDACSV  KEY > LLAVE-BDACSVREAD BDACSV IGNORE LOCK NEXT RECORDREAD BDACSV IGNORE LOCK NEXT RECORDEND-START.END-START.PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =PERFORM UNTIL FIN-Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsFIN-BDAMATCH<W-S>0 :   FIN-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   FIN-BDAMATCH  = 1 OR   NU                   TIAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   BDAMATCH  = 1 OR NUQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUM-ID-BDACSV<W-S>000000000154034     OR:   NUM-ID-BDACSV<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NUM-ID-BDACSV  NOT =M-IDE-INPUT-BDAMATCH  ORPO-ID-BDACSV  NOT =AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUM-IDE-INPUT-BDAMATCH<W-S>00000149123         :   NUM-IDE-INPUT-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NUM-IDE-INPUT-BDAMATCH  ORTIPO-ID-BDACSV  NOT =TIP-IDE-INPUT-BDAMATCHAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =7008       MOVE 0 TO PROCESAR-BDAMATCHRMB0004      7009              END-IF                                              RMB0004      7010      ELSE                 RMB0004      7011         MOVE 0 TO PROCESAR-BDAMATCH    4      7012      END-IF                        4      7013   END-IF                      RMB0004      7014   IF PROCESAR-BDAMATCH = 17015   PERFORM 1200-PROC-REG-CSV-BDAMATCH7016END-IF7017   READ BDACSV IGNORE LOCK   NEXT RECORD7018   AT END7019      MOVE 1 TO FIN-BDAMATCH7020   END-READ7021   IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENARMB0004      7022      MOVE 1 TO FIN-BDAMATCH *> SE ABLIGA A TIPRMB0004      7023      MOVE 0 TO MAX-CUENTAS-BDAMATCH*> EFICIENCIA Y   RMB0004      7024MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004      7025END-IF                      RMB0004      7026END-PERFORM.7027IF MAX-CUENTAS-BDAMATCH > 07028IF APELLIDO-INPUT-BDAMATCH <> SPACES ANDRMB0004      7029MAX-CUENTAS-BDAMATCH > 1       RMB0004      7030PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004      7031      PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004      7032      PERFORM 1200-PROC-REG-CSV-BDAMATCH               RMB0004      7033END-IF                            RMB0004      7034PERFORM 9000-U-REALIZAR-BDAMATCH7035IF NOM-OUTPUT-BDAMATCH <> SPACES AND                RMB0004      7036   (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)    RMB0004      7037   MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004      7038PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004      7039MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004      7040END-IF            RMB0004      7041IF NOM-OUTPUT-BDAMATCH <> SPACES7042   MOVE 1 TO IDE-TIPO-BDAMATCH7043END-IF7044END-IF.45 1100-MAQUILLAR-NOMBRE-MAQ.                   46MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ    47MOVE 0 TO I-MAQ                           48INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE    49INITIAL "Y/O"    50OR "Y\O"                              51OR      " Y/OTRO "    52OR      " Y/OTRA "    53OR      " Y\OTRO "                 IF MAX-CUENTAS-BDAMATCH > 0IF MAQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsMAX-CUENTAS-BDAMATCH<W-S>00000                              :   MAX-CUENTAS-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   MAX-CUENTAS-BDAMATCH > 0IF APELLIDO-INPUT-BDAMATCH <>       MAX-CUENTAS-BDAMATCH > 1      AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF MAX-CUENTAS-BDAMATCH > 04271D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272PERFORM 1000-U-RECORRER-CSV-BDAMATCH4273D  display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4274D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4275D  " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4276D     " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4277     MOVE 1 TO HACERMATCH-LEEMSTRS4278  IF IDE-TIPO-BDAMATCH = 14279         IF TIPOID-E = 1 OR 44280             INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL4281      "," BY " ", ";" BY " "4282      END-IF4283         MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM4284         MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM4285      MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM4286      MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4287      PERFORM 10000-MATCH-NOMBRES-VALNOM4288D         display "10000-MATCH-NOMBRES-VALNOM"4289D           display "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM4290D            " " NOM-OUTPUT-BDAMATCH4291         IF MATCH-OK-OUT-VALNOM = 14292          MOVE 1 TO IDE-TIPO-BDAMATCH4293      ELSE4294         IF W-BLOQUES > 04295             MOVE 0 TO IDE-TIPO-BDAMATCH4296      END-IF4297         END-IF4298     END-IF42994300  IF IDE-TIPO-BDAMATCH = 14301      MOVE TIPOID-E TO TIP-VAL4302      MOVE NUMID-E TO CED-VAL4303         MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA4304         PERFORM 9800-FILTRAR-ALFABETICO4305      MOVE CADENA-SALE TO  NOM-VAL4306         MOVE ZEROS TO FEC-EXP-VAL4307       MOVE SPACES TO MUN-EXP-VAL4308                 MOVE SPACES TO DEP-EXP-VAL4309            MOVE SPACES TO VIG-VAL4310            MOVE SPACES TO GENERO-VAL4311            MOVE SPACES TO EDAD-VAL4312    MOVE SPACES TO EDAD-RANGO4313    ADD 1 TO SI-EXISTE-CSV4314END-IF4315END-IF4316END-IF.


      


      


      display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSMOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF IQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsIDE-TIPO-BDAMATCH<W-S>0                       :   IDE-TIPO-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   IDE-TIPO-BDAMATCH = 1 MOVE TIPOID-E TO TIP-VAL MOVE NUMID-E TO CED-VALAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF TQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsTIPOID-E<W-S>1              :   TIPOID-E<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   TIPOID-E = 1 OR 4 INSPECT NOM-OUTP "," BY " ", ";" AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsIDE-TIPO-BDAMATCH<W-S>0                   :   IDE-TIPO-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   IDE-TIPO-BDAMATCH = 1 IF TIPOID-E = 1 OR 4     INSPECT NOM-OUTPUT-BDAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF IDE-TIPO-BDAMATCH = 1END-IFEND-IFEND-IF.END-IF.3548*valida si la identificación está en la base de datos alterna3549PERFORM 513-VALIDA-EN-CSV3550 IF IDE-TIPO-BDAMATCH = 03551 IF TIP-IDE-BDIIVIDE = 13552*es una cédula3553 MOVE 04 TO CODIGO-ERROR3554else3555*no es una cédula3556MOVE 03 TO CODIGO-ERROR3557END-IF3558END-IF.355935603561 4300-MODIFICAR-BDIIALE.3562Ddisplay "4300-MODIFICAR-BDIIALE"3563******************************************************************3564* Se impacta el archivo BDIIALE con una o dos inserciones,3565* modificaciones o eliminaciones segun haya o no demandas y3566* embargos3567******************************************************************3568initialize REG-BDIIALE35693570*si hay demandas3571if JURAD-demandas-vigentes > zero3572or JURAD-demandas-terminadas > zero3573move "J001" to LLASEC-BDIIALE3574*arma datos de demandas3575move JURAD-demandas-vigentes to D-vigentes3576move JURAD-demandas-terminadas to D-terminados3577string "20" JURAD-demandas-fecha-ultima3578delimited size into D-fecha-ultima3579perform 4300-MODIFICAR-BDIIALE-DATOS3580end-if.35813582*si hay embargos3583if JURAD-embargos-vigentes > zero3584or JURAD-embargos-terminados > zero3585move "J002" to LLASEC-BDIIALE3586*arma datos de embargos3587move JURAD-embargos-vigentes to D-vigentes3588move JURAD-embargos-terminados to D-terminados3589string "20" JURAD-embargos-fecha-ultimo3590delimited size into D-fecha-ultima3591perform 4300-MODIFICAR-BDIIALE-DATOS3592end-if.3593IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1MOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERROREND-IF.END-IF.321si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325 perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347Numero de identificacion348if JURAD-id-numeroX is not numeric349call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356tipo-novedad = "E"357    exit paragraph358end-if359Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR861862 4900-GRABAR-ERROR.863Ddisplay "4900-GRABAR-ERROR"864******************************************************************865* El registro de JURAD tiene error: se graba en el archivo ERRS866* con indicacion del error detectado867******************************************************************86move JURAD-reg to ERRS-reg86move E-errores-reg to ERRS-causa-rechazo870*lista de los codigos de los errores del registro871 move E-errores-reg to ERRS-causa-rechazo87write ERRS-reg87evaluate ERRS-fs87when "00"87continue87when other877             display "Error al grabar el archivo de errores "878         display "Nombre del archivo: " ERRS-file-name879             display "File status: " ERRS-fs880             perform 9000-CANCELAR-PROGRAMA881             goback882 end-evaluate.883884885 4320-ARMAR-TEXTO-ALERTA.886Ddisplay "4320-ARMAR-TEXTO-ALERTA"887****************************************************************888* Hace el reemplazo de los valores adecuados en los templates889* de las linea de alerta que corresponde890****************************************************************891*segun se trate de demandas o embargos89if JURAD-demandas-vigentes not = 089or JURAD-demandas-terminadas not = 0894     set LAx to 1895     move high-values to LA-valores89    move JURAD-demandas-vigentes to LA-num897* >>>> esto esta anulado x que no se como hacer para que lo compile898*    unstring LA-numX into LA-descarte LA-valor(1)89    delimited by all space90    move LA-numx(9:12) to LA-valor(1)90move JURAD-demandas-terminadas to LA-num902* >>>> esto esta anulado x que no se como hacer para que lo compile90    unstring LA-numX into LA-descarte LA-valor(2)904*    delimited by all space90move LA-numx(9:12) to LA-valor(2)906
      
      
      display "4900-GRABAR-ERROR"move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fscontinuecontinueend-evaluate.end-evaluate.323if E-hay-error = "SI"324         perform 4900-GRABAR-ERROR325     perform 4240-CONTAR-TIPO-CUENTA326         exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345move 05 to codigo-error346end-if347*    Numero de identificacion348 if JURAD-id-numeroX is not numeric349         call "PONERR" using "03" JURAD-reg E-errores350     end-if351     if JURAD-id-numero not > 0352         call "PONERR" using "04" JURAD-reg E-errores353 end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361 call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364     if JURAD-demandas-vigentes is not numeric365 call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numericperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide51402=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*    cuenta tipo 7: 03 04 05524525 IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526    ADD 1 TO W-CONT-TIPO-6527ELSE528IF CODIGO-ERROR = 03 OR 04 OR 05529        ADD 1 TO W-CONT-TIPO-7530     ELSE531*        registros correctos, repetidos o no532    ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534        IF TIPOID-E = 2 OR 3535        ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537     END-IF538 END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546 MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548*valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550 IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1
















IF CODQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCODIGO-ERROR<W-S>04                 -6:   CODIGO-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CODIGO-ERROR = 01 OR  ADD 1 TO W-CONT-TIPO-6EAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7END-IF.END-IF.324perform 4900-GRABAR-ERROR325         perform 4240-CONTAR-TIPO-CUENTA326     exit paragraph327     end-if328329 perform 4240-CONTAR-TIPO-CUENTA330331intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333 add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349 call "PONERR" using "03" JURAD-reg E-errores350end-if351 if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361         call "PONERR" using "05" JURAD-reg E-errores362     end-if363*    Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numeric369call "PONERR" using "07" JURAD-reg E-erroresexit paragraph264*controla el reg y lo aplica si es OK26000-PROCESAR-REGISTRO-226move JURAD-reg to JURAD-reg-anterior26    add 1 to REG-LEIDOS26when "10"269*    fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes27    de que se terminara el archivo27    display "Falta el reg de totales del archivo JURAD "27    display "Nombre del archivo: " P-file-name27display "File status: " JURAD-fs27display "Ultimo registro leido: " N-reg-leidos27display JURAD-reg-anterior277         perform 9000-CANCELAR-PROGRAMA278 when other279*        error de lectura: cancelacion del proceso280         display "Error en lectura del archivo JURAD "281         display "Nombre del archivo: " P-file-name282     display "File status: " JURAD-fs28    display "Ultimo registro leido: " N-reg-leidos28display JURAD-reg-anterior28perform 9000-CANCELAR-PROGRAMA28evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************29move "NO" to E-hay-error297298*validacion del tipo de movimiento299 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"0    call "PONERR" using "01" JURAD-reg E-errores0end-if020si es el registro "T" hay que señalar el fin de proceso0tipo-novedad = "T"0move "SI" to IND-fin-proceso0    perform 4800-PROCESO-REG-T07     exit paragraph0end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************

         

         

         display "4000-PROCESAR-REGISTRO"read JURADread JURADevaluate JURAD-fsevaluate JURAD-fsdisplay " "

         

         

         display " "display " "

         

         

         display " "display JURAD-reg

         

         

         display JURAD-regperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2display "4000-PROCESAR-REGISTRO-2"   

         

         

         display "4000-PROCESAR-REGISTRO-2"   94* La informacion esta leida en JURAD-reg95****************************************************************96 move "NO" to E-hay-error9798*    validacion del tip movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305 move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313 move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323 if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339**move "NO" to E-hay-errorif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"add 1 to N-reg-leidosadd 1 to N-reg-leidosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALPerform-level      Exit View

      

      

      perform 4100-VALIDACION-FORMALif E-hay-error = "SI"AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if EQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsE-HAY-ERROR<W-S>SI                :   E-HAY-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   E-hay-error = "SI" perform 4900-GRABAR perform 4240-CONTARAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressTABLA-DIR-COMPUESTAS-BDLDIR.                                                    J

U

R

A

D




r

e

g

COMPUESTAS-BDLDIR. 

OMPUESTAS-BDLDIR. 

MPUESTAS-BDLDIR. 

PUESTAS-BDLDIR. 

UESTAS-BDLDIR. 

ESTAS-BDLDIR. 

STAS-BDLDIR. 

TAS-BDLDIR. 

AS-BDLDIR. 

S-BDLDIR. 

-BDLDIR. 

BDLDIR. 

DLDIR. 

LDIR. 

DIR. 

IR. 

R. 

. 

 













-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphJURAD-REG<W-S>Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411:   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape   E-hay-error = "SI" perform 4900-GRABAR-ERROR perform 4240-CONTAR-TIPO-CUENTA exit paragraphAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR861862 4900-GRABAR-ERROR.863Ddisplay "4900-GRABAR-ERROR"864******************************************************************865* El registro de JURAD tiene error: se graba en el archivo ERRS866* con indicacion del error detectado867******************************************************************868move JURAD-reg to ERRS-reg869move E-errores-reg to ERRS-causa-rechazo870lista de los codigos de los errores del registro871move E-errores-reg to ERRS-causa-rechazo872write ERRS-reg873evaluate ERRS-fs874when "00"875        continue876when other877        display "Error al grabar el archivo de errores "878display "Nombre del archivo: " ERRS-file-name879         display "File status: " ERRS-fs880        perform 9000-CANCELAR-PROGRAMA881        goback882end-evaluate.883884885 4320-ARMAR-TEXTO-ALERTA.886Ddisplay "4320-ARMAR-TEXTO-ALERTA"887****************************************************************888* Hace el reemplazo de los valores adecuados en los templates889* de las linea de alerta que corresponde890****************************************************************891*segun se trate de demandas o embargos892if JURAD-demandas-vigentes not = 0893or JURAD-demandas-terminadas not = 0894    set LAx to 1895move high-values to LA-valores896    move JURAD-demandas-vigentes to LA-num897* >>>> esto esta anulado x que no se como hacer para que lo compile898    unstring LA-numX into LA-descarte LA-valor(1)899*    delimited by all space900    move LA-numx(9:12) to LA-valor(1)901move JURAD-demandas-terminadas to LA-num902* >>>> esto esta anulado x que no se como hacer para que lo compile903*unstring LA-numX into LA-descarte LA-valor(2)904*        delimited by all space905     move LA-numx(9:12) to LA-valor(2)906
      
      
      display "4900-GRABAR-ERROR"move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fscontinuecontinueend-evaluate.end-evaluate.316perform 4900-GRABAR-ERROR317*        perform 4240-CONTAR-TIPO-CUENTA318     exit paragraph319     end-if320321*    si la validacion formal dio OK se hace validacion semantica322     perform 4200-VALIDACION-SEMANTICA323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325     perform 4240-CONTAR-TIPO-CUENTA326    exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343     if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346 end-if347*Numero de identificacion348ifid-numeroX is not numeric349call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352         call "PONERR" using "04" JURAD-reg E-errores353 end-if354si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357         exit paragraph358 end-if359Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-erroresexit paragraph264*controla el reg y lo aplica si es OK265 000-PROCESAR-REGISTRO-2266move JURAD-reg to JURAD-reg-anterior267    add 1 to REG-LEIDOS268when "10"269    fin del archivo de input:270*    esto es un error, no se encontro el registro "T" antes271*    de que se terminara el archivo272display "Falta el reg de totales del archivo JURAD "273display "Nombre del archivo: " P-file-name274display "File status: " JURAD-fs275    display "Ultimo registro leido: " N-reg-leidos276display JURAD-reg-anterior277    perform 9000-CANCELAR-PROGRAMA278when other279    error de lectura: cancelacion del proceso280    display "Error en lectura del archivo JURAD "281    display "Nombre del archivo: " P-file-name282display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284display JURAD-reg-anterior285         perform 9000-CANCELAR-PROGRAMA286 end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299tipo-novedad not = "I" and "M" and "E" and "T"001010203si es el registro "T" hay que señalar el fin de proceso04T"05move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07     exit paragraph08end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************

         

         

         display "4000-PROCESAR-REGISTRO"read JURADread JURADevaluate JURAD-fsevaluate JURAD-fsdisplay " "

         

         

         display " "display " "

         

         

         display " "display JURAD-reg

         

         

         display JURAD-regperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2display "4000-PROCESAR-REGISTRO-2"   

         

         

         display "4000-PROCESAR-REGISTRO-2"   94* La informacion esta leida en JURAD-reg95****************************************************************96 move "NO" to E-hay-error9798*    validacion del tip movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305 move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313 move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323 if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339**move "NO" to E-hay-errorif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress"T"JURAD-reg.                                                              j

u

r

a

d









 

if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"    call "PONERR" using "01" JURAD-reg E-erroresend-ifJURAD-REG<W-S>I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406:   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    if JURAD-tipo-novedad not = "I" and "M" and "E" and     call "PONERR" using "01" JURAD-reg E-errores end-ifAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"add 1 to N-reg-leidosadd 1 to N-reg-leidosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALdisplay "4100-VALIDACION-FORMAL"

      

      

      display "4100-VALIDACION-FORMAL"341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346end-if47*Numero de identificacion48if JURAD-id-numeroX is not numeric49call "PONERR" using "03" JURAD-reg E-errores50 end-if51id-numero not > 052call "PONERR" using "04" JURAD-reg E-errores53end-if54*si el movimiento es una eliminacion los datos subsiguientes55*no se controlan56if JURAD-tipo-novedad = "E"57    exit paragraph58end-if59Nombres y Apellidos60if JURAD-nombre = spaces61    call "PONERR" using "05" JURAD-reg E-errores62end-if63*Numero de demandas vigentes64 if JURAD-demandas-vigentes is not numeric65call "PONERR" using "06" JURAD-reg E-errores6667*Numero de demandas terminadas68 if JURAD-demandas-terminadas is not numeric69    call "PONERR" using "07" JURAD-reg E-errores70end-if71*Fecha ultima demanda vigente YYMMDD72if JURAD-demandas-fecha-ultima is not numeric73call "PONERR" using "08" JURAD-reg E-errores7475move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS76if not ANO-VAL or not MES-VAL or not DIA-VAL77call "PONERR" using "09" JURAD-reg E-errores78 end-if79*Numero de embargos vigentes80if JURAD-embargos-vigentes not numeric81call "PONERR" using "10" JURAD-reg E-errores82end-if83*Numero de embargos terminados84     if JURAD-embargos-terminados not numeric85     call "PONERR" using "11" JURAD-reg E-errores86     end-ifif JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericif JURAD-id-numero not > 0if JURAD-id-numero not > 0if JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"if JURAD-nombre = spacesif JURAD-nombre = spacesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numeric86     end-if87Fecha ultimo embargo vigente YYMMDD88if JURAD-embargos-fecha-ultimo is not numeric89190end-if91move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS92 if not ANO-VAL or not MES-VAL or not DIA-VAL93    call "PONERR" using "13" JURAD-reg E-errores94end-if.959697 4200-VALIDACION-SEMANTICA.98Ddisplay "4200-VALIDACION-SEMANTICA"                                     99****************************************************************400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403move JURAD-id-tipo to TIP-IDE-BDIIVIDE404 move JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408 move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411move 1 to SW-VERIFNOM-BDIIVIDE412 move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416 MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420*Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423if SW-ID-BDIIVIDE = 1424    es un id inválido425    call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428 else429*    existe id, a ver si el nombre coincide430if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-erroresif JURAD-embargos-fecha-ultimo is not numericmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VAL13move 0 to codigo-error14 perform 4100-VALIDACION-FORMAL15if E-hay-error = "SI"16perform 4900-GRABAR-ERROR17*    perform 4240-CONTAR-TIPO-CUENTA18    exit paragraph19end-if2021*si la validacion formal dio OK se hace validacion semantica22perform 4200-VALIDACION-SEMANTICA23if E-hay-error = "SI"24         perform 4900-GRABAR-ERROR25     perform 4240-CONTAR-TIPO-CUENTA26         exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344     call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348if JURAD-id-numeroX is not numeric349     call "PONERR" using "03" JURAD-reg E-errores350end-if351 if JURAD-id-numero not > 03520353 end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356 if JURAD-tipo-novedad = "E"357exit paragraph358end-ifif E-Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsE-HAY-ERROR<W-S>NO                :   E-HAY-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   E-hay-error = "SI" perform 4900-GRABAR perform 4240-CONTARAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if E-hay-error = "SI"perform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICA9697 4200-VALIDACION-SEMANTICA.98Ddisplay "4200-VALIDACION-SEMANTICA"                                     99****************************************************************400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403move JURAD-id-tipo to TIP-IDE-BDIIVIDE404 move JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414     MOVE 1 TO SW-DIGCHEQUEO-VIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420*    Retorna SW-ID-BDIIVIDE=1 si hay error421 perform 80R-IDENTIFICACION422*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423     if SW-ID-BDIIVIDE = 1424*        es un id inválido425     call "PONERR" using "14" JURAD-reg E-errores426*    valida contra la base alterna427perform 4210-VALIDACION-ID-NO-FIGURA428else429*    existe id, a ver si el nombre coincide430     if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  nombre433        display "registro: " NOM-LEIDO-BDIIVIDE434*        validación en base alterna435    perform 4220-VALIDA-NOMBRE-NO-COINCIDE436    else437         perform 4222-VALIDA-NOMBRE-COINCIDE438     end-if439end-if.440441   

         

         

         move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDEperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF SW-ASGTIPID-BDIIVIDE = 1FAC0002    IF SW-ASGTIPID-BDIIVIDE = 1FAC0002    IF SW-VALTIPID-BDIIVIDE = 1FAC0002    IF SW-VALTIPID-BDIIVIDE = 1FAC0002    IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004    IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004    IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004    IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004    PERFORM 80200-VALIDAR-IDPERFORM 80200-VALIDAR-ID439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULA546*Arma el nombre completo en una sola variable547=============================548MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI549MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI550READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE551END-READ552IF SW-ID-BDIIVIDE = 0553 MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE554MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE555 MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE556MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE557 IF ESTADO-CIVIL-BDIIREGI = 0558   STRING559        SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",560"*" DELIMITED BY SIZE ,561             PRIMER-NOMBRE-BDIIVIDEDELIMITED BY "  ",562             "*" DELIMITED BY SIZE ,563             SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,564             ";" DELIMITED BY SIZE ,565             INTO NOM-LEIDO-BDIIVIDE566         END-IF567     IF ESTADO-CIVIL-BDIIREGI = 1568         STRING569       "DE" DELIMITED BY SIZE,570    "*"  DELIMITED BY SIZE,571    SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",572    "*"  DELIMITED BY SIZE,573    PRIMER-NOMBRDELIMITED BY "  ",574       "*"  DELIMITED BY SIZE,575     SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,576  ";"  DELIMITED BY SIZE,577  INTO NOM-LEIDO-BDIIVIDE578END-IF579IF ESTADO-CIVIL-BDIIREGI = 2580  STRING581 "VDA DE" DELIMITED BY SIZE,582 "*"      DELIMITED BY SIZE,583   SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",584     "*"DELIMITED BY SIZE,585   PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",586"*"      DELIMITED BY SIZE,587SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,588";"      DELIMITED BY SIZE,589INTO NOM-LEIDO-BDIIVIDE590END-IF591STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEYREAD BDIIREGI INVALID KEYMOVE 1 TO SW-ID-BDIIVIDEMOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409     MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410  MOVE NOM-VALVIDENOMBOK-INPUT-VALNOM411  IF SW-ID-BDIIVIDE = 0412     IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413        NUM-BLOQUES-BDIIVIDE <> ZEROS414        MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415 ELSE IF TIP-ID-INPUT-VALNOM = 1416        MOVE 2 TO BLOQUES-INPUT-VALNOM417     ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418     END-IF419END-IF420PERFORM 10000-MATCH-NOMBRES-VALNOM421IF MATCH-OK-OUT-VALNOM = 0422   MOVE 1 TO SW-NOMBRES-BDIIVIDE423    END-IF424 END-IF425END-IF426ELSE IF SW-TID-BDIIVIDE = 1   FAC0002      4427 MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IF                                        FAC0002      4429END-IF                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE431END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443PERFORM 85010-UBICA-CEDULA444WHEN 2445PERFORM 85020-UBICA-NIT446WHEN 3447PERFORM 85020-UBICA-NIT448WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0END-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*  es un id inválido3425  call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448 IF TIP-IDE-BDIIVIDE = 13449*        es una cédula3450MOVE 02 TO CODIGO-ERROR3451     ELSE3452*        no es una cédula3453         MOVE 01 TO CODIGO-ERROR3454     END-IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*nombre coincide: busca ID en BDIIALE3463initialize LLAVE-BDIIALE3464move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1call "PONERR" using "14" JURAD-reg E-erroresPerform-level      Exit View


      


      


      call "PONERR" using "14" JURAD-reg E-erroresperform 4210-VALIDACION-ID-NO-FIGURAAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4210-VALIDACION-ID-NO-FIGURA540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551IF TIP-IDE-BDIIVIDE = 1552*es una cédula553 MOVE 04 TO CODIGO-ERROR554else555*    no es una cédula556MOVE 03 TO CODIGO-ERROR557END-IF558END-IF.559560561 4300-MODIFICAR-BDIIALE.562300-MODIFICAR-BDIIALE"563564* Se impacta el archivo BDIIALE con una o dos inserciones,565* modificaciones o eliminaciones segun haya o no demandas y566* embargos567******************************************************************568 initialize REG-BDIIALE569570*si hay demandas571 if JURAD-demandas-vigentes > zero572or JURAD-demandas-terminadas > zero573    move "J001" to LLASEC-BDIIALE574*arma datos de demandas575move JURAD-demandas-vigentes to D-vigentes576         move JURAD-demandas-terminadas to D-terminados577     string "20" JURAD-demandas-fecha-ultima578         delimited size into D-fecha-ultima579         perform 4300-MODIFICAR-BDIIALE-DATOS580     end-if.581582*si hay embargos583if JURAD-embargos-vigentes > zero584or JURAD-embargos-terminados > zero585    move "J002" to LLASEC-BDIIALE
      
      
      display "4210-VALIDACION-ID-NO-FIGURA"MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCHPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSV42274228 513-VALIDA-EN-CSV.4229display "513-VALIDA-EN-CSV"                                               4230D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E4231**************************************************************4232* Valida si la identificación está en la base de datos alterna4233**************************************************************4234*hace validacion de tipo de identificacion4235 MOVE TIPOID-E TO TIP-IDE-BDIIVIDE4236MOVE NUMID-E TO NUM-IDE-BDIIVIDE4237*retorna SW-TID-BDIIVIDE=0 si el num id no está dentro4238*del rango que corresponde al tipo de id4239 display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4240" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4242 PERFORM 80400-VALIDAR-TIPO-ID4243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4246IF SW-TID-BDIIVIDE = 04247*el tipo de id es OK4248D        display "el n° de ID está dentro de su rango"4249     IF HACER-MATCH = ZEROS4250*            abre archivos y carga la tabla de direcciones4251*            estandar, solo la primera vez4252             IF OPEN-DIR = ZEROS4253D         display "carga tabla DIRESTAN"4254                 OPEN INPUT MAESTRO-DIRECC4255            OPEN INPUT BDLCLI4256OPEN INPUT SUSCRIPTOR4257             OPEN INPUT MAESTRO-CREDIT4258            OPEN INPUT MAESTRO-CHECK4259            PERFORM 06000-U-CARGAR-TABLA-DIRESTAN4260        MOVE 1 TO OPEN-DIR4261     END-IF4262*    abre archivos y carga la tabla de direcciones4263    MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH4264    MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH4265*    Se recorre toda la estructura bdacsv para la identificacion       4266*    buscada. En caso de hallar registros se procede a realizar el     4267*        match4268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4269D        " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4270D        " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4271D        " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272    PERFORM 1000-U-RECORRER-CSV-BDAMATCH   


        
         


        
         


        
         display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E   


        
         


        
         


        
      display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-EMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE   


        
         


        
         


        
      display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-ID492*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002      4493*================================================================494    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE                         FAC0002      4495    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4496    EVALUATE TIP-IDE-BDIIVIDE                                 FAC0002      4497      WHEN 1                                                  FAC0002      4498       IF NUM-IDE-BDIIVIDE-R > 9999999999                     FAC0002      4499      MOVE 1 TO SW-TID-BDIIVIDE           FAC0002      4500  END-IF                         FAC0002      4501 WHEN 2                         FAC0002      4502   IF NUM-IDE-BDIIVIDE-R >  9999999999 OR             FAC006C      4503      (NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005      4504     MOVE 1 TO SW-TID-BDIIVIDE                     FAC0002      4505  END-IF                          FAC0002      4506 WHEN 3                                                FAC0002      4507  IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005      4508     MOVE 1 TO SW-TID-BDIIVIDE                     FAC0002      4509  END-IF                          FAC0002      4510END-EVALUATE.                                           FAC0002      4511512 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004      4513*================================================================514*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004      4515*Elimina el digito de chequeo y cambia el tipo de identificacion516*de acuerdo a los rangos para tipo id = 2 y 3517*================================================================518 IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND  FAC0004      4519NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005      4520(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004      4521NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005      4522MOVE 3 TO TIP-IDE-BDIIVIDE      FAC0004      4523END-IF                        FAC0004      4524IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND         FAC0004      4525NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005      4526(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004      4527 NUM-IDE-BDIIVIDE-R  <= 9999999999)               FAC0005      4528MOVE 2 TO TIP-IDE-BDIIVIDE                FAC0004      4529END-IF                                        FAC0004      4530 IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004      4531 (NUM-IDE-BDIIVIDE-R >= 10000000000) OR                   FAC0004      4532 (NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004      4533 NUM-IDE-BDIIVIDE-R <= 9999999999)) OR             FAC0005      4534 (TIP-IDE-BDIIVIDE = 3 AND                                FAC0004      4535 (NUM-IDE-BDIIVIDE-R >= 6000000000 AND           FAC0004      4536 NUM-IDE-BDIIVIDE-R <  8000000000))     FAC0005      4537MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002    EVALUATE TIP-IDE-BDIIVIDEFAC0002    EVALUATE TIP-IDE-BDIIVIDEFAC0002    IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002    IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002    241     " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE242     PERFORM 80400-VALIDAR-TIPO-ID243 display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE244 " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE245 " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE246IF SW-TID-BDIIVIDE = 0247*  el tipo de id es OK248Ddisplay "el n° de ID está dentro de su rango"249  IF HACER-MATCH = ZEROS250*       abre archivos y carga la tabla de direcciones251*      estandar, solo la primera vez252   IF OPEN-DIR = ZEROS253D       display "carga tabla DIRESTAN"254      OPEN INPUT MAESTRO-DIRECC255      OPEN INPUT BDLCLI256          OPEN INPUT SUSCRIPTOR257       OPEN INPUT MAESTRO-CREDIT258      OPEN INPUT MAESTRO-CHECK259             PERFORM 06000-U-CARGAR-TABLA-DIRESTAN260MOVE 1 TO OPEN-DIR261             END-IF262*            abre archivos y carga la tabla de direcciones263             MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH264             MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH265*            Se recorre toda la estructura bdacsv para la identificacion       4266*            buscada. En caso de hallar registros se procede a realizar el     4267*       match268D    display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH269D    " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH270D   " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH271D   " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH272       PERFORM 1000-U-RECORRER-CSV-BDAMATCH273D       display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH274D    " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH275D    " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH276D    " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH277   MOVE 1 TO HACERMATCH-LEEMSTRS278       IF IDE-TIPO-BDAMATCH = 1279           IF TIPOID-E = 1 OR 4280            INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL281            "," BY " ", ";" BY " "282       END-IF283        MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM284        MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM285       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM286       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
        

      
        

      
        

      display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0display "el n° de ID está dentro de su rango"
        

      
        

      
        

      display "el n° de ID está dentro de su rango"IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROSIF OPEN-DIR = ZEROSMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHdisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
        

      
        

      
        

      display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH6963* MATCH6964******************************************************************6965MOVE 0 TO IDE-TIPO-BDAMATCH6966MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003      6967MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                   RMB0003      6968MOVE 0 TO MAX-CUENTAS-BDAMATCH.6969 IF ABIERTO-BDAMATCH  = 06970 OPEN INPUT  BDACSV6971MOVE 1 TO ABIERTO-BDAMATCH6972 END-IF.6973 INITIALIZE LLAVE-BDACSV.6974MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .6975 MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .6976MOVE 0 TO FIN-BDAMATCH .6977MOVE 0 TO PROCESAR-BDAMATCH .6978START BDACSV  KEY > LLAVE-BDACSV6979INVALID KEY6980MOVE 1 TO FIN-BDAMATCH6981NOT INVALID KEY6982READ BDACSV IGNORE LOCK NEXT RECORD6983    AT END6984        MOVE 1 TO FIN-BDAMATCH6985 END-READ6986END-START.6987 PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =6988                          NUM-IDE-INPUT-BDAMATCH  OR6989      TIPO-ID-BDACSV  NOT =6990                          TIP-IDE-INPUT6991 MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD026992 READ SUSCRIPTOR IGNORE LOCK6993 INVALID KEY6994 MOVE 0 TO PROCESAR-BDAMATCH6995 NOT INVALID KEY6996  MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004      6997 END-READ6998 IF PROCESAR-BDAMATCH = 1                 RMB0004      6999IF ESTADO-ABD02 = 1            RMB0004      7000 IF IND-BLOQUEO-BDACSV <> "B"RMB0004      7001MOVE 1 TO PROCESAR-BDAMATCHRMB0004      7002IF FUENTE-REG-BDACSV <= 01                   RMB0004      7003PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004      7004LSE  RMB0004      7005   PERFORM 1100-LLENAR-AUX-BDAMATCH RMB0004      7006END-IF                                           RMB0004      7007ELSE                                    RMB0004      70080 TO PROCESAR-BDAMATCH                      RMB0004    MOVE 0 TO IDE-TIPO-BDAMATCH18 COPY BDAMATCH.PROC.19**recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS      20* BDAMATCH.PROC.v.000521******************************************************************22* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH23* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO24* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR25* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS26* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.27********************************************************************28* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*29* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*30* R.MARTINEZ  *          10 POSICIONES DE LAS MISMA*31******************************************************************32* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE33* R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL34*   *        MEJOR PORTAFOLIO35* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH36*   *           NUM-CTAS-OUTPUT-BDAMATCH37**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN38**        BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE39**   DE FRENADAS40*****************************************************************41* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *42* R-MARTINEZ. *          DEL PORTAFOLIO .                   *43* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *44** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV  *45** FUEN01 - NCLUIR  FUENTES EXTERNAS           *46*      * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*47*      * LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*48*   * NOMB01 - MAQUILLAR EL NOMBRE*49** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *50*   *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2*51*****************************************************************52* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *53* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*54* 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *6955**          DECUENTA DE LA MISMA CUENTA*6956*****************************************************************69576958 1000-U-RECORRER-CSV-BDAMATCH.6959******************************************************************6960*1000-U-RECORRER-CSV-BDAMATCH.6961* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION6962* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL6963* MATCH63* MATCH64******************************************************************65     MOVE 0 TO IDE-TIPO-BDAMATCH66     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .                     RMB0003    67     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                         RMB0003    68     MOVE 0 TO MAX-CUENTAS-BDAMATCH.69     IF ABIERTO-BDAMATCH  = 070        OPEN INPUT  BDACSV71        MOVE 1 TO ABIERTO-BDAMATCH72     END-IF.73     INITIALIZE LLAVE-BDACSV.74     MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .75     MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .76     MOVE 0 TO FIN-BDAMATCH .77     MOVE 0 TO PROCESAR-BDAMATCH .78     START BDACSV  KEY > LLAVE-BDACSV79 INVALID KEY80              MOVE 1 TO FIN-BDAMATCH81 NOT INVALID KEY82 READ BDACSV IGNORE LOCK NEXT RECORD83    AT END84  MOVE 1 TO FIN-BDAMATCH85              END-READ86     END-START.87     PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =88                                      NUM-IDE-INPUT-BDAMATCH  OR89                         TIPO-ID-BDACSV  NOT =90                         TIP-IDE-INPUT-BDAMATCH91 MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD0292 READ SUSCRIPTOR IGNORE LOCK93 INVALID KEY94 MOVE 0 TO PROCESAR-BDAMATCH95 NOT INVALID KEY96              MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004    97        END-READ98        IF PROCESAR-BDAMATCH = 1                                  RMB0004    99           IF ESTADO-ABD02 = 1                                    RMB0004      7000 IF IND-BLOQUEO-BDACSV <> "B"            RMB0004      7001                 MOVE 1 TO PROCESAR-BDAMATCH                      RMB0004      7002IF FUENTE-REG-BDACSV <= 01RMB0004      7003                    PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004      7004                 ELSE                                             RMB0004      7005                    PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004      7006                 END-IF                                      RMB0004      7007              ELSE                                                RMB0004      7008       MOVE 0 TO PROCESAR-BDAMATCHRMB0004    MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO MAX-CUENTAS-BDAMATCH.MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0IF ABIERTO-BDAMATCH  = 0INITIALIZE LLAVE-BDACSV.INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVSTART BDACSV  KEY > LLAVE-BDACSVREAD BDACSV IGNORE LOCK NEXT RECORDREAD BDACSV IGNORE LOCK NEXT RECORDEND-START.END-START.PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =PERFORM UNTIL FIN-BDAMAQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsFIN-BDAMATCH<W-S>0 :   FIN-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   FIN-BDAMATCH  = 1 OR   NU                   TIAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   TCH  = 1 OR NQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUM-ID-BDACSV<W-S>000000000341054     OR:   NUM-ID-BDACSV<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NUM-ID-BDACSV  NOT =M-IDE-INPUT-BDAMATCH  ORPO-ID-BDACSV  NOT =AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   U
Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUM-IDE-INPUT-BDAMATCH<W-S>00000262135         :   NUM-IDE-INPUT-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NUM-IDE-INPUT-BDAMATCH  ORTIPO-ID-BDACSV  NOT =TIP-IDE-INPUT-BDAMATCHAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =7025        END-IFRMB0004      7026     END-PERFORM.7027IF MAX-CUENTAS-BDAMATCH > 07028   IF APELLIDO-INPUT-BDAMATCH <> SPACES AND4      7029      MAX-CUENTAS-BDAMATCH > 1      4      7030      PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004      7031      PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004      7032   PERFORM 1200-PROC-REG-CSV-BDAMATCHRMB0004      7033END-IF                    RMB0004      7034   PERFORM 9000-U-REALIZAR-BDAMATCH7035   IF NOM-OUTPUTMATCH <> SPACES ANDRMB0004      7036      (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)         RMB0004      7037      MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004      7038      PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004      7039      MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004      7040   END-IF                       RMB0004      7041IF NOM-OUTPUT-BDAMATCH <> SPACES7042MOVE 1 TO IDE-TIPO-BDAMATCH7043END-IF7044END-IF.7045 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004      7046MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQRMB0004      7047MOVE 0 TO I-MAQ  RMB0004      7048INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004      7049        INITIAL "Y/O"                                  RMB0004      7050OR"Y\O"                            RMB0004      7051OR" Y/OTRO "                     RMB0004      7052OR" Y/OTRA "                      RMB0004      7053     OR      " Y\OTRO "                 RMB0004      7054     OR      " Y\OTRA "    RMB0004      7055  OR      " Y OTRO "RMB0004      7056OR      " Y OTRA "          RMB0004      7057IF I-MAQ < 45 AND I-MAQ > 2RMB0004      7058ADD 1 TO I-MAQ                         7059MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004      7060ELSE                             7061IF I-MAQ < 45             62ADD 1 TO I-MAQ                     63MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)    64END-IF                                 65END-IF                                           66MOVE 0 TO SW-BORRAR-MAQ    67MOVE 1 TO I-MAQ.                                   68PERFORM UNTIL I-MAQ > 45    69MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ    70IF TILDE-MAQ                             IF MAX-CUENTAS-BDAMATCH > 04271D     " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272        PERFORM 1000-U-RECORRER-CSV-BDAMATCH4273D        display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4274D     " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4275D  " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4276D  " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4277  MOVE 1 TO HACERMATCH-LEEMSTRS4278  IF IDE-TIPO-BDAMATCH = 14279         IF TIPOID-E = 1 OR 44280             INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL4281             "," BY " ", ";" BY " "4282      END-IF4283      MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM4284      MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM4285      MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM4286         MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4287         PERFORM 10000-MATCH-NOMBRES-VALNOM4288D      display "10000-MATCH-NOMBRES-VALNOM"4289D        display "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM4290D       " " NOM-OUTPUT-BDAMATCH4291                 IF MATCH-OK-OUT-VALNOM = 14292                MOVE 1 TO IDE-TIPO-BDAMATCH4293            ELSE4294               IF W-BLOQUES > 04295           MOVE 0 TO IDE-TIPO-BDAMATCH4296  END-IF4297    END-IF4298END-IF42994300IF IDE-TIPO-BDAMATCH = 14301    MOVE TIPOID-E TO TIP-VAL4302    MOVE NUMID-E TO CED-VAL4303            MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA4304         PERFORM 9800-FILTRAR-ALFABETICO4305         MOVE CADENA-SALE TO  NOM-VAL4306    MOVE ZEROS TO FEC-EXP-VAL4307         MOVE SPACES TO MUN-EXP-VAL4308      MOVE SPACES TO DEP-EXP-VAL4309      MOVE SPACES TO VIG-VAL4310         MOVE SPACES TO GENERO-VAL4311      MOVE SPACES TO EDAD-VAL4312            MOVE SPACES TO EDAD-RANGO4313            ADD 1 TO SI-EXISTE-CSV4314        END-IF4315  END-IF4316END-IF.


      


      


      display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSMOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1END-IFEND-IFEND-IF.END-IF.3548*valida si la identificación está en la base de datos alterna3549PERFORM 513-VALIDA-EN-CSV3550 IF IDE-TIPO-BDAMATCH = 03551 IF TIP-IDE-BDIIVIDE = 13552*es una cédula3553 MOVE 04 TO CODIGO-ERROR3554else3555*no es una cédula3556MOVE 03 TO CODIGO-ERROR3557END-IF3558END-IF.355935603561 4300-MODIFICAR-BDIIALE.3562Ddisplay "4300-MODIFICAR-BDIIALE"3563******************************************************************3564* Se impacta el archivo BDIIALE con una o dos inserciones,3565* modificaciones o eliminaciones segun haya o no demandas y3566* embargos3567******************************************************************3568initialize REG-BDIIALE35693570*si hay demandas3571if JURAD-demandas-vigentes > zero3572or JURAD-demandas-terminadas > zero3573move "J001" to LLASEC-BDIIALE3574*arma datos de demandas3575move JURAD-demandas-vigentes to D-vigentes3576move JURAD-demandas-terminadas to D-terminados3577string "20" JURAD-demandas-fecha-ultima3578delimited size into D-fecha-ultima3579perform 4300-MODIFICAR-BDIIALE-DATOS3580end-if.35813582*si hay embargos3583if JURAD-embargos-vigentes > zero3584or JURAD-embargos-terminados > zero3585move "J002" to LLASEC-BDIIALE3586*arma datos de embargos3587move JURAD-embargos-vigentes to D-vigentes3588move JURAD-embargos-terminados to D-terminados3589string "20" JURAD-embargos-fecha-ultimo3590delimited size into D-fecha-ultima3591perform 4300-MODIFICAR-BDIIALE-DATOS3592end-if.3593IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1MOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERROREND-IF.END-IF.321si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325 perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347Numero de identificacion348if JURAD-id-numeroX is not numeric349call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356tipo-novedad = "E"357    exit paragraph358end-if359Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR861862 4900-GRABAR-ERROR.863Ddisplay "4900-GRABAR-ERROR"864******************************************************************865* El registro de JURAD tiene error: se graba en el archivo ERRS866* con indicacion del error detectado867******************************************************************86move JURAD-reg to ERRS-reg86move E-errores-reg to ERRS-causa-rechazo870*lista de los codigos de los errores del registro871 move E-errores-reg to ERRS-causa-rechazo87write ERRS-reg87evaluate ERRS-fs87when "00"87continue87when other877             display "Error al grabar el archivo de errores "878         display "Nombre del archivo: " ERRS-file-name879             display "File status: " ERRS-fs880             perform 9000-CANCELAR-PROGRAMA881             goback882 end-evaluate.883884885 4320-ARMAR-TEXTO-ALERTA.886Ddisplay "4320-ARMAR-TEXTO-ALERTA"887****************************************************************888* Hace el reemplazo de los valores adecuados en los templates889* de las linea de alerta que corresponde890****************************************************************891*segun se trate de demandas o embargos89if JURAD-demandas-vigentes not = 089or JURAD-demandas-terminadas not = 0894     set LAx to 1895     move high-values to LA-valores89    move JURAD-demandas-vigentes to LA-num897* >>>> esto esta anulado x que no se como hacer para que lo compile898*    unstring LA-numX into LA-descarte LA-valor(1)89    delimited by all space90    move LA-numx(9:12) to LA-valor(1)90move JURAD-demandas-terminadas to LA-num902* >>>> esto esta anulado x que no se como hacer para que lo compile90    unstring LA-numX into LA-descarte LA-valor(2)904*    delimited by all space90move LA-numx(9:12) to LA-valor(2)906
      
      
      display "4900-GRABAR-ERROR"move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fscontinuecontinueend-evaluate.end-evaluate.323if E-hay-error = "SI"324         perform 4900-GRABAR-ERROR325     perform 4240-CONTAR-TIPO-CUENTA326         exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345move 05 to codigo-error346end-if347*    Numero de identificacion348 if JURAD-id-numeroX is not numeric349         call "PONERR" using "03" JURAD-reg E-errores350     end-if351     if JURAD-id-numero not > 0352         call "PONERR" using "04" JURAD-reg E-errores353 end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361 call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364     if JURAD-demandas-vigentes is not numeric365 call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numericperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide51402=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*    cuenta tipo 7: 03 04 05524525 IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526    ADD 1 TO W-CONT-TIPO-6527ELSE528IF CODIGO-ERROR = 03 OR 04 OR 05529        ADD 1 TO W-CONT-TIPO-7530     ELSE531*        registros correctos, repetidos o no532    ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534        IF TIPOID-E = 2 OR 3535        ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537     END-IF538 END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546 MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548*valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550 IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7END-IF.END-IF.324perform 4900-GRABAR-ERROR325         perform 4240-CONTAR-TIPO-CUENTA326     exit paragraph327     end-if328329 perform 4240-CONTAR-TIPO-CUENTA330331intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333 add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349 call "PONERR" using "03" JURAD-reg E-errores350end-if351 if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361         call "PONERR" using "05" JURAD-reg E-errores362     end-if363*    Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numeric369call "PONERR" using "07" JURAD-reg E-erroresexit paragraph264*controla el reg y lo aplica si es OK26000-PROCESAR-REGISTRO-226move JURAD-reg to JURAD-reg-anterior26    add 1 to REG-LEIDOS26when "10"269*    fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes27    de que se terminara el archivo27    display "Falta el reg de totales del archivo JURAD "27    display "Nombre del archivo: " P-file-name27display "File status: " JURAD-fs27display "Ultimo registro leido: " N-reg-leidos27display JURAD-reg-anterior277         perform 9000-CANCELAR-PROGRAMA278 when other279*        error de lectura: cancelacion del proceso280         display "Error en lectura del archivo JURAD "281         display "Nombre del archivo: " P-file-name282     display "File status: " JURAD-fs28    display "Ultimo registro leido: " N-reg-leidos28display JURAD-reg-anterior28perform 9000-CANCELAR-PROGRAMA28evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************29move "NO" to E-hay-error297298*validacion del tipo de movimiento299 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"0    call "PONERR" using "01" JURAD-reg E-errores0end-if020si es el registro "T" hay que señalar el fin de proceso0tipo-novedad = "T"0move "SI" to IND-fin-proceso0    perform 4800-PROCESO-REG-T07     exit paragraph0end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************

         

         

         

         display "4000-PROCESAR-REGISTRO"read JURADread JURADevaluate JURAD-fsevaluate JURAD-fsdisplay " "

         

         

         display " "display " "

         

         

         display " "display JURAD-reg

         

         

         display JURAD-regperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2display "4000-PROCESAR-REGISTRO-2"   

         

         

         display "4000-PROCESAR-REGISTRO-2"   94* La informacion esta leida en JURAD-reg95****************************************************************96 move "NO" to E-hay-error9798*    validacion del tip movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305 move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313 move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323 if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339**move "NO" to E-hay-errorif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"add 1 to N-reg-leidosadd 1 to N-reg-leidosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressjurad-reg.                                                                    


























 




perform 4100-VALIDACION-FORMALif E-hay-error = "SI"    perform 4900-GRABAR-ERROR    perform 4240-CONTAR-TIPO-CUENTAJURAD-REG<W-S>I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406:   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    perform 4100-VALIDACION-FORMAL if E-hay-error = "SI"     perform 4900-GRABAR-ERROR     perform 4240-CONTAR-TIPO-CUENTAAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Perform-level      Exit View

      

      

      perform 4100-VALIDACION-FORMALif E-hay-error = "SI"AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if EQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsE-HAY-ERROR<W-S>NO                :   E-HAY-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   E-hay-error = "SI" perform 4900-GRABAR perform 4240-CONTARAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if E-hay-error = "SI"perform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICA396397 4200-VALIDACION-SEMANTICA.398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403move JURAD-id-tipo to TIP-IDE-BDIIVIDE404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R405 move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414     MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419del nombre reportado420*Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423 if SW-ID-BDIIVIDE = 1424*    es un id inválido425    call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna42710-VALIDACION-ID-NO-FIGURA428else429*    existe id, a ver si el nombre coincide430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432display "novedad:  " JURAD-nombre433         display "registro: " NOM-LEIDO-BDIIVIDE434*        validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439     end-if.440441   

         

         

         move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDEperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF SW-ASGTIPID-BDIIVIDE = 1FAC0002    IF SW-ASGTIPID-BDIIVIDE = 1FAC0002    IF SW-VALTIPID-BDIIVIDE = 1FAC0002    IF SW-VALTIPID-BDIIVIDE = 1FAC0002    IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004    IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004    IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004    IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004    PERFORM 80200-VALIDAR-IDPERFORM 80200-VALIDAR-ID439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULA546*Arma el nombre completo en una sola variable547=============================548MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI549MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI550READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE551END-READ552IF SW-ID-BDIIVIDE = 0553 MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE554MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE555 MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE556MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE557 IF ESTADO-CIVIL-BDIIREGI = 0558   STRING559        SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",560"*" DELIMITED BY SIZE ,561             PRIMER-NOMBRE-BDIIVIDEDELIMITED BY "  ",562             "*" DELIMITED BY SIZE ,563             SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,564             ";" DELIMITED BY SIZE ,565             INTO NOM-LEIDO-BDIIVIDE566         END-IF567     IF ESTADO-CIVIL-BDIIREGI = 1568         STRING569       "DE" DELIMITED BY SIZE,570    "*"  DELIMITED BY SIZE,571    SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",572    "*"  DELIMITED BY SIZE,573    PRIMER-NOMBRDELIMITED BY "  ",574       "*"  DELIMITED BY SIZE,575     SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,576  ";"  DELIMITED BY SIZE,577  INTO NOM-LEIDO-BDIIVIDE578END-IF579IF ESTADO-CIVIL-BDIIREGI = 2580  STRING581 "VDA DE" DELIMITED BY SIZE,582 "*"      DELIMITED BY SIZE,583   SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",584     "*"DELIMITED BY SIZE,585   PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",586"*"      DELIMITED BY SIZE,587SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,588";"      DELIMITED BY SIZE,589INTO NOM-LEIDO-BDIIVIDE590END-IF591STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEYREAD BDIIREGI INVALID KEYMOVE 1 TO SW-ID-BDIIVIDEMOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409     MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410  MOVE NOM-VALVIDENOMBOK-INPUT-VALNOM411  IF SW-ID-BDIIVIDE = 0412     IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413        NUM-BLOQUES-BDIIVIDE <> ZEROS414        MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415 ELSE IF TIP-ID-INPUT-VALNOM = 1416        MOVE 2 TO BLOQUES-INPUT-VALNOM417     ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418     END-IF419END-IF420PERFORM 10000-MATCH-NOMBRES-VALNOM421IF MATCH-OK-OUT-VALNOM = 0422   MOVE 1 TO SW-NOMBRES-BDIIVIDE423    END-IF424 END-IF425END-IF426ELSE IF SW-TID-BDIIVIDE = 1   FAC0002      4427 MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IF                                        FAC0002      4429END-IF                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE431END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443PERFORM 85010-UBICA-CEDULA444WHEN 2445PERFORM 85020-UBICA-NIT446WHEN 3447PERFORM 85020-UBICA-NIT448WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0END-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*  es un id inválido3425  call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448 IF TIP-IDE-BDIIVIDE = 13449*        es una cédula3450MOVE 02 TO CODIGO-ERROR3451     ELSE3452*        no es una cédula3453         MOVE 01 TO CODIGO-ERROR3454     END-IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*nombre coincide: busca ID en BDIIALE3463initialize LLAVE-BDIIALE3464move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1call "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores10053 00.
10054marca al reg actual como erroneo10055move "SI" to E-hay-error1005610057*cuenta y muestra el registro de input10058 if reg-input not = reg-input-anterior10059add 1 to E-cont-regs-con-error10060    display " "10061 display reg-input10062move reg-input to reg-input-anterior10063move spaces to E-errores-reg10064move 2 to errIndex10065end-if1006610067*contabiliza el error en la tabla de errores10068set Ex to 110069search E-error varying Ex10070at end10071    display "--- falla en la tabla de errores ---" cod-error10072when E-codigo(Ex) = "00"10073add 1 to E-contador(Ex)10074         display "--- error tipo exotico: " cod-error10075     add 1 to E-contador(Ex)10076     when E-codigo(Ex) = cod-error10077         add 1 to E-contador(Ex)10078         display "Error " cod-error " " E-descripcion(Ex)10079 end-search1008010081agrega a la lista de errores del registro10082if errIndex < (300 - 59 - 3)10083    move cod-error to E-errores-reg(errIndex:2)10084 add 3 to errIndex10085move E-descripcion(Ex) to E-errores-reg(errIndex:59)10086    add 59 to errIndex10087end-if1008810089     exit program.100901009110092 end program PONERR.1009310094 end program CARGAJUR.1009510096******************************************************************10097******************************************************************10098move "SI" to E-hay-errorif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "


      


      


      display " "display reg-input


      


      


      display reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-ifset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exadd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)


      


      


      display "Error " cod-error " " E-descripcion(Ex)if errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsERRINDEX<W-S>00005          x:   ERRINDEX<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   errIndex < (300 - move cod-error t add 3 to errIndexAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program. 3425    call "PONERR" using "14" JURAD-reg E-errores
 3426    valida contra la base alterna 3427    perform 4210-VALIDACION-ID-NO-FIGURA 3428else 3429    existe id, a ver si el nombre coincide 3430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide 3431    call "PONERR" using "15" JURAD-reg E-errores 3432    display "novedad:  " JURAD-nombre 3433    display "registro: " NOM-LEIDO-BDIIVIDE 3434*    validación en base alterna 3435    perform 4220-VALIDA-NOMBRE-NO-COINCIDE 3436else 3437        perform 4222-VALIDA-NOMBRE-COINCIDE 3438end-if 3439 end-if. 3440 3441 3442 4220-VALIDA-NOMBRE-NO-COINCIDE. 3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE" 3444****************************************************************** 3445* Validación de IDs que figuran OK pero el nombre no coincide 3446****************************************************************** 3447*nombre no coincide 3448IF TIP-IDE-BDIIVIDE = 1 3449*es una cédula 3450MOVE 02 TO CODIGO-ERROR 3451ELSE 3452*no es una cédula 3453     MOVE 01 TO CODIGO-ERROR 3454END-IF. 3455 3456 3457 4222-VALIDA-NOMBRE-COINCIDE. 3458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE" 3459****************************************************************** 3460* Validación de IDs que figuran OK pero el nombre coincide 3461****************************************************************** 3462*nombre coincide: busca ID en BDIIALE 3463initialize LLAVE-BDIIALE 3464     move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE 3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE 3466     move 990003 to FUENTE-BDIIALE 3467start BDIIALE key not < LLAVE-BDIIALE INVALID KEY 3468         move 1 TO SW-BDIIALE 3469     not invalid key 3470move 0 to SW-BDIIALEperform 4210-VALIDACION-ID-NO-FIGURA540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548*valida si la identificación está en la base de datos alterna549 PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551IF TIP-IDE-BDIIVIDE = 1552*es una cédula553    MOVE 04 TO CODIGO-ERROR554    else555*no es una cédula556MOVE 03 TO CODIGO-ERROR557         END-IF558 END-IF.559560561 4300-MODIFICAR-BDIIALE.562Ddisplay "4300-MODIFICAR-BDIIALE"563******************************************************************564* Se impacta el archivo BDIIALE con una o dos inserciones,565* modificaciones o eliminaciones segun haya o no demandas y566* embargos567******************************************************************568initialize REG-BDIIALE569570*si hay demandas571if JURAD-demandas-vigentes > zero572     or JURAD-demandas-terminadas > zero573     move "J001" to LLASEC-BDIIALE574*        arma datos de demandas575         move JURAD-demandas-vigentes to D-vigentes576         move JURAD-demandas-terminadas to D-terminados577     string "20" JURAD-demandas-fecha-ultima578    delimited size into D-fecha-ultima579    perform 4300-MODIFICAR-BDIIALE-DATOS580end-if.581582*i hay embargos583if JURAD-embargos-vigentes > zero584or JURAD-embargos-terminados > zero585"J002" to LLASEC-BDIIALE
      
      
      display "4210-VALIDACION-ID-NO-FIGURA"MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCHPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSV42274228 513-VALIDA-EN-CSV.4229display "513-VALIDA-EN-CSV"                                               4230D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E4231**************************************************************4232* Valida si la identificación está en la base de datos alterna4233**************************************************************4234*hace validacion de tipo de identificacion4235 MOVE TIPOID-E TO TIP-IDE-BDIIVIDE4236MOVE NUMID-E TO NUM-IDE-BDIIVIDE4237*retorna SW-TID-BDIIVIDE=0 si el num id no está dentro4238*del rango que corresponde al tipo de id4239 display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4240" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4242 PERFORM 80400-VALIDAR-TIPO-ID4243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE4244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE4245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE4246IF SW-TID-BDIIVIDE = 04247*el tipo de id es OK4248D        display "el n° de ID está dentro de su rango"4249     IF HACER-MATCH = ZEROS4250*            abre archivos y carga la tabla de direcciones4251*            estandar, solo la primera vez4252             IF OPEN-DIR = ZEROS4253D         display "carga tabla DIRESTAN"4254                 OPEN INPUT MAESTRO-DIRECC4255            OPEN INPUT BDLCLI4256OPEN INPUT SUSCRIPTOR4257             OPEN INPUT MAESTRO-CREDIT4258            OPEN INPUT MAESTRO-CHECK4259            PERFORM 06000-U-CARGAR-TABLA-DIRESTAN4260        MOVE 1 TO OPEN-DIR4261     END-IF4262*    abre archivos y carga la tabla de direcciones4263    MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH4264    MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH4265*    Se recorre toda la estructura bdacsv para la identificacion       4266*    buscada. En caso de hallar registros se procede a realizar el     4267*        match4268Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4269D        " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4270D        " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4271D        " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272    PERFORM 1000-U-RECORRER-CSV-BDAMATCH   


        
         


        
         display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E   


        
         


        
         


        
      display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-EMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE   


        
         


        
         


        
      display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-ID492*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002      4493*================================================================494    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE                         FAC0002      4495    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4496    EVALUATE TIP-IDE-BDIIVIDE                                 FAC0002      4497      WHEN 1                                                  FAC0002      4498       IF NUM-IDE-BDIIVIDE-R > 9999999999                     FAC0002      4499      MOVE 1 TO SW-TID-BDIIVIDE           FAC0002      4500  END-IF                         FAC0002      4501 WHEN 2                         FAC0002      4502   IF NUM-IDE-BDIIVIDE-R >  9999999999 OR             FAC006C      4503      (NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005      4504     MOVE 1 TO SW-TID-BDIIVIDE                     FAC0002      4505  END-IF                          FAC0002      4506 WHEN 3                                                FAC0002      4507  IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005      4508     MOVE 1 TO SW-TID-BDIIVIDE                     FAC0002      4509  END-IF                          FAC0002      4510END-EVALUATE.                                           FAC0002      4511512 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004      4513*================================================================514*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004      4515*Elimina el digito de chequeo y cambia el tipo de identificacion516*de acuerdo a los rangos para tipo id = 2 y 3517*================================================================518 IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND  FAC0004      4519NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005      4520(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004      4521NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005      4522MOVE 3 TO TIP-IDE-BDIIVIDE      FAC0004      4523END-IF                        FAC0004      4524IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND         FAC0004      4525NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005      4526(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004      4527 NUM-IDE-BDIIVIDE-R  <= 9999999999)               FAC0005      4528MOVE 2 TO TIP-IDE-BDIIVIDE                FAC0004      4529END-IF                                        FAC0004      4530 IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004      4531 (NUM-IDE-BDIIVIDE-R >= 10000000000) OR                   FAC0004      4532 (NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004      4533 NUM-IDE-BDIIVIDE-R <= 9999999999)) OR             FAC0005      4534 (TIP-IDE-BDIIVIDE = 3 AND                                FAC0004      4535 (NUM-IDE-BDIIVIDE-R >= 6000000000 AND           FAC0004      4536 NUM-IDE-BDIIVIDE-R <  8000000000))     FAC0005      4537MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002    EVALUATE TIP-IDE-BDIIVIDEFAC0002    EVALUATE TIP-IDE-BDIIVIDEFAC0002    IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002    IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002    241     " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE242     PERFORM 80400-VALIDAR-TIPO-ID243 display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE244 " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE245 " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE246IF SW-TID-BDIIVIDE = 0247*  el tipo de id es OK248Ddisplay "el n° de ID está dentro de su rango"249  IF HACER-MATCH = ZEROS250*       abre archivos y carga la tabla de direcciones251*      estandar, solo la primera vez252   IF OPEN-DIR = ZEROS253D       display "carga tabla DIRESTAN"254      OPEN INPUT MAESTRO-DIRECC255      OPEN INPUT BDLCLI256          OPEN INPUT SUSCRIPTOR257       OPEN INPUT MAESTRO-CREDIT258      OPEN INPUT MAESTRO-CHECK259             PERFORM 06000-U-CARGAR-TABLA-DIRESTAN260MOVE 1 TO OPEN-DIR261             END-IF262*            abre archivos y carga la tabla de direcciones263             MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH264             MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH265*            Se recorre toda la estructura bdacsv para la identificacion       4266*            buscada. En caso de hallar registros se procede a realizar el     4267*       match268D    display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH269D    " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH270D   " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH271D   " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH272       PERFORM 1000-U-RECORRER-CSV-BDAMATCH273D       display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH274D    " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH275D    " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH276D    " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH277   MOVE 1 TO HACERMATCH-LEEMSTRS278       IF IDE-TIPO-BDAMATCH = 1279           IF TIPOID-E = 1 OR 4280            INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL281            "," BY " ", ";" BY " "282       END-IF283        MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM284        MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM285       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM286       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
        

      
        

      
        

      display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0display "el n° de ID está dentro de su rango"
        

      
        

      
        

      display "el n° de ID está dentro de su rango"IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROSIF OPEN-DIR = ZEROSMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHdisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
        

      
        

      
        

      display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH6963* MATCH6964******************************************************************6965MOVE 0 TO IDE-TIPO-BDAMATCH6966MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003      6967MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                   RMB0003      6968MOVE 0 TO MAX-CUENTAS-BDAMATCH.6969 IF ABIERTO-BDAMATCH  = 06970 OPEN INPUT  BDACSV6971MOVE 1 TO ABIERTO-BDAMATCH6972 END-IF.6973 INITIALIZE LLAVE-BDACSV.6974MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .6975 MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .6976MOVE 0 TO FIN-BDAMATCH .6977MOVE 0 TO PROCESAR-BDAMATCH .6978START BDACSV  KEY > LLAVE-BDACSV6979INVALID KEY6980MOVE 1 TO FIN-BDAMATCH6981NOT INVALID KEY6982READ BDACSV IGNORE LOCK NEXT RECORD6983    AT END6984        MOVE 1 TO FIN-BDAMATCH6985 END-READ6986END-START.6987 PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =6988                          NUM-IDE-INPUT-BDAMATCH  OR6989      TIPO-ID-BDACSV  NOT =6990                          TIP-IDE-INPUT6991 MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD026992 READ SUSCRIPTOR IGNORE LOCK6993 INVALID KEY6994 MOVE 0 TO PROCESAR-BDAMATCH6995 NOT INVALID KEY6996  MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004      6997 END-READ6998 IF PROCESAR-BDAMATCH = 1                 RMB0004      6999IF ESTADO-ABD02 = 1            RMB0004      7000 IF IND-BLOQUEO-BDACSV <> "B"RMB0004      7001MOVE 1 TO PROCESAR-BDAMATCHRMB0004      7002IF FUENTE-REG-BDACSV <= 01                   RMB0004      7003PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004      7004LSE  RMB0004      7005   PERFORM 1100-LLENAR-AUX-BDAMATCH RMB0004      7006END-IF                                           RMB0004      7007ELSE                                    RMB0004      70080 TO PROCESAR-BDAMATCH                      RMB0004    MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO MAX-CUENTAS-BDAMATCH.MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0IF ABIERTO-BDAMATCH  = 0INITIALIZE LLAVE-BDACSV.INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVSTART BDACSV  KEY > LLAVE-BDACSVREAD BDACSV IGNORE LOCK NEXT RECORDREAD BDACSV IGNORE LOCK NEXT RECORDEND-START.
PERFORM UNTIL FIN-BQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsFIN-BDAMATCH<W-S>0 :   FIN-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   FIN-BDAMATCH  = 1 OR   NU                   TIAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   DAMATCH  = 1 OR NUMQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUM-ID-BDACSV<W-S>000000001974451     OR:   NUM-ID-BDACSV<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NUM-ID-BDACSV  NOT =M-IDE-INPUT-BDAMATCH  ORPO-ID-BDACSV  NOT =AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUM-IDE-INPUT-BDAMATCH<W-S>00000958212         :   NUM-IDE-INPUT-BDAMATCH<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NUM-IDE-INPUT-BDAMATCH  ORTIPO-ID-BDACSV  NOT =TIP-IDE-INPUT-BDAMATCHAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   END-START.PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =7025        END-IFRMB0004      7026     END-PERFORM.7027IF MAX-CUENTAS-BDAMATCH > 07028   IF APELLIDO-INPUT-BDAMATCH <> SPACES AND4      7029      MAX-CUENTAS-BDAMATCH > 1      4      7030      PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004      7031      PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004      7032   PERFORM 1200-PROC-REG-CSV-BDAMATCHRMB0004      7033END-IF                    RMB0004      7034   PERFORM 9000-U-REALIZAR-BDAMATCH7035   IF NOM-OUTPUTMATCH <> SPACES ANDRMB0004      7036      (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)         RMB0004      7037      MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004      7038      PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004      7039      MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004      7040   END-IF                       RMB0004      7041IF NOM-OUTPUT-BDAMATCH <> SPACES7042MOVE 1 TO IDE-TIPO-BDAMATCH7043END-IF7044END-IF.7045 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004      7046MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQRMB0004      7047MOVE 0 TO I-MAQ  RMB0004      7048INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004      7049        INITIAL "Y/O"                                  RMB0004      7050OR"Y\O"                            RMB0004      7051OR" Y/OTRO "                     RMB0004      7052OR" Y/OTRA "                      RMB0004      7053     OR      " Y\OTRO "                 RMB0004      7054     OR      " Y\OTRA "    RMB0004      7055  OR      " Y OTRO "RMB0004      7056OR      " Y OTRA "          RMB0004      7057IF I-MAQ < 45 AND I-MAQ > 2RMB0004      7058ADD 1 TO I-MAQ                         7059MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004      7060ELSE                             7061IF I-MAQ < 45             62ADD 1 TO I-MAQ                     63MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)    64END-IF                                 65END-IF                                           66MOVE 0 TO SW-BORRAR-MAQ    67MOVE 1 TO I-MAQ.                                   68PERFORM UNTIL I-MAQ > 45    69MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ    70IF TILDE-MAQ                             IF MAX-CUENTAS-BDAMATCH > 04271D     " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272        PERFORM 1000-U-RECORRER-CSV-BDAMATCH4273D        display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4274D     " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4275D  " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4276D  " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4277  MOVE 1 TO HACERMATCH-LEEMSTRS4278  IF IDE-TIPO-BDAMATCH = 14279         IF TIPOID-E = 1 OR 44280             INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL4281             "," BY " ", ";" BY " "4282      END-IF4283      MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM4284      MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM4285      MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM4286         MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4287         PERFORM 10000-MATCH-NOMBRES-VALNOM4288D      display "10000-MATCH-NOMBRES-VALNOM"4289D        display "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM4290D       " " NOM-OUTPUT-BDAMATCH4291                 IF MATCH-OK-OUT-VALNOM = 14292                MOVE 1 TO IDE-TIPO-BDAMATCH4293            ELSE4294               IF W-BLOQUES > 04295           MOVE 0 TO IDE-TIPO-BDAMATCH4296  END-IF4297    END-IF4298END-IF42994300IF IDE-TIPO-BDAMATCH = 14301    MOVE TIPOID-E TO TIP-VAL4302    MOVE NUMID-E TO CED-VAL4303            MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA4304         PERFORM 9800-FILTRAR-ALFABETICO4305         MOVE CADENA-SALE TO  NOM-VAL4306    MOVE ZEROS TO FEC-EXP-VAL4307         MOVE SPACES TO MUN-EXP-VAL4308      MOVE SPACES TO DEP-EXP-VAL4309      MOVE SPACES TO VIG-VAL4310         MOVE SPACES TO GENERO-VAL4311      MOVE SPACES TO EDAD-VAL4312            MOVE SPACES TO EDAD-RANGO4313            ADD 1 TO SI-EXISTE-CSV4314        END-IF4315  END-IF4316END-IF.


      


      


      display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSMOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1END-IFEND-IFEND-IF.END-IF.3548*valida si la identificación está en la base de datos alterna3549PERFORM 513-VALIDA-EN-CSV3550 IF IDE-TIPO-BDAMATCH = 03551 IF TIP-IDE-BDIIVIDE = 13552*es una cédula3553 MOVE 04 TO CODIGO-ERROR3554else3555*no es una cédula3556MOVE 03 TO CODIGO-ERROR3557END-IF3558END-IF.355935603561 4300-MODIFICAR-BDIIALE.3562Ddisplay "4300-MODIFICAR-BDIIALE"3563******************************************************************3564* Se impacta el archivo BDIIALE con una o dos inserciones,3565* modificaciones o eliminaciones segun haya o no demandas y3566* embargos3567******************************************************************3568initialize REG-BDIIALE35693570*si hay demandas3571if JURAD-demandas-vigentes > zero3572or JURAD-demandas-terminadas > zero3573move "J001" to LLASEC-BDIIALE3574*arma datos de demandas3575move JURAD-demandas-vigentes to D-vigentes3576move JURAD-demandas-terminadas to D-terminados3577string "20" JURAD-demandas-fecha-ultima3578delimited size into D-fecha-ultima3579perform 4300-MODIFICAR-BDIIALE-DATOS3580end-if.35813582*si hay embargos3583if JURAD-embargos-vigentes > zero3584or JURAD-embargos-terminados > zero3585move "J002" to LLASEC-BDIIALE3586*arma datos de embargos3587move JURAD-embargos-vigentes to D-vigentes3588move JURAD-embargos-terminados to D-terminados3589string "20" JURAD-embargos-fecha-ultimo3590delimited size into D-fecha-ultima3591perform 4300-MODIFICAR-BDIIALE-DATOS3592end-if.3593IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1MOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERROREND-IF.END-IF.321si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325 perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347Numero de identificacion348if JURAD-id-numeroX is not numeric349call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356tipo-novedad = "E"357    exit paragraph358end-if359Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4900-GRABAR-ERRORPerform-level      Exit View

      

      perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsW-CONT-TIPO-7<W-S>000002:   W-CONT-TIPO-7<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   W-CONT-TIPO-7 correctos, repetidos AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   ADD 1 TO W-CONT-TIPO-7END-IF.        ADD 1 TO W-CONT-TQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsW-CONT-TIPO-7<W-S>000003:   W-CONT-TIPO-7<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   W-CONT-TIPO-7 correctos, repetidos AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   END-IF.324perform 4900-GRABAR-ERROR325         perform 4240-CONTAR-TIPO-CUENTA326     exit paragraph327     end-if328329 perform 4240-CONTAR-TIPO-CUENTA330331intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333 add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349 call "PONERR" using "03" JURAD-reg E-errores350end-if351 if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361         call "PONERR" using "05" JURAD-reg E-errores362     end-if363*    Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numeric369call "PONERR" using "07" JURAD-reg E-erroresexit paragraph264*controla el reg y lo aplica si es OK26000-PROCESAR-REGISTRO-226move JURAD-reg to JURAD-reg-anterior26    add 1 to REG-LEIDOS26when "10"269*    fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes27    de que se terminara el archivo27    display "Falta el reg de totales del archivo JURAD "27    display "Nombre del archivo: " P-file-name27display "File status: " JURAD-fs27display "Ultimo registro leido: " N-reg-leidos27display JURAD-reg-anterior277         perform 9000-CANCELAR-PROGRAMA278 when other279*        error de lectura: cancelacion del proceso280         display "Error en lectura del archivo JURAD "281         display "Nombre del archivo: " P-file-name282     display "File status: " JURAD-fs28    display "Ultimo registro leido: " N-reg-leidos28display JURAD-reg-anterior28perform 9000-CANCELAR-PROGRAMA28evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************29move "NO" to E-hay-error297298*validacion del tipo de movimiento299 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"0    call "PONERR" using "01" JURAD-reg E-errores0end-if020si es el registro "T" hay que señalar el fin de proceso0tipo-novedad = "T"0move "SI" to IND-fin-proceso0    perform 4800-PROCESO-REG-T07     exit paragraph0end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************Zoom   Ctrl+C to stopI100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406

4000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA         0   0
         0   04000-PROCESAR-REGISTRO120406
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO      0   0
         0   04000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL2SEMANTICA
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO      0   0
         0   0100-VALIDACION-FORMAL
2SEMANTICA


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO2SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO"display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   display "4000-PROCESAR-REGISTRO-2"   95****************************************************************96     move "NO" to E-hay-error9798*    validacion del tipo de movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301     end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305    move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316 perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323if E-hay-error = "SI"324 perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input





Zoom   Ctrl+C to stop
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069      0   0
         0   0
   4000-PROCESAR-REGISTRO-2I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520   120406

Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2      0   0
         0   0
   4100-VALIDACION-FORMAL120406
Error 14 El numero de id no se encuentra en el archivo maestro

4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL   0   0
         0   0
   Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA

513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV

TIPOID-E:1 NUMID-E:00000262135SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000262135

SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069   0   0
         0   0
      Error    0   0
         0   0
      
13   0   0
         0   0
          0   0
         0   0
      Fecha ultimo embargo vigente YYYYMMDD: fuera de rangoTIPOID-E:1 NUMID-E:00000262135
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:


SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango

   0   0
         0   0
      4900-GRABAR-ERRORSALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR
   0   0
         0   0
      4000-PROCESAR-REGISTRO
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:


el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

   0   0
         0   0
      SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   0   0
         0   0
      
el n° de ID está dentro de su rango

BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTROel n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0

BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406  3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.3334333533363337 4100-VALIDACION-FORMAL.3338Ddisplay "4100-VALIDACION-FORMAL"3339******************************************************************3340* Validacion formal de los datos del inputZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop8889 4000-PROCESAR-REGISTRO-2.0Ddisplay "4000-PROCESAR-REGISTRO-2"                                      1****************************************************************2* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296 move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"0call "PONERR" using "01" JURAD-reg E-errores1203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05     move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07    exit paragraph08end-if090 add 1 to N-reg-leidos12*validacion formal de los datos13move 0 to codigo-error14 perform 4100-VALIDACION-FORMAL15if E-hay-error = "SI"16    perform 4900-GRABAR-ERROR17*240-CONTAR-TIPO-CUENTA18exit paragraph19end-if01*si la validacion formal dio OK se hace validacion semantica200-VALIDACION-SEMANTICA23if E-hay-error = "SI"24     perform 4900-GRABAR-ERROR25    perform 4240-CONTAR-TIPO-CUENTA26    exit paragraph27end-if2829perform 4240-CONTAR-TIPO-CUENTA01*intento de actualizacion de BDIIALE2     perform 4300-MODIFICAR-BDIIALE33     add 1 to N-reg-OK.Break-point encountered    display "4000-PROCESAR-REGISTRO-2"   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0

BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406   0   0
         0   0
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More                           display "4000-PROCESAR-REGISTRO-2"   move "NO" to E-hay-errormove "NO" to E-hay-errorif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"add 1 to N-reg-leidosadd 1 to N-reg-leidosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALPerform-level      Exit View                           perform 4100-VALIDACION-FORMALif E-hay-error = "SI"AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if EQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsE-HAY-ERROR<W-S>NO                :   E-HAY-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   E-hay-error = "SI" perform 4900-GRABAR perform 4240-CONTARAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0

4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   0004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020   000406Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:1 NUMID-E:00000958212SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   4404064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL   0
         0   0
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsE-HAY-ERROR<W-S>NO                :   E-HAY-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   E-hay-error = "SI" perform 4900-GRABAR perform 4240-CONTARAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if E-hay-error = "SI"perform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICA396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"     3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441   

         

         

         move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDEperform 80100-VALIDAR-IDENTIFICACIONBreak-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setperform 80100-VALIDAR-IDENTIFICACION                                    AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION    4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF SW-ASGTIPID-BDIIVIDE = 1FAC0002    IF SW-ASGTIPID-BDIIVIDE = 1FAC0002    IF SW-VALTIPID-BDIIVIDE = 1FAC0002    IF SW-VALTIPID-BDIIVIDE = 1FAC0002    IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004    IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004    IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004    IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004    PERFORM 80200-VALIDAR-IDBreak-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setPERFORM 80200-VALIDAR-ID                                              AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID    439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULA546*Arma el nombre completo en una sola variable547=============================548MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI549MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI550READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE551END-READ552IF SW-ID-BDIIVIDE = 0553 MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE554MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE555 MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE556MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE557 IF ESTADO-CIVIL-BDIIREGI = 0558   STRING559        SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",560"*" DELIMITED BY SIZE ,561             PRIMER-NOMBRE-BDIIVIDEDELIMITED BY "  ",562             "*" DELIMITED BY SIZE ,563             SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,564             ";" DELIMITED BY SIZE ,565             INTO NOM-LEIDO-BDIIVIDE566         END-IF567     IF ESTADO-CIVIL-BDIIREGI = 1568         STRING569       "DE" DELIMITED BY SIZE,570    "*"  DELIMITED BY SIZE,571    SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",572    "*"  DELIMITED BY SIZE,573    PRIMER-NOMBRDELIMITED BY "  ",574       "*"  DELIMITED BY SIZE,575     SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,576  ";"  DELIMITED BY SIZE,577  INTO NOM-LEIDO-BDIIVIDE578END-IF579IF ESTADO-CIVIL-BDIIREGI = 2580  STRING581 "VDA DE" DELIMITED BY SIZE,582 "*"      DELIMITED BY SIZE,583   SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",584     "*"DELIMITED BY SIZE,585   PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",586"*"      DELIMITED BY SIZE,587SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,588";"      DELIMITED BY SIZE,589INTO NOM-LEIDO-BDIIVIDE590END-IF591STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEYREAD BDIIREGI INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEIF ESTADO-CIVIL-BDIIREGI = 0IF ESTADO-CIVIL-BDIIREGI = 0STRINGSTRINGEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 2IF ESTADO-CIVIL-BDIIREGI = 2STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",95            INTO NOM-VAL-BDIIVIDE9697    INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "98    INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "99    INITIALIZE NOM-LEIDO-BDIIVIDE600    MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.601602 85020-UBICA-NIT.603*================================================================604*85020-UBICA-NIT.605*Ubica NIT en archivo de la DIAN, BDIIDIAN606*================================================================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622END-READ623IF SW-ID-BDIIVIDE = 0624MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"RMB0013      4628$IF HACERMATCH = "SI"                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                           RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                                            RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                    REGISTRO DIRECC .639*2017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640*                      ORDENAN DE ACUERDO A LO DEFINIDOINSPECT NOQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOM-VAL-BDIIVIDE<W-S>VARGAS*CABALLERO*JOAQUIN*               ;                             :   NOM-VAL-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "ZE NOM-LEIDO-BDIIVIDE-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEINSPECT NOM-VQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOM-VAL-BDIIVIDE<W-S>VARGAS CABALLERO JOAQUIN                                                             :   NOM-VAL-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "ZE NOM-LEIDO-BDIIVIDE-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   INITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407IF SW-VERIFNOM-BDIIVIDE = 1408 MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411          IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415        ELSE IF TIP-ID-INPUT-VALNOM = 1416                MOVE 2 TO BLOQUES-INPUT-VALNOM417        ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418             END-IF419     END-IF420        PERFORM 10000-MATCH-NOMBRES-VALNOM421IF MATCH-OK-OUT-VALNOM = 0422                MOVE 1 TO SW-NOMBRES-BDIIVIDE423             END-IF424          END-IF425       END-IF426      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002      4427         MOVE 1 TO SW-ID-BDIIVIDE      FAC0002      4428      END-IF                            FAC0002      4429 END-IF                                          FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE431END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441     EVALUATE TIP-IDE-BDIIVIDE442       WHEN 1443         PERFORM 85010-UBICA-CEDULA444   WHEN 2445     PERFORM 85020-UBICA-NIT446 WHEN 3447     PERFORM 85020-UBICA-NIT448 WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SWQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsSW-VERIFNOM-BDIIVIDE<W-S>1                          :   SW-VERIFNOM-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-MOVE NOMBRE-BDIIVIDE TO NOMBRAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNUM-BLOQUES-BDIIVIDE<W-S>AND2                          :   NUM-BLOQUES-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM9260*CON EL NOMBRE ENVIADO EN LA CONSULTA.9261******************************************************************9262MOVE 0 TO MATCH-OK-OUT-VALNOM.9263MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9264IF TIP-ID-INPUT-VALNOM  = 29265INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9266 " S.A. " BY "      ",                     RMB0002      9267 "." BY " ", " LTDA " BY "      ",          RMB0002      9268 " LIMITADA " BY "   ",RMB0002      9269" CIA " BY "     ", " COMPA/IA " BY "",RMB0002      9270" INVERSIONES " BY "             ",RMB0002      9271" EMPRESA " BY "         ",                            RMB0002      9272" CORPORACION " BY "             ",RMB0002      9273" DE " BY "    ", " LA " BY "    ", " DEL " BY "",RMB0002      9274" S " BY "   ", " A " BY "   "            RMB0002      9275" Y " BY "   "GJC0003      9276INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9277" S.A. " BY "      ",               RMB0002      9278"." BY " ", " LTDA " BY "      ",RMB0002      9279" LIMITADA " BY "          ",     RMB0002      9280" CIA " BY "", " COMPA/IA " BY "",RMB0002      9281 " INVERSIONES " BY "",RMB0002      9282    " EMPRESA " BY "",RMB0002      9283     " CORPORACION " BY "  ",RMB      9284" DE " BY "    ", " LA " BY "", " DEL " BY "",RMB      9285" S " BY "   ", " A " BY "   "RMB      9286     " Y " BY "   "GJ3      9287     INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9288       "." BY " ","-" BY " ",GJC0003      9289"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9290                "Y" BY "G","H" BY "G","I" BY "G"GJC0003      9291         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9292                "." BY " ","-" BY " ",GJC0003      9293                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9294                "Y" BY "G","H" BY "G","I" BY "G"       GJC0003      9295         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM9296     ELSE9297        INSPECT CADENA-VALNOM    REPLACING ALL9298            "." BY " ","-" BY " ", "," BY " ",9299         "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9300       "Y" BY "G","H" BY "G","I" BY "G",9301         " DE " BY ""," LA " BY "",9302       " DEL " BY "     "9303 INSPECT CADENA-VALNOMREPLACING ALLRMB0002      9304        "." BY " ","-" BY " ", "," BY " ",9305         "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002    MOVE 0 TO MATCH-OK-OUT-VALNOM.MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.IF TIP-ID-INPUT-VALNOM  = 2MOVE NOQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBRE-INPUT-VALNOM<W-S>JOAQUIN VARGAS CABALLERO                                                                   :   NOMBRE-INPUT-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.P-ID-INPUT-VALNOM  = 2NSPECT NOMBRE-AUX-VALNOM REPLACING ALL " S.A. " BY "      ",                                  AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF TIP-ID-INPUT-VALNOM  = 2INSPECT CADENA-VALNOMREPLACING ALL   Exit from animator ?  Yes/No/Detach   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
INSPECT CADENA-VALNOMREPLACING ALL95  MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM96     ELSE97   INSPECT CADENA-VALNOM    REPLACING ALL98            "." BY " ","-" BY " ", "," BY " ",99           "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",300       "Y" BY "G","H" BY "G","I" BY "G",301     " DE " BY "    "," LA " BY "",302     " DEL " BY "     "303INSPECT CADENA-VALNOMREPLACING ALL      9304      "." BY " ","-" BY " ", ",",305     "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      9306     "Y" BY "G","H" BY "G","I" BY "G",      9307     " DE " BY "    "," LA " BY "    ",      9308     " DEL " BY "     "                             9309     PERFORM VARYING I-VALNOM FROM 1 BY 1310             UNTIL I-VALNOM >= 66311         IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC312           AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC313          MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)314       END-IF315     END-PERFORM316END-IF.317MOVE SPACES TO VECTOR-INPUT-VALNOM.318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO319       BASURA-VALNOM320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)325VM-INPUT-VALNOM(14)326VM-INPUT-VALNOM(15)327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)328VM-INPUT-VALNOM(19)329VM-INPUT-VALNOM(20)330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.332IF TIP-ID-INPUT-VALNOM  NOT = 2333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL334 "." BY " ","-" BY " ","," BY " ",35CS","ZS","J"V" BY "B",36Y" BY "G","H" BY "G","I" BY "G"37PERFORM VARYING I-VALNOM FROM 1 BY 138                UNTIL I-VALNOM >= 6639 IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC40      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERICINSPECT CQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCADENA-VALNOM<W-S>A JOAQUIN VARGAS CABALLERO                                                                   :   CADENA-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CADENA-VALNOM    REPLACING ALL "." BY " ","-" BY " ", "," BY " ","C" BY "S","Z" BY "S","J" BY "G","V" BY "B","Y" BY "G","H" BY "G","I" BY "G",AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   INSPECT CADENA-VALNOMREPLACING ALLINSPECT CADENA-VALNOMREPLACING ALLRMB0002    INSPECT CADENA-VQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCADENA-VALNOM<W-S>    A GOAQUGN BARGAS SABALLERO                                                                            :   CADENA-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CADENA-VALNOM    REPLACING ALL                    RM     "." BY " ","-" BY " ", "," BY " ","C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RM    "Y" BY "G","H" BY "G","I" BY "G",                 RM    AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   INSPECT CADENA-VALNOMREPLACING ALLRMB0002    PERFORM VARYING I-VALNOM FROM 1 BY 1PERFORM VARYING I-VALNOM FROM 1 BY 1IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC      UNTIL I-VALNOM >= 6Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsI-VALNOM<W-S>00035          :   I-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   I-VALNOM >= 66VALNOM(I-VALNOM) -AUX-VALNOM(I-VALAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC      UNTIL I-VALNOMQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsI-VALNOM<W-S>00058          :   I-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   I-VALNOM >= 66VALNOM(I-VALNOM) -AUX-VALNOM(I-VALAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMEND-IF.END-IF.MOVE SPACES TO VECTOR-INPUT-VALNOM.MOVE SPACES TO VECTOR-INPUT-VALNOM.UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOUNSTRING CAQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCADENA-VALNOM<W-S>A GOAQUGN BARGAS SABALLERO                                                                          :   CADENA-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CADENA-VALNOM      DELIMITED BY ALL " " INTO    BASURA-VALNOM-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)-VALNOM(4) VM-INPUT-VALNOM(5)AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOMOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.


             BAQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsBASURA-VALNOM<W-S>A                   (5):   BASURA-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   BASURA-VALNOMNOM(1) VM-INPUT-VALNOMNOM(4) VM-INPUT-VALNOM(5)AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsVM-INPUT-VALNOM (1)<W-S>GOAQUGN                   :   VM-INPUT-VALNOM (1)<W-S>   clear F3=hex monitor F5/F6=up/down table   ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   VM-INPUT-VALNOM(1) VM-INPUT-VM-INPUT-VALNOM(4) VM-INPUT-VM-INPUT-VALNOM(6) VM-INPUT-AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.IF TIP-ID-INPUT-VALNOM  NOT = 2MOVE NOQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBOK-INPUT-VALNOM<W-S>VARGAS CABALLERO JOAQUIN                                                              :   NOMBOK-INPUT-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.P-ID-INPUT-VALNOM  NOT = 2SPECT NOMBRE-AUX-VALNOM REPLACING ALL       "." BY " ","-" BY " ","," BY " ",AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
IF TIP-ID-INPUT-VALNOM  NOT = 2INSPECT NOMBRE-AUX-VALNOM REPLACING ALLQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsTIP-ID-INPUT-VALNOM<W-S>01                        :   TIP-ID-INPUT-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   TIP-ID-INPUT-VALNOM  NOT = 2INSPECT NOMBRE-AUX-VALNOM RE         "." BY " ","-" BY "AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
INSPECT NOMBRE-AUX-VALNOM REPLACING ALLPERFORM VARYING I-VALNOM FROM 1 BY 1PERFORM VARYING I-VALNOM FROM 1 BY 1328VM-INPUT-VALNOM(19)329 VM-INPUT-VALNOM(20)330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.332IF TIP-ID-INPUT-VALNOM  NOT = 233INSPECT NOMBRE-AUX-VALNOM REPLACING ALL34 "." BY " ","-" BY " ","," BY " ",35C" BY "S","Z" BY "S","J" BY "G","V" BY "B",36        "Y" BY "G","H" BY "G","I" BY "G"37PERFORM VARYING I-VALNOM FROM 1 BY 138        UNTIL I-VALNOM >= 6639  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC40      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC41     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)42  END-IF43END-PERFORM44ELSE45INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002    46" S.A. " BY "      ",                          RMB0002    47"." BY " ", " LTDA " BY "",RMB0002    48" LIMITADA " BY "",RMB0002    49      " CIA " BY "", " COMPA/IA " BY "",RMB0002    50      " INVERSIONES " BY "         ",RMB0002    51      " EMPRESA " BY "   ",                    RMB0002    52" CORPORACION " BY "",RMB0002    53     " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002    54     " S " BY "   ", " A " BY "   "  RMB0002    55     " Y " BY "   "                                     GJC0003    56   INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002    57     " S.A. " BY "      ",                                  RMB0002    58     "." BY " ", " LTDA " BY "",RMB0002    59     " LIMITADA " BY "",RMB0002    60     " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002    61     " INVERSIONES " BY "",RMB0002    62     " EMPRESA " BY "",RMB0002    63           " CORPORACION " BY "             ",                    RMB0002    64      " DE " BY "    ", " LA " BY "    ", " DEL " BY "",RMB0002    65      " S " BY "   ", " A " BY "   "RMB0002    66   " Y " BY "   "                      GJC0003    67INSPECT NOMBRE-AUX-VALNOM REPLACING ALL   GJC0003    68. ","- ",                      GJC0003    69CS","ZS","J,"V" BY "B",GJC0003    70"Y" BY "G","H" BY "G","I" BY "G"    GJC0003    71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM72END-IF.73MOVE SPACES TO VECTOR-OK-VALNOM.PERFORM VARYING I-VALNOM FROM 1 BY 1IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsI-VALNOM<W-S>00043          :   I-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   I-VALNOM) NOT ALPLNOM(I-VALNOM) NO-AUX-VALNOM(I-VALAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsI-VALNOM<W-S>00064          :   I-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   I-VALNOM) NOT ALPLNOM(I-VALNOM) NO-AUX-VALNOM(I-VALAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMMOVE SPACES TO VECTOR-OK-VALNOM.MOVE SPACES TO VECTOR-OK-VALNOM.72END-IF.73MOVE SPACES TO VECTOR-OK-VALNOM.74     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO75             BASURA-VALNOM76 VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77VM-OK-VALNOM(4) VM-OK-VALNOM(5)78VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79VM-OK-VALNOM(9) VM-OK-VALNOM(10)80VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81VM-OK-VALNOM(14) VM-OK-VALNOM(15)82VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83VM-OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91 ADD 1 TO BLOQOK-AUX-VALNOM92 MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93            VM-INPUT-VALNOM(I-VALNOM)94 MOVE 21 TO J-VALNOM95ELSE96 MOVE 0 TO M-VALNOM97 INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98         FOR CHARACTERS BEFORE INITIAL "*"99 IF M-VALNOM >= 15400      MOVE 0 TO M-VALNOM401    INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)  GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411          PEDAZO-VALNOM(1:M-VALNOM) =412  VM-INPUT-VALNOM(I-VALNOM)413  ADD 1 TO BLOQOK-AUX-VALNOM414  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                  VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOM417             ADD 1 TO I-VALNOMUNSTRING CADQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCADENA-VALNOM<W-S>A BARGAS SABALLERO GOAQUGN                                                              :   CADENA-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CADENA-VALNOM      DELIMITED BY ALL " " INTO    BASURA-VALNOMLNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)LNOM(4) VM-OK-VALNOM(5)AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOMOVE 1 TO I-VALNOM.
MOVE 1 TO I-VALNOM.84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88 MOVE 1 TO J-VALNOM89 PERFORM UNTIL J-VALNOM > 2090   IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91      ADD 1 TO BLOQOK-AUX-VALNOM92      MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93                     VM-INPUT-VALNOM(I-VALNOM)94      MOVE 21 TO J-VALNOM95   ELSE96            MOVE 0 TO M-VALNOM97       INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98               FOR CHARACTERS BEFORE INITIAL "*"99       IF M-VALNOM >= 15400        MOVE 0 TO M-VALNOM401        INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402           FOR CHARACTERS BEFORE INITIAL "N"403END-IF404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405AND (14 - M-VALNOM > 0)              GJC0005      9406   COMPUTE INI-VALNOM = M-VALNOM + 2407      COMPUTE LON-VALNOM = 14 - M-VALNOM408   MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409   IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411      PEDAZO-VALNOM(1:M-VALNOM) =12   VM-INPUT(I-VALNOM)13   ADD 1 TO BLOQOK-AUX14MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)15      VM-INPUT-VALNOM(I-VALNOM)16      MOVE 21 TO J-VALNOM17   ADD 1 TO I-VALNOM18   MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)19END-IF20END-IF21END-IF22ADD 1 TO J-VALNOM23END-PERFORM24ADD 1 TO I-VALNOM25IF I-VALNOM = 2126NEXT SENTENCE27END-IF28END-PERFORM.29IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMMOVE 1 TO I-VALNOM.MOVE 0 TO BLOQOK-AUX-VALNOM.MOVE 0 TO BLOQOK-AUX-VALNOM.PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACESPERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACESMOVE 1 TO J-VALNOMMOVE 1 TO J-VALNOMPERFORM UNTIL J-VALNOM > 20PERFORM UNTIL J-VALNOM > 20IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMIF M-VALNOM >= 15IF M-VALNOM >= 15MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMEND-IFEND-IFIF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20IF MQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsM-VALNOM<W-S>00015              :   M-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   M-VALNOM > 0 AND AND (14 - M-VALNO    COMPUTE INI-VALNOAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20END-IFEND-IFADD 1 TO J-VALNOMADD 1 TO J-VALNOMEND-PERFORMEND-PERFORMIF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMIF M-VALNOM >= 15IF M-VALNOM >= 15MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMEND-IFEND-IFIF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20END-IFEND-IFADD 1 TO J-VALNOMADD 1 TO J-VALNOMEND-PERFORMEND-PERFORMIF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)ADD 1 TO BLOQOK-AUX-VALNOMADD 1 TO BLOQOK-AUX-VALNOMMOVE SPACES TO VM-OK-VALNOM(J-VALNOM)MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)MOVE 21 TO J-VALNOMMOVE 21 TO J-VALNOMADD 1 TO J-VALNOMADD 1 TO J-VALNOMEND-PERFORMEND-PERFORMADD 1 TO I-VALNOMADD 1 TO I-VALNOMIF I-VALNOM = 21IF IQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsI-VALNOM<W-S>00002          :   I-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   I-VALNOM = 21NEXT SENTENCE-IFAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF I-VALNOM = 21END-PERFORM.END-PERFORM.MOVE 1 TO J-VALNOMMOVE 1 TO J-VALNOMPERFORM UNTIL J-VALNOM > 20PERFORM UNTIL J-VALNOM > 20IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)ADD 1 TO BLOQOK-AUX-VALNOM
ADD 1 TO BLOQOK-AUX-VALNOMMOVE SPACES TO VM-OK-VALNOM(J-VALNOM)MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)MOVE 21 TO J-VALNOMMOVE 21 TO J-VALNOMADD 1 TO J-VALNOMADD 1 TO J-VALNOMEND-PERFORMEND-PERFORMADD 1 TO I-VALNOMADD 1 TO I-VALNOMIF I-VALNOM = 21IF Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsI-VALNOM<W-S>00003          :   I-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   I-VALNOM = 21NEXT SENTENCE-IFAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF I-VALNOM = 21END-PERFORM.END-PERFORM.MOVE 1 TO J-VALNOMMOVE 1 TO J-VALNOMPERFORM UNTIL J-VALNOM > 20PERFORM UNTIL J-VALNOM > 20IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMIF M-VALNOM >= 15IF M-VALNOM >= 15MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMEND-IFEND-IFIF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20END-IFEND-IFADD 1 TO J-VALNOMADD 1 TO J-VALNOMEND-PERFORMEND-PERFORMIF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)ADD 1 TO BLOQOK-AUX-VALNOMADD 1 TO BLOQOK-AUX-VALNOMMOVE SPACES TO VM-OK-VALNOM(J-VALNOM)MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)MOVE 21 TO J-VALNOMMOVE 21 TO J-VALNOMADD 1 TO J-VALNOMADD 1 TO J-VALNOMEND-PERFORMEND-PERFORMADD 1 TO I-VALNOMADD 1 TO I-VALNOMIF I-VALNOM = 21IF I-VALNOM = 21END-PERFORM.END-PERFORM.IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMIF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM427       END-IF428END-PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432 IF TIP-ID-INPUT-VALNOM <> 2433  PERFORM 10100-MATCH-APROXIMADO434ELSE435PERFORM 10100-MATCH-APROX-EMPRESAS436END-IF437IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438  MOVE 1 TO MATCH-OK-OUT-VALNOM439END-IF440END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.43*EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS44*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON45*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.46**********************************************************************47 10100-MATCH-APROXIMADO.48IF BLOQOK-AUX-VALNOM > 049MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM50ELSE51MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM52END-IF53MOVE 1 TO I-VALNOM.54PERFORM UNTIL I-VALNOM > 1055MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563  IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =64        VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)65        OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66          AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67               OR = "N"))GJC0003    68          IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES69          ADD 1 TO LETRAS-OK-VALNOM70      ADD 1 TO K-VALNOM71               ADD 1 TO L-VALNOM72            ELSEIF BLQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsBLOQOK-AUX-VALNOM<W-S>03                      NOM:   BLOQOK-AUX-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   BLOQOK-AUX-VALNOM >= BLOQUMOVE 1 TO MATCH-OK-OUT-VALNOMEAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   OQOK-AUX-VALNOM >= BLQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsBLOQUES-INPUT-VALNOM<W-S>02     :   BLOQUES-INPUT-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   BLOQUES-INPUT-VALNOMT-VALNOMAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"display "4222-VALIDA-NOMBRE-COINCIDE"5657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69 not invalid key70move 0 to SW-BDIIALE71read BDIIALE next record72at end73    move 1 to SW-BDIIALE74    end-read75end-start7677     perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79     or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80         if FUENTE-BDIIALE = 99000381         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82     and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83    and BLOQUEO-BDIIALE = 084     encontrado85     move 1 to SW-BDIIALE86    end-if87 if SW-BDIIALE = 088    read BDIIALE next record at end89       move 1 to SW-BDIIALE90end-read91end-if92     end-perform.9394     if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97     else98        if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOS


      


      


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1    if SWQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsSW-BDIIALE<W-S>0                :   SW-BDIIALE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   SW-BDIIALE = 0 read BDIIALE next      move 1 to SW-BAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   








if TIP-IDE-BDIIVIDE = 194if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196         move 07 to CODIGO-ERROR97         else98             if ESTADO-VIG-BDIIREGI = 2199                 move 06 to CODIGO-ERROR500             add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOS502        end-if503    end-if504end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524******************************************************************525IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526ADD 1 TO W-CONT-TIPO-6527ELSE528IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530    ELSE531*registros correctos, repetidos o no532        ADD 1 TO W-CONT-TIPO-5533*    si es una empresa534IF TIPOID-E = 2 OR 3535    ADD 1 TO W-CONT-TIPO-5-PJ536END-IF537END-IF38END-IF.39if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if EQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsESTADO-VIG-BDIIREGI<W-S>21                        :   ESTADO-VIG-BDIIREGI<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   ESTADO-VIG-BDIIREGI = 12 and move 07 to CODIGO-ERROReAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   STADO-VIG-BDIIREGI = 12 and W-DQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsW-DERECHOS<W-S>0:   W-DERECHOS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   W-DERECHOS = 1AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSend-ifend-ifend-ifend-ifend-if.end-if.36    else37    perform 4222-VALIDA-NOMBRE-COINCIDE38end-if39end-if.4041442 4220-VALIDA-NOMBRE-NO-COINCIDE.443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"444******************************************************************445* Validación de IDs que figuran OK pero el nombre no coincide446******************************************************************447*nombre no coincide448IF TIP-IDE-BDIIVIDE = 1449*        es una cédula450     MOVE 02 TO CODIGO-ERROR451     ELSE452    no es una cédula453     MOVE 01 TO CODIGO-ERROR454 END-IF.455456457 4222-VALIDA-NOMBRE-COINCIDE.458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"459******************************************************************460* Validación de IDs que figuran OK pero el nombre coincide461******************************************************************462nombre coincide: busca ID en BDIIALE463 initialize LLAVE-BDIIALE464 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE465 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE466     move 990003 to FUENTE-BDIIALE467start BDIIALE key not < LLAVE-BDIIALE INVALID KEY468move 1 TO SW-BDIIALE469not invalid key470move 0 to SW-BDIIALE471read BDIIALE next record472at end473 move 1 to SW-BDIIALE474end-read475 end-start476477perform until SW-BDIIALE = 1478or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480    if FUENTE-BDIIALE = 990003481and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-COQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsW-CONT-TIPO-6<W-S>0000005:   W-CONT-TIPO-6<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   W-CONT-TIPO-6-ERROR = 03 OR 04 OR 05AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   


Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsW-CONT-TIPO-7<W-S>000003:   W-CONT-TIPO-7<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   W-CONT-TIPO-7 correctos, repetidos AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   ADD 1 TO W-CONT-TIPO-6330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASperform 4300-MODIFICAR-BDIIALE560561 4300-MODIFICAR-BDIIALE.562Ddisplay "4300-MODIFICAR-BDIIALE"563******************************************************************564* Se impacta el archivo BDIIALE con una o dos inserciones,565* modificaciones o eliminaciones segun haya o no demandas y566* embargos567******************************************************************568 initialize REG-BDIIALE569570*    si hay demandas571     if JURAD-demandas-vigentes > zero572 or JURAD-demandas-terminadas > zero57    move "J001" to LLASEC-BDIIALE574*arma datos de demandas57JURAD-demandas-vigentes to D-vigentes57    move JURAD-demandas-terminadas to D-terminados577     string "20" JURAD-demandas-fecha-ultima57    delimited size into D-fecha-ultima57perform 4300-MODIFICAR-BDIIALE-DATOS58.581582*si hay embargos58if JURAD-embargos-vigentes > zero584 or JURAD-embargos-terminados > zero585     move "J002" to LLASEC-BDIIALE586*    arma datos de embargos58move JURAD-embargos-vigentes to D-vigentes58    move JURAD-embargos-terminados to D-terminados589     string "20" JURAD-embargos-fecha-ultimo59    delimited size into D-fecha-ultima59perform 4300-MODIFICAR-BDIIALE-DATOS59.593594595596 4300-MODIFICAR-BDIIALE-DATOS.597Ddisplay "4300-MODIFICAR-BDIIALE-DATOS"598******************************************************************599* Parte de la carga de datos en el registro BDIIALE y grabacion600* del mismo que es comun a demandas y embargos601* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"602******************************************************************603*completa la clave e intenta leer la alerta, si se leyo OK604*l file status de BDIIALE queda con "00"60perform 4333-LEER-BDIIALE-RANDOM

      

      

      display "4300-MODIFICAR-BDIIALE"initialize REG-BDIIALEinitialize REG-BDIIALEif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALEmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSdisplay "4300-MODIFICAR-BDIIALE-DATOS"display "4300-MODIFICAR-BDIIALE-DATOS"9596-DATOS.97display "4300-MODIFICAR-BDIIALE-DATOS"9899* Parte de la carga de datos en el registro BDIIALE y grabacion600* del mismo que es comun a demandas y embargos601* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"602603*completa la clave e intenta leer la alerta, si se leyo OK604*el file status de BDIIALE queda con "00"605 perform 4333-LEER-BDIIALE-RANDOM606607*procesa segun el tipo de novedad I M E608evaluate JURAD-tipo-novedad609 when "I"610add 1 to N-reg-tipo-I-OK611perform 4300-MODIFICAR-BDIIALE-I612when "M"613add 1 to N-reg-tipo-M-OK614M615when "E"616add 1 to N-reg-tipo-E-OK617     perform 4300-MODIFICAR-BDIIALE-E618when other619*    esto es "imposible" por control de consistencia anterior620display "error de logica: tipo-novedad="621 JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos622display "Registro de JURAD: " display JURAD-reg623perform 9000-CANCELAR-PROGRAMA624end-evaluate.625626627 4300-MODIFICAR-BDIIALE-I.628Ddisplay "4300-MODIFICAR-BDIIALE-I"629******************************************************************630* Insercion de una alerta nueva631* Si ya existia muestra un mensaje y continua632******************************************************************633*    si el registro existia es un error634     if EST-BDIIALE = "00"35         display "Insercion de alerta nueva que ya existe "36         " key: " LLAVE-BDIIALE37         display "Registro de input: "38     display JURAD-reg39     display "Datos en la alerta: " INF-DATAHOST-BDIIALE40    add 1 to N-ale-ya-existe
      
      
      display "4300-MODIFICAR-BDIIALE-DATOS"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM709710 4333-LEER-BDIIALE-RANDOM.711display "4333-LEER-BDIIALE-RANDOM"712713* Arma clave exacta y lee un registro de BDIIALE714* Usa los datos del reg input, excepto LLASEC que esta precargado715* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"716717 move JURAD-id-tipo to TIP-IDE-BDIIALE718 move JURAD-id-numero to NUM-IDE-BDIIALE719move P-cod-suscriptor to FUENTE-BDIIALE720move 000 to COD-ALERTA-BDIIALE721LLASEC-BDIIALE fué previamente cargado con J001 o J002722723read BDIIALE724evaluate EST-BDIIALE725when "00"726    continue727when "23"728continue729other730display "Error al leer BDIIALE fs: " EST-BDIIALE731" key: " LLAVE-BDIIALE732    display "Ultimo registro procesado: "733 display JURAD-reg-anterior734perform 9000-CANCELAR-PROGRAMA735end-evaluate.736*display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE737*" fs:" EST-BDIIALE.738739740 4333-GRABAR-BDIIALE.741D    display "4333-GRABAR-BDIIALE"742******************************************************************743* Inserta un registro nuevo en BDIIALE744******************************************************************745     if not PROCESO-REAL746         exit paragraph747 end-if748write REG-BDIIALE749evaluate EST-BDIIALE750when "00"751add 1 to N-ale-insertadas752when other753Error al grabar BDIIALE fs: " EST-BDIIALE754" key: " LLAVE-BDIIALE

      

      

      display "4333-LEER-BDIIALE-RANDOM"move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALEread BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEcontinuecontinue606607*    procesa segun el tipo de novedad I M E608 evaluate JURAD-tipo-novedad609     when "I"610         add 1 to N-reg-tipo-I-OK611         perform 4300-MODIFICAR-BDIIALE-I612     when "M"613         add 1 to N-reg-tipo-M-OK614    perform 4300-MODIFICAR-BDIIALE-M615when "E"616    add 1 to N-reg-tipo-E-OK617    perform 4300-MODIFICAR-BDIIALE-E618 when other619*esto es "imposible" por control de consistencia anterior620    display "error de logica: tipo-novedad="621    JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos622    display "Registro de JURAD: " display JURAD-reg623perform 9000-CANCELAR-PROGRAMA624end-evaluate.625626627 4300-MODIFICAR-BDIIALE-I.628Ddisplay "4300-MODIFICAR-BDIIALE-I"629******************************************************************630* Insercion de una alerta nueva631* Si ya existia muestra un mensaje y continua632******************************************************************633si el registro existia es un error634 if EST-BDIIALE = "00"635display "Insercion de alerta nueva que ya existe "636" key: " LLAVE-BDIIALE637         display "Registro de input: "638     display JURAD-reg639         display "Datos en la alerta: " INF-DATAHOST-BDIIALE640         add 1 to N-ale-ya-existe641     end-if642643*completa los datos del registro644initialize ENCABEZADO-BDIIALE645move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE646FEC-REP-BDIIALE647move P-fecha-proceso-50 to FEC-VEN-BDIIALE648move 0 to BLOQUEO-BDIIALE649move D-datahost to INF-DATAHOST-BDIIALE650perform 4320-ARMAR-TEXTO-ALERTA651if EST-BDIIALE = "00"evaluate JURAD-tipo-novedadadd 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Idisplay "4300-MODIFICAR-BDIIALE-I"
      
      
      display "4300-MODIFICAR-BDIIALE-I"if EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "
      
      
      display "Insercion de alerta nueva que ya existe "display "Registro de input: "
      
      
      display "Registro de input: "display JURAD-reg
      
      
      display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALE
      
      
      display "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeend-ifend-ifinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALE4243completa los datos del registro44initialize ENCABEZADO-BDIIALE45move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE46FEC-REP-BDIIALE47move P-fecha-proceso-50 to FEC-VEN-BDIIALE48move 0 to BLOQUEO-BDIIALE49move D-datahost to INF-DATAHOST-BDIIALE50perform 4320-ARMAR-TEXTO-ALERTA51if EST-BDIIALE = "00"52perform 4333-REGRABAR-BDIIALE53else54    perform 4333-GRABAR-BDIIALE55 end-if.56*display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE57*" fs:" EST-BDIIALE.585960 4300-MODIFICAR-BDIIALE-M.61Ddisplay "4300-MODIFICAR-BDIIALE-M"62******************************************************************63* Modificacion de una alerta existente64* Si no existia muestra un mensaje y continua6566*    si el registro no existia es un error67     if EST-BDIIALE not = "00"68         display "Modificacion de alerta inexistente "69     " key: " LLAVE-BDIIALE70    display "Registro de input: "71JURAD-reg72display "Datos en la alerta: " INF-DATAHOST-BDIIALE73add 1 to N-ale-no-existe74call "PONERR" using "17" JURAD-reg E-errores75end-if76*reemplaza la fecha de reporte y los valores77move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE78move D-datahost to INF-DATAHOST-BDIIALE79 perform 4320-ARMAR-TEXTO-ALERTA80f EST-BDIIALE = "00"81    perform 4333-REGRABAR-BDIIALE82else83    perform 4333-GRABAR-BDIIALE84end-if.85*display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE86*" fs:" EST-BDIIALE.87

















initialize ENCABEZADO-BDIIALE60 4300-MODIFICAR-BDIIALE-M.61Ddisplay "4300-MODIFICAR-BDIIALE-M"62******************************************************************63* Modificacion de una alerta existente64* Si no existia muestra un mensaje y continua65******************************************************************66*si el registro no existia es un error67if EST-BDIIALE not = "00"68    display "Modificacion de alerta inexistente "69    " key: " LLAVE-BDIIALE70display "Registro de input: "71    display JURAD-reg72display "Datos en la alerta: " INF-DATAHOST-BDIIALE73    add 1 to N-ale-no-existe74     call "PONERR" using "17" JURAD-reg E-errores75 end-if76*reemplaza la fecha de reporte y los valores77move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE78     move D-datahost to INF-DATAHOST-BDIIALE79 perform 4320-ARMAR-TEXTO-ALERTA80     if EST-BDIIALE = "00"81         perform 4333-REGRABAR-BDIIALE82     else83         perform 4333-GRABAR-BDIIALE84 end-if.85*display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE86*" fs:" EST-BDIIALE.878889 4300-MODIFICAR-BDIIALE-E.90Ddisplay "4300-MODIFICAR-BDIIALE-E"91******************************************************************92* Eliminacion de una alerta93* Si no existia muestra un mensaje y continua94******************************************************************95*elimina el registro96if EST-BDIIALE = "00"97    perform 4333-ELIMINAR-BDIIALE98else99display "Eliminacion de alerta inexistente "700    " key: " LLAVE-BDIIALE701display "Registro de input: "702    display JURAD-reg703     add 1 to N-ale-no-existe704     call "PONERR" using "18" JURAD-reg E-errores705end-if.15     when "E"16     add 1 to N-reg-tipo-E-OK17         perform 4300-MODIFICAR-BDIIALE-E18     when other19*        esto es "imposible" por control de consistencia anterior20         display "error de logica: tipo-novedad="21     JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos22    display "Registro de JURAD: " display JURAD-reg23perform 9000-CANCELAR-PROGRAMA24end-evaluate.252627 4300-MODIFICAR-BDIIALE-I.28Ddisplay "4300-MODIFICAR-BDIIALE-I"29******************************************************************30* Insercion de una alerta nueva31* Si ya existia muestra un mensajcontinua32******************************************************************33*si el registro existia es un error34if EST-BDIIALE = "00"35    display "Insercion de alerta nueva que ya existe "36" key: " LLAVE-BDIIALE37    display "Registro de input: "38display JURAD-reg39    display "Datos en la alerta: " INF-DATAHOST-BDIIALE40     add 1 to N-ale-ya-existe41 end-if4243*completa los datos del registro44     initialize ENCABEZADO-BDIIALE45 move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE46     FEC-REP-BDIIALE47     move P-fecha-proceso-50 to FEC-VEN-BDIIALE48     move 0 to BLOQUEO-BDIIALE49     move D-datahost to INF-DATAHOST-BDIIALE50 perform 4320-ARMAR-TEXTO-ALERTA5152REGRAB5354perform 4333-GRABAR-BDIIALE655end-if.656*display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE657*" fs:" EST-BDIIALE.658659660 4300-MODIFICAR-BDIIALE-M.











initialize ENCABEZADO-BDIIALE27 4300-MODIFICAR-BDIIALE-I.28Ddisplay "4300-MODIFICAR-BDIIALE-I"29******************************************************************30* Insercion de una alerta nueva31* Si ya existia muestra un mensaje y continua32******************************************************************33*si el registro existia es un error34if EST-BDIIALE = "00"35display "Insercion de alerta nueva que ya existe "36    " key: " LLAVE-BDIIALE37display "Registro de input: "38display JURAD-reg39         display "Datos en la alerta: " INF-DATAHOST-BDIIALE40     add 1 to N-ale-ya-existe41     end-if4243*    completa los datos del registro44     initialize ENCABEZADO-BDIIALE45 move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE46FEC-REP-BDIIALE47move P-fecha-proceso-50 to FEC-VEN-BDIIALE48move 0 to BLOQUEO-BDIIALE49move D-datahost to INF-DATAHOST-BDIIALE50perform 4320-ARMAR-TEXTO-ALERTA51if EST-BDIIALE = "00"52perform 4333-REGRABAR-BDIIALE53lse54perform 4333-GRABAR-BDIIALE55 end-if.56*display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE57*" fs:" EST-BDIIALE.585960 4300-MODIFICAR-BDIIALE-M.61Ddisplay "4300-MODIFICAR-BDIIALE-M"62******************************************************************63* Modificacion de una alerta existente64* Si no existia muestra un mensaje y continua65******************************************************************66*si el registro no existia es un error67if EST-BDIIALE not = "00"68     display "Modificacion de alerta inexistente "69     " key: " LLAVE-BDIIALE70display "Registro de input: "71display JURAD-reg72         display "Datos en la alerta: " INF-DATAHOST-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTA884885 4320-ARMAR-TEXTO-ALERTA.886D    display "4320-ARMAR-TEXTO-ALERTA"887****************************************************************888* Hace el reemplazo de los valores adecuados en los templates889* de las linea de alerta que corresponde890****************************************************************891*segun se trate de demandas o embargos892if JURAD-demandas-vigentes not = 0893or JURAD-demandas-terminadas not = 0894set LAx to 1895move high-values to LA-valores896move JURAD-demandas-vigentes to LA-num897* >>>> esto esta anulado x que no se como hacer para que lo compile898*    unstring LA-numX into LA-descarte LA-valor(1)899*delimited by all space900     move LA-numx(9:12) to LA-valor(1)901    move JURAD-demandas-terminadas to LA-num902* >>>> esto esta anulado x que no se como hacer para que lo compile903*    unstring LA-numX into LA-descarte LA-valor(2)904*    delimited by all space905    move LA-numx(9:12) to LA-valor(2)906907* >>>> esto esta anulado x que no se como hacer para que lo compile908* >>>> da error en el end-if909*string LA-parte(LAx, 1) LA-valor(1)910*    LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)911*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)912*    LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)913    LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)914    LA-parte(LAx, 10) LA-valor(10)915*delimited by high-value916end-if.917918919 1000-RUTINA-INICIAL.920D    display "1000-RUTINA-INICIAL"921******************************************************************922* Todas las operaciones que se realizan una sola vez, al comienzo923* del programa:924*   - obtencion de los parametros925*   - apertura del archivo de entrada926*   - apertura de todos los demas archivos927*   - eliminacion de datos existentes si es refresque completo928*   - carga en memoria de los IDs de inconsistentes929******************************************************************



      



      



      display "4320-ARMAR-TEXTO-ALERTA"if JURAD-demandas-vigentes not = 0if JURAD-demandas-vigentes not = 0set LAx to 1set LAx to 1move high-values to LA-valoresmove high-values to LA-valoresmove JURAD-demandas-vigentes to LA-nummove JURAD-demandas-vigentes to LA-nummove LA-numx(9:12) to LA-valor(1)move LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-nummove JURAD-demandas-terminadas to LA-nummove LA-numx(9:12) to LA-valor(2)move LA-numx(9:12) to LA-valor(2)end-if.end-if.649move D-datahost to INF-DATAHOST-BDIIALE650     perform 4320-ARMAR-TEXTO-ALERTA651 if EST-BDIIALE = "00"652         perform 4333-REGRABAR-BDIIALE653     else654         perform 4333-GRABAR-BDIIALE655     end-if.656display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE657*" fs:" EST-BDIIALE.658659660 4300-MODIFICAR-BDIIALE-M.661Ddisplay "4300-MODIFICAR-BDIIALE-M"662******************************************************************663* Modificacion de una alerta existente664* Si no existia muestra un mensaje y continua665******************************************************************666*si el registro no existia es un error667     if EST-BDIIALE not = "00"668 display "Modificacion de alerta inexistente "669 " key: " LLAVE-BDIIALE670display "Registro de input: "671display JURAD-reg672         display "Datos en la alerta: " INF-DATAHOST-BDIIALE673         add 1 to N-ale-no-existe674 call "PONERR" using "17" JURAD-reg E-errores675 end-if676reemplaza la fecha de reporte y los valores677 move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE678 move D-datahost to INF-DATAHOST-BDIIALE679 perform 4320-ARMAR-TEXTO-ALERTA680 if EST-BDIIALE = "00"681    perform 4333-REGRABAR-BDIIALE682else683perform 4333-GRABAR-BDIIALE684     end-if.685*4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE686*    " fs:" EST-BDIIALE.687688689 4300-MODIFICAR-BDIIALE-E.690D    display "4300-MODIFICAR-BDIIALE-E"691******************************************************************692* Eliminacion de una alerta693* Si no existia muestra un mensaje y continua694if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALE760761 4333-REGRABAR-BDIIALE.762Ddisplay "4333-REGRABAR-BDIIALE"763******************************************************************764* Regraba un registro modificado en BDIIALE765******************************************************************766if not PROCESO-REAL767     exit paragraph768 end-if769rewrite REG-BDIIALE770evaluate EST-BDIIALE771     when "00"772     add 1 to N-ale-modificadas773     when other774         display "Error al regrabar BDIIALE fs: " EST-BDIIALE775         " key: " LLAVE-BDIIALE776         display "Registro BDIIALE: "777     display REG-BDIIALE778    perform 9000-CANCELAR-PROGRAMA779end-evaluate.780781782 4333-ELIMINAR-BDIIALE.783Ddisplay "4333-ELIMINAR-BDIIALE"784******************************************************************785* Elimina un registro de BDIIALE786******************************************************************787 if not PROCESO-REAL788    exit paragraph789end-if790delete BDIIALE791evaluate EST-BDIIALE792when "00"793    add 1 to N-ale-eliminadas794when other795    display "Error al deletear BDIIALE fs: " EST-BDIIALE796     " key: " LLAVE-BDIIALE797     display "Registro BDIIALE: "798display REG-BDIIALE799perform 9000-CANCELAR-PROGRAMA800     end-evaluate.801802 4800-PROCESO-REG-T.803D    display "4800-PROCESO-REG-T"804******************************************************************805* El registro leido en el archivo JURAD es tipo "T" con totales
      
      
      display "4333-REGRABAR-BDIIALE"if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraph578delimited size into D-fecha-ultima579         perform 4300-MODIFICAR-BDIIALE-DATOS580 end-if.581582*    si hay embargos583     if JURAD-embargos-vigentes > zero584or JURAD-embargos-terminados > zero585move "J002" to LLASEC-BDIIALE586*    arma datos de embargos587    move JURAD-embargos-vigentes to D-vigentes588    move JURAD-embargos-terminados to D-terminados589    string "20" JURAD-embargos-fecha-ultimo590delimited size into D-fecha-ultima591    perform 4300-MODIFICAR-BDIIALE-DATOS592end-if.593594595596 4300-MODIFICAR-BDIIALE-DATOS.597Ddisplay "4300-MODIFICAR-BDIIALE-DATOS"598******************************************************************599* Parte de la carga de datos en el registro BDIIALE y grabacion600* del mismo que es comun a demandas y embargos601* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"602603*    completa la clave e intenta leer la alerta, si se leyo OK604*    el file status de BDIIALE queda con "00"605perform 4333-LEER-BDIIALE-RANDOM606607*procesa segun el tipo de novedad I M E608evaluate JURAD-tipo-novedad609when "I"610    add 1 to N-reg-tipo-I-OK611perform 4300-MODIFICAR-BDIIALE-I612"M"613add 1 to N-reg-tipo-M-OK614perform 4300-MODIFICAR-BDIIALE-M615when "E"616add 1 to N-reg-tipo-E-OK6174300-MODIFICAR-BDIIALE-E618when other619*esto es "imposible" por control de consistencia anterior620         display "error de logica: tipo-novedad="621     JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos622         display "Registro de JURAD: " display JURAD-reg623         perform 9000-CANCELAR-PROGRAMAend-if.if JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALEmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimoperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSdisplay "4300-MODIFICAR-BDIIALE-DATOS"

      

      

      display "4300-MODIFICAR-BDIIALE-DATOS"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM709710 4333-LEER-BDIIALE-RANDOM.711Ddisplay "4333-LEER-BDIIALE-RANDOM"712******************************************************************713* Arma clave exacta y lee un registro de BDIIALE714* Usa los datos del reg input, excepto LLASEC que esta precargado715* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"716******************************************************************717 move JURAD-id-tipo to TIP-IDE-BDIIALE718move JURAD-id-numero to NUM-IDE-BDIIALE719move P-cod-suscriptor to FUENTE-BDIIALE720move 000 to COD-ALERTA-BDIIALE721*LLASEC-BDIIALE fué previamente cargado con J001 o J002722723read BDIIALE724evaluate EST-BDIIALE725when "00"726continue727     when "23"728     continue729     when other730         display "Error al leer BDIIALE fs: " EST-BDIIALE731         " key: " LLAVE-BDIIALE732         display "Ultimo registro procesado: "733         display JURAD-reg-anterior734     perform 9000-CANCELAR-PROGRAMA735 nd-evaluate.736*display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE737*" fs:" EST-BDIIALE.738739740 4333-GRABAR-BDIIALE.741Ddisplay "4333-GRABAR-BDIIALE"742******************************************************************743* Inserta un registro nuevo en BDIIALE744******************************************************************745if not PROCESO-REAL746    exit paragraph747end-if748write REG-BDIIALE749evaluate EST-BDIIALE750 when "00"751add 1 to N-ale-insertadas752when other753Error al grabar BDIIALE fs: " EST-BDIIALE754" key: " LLAVE-BDIIALE

      

      

      display "4333-LEER-BDIIALE-RANDOM"move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALEread BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEcontinuecontinue606607*    procesa segun el tipo de novedad I M E608 evaluate JURAD-tipo-novedad609     when "I"610         add 1 to N-reg-tipo-I-OK611         perform 4300-MODIFICAR-BDIIALE-I612     when "M"613         add 1 to N-reg-tipo-M-OK614    perform 4300-MODIFICAR-BDIIALE-M615when "E"616    add 1 to N-reg-tipo-E-OK617    perform 4300-MODIFICAR-BDIIALE-E618 when other619*esto es "imposible" por control de consistencia anterior620    display "error de logica: tipo-novedad="621    JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos622    display "Registro de JURAD: " display JURAD-reg623perform 9000-CANCELAR-PROGRAMA624end-evaluate.625626627 4300-MODIFICAR-BDIIALE-I.628Ddisplay "4300-MODIFICAR-BDIIALE-I"629******************************************************************630* Insercion de una alerta nueva631* Si ya existia muestra un mensaje y continua632******************************************************************633si el registro existia es un error634 if EST-BDIIALE = "00"635display "Insercion de alerta nueva que ya existe "636" key: " LLAVE-BDIIALE637         display "Registro de input: "638     display JURAD-reg639         display "Datos en la alerta: " INF-DATAHOST-BDIIALE640         add 1 to N-ale-ya-existe641     end-if642643*completa los datos del registro644initialize ENCABEZADO-BDIIALE645move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE646FEC-REP-BDIIALE647move P-fecha-proceso-50 to FEC-VEN-BDIIALE648move 0 to BLOQUEO-BDIIALE649move D-datahost to INF-DATAHOST-BDIIALE650perform 4320-ARMAR-TEXTO-ALERTA651if EST-BDIIALE = "00"evaluate JURAD-tipo-novedadadd 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Idisplay "4300-MODIFICAR-BDIIALE-I"
      
      
      display "4300-MODIFICAR-BDIIALE-I"if EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "
      
      
      display "Insercion de alerta nueva que ya existe "display "Registro de input: "
      
      
      display "Registro de input: "display JURAD-reg
      
      
      display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALE
      
      
      display "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeend-ifend-ifinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTA884885 4320-ARMAR-TEXTO-ALERTA.886Ddisplay "4320-ARMAR-TEXTO-ALERTA"887****************************************************************888* Hace el reemplazo de los valores adecuados en los templates889* de las linea de alerta que corresponde890****************************************************************891*segun se trate de demandas o embargos892if JURAD-demandas-vigentes not = 0893or JURAD-demandas-terminadas not = 0894set LAx to 1895move high-values to LA-valores896    move JURAD-demandas-vigentes to LA-num897* >>>> esto esta anulado x que no se como hacer para que lo compile898*unstring LA-numX into LA-descarte LA-valor(1)899*delimited by all space900move LA-numx(9:12) to LA-valor(1)901move JURAD-demandas-terminadas to LA-num902* >>>> esto esta anulado x que no se como hacer para que lo compile903*unstring LA-numX into LA-descarte LA-valor(2)904*delimited by all space905         move LA-numx(9:12) to LA-valor(2)906907* >>>> esto esta anulado x que no se como hacer para que lo compile908* >>>> da error en el end-if909*        string LA-parte(LAx, 1) LA-valor(1)910*        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)911    LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)912*    LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)913*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)914*LA-parte(LAx, 10) LA-valor(10)915*elimited by high-value916end-if.917918919 1000-RUTINA-INICIAL.920Ddisplay "1000-RUTINA-INICIAL"921******************************************************************922* Todas las operaciones que se realizan una sola vez, al comienzo923* del programa:924*   - obtencion de los parametros925*   - apertura del archivo de entrada926*   - apertura de todos los demas archivos927*   - eliminacion de datos existentes si es refresque completo928*   - carga en memoria de los IDs de inconsistentes929******************************************************************



      



      



      display "4320-ARMAR-TEXTO-ALERTA"if JURAD-demandas-vigentes not = 0if JURAD-demandas-vigentes not = 0set LAx to 1set LAx to 1move high-values to LA-valoresmove high-values to LA-valoresmove JURAD-demandas-vigentes to LA-nummove JURAD-demandas-vigentes to LA-nummove LA-numx(9:12) to LA-valor(1)move LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-nummove JURAD-demandas-terminadas to LA-nummove LA-numx(9:12) to LA-valor(2)move LA-numx(9:12) to LA-valor(2)end-if.
end-if.649move D-datahost to INF-DATAHOST-BDIIALE650     perform 4320-ARMAR-TEXTO-ALERTA651 if EST-BDIIALE = "00"652         perform 4333-REGRABAR-BDIIALE653     else654         perform 4333-GRABAR-BDIIALE655     end-if.656display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE657*" fs:" EST-BDIIALE.658659660 4300-MODIFICAR-BDIIALE-M.661Ddisplay "4300-MODIFICAR-BDIIALE-M"662******************************************************************663* Modificacion de una alerta existente664* Si no existia muestra un mensaje y continua665******************************************************************666*si el registro no existia es un error667     if EST-BDIIALE not = "00"668 display "Modificacion de alerta inexistente "669 " key: " LLAVE-BDIIALE670display "Registro de input: "671display JURAD-reg672         display "Datos en la alerta: " INF-DATAHOST-BDIIALE673         add 1 to N-ale-no-existe674 call "PONERR" using "17" JURAD-reg E-errores675 end-if676reemplaza la fecha de reporte y los valores677 move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE678 move D-datahost to INF-DATAHOST-BDIIALE679 perform 4320-ARMAR-TEXTO-ALERTA680 if EST-BDIIALE = "00"681    perform 4333-REGRABAR-BDIIALE682else683perform 4333-GRABAR-BDIIALE684     end-if.685*4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE686*    " fs:" EST-BDIIALE.687688689 4300-MODIFICAR-BDIIALE-E.690D    display "4300-MODIFICAR-BDIIALE-E"691******************************************************************692* Eliminacion de una alerta693* Si no existia muestra un mensaje y continua694if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALE760761 4333-REGRABAR-BDIIALE.762Ddisplay "4333-REGRABAR-BDIIALE"763******************************************************************764* Regraba un registro modificado en BDIIALE765******************************************************************766if not PROCESO-REAL767     exit paragraph768 end-if769rewrite REG-BDIIALE770evaluate EST-BDIIALE771     when "00"772     add 1 to N-ale-modificadas773     when other774         display "Error al regrabar BDIIALE fs: " EST-BDIIALE775         " key: " LLAVE-BDIIALE776         display "Registro BDIIALE: "777     display REG-BDIIALE778    perform 9000-CANCELAR-PROGRAMA779end-evaluate.780781782 4333-ELIMINAR-BDIIALE.783Ddisplay "4333-ELIMINAR-BDIIALE"784******************************************************************785* Elimina un registro de BDIIALE786******************************************************************787 if not PROCESO-REAL788    exit paragraph789end-if790delete BDIIALE791evaluate EST-BDIIALE792when "00"793    add 1 to N-ale-eliminadas794when other795    display "Error al deletear BDIIALE fs: " EST-BDIIALE796     " key: " LLAVE-BDIIALE797     display "Registro BDIIALE: "798display REG-BDIIALE799perform 9000-CANCELAR-PROGRAMA800     end-evaluate.801802 4800-PROCESO-REG-T.803D    display "4800-PROCESO-REG-T"804******************************************************************805* El registro leido en el archivo JURAD es tipo "T" con totales
      
      
      display "4333-REGRABAR-BDIIALE"if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraph59delimited size into D-fecha-ultima591         perform 4300-MODIFICAR-BDIIALE-DATOS592 end-if.593594595596 4300-MODIFICAR-BDIIALE-DATOS.597Ddisplay "4300-MODIFICAR-BDIIALE-DATOS"598******************************************************************599* Parte de la carga de datos en el registro BDIIALE y grabacion600* del mismo que es comun a demandas y embargos601* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"602******************************************************************603*completa la clave e intenta leer la alerta, si se leyo OK604*el file status de BDIIALE queda con "00"60perform 4333-LEER-BDIIALE-RANDOM606607*procesa segun el tipo de novedad I M E60evaluate JURAD-tipo-novedad60when "I"61add 1 to N-reg-tipo-I-OK61perform 4300-MODIFICAR-BDIIALE-I612     when "M"613     add 1 to N-reg-tipo-M-OK614         perform 4300-MODIFICAR-BDIIALE-M615     when "E"616         add 1 to N-reg-tipo-E-OK61    perform 4300-MODIFICAR-BDIIALE-E61when other619*    esto es "imposible" por control de consistencia anterior62    display "error de logica: tipo-novedad="62    JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos62    display "Registro de JURAD: " display JURAD-reg62perform 9000-CANCELAR-PROGRAMA62end-evaluate.625626627 4300-MODIFICAR-BDIIALE-I.628Ddisplay "4300-MODIFICAR-BDIIALE-I"629******************************************************************630* Insercion de una alerta nueva631* Si ya existia muestra un mensaje y continua632******************************************************************633*si el registro existia es un error634     if EST-BDIIALE = "00"635         display "Insercion de alerta nueva que ya existe "end-if.331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338100-VALIDACION-FORMAL"339340* Validacion formallos datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343     if JURAD-id-tipo not = "1" and "2" and "3" and "4"344     call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346end-if347*Numero de identificacion348 if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360 if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366end-if367*Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369     call "PONERR" using "07" JURAD-reg E-errores370     end-if371*    Fecha ultima demanda vigente YYMMDD372     if JURAD-demandas-fecha-ultima is not numeric373         call "PONERR" using "08" JURAD-reg E-errores374 end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS376if not ANO-VAL or not MES-VAL or not DIA-VALadd 1 to N-reg-OK.264    controla el reg y lo aplica si es OK265    perform 4000-PROCESAR-REGISTRO-2266    move JURAD-reg to JURAD-reg-anterior267add 1 to REG-LEIDOS268when "10"269*fin del archivo de input:270*        esto es un error, no se encontro el registro "T" antes271*    de que se terminara el archivo272         display "Falta el reg de totales del archivo JURAD "273         display "Nombre del archivo: " P-file-name274         display "File status: " JURAD-fs275     display "Ultimo registro leido: " N-reg-leidos276    display JURAD-reg-anterior277perform 9000-CANCELAR-PROGRAMA278when other279*    error de lectura: cancelacion del proceso280     display "Error en lectura del archivo JURAD "281    display "Nombre del archivo: " P-file-name282display "File status: " JURAD-fs283    display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285perform 9000-CANCELAR-PROGRAMA286evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296 move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00     call "PONERR" using "01" JURAD-reg E-errores01end-if0203*si es el registro "T" hay que señalar el fin de proceso04 if JURAD-tipo-novedad = "T"05    move "SI" to IND-fin-proceso06perform 4800-PROCESO-REG-T07    exit paragraph08end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************

         

         

         display "4000-PROCESAR-REGISTRO"read JURADread JURADevaluate JURAD-fsevaluate JURAD-fsdisplay " "Zoom   Ctrl+C to stop0
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   4404064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO   0
      
   
   
   BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0

4900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   0
      
   
   
   0
4900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO4900-GRABAR-ERROR
240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   100435240-CONTAR-TIPO-CUENTA
000-PROCESAR-REGISTRO



I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   100435  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay " "display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   display "4000-PROCESAR-REGISTRO-2"   8889-2.90display "4000-PROCESAR-REGISTRO-2"                                      9192* Controla los datos de un registro de JURAD y si es OK lo usa93* para actualizar el archivo de alertas en linea94* La informacion esta leida en JURAD-reg95****************************************************************96move "NO" to E-hay-error9798*validacion del tipo de movimiento99 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300 call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305move "SI" to IND-fin-proceso306    perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313move 0 to codigo-error314perform 4100-VALIDACION-FORMAL315if E-hay-error = "SI"316    perform 4900-GRABAR-ERROR317perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332     perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.































                              move "NO" to E-hay-error

























Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setperform 4200-VALIDACION-SEMANTICA                                       AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4000-PROCESAR-REGISTRO


I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   4404064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2

      
   
   
   
   4100-VALIDACION-FORMAL

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
      
   
   
   
   
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   9840694000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMALI100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069

4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435984069
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435   
   
   
   
      Error    
   
   
   
      
13   
   
   
   
          
   
   
   
      Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL


I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango

   
   
   
   
      4900-GRABAR-ERROR100-VALIDACION-FORMAL

I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR
   
   
   
   
      4000-PROCESAR-REGISTRO
I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO   
   
   
   
      I100001327130GONZALO PATIÑO MORENO0030062013010604407619   984069

Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO   
   
   
   
      984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango

4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTROError 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064900-GRABAR-ERROR
000-PROCESAR-REGISTRO



I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove "NO" to E-hay-errordisplay "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO



I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   4404064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406


   
   
   
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO



I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   4404064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406


   
   
   
      
   4000-PROCESAR-REGISTRO-2000-PROCESAR-REGISTRO


I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2

   
   
   
      
   4100-VALIDACION-FORMAL

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
   
   
   
      
   
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMALI100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406440406
000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406
   
   
      
      Error 
   
   
      
      
13
   
   
      
       
   
   
      
      Fecha ultimo embargo vigente YYYYMMDD: fuera de rango000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
   
   
      
      4900-GRABAR-ERROR100-VALIDACION-FORMAL
2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR
   
   
      
      4000-PROCESAR-REGISTRO2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
   
      
      22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
   
      
      40-CONTAR-TIPO-CUENTA
300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   display "4000-PROCESAR-REGISTRO-2"          4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM

4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406
   
   
      
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM

4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406
   
   
      
      
   4000-PROCESAR-REGISTRO-233-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 100002249789999999000J001Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2
   
   
      
      
   4100-VALIDACION-FORMAL00-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001

Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL   
   
      
      
   Insercion de alerta nueva que ya existe  key: 100002249789999999000J001
Registro de input:

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMALRegistro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406

Datos en la alerta: 0000400003202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406   
   
      
      
      Error    
   
      
      
      
07   
   
      
      
          
   
      
      
      Numero de demandas terminadas: debe ser numerico440406
Datos en la alerta: 000040000320201204

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico
   
      
      
      4900-GRABAR-ERRORDatos en la alerta: 000040000320201204
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR
   
      
      
      4000-PROCESAR-REGISTRO4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
      
      
      33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
      
      
      00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 100002249789999999000J002Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   11050600-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002

Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   110506  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002

Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   110506   
      
      
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002

Registro de input:I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   110506   
      
      
      
   4000-PROCESAR-REGISTRO-2Insercion de alerta nueva que ya existe  key: 100002249789999999000J002
Registro de input:

I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2   
      
      
      
   4100-VALIDACION-FORMALRegistro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   perform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Registro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL   
      
      
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moreperform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"     3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441Zoom   Ctrl+C to stopRegistro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL   
      
      
      
   4200-VALIDACION-SEMANTICAI100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406

Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stopI100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406

Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULA546*Arma el nombre completo en una sola variable547=============================548MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI549MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI550READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE551END-READ552IF SW-ID-BDIIVIDE = 0553 MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE554MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE555 MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE556MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE557 IF ESTADO-CIVIL-BDIIREGI = 0558   STRING559        SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",560"*" DELIMITED BY SIZE ,561             PRIMER-NOMBRE-BDIIVIDEDELIMITED BY "  ",562             "*" DELIMITED BY SIZE ,563             SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,564             ";" DELIMITED BY SIZE ,565             INTO NOM-LEIDO-BDIIVIDE566         END-IF567     IF ESTADO-CIVIL-BDIIREGI = 1568         STRING569       "DE" DELIMITED BY SIZE,570    "*"  DELIMITED BY SIZE,571    SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",572    "*"  DELIMITED BY SIZE,573    PRIMER-NOMBRDELIMITED BY "  ",574       "*"  DELIMITED BY SIZE,575     SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,576  ";"  DELIMITED BY SIZE,577  INTO NOM-LEIDO-BDIIVIDE578END-IF579IF ESTADO-CIVIL-BDIIREGI = 2580  STRING581 "VDA DE" DELIMITED BY SIZE,582 "*"      DELIMITED BY SIZE,583   SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",584     "*"DELIMITED BY SIZE,585   PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",586"*"      DELIMITED BY SIZE,587SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,588";"      DELIMITED BY SIZE,589INTO NOM-LEIDO-BDIIVIDE590END-IF591STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI01      WHEN 2                                 FAC0002    02       IF NUM-IDE-BDIIVIDE-R >  9999999999 OR                     FAC006C    03     (NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005    04     MOVE 1 TO SW-TID-BDIIVIDE           FAC0002    05  END-IF                                          FAC0002    06 WHEN 3 FAC0002    07  IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005    08  MOVE 1 TO SW-TID-BDIIVIDE                        FAC0002    09END-IF                                               FAC0002    10END-EVALUATE.                                           FAC0002    1112 80500-ELIMINAR-DIGITO-CHEQUEO.     FAC0004    13*================================================================14*80500-ELIMINAR-DIGITO-CHEQUEO.                          FAC0004    15*Elimina el digito de chequeo y cambia el tipo de identificacion16*de acuerdo a los rangos para tipo id = 2 y 317*================================================================18IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND            FAC0004    19NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    20(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004    21 NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005    22 MOVE 3 TO TIP-IDE-BDIIVIDE FAC0004    23END-IF       FAC0004    24IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004    25NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    26(NUM-IDE-BDIIVIDE-R >= 8000000000 AND           FAC0004    27NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    28MOVE 2 TO TIP-IDE-BDIIVIDE                     FAC0004    29END-IF                        FAC0004    30IF (TIP-IDE-BDIIVIDE = 2 AND                       FAC0004    31(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004    32(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004    33 NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005    34(TIP-IDE-BDIIVIDE = 3 AND   FAC0004    35(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004    36NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005    37MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004    38MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-R FAC0004    39END-IF                      FAC0004    40INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " "0". FAC0004    4142 85010-UBICA-CEDULA.43*================================================================44*85010-UBICA-CEDULA.45*Ubica la identificacion dada la llave en BDIIREGI46*Arma el nombre completo en una sola variable46*Arma el nombre completo en una sola variable47*================================================================48MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI49MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI50READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE51END-READ52IF SW-ID-BDIIVIDE = 053MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE54 MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE55    MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE56MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE57        IF ESTADO-CIVIL-BDIIREGI = 058            STRING59             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",60             "*" DELIMITED BY SIZE ,61             PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",62             "*" DELIMITED BY SIZE ,63       SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,64    ";" DELIMITED BY SIZE ,65    INTO NOM-LEIDO-BDIIVIDE66END-IF67IF ESTADO-CIVIL-BDIIREGI = 168       STRING69       "DE" DELIMITED BY SIZE,70    "*"  DELIMITED BY SIZE,71    SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",72    "*"  DELIMITED BY SIZE,73   PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",74       "*"  DELIMITED BY SIZE,75       SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,76    ";"  DELIMITED BY SIZE,77    INTO NOM-LEIDO-BDIIVIDE78END-IF79IF ESTADO-CIVIL-BDIIREGI = 280   STRING81   "VDA DE" DELIMITED BY SIZE,82   "*"      DELIMITED BY SIZE,83   SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",84       "*"DELIMITED BY SIZE,85       PRIMER-NOMBRE-BDIIVIDE    DELIMITED  ",86"*"DELIMITED BY SIZE,87             SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,88             ";"      DELIMITED BY SIZE,89         INTO NOM-LEIDO-BDIIVIDE90         END-IF91         STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEYREAD BDIIREGI INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEIF ESTADO-CIVIL-BDIIREGI = 0IF ESTADO-CIVIL-BDIIREGI = 0STRINGSTRINGEND-IF    INTO NOM-LEIQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOM-LEIDO-BDIIVIDE<W-S>BARBOSA*HENRY*               ;                                      :   NOM-LEIDO-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOM-LEIDO-BDIIVIDE-CIVIL-BDIIREGI = 1GAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
END-IFIF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 2IF ESTADO-CIVIL-BDIIREGI = 2STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",89         INTO NOM-LEIDO-BDIIVIDE90         END-IF91    STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",92       "*"             DELIMITED BY SIZE,93       NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",94        DELIMITED BY SIZE,95       INTO NOM-VAL-BDIIVIDE9697 INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "98 INSPECT NOM-VALVIDE REPLACING ALL ";" BY " "99 INITIALIZE NOM-LEIDO-BDIIVIDE600 MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.601602 85020-UBICA-NIT.603*================================================================604*85020-UBICA-NIT.605*Ubica NIT en archivo de la DIAN, BDIIDIAN606*================================================================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622END-READ623IF SW-ID-BDIIVIDE = 0624MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"            RMB0013      4628$IF HACERMATCH = "SI"                                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                                          RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                       RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIASSTRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "   INTO NOMQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOM-VAL-BDIIVIDE<W-S>REY*BARBOSA*HENRY*               ;                                                        :   NOM-VAL-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOM-VAL-BDIIVIDENOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOM-VAL-BDIIVIDE<W-S>REY*BARBOSA*HENRY*               ;                                                        :   NOM-VAL-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOM-VAL-BDIIVIDENOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEINITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407IF SW-VERIFNOM= 1408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411 IF SW-ID-BDIIVIDE = 0412    IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413       NUM-BLOQUES-BDIIVIDE <> ZEROS414       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415ELSE IF TIP-ID-INPUT-VALNOM = 1416                 MOVE 2 TO BLOQUES-INPUT-VALNOM417                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418                  END-IF419             END-IF420             PERFORM 10000-MATCH-NOMBRES-VALNOM421        IF MATCH-OK-OUT-VALNOM = 0422           MOVE 1 TO SW-NOMBRES-BDIIVIDE423        END-IF424     END-IF425END-IF426 ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428           END-IFFAC0002      4429      END-IF                                                      FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441     EVALUATE TIP-IDE-BDIIVIDE442       WHEN 1443         PERFORM 85010-UBICA-CEDULA444       WHEN 2445         PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NUM-BLOQUES-BDIIVIDE NUMERIC ANDMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM9260*CON EL NOMBRE ENVIADO EN LA CONSULTA.9261******************************************************************9262MOVE 0 TO MATCH-OK-OUT-VALNOM.9263MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9264IF TIP-ID-INPUT-VALNOM  = 29265INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9266 " S.A. " BY "      ",                     RMB0002      9267 "." BY " ", " LTDA " BY "      ",          RMB0002      9268 " LIMITADA " BY "   ",RMB0002      9269" CIA " BY "     ", " COMPA/IA " BY "",RMB0002      9270" INVERSIONES " BY "             ",RMB0002      9271" EMPRESA " BY "         ",                            RMB0002      9272" CORPORACION " BY "             ",RMB0002      9273" DE " BY "    ", " LA " BY "    ", " DEL " BY "",RMB0002      9274" S " BY "   ", " A " BY "   "            RMB0002      9275" Y " BY "   "GJC0003      9276INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9277" S.A. " BY "      ",               RMB0002      9278"." BY " ", " LTDA " BY "      ",RMB0002      9279" LIMITADA " BY "          ",     RMB0002      9280" CIA " BY "", " COMPA/IA " BY "",RMB0002      9281 " INVERSIONES " BY "",RMB0002      9282    " EMPRESA " BY "",RMB0002      9283     " CORPORACION " BY "  ",RMB      9284" DE " BY "    ", " LA " BY "", " DEL " BY "",RMB      9285" S " BY "   ", " A " BY "   "RMB      9286     " Y " BY "   "GJ3      9287     INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9288       "." BY " ","-" BY " ",GJC0003      9289"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9290                "Y" BY "G","H" BY "G","I" BY "G"GJC0003      9291         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9292                "." BY " ","-" BY " ",GJC0003      9293                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9294                "Y" BY "G","H" BY "G","I" BY "G"       GJC0003      9295         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM9296     ELSE9297        INSPECT CADENA-VALNOM    REPLACING ALL9298            "." BY " ","-" BY " ", "," BY " ",9299         "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9300       "Y" BY "G","H" BY "G","I" BY "G",9301         " DE " BY ""," LA " BY "",9302       " DEL " BY "     "9303 INSPECT CADENA-VALNOMREPLACING ALLRMB0002      9304        "." BY " ","-" BY " ", "," BY " ",9305         "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002    MOVE 0 TO MATCH-OK-OUT-VALNOM.MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.IF TIP-ID-INPUT-VALNOM  = 2IF TIP-ID-INPUT-VALNOM  = 2INSPECT CADENA-VALNOMREPLACING ALLINSPECT CADENA-VALNOMREPLACING ALLINSPECT CADENA-VALNOMREPLACING ALLRMB0002    INSPECT CADENA-VALNOMREPLACING ALLRMB0002    301         " DE " BY "    "," LA " BY "    ",302                " DEL " BY "     "303   INSPECT CADENA-VALNOM    REPLACING ALLRMB0002      9304            "." BY " ","-" BY " ", "," BY " ",305           "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002      9306       "Y" BY "G","H" BY "G","I" BY "G",RMB0002      9307     " DE " BY "    "," LA " BY "",      9308     " DEL " BY "     "          9309     PERFORM VARYING I-VALNOM FROM 1 BY 1310             UNTIL I-VALNOM >= 66311       IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC312           AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC313          MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)314       END-IF315     END-PERFORM316END-IF.317MOVE SPACES TO VECTOR-INPUT-VALNOM.318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO319       BASURA-VALNOM320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)325VM-INPUT-VALNOM(14)326VM-INPUT-VALNOM(15)327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)328VM-INPUT-VALNOM(19)329VM-INPUT-VALNOM(20)330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.332IF TIP-ID-INPUT-VALNOM  NOT = 2333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL334 "." BY " ","-" BY " ","," BY " ",335CS","ZS","J,"V" BY "B",336       "Y" BY "G","H" BY "G","I" BY "G"337    PERFORM VARYING I-VALNOM FROM 1 BY 1338                UNTIL I-VALNOM >= 66339 IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC340      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC41     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)42  END-IF43END-PERFORM44ELSE45INSPECT NOMBRE-AUX-VALNOM REPLACING ALL   RMB0002    46" S.A.       ",                                INSPECT CADENA-VALNOMREPLACING ALLRMB0002    PERFORM VARYING I-VALNOM FROM 1 BY 1Options   3=CSI F5=CSI-enter-name F6=CSI-word-at-cursor < /> =scroll-up/down Esc                                                          F9/F10=fast-scroll-up/down   Animate   2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Options   3=CSI F5=CSI-enter-name F6=CSI-word-at-cursor < /> =scroll-up/down Esc                                                          F9/F10=fast-scroll-up/down   Animate   2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Options   3=CSI F5=CSI-enter-name F6=CSI-word-at-cursor < /> =scroll-up/down Esc                                                          F9/F10=fast-scroll-up/down   Animate   2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Options   3=CSI F5=CSI-enter-name F6=CSI-word-at-cursor < /> =scroll-up/down Esc                                                          F9/F10=fast-scroll-up/down   Animate   2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Options   3=CSI F5=CSI-enter-name F6=CSI-word-at-cursor < /> =scroll-up/down Esc                                                          F9/F10=fast-scroll-up/down   Animate   2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM VARYING I-VALNOM FROM 1 BY 1IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICDEL " 
VARYING IQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsI-VALNOM<W-S>Y 100001      :   I-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   I-VALNOM FROM 1 BY 1VALNOM >= 66LNOM(I-VALNOM) NOAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   







Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setMOVE SPACES TO VECTOR-INPUT-VALNOM.                                     AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stopI100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406

Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9301" DE " BY ""," LA " BY "",9302" DEL " BY ""9303INSPECT CADENA-VALNOMREPLACING ALLRMB0002      9304"." BY " ","-" BY " ", "," BY " ",9305"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002      9306"Y" BY "G","H" BY "G","I" BY "G",RMB0002      9307" DE " BY ""," LA " BY "",RMB0002      9308" DEL " BY ""RMB0002      9309PERFORM VARYING I-VALNOM FROM 1 BY 19310UNTIL I-VALNOM >= 669311IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9312AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9313MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9314END-IF9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICMOVE SPACES TO VECTOR-INPUT-VALNOM.    Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE SPACES TO VECTOR-INPUT-VALNOM.    UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOUNSTRING CADENA-Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCADENA-VALNOM<W-S>A GENRG REG BARBOSA                                                                                 :   CADENA-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CADENA-VALNOM      DELIMITED BY ALL " " INTO    BASURA-VALNOM-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)-VALNOM(4) VM-INPUT-VALNOM(5)AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOMOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.IF TIP-ID-INPUT-VALNOM  NOT = 2IF TIP-ID-INPUT-VALNOM  NOT = 2INSPECT NOMBRE-AUX-VALNOM REPLACING ALLINSPECT NOMBRE-AUX-VALNOM REPLACING ALLPERFORM VARYING I-VALNOM FROM 1 BY 1PERFORM VARYING I-VALNOM FROM 1 BY 1IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC


IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC28VM-INPUT-VALNOM(19)29VM-INPUT-VALNOM(20)30******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********31MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.32IF TIP-ID-INPUT-VALNOM  NOT = 233INSPECT NOMBRE-AUX-VALNOM REPLACING ALL34 "." BY " ","-" BY " ","," BY " ",35C" BY "S","Z" BY "S","J" BY "G","V" BY "B",36"Y" BY "G","H" BY "G","I" BY "G"37PERFORM VARYING I-VALNOM FROM 1 BY 138      UNTIL I-VALNOM >= 6639IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC40 AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC41   MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)42  END-IF43       END-PERFORM44ELSE45    INSPECT NOMBRE-AUX-VALNOM REPLACING ALL          RMB0002    46" S.A. " BY "      ",RMB0002    47     "." BY " ", " LTDA " BY "      ",                  RMB0002    48     " LIMITADA " BY "          ",   RMB0002    49     " CIA " BY "     ", " COMPA/IA " BY "          ",  RMB0002    50     " INVERSIONES " BY "             ",RMB0002    51     " EMPRESA " BY "         ",                            RMB0002    52     " CORPORACION " BY "",RMB0002    53     " DE " BY "    ", " LA " BY "", " DEL " BY "",RMB0002    54     " S " BY "   ", " A " BY "   "                         RMB0002    55     " Y " BY "   "GJC0003    56   INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002    57           " S.A. " BY "      ",                                  RMB0002    58      "." BY " ", " LTDA " BY "      ",       RMB0002    59      " LIMITADA " BY "          ",RMB0002    60   " CIA " BY "     ", " COMPA/IA " BY "",RMB0002    61" INVERSIONES " BY "             ",    RMB0002    62" EMPRESA " BY "         ",                      RMB0002    63" CORPORACION " BY "             ",  RMB0002    64" DE " BY "    ", " LA " BY "    ", " DEL " BY "",RMB0002    65" S " BY "   ", " A " BY "   "   RMB0002    66" Y " BY "   "                                    GJC0003    67INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003    68"." BY " ","-" BY " ",                    GJC0003    69"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003    70"Y" BY "G","H" BY "G","I" BY "G"GJC0003    71    MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM72END-IF.73MOVE SPACES TO VECTOR-OK-VALNOM.








IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICEND-PERFORMEND-PERFORMIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC

































Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setMOVE SPACES TO VECTOR-OK-VALNOM.                                        AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stopI100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406

Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002      9361" INVERSIONES " BY "",RMB0002      9362" EMPRESA " BY "",RMB0002      9363" CORPORACION " BY "",RMB0002      9364" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9365" S " BY "   ", " A " BY "   "RMB0002      9366" Y " BY "   "GJC0003      9367INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9368"." BY " ","-" BY " ",GJC0003      9369"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9370"Y" BY "G","H" BY "G","I" BY "G"GJC0003      9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                        ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopIF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETICMOVE SPACES TO VECTOR-OK-VALNOM.    Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
    MOVE NOMQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBRE-AUX-VALNOM<W-S>REG BARBOSA GENRG                                                                                          :   NOMBRE-AUX-      clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   VALNOM<W-S>Level=**Speed=5InsCapsNu   NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOMES TO VECTOR-OK-VALNOM.                                 AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE SPACES TO VECTOR-OK-VALNOM.    69          "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003    70          "Y" BY "G","H" BY "G","I" BY "G"GJC0003    71         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM72END-IF.73MOVE SPACES TO VECTOR-OK-VALNOM.                                        74UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO75 BASURA-VALNOM76VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77VM-OK-VALNOM(4) VM-OK-VALNOM(5)78VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79VM-OK-VALNOM(9) VM-OK-VALNOM(10)80VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81VM-OK-VALNOM(14) VM-OK-VALNOM(15)82VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83VM-OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91 ADD 1 TO BLOQOK-AUX-VALNOM92 MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93                VM-INPUT-VALNOM(I-VALNOM)94 MOVE 21 TO J-VALNOM95ELSE96 MOVE 0 TO M-VALNOM97   INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98         FOR CHARACTERS BEFORE INITIAL "*"99 IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401    INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)                   GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408       MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410  VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411  PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414             MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)   UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOUNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOMOVE 1 TO I-VALNOM.MOVE 1 TO I-VALNOM.MOVE 0 TO BLOQOK-AUX-VALNOM.MOVE 0 TO BLOQOK-AUX-VALNOM.PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACESPERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACESMOVE 1 TO J-VALNOMMOVE 1 TO J-VALNOMPERFORM UNTIL J-VALNOM > 20PERFORM UNTIL J-VALNOM > 20IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMIF M-VALNOM >= 15IF M-VALNOM >= 15MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMEND-IFEND-IFIF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 2041END-IF42END-IF42END-IF42    ADD 1 TO J-VALNOM42  END-PERFORM42  ADD 1 TO I-VALNOM42IF I-VALNOM = 2142    NEXT SENTENCE42 END-IF42END-PERFORM.42IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM43  MOVE 1 TO MATCH-OK-OUT-VALNOM43ELSE43  IF TIP-ID-INPUT-VALNOM <> 243     PERFORM 10100-MATCH-APROXIMADO434        ELSE43      PERFORM 10100-MATCH-APROX-EMPRESAS43   END-IF43   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM43    MOVE 1 TO MATCH-OK-OUT-VALNOM43 END-IF44END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443*EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.44IF BLOQOK-AUX-VALNOM > 044MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM5ELSE5MOVE 70 TO APROX-TOT APROX-INP-VALNOM5END-IF5MOVE 1 TO I-VALNOM.5PERFORM UNTIL I-VALNOM > 105MOVE 1 TO J-VALNOM5PERFORM UNTIL J-VALNOM > 105MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM5MOVE 1 TO K-VALNOM5MOVE 1 TO L-VALNOM6IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND6VM-OK-VALNOM   (J-VALNOM) NOT = SPACES6PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 156IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =6VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)END-IFADD 1 TO J-VALNOMADD 1 TO J-VALNOMEND-PERFORMEND-PERFORM388MOVE 1 TO J-VALNOM389PERFORM UNTIL J-VALNOM > 20390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)391   ADD 1 TO BLOQOK-AUX-VALNOM392     MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)393                    VM-INPUT-VALNOM(I-VALNOM)394     MOVE 21 TO J-VALNOM395ELSE396     MOVE 0 TO M-VALNOM397       INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM398               FOR CHARACTERS BEFORE INITIAL "*"399    IF M-VALNOM >= 1500    MOVE 0 TO M-VALNOM01       INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM02         FOR CHARACTERS BEFORE INITIAL "N"03    END-IF04 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 2005       AND (14 - M-VALNOM > 0)GJC0005    06       COMPUTE INI-VALNOM = M-VALNOM + 207    COMPUTE LON-VALNOM = 14 - M-VALNOM08       MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM09          IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =10                  VM-INPUT-VALNOM(I-VALNOM + 1 ) AND11                  PEDAZO-VALNOM(1:M-VALNOM) =12             VM-INPUT-VALNOM(I-VALNOM)13             ADD 1 TO BLOQOK-AUX-VALNOM14             MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)15                           VM-INPUT-VALNOM(I-VALNOM)16                  MOVE 21 TO J-VALNOM17             ADD 1 TO I-VALNOM18          MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)19    END-IF20    END-IF21    END-IF22    ADD 1 TO J-VALNOM23  END-PERFORM24ADD 1 TO I-VALNOM25IF I-VALNOM = 2126 NEXT SENTENCE27END-IF28END-PERFORM.29IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM30MOVE 1 TO MATCH-OK-OUT-VALNOM31ELSE32IF TIP-ID-INPUT-VALNOM <> 233PERFORM 10100-MATCH-APROXIMADOIF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMIF M-VALNOM >= 15IF M-VALNOM >= 15MOVE 0 TO M-VALNOMMOVE 0 TO M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMINSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOMEND-IFEND-IFIF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20END-IFEND-IFADD 1 TO J-VALNOMADD 1 TO J-VALNOMEND-PERFORMEND-PERFORMIF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)






































Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setIF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                            AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stopI100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320   440406

Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100002859753ERNESTO RICO0050672013040602206720   1004354000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002859753ERNESTO RICO0050672013040602206720   100435Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   1114064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320   111406Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOM9417ADD 1 TO I-VALNOM9418MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)9419END-IF9420END-IF9421END-IF9422ADD 1 TO J-VALNOM9423END-PERFORM9424ADD 1 TO I-VALNOM9425IF I-VALNOM = 219426NEXT SENTENCE9427END-IF9428END-PERFORM.9429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                              9430MOVE 1 TO MATCH-OK-OUT-VALNOM9431ELSE9432IF TIP-ID-INPUT-VALNOM <> 29433PERFORM 10100-MATCH-APROXIMADOZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopIF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM    Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM    427END-IF428END-PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                              9430MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432IF TIP-ID-INPUT-VALNOM <> 2433PERFORM 10100-MATCH-APROXIMADO434ELSE435PERFORM 10100-MATCH-APROX-EMPRESAS436END-IF437IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438MOVE 1 TO MATCH-OK-OUT-VALNOM39END-IF40END-IF.41**********************************************************************42*10100-MATCH-APROXIMADO.43*EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS44*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON45*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.46**********************************************************************47 10100-MATCH-APROXIMADO.48IF BLOQOK-AUX-VALNOM > 049MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM50ELSE51MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM52END-IF53MOVE 1 TO I-VALNOM.54PERFORM UNTIL I-VALNOM > 1055MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61   VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62     PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563       IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =64          VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)65       OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66      AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67            OR = "N"))GJC0003    68            IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES69            ADD 1 TO LETRAS-OK-VALNOM70    ADD 1 TO K-VALNOM71            ADD 1 TO L-VALNOM72      ELSE   MOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsSW-ID-BDIIVIDE<W-S>0                :   SW-ID-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   SW-ID-BDIIVIDE = 1 es un id inválido call "PONERR" using "1AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsSW-NOMBRES-BDIIVIDE<W-S>0                         :   SW-NOMBRES-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   SW-NOMBRES-BDIIVIDE = 1    * call "PONERR" using "15" JU display "novedad:  " JURAD-AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"display "4222-VALIDA-NOMBRE-COINCIDE"5657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69 not invalid key70move 0 to SW-BDIIALE71read BDIIALE next record72at end73    move 1 to SW-BDIIALE74    end-read75end-start7677     perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79     or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80         if FUENTE-BDIIALE = 99000381         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82     and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83    and BLOQUEO-BDIIALE = 084     encontrado85     move 1 to SW-BDIIALE86    end-if87 if SW-BDIIALE = 088    read BDIIALE next record at end89       move 1 to SW-BDIIALE90end-read91end-if92     end-perform.9394     if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97     else98        if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOS


      


      


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressjurad-reg.                                                              r

e

g

-

b

d

i

i

a

l

e

end-perform.if TIP-IDE-BDIIVIDE = 1    if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1REG-BDIIALE<W-S>100003306940990003004        2010072120171212201007210                            HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION DE IDENTIDAD                                      :   REG-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    end-perform. if TIP-IDE-BDIIVIDE = 1     if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1         move 07 to CODIGO-ERROR     elseAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 192end-perform.9394 if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97         else98         if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCREGIS501            add 1 to CONT-FALLECIDOS502        end-if503    end-if504end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524******************************************************************525IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526ADD 1 TO W-CONT-TIPO-6527ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529ADD 1 TO W-CONT-TIPO-7530    ELSE531*    registros correctos, repetidos o no532ADD 1 TO W-CONT-TIPO-5533*    si es una empresa534IF TIPOID-E = 2 OR 3535ADD 1 TO W-CONT-TIPO-5-PJ36END-IF37END-IFif TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21end-if        move 06 to COQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCODIGO-ERROR<W-S>00            :   CODIGO-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CODIGO-ERROR-COINCIDE-REGISNT-FALLECIDOSAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   end-ifend-if.end-if.36    else37perform 4222-VALIDA-NOMBRE-COINCIDE38    end-if39end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"444******************************************************************445* Validación de IDs que figuran OK pero el nombre no coincide446******************************************************************447*nombre no coincide448IF TIP-IDE-BDIIVIDE = 1449*es una cédula450MOVE 02 TO CODIGO-ERROR451     ELSE452*    no es una cédula453         MOVE 01 TO CODIGO-ERROR454 END-IF.455456457 4222-VALIDA-NOMBRE-COINCIDE.458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"459******************************************************************460* Validación de IDs que figuran OK pero el nombre coincide461******************************************************************462nombre coincide: busca ID en BDIIALE463 initialize LLAVE-BDIIALE464 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE465 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE466 move 990003 to FUENTE-BDIIALE467 start BDIIALE key not < LLAVE-BDIIALE INVALID KEY468         move 1 TO SW-BDIIALE469not invalid key470move 0 to SW-BDIIALE471    read BDIIALE next record472at end473move 1 to SW-BDIIALE474end-read475 end-start476477 perform until SW-BDIIALE = 1478or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480if FUENTE-BDIIALE = 990003481and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3END-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASperform 4300-MODIFICAR-BDIIALE560561 4300-MODIFICAR-BDIIALE.562Ddisplay "4300-MODIFICAR-BDIIALE"563******************************************************************564* Se impacta el archivo BDIIALE con una o dos inserciones,565* modificaciones o eliminaciones segun haya o no demandas y566* embargos567******************************************************************568 initialize REG-BDIIALE569570*    si hay demandas571     if JURAD-demandas-vigentes > zero572 or JURAD-demandas-terminadas > zero57    move "J001" to LLASEC-BDIIALE574*arma datos de demandas57JURAD-demandas-vigentes to D-vigentes57    move JURAD-demandas-terminadas to D-terminados577     string "20" JURAD-demandas-fecha-ultima57    delimited size into D-fecha-ultima57perform 4300-MODIFICAR-BDIIALE-DATOS58.581582*si hay embargos58if JURAD-embargos-vigentes > zero584 or JURAD-embargos-terminados > zero585     move "J002" to LLASEC-BDIIALE586*    arma datos de embargos58move JURAD-embargos-vigentes to D-vigentes58    move JURAD-embargos-terminados to D-terminados589     string "20" JURAD-embargos-fecha-ultimo59    delimited size into D-fecha-ultima59perform 4300-MODIFICAR-BDIIALE-DATOS59.593594595596 4300-MODIFICAR-BDIIALE-DATOS.597Ddisplay "4300-MODIFICAR-BDIIALE-DATOS"598******************************************************************599* Parte de la carga de datos en el registro BDIIALE y grabacion600* del mismo que es comun a demandas y embargos601* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"602******************************************************************603*completa la clave e intenta leer la alerta, si se leyo OK604*l file status de BDIIALE queda con "00"60perform 4333-LEER-BDIIALE-RANDOM

      

      

      display "4300-MODIFICAR-BDIIALE"initialize REG-BDIIALEinitialize REG-BDIIALEif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALEmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSdisplay "4300-MODIFICAR-BDIIALE-DATOS"display "4300-MODIFICAR-BDIIALE-DATOS"9596-DATOS.97display "4300-MODIFICAR-BDIIALE-DATOS"9899* Parte de la carga de datos en el registro BDIIALE y grabacion600* del mismo que es comun a demandas y embargos601* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"602603*completa la clave e intenta leer la alerta, si se leyo OK604*el file status de BDIIALE queda con "00"605 perform 4333-LEER-BDIIALE-RANDOM606607*procesa segun el tipo de novedad I M E608evaluate JURAD-tipo-novedad609 when "I"610add 1 to N-reg-tipo-I-OK611perform 4300-MODIFICAR-BDIIALE-I612when "M"613add 1 to N-reg-tipo-M-OK614M615when "E"616add 1 to N-reg-tipo-E-OK617     perform 4300-MODIFICAR-BDIIALE-E618when other619*    esto es "imposible" por control de consistencia anterior620display "error de logica: tipo-novedad="621 JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos622display "Registro de JURAD: " display JURAD-reg623perform 9000-CANCELAR-PROGRAMA624end-evaluate.625626627 4300-MODIFICAR-BDIIALE-I.628Ddisplay "4300-MODIFICAR-BDIIALE-I"629******************************************************************630* Insercion de una alerta nueva631* Si ya existia muestra un mensaje y continua632******************************************************************633*    si el registro existia es un error634     if EST-BDIIALE = "00"35         display "Insercion de alerta nueva que ya existe "36         " key: " LLAVE-BDIIALE37         display "Registro de input: "38     display JURAD-reg39     display "Datos en la alerta: " INF-DATAHOST-BDIIALE40    add 1 to N-ale-ya-existe
      
      
      display "4300-MODIFICAR-BDIIALE-DATOS"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM709710 4333-LEER-BDIIALE-RANDOM.711display "4333-LEER-BDIIALE-RANDOM"712713* Arma clave exacta y lee un registro de BDIIALE714* Usa los datos del reg input, excepto LLASEC que esta precargado715* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"716717 move JURAD-id-tipo to TIP-IDE-BDIIALE718 move JURAD-id-numero to NUM-IDE-BDIIALE719move P-cod-suscriptor to FUENTE-BDIIALE720move 000 to COD-ALERTA-BDIIALE721LLASEC-BDIIALE fué previamente cargado con J001 o J002722723read BDIIALE724evaluate EST-BDIIALE725when "00"726    continue727when "23"728continue729other730display "Error al leer BDIIALE fs: " EST-BDIIALE731" key: " LLAVE-BDIIALE732    display "Ultimo registro procesado: "733 display JURAD-reg-anterior734perform 9000-CANCELAR-PROGRAMA735end-evaluate.736*display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE737*" fs:" EST-BDIIALE.738739740 4333-GRABAR-BDIIALE.741D    display "4333-GRABAR-BDIIALE"742******************************************************************743* Inserta un registro nuevo en BDIIALE744******************************************************************745     if not PROCESO-REAL746         exit paragraph747 end-if748write REG-BDIIALE749evaluate EST-BDIIALE750when "00"751add 1 to N-ale-insertadas752when other753Error al grabar BDIIALE fs: " EST-BDIIALE754" key: " LLAVE-BDIIALE

      

      

      display "4333-LEER-BDIIALE-RANDOM"move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALEread BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEcontinuecontinue606607*    procesa segun el tipo de novedad I M E608 evaluate JURAD-tipo-novedad609     when "I"610         add 1 to N-reg-tipo-I-OK611         perform 4300-MODIFICAR-BDIIALE-I612     when "M"613         add 1 to N-reg-tipo-M-OK614    perform 4300-MODIFICAR-BDIIALE-M615when "E"616    add 1 to N-reg-tipo-E-OK617    perform 4300-MODIFICAR-BDIIALE-E618 when other619*esto es "imposible" por control de consistencia anterior620    display "error de logica: tipo-novedad="621    JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos622    display "Registro de JURAD: " display JURAD-reg623perform 9000-CANCELAR-PROGRAMA624end-evaluate.625626627 4300-MODIFICAR-BDIIALE-I.628Ddisplay "4300-MODIFICAR-BDIIALE-I"629******************************************************************630* Insercion de una alerta nueva631* Si ya existia muestra un mensaje y continua632******************************************************************633si el registro existia es un error634 if EST-BDIIALE = "00"635display "Insercion de alerta nueva que ya existe "636" key: " LLAVE-BDIIALE637         display "Registro de input: "638     display JURAD-reg639         display "Datos en la alerta: " INF-DATAHOST-BDIIALE640         add 1 to N-ale-ya-existe641     end-if642643*completa los datos del registro644initialize ENCABEZADO-BDIIALE645move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE646FEC-REP-BDIIALE647move P-fecha-proceso-50 to FEC-VEN-BDIIALE648move 0 to BLOQUEO-BDIIALE649move D-datahost to INF-DATAHOST-BDIIALE650perform 4320-ARMAR-TEXTO-ALERTA651if EST-BDIIALE = "00"evaluate JURAD-tipo-novedadadd 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Idisplay "4300-MODIFICAR-BDIIALE-I"
      
      
      display "4300-MODIFICAR-BDIIALE-I"if EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "
      
      
      display "Insercion de alerta nueva que ya existe "display "Registro de input: "
      
      
      display "Registro de input: "display JURAD-reg
      
      
      display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALE
      
      
      display "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeend-ifend-if51if EST-BDIIALE = "00"52     perform 4333-REGRABAR-BDIIALE53lse54    perform 4333-GRABAR-BDIIALE55end-if.56*display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE57*" fs:" EST-BDIIALE.585960 4300-MODIFICAR-BDIIALE-M.61Ddisplay "4300-MODIFICAR-BDIIALE-M"62******************************************************************63* Modificacion de una alerta existente64* Si no existia muestra un mensaje y continua65******************************************************************66*si el registro no existia es un error67if EST-BDIIALE not = "00"68display "Modificacion de alerta inexistente "69    " key: " LLAVE-BDIIALE70display "Registro de input: "71display JURAD-reg72         display "Datos en la alerta: " INF-DATAHOST-BDIIALE73     add 1 to N-ale-no-existe74         call "PONERR" using "17" JURAD-reg E-errores75     end-if76*    reemplaza la fecha de reportlos valores77     move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE78 move D-datahost to INF-DATAHOST-BDIIALE79perform 4320-ARMAR-TEXTO-ALERTA80if EST-BDIIALE = "00"81perform 4333-REGRABAR-BDIIALE82else83perform 4333-GRABAR-BDIIALE84end-if.85*display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE86*" fs:" EST-BDIIALE.878889 4300-MODIFICAR-BDIIALE-E.90Ddisplay "4300-MODIFICAR-BDIIALE-E"91******************************************************************92* Eliminacion de una alerta93* Si no existia muestra un mensaje y continua94******************************************************************95*elimina el registro960607*procesa segun el tipo de novedad I M E08valuate JURAD-tipo-novedad09when "I"10    add 1 to N-reg-tipo-I-OK11     perform 4300-MODIFICAR-BDIIALE-I12 when "M"13add 1 to N-reg-tipo-M-OK14perform 4300-MODIFICAR-BDIIALE-M15     when "E"16     add 1 to N-reg-tipo-E-OK17         perform 4300-MODIFICAR-BDIIALE-E18     when other19*        esto es "imposible" por control de consistencia anterior20         display "error de logica: tipo-novedad="21     JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos22    display "Registro de JURAD: " display JURAD-reg23perform 9000-CANCELAR-PROGRAMA24end-evaluate.252627 4300-MODIFICAR-BDIIALE-I.28Ddisplay "4300-MODIFICAR-BDIIALE-I"29******************************************************************30* Insercion de una alerta nueva31* Si ya existia muestra un mensajcontinua32******************************************************************33*si el registro existia es un error34if EST-BDIIALE = "00"35    display "Insercion de alerta nueva que ya existe "36" key: " LLAVE-BDIIALE37    display "Registro de input: "38display JURAD-reg39    display "Datos en la alerta: " INF-DATAHOST-BDIIALE40     add 1 to N-ale-ya-existe41 end-if4243*completa los datos del registro44     initialize ENCABEZADO-BDIIALE45 move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE46     FEC-REP-BDIIALE47     move P-fecha-proceso-50 to FEC-VEN-BDIIALE48     move 0 to BLOQUEO-BDIIALE49     move D-datahost to INF-DATAHOST-BDIIALE50 perform 4320-ARMAR-TEXTO-ALERTA51end-ifinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAPerform-level      Exit View
      
      
      perform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if EST-BDIIALE = "00"50perform 4320-ARMAR-TEXTO-ALERTA51 if EST-BDIIALE = "00"52    perform 4333-REGRABAR-BDIIALE53else54perform 4333-GRABAR-BDIIALE55end-if.56*display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE57*" fs:" EST-BDIIALE.585960 4300-MODIFICAR-BDIIALE-M.61Ddisplay "4300-MODIFICAR-BDIIALE-M"62******************************************************************63* Modificacion de una alerta existente64* Si no existia muestra un mensaje y continua65******************************************************************66*si el registro no existia es un error67if EST-BDIIALE not = "00"68    display "Modificacion de alerta inexistente "69" key: " LLAVE-BDIIALE70display "Registro de input: "71         display JURAD-reg72     display "Datos en la alerta: " INF-DATAHOST-BDIIALE73         add 1 to N-ale-no-existe74         call "PONERR" using "17" JURAD-reg E-errores75     end-if76*    reemplaza la fecha de reporte y los valores77 move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE78move D-datahost to INF-DATAHOST-BDIIALE79perform 4320-ARMAR-TEXTO-ALERTA80if EST-BDIIALE = "00"81perform 4333-REGRABAR-BDIIALE82else83perform 4333-GRABAR-BDIIALE84end-if.85*display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE86*" fs:" EST-BDIIALE.878889 4300-MODIFICAR-BDIIALE-E.90Ddisplay "4300-MODIFICAR-BDIIALE-E"91******************************************************************92* Eliminacion de una alerta93* Si no existia muestra un mensaje y continua94******************************************************************95*elimina el registroperform 4333-REGRABAR-BDIIALE760761 4333-REGRABAR-BDIIALE.762Ddisplay "4333-REGRABAR-BDIIALE"763******************************************************************764* Regraba un registro modificado en BDIIALE765******************************************************************766 if not PROCESO-REAL767     exit paragraph76end-if76rewrite REG-BDIIALE770     evaluate EST-BDIIALE771 when "00"772         add 1 to N-ale-modificadas773     when other774         display "Error al regrabar BDIIALE fs: " EST-BDIIALE775         " key: " LLAVE-BDIIALE776     display "Registro BDIIALE: "77    display REG-BDIIALE77perform 9000-CANCELAR-PROGRAMA77end-evaluate.780781782 4333-ELIMINAR-BDIIALE.783Ddisplay "4333-ELIMINAR-BDIIALE"784******************************************************************785* Elimina un registro de BDIIALE786******************************************************************78if not PROCESO-REAL78    exit paragraph78end-if79delete 79evaluate EST-BDIIALE79when "00"79add 1 to N-ale-eliminadas79when other795     display "Error al deletear BDIIALE fs: " EST-BDIIALE796     " key: " LLAVE-BDIIALE79display "Registro BDIIALE: "79display REG-BDIIALE799         perform 9000-CANCELAR-PROGRAMA800 end-evaluate.801802 4800-PROCESO-REG-T.803D    display "4800-PROCESO-REG-T"80805* El registro leido en el archivo JURAD es tipo "T" con totales
      
      
      display "4333-REGRABAR-BDIIALE"if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraph578delimited size into D-fecha-ultima579         perform 4300-MODIFICAR-BDIIALE-DATOS580 end-if.581582*    si hay embargos583     if JURAD-embargos-vigentes > zero584or JURAD-embargos-terminados > zero585move "J002" to LLASEC-BDIIALE586*    arma datos de embargos587    move JURAD-embargos-vigentes to D-vigentes588    move JURAD-embargos-terminados to D-terminados589    string "20" JURAD-embargos-fecha-ultimo590delimited size into D-fecha-ultima591    perform 4300-MODIFICAR-BDIIALE-DATOS592end-if.593594595596 4300-MODIFICAR-BDIIALE-DATOS.597Ddisplay "4300-MODIFICAR-BDIIALE-DATOS"598******************************************************************599* Parte de la carga de datos en el registro BDIIALE y grabacion600* del mismo que es comun a demandas y embargos601* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"602603*    completa la clave e intenta leer la alerta, si se leyo OK604*    el file status de BDIIALE queda con "00"605perform 4333-LEER-BDIIALE-RANDOM606607*procesa segun el tipo de novedad I M E608evaluate JURAD-tipo-novedad609when "I"610    add 1 to N-reg-tipo-I-OK611perform 4300-MODIFICAR-BDIIALE-I612"M"613add 1 to N-reg-tipo-M-OK614perform 4300-MODIFICAR-BDIIALE-M615when "E"616add 1 to N-reg-tipo-E-OK6174300-MODIFICAR-BDIIALE-E618when other619*esto es "imposible" por control de consistencia anterior620         display "error de logica: tipo-novedad="621     JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos622         display "Registro de JURAD: " display JURAD-reg623         perform 9000-CANCELAR-PROGRAMAend-if.if JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALEmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimoperform 4300-MODIFICAR-BDIIALE-DATOSPerform-level      Exit View

      

      

      perform 4300-MODIFICAR-BDIIALE-DATOS331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349         call "PONERR" using "03" JURAD-reg E-errores350 end-if351     if JURAD-id-numero not > 0352         call "PONERR" using "04" JURAD-reg E-errores353     end-if354*    si el movimiento es una eliminacion los datos subsiguientes355*    no se controlan356 if JURAD-tipo-novedad = "E"357     exit paragraph358end-if359*Nombres y Apellidos360 if JURAD-nombre = spaces361    call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numeric369call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS376if not ANO-VAL or not MES-VAL or not DIA-VALAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   add 1 to N-reg-OK.264    controla el reg y lo aplica si es OK265    perform 4000-PROCESAR-REGISTRO-2266    move JURAD-reg to JURAD-reg-anterior267add 1 to REG-LEIDOS268when "10"269*fin del archivo de input:270*        esto es un error, no se encontro el registro "T" antes271*    de que se terminara el archivo272         display "Falta el reg de totales del archivo JURAD "273         display "Nombre del archivo: " P-file-name274         display "File status: " JURAD-fs275     display "Ultimo registro leido: " N-reg-leidos276    display JURAD-reg-anterior277perform 9000-CANCELAR-PROGRAMA278when other279*    error de lectura: cancelacion del proceso280     display "Error en lectura del archivo JURAD "281    display "Nombre del archivo: " P-file-name282display "File status: " JURAD-fs283    display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285perform 9000-CANCELAR-PROGRAMA286evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296 move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00     call "PONERR" using "01" JURAD-reg E-errores01end-if0203*si es el registro "T" hay que señalar el fin de proceso04 if JURAD-tipo-novedad = "T"05    move "SI" to IND-fin-proceso06perform 4800-PROCESO-REG-T07    exit paragraph08end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************

         

         

         display "4000-PROCESAR-REGISTRO"read JURADread JURADevaluate JURAD-fsevaluate JURAD-fsdisplay " "Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressreg-bdiiale.                                                            j

u

r

a

d

-

r

e

g

display " "display " "display JURAD-regcontrola el reg y lo aplica si es OK14-S Invalid operand AnimateCARGAJUR.gnt/.o/.exe   view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</>   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressjurad-regle.                                                            jurad-regle 

 

 




display " "display " "display JURAD-regcontrola el reg y lo aplica si es OKJURAD-REG<W-S>I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806:   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    display " " display " " display JURAD-reg controla el reg y lo aplica si es OKAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

         

         

         display " "display " "

         

         

         display " "display JURAD-regZoom   Ctrl+C to stop111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango

4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTROError 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064900-GRABAR-ERROR
000-PROCESAR-REGISTRO



I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay JURAD-regdisplay "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   display "4000-PROCESAR-REGISTRO-2"   8889-2.90display "4000-PROCESAR-REGISTRO-2"                                      9192* Controla los datos de un registro de JURAD y si es OK lo usa93* para actualizar el archivo de alertas en linea94* La informacion esta leida en JURAD-reg95****************************************************************96move "NO" to E-hay-error9798*validacion del tipo de movimiento99 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300 call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305move "SI" to IND-fin-proceso306    perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313move 0 to codigo-error314perform 4100-VALIDACION-FORMAL315if E-hay-error = "SI"316    perform 4900-GRABAR-ERROR317perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332     perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.Zoom   Ctrl+C to stop4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO



I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806


      
   
   
   
   4000-PROCESAR-REGISTRO-2000-PROCESAR-REGISTRO


I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2

      
   
   
   
   4100-VALIDACION-FORMAL

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
      
   
   
   
   
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMALI100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406

4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806130406
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806   
   
   
   
      Error    
   
   
   
      
13   
   
   
   
          
   
   
   
      Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL


I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango

   
   
   
   
      4900-GRABAR-ERROR100-VALIDACION-FORMAL

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR
   
   
   
   
      4000-PROCESAR-REGISTRO
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO   
   
   
   
      I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120   130406

Error 07 Numero de demandas terminadas: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO   
   
   
   
      130406
Error 07 Numero de demandas terminadas: debe ser numerico

4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTROError 07 Numero de demandas terminadas: debe ser numerico
4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064900-GRABAR-ERROR
000-PROCESAR-REGISTRO



I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO



I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406


   
   
   
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO



I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406


   
   
   
      
   4000-PROCESAR-REGISTRO-2000-PROCESAR-REGISTRO


I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2

   
   
   
      
   4100-VALIDACION-FORMAL

I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   perform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitors14-S Invalid operand AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress   jurad-reg.                                                                       e

   -

   h

   

   y

   

   e

   r

   r

   o

   r

perform 4200-VALIDACION-SEMANTICA                      if E-hay-error = "SI"    perform 4900-GRABAR-ERROR    perform 4240-CONTAR-TIPO-CUENTAE-HAY-ERROR<W-S>   NO                I":   E-HAY-ERROR<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    perform 4200-VALIDA    if E-hay-error = "SI"     perform 4900-GRAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"     3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441      

            

         move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3Zoom   Ctrl+C to stop
I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopIF TIP-IDE-BDIIVIDE = 2 OR 3perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop
I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85020-UBICA-NITQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddresse-hay-error.                                                            j

u

r




d




r

e

g

 

 

 




PERFORM 85020-UBICA-NITEN 3PERFORM 85020-UBICA-NITEN 4JURAD-REG<W-S>I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406:   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    PERFORM 85020-UBICA-NITHEN 3 PERFORM 85020-UBICA-NITHEN 4AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 85020-UBICA-NIT605*Ubica NIT en archivla DIAN, BDIIDIAN606=============================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622     END-READ623     IF SW-ID-BDIIVIDE = 0624        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625     copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"                         RMB0013      4628$IF HACERMATCH = "SI"                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                                     RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                          RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                  REGISTRO DIRECC .6392017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640                 ORDENAN DE ACUERDO A LO DEFINIDO6412017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                         DE ESTANDARIZACION DE NOMBRES DE645*                      COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                   A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  * PROBABLE AUMENTANDO UN PESO CON BASE A LAMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEYREAD BDIIDIAN INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsDESCRIPCION-BDIIDIAN<W-S>SERVICULTIVOS LTDA.                                                            :   DESCRIPCION-BDIIDIAN<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEXT.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409  MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410     MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416                     MOVE 2 TO BLOQUES-INPUT-VALNOM417             ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418             END-IF419        END-IF420        PERFORM 10000-MATCH-NOMBRES-VALNOM421        IF MATCH-OK-OUT-VALNOM = 0422        MOVE 1 TO SW-NOMBRES-BDIIVIDE423        END-IF424          END-IF425       END-IF426      ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427              MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428     END-IFFAC0002      4429      END-IF                                                 FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441 EVALUATE TIP-IDE-BDIIVIDE442 WHEN 1443 PERFORM 85010-UBICA-CEDULA444   WHEN 2445 PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NUM-BLOQUES-BDIIVIDE NUMERIC ANDMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM9260*CON EL NOMBRE ENVIADO EN LA CONSULTA.9261******************************************************************9262MOVE 0 TO MATCH-OK-OUT-VALNOM.9263MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9264IF TIP-ID-INPUT-VALNOM  = 29265INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9266 " S.A. " BY "      ",                     RMB0002      9267 "." BY " ", " LTDA " BY "      ",          RMB0002      9268 " LIMITADA " BY "   ",RMB0002      9269" CIA " BY "     ", " COMPA/IA " BY "",RMB0002      9270" INVERSIONES " BY "             ",RMB0002      9271" EMPRESA " BY "         ",                            RMB0002      9272" CORPORACION " BY "             ",RMB0002      9273" DE " BY "    ", " LA " BY "    ", " DEL " BY "",RMB0002      9274" S " BY "   ", " A " BY "   "            RMB0002      9275" Y " BY "   "GJC0003      9276INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9277" S.A. " BY "      ",               RMB0002      9278"." BY " ", " LTDA " BY "      ",RMB0002      9279" LIMITADA " BY "          ",     RMB0002      9280" CIA " BY "", " COMPA/IA " BY "",RMB0002      9281 " INVERSIONES " BY "",RMB0002      9282    " EMPRESA " BY "",RMB0002      9283     " CORPORACION " BY "  ",RMB      9284" DE " BY "    ", " LA " BY "", " DEL " BY "",RMB      9285" S " BY "   ", " A " BY "   "RMB      9286     " Y " BY "   "GJ3      9287     INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9288       "." BY " ","-" BY " ",GJC0003      9289"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9290                "Y" BY "G","H" BY "G","I" BY "G"GJC0003      9291         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9292                "." BY " ","-" BY " ",GJC0003      9293                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9294                "Y" BY "G","H" BY "G","I" BY "G"       GJC0003      9295         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM9296     ELSE9297        INSPECT CADENA-VALNOM    REPLACING ALL9298            "." BY " ","-" BY " ", "," BY " ",9299         "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9300       "Y" BY "G","H" BY "G","I" BY "G",9301         " DE " BY ""," LA " BY "",9302       " DEL " BY "     "9303 INSPECT CADENA-VALNOMREPLACING ALLRMB0002      9304        "." BY " ","-" BY " ", "," BY " ",9305         "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002    MOVE 0 TO MATCH-OK-OUT-VALNOM.MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.IF TIP-ID-INPUT-VALNOM  = 2IF TIP-ID-INPUT-VALNOM  = 2INSPECT NOMBRE-AUX-VALNOM REPLACING ALLINSPECT NOMBRE-AUX-VALNOM REPLACING ALLINSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002    INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002    INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003    INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003    INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003    INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003    MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM






MOVE NOMQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBRE-AUX-VALNOM<W-S>SERBGSULTGBOS                                                                    :   NOMBRE-AUX-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOMT CADENA-VALNOM    REPLACING ALL   "." BY " ","-" BY " ", "," BY " ",AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   BRE-AUX-VALNOM TO NOMBQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBRE-INPUT-VALNOM<W-S>   SERVICULTIVOS LTDA                                         :   NOMBRE-INPUT-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOMBRE-INPUT-VALNOMPLACING ALL" ", "," BY " ",AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM315         END-PERFORM316     END-IF.317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO319             BASURA-VALNOM320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)325VM-INPUT-VALNOM(14)326VM-INPUT-VALNOM(15)327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)328VM-INPUT-VALNOM(19)329VM-INPUT-VALNOM(20)330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.332IF TIP-ID-INPUT-VALNOM  NOT = 2333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL334      "." BY " ","-" BY " ","," BY " ",335     "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",336     "Y" BY "G","H" BY "G","I" BY "G"337     PERFORM VARYING I-VALNOM FROM 1 BY 1338             UNTIL I-VALNOM >= 66339       IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC340           AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC341          MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)342         END-IF343END-PERFORM344ELSE345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346  " S.A. " BY "      ",                RMB0002      9347"." BY " ", " LTDA " BY "  ",RMB0002      9348" LIMITADA " BY "          ",                    RMB0002      9349" CIA " BY "     ", " COMPA/IA " BY ",RMB0002      9350  " INVERSIONES " BY "             ",        RMB0002      9351      " EMPRESA " BY "",RMB0002      9352   " CORPORACION " BY "             ",RMB0002      9353" DE " BY "    ", " LA " BY "    ", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "                   RMB0002    55" Y " BY "   "                        GJC0003    56INSPECT NOMBRE-AUX-VALNOM REPLACING ALL  RMB0002    57" S.A. " BY "      ",  RMB0002    58   "." BY " ", " LTDA " BY "      ",      59" LIMITADA " BY "          ",           RMB0002    60" CIA " BY "     ", " COMPA/IA " BY "                 UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOUNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOMOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.IF TIP-ID-INPUT-VALNOM  NOT = 2IF TIP-ID-INPUT-VALNOM  NOT = 2INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002    INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002    INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002    INSPECT NOQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBRE-AUX-VALNOM<W-S>    SERVICULTIVOS LTDA                                                                  :   NOMBRE-AUX-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOMBRE-AUX-VALNOM REPLACING ALL                  RMB     " BY "      ",                                  RMB     " ", " LTDA " BY "",RMB    TADA " BY "          ",                          RMB    
AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002    6" S " BY "   ", " A " BY "   "RMB0002    6      " Y " BY "   "GJC0003    6   INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003    6           "." BY " ","-" BY " ",                    GJC0003    6"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003    7          "Y" BY "G","H" BY "G","I" BY "G"              GJC0003    7   MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7END-IF.7MOVE SPACES TO VECTOR-OK-VALNOM.                                        7UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO7            BASURA-VALNOM7OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)7OK-VALNOM(4) VM-OK-VALNOM(5)7OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)7OK-VALNOM(9) VM-OK-VALNOM(10)80      VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)8 VM-OK-VALNOM(14) VM-OK-VALNOM(15)8 VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)8VM-OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************8MOVE 1 TO I-VALNOM.8MOVE 0 TO BLOQOK-AUX-VALNOM.8PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES8MOVE 1 TO J-VALNOM8PERFORM UNTIL J-VALNOM > 209IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9ADD 1 TO BLOQOK-AUX-VALNOM9MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9           VM-INPUT-VALNOM(I-VALNOM)9       MOVE 21 TO J-VALNOM9ELSE9 MOVE 0 TO M-VALNOM9 INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9         FOR CHARACTERS BEFORE INITIAL "*"9 IF M-VALNOM >= 1540    MOVE 0 TO M-VALNOM40    INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM40         FOR CHARACTERS BEFORE INITIAL "N"40 END-IF40 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 2040    AND (14 - M-VALNOM > 0)5      940      COMPUTE INI-VALNOM = M-VALNOM + 240    COMPUTE LON-VALNOM = 14 - M-VALNOM40    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM40    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =41       VM-INPUT-VALNOM(I-VALNOM + 1 ) ANDINSPECT NOMBRE-AUXQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBRE-AUX-VALNOM<W-S>    SERVICULTIVOS                                                                                             :   NOMBRE-AUX-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOMBRE-AUX-VALNOM REPLACING ALL                   GJ    "." BY " ","-" BY " ",                            GJ    "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJ    "Y" BY "G","H" BY "G","I" BY "G"                  GJ    AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003    MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOMMOVE NOMBQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBRE-AUX-VALNOM<W-S>SERBGSULTGBOS                                                                                          :   NOMBRE-AUX-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOMES TO VECTOR-OK-VALNOM.                                CADENA-VALNOM      DELIMITED BY ALL " " INTOAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOMEND-IF.END-IF.MOVE SPACES TO VECTOR-OK-VALNOM.   MOVE SPACES TO VECTOR-OK-VALNOM.   UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOUNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOMOVE 1 TO I-VALNOM.MOVE 1 TO I-VALNOM.83VM-OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090    IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91       ADD 1 TO BLOQOK-AUX-VALNOM92       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93         VM-INPUT-VALNOM(I-VALNOM)94      MOVE 21 TO J-VALNOM95   ELSE96      MOVE 0 TO M-VALNOM97      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98              FOR CHARACTERS BEFORE INITIAL "*"99      IF M-VALNOM >= 15400         MOVE 0 TO M-VALNOM401         INSPECTJ-VALNOM) TALLYING M-VALNOM402                    FOR CHARACTERS BEFORE INITIAL "N"403       END-IF404       IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405          AND (14 - M-VALNOM > 0)               GJC0005      9406        COMPUTE INI-VALNOM = M-VALNOM + 2407        COMPUTE LON-VALNOM = 14 - M-VALNOM408      MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409   IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410      VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411PEDAZO-VALNOM(1:M) =412      VM-INPUT-VALNOM(I-VALNOM)413    ADD 1 TO BLOQOK-AUX-VALNOM414      MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415               VM-INPUT-VALNOM(I-VALNOM)416MOVE 21 TO J-VALNOM417      ADD 1 TO I-VALNOM18   MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)19END-IF20END-IF21END-IF22ADD 1 TO J-VALNOM23END-PERFORM24ADD 1 TO I-VALNOM25IF I-VALNOM = 2126NEXT SENTENCE27END-IF28END-PERFORM.










































MOVE 1 TO I-VALNOM.427 END-IF428     END-PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                              9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432 IF TIP-ID-INPUT-VALNOM <> 2433    PERFORM 10100-MATCH-APROXIMADO434ELSE435PERFORM 10100-MATCH-APROX-EMPRESAS436END-IF437IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438MOVE 1 TO MATCH-OK-OUT-VALNOM439END-IF440END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443*EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS44*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON45*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.46**********************************************************************47 10100-MATCH-APROXIMADO.48IF BLOQOK-AUX-VALNOM > 049MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM50ELSE51MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM52END-IF53MOVE 1 TO I-VALNOM.54PERFORM UNTIL I-VALNOM > 1055MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =64     VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)65        OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66        AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67           OR = "N"))GJC0003    68          IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES69             ADD 1 TO LETRAS-OK-VALNOM70          ADD 1 TO K-VALNOM71      ADD 1 TO L-VALNOM72            ELSE
Zoom   Ctrl+C to stop
I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9427END-IF9428END-PERFORM.9429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                              9430MOVE 1 TO MATCH-OK-OUT-VALNOM9431ELSE9432IF TIP-ID-INPUT-VALNOM <> 29433PERFORM 10100-MATCH-APROXIMADO9434ELSE9435PERFORM 10100-MATCH-APROX-EMPRESAS9436END-IF9437IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM9438MOVE 1 TO MATCH-OK-OUT-VALNOM9439END-IF9440END-IF.9441**********************************************************************9442*10100-MATCH-APROXIMADO.9443*EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS9444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON9445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.9446**********************************************************************9447 10100-MATCH-APROXIMADO.9448IF BLOQOK-AUX-VALNOM > 09449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM9450ELSE9451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM9452END-IF9453MOVE 1 TO I-VALNOM.9454PERFORM UNTIL I-VALNOM > 109455MOVE 1 TO J-VALNOM9456PERFORM UNTIL J-VALNOM > 109457MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM9458MOVE 1 TO K-VALNOM9459MOVE 1 TO L-VALNOM9460IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND9461VM-OK-VALNOM   (J-VALNOM) NOT = SPACES9462PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 159463IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =9464VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)9465OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003      9466AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003      9467OR = "N"))GJC0003      9468IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES9469ADD 1 TO LETRAS-OK-VALNOM9470ADD 1 TO K-VALNOM9471ADD 1 TO L-VALNOM9472ELSEZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopIF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   IF TIP-ID-INPUT-VALNOM <> 2IF TIP-ID-INPUT-VALNOM <> 2PERFORM 10100-MATCH-APROX-EMPRESASPERFORM 10100-MATCH-APROX-EMPRESAS562**********************************************************************563 10100-MATCH-APROX-EMPRESAS.564   MOVE ZEROS TO TOTLET-INP-VALNOM565   MOVE ZEROS TO LETRAS-OK2-VALNOM566MOVE ZEROS TO A-VALNOMGJC0003      9567   MOVE 1 TO K-VALNOM568   PERFORM UNTIL K-VALNOM > 65569MOVE K-VALNOM  TO I-VALNOM570MOVE 1       TO J-VALNOM571MOVE ZEROS TO LETRAS-OK-VALNOM572PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65573IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND574   V-NOMBRE-VALNOM(I-VALNOM) <> "."575      IF V-NOMBRE-VALNOM(I-VALNOM) =576              V-NOMBOK-VALNOM(J-VALNOM)577              ADD 1 TO LETRAS-OK-VALNOM578         ADD 1 TO I-VALNOM579         ADD 1 TO J-VALNOM580      ELSE581              ADD 1 TO J-VALNOM582           END-IF583   ELSE584   ADD 1 TO I-VALNOM585   END-IF586END-PERFORM587IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM588   MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM589END-IF590ADD 1 TO K-VALNOM591   END-.592   MOVE 1 TO I-VALNOM593   PERFORM UNTIL I-VALNOM > 65594IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND595V-NOMBRE-VALNOM(I-VALNOM) <> "."596ADD 1 TO TOTLET-INP-VALNOM597END-IF598ADD 1 TO I-VALNOM599   END-PERFORM.600   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /601    TOTLET-INP.602   IF A-VALNOM >= 75603ADD 1 TO BLOQOK-AUX604   END-IF.605MOVE 0 TO K-VALNOM               GJC0003      9606   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOMGJC0003      9607INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOMGJC0003    MOVE ZEROS TO TOTLET-INP-VALNOMMOVE ZEROS TO LETRAS-OK2-VALNOMMOVE ZEROS TO LETRAS-OK2-VALNOMMOVE ZEROS TO A-VALNOMGJC0003    MOVE ZEROS TO A-VALNOMGJC0003    MOVE 1 TO K-VALNOMMOVE 1 TO K-VALNOMPERFORM UNTIL K-VALNOM > 65PERFORM UNTIL K-VALNOM > 65MOVE K-VALNOM  TO I-VALNOMMOVE K-VALNOM  TO I-VALNOMMOVE 1TO J-VALNOMMOVE 1TO J-VALNOMMOVE ZEROS TO LETRAS-OK-VALNOMMOVE ZEROS TO LETRAS-OK-VALNOMPERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND

















Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setEND-PERFORM.                                                              AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9562**********************************************************************9563 10100-MATCH-APROX-EMPRESAS.9564   MOVE ZEROS TO TOTLET-INP-VALNOM9565   MOVE ZEROS TO LETRAS-OK2-VALNOM9566MOVE ZEROS TO A-VALNOMGJC0003      9567   MOVE 1 TO K-VALNOM9568   PERFORM UNTIL K-VALNOM > 659569MOVE K-VALNOM  TO I-VALNOM9570MOVE 1TO J-VALNOM9571MOVE ZEROS TO LETRAS-OK-VALNOM9572PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 659573IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9574V-NOMBRE-VALNOM(I-VALNOM) <> "."9575IF V-NOMBRE-VALNOM(I-VALNOM) =9576V-NOMBOK-VALNOM(J-VALNOM)9577ADD 1 TO LETRAS-OK-VALNOM9578ADD 1 TO I-VALNOM9579ADD 1 TO J-VALNOM9580ELSE9581ADD 1 TO J-VALNOM9582END-IF9583ELSE9584ADD 1 TO I-VALNOM9585END-IF9586END-PERFORM9587IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM9588MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM9589END-IF9590ADD 1 TO K-VALNOM9591   END-PERFORM.                                                                9592   MOVE 1 TO I-VALNOM9593   PERFORM UNTIL I-VALNOM > 659594IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9595V-NOMBRE-VALNOM(I-VALNOM) <> "."9596ADD 1 TO TOTLET-INP-VALNOM9597END-IF9598ADD 1 TO I-VALNOM9599   END-PERFORM.9600   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /9601TOTLET-INP-VALNOM.9602   IF A-VALNOM >= 759603ADD 1 TO BLOQOK-AUX-VALNOM9604   END-IF.9605MOVE 0 TO K-VALNOMGJC0003      9606   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOMGJC0003      9607INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOMGJC0003    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopIF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES ANDEND-PERFORM.    Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   END-PERFORM.    MOVE K-VALNOM  TO I-VALNOMMOVE K-VALNOM  TO I-VALNOMMOVE 1TO J-VALNOMZoom   Ctrl+C to stop
I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9562**********************************************************************9563 10100-MATCH-APROX-EMPRESAS.9564   MOVE ZEROS TO TOTLET-INP-VALNOM9565   MOVE ZEROS TO LETRAS-OK2-VALNOM9566MOVE ZEROS TO A-VALNOMGJC0003      9567   MOVE 1 TO K-VALNOM9568   PERFORM UNTIL K-VALNOM > 659569MOVE K-VALNOM  TO I-VALNOM9570MOVE 1TO J-VALNOM9571MOVE ZEROS TO LETRAS-OK-VALNOM9572PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 659573IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9574V-NOMBRE-VALNOM(I-VALNOM) <> "."9575IF V-NOMBRE-VALNOM(I-VALNOM) =9576V-NOMBOK-VALNOM(J-VALNOM)9577ADD 1 TO LETRAS-OK-VALNOM9578ADD 1 TO I-VALNOM9579ADD 1 TO J-VALNOM9580ELSE9581ADD 1 TO J-VALNOM9582END-IF9583ELSE9584ADD 1 TO I-VALNOM9585END-IF9586END-PERFORM9587IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM9588MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM9589END-IF9590ADD 1 TO K-VALNOM9591   END-PERFORM.                                                                9592   MOVE 1 TO I-VALNOM9593   PERFORM UNTIL I-VALNOM > 659594IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9595V-NOMBRE-VALNOM(I-VALNOM) <> "."9596ADD 1 TO TOTLET-INP-VALNOM9597END-IF9598ADD 1 TO I-VALNOM9599   END-PERFORM.9600   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /9601TOTLET-INP-VALNOM.9602   IF A-VALNOM >= 759603ADD 1 TO BLOQOK-AUX-VALNOM9604   END-IF.9605MOVE 0 TO K-VALNOMGJC0003      9606   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOMGJC0003      9607INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOMGJC0003    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE 1TO J-VALNOMEND-PERFORM.    Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   END-PERFORM.    MOVE K-VALNOM  TO I-VALNOMRFORM UNTIL K-VALQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsK-VALNOM<W-S>00003          :   K-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   K-VALNOM > 65M  TO I-VALNOM TO J-VALNOMAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9562**********************************************************************9563 10100-MATCH-APROX-EMPRESAS.9564   MOVE ZEROS TO TOTLET-INP-VALNOM9565   MOVE ZEROS TO LETRAS-OK2-VALNOM9566MOVE ZEROS TO A-VALNOMGJC0003      9567   MOVE 1 TO K-VALNOM9568   PERFORM UNTIL K-VALNOM > 659569MOVE K-VALNOM  TO I-VALNOM9570MOVE 1TO J-VALNOM9571MOVE ZEROS TO LETRAS-OK-VALNOM9572PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 659573IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9574V-NOMBRE-VALNOM(I-VALNOM) <> "."9575IF V-NOMBRE-VALNOM(I-VALNOM) =9576V-NOMBOK-VALNOM(J-VALNOM)9577ADD 1 TO LETRAS-OK-VALNOM9578ADD 1 TO I-VALNOM9579ADD 1 TO J-VALNOM9580ELSE9581ADD 1 TO J-VALNOM9582END-IF9583ELSE9584ADD 1 TO I-VALNOM9585END-IF9586END-PERFORM9587IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM9588MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM9589END-IF9590ADD 1 TO K-VALNOM9591   END-PERFORM.                                                                9592   MOVE 1 TO I-VALNOM9593   PERFORM UNTIL I-VALNOM > 659594IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9595V-NOMBRE-VALNOM(I-VALNOM) <> "."9596ADD 1 TO TOTLET-INP-VALNOM9597END-IF9598ADD 1 TO I-VALNOM9599   END-PERFORM.9600   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /9601TOTLET-INP-VALNOM.9602   IF A-VALNOM >= 759603ADD 1 TO BLOQOK-AUX-VALNOM9604   END-IF.9605MOVE 0 TO K-VALNOMGJC0003      9606   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOMGJC0003      9607INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOMGJC0003    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE K-VALNOM  TO I-VALNOMEND-PERFORM.    Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Break-point Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setAlready true AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Break-point Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setEND-PERFORM.AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setMOVE 1 TO I-VALNOM                                                        AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9562**********************************************************************9563 10100-MATCH-APROX-EMPRESAS.9564   MOVE ZEROS TO TOTLET-INP-VALNOM9565   MOVE ZEROS TO LETRAS-OK2-VALNOM9566MOVE ZEROS TO A-VALNOMGJC0003      9567   MOVE 1 TO K-VALNOM9568   PERFORM UNTIL K-VALNOM > 659569MOVE K-VALNOM  TO I-VALNOM9570MOVE 1TO J-VALNOM9571MOVE ZEROS TO LETRAS-OK-VALNOM9572PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 659573IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9574V-NOMBRE-VALNOM(I-VALNOM) <> "."9575IF V-NOMBRE-VALNOM(I-VALNOM) =9576V-NOMBOK-VALNOM(J-VALNOM)9577ADD 1 TO LETRAS-OK-VALNOM9578ADD 1 TO I-VALNOM9579ADD 1 TO J-VALNOM9580ELSE9581ADD 1 TO J-VALNOM9582END-IF9583ELSE9584ADD 1 TO I-VALNOM9585END-IF9586END-PERFORM9587IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM9588MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM9589END-IF9590ADD 1 TO K-VALNOM9591   END-PERFORM.9592   MOVE 1 TO I-VALNOM                                                          9593   PERFORM UNTIL I-VALNOM > 659594IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9595V-NOMBRE-VALNOM(I-VALNOM) <> "."9596ADD 1 TO TOTLET-INP-VALNOM9597END-IF9598ADD 1 TO I-VALNOM9599   END-PERFORM.9600   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /9601TOTLET-INP-VALNOM.9602   IF A-VALNOM >= 759603ADD 1 TO BLOQOK-AUX-VALNOM9604   END-IF.9605MOVE 0 TO K-VALNOMGJC0003      9606   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOMGJC0003      9607INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOMGJC0003    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopEND-PERFORM.MOVE 1 TO I-VALNOM    Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More     ADD 1 TO Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsK-VALNOM<W-S>00066    :   K-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   K-VALNOM.-VALNOM              AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE 1 TO I-VALNOM    PERFORM UNTIL I-VALNOM > 65Break-point Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setMOVE 1 TO I-VALNOMAnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   







Break-pointsOn-count=unset      Set Unset Cancel-all Examine If Do On-count Zoom Thread-local-setCOMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /                              AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I100003295380HENRY REY BARBOSA0080452013011123200220   1105064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J001Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0000800045202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 100003295380999999000J002Registro de input:I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9562**********************************************************************9563 10100-MATCH-APROX-EMPRESAS.9564   MOVE ZEROS TO TOTLET-INP-VALNOM9565   MOVE ZEROS TO LETRAS-OK2-VALNOM9566MOVE ZEROS TO A-VALNOMGJC0003      9567   MOVE 1 TO K-VALNOM9568   PERFORM UNTIL K-VALNOM > 659569MOVE K-VALNOM  TO I-VALNOM9570MOVE 1TO J-VALNOM9571MOVE ZEROS TO LETRAS-OK-VALNOM9572PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 659573IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9574V-NOMBRE-VALNOM(I-VALNOM) <> "."9575IF V-NOMBRE-VALNOM(I-VALNOM) =9576V-NOMBOK-VALNOM(J-VALNOM)9577ADD 1 TO LETRAS-OK-VALNOM9578ADD 1 TO I-VALNOM9579ADD 1 TO J-VALNOM9580ELSE9581ADD 1 TO J-VALNOM9582END-IF9583ELSE9584ADD 1 TO I-VALNOM9585END-IF9586END-PERFORM9587IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM9588MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM9589END-IF9590ADD 1 TO K-VALNOM9591   END-PERFORM.9592   MOVE 1 TO I-VALNOM9593   PERFORM UNTIL I-VALNOM > 659594IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND9595V-NOMBRE-VALNOM(I-VALNOM) <> "."9596ADD 1 TO TOTLET-INP-VALNOM9597END-IF9598ADD 1 TO I-VALNOM9599   END-PERFORM.9600   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /                                9601TOTLET-INP-VALNOM.9602   IF A-VALNOM >= 759603ADD 1 TO BLOQOK-AUX-VALNOM9604   END-IF.9605MOVE 0 TO K-VALNOMGJC0003      9606   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOMGJC0003      9607INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOMGJC0003    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopPERFORM UNTIL I-VALNOM > 65COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /    Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /    IF A-VALNOM >= 75IF A-VALNOM >= 75ADD 1 TO BLOQOK-AUX-VALNOMADD 1 TO BLOQOK-AUX-VALNOMEND-IF.END-IF.MOVE 0 TO K-VALNOMGJC0003    MOVE 0 TO K-VALNOMGJC0003    IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOMGJC0003    IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOMGJC0003    434        ELSE435           PERFORM 10100-MATCH-APROX-EMPRESAS436        END-IF437        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438       MOVE 1 TO MATCH-OK-OUT-VALNOM439        END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444* CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM456PERFORM UNTIL J-VALNOM > 10457 MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM458    MOVE 1 TO K-VALNOM459    MOVE 1 TO L-VALNOM460 IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND461       VM-OK-VALNOM   (J-VALNOM) NOT = SPACES462       PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15463              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =464                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)465                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003      9466            AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003      9467              OR = "N"))        GJC0003      9468         IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES469      ADD 1 TO LETRAS-OK-VALNOM470               ADD 1 TO K-VALNOM471               ADD 1 TO L-VALNOM472                 ELSE473MOVE 19 TO K-VALNOM474                 END-IF475       ELSE476          ADD 1   TO K-VALNOM477             IF K-VALNOM <= 15 AND L-VALNOM < 15478                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =479                 VMM-OK-VALNOM(J-VALNOM,K-VALNOM )END-IFIF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMIF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOMEND-IFEND-IFEND-IF.END-IF.4419     END-IF4420  PERFORM 10000-MATCH-NOMBRES-VALNOM4421     IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423  END-IF4424  END-IF4425  END-IF4426      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002      4427              MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428      END-IF                                                 FAC0002      4429 END-IF                                                      FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE4431    END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451MOVE 1 TO SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                      FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.              FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND               FAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) OR                      FAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 AND          FAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"   


         


         


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE5657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69 not invalid key70move 0 to SW-BDIIALE71read BDIIALE next record72at end73    move 1 to SW-BDIIALE74    end-read75end-start7677     perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79     or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80         if FUENTE-BDIIALE = 99000381         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82     and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83    and BLOQUEO-BDIIALE = 084     encontrado85     move 1 to SW-BDIIALE86    end-if87 if SW-BDIIALE = 088    read BDIIALE next record at end89       move 1 to SW-BDIIALE90end-read91end-if92     end-perform.9394     if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97     else98        if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOSmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressjurad-reg.                                                                   r

e

g

-

b

d

i

i

a

l

e

if SW-BDIIALE = 0    read BDIIALE next record at end        move 1 to SW-BDIIALE    end-readREG-BDIIALE<W-S>200800002194999999000J002    2014010120640101201401010          000340004520201204                                                                                                    :   REG-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    if SW-BDIIALE = 0     read BDIIALE next record at end         move 1 to SW-BDIIALE     end-read end-if-perform.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitors14-S Invalid operand AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Reset-execution      Cursor-position Next Start Quit-performNo such command AnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressreg-bdiiale.                                                            end-ifperform.IP-IDE-BDIIVIDE = 1REG-BDIIALE<W-S>200800178009000001000J001    2014010420640104201401040          000330002020200004                                                                                                                  :   REG-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    end-if-perform.TIP-IDE-BDIIVIDE = 1 if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1     move 07 to CODIGO-ERRORAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   end-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 192end-perform.9394 if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97         else98         if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCREGIS501            add 1 to CONT-FALLECIDOS502        end-if503    end-if504end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524******************************************************************525IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526ADD 1 TO W-CONT-TIPO-6527ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529ADD 1 TO W-CONT-TIPO-7530    ELSE531*    registros correctos, repetidos o no532ADD 1 TO W-CONT-TIPO-5533*    si es una empresa534IF TIPOID-E = 2 OR 3535ADD 1 TO W-CONT-TIPO-5-PJ36END-IF37END-IFif TIP-IDE-BDIIVIDE = 136    else37perform 4222-VALIDA-NOMBRE-COINCIDE38    end-if39end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"444******************************************************************445* Validación de IDs que figuran OK pero el nombre no coincide446******************************************************************447*nombre no coincide448IF TIP-IDE-BDIIVIDE = 1449*es una cédula450MOVE 02 TO CODIGO-ERROR451     ELSE452*    no es una cédula453         MOVE 01 TO CODIGO-ERROR454 END-IF.455456457 4222-VALIDA-NOMBRE-COINCIDE.458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"459******************************************************************460* Validación de IDs que figuran OK pero el nombre coincide461******************************************************************462nombre coincide: busca ID en BDIIALE463 initialize LLAVE-BDIIALE464 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE465 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE466 move 990003 to FUENTE-BDIIALE467 start BDIIALE key not < LLAVE-BDIIALE INVALID KEY468         move 1 TO SW-BDIIALE469not invalid key470move 0 to SW-BDIIALE471    read BDIIALE next record472at end473move 1 to SW-BDIIALE474end-read475 end-start476477 perform until SW-BDIIALE = 1478or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480if FUENTE-BDIIALE = 990003481and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCODIGO-ERROR<W-S>00                 -6:   CODIGO-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CODIGO-ERROR = 01 OR  ADD 1 TO W-CONT-TIPO-6EAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASperform 4300-MODIFICAR-BDIIALE560561 4300-MODIFICAR-BDIIALE.562Ddisplay "4300-MODIFICAR-BDIIALE"563******************************************************************564* Se impacta el archivo BDIIALE con una o dos inserciones,565* modificaciones o eliminaciones segun haya o no demandas y566* embargos567******************************************************************568 initialize REG-BDIIALE569570*    si hay demandas571     if JURAD-demandas-vigentes > zero572 or JURAD-demandas-terminadas > zero57    move "J001" to LLASEC-BDIIALE574*arma datos de demandas57JURAD-demandas-vigentes to D-vigentes57    move JURAD-demandas-terminadas to D-terminados577     string "20" JURAD-demandas-fecha-ultima57    delimited size into D-fecha-ultima57perform 4300-MODIFICAR-BDIIALE-DATOS58.581582*si hay embargos58if JURAD-embargos-vigentes > zero584 or JURAD-embargos-terminados > zero585     move "J002" to LLASEC-BDIIALE586*    arma datos de embargos58move JURAD-embargos-vigentes to D-vigentes58    move JURAD-embargos-terminados to D-terminados589     string "20" JURAD-embargos-fecha-ultimo59    delimited size into D-fecha-ultima59perform 4300-MODIFICAR-BDIIALE-DATOS59.593594595596 4300-MODIFICAR-BDIIALE-DATOS.597Ddisplay "4300-MODIFICAR-BDIIALE-DATOS"598******************************************************************599* Parte de la carga de datos en el registro BDIIALE y grabacion600* del mismo que es comun a demandas y embargos601* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"602******************************************************************603*completa la clave e intenta leer la alerta, si se leyo OK604*l file status de BDIIALE queda con "00"60perform 4333-LEER-BDIIALE-RANDOM

      

      

      display "4300-MODIFICAR-BDIIALE"initialize REG-BDIIALEinitialize REG-BDIIALEif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeromove "J001" to LLASEC-BDIIALEPerform-level      Exit View

      

      

      

      

      move "J001" to LLASEC-BDIIALE331*intento de actualizacion de BDIIALE332     perform 4300-MODIFICAR-BDIIALE333 add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343ifid-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345 move 05 to codigo-error346end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353 end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-if367*    Numero de demandas terminadas368 if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370     end-if371*    Fecha ultima demanda vigente YYMMDD372     if JURAD-demandas-fecha-ultima is not numeric373         call "PONERR" using "08" JURAD-reg E-errores374 end-if375 move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS376if not ANO-VAL or not MES-VAL or not DIA-VALAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   add 1 to N-reg-OK.286 end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296     move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00call "PONERR" using "01" JURAD-reg E-errores010203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05    move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07exit paragraph080910 add 1 to N-reg-leidos1112*validacion formal de los datos13move 0 to codigo-error14 perform 4100-VALIDACION-FORMAL15E-hay-error = "SI"16perform 4900-GRABAR-ERROR17*    perform 4240-CONTAR-TIPO-CUENTA18     exit paragraph19end-if2021*si la validacion formal dio OK se hace validacion semantica22 perform 4200-VALIDACION-SEMANTICA                                       23E-hay-error = "SI"24perform 4900-GRABAR-ERROR25    perform 4240-CONTAR-TIPO-CUENTA26     exit paragraph27end-if2829perform 4240-CONTAR-TIPO-CUENTA3031*ntento de actualizacion de BDIIALE64*    controla el reg y lo aplica si es OK65perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67         add 1 to REG-LEIDOS68 when "10"69*        fin del archivo de input:70*        esto es un error, no se encontro el registro "T" antes71*        de que se terminara el archivo72         display "Falta el reg de totales del archivo JURAD "73         display "Nombre del archivo: " P-file-name74    display "File status: " JURAD-fs75display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77    perform 9000-CANCELAR-PROGRAMA278when other279*    error de lectura: cancelacion del proceso280display "Error en lectura del archivo JURAD "281     display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284display JURAD-reg-anterior285perform 9000-CANCELAR-PROGRAMA286evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00    call "PONERR" using "01" JURAD-reg E-errores01end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05    move "SI" to IND-fin-proceso06perform 4800-PROCESO-REG-T07    exit paragraph08end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************Zoom   Ctrl+C to stopRegistro de input:
I100003295380HENRY REY BARBOSA0080452013011123200220   110506Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE   
      
   
   
   4000-PROCESAR-REGISTROI100003295380HENRY REY BARBOSA0080452013011123200220   110506

Datos en la alerta: 0023200002202011054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
      
   
   
   110506
Datos en la alerta: 002320000220201105

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO
      
   
   
   Datos en la alerta: 002320000220201105
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   14010633-REGRABAR-BDIIALE
000-PROCESAR-REGISTRO



I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO"display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO



I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106


      
   
   
   
   4000-PROCESAR-REGISTRO-2000-PROCESAR-REGISTRO


I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2

      
   
   
   
   4100-VALIDACION-FORMAL

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   320321*    si la validacion formal dio OK se hace validacion semantica322 perform 4200-VALIDACION-SEMANTICA                                         3323     if E-hay-error = "SI"324         perform 4900-GRABAR-ERROR325         perform 4240-CONTAR-TIPO-CUENTA326         exit paragraph327 end-if32832perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333 add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}34if JURAD-id-tipo not = "1" and "2" and "3" and "4"34call "PONERR" using "02" JURAD-reg E-errores34move 05 to codigo-error34end-if347*Numero de identificacion34if JURAD-id-numeroX is not numeric349 call "PONERR" using "03" JURAD-reg E-errores35end-if35if JURAD-id-numero not > 035call "PONERR" using "04" JURAD-reg E-errores35end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan35if JURAD-tipo-novedad = "E"35exit paragraph35end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361         call "PONERR" using "05" JURAD-reg E-errores362     end-if363*    Numero de demandas vigentes364     if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-erroresBreak-point encountered    perform 4200-VALIDACION-SEMANTICA   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
      
   
   
   
     33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.3334333533363337 4100-VALIDACION-FORMAL.3338Ddisplay "4100-VALIDACION-FORMAL"3339******************************************************************3340* Validacion formal de los datos del input3341******************************************************************3342*Tipo de identificacion Numero {1, 2, 3, 4}3343if JURAD-id-tipo not = "1" and "2" and "3" and "4"3344call "PONERR" using "02" JURAD-reg E-errores3345move 05 to codigo-error3346end-if3347*Numero de identificacion3348if JURAD-id-numeroX is not numeric3349call "PONERR" using "03" JURAD-reg E-errores3350end-if3351if JURAD-id-numero not > 03352call "PONERR" using "04" JURAD-reg E-errores3353end-if3354*si el movimiento es una eliminacion los datos subsiguientes3355*no se controlan3356if JURAD-tipo-novedad = "E"3357exit paragraph3358end-if3359*Nombres y Apellidos3360if JURAD-nombre = spaces3361call "PONERR" using "05" JURAD-reg E-errores3362end-if3363*Numero de demandas vigentes3364if JURAD-demandas-vigentes is not numeric3365call "PONERR" using "06" JURAD-reg E-erroresAnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moreperform 4200-VALIDACION-SEMANTICA   9697 4200-VALIDACION-SEMANTICA.98Ddisplay "4200-VALIDACION-SEMANTICA"   99****************************************************************400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403move JURAD-id-tipo to TIP-IDE-BDIIVIDE404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407 move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413     IF TIP-IDE-BDIIVIDE = 2 OR 3414     MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415     END-IF416     MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*    Valida el numero de identificación contra las bases de418datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420*Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423 if SW-ID-BDIIVIDE = 1424*    es un id inválido42514426*    valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429*    existe id, a ver si el nombre coincide430     if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431         call "PONERR" using "15" JURAD-reg E-errores432        display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*        validación en base alterna435         perform 4220-VALIDA-NOMBRE-NO-COINCIDE436    else437    perform 4222-VALIDA-NOMBRE-COINCIDE438    end-if439 end-if.440441Zoom   Ctrl+C to stop

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
      
   
   
   
   4200-VALIDACION-SEMANTICA
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress   reg-bdiiale.                                                               

   

   -bdiiale. 

   bdiiale. 

   j

   u

   r

   a

   d

   -

   r

   e

   g

   

   

perform 80100-VALIDAR-IDENTIFICACION                   SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1    es un id inválido14-S Invalid operand AnimateCARGAJUR.gnt/.o/.exe   view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</>   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress   rejurad-reg.                                                               ejurad-reg. 

   jurad-reg. 

perform 80100-VALIDAR-IDENTIFICACION                   SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1    es un id inválidoJURAD-REG<W-S>   I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106:   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    perform 80100-VALIDAR-IDENTIFICACION                   SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe if SW-ID-BDIIVIDE = 1     es un id inválidoAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NIT605*Ubica NIT en archivla DIAN, BDIIDIAN606=============================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622     END-READ623     IF SW-ID-BDIIVIDE = 0624        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625     copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"                         RMB0013      4628$IF HACERMATCH = "SI"                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                                     RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                          RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                  REGISTRO DIRECC .6392017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640                 ORDENAN DE ACUERDO A LO DEFINIDO6412017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                         DE ESTANDARIZACION DE NOMBRES DE645*                      COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                   A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  * PROBABLE AUMENTANDO UN PESO CON BASE A LAMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEYREAD BDIIDIAN INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsDESCRIPCION-BDIIDIAN<W-S>CALZADO ORION DEL LITORAL                                                      :   DESCRIPCION-BDIIDIAN<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEXT.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409  MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410     MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416                     MOVE 2 TO BLOQUES-INPUT-VALNOM417             ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418             END-IF419        END-IF420        PERFORM 10000-MATCH-NOMBRES-VALNOM421        IF MATCH-OK-OUT-VALNOM = 0422        MOVE 1 TO SW-NOMBRES-BDIIVIDE423        END-IF424          END-IF425       END-IF426      ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427              MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428     END-IFFAC0002      4429      END-IF                                                 FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441 EVALUATE TIP-IDE-BDIIVIDE442 WHEN 1443 PERFORM 85010-UBICA-CEDULA444   WHEN 2445 PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NUM-BLOQUES-BDIIVIDE NUMERIC ANDMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM9260*CON EL NOMBRE ENVIADO EN LA CONSULTA.9261******************************************************************9262MOVE 0 TO MATCH-OK-OUT-VALNOM.9263MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9264IF TIP-ID-INPUT-VALNOM  = 29265INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9266 " S.A. " BY "      ",                     RMB0002      9267 "." BY " ", " LTDA " BY "      ",          RMB0002      9268 " LIMITADA " BY "   ",RMB0002      9269" CIA " BY "     ", " COMPA/IA " BY "",RMB0002      9270" INVERSIONES " BY "             ",RMB0002      9271" EMPRESA " BY "         ",                            RMB0002      9272" CORPORACION " BY "             ",RMB0002      9273" DE " BY "    ", " LA " BY "    ", " DEL " BY "",RMB0002      9274" S " BY "   ", " A " BY "   "            RMB0002      9275" Y " BY "   "GJC0003      9276INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9277" S.A. " BY "      ",               RMB0002      9278"." BY " ", " LTDA " BY "      ",RMB0002      9279" LIMITADA " BY "          ",     RMB0002      9280" CIA " BY "", " COMPA/IA " BY "",RMB0002      9281 " INVERSIONES " BY "",RMB0002      9282    " EMPRESA " BY "",RMB0002      9283     " CORPORACION " BY "  ",RMB      9284" DE " BY "    ", " LA " BY "", " DEL " BY "",RMB      9285" S " BY "   ", " A " BY "   "RMB      9286     " Y " BY "   "GJ3      9287     INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9288       "." BY " ","-" BY " ",GJC0003      9289"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9290                "Y" BY "G","H" BY "G","I" BY "G"GJC0003      9291         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9292                "." BY " ","-" BY " ",GJC0003      9293                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9294                "Y" BY "G","H" BY "G","I" BY "G"       GJC0003      9295         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM9296     ELSE9297        INSPECT CADENA-VALNOM    REPLACING ALL9298            "." BY " ","-" BY " ", "," BY " ",9299         "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9300       "Y" BY "G","H" BY "G","I" BY "G",9301         " DE " BY ""," LA " BY "",9302       " DEL " BY "     "9303 INSPECT CADENA-VALNOMREPLACING ALLRMB0002      9304        "." BY " ","-" BY " ", "," BY " ",9305         "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002    Zoom   Ctrl+C to stop
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9260*CON EL NOMBRE ENVIADO EN LA CONSULTA.9261******************************************************************9262MOVE 0 TO MATCH-OK-OUT-VALNOM.9263MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9264IF TIP-ID-INPUT-VALNOM  = 29265INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9266" S.A. " BY "",RMB0002      9267"." BY " ", " LTDA " BY "",RMB0002      9268" LIMITADA " BY "",RMB0002      9269" CIA " BY "", " COMPA/IA " BY "",RMB0002      9270" INVERSIONES " BY "",RMB0002      9271" EMPRESA " BY "",RMB0002      9272" CORPORACION " BY "",RMB0002      9273" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9274" S " BY "   ", " A " BY "   "RMB0002      9275" Y " BY "   "GJC0003      9276INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9277" S.A. " BY "",RMB0002      9278"." BY " ", " LTDA " BY "",RMB0002      9279" LIMITADA " BY "",RMB0002      9280" CIA " BY "", " COMPA/IA " BY "",RMB0002      9281" INVERSIONES " BY "",RMB0002      9282" EMPRESA " BY "",RMB0002      9283" CORPORACION " BY "",RMB0002      9284" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9285" S " BY "   ", " A " BY "   "RMB0002      9286" Y " BY "   "GJC0003      9287INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9288"." BY " ","-" BY " ",GJC0003      9289"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9290"Y" BY "G","H" BY "G","I" BY "G"GJC0003      9291INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003      9292"." BY " ","-" BY " ",GJC0003      9293"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003      9294"Y" BY "G","H" BY "G","I" BY "G"GJC0003      9295MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM9296ELSE9297INSPECT CADENA-VALNOMREPLACING ALL9298"." BY " ","-" BY " ", "," BY " ",9299"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9300"Y" BY "G","H" BY "G","I" BY "G",9301" DE " BY ""," LA " BY "",9302" DEL " BY ""9303INSPECT CADENA-VALNOMREPLACING ALLRMB0002      9304"." BY " ","-" BY " ", "," BY " ",9305"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE 0 TO MATCH-OK-OUT-VALNOM.315         END-PERFORM316     END-IF.317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO319             BASURA-VALNOM320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)325VM-INPUT-VALNOM(14)326VM-INPUT-VALNOM(15)327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)328VM-INPUT-VALNOM(19)329VM-INPUT-VALNOM(20)330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.332IF TIP-ID-INPUT-VALNOM  NOT = 2333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL334      "." BY " ","-" BY " ","," BY " ",335     "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",336     "Y" BY "G","H" BY "G","I" BY "G"337     PERFORM VARYING I-VALNOM FROM 1 BY 1338             UNTIL I-VALNOM >= 66339       IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC340           AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC341          MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)342         END-IF343END-PERFORM344ELSE345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346  " S.A. " BY "      ",                RMB0002      9347"." BY " ", " LTDA " BY "  ",RMB0002      9348" LIMITADA " BY "          ",                    RMB0002      9349" CIA " BY "     ", " COMPA/IA " BY ",RMB0002      9350  " INVERSIONES " BY "             ",        RMB0002      9351      " EMPRESA " BY "",RMB0002      9352   " CORPORACION " BY "             ",RMB0002      9353" DE " BY "    ", " LA " BY "    ", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "                   RMB0002    55" Y " BY "   "                        GJC0003    56INSPECT NOMBRE-AUX-VALNOM REPLACING ALL  RMB0002    57" S.A. " BY "      ",  RMB0002    58   "." BY " ", " LTDA " BY "      ",      59" LIMITADA " BY "          ",           RMB0002    60" CIA " BY "     ", " COMPA/IA " BY "              Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   1008064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030   100806Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200800002194SERVICULTIVOS LTDA0220452012040603404520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J001Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-INPUT-VALNOM.   71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Perform-level      Exit ViewMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   MOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"   


         


         


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALE

initialize LLAVE-BDIIALE57 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69not invalid key70 move 0 to SW-BDIIALE71read BDIIALE next record72at end73move 1 to SW-BDIIALE74read75start7677perform until SW-BDIIALE = 178     or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79 or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80         if FUENTE-BDIIALE = 99000381         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82         and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83     and BLOQUEO-BDIIALE = 084*         encontrado85      move 1 to SW-BDIIALE86end-if87    if SW-BDIIALE = 088     read BDIIALE next record at end89        move 1 to SW-BDIIALE90        end-read91end-if92end-perform.9394 if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97         else98         if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCREGIS501            add 1 to CONT-FALLECIDOS502        end-ifinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressjurad-reg.                                                                                      r

e

g

-

b

d

i

i

a

l

e







if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0REG-BDIIALE<W-S>200800178009999999000J001    2014010120640101201401010          000330002020200004                                                                                                    :   REG-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    if FUENTE-BDIIALE = 990003 and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD and BLOQUEO-BDIIALE = 0      encontrado      move 1 to SW-BDIIALEAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressreg-bdiiale.                                                                 if SW-BDIIALE = 0    read BDIIALE next record at end        move 1 to SW-BDIIALE    end-readREG-BDIIALE<W-S>200800178009999999000J002    2014010120640101201401010          000150005420201401                                                                                                    :   REG-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    if SW-BDIIALE = 0     read BDIIALE next record at end         move 1 to SW-BDIIALE     end-read end-if-perform.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressreg-bdiiale.                                                            l

l

a

v

e

-

b

e

d

e. 

. 

 




d

i

i

a

l

e

end-perform.if TIP-IDE-BDIIVIDE = 1    if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1LLAVE-BDIIALE<W-S>200830067928000001000J001    :   LLAVE-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    end-perform. if TIP-IDE-BDIIVIDE = 1AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 192     end-perform.9394     if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97     else98        if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOS502        end-if503end-if504end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 2151907=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524******************************************************************525IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526ADD 1 TO W-CONT-TIPO-6527ELSE528IF CODIGO-ERROR = 03 OR 04 OR 05529        ADD 1 TO W-CONT-TIPO-7530ELSE531*registros correctos, repetidos o no532    ADD 1 TO W-CONT-TIPO-5533*si es una empresa534IF TIPOID-E = 2 OR 335ADD 1 TO W-CONT-TIPO-5-PJ36END-IF37END-IFif TIP-IDE-BDIIVIDE = 136    else37perform 4222-VALIDA-NOMBRE-COINCIDE38    end-if39end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"444******************************************************************445* Validación de IDs que figuran OK pero el nombre no coincide446******************************************************************447*nombre no coincide448IF TIP-IDE-BDIIVIDE = 1449*es una cédula450MOVE 02 TO CODIGO-ERROR451     ELSE452*    no es una cédula453         MOVE 01 TO CODIGO-ERROR454 END-IF.455456457 4222-VALIDA-NOMBRE-COINCIDE.458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"459******************************************************************460* Validación de IDs que figuran OK pero el nombre coincide461******************************************************************462nombre coincide: busca ID en BDIIALE463 initialize LLAVE-BDIIALE464 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE465 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE466 move 990003 to FUENTE-BDIIALE467 start BDIIALE key not < LLAVE-BDIIALE INVALID KEY468         move 1 TO SW-BDIIALE469not invalid key470move 0 to SW-BDIIALE471    read BDIIALE next record472at end473move 1 to SW-BDIIALE474end-read475 end-start476477 perform until SW-BDIIALE = 1478or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480if FUENTE-BDIIALE = 990003481and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-if392if not ANO-VAL or not MES-VAL or not DIA-VAL393call "PONERR" using "13" JURAD-reg E-errores394end-if.395396397 4200-VALIDACION-SEMANTICA.398D    display "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************00* Validacion del numero de identificacion y de su relacion con01* el nombre0203 move JURAD-id-tipo to TIP-IDE-BDIIVIDE04move JURAD-id-numero to NUM-IDE-BDIIVIDE-R05 move JURAD-nombre to NOMBRE-BDIIVIDE0607move JURAD-id-tipo to TIPOID-E08 move JURAD-id-numero to NUMID-E09move JURAD-nombre to NOMBRE-E1011move 1 to SW-VERIFNOM-BDIIVIDE12move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE13     IF TIP-IDE-BDIIVIDE = 2 OR 314     MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE15     END-IF16     MOVE 2 TO NUM-BLOQUES-BDIIVIDE17*    Valida el numero de identificación contra las bases de18datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia19*del nombre reportado20*Retorna SW-ID-BDIIVIDE=1 si hay error21perform 80100-VALIDAR-IDENTIFICACION                                    22*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe23if SW-ID-BDIIVIDE = 124*es un id inválido25    call "PONERR" using "14" JURAD-reg E-errores26*valida contra la base alterna27perform 4210-VALIDACION-ID-NO-FIGURA28else29*existe id, a ver si el nombre coincide30if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide31        call "PONERR" using "15" JURAD-reg E-errores32display "novedad:  " JURAD-nombre33        display "registro: " NOM-LEIDO-BDIIVIDE34*        validación en base alterna35        perform 4220-VALIDA-NOMBRE-NO-COINCIDE36else37    perform 4222-VALIDA-NOMBRE-COINCIDE


436    else437    perform 4222-VALIDA-NOMBRE-COINCIDE438    end-if439end-if.440441442 4220-VALIDA-NOMBRE-NO-COINCIDE.443D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"44******************************************************************45* Validación de IDs que figuran OK pero el nombre no coincide46**47*nombre no coincide48IF TIP-IDE-BDIIVIDE = 149*    es una cédula50MOVE 02 TO CODIGO-ERROR51ELSE52*    no es una cédula53    MOVE 01 TO CODIGO-ERROR54END-IF.555657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62nombre coincide: busca ID en BDIIALE63 initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66 move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68 move 1 TO SW-BDIIALE69not invalid key70 move 0 to SW-BDIIALE71read BDIIALE next record72    at end73     move 1 to SW-BDIIALE74end-read75end-start7677perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80if FUENTE-BDIIALE = 99000381and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASPerform-level      Exit View

      

      

      

      

      perform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   add 1 to N-reg-OK.264*controla el reg y lo aplica si es OK265     perform 4000-PROCESAR-REGISTRO-2266    move JURAD-reg to JURAD-reg-anterior267    add 1 to REG-LEIDOS268when "10"269*fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes271*        de que se terminara el archivo272     display "Falta el reg de totales del archivo JURAD "273         display "Nombre del archivo: " P-file-name274         display "File status: " JURAD-fs275         display "Ultimo registro leido: " N-reg-leidos276     display JURAD-reg-anterior277    perform 9000-CANCELAR-PROGRAMA278when other279*error de lectura: cancelacion del proceso280    display "Error en lectura del archivo JURAD "281     display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00    call "PONERR" using "01" JURAD-reg E-errores01 end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05     move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07exit paragraph0809move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************Zoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001

Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE   
   
   
   
   4000-PROCESAR-REGISTROInsercion de alerta nueva que ya existe  key: 200800002194999999000J001
Registro de input:

I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
   
   
   
   Registro de input:
I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
   
   
   
   I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406

Datos en la alerta: 0002200045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO120406
Datos en la alerta: 000220004520201204

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Datos en la alerta: 000220004520201204
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   990101  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO"display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

         

         

         display "4000-PROCESAR-REGISTRO-2"   94* La informacion esta leida en JURAD-reg95****************************************************************96 move "NO" to E-hay-error9798*    validacion del tip movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305 move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313 move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323 if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339**Zoom   Ctrl+C to stop4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE

4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2
   
   
   
   
   4100-VALIDACION-FORMAL33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
   
   
   
   
   00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 200800002194999999000J002Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   99010100-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002

Registro de input:I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101   
   
   
   
      Error    
   
   
   
      
09   
   
   
   
          
   
   
   
      Fecha ultima demanda vigente YYYYMMDD: fuera de rangoInsercion de alerta nueva que ya existe  key: 200800002194999999000J002
Registro de input:

I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango   
   
   
   
      4900-GRABAR-ERRORRegistro de input:
I200800002194SERVICULTIVOS LTDA0220452012040603404520   120406Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR   
   
   
   
      4000-PROCESAR-REGISTROI200800002194SERVICULTIVOS LTDA0220452012040603404520   120406

Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO   
   
   
   
      120406
Datos en la alerta: 000340004520201204

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
   
   
      Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   10040633-REGRABAR-BDIIALE
000-PROCESAR-REGISTRO



I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   100406  3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.3334333533363337 4100-VALIDACION-FORMAL.3338Ddisplay "4100-VALIDACION-FORMAL"3339******************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove "NO" to E-hay-error8889 4000-PROCESAR-REGISTRO-2.0Ddisplay "4000-PROCESAR-REGISTRO-2"                                      1****************************************************************2* Controla los datos de un registro de JURAD y si es OK lo usa3* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"0call "PONERR" using "01" JURAD-reg E-errores1end-if23*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05move "SI" to IND-fin-proceso06     perform 4800-PROCESO-REG-T07    exit paragraph08end-if090add 1 to N-reg-leidos12*validacion formal de los datos3move 0 to codigo-error14perform 4100-VALIDACION-FORMAL15 if E-hay-error = "SI"16    perform 4900-GRABAR-ERROR17*    perform 4240-CONTAR-TIPO-CUENTA18exit paragraph19end-if01*si la validacion formal dio OK se hace validacion semantica2perform 4200-VALIDACION-SEMANTICA                                       3if E-hay-error = "SI"24perform 4900-GRABAR-ERROR25     perform 4240-CONTAR-TIPO-CUENTA26    exit paragraph27end-if2829perform 4240-CONTAR-TIPO-CUENTA01*    intento de actualizacion de BDIIALE2 perform 4300-MODIFICAR-BDIIALE3     add 1 to N-reg-OK.Break-point encountered    display "4000-PROCESAR-REGISTRO-2"   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO



I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   100406


   
   
   
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More                                    display "4000-PROCESAR-REGISTRO-2"   move "NO" to E-hay-errormove "NO" to E-hay-errorif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"Zoom   Ctrl+C to stop4000-PROCESAR-REGISTRO


I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2

   
   
   
      
   4100-VALIDACION-FORMAL

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"perform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
   
   
   
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moreperform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"     3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441Zoom   Ctrl+C to stop

I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
   
   
   
      
   4200-VALIDACION-SEMANTICA
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NIT605*Ubica NIT en archivla DIAN, BDIIDIAN606=============================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622     END-READ623     IF SW-ID-BDIIVIDE = 0624        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625     copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"                         RMB0013      4628$IF HACERMATCH = "SI"                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                                     RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                          RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                  REGISTRO DIRECC .6392017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640                 ORDENAN DE ACUERDO A LO DEFINIDO6412017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                         DE ESTANDARIZACION DE NOMBRES DE645*                      COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                   A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  * PROBABLE AUMENTANDO UN PESO CON BASE A LAMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEYREAD BDIIDIAN INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DEQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsDESCRIPCION-BDIIDIAN<W-S>C I GLOMA S A                                                                  :   DESCRIPCION-BDIIDIAN<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEXT.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409  MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410     MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416                     MOVE 2 TO BLOQUES-INPUT-VALNOM417             ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418             END-IF419        END-IF420        PERFORM 10000-MATCH-NOMBRES-VALNOM421        IF MATCH-OK-OUT-VALNOM = 0422        MOVE 1 TO SW-NOMBRES-BDIIVIDE423        END-IF424          END-IF425       END-IF426      ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427              MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428     END-IFFAC0002      4429      END-IF                                                 FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441 EVALUATE TIP-IDE-BDIIVIDE442 WHEN 1443 PERFORM 85010-UBICA-CEDULA444   WHEN 2445 PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMZoom   Ctrl+C to stop
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOM4421IF MATCH-OK-OUT-VALNOM = 04422MOVE 1 TO SW-NOMBRES-BDIIVIDE4423END-IF4424END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IFFAC0002      4429END-IFFAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 4ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM9315       END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO9319           BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334 "." BY " ","-" BY " ","," BY " ",9335   "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336      "Y" BY "G","H" BY "G","I" BY "G"9337         PERFORM VARYING I-VALNOM FROM 1 BY 19338                  UNTIL I-VALNOM >= 669339    IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341      MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342              END-IF9343       END-PERFORM9344ELSE9345         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346           " S.A. " BY "      ",     RMB0002      9347           "." BY " ", " LTDA " BY "",RMB0002      9348           " LIMITADA " BY "          ",RMB0002      9349           " CIA " BY "     ", " COMPA/IA " BY "          ",RMB0002      9350           " INVERSIONES " BY "             ",RMB0002      9351           " EMPRESA " BY "         ", RMB0002      9352           " CORPORACION " BY "      ",RMB0002      9353      " DE " BY "    ", " LA " BY "", " DEL " BY "",RMB0002      9354    " S " BY "   ", " A " BY "   "RMB0002      9355  " Y " BY "   "          GJC0003      9356  INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357  " S.A. " BY "      ",RMB0002      9358    "." BY " ", " LTDA " BY "",RMB0002      9359  " LIMITADA " BY "    ",RMB0002      9360    " CIA " BY "", " COMPA/IA " BY "",RMB0002    Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-INPUT-VALNOM.   71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   1401064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J001Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0003300020202000044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200800178009999999000J002Registro de input:I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                          9374UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9375BASURA-VALNOM9376VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)9377VM-OK-VALNOM(4) VM-OK-VALNOM(5)9378VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)9379VM-OK-VALNOM(9) VM-OK-VALNOM(10)9380VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)9381VM-OK-VALNOM(14) VM-OK-VALNOM(15)9382VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)9383VM-OK-VALNOM(19) VM-OK-VALNOM(20).9384***********HACE LA VALIDACION BLOQUE A BLOQUE********************9385MOVE 1 TO I-VALNOM.9386MOVE 0 TO BLOQOK-AUX-VALNOM.9387PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   MOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"   


         


         


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66 move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68 move 1 TO SW-BDIIALE69not invalid key70 move 0 to SW-BDIIALE71read BDIIALE next record72    at end73     move 1 to SW-BDIIALE74end-read75end-start7677perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80if FUENTE-BDIIALE = 99000381and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83    and BLOQUEO-BDIIALE = 084*encontrado85move 1 to SW-BDIIALE86         end-if87     if SW-BDIIALE = 088             read BDIIALE next record at end89                 move 1 to SW-BDIIALE90             end-read91     end-if92end-perform.9394if TIP-IDE-BDIIVIDE = 195    if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196     move 07 to CODIGO-ERROR97else98        if ESTADO-VIG-BDIIREGI = 2199move 06 to CODIGO-ERROR500add 1 to NO-COINCIDE-REGIS501                 add 1 to CONT-FALLECIDOS502         end-if503         end-if504     end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del códigostart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressllave-bdiiale.                                                               r

e

g

e-bdiiale. 

-bdiiale. 

if SW-BDIIALE = 0    read BDIIALE next record at end        move 1 to SW-BDIIALE    end-readREG-BDIIALE<W-S>200830067928999999000J002    2014010120640101201401010          000120003220201004                                                                                                    :   REG-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    if SW-BDIIALE = 0     read BDIIALE next record at end         move 1 to SW-BDIIALE     end-read end-if-perform.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 136    else37        perform 4222-VALIDA-NOMBRE-COINCIDE38    end-if39end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"44******************************************************************45* Validación de IDs que figuran OK pero el nombre no coincide46******************************************************************47*nombre no coincide48IF TIP-IDE-BDIIVIDE = 149*    es una cédula50    MOVE 02 TO CODIGO-ERROR51ELSE52*no es una cédula53MOVE 01 TO CODIGO-ERROR54END-IF.555657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69not invalid key70move 0 to SW-BDIIALE471read BDIIALE next record472at end473move 1 to SW-BDIIALE474read475start476477perform until SW-BDIIALE = 1478     or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479 or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480         if FUENTE-BDIIALE = 990003481     and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressreg-bdiiale.                                                            w

-

c

o

n

t

a

d

o

r




s

perform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.
W-CONTADORES<W-S>000004000001000003000003000000:   W-CONTADORES<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    perform 4300-MODIFICAR-BDIIALE add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Perform-level      Exit View

      

      

      

      

      perform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   add 1 to N-reg-OK.264*controla el reg y lo aplica si es OK265     perform 4000-PROCESAR-REGISTRO-2266    move JURAD-reg to JURAD-reg-anterior267    add 1 to REG-LEIDOS268when "10"269*fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes271*        de que se terminara el archivo272     display "Falta el reg de totales del archivo JURAD "273         display "Nombre del archivo: " P-file-name274         display "File status: " JURAD-fs275         display "Ultimo registro leido: " N-reg-leidos276     display JURAD-reg-anterior277    perform 9000-CANCELAR-PROGRAMA278when other279*error de lectura: cancelacion del proceso280    display "Error en lectura del archivo JURAD "281     display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00    call "PONERR" using "01" JURAD-reg E-errores01 end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05     move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07exit paragraph0809move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************Zoom   Ctrl+C to stopRegistro de input:
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE   
      
   
   
   4000-PROCESAR-REGISTROI200800178009CALZADO ORION DEL LITORAL0330202000040601505420   140106

Datos en la alerta: 0001500054202014014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
      
   
   
   140106
Datos en la alerta: 000150005420201401

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO
      
   
   
   Datos en la alerta: 000150005420201401
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   13120633-REGRABAR-BDIIALE
000-PROCESAR-REGISTRO



I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO"display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

         

         

         display "4000-PROCESAR-REGISTRO-2"   94* La informacion esta leida en JURAD-reg95****************************************************************96 move "NO" to E-hay-error9798*    validacion del tip movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305 move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313 move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323 if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339**Zoom   Ctrl+C to stop4000-PROCESAR-REGISTRO


I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2

      
   
   
   
   4100-VALIDACION-FORMAL

I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
      
   
   
   
   
I200811046741SALUD AXIAL LTDA0440761998406903400219   9901014000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMALI200811046741SALUD AXIAL LTDA0440761998406903400219   990101

4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206990101
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206   
   
   
   
      Error    
   
   
   
      
09   
   
   
   
          
   
   
   
      Fecha ultima demanda vigente YYYYMMDD: fuera de rango4000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL


I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango

   
   
   
   
      4900-GRABAR-ERROR100-VALIDACION-FORMAL

I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR
   
   
   
   
      4000-PROCESAR-REGISTRO
I200811046741SALUD AXIAL LTDA0440761998406903400219   990101Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO   
   
   
   
      I200811046741SALUD AXIAL LTDA0440761998406903400219   990101

Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO   
   
   
   
      990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango

4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTROError 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024900-GRABAR-ERROR
000-PROCESAR-REGISTRO



I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   110402  3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.3334333533363337 4100-VALIDACION-FORMAL.3338Ddisplay "4100-VALIDACION-FORMAL"3339******************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove "NO" to E-hay-error8889 4000-PROCESAR-REGISTRO-2.0Ddisplay "4000-PROCESAR-REGISTRO-2"                                      1****************************************************************2* Controla los datos de un registro de JURAD y si es OK lo usa3* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"0call "PONERR" using "01" JURAD-reg E-errores1end-if23*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05move "SI" to IND-fin-proceso06     perform 4800-PROCESO-REG-T07    exit paragraph08end-if090add 1 to N-reg-leidos12*validacion formal de los datos3move 0 to codigo-error14perform 4100-VALIDACION-FORMAL15 if E-hay-error = "SI"16    perform 4900-GRABAR-ERROR17*    perform 4240-CONTAR-TIPO-CUENTA18exit paragraph19end-if01*si la validacion formal dio OK se hace validacion semantica2perform 4200-VALIDACION-SEMANTICA                                       3if E-hay-error = "SI"24perform 4900-GRABAR-ERROR25     perform 4240-CONTAR-TIPO-CUENTA26    exit paragraph27end-if2829perform 4240-CONTAR-TIPO-CUENTA01*    intento de actualizacion de BDIIALE2 perform 4300-MODIFICAR-BDIIALE3     add 1 to N-reg-OK.Break-point encountered    display "4000-PROCESAR-REGISTRO-2"   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO



I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   110402


   
   
   
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO



I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   110402


   
   
   
      
   4000-PROCESAR-REGISTRO-2000-PROCESAR-REGISTRO


I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2

   
   
   
      
   4100-VALIDACION-FORMAL

I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
   
   
   
      
   
I200830067928C I GLOMA S A0110432044040601203220   1004064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMALI200830067928C I GLOMA S A0110432044040601203220   100406

4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402100406
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402
   
   
      
      Error 
   
   
      
      
09
   
   
      
       
   
   
      
      Fecha ultima demanda vigente YYYYMMDD: fuera de rango4000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
   
   
      
      4900-GRABAR-ERROR100-VALIDACION-FORMAL
2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR
   
   
      
      4000-PROCESAR-REGISTRO2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
   
      
      22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
   
      
      40-CONTAR-TIPO-CUENTA
300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM

4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411
   
   
      
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM

4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411
   
   
      
      
   4000-PROCESAR-REGISTRO-233-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 200830067928999999000J001Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2
   
   
      
      
   4100-VALIDACION-FORMAL00-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001

Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL   
   
      
      
   Insercion de alerta nueva que ya existe  key: 200830067928999999000J001
Registro de input:

I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMALRegistro de input:
I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411I200830067928C I GLOMA S A0110432044040601203220   100406

Datos en la alerta: 0001100043202044044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411   
   
      
      
      Error    
   
      
      
      
09   
   
      
      
          
   
      
      
      Fecha ultima demanda vigente YYYYMMDD: fuera de rango100406
Datos en la alerta: 000110004320204404

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
   
      
      
      4900-GRABAR-ERRORDatos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR
   
      
      
      4000-PROCESAR-REGISTRO4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
      
      
      33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
      
      
      00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 200830067928999999000J002Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   13101000-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002

Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002

Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010   
      
      
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002

Registro de input:I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010   
      
      
      
   4000-PROCESAR-REGISTRO-2Insercion de alerta nueva que ya existe  key: 200830067928999999000J002
Registro de input:

I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2   
      
      
      
   4100-VALIDACION-FORMALRegistro de input:
I200830067928C I GLOMA S A0110432044040601203220   100406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL   
      
      
      
   I200830067928C I GLOMA S A0110432044040601203220   100406

Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL100406
Datos en la alerta: 000120003220201004

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010
      
      
      
      Error 
      
      
      
      
09
      
      
      
       
      
      
      
      Fecha ultima demanda vigente YYYYMMDD: fuera de rango4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
      
      
      
      4900-GRABAR-ERROR33-REGRABAR-BDIIALE
000-PROCESAR-REGISTRO



I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR


      
      
      
      4000-PROCESAR-REGISTRO000-PROCESAR-REGISTRO


I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

      
      
      
      

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO
      
      
      
      
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   1312064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTROI200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206

4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506131206
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   131206
4000-PROCESAR-REGISTRO-2

4100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506   
      
      
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop131206
4000-PROCESAR-REGISTRO-2

4100-VALIDACION-FORMAL
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506   
      
      
      
   4000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL


I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2

   
      
      
      
   4100-VALIDACION-FORMAL100-VALIDACION-FORMAL

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   perform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4100-VALIDACION-FORMAL

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
   
      
      
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moreperform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"     3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441Zoom   Ctrl+C to stop4100-VALIDACION-FORMAL

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
   
      
      
      
   4200-VALIDACION-SEMANTICA
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NIT605*Ubica NIT en archivla DIAN, BDIIDIAN606=============================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622     END-READ623     IF SW-ID-BDIIVIDE = 0624        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625     copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"                         RMB0013      4628$IF HACERMATCH = "SI"                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                                     RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                          RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                  REGISTRO DIRECC .6392017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640                 ORDENAN DE ACUERDO A LO DEFINIDO6412017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                         DE ESTANDARIZACION DE NOMBRES DE645*                      COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                   A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  * PROBABLE AUMENTANDO UN PESO CON BASE A LAMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEYREAD BDIIDIAN INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsDESCRIPCION-BDIIDIAN<W-S>SUBSUELO Y GEOTECNIA LTDA                                                      :   DESCRIPCION-BDIIDIAN<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEXT.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409  MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410     MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416                     MOVE 2 TO BLOQUES-INPUT-VALNOM417             ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418             END-IF419        END-IF420        PERFORM 10000-MATCH-NOMBRES-VALNOM421        IF MATCH-OK-OUT-VALNOM = 0422        MOVE 1 TO SW-NOMBRES-BDIIVIDE423        END-IF424          END-IF425       END-IF426      ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427              MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428     END-IFFAC0002      4429      END-IF                                                 FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441 EVALUATE TIP-IDE-BDIIVIDE442 WHEN 1443 PERFORM 85010-UBICA-CEDULA444   WHEN 2445 PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4Zoom   Ctrl+C to stop
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOM4421IF MATCH-OK-OUT-VALNOM = 04422MOVE 1 TO SW-NOMBRES-BDIIVIDE4423END-IF4424END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IFFAC0002      4429END-IFFAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 4ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE NOM-VAL-BDIIVIDE9315       END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO9319           BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334 "." BY " ","-" BY " ","," BY " ",9335   "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336      "Y" BY "G","H" BY "G","I" BY "G"9337         PERFORM VARYING I-VALNOM FROM 1 BY 19338                  UNTIL I-VALNOM >= 669339    IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341      MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342              END-IF9343       END-PERFORM9344ELSE9345         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346           " S.A. " BY "      ",     RMB0002      9347           "." BY " ", " LTDA " BY "",RMB0002      9348           " LIMITADA " BY "          ",RMB0002      9349           " CIA " BY "     ", " COMPA/IA " BY "          ",RMB0002      9350           " INVERSIONES " BY "             ",RMB0002      9351           " EMPRESA " BY "         ", RMB0002      9352           " CORPORACION " BY "      ",RMB0002      9353      " DE " BY "    ", " LA " BY "", " DEL " BY "",RMB0002      9354    " S " BY "   ", " A " BY "   "RMB0002      9355  " Y " BY "   "          GJC0003      9356  INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357  " S.A. " BY "      ",RMB0002      9358    "." BY " ", " LTDA " BY "",RMB0002      9359  " LIMITADA " BY "    ",RMB0002      9360    " CIA " BY "", " COMPA/IA " BY "",RMB0002    Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-INPUT-VALNOM.   71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220   131206Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860024151COMPUTEC SA0330332011140604500120   1104024000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860024151COMPUTEC SA0330332011140604500120   110402Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200860034313BANCO DAVIVIENDA SA0533000013040601102320   1104114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                          9374UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9375BASURA-VALNOM9376VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)9377VM-OK-VALNOM(4) VM-OK-VALNOM(5)9378VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)9379VM-OK-VALNOM(9) VM-OK-VALNOM(10)9380VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)9381VM-OK-VALNOM(14) VM-OK-VALNOM(15)9382VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)9383VM-OK-VALNOM(19) VM-OK-VALNOM(20).9384***********HACE LA VALIDACION BLOQUE A BLOQUE********************9385MOVE 1 TO I-VALNOM.9386MOVE 0 TO BLOQOK-AUX-VALNOM.9387PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   MOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IFIF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"display "4222-VALIDA-NOMBRE-COINCIDE"5657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69 not invalid key70move 0 to SW-BDIIALE71read BDIIALE next record72at end73    move 1 to SW-BDIIALE74    end-read75end-start7677     perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79     or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80         if FUENTE-BDIIALE = 99000381         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82     and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83    and BLOQUEO-BDIIALE = 084     encontrado85     move 1 to SW-BDIIALE86    end-if87 if SW-BDIIALE = 088    read BDIIALE next record at end89       move 1 to SW-BDIIALE90end-read91end-if92     end-perform.9394     if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97     else98        if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOS


      


      


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at end 
move 1 to SQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsSW-BDIIALE<W-S>0:   SW-BDIIALE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   SW-BDIIALE 0AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   read BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 192end-perform.9394 if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97         else98         if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCREGIS501            add 1 to CONT-FALLECIDOS502        end-if503    end-if504end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524******************************************************************525IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526ADD 1 TO W-CONT-TIPO-6527ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529ADD 1 TO W-CONT-TIPO-7530    ELSE531*    registros correctos, repetidos o no532ADD 1 TO W-CONT-TIPO-5533*    si es una empresa534IF TIPOID-E = 2 OR 3535ADD 1 TO W-CONT-TIPO-5-PJ36END-IF37END-IFif TIP-IDE-BDIIVIDE = 136    else37perform 4222-VALIDA-NOMBRE-COINCIDE38    end-if39end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"444******************************************************************445* Validación de IDs que figuran OK pero el nombre no coincide446******************************************************************447*nombre no coincide448IF TIP-IDE-BDIIVIDE = 1449*es una cédula450MOVE 02 TO CODIGO-ERROR451     ELSE452*    no es una cédula453         MOVE 01 TO CODIGO-ERROR454 END-IF.455456457 4222-VALIDA-NOMBRE-COINCIDE.458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"459******************************************************************460* Validación de IDs que figuran OK pero el nombre coincide461******************************************************************462nombre coincide: busca ID en BDIIALE463 initialize LLAVE-BDIIALE464 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE465 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE466 move 990003 to FUENTE-BDIIALE467 start BDIIALE key not < LLAVE-BDIIALE INVALID KEY468         move 1 TO SW-BDIIALE469not invalid key470move 0 to SW-BDIIALE471    read BDIIALE next record472at end473move 1 to SW-BDIIALE474end-read475 end-start476477 perform until SW-BDIIALE = 1478or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480if FUENTE-BDIIALE = 990003481and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-if81and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83and BLOQUEO-BDIIALE = 084*         encontrado85move 1 to SW-BDIIALE86end-if87         if SW-BDIIALE = 088         read BDIIALE next record at end89                 move 1 to SW-BDIIALE90             end-read91         end-if92 end-perform.9394 if TIP-IDE-BDIIVIDE = 195if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196    move 07 to CODIGO-ERROR97 else98    if ESTADO-VIG-BDIIREGI = 2199       move 06 to CODIGO-ERROR500add 1 to NO-COINCIDE-REGIS501add 1 to CONT-FALLECIDOS502             end-if503     end-if504     end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524******************************************************************525IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526ADD 1 TO W-CONT-TIPO-6










Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsTIP-IDE-BDIIVIDE<W-S>2                      ROR:   TIP-IDE-BDIIVIDE<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   TIP-IDE-BDIIVIDE = 1 if ESTADO-VIG-BDIIREGI =     move 07 to CODIGO-ERRORAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   36else37    perform 4222-VALIDA-NOMBRE-COINCIDE38end-if39 end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"44******************************************************************45* Validación de IDs que figuran OK pero el nombre no coincide46******************************************************************47*nombre no coincide48IF TIP-IDE-BDIIVIDE = 149*    es una cédula50MOVE 02 TO CODIGO-ERROR51ELSE52*no es una cédula53MOVE 01 TO CODIGO-ERROR54END-IF.455456457 4222-VALIDA-NOMBRE-COINCIDE.458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"459******************************************************************460* Validación de IDs que figuran OK pero el nombre coincide461******************************************************************462*    nombre coincide: busca ID en BDIIALE463 initialize LLAVE-BDIIALE464     move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE465 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE466 move 990003 to FUENTE-BDIIALE467 start BDIIALE key not < LLAVE-BDIIALE INVALID KEY468     move 1 TO SW-BDIIALE469 not invalid key470     move 0 to SW-BDIIALE471     read BDIIALE next record472     at end473         move 1 to SW-BDIIALE474     end-read475 end-start476477 perform until SW-BDIIALE = 1478 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479     or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480    if FUENTE-BDIIALE = 990003481and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-if81and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83and BLOQUEO-BDIIALE = 084*         encontrado85move 1 to SW-BDIIALE86end-if87         if SW-BDIIALE = 088         read BDIIALE next record at end89                 move 1 to SW-BDIIALE90             end-read91         end-if92 end-perform.9394 if TIP-IDE-BDIIVIDE = 195if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196    move 07 to CODIGO-ERROR97 else98    if ESTADO-VIG-BDIIREGI = 2199       move 06 to CODIGO-ERROR500add 1 to NO-COINCIDE-REGIS501add 1 to CONT-FALLECIDOS502             end-if503     end-if504     end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524******************************************************************525IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526ADD 1 TO W-CONT-TIPO-637    perform 4222-VALIDA-NOMBRE-COINCIDE38end-if39end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"44******************************************************************45* Validación de IDs que figuran OK pero el nombre no coincide46******************************************************************47*nombre no coincide48IF TIP-IDE-BDIIVIDE = 149*es una cédula50    MOVE 02 TO CODIGO-ERROR51ELSE52*no es una cédula53MOVE 01 TO CODIGO-ERROR54END-IF.55456457 4222-VALIDA-NOMBRE-COINCIDE.458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"459******************************************************************460* Validación de IDs que figuran OK pero el nombre coincide461******************************************************************462*nombre coincide: busca ID en BDIIALE463     initialize LLAVE-BDIIALE464 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE465     move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE466 move 990003 to FUENTE-BDIIALE467 start BDIIALE key not < LLAVE-BDIIALE INVALID KEY468     move 1 TO SW-BDIIALE469 not invalid key470     move 0 to SW-BDIIALE471     read BDIIALE next record472     at end473         move 1 to SW-BDIIALE474     end-read475 end-start476477 perform until SW-BDIIALE = 1478 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479 or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480         if FUENTE-BDIIALE = 990003481    and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD482and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDend-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326         exit paragraph327 end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333 add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343     if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346 end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361    call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASPerform-level      Exit View

      

      

      

      

      perform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   add 1 to N-reg-OK.264*controla el reg y lo aplica si es OK265     perform 4000-PROCESAR-REGISTRO-2266    move JURAD-reg to JURAD-reg-anterior267    add 1 to REG-LEIDOS268when "10"269*fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes271*        de que se terminara el archivo272     display "Falta el reg de totales del archivo JURAD "273         display "Nombre del archivo: " P-file-name274         display "File status: " JURAD-fs275         display "Ultimo registro leido: " N-reg-leidos276     display JURAD-reg-anterior277    perform 9000-CANCELAR-PROGRAMA278when other279*error de lectura: cancelacion del proceso280    display "Error en lectura del archivo JURAD "281     display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00    call "PONERR" using "01" JURAD-reg E-errores01 end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05     move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07exit paragraph0809move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************

         

         

         display "4000-PROCESAR-REGISTRO"read JURADZoom   Ctrl+C to stop
I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO   
      
   
   
   I200860034313BANCO DAVIVIENDA SA0533000013040601102320   110411

Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
      
   
   
   110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango

4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTROError 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064900-GRABAR-ERROR
000-PROCESAR-REGISTRO



I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopread JURADdisplay "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress   w-contadores.                                                                                       display "4000-PROCESAR-REGISTRO-2"                     ****************************************************trola los datos de un registro de JURAD y si es OK la actualizar el archivo de alertas en lineaW-CONTADORES<W-S>   000005000001000003000004000000:   W-CONTADORES<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    display "4000-PROCESAR-REGISTRO   ********************************ntrola los datos de un registro AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress   w-contadores.                                                                                          j   u   r   a   d   -   r   e   g                         display "4000-PROCESAR-REGISTRO-2"                     ****************************************************trola los datos de un registro de JURAD y si es OK la actualizar el archivo de alertas en lineaJURAD-REG<W-S>   I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106              :   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    display "4000-PROCESAR-REGISTRO-2"                    ****************************************************ntrola los datos de un registro de JURAD y si es OK ra actualizar el archivo de alertas en lineaAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   display "4000-PROCESAR-REGISTRO-2"   8889-2.90display "4000-PROCESAR-REGISTRO-2"                                      9192* Controla los datos de un registro de JURAD y si es OK lo usa93* para actualizar el archivo de alertas en linea94* La informacion esta leida en JURAD-reg95****************************************************************96move "NO" to E-hay-error9798*validacion del tipo de movimiento99 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300 call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305move "SI" to IND-fin-proceso306    perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313move 0 to codigo-error314perform 4100-VALIDACION-FORMAL315if E-hay-error = "SI"316    perform 4900-GRABAR-ERROR317perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332     perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.                                       move "NO" to E-hay-errorZoom   Ctrl+C to stop4000-PROCESAR-REGISTRO


I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2

      
   
   
   
   4100-VALIDACION-FORMAL

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove "NO" to E-hay-errorperform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"     3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441Zoom   Ctrl+C to stop

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
      
   
   
   
   4200-VALIDACION-SEMANTICA
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NIT605*Ubica NIT en archivla DIAN, BDIIDIAN606=============================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622     END-READ623     IF SW-ID-BDIIVIDE = 0624        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625     copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"                         RMB0013      4628$IF HACERMATCH = "SI"                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                                     RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                          RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                  REGISTRO DIRECC .6392017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640                 ORDENAN DE ACUERDO A LO DEFINIDO6412017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                         DE ESTANDARIZACION DE NOMBRES DE645*                      COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                   A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  * PROBABLE AUMENTANDO UN PESO CON BASE A LAMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEYREAD BDIIDIAN INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DEQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsDESCRIPCION-BDIIDIAN<W-S>SUPERTIENDAS Y DROGUERIAS OLIMPICA S.A.                                        :   DESCRIPCION-BDIIDIAN<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEXT.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409  MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410     MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416                     MOVE 2 TO BLOQUES-INPUT-VALNOM417             ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418             END-IF419        END-IF420        PERFORM 10000-MATCH-NOMBRES-VALNOM421        IF MATCH-OK-OUT-VALNOM = 0422        MOVE 1 TO SW-NOMBRES-BDIIVIDE423        END-IF424          END-IF425       END-IF426      ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427              MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428     END-IFFAC0002      4429      END-IF                                                 FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441 EVALUATE TIP-IDE-BDIIVIDE442 WHEN 1443 PERFORM 85010-UBICA-CEDULA444   WHEN 2445 PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4Zoom   Ctrl+C to stop
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOM4421IF MATCH-OK-OUT-VALNOM = 04422MOVE 1 TO SW-NOMBRES-BDIIVIDE4423END-IF4424END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IFFAC0002      4429END-IFFAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 4ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE NOM-VAL-BDIIVIDE9315       END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO9319           BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334 "." BY " ","-" BY " ","," BY " ",9335   "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336      "Y" BY "G","H" BY "G","I" BY "G"9337         PERFORM VARYING I-VALNOM FROM 1 BY 19338                  UNTIL I-VALNOM >= 669339    IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341      MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342              END-IF9343       END-PERFORM9344ELSE9345         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346           " S.A. " BY "      ",     RMB0002      9347           "." BY " ", " LTDA " BY "",RMB0002      9348           " LIMITADA " BY "          ",RMB0002      9349           " CIA " BY "     ", " COMPA/IA " BY "          ",RMB0002      9350           " INVERSIONES " BY "             ",RMB0002      9351           " EMPRESA " BY "         ", RMB0002      9352           " CORPORACION " BY "      ",RMB0002      9353      " DE " BY "    ", " LA " BY "", " DEL " BY "",RMB0002      9354    " S " BY "   ", " A " BY "   "RMB0002      9355  " Y " BY "   "          GJC0003      9356  INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357  " S.A. " BY "      ",RMB0002      9358    "." BY " ", " LTDA " BY "",RMB0002      9359  " LIMITADA " BY "    ",RMB0002      9360    " CIA " BY "", " COMPA/IA " BY "",RMB0002    Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE SPACES TO VECTOR-INPUT-VALNOM.   UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOZoom   Ctrl+C to stop
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopUNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   1310104000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320   131010Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   1305064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J001Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                          9374UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9375BASURA-VALNOM9376VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)9377VM-OK-VALNOM(4) VM-OK-VALNOM(5)9378VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)9379VM-OK-VALNOM(9) VM-OK-VALNOM(10)9380VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)9381VM-OK-VALNOM(14) VM-OK-VALNOM(15)9382VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)9383VM-OK-VALNOM(19) VM-OK-VALNOM(20).9384***********HACE LA VALIDACION BLOQUE A BLOQUE********************9385MOVE 1 TO I-VALNOM.9386MOVE 0 TO BLOQOK-AUX-VALNOM.9387PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   MOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"   


         


         


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALE57 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69not invalid key70 move 0 to SW-BDIIALE71read BDIIALE next record72at end73move 1 to SW-BDIIALE74read75start7677perform until SW-BDIIALE = 178     or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79 or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80         if FUENTE-BDIIALE = 99000381         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82         and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83     and BLOQUEO-BDIIALE = 084*         encontrado85      move 1 to SW-BDIIALE86end-if87    if SW-BDIIALE = 088     read BDIIALE next record at end89        move 1 to SW-BDIIALE90        end-read91end-if92end-perform.9394 if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97         else98         if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCREGIS501            add 1 to CONT-FALLECIDOS502        end-ifinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 192     end-perform.9394     if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97     else98        if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOS502        end-if503end-if504end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 2151907=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524******************************************************************525IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526ADD 1 TO W-CONT-TIPO-6527ELSE528IF CODIGO-ERROR = 03 OR 04 OR 05529        ADD 1 TO W-CONT-TIPO-7530ELSE531*registros correctos, repetidos o no532    ADD 1 TO W-CONT-TIPO-5533*si es una empresa534IF TIPOID-E = 2 OR 335ADD 1 TO W-CONT-TIPO-5-PJ36END-IF37END-IFif TIP-IDE-BDIIVIDE = 136    else37perform 4222-VALIDA-NOMBRE-COINCIDE38    end-if39end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"444******************************************************************445* Validación de IDs que figuran OK pero el nombre no coincide446******************************************************************447*nombre no coincide448IF TIP-IDE-BDIIVIDE = 1449*es una cédula450MOVE 02 TO CODIGO-ERROR451     ELSE452*    no es una cédula453         MOVE 01 TO CODIGO-ERROR454 END-IF.455456457 4222-VALIDA-NOMBRE-COINCIDE.458Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"459******************************************************************460* Validación de IDs que figuran OK pero el nombre coincide461******************************************************************462nombre coincide: busca ID en BDIIALE463 initialize LLAVE-BDIIALE464 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE465 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE466 move 990003 to FUENTE-BDIIALE467 start BDIIALE key not < LLAVE-BDIIALE INVALID KEY468         move 1 TO SW-BDIIALE469not invalid key470move 0 to SW-BDIIALE471    read BDIIALE next record472at end473move 1 to SW-BDIIALE474end-read475 end-start476477 perform until SW-BDIIALE = 1478or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480if FUENTE-BDIIALE = 990003481and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASPerform-level      Exit View

      

      

      

      

      

      perform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   add 1 to N-reg-OK.264*controla el reg y lo aplica si es OK265     perform 4000-PROCESAR-REGISTRO-2266    move JURAD-reg to JURAD-reg-anterior267    add 1 to REG-LEIDOS268when "10"269*fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes271*        de que se terminara el archivo272     display "Falta el reg de totales del archivo JURAD "273         display "Nombre del archivo: " P-file-name274         display "File status: " JURAD-fs275         display "Ultimo registro leido: " N-reg-leidos276     display JURAD-reg-anterior277    perform 9000-CANCELAR-PROGRAMA278when other279*error de lectura: cancelacion del proceso280    display "Error en lectura del archivo JURAD "281     display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00    call "PONERR" using "01" JURAD-reg E-errores01 end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05     move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07exit paragraph0809move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************Zoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001

Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE   
   
   
   
   4000-PROCESAR-REGISTROInsercion de alerta nueva que ya existe  key: 200890934264999999000J001
Registro de input:

I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
   
   
   
   Registro de input:
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
   
   
   
   I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506

Datos en la alerta: 0004500000202010084320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO130506
Datos en la alerta: 000450000020201008

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   120406Datos en la alerta: 000450000020201008
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   120406  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO"display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress   jurad-reg.                                                                                          display "4000-PROCESAR-REGISTRO-2"                     ****************************************************trola los datos de un registro de JURAD y si es OK la actualizar el archivo de alertas en lineaJURAD-REG<W-S>   I300600003115xxxxxx                                       0150542014010600400320120406              :   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    display "4000-PROCESAR-REGISTRO-2"                    ****************************************************ntrola los datos de un registro de JURAD y si es OK ra actualizar el archivo de alertas en lineaAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

         

         

         display "4000-PROCESAR-REGISTRO-2"   94* La informacion esta leida en JURAD-reg95****************************************************************96 move "NO" to E-hay-error9798*    validacion del tip movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305 move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313 move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323 if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339**Zoom   Ctrl+C to stop4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE

4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2
   
   
   
   
   4100-VALIDACION-FORMAL33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.3334333533363337 4100-VALIDACION-FORMAL.3338Ddisplay "4100-VALIDACION-FORMAL"3339******************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove "NO" to E-hay-errorperform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403move JURAD-id-tipo to TIP-IDE-BDIIVIDE404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R405 move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414     MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419del nombre reportado420*Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423 if SW-ID-BDIIVIDE = 1424*    es un id inválido425    call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna42710-VALIDACION-ID-NO-FIGURA428else429*    existe id, a ver si el nombre coincide430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432display "novedad:  " JURAD-nombre433         display "registro: " NOM-LEIDO-BDIIVIDE434*        validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439     end-if.440441Zoom   Ctrl+C to stop4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS

4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
   
   
   
   
   4200-VALIDACION-SEMANTICA00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM

4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NIT605*Ubica NIT en archivla DIAN, BDIIDIAN606=============================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622     END-READ623     IF SW-ID-BDIIVIDE = 0624        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625     copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"                         RMB0013      4628$IF HACERMATCH = "SI"                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                                     RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                          RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                  REGISTRO DIRECC .6392017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640                 ORDENAN DE ACUERDO A LO DEFINIDO6412017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                         DE ESTANDARIZACION DE NOMBRES DE645*                      COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                   A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  * PROBABLE AUMENTANDO UN PESO CON BASE A LAMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEYREAD BDIIDIAN INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DEQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsDESCRIPCION-BDIIDIAN<W-S>FERNANDEZ PENA JULIO ANTONIO                                                   :   DESCRIPCION-BDIIDIAN<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEXT.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409  MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410     MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416                     MOVE 2 TO BLOQUES-INPUT-VALNOM417             ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418             END-IF419        END-IF420        PERFORM 10000-MATCH-NOMBRES-VALNOM421        IF MATCH-OK-OUT-VALNOM = 0422        MOVE 1 TO SW-NOMBRES-BDIIVIDE423        END-IF424          END-IF425       END-IF426      ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427              MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428     END-IFFAC0002      4429      END-IF                                                 FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441 EVALUATE TIP-IDE-BDIIVIDE442 WHEN 1443 PERFORM 85010-UBICA-CEDULA444   WHEN 2445 PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1Zoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM

4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOM4421IF MATCH-OK-OUT-VALNOM = 04422MOVE 1 TO SW-NOMBRES-BDIIVIDE4423END-IF4424END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IFFAC0002      4429END-IFFAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 4ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopIF SW-VERIFNOM-BDIIVIDE = 19315       END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO9319           BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334 "." BY " ","-" BY " ","," BY " ",9335   "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336      "Y" BY "G","H" BY "G","I" BY "G"9337         PERFORM VARYING I-VALNOM FROM 1 BY 19338                  UNTIL I-VALNOM >= 669339    IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341      MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342              END-IF9343       END-PERFORM9344ELSE9345         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346           " S.A. " BY "      ",     RMB0002      9347           "." BY " ", " LTDA " BY "",RMB0002      9348           " LIMITADA " BY "          ",RMB0002      9349           " CIA " BY "     ", " COMPA/IA " BY "          ",RMB0002      9350           " INVERSIONES " BY "             ",RMB0002      9351           " EMPRESA " BY "         ", RMB0002      9352           " CORPORACION " BY "      ",RMB0002      9353      " DE " BY "    ", " LA " BY "", " DEL " BY "",RMB0002      9354    " S " BY "   ", " A " BY "   "RMB0002      9355  " Y " BY "   "          GJC0003      9356  INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357  " S.A. " BY "      ",RMB0002      9358    "." BY " ", " LTDA " BY "",RMB0002      9359  " LIMITADA " BY "    ",RMB0002      9360    " CIA " BY "", " COMPA/IA " BY "",RMB0002    Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM

4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-INPUT-VALNOM.   71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM

4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890934264999999000J002Registro de input:I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420   130506Datos en la alerta: 0000200044202013054320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                          9374UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9375BASURA-VALNOM9376VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)9377VM-OK-VALNOM(4) VM-OK-VALNOM(5)9378VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)9379VM-OK-VALNOM(9) VM-OK-VALNOM(10)9380VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)9381VM-OK-VALNOM(14) VM-OK-VALNOM(15)9382VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)9383VM-OK-VALNOM(19) VM-OK-VALNOM(20).9384***********HACE LA VALIDACION BLOQUE A BLOQUE********************9385MOVE 1 TO I-VALNOM.9386MOVE 0 TO BLOQOK-AUX-VALNOM.9387PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   IF TIP-ID-INPUT-VALNOM <> 2IF TIP-ID-INPUT-VALNOM <> 2PERFORM 10100-MATCH-APROXIMADOPerform-level      Exit ViewPERFORM 10100-MATCH-APROXIMADOIF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMEND-IF.END-IF.4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEMOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IFEND-IFEND-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresPerform-level      Exit View   


         


         


      call "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombreAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More      


         


         


      display "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE   


         


         


      display "registro: " NOM-LEIDO-BDIIVIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEdisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"   


         


         


      display "4220-VALIDA-NOMBRE-NO-COINCIDE"IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1MOVE 01 TO CODIGO-ERRORMOVE 01 TO CODIGO-ERROR376if not ANO-VAL or not MES-VAL or not DIA-VAL377     call "PONERR" using "09" JURAD-reg E-errores378end-if379Numero de embargos vigentes380if JURAD-embargos-vigentes not numeric381 call "PONERR" using "10" JURAD-reg E-errores382end-if383*Numero de embargos terminados384 if JURAD-embargos-terminados not numeric385call "PONERR" using "11" JURAD-reg E-errores386end-if387*Fecha ultimo embargo vigente YYMMDD388if JURAD-embargos-fecha-ultimo is not numeric389 call "PONERR" using "12" JURAD-reg E-errores390end-if391move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS392if not ANO-VAL or not MES-VAL or not DIA-VAL393call "PONERR" using "13" JURAD-reg E-errores394395396397 420CION-SEMANTICA.398display "4200-VALIDACION-SEMANTICA"                                       339900ol numero de identificacion y de su relacion con01* el nombre02****************************************************************03move JURAD-id-tipo to TIP-IDE-BDIIVIDE04 move JURAD-id-numero to NUM-IDE-BDIIVIDE-R05move JURAD-nombre to NOMBRE-BDIIVIDE0607 move JURAD-id-tipo to TIPOID-E08move JURAD-id-numero to NUMID-E09move JURAD-nombre to NOMBRE-E1011move 1 to SW-VERIFNOM-BDIIVIDE12     move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE13 IF TIP-IDE-BDIIVIDE = 2 OR 314         MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE15     END-IF16     MOVE 2 TO NUM-BLOQUES-BDIIVIDE17Valida el numero de identificación contra las bases de18*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia19*del nombre reportado20*Retorna SW-ID-BDIIVIDE=1 si hay error21perform 80100-VALIDAR-IDENTIFICACION                                    421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423if SW-ID-BDIIVIDE = 1424    es un id inválido425    call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428 else429*    existe id, a ver si el nombre coincide430if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432         display "novedad:  " JURAD-nombre433        display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436    else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439440441442 422-NOMBRE-NO-COINCIDE.443display "4220-VALIDA-NOMBRE-NO-COINCIDE"444**45ó IDs que figuran OK pero el nombre no coincide46******************************************************************47*    nombre no coincide48IF TIP-IDE-BDIIVIDE = 149*    es una cédula50    MOVE 02 TO CODIGO-ERROR51ELSE52*    no es una cédula53    MOVE 01 TO CODIGO-ERROR54END-IF.555657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62nombre coincide: busca ID en BDIIALE63 initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65 move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALEMOVE 01 TO CODIGO-ERROREND-IF.    MOVE 01 TO Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCODIGO-ERROR<W-S>01:   CODIGO-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CODIGO-ERRORAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   END-IF.end-if.end-if.376if not ANO-VAL or not MES-VAL or not DIA-VAL377     call "PONERR" using "09" JURAD-reg E-errores378end-if379Numero de embargos vigentes380if JURAD-embargos-vigentes not numeric381 call "PONERR" using "10" JURAD-reg E-errores382end-if383*Numero de embargos terminados384 if JURAD-embargos-terminados not numeric385call "PONERR" using "11" JURAD-reg E-errores386end-if387*Fecha ultimo embargo vigente YYMMDD388if JURAD-embargos-fecha-ultimo is not numeric389 call "PONERR" using "12" JURAD-reg E-errores390end-if391move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS392if not ANO-VAL or not MES-VAL or not DIA-VAL393call "PONERR" using "13" JURAD-reg E-errores394395396397 420CION-SEMANTICA.398display "4200-VALIDACION-SEMANTICA"                                       339900ol numero de identificacion y de su relacion con01* el nombre02****************************************************************03move JURAD-id-tipo to TIP-IDE-BDIIVIDE04 move JURAD-id-numero to NUM-IDE-BDIIVIDE-R05move JURAD-nombre to NOMBRE-BDIIVIDE0607 move JURAD-id-tipo to TIPOID-E08move JURAD-id-numero to NUMID-E09move JURAD-nombre to NOMBRE-E1011move 1 to SW-VERIFNOM-BDIIVIDE12     move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE13 IF TIP-IDE-BDIIVIDE = 2 OR 314         MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE15     END-IF16     MOVE 2 TO NUM-BLOQUES-BDIIVIDE17Valida el numero de identificación contra las bases de18*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia19*del nombre reportado20*Retorna SW-ID-BDIIVIDE=1 si hay error21perform 80100-VALIDAR-IDENTIFICACION                                    21*si la validacion formal dio OK se hace validacion semantica22perform 4200-VALIDACION-SEMANTICA                                       23if E-hay-error = "SI"24     perform 4900-GRABAR-ERROR25    perform 4240-CONTAR-TIPO-CUENTA26exit paragraph272829perform 4240-CONTAR-TIPO-CUENTA3031*intento de actualizacion de BDIIALE32 perform 4300-MODIFICAR-BDIIALE33add 1 to N-reg-OK.34353637 4100-VALIDACION-FORMAL.38Ddisplay "4100-VALIDACION-FORMAL"39******************************************************************40* Validacion formal de los datos del input41******************************************************************42*    Tipo de identificacion Numero {1, 2, 3, 4}43 if JURAD-id-tipo not = "1" and "2" and "3" and "4"44         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347*    Numero de identificacion348if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357    exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361    call "PONERR" using "05" JURAD-reg E-errores362 end-if363Numero de demandas vigentes364 if JURAD-demandas-vigentes is not numeric365     call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR861862 4900-GRABAR-ERROR.863Ddisplay "4900-GRABAR-ERROR"864******************************************************************865* El registro de JURAD tiene error: se graba en el archivo ERRS866* con indicacion del error detectado867******************************************************************86move JURAD-reg to ERRS-reg86move E-errores-reg to ERRS-causa-rechazo870*lista de los codigos de los errores del registro871 move E-errores-reg to ERRS-causa-rechazo87write ERRS-reg87evaluate ERRS-fs87when "00"87continue87when other877             display "Error al grabar el archivo de errores "878         display "Nombre del archivo: " ERRS-file-name879             display "File status: " ERRS-fs880             perform 9000-CANCELAR-PROGRAMA881             goback882 end-evaluate.883884885 4320-ARMAR-TEXTO-ALERTA.886Ddisplay "4320-ARMAR-TEXTO-ALERTA"887****************************************************************888* Hace el reemplazo de los valores adecuados en los templates889* de las linea de alerta que corresponde890****************************************************************891*segun se trate de demandas o embargos89if JURAD-demandas-vigentes not = 089or JURAD-demandas-terminadas not = 0894     set LAx to 1895     move high-values to LA-valores89    move JURAD-demandas-vigentes to LA-num897* >>>> esto esta anulado x que no se como hacer para que lo compile898*    unstring LA-numX into LA-descarte LA-valor(1)89    delimited by all space90    move LA-numx(9:12) to LA-valor(1)90move JURAD-demandas-terminadas to LA-num902* >>>> esto esta anulado x que no se como hacer para que lo compile90    unstring LA-numX into LA-descarte LA-valor(2)904*    delimited by all space90move LA-numx(9:12) to LA-valor(2)906
      
      
      display "4900-GRABAR-ERROR"move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fscontinuecontinueend-evaluate.end-evaluate.323if E-hay-error = "SI"324         perform 4900-GRABAR-ERROR325     perform 4240-CONTAR-TIPO-CUENTA326         exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345move 05 to codigo-error346end-if347*    Numero de identificacion348 if JURAD-id-numeroX is not numeric349         call "PONERR" using "03" JURAD-reg E-errores350     end-if351     if JURAD-id-numero not > 0352         call "PONERR" using "04" JURAD-reg E-errores353 end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361 call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364     if JURAD-demandas-vigentes is not numeric365 call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numericperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide51402=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*    cuenta tipo 7: 03 04 05524525 IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526    ADD 1 TO W-CONT-TIPO-6527ELSE528IF CODIGO-ERROR = 03 OR 04 OR 05529        ADD 1 TO W-CONT-TIPO-7530     ELSE531*        registros correctos, repetidos o no532    ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534        IF TIPOID-E = 2 OR 3535        ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537     END-IF538 END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546 MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548*valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550 IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6324perform 4900-GRABAR-ERROR325         perform 4240-CONTAR-TIPO-CUENTA326     exit paragraph327     end-if328329 perform 4240-CONTAR-TIPO-CUENTA330331intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333 add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349 call "PONERR" using "03" JURAD-reg E-errores350end-if351 if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361         call "PONERR" using "05" JURAD-reg E-errores362     end-if363*    Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numeric369call "PONERR" using "07" JURAD-reg E-erroresexit paragraph264*controla el reg y lo aplica si es OK26000-PROCESAR-REGISTRO-226move JURAD-reg to JURAD-reg-anterior26    add 1 to REG-LEIDOS26when "10"269*    fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes27    de que se terminara el archivo27    display "Falta el reg de totales del archivo JURAD "27    display "Nombre del archivo: " P-file-name27display "File status: " JURAD-fs27display "Ultimo registro leido: " N-reg-leidos27display JURAD-reg-anterior277         perform 9000-CANCELAR-PROGRAMA278 when other279*        error de lectura: cancelacion del proceso280         display "Error en lectura del archivo JURAD "281         display "Nombre del archivo: " P-file-name282     display "File status: " JURAD-fs28    display "Ultimo registro leido: " N-reg-leidos28display JURAD-reg-anterior28perform 9000-CANCELAR-PROGRAMA28evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************29move "NO" to E-hay-error297298*validacion del tipo de movimiento299 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"0    call "PONERR" using "01" JURAD-reg E-errores0end-if020si es el registro "T" hay que señalar el fin de proceso0tipo-novedad = "T"0move "SI" to IND-fin-proceso0    perform 4800-PROCESO-REG-T07     exit paragraph0end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSZoom   Ctrl+C to stop4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO



I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA


   
   
   
      4000-PROCESAR-REGISTRO000-PROCESAR-REGISTRO


I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

   
   
   
      

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO
   
   
   
      
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   1301064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTROI200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106

4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406130106
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406  3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if3309ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopadd 1 to REG-LEIDOSdisplay "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop130106
4000-PROCESAR-REGISTRO-2

4100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406
   
   
      
   4000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2
   
   
      
   4100-VALIDACION-FORMAL100-VALIDACION-FORMAL
2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if3309ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325 perform 4240-CONTAR-TIPO-CUENTA326 xit paragraph327 end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346 end-if347*    Numero de identificacion348     if JURAD-id-numeroX is not numeric349         call "PONERR" using "03" JURAD-reg E-errores350     end-if351     if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354si el movimiento es una eliminacion los datos subsiguientes355*no se controlan56if JURAD-tipo-novedad = "E"57    exit paragraph58end-if59Nombres y Apellidos60nombre = spaces61call "PONERR" using "05" JURAD-reg E-errores62end-if63*Numero de demandas vigentes64if JURAD-demandas-vigentes is not numeric65call "PONERR" using "06" JURAD-reg E-erroresBreak-point encountered    perform 4200-VALIDACION-SEMANTICA   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4200-VALIDACION-SEMANTICA   9697 4200-VALIDACION-SEMANTICA.98Ddisplay "4200-VALIDACION-SEMANTICA"   99****************************************************************400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403move JURAD-id-tipo to TIP-IDE-BDIIVIDE404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407 move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413     IF TIP-IDE-BDIIVIDE = 2 OR 3414     MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415     END-IF416     MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*    Valida el numero de identificación contra las bases de418datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420*Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423 if SW-ID-BDIIVIDE = 1424*    es un id inválido42514426*    valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429*    existe id, a ver si el nombre coincide430     if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431         call "PONERR" using "15" JURAD-reg E-errores432        display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*        validación en base alterna435         perform 4220-VALIDA-NOMBRE-NO-COINCIDE436    else437    perform 4222-VALIDA-NOMBRE-COINCIDE438    end-if439 end-if.440441Zoom   Ctrl+C to stop4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
   
   
      
   4200-VALIDACION-SEMANTICA2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressOMjurad-reg.                                                                                              INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM           NOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"IF SW-VERIFNOM-BDIIVIDE NOT NUMERIC                     JURAD-REG<W-S>NOMI300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406                  :   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM            NOMBRES-AUX-W-BDIIVIDE INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0" IF SW-VERIFNOM-BDIIVIDE NOT NUMERIC                    AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"Zoom   Ctrl+C to stop4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE

4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"PERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NIT605*Ubica NIT en archivla DIAN, BDIIDIAN606=============================607MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN608READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE609END-READ610IF SW-ID-BDIIVIDE = 0611MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE612END-IF.613614 85030-UBICA-EXT.615*================================================================616*85030-UBICA-EXT.617*Ubica cedula de extranjeria en archivo del DAS618*================================================================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622     END-READ623     IF SW-ID-BDIIVIDE = 0624        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625     copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"                         RMB0013      4628$IF HACERMATCH = "SI"                RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE                                     RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                          RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                  REGISTRO DIRECC .6392017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640                 ORDENAN DE ACUERDO A LO DEFINIDO6412017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                         DE ESTANDARIZACION DE NOMBRES DE645*                      COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                   A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  * PROBABLE AUMENTANDO UN PESO CON BASE A LAMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEYREAD BDIIDIAN INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsDESCRIPCION-BDIIDIAN<W-S>CONDOLUCI DOMINGO ANTONIO                                                      :   DESCRIPCION-BDIIDIAN<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEXT.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsDESCRIPCION-BDIIDIAN<W-S>CONDOLUCI DOMINGO ANTONIO                                                      :   DESCRIPCION-BDIIDIAN<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEXT.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409  MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410     MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416                     MOVE 2 TO BLOQUES-INPUT-VALNOM417             ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418             END-IF419        END-IF420        PERFORM 10000-MATCH-NOMBRES-VALNOM421        IF MATCH-OK-OUT-VALNOM = 0422        MOVE 1 TO SW-NOMBRES-BDIIVIDE423        END-IF424          END-IF425       END-IF426      ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427              MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428     END-IFFAC0002      4429      END-IF                                                 FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441 EVALUATE TIP-IDE-BDIIVIDE442 WHEN 1443 PERFORM 85010-UBICA-CEDULA444   WHEN 2445 PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEZoom   Ctrl+C to stop4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE

4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOM4421IF MATCH-OK-OUT-VALNOM = 04422MOVE 1 TO SW-NOMBRES-BDIIVIDE4423END-IF4424END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IFFAC0002      4429END-IFFAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 4ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE9315       END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO9319           BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334 "." BY " ","-" BY " ","," BY " ",9335   "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336      "Y" BY "G","H" BY "G","I" BY "G"9337         PERFORM VARYING I-VALNOM FROM 1 BY 19338                  UNTIL I-VALNOM >= 669339    IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341      MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342              END-IF9343       END-PERFORM9344ELSE9345         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346           " S.A. " BY "      ",     RMB0002      9347           "." BY " ", " LTDA " BY "",RMB0002      9348           " LIMITADA " BY "          ",RMB0002      9349           " CIA " BY "     ", " COMPA/IA " BY "          ",RMB0002      9350           " INVERSIONES " BY "             ",RMB0002      9351           " EMPRESA " BY "         ", RMB0002      9352           " CORPORACION " BY "      ",RMB0002      9353      " DE " BY "    ", " LA " BY "", " DEL " BY "",RMB0002      9354    " S " BY "   ", " A " BY "   "RMB0002      9355  " Y " BY "   "          GJC0003      9356  INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357  " S.A. " BY "      ",RMB0002      9358    "." BY " ", " LTDA " BY "",RMB0002      9359  " LIMITADA " BY "    ",RMB0002      9360    " CIA " BY "", " COMPA/IA " BY "",RMB0002    Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE

4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-INPUT-VALNOM.   71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE

4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                          9374UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9375BASURA-VALNOM9376VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)9377VM-OK-VALNOM(4) VM-OK-VALNOM(5)9378VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)9379VM-OK-VALNOM(9) VM-OK-VALNOM(10)9380VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)9381VM-OK-VALNOM(14) VM-OK-VALNOM(15)9382VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)9383VM-OK-VALNOM(19) VM-OK-VALNOM(20).9384***********HACE LA VALIDACION BLOQUE A BLOQUE********************9385MOVE 1 TO I-VALNOM.9386MOVE 0 TO BLOQOK-AUX-VALNOM.9387PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   MOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"display "4222-VALIDA-NOMBRE-COINCIDE"5657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69 not invalid key70move 0 to SW-BDIIALE71read BDIIALE next record72at end73    move 1 to SW-BDIIALE74    end-read75end-start7677     perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79     or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80         if FUENTE-BDIIALE = 99000381         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82     and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83    and BLOQUEO-BDIIALE = 084     encontrado85     move 1 to SW-BDIIALE86    end-if87 if SW-BDIIALE = 088    read BDIIALE next record at end89       move 1 to SW-BDIIALE90end-read91end-if92     end-perform.9394     if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97     else98        if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOS


      


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 13else37             perform 4222-VALIDA-NOMBRE-COINCIDE38     end-if39     end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"44******************************************************************45* Validación de IDs que figuran OK pero el nombre no coincide46******************************************************************47*nombre no coincide4IF TIP-IDE-BDIIVIDE = 149*    es una cédula5MOVE 02 TO CODIGO-ERROR5ELSE52*no es una cédula5MOVE 01 TO CODIGO-ERROR5END-IF.555657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE6initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE6move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE6move 990003 to FUENTE-BDIIALE6start BDIIALE key not < LLAVE-BDIIALE INVALID KEY6move 1 TO SW-BDIIALE6not invalid key7move 0 to SW-BDIIALE7read BDIIALE next record7    at end7move 1 to SW-BDIIALE7    end-read7end-start767perform until SW-BDIIALE = 17or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE7or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE48if FUENTE-BDIIALE = 99000348and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASZoom   Ctrl+C to stop4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE

4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA
   
   
      
   4300-MODIFICAR-BDIIALE300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
   
   
      
   4300-MODIFICAR-BDIIALE-DATOS-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS
   
   
      
   4333-LEER-BDIIALE-RANDOM33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 200890107487999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM
   
   
      
   4300-MODIFICAR-BDIIALE-I00-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001

Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I   
   
      
   
Insercion de alerta nueva que ya existe    
   
      
   
key:    
   
      
   
300611000446999999000J001Insercion de alerta nueva que ya existe  key: 200890107487999999000J001
Registro de input:

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001   
   
      
   
Registro de input: Registro de input:
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106

Datos en la alerta: 0003400045202012044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406130106
Datos en la alerta: 000340004520201204

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406
   
      
   
   Datos en la alerta: 
   
      
   
   000340000220199901Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 000340000220199901
   
      
   
   4320-ARMAR-TEXTO-ALERTA4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA
   
      
   
   4333-REGRABAR-BDIIALE33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE
   
      
   
   4300-MODIFICAR-BDIIALE-DATOS00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS
   
      
   
   4333-LEER-BDIIALE-RANDOM33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 200890107487999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM
   
      
   
   4300-MODIFICAR-BDIIALE-I00-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002

Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I   
      
   
   
Insercion de alerta nueva que ya existe    
      
   
   
key:    
      
   
   
300611000446999999000J002Insercion de alerta nueva que ya existe  key: 200890107487999999000J002
Registro de input:

I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002   
      
   
   
Registro de input: Registro de input:
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620   130106

Datos en la alerta: 0000300006202013014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406130106
Datos en la alerta: 000030000620201301

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406
      
   
   
   Datos en la alerta: 
      
   
   
   000050006720201304Datos en la alerta: 000030000620201301
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 000050006720201304
      
   
   
   4320-ARMAR-TEXTO-ALERTA4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA
      
   
   
   4333-REGRABAR-BDIIALE33-REGRABAR-BDIIALE
000-PROCESAR-REGISTRO



I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE


      
   
   
   4000-PROCESAR-REGISTRO000-PROCESAR-REGISTRO


I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

      
   
   
   

I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO
      
   
   
   
I300600003115xxxxxx0150542014010600400320   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTROI300600003115xxxxxx0150542014010600400320   120406

4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406120406
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406  33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.3334333533363337 4100-VALIDACION-FORMAL.3338Ddisplay "4100-VALIDACION-FORMAL"3339******************************************************************3340* Validacion formal de los datos del input3341******************************************************************3342*Tipo de identificacion Numero {1, 2, 3, 4}3343if JURAD-id-tipo not = "1" and "2" and "3" and "4"3344call "PONERR" using "02" JURAD-reg E-errores3345move 05 to codigo-error3346end-if3347*Numero de identificacion3348if JURAD-id-numeroX is not numeric3349call "PONERR" using "03" JURAD-reg E-errores3350end-if3351if JURAD-id-numero not > 03352call "PONERR" using "04" JURAD-reg E-errores3353end-if3354*si el movimiento es una eliminacion los datos subsiguientes3355*no se controlan3356if JURAD-tipo-novedad = "E"3357exit paragraph3358end-if3359*Nombres y Apellidos3360if JURAD-nombre = spaces3361call "PONERR" using "05" JURAD-reg E-errores3362end-if3363*Numero de demandas vigentes3364if JURAD-demandas-vigentes is not numeric3365call "PONERR" using "06" JURAD-reg E-errores3366end-if3367*Numero de demandas terminadas3368if JURAD-demandas-terminadas is not numeric3369call "PONERR" using "07" JURAD-reg E-errores3370end-if3371*Fecha ultima demanda vigente YYMMDD3372if JURAD-demandas-fecha-ultima is not numeric3373call "PONERR" using "08" JURAD-reg E-errores3374end-if3375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopperform 4300-MODIFICAR-BDIIALE288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296 move "NO" to E-hay-error297298*    validacion del tipo de movimiento299     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00     call "PONERR" using "01" JURAD-reg E-errores01end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05     move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07exit paragraph080910add 1 to N-reg-leidos1112validacion formal de los datos13 move 0 to codigo-error14perform 4100-VALIDACION-FORMAL15if E-hay-error = "SI"16    perform 4900-GRABAR-ERROR17    perform 4240-CONTAR-TIPO-CUENTA18    exit paragraph19end-if2021si la validacion formal dio OK se hace validacion semantica22perform 4200-VALIDACION-SEMANTICA                                       23if E-hay-error = "SI"24    perform 4900-GRABAR-ERROR25     perform 4240-CONTAR-TIPO-CUENTA26    exit paragraph27end-if2829 perform 4240-CONTAR-TIPO-CUENTA3031*intento de actualizacion de BDIIALE32perform 4300-MODIFICAR-BDIIALE33add 1 to N-reg-OK.Break-point encountered    display "4000-PROCESAR-REGISTRO-2"   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   120406
4000-PROCESAR-REGISTRO-2

4100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406   
   
   
   
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop120406
4000-PROCESAR-REGISTRO-2

4100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406   
   
   
   
   4000-PROCESAR-REGISTRO-24000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL2SEMANTICA
I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2   
   
   
   
   4100-VALIDACION-FORMAL100-VALIDACION-FORMAL
2SEMANTICA


I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   perform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA


I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL

   
   
   
   
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads Moreperform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"     3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441Zoom   Ctrl+C to stop4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA


I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL

   
   
   
   
   4200-VALIDACION-SEMANTICA2SEMANTICA

I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop4200-VALIDACION-SEMANTICA

I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85030-UBICA-EXTPERFORM 85030-UBICA-EXT617*Ubica cedula de extranjeria en archivo del DAS618=============================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622END-READ623IF SW-ID-BDIIVIDE = 0624 MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"    RMB0013      4628$IF HACERMATCH = "SI"RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE             RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                   RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*    2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*    2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                            REGISTRO DIRECC .639*    2017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640*                         ORDENAN DE ACUERDO A LO DEFINIDO641*2017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642*                      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                          DE ESTANDARIZACION DE NOMBRES DE645*    COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                     A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  *          PROBABLE AUMENTANDO UN PESO CON BASE A LA651* R.MARTINEZ   *          CONFORMACION DE LA DIRECCION O DEL TELEFONO652*******************************************************************653* RMB0003 * DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOS654* MAR-15-2003  * PERMISOS DE ACCESO A LA BASE DE DATOS DE655* R.MARTINEZ   *DIRECCIONES656*******************************************************************657* RMB0004  * VEC001 - SE CORRIGE PROBLEMA EN EL VECTOR DE TELE658* ABR-15-2003  *          FONOS YA QUE USABA LA FECHA DE DIRECCIONES659* R.MARTINEZ   *          Y NO LA V-FECHATEL660*******************************************************************661* RMB0005      * UBI001 - SE CORRIGE PROBLEMA DE REFLEGAR EN EL662* ABR-15-2003  * INFORME LA MISMA DIRECCION COMO R,L,C DIF-MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEYREAD BDIIDAS INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.MOVE NQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsNOMBRE-BDIIDAS<W-S>SKAFF DE KARAAN MARWA MIKHAEL                :   NOMBRE-BDIIDAS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.DIR.PROC.v.0028AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409     MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410  MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411     IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416     MOVE 2 TO BLOQUES-INPUT-VALNOM417                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418    END-IF419             END-IF420             PERFORM 10000-MATCH-NOMBRES-VALNOM421             IF MATCH-OK-OUT-VALNOM = 0422            MOVE 1 TO SW-NOMBRES-BDIIVIDE423         END-IF424 END-IF425   END-IF426 ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002      4427          MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428 END-IF                                   FAC0002      4429  END-IF                                                      FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441     EVALUATE TIP-IDE-BDIIVIDE442       WHEN 1443         PERFORM 85010-UBICA-CEDULA444       WHEN 2445         PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4INITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEZoom   Ctrl+C to stop4200-VALIDACION-SEMANTICA

I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOM4421IF MATCH-OK-OUT-VALNOM = 04422MOVE 1 TO SW-NOMBRES-BDIIVIDE4423END-IF4424END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IFFAC0002      4429END-IFFAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 4ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE9315       END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO9319           BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334 "." BY " ","-" BY " ","," BY " ",9335   "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336      "Y" BY "G","H" BY "G","I" BY "G"9337         PERFORM VARYING I-VALNOM FROM 1 BY 19338                  UNTIL I-VALNOM >= 669339    IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341      MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342              END-IF9343       END-PERFORM9344ELSE9345         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346           " S.A. " BY "      ",     RMB0002      9347           "." BY " ", " LTDA " BY "",RMB0002      9348           " LIMITADA " BY "          ",RMB0002      9349           " CIA " BY "     ", " COMPA/IA " BY "          ",RMB0002      9350           " INVERSIONES " BY "             ",RMB0002      9351           " EMPRESA " BY "         ", RMB0002      9352           " CORPORACION " BY "      ",RMB0002      9353      " DE " BY "    ", " LA " BY "", " DEL " BY "",RMB0002      9354    " S " BY "   ", " A " BY "   "RMB0002      9355  " Y " BY "   "          GJC0003      9356  INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357  " S.A. " BY "      ",RMB0002      9358    "." BY " ", " LTDA " BY "",RMB0002      9359  " LIMITADA " BY "    ",RMB0002      9360    " CIA " BY "", " COMPA/IA " BY "",RMB0002    Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4200-VALIDACION-SEMANTICA

I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-INPUT-VALNOM.   71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4200-VALIDACION-SEMANTICA

I300600003115xxxxxx0150542014010600400320   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: FERNANDEZ PENA JULIO ANTONIO4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   1304064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J001Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                          9374UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9375BASURA-VALNOM9376VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)9377VM-OK-VALNOM(4) VM-OK-VALNOM(5)9378VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)9379VM-OK-VALNOM(9) VM-OK-VALNOM(10)9380VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)9381VM-OK-VALNOM(14) VM-OK-VALNOM(15)9382VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)9383VM-OK-VALNOM(19) VM-OK-VALNOM(20).9384***********HACE LA VALIDACION BLOQUE A BLOQUE********************9385MOVE 1 TO I-VALNOM.9386MOVE 0 TO BLOQOK-AUX-VALNOM.9387PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   MOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"display "4222-VALIDA-NOMBRE-COINCIDE"5657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69 not invalid key70move 0 to SW-BDIIALE71read BDIIALE next record72at end73    move 1 to SW-BDIIALE74    end-read75end-start7677     perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79     or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80         if FUENTE-BDIIALE = 99000381         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82     and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83    and BLOQUEO-BDIIALE = 084     encontrado85     move 1 to SW-BDIIALE86    end-if87 if SW-BDIIALE = 088    read BDIIALE next record at end89       move 1 to SW-BDIIALE90end-read91end-if92     end-perform.9394     if TIP-IDE-BDIIVIDE = 195         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196             move 07 to CODIGO-ERROR97     else98        if ESTADO-VIG-BDIIREGI = 2199            move 06 to CODIGO-ERROR500            add 1 to NO-COINCIDE-REGIS501            add 1 to CONT-FALLECIDOS


      


      


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0
Reset-execution      Cursor-position Next Start Quit-performif SW-BDIIALE = 0read BDIIALE next record at endAnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Reset-execution      Cursor-position Next Start Quit-performread BDIIALE next record at endinitialize LLAVE-BDIIALEAnimateCARGAJUR.gnt/.o/.exe      Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   initialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressjurad-reg.                                                                   r

e

g

-

b

d

i

i

a

l

e







if SW-BDIIALE = 0    read BDIIALE next record at end        move 1 to SW-BDIIALE    end-readREG-BDIIALE<W-S>400000163597990003001        2014052220140920201405220                            EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO                                                            :   REG-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    if SW-BDIIALE = 0     read BDIIALE next record at end         move 1 to SW-BDIIALE     end-read end-if-perform.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressreg-bdiiale.                                                                 if SW-BDIIALE = 0    read BDIIALE next record at end        move 1 to SW-BDIIALE    end-readREG-BDIIALE<W-S>400000163597999999000J001    2014010120640101201401010          000120003220201004                                                                                                    :   REG-BDIIALE<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    if SW-BDIIALE = 0     read BDIIALE next record at end         move 1 to SW-BDIIALE     end-read end-if-perform.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 13else37             perform 4222-VALIDA-NOMBRE-COINCIDE38     end-if39     end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"44******************************************************************45* Validación de IDs que figuran OK pero el nombre no coincide46******************************************************************47*nombre no coincide4IF TIP-IDE-BDIIVIDE = 149*    es una cédula5MOVE 02 TO CODIGO-ERROR5ELSE52*no es una cédula5MOVE 01 TO CODIGO-ERROR5END-IF.555657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE6initialize LLAVE-BDIIALE64 move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE6move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE6move 990003 to FUENTE-BDIIALE6start BDIIALE key not < LLAVE-BDIIALE INVALID KEY6move 1 TO SW-BDIIALE6not invalid key7move 0 to SW-BDIIALE7read BDIIALE next record7    at end7move 1 to SW-BDIIALE7    end-read7end-start767perform until SW-BDIIALE = 17or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE7or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE48if FUENTE-BDIIALE = 99000348and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3END-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASPerform-level      Exit View

      

      

      

      

      

      perform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001

Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE   
   
   
   
   4000-PROCESAR-REGISTROInsercion de alerta nueva que ya existe  key: 300611000446999999000J001
Registro de input:

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
   
   
   
   Registro de input:
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   
   
   
   
   I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406

Datos en la alerta: 0003400002201999014320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO130406
Datos en la alerta: 000340000220199901

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Datos en la alerta: 000340000220199901
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   110106  33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.3334333533363337 4100-VALIDACION-FORMAL.3338Ddisplay "4100-VALIDACION-FORMAL"3339******************************************************************3340* Validacion formal de los datos del input3341******************************************************************3342*Tipo de identificacion Numero {1, 2, 3, 4}3343if JURAD-id-tipo not = "1" and "2" and "3" and "4"3344call "PONERR" using "02" JURAD-reg E-errores3345move 05 to codigo-error3346end-if3347*Numero de identificacion3348if JURAD-id-numeroX is not numeric3349call "PONERR" using "03" JURAD-reg E-errores3350end-if3351if JURAD-id-numero not > 03352call "PONERR" using "04" JURAD-reg E-errores3353end-if3354*si el movimiento es una eliminacion los datos subsiguientes3355*no se controlan3356if JURAD-tipo-novedad = "E"3357exit paragraph3358end-if3359*Nombres y Apellidos3360if JURAD-nombre = spaces3361call "PONERR" using "05" JURAD-reg E-errores3362end-if3363*Numero de demandas vigentes3364if JURAD-demandas-vigentes is not numeric3365call "PONERR" using "06" JURAD-reg E-errores3366end-if3367*Numero de demandas terminadas3368if JURAD-demandas-terminadas is not numeric3369call "PONERR" using "07" JURAD-reg E-errores3370end-if3371*Fecha ultima demanda vigente YYMMDD3372if JURAD-demandas-fecha-ultima is not numeric3373call "PONERR" using "08" JURAD-reg E-errores3374end-if3375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopadd 1 to N-reg-OK.288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296 move "NO" to E-hay-error297298*    validacion del tipo de movimiento299     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00     call "PONERR" using "01" JURAD-reg E-errores01end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05     move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07exit paragraph080910add 1 to N-reg-leidos1112validacion formal de los datos13 move 0 to codigo-error14perform 4100-VALIDACION-FORMAL15if E-hay-error = "SI"16    perform 4900-GRABAR-ERROR17    perform 4240-CONTAR-TIPO-CUENTA18    exit paragraph19end-if2021si la validacion formal dio OK se hace validacion semantica22perform 4200-VALIDACION-SEMANTICA                                       23if E-hay-error = "SI"24    perform 4900-GRABAR-ERROR25     perform 4240-CONTAR-TIPO-CUENTA26    exit paragraph27end-if2829 perform 4240-CONTAR-TIPO-CUENTA3031*intento de actualizacion de BDIIALE32perform 4300-MODIFICAR-BDIIALE33add 1 to N-reg-OK.Break-point encountered    display "4000-PROCESAR-REGISTRO-2"   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More                                       display "4000-PROCESAR-REGISTRO-2"   move "NO" to E-hay-errorZoom   Ctrl+C to stop4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE

4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2
   
   
   
   
   4100-VALIDACION-FORMAL33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
   
   
   
   
   00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 300611000446999999000J002Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   11010600-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002

Registro de input:I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106   
   
   
   
      Error    
   
   
   
      
11   
   
   
   
          
   
   
   
      Numero de embargos terminados: debe ser numericoInsercion de alerta nueva que ya existe  key: 300611000446999999000J002
Registro de input:

I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico   
   
   
   
      4900-GRABAR-ERRORRegistro de input:
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR   
   
   
   
      4000-PROCESAR-REGISTROI300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720   130406

Datos en la alerta: 0000500067202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO   
   
   
   
      130406
Datos en la alerta: 000050006720201304

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO
   
   
   
      Datos en la alerta: 000050006720201304
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   13011133-REGRABAR-BDIIALE
000-PROCESAR-REGISTRO



I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove "NO" to E-hay-errordisplay "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO



I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111


   
   
   
      
     32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads MoreZoom   Ctrl+C to stop4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO



I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111


   
   
   
      
   4000-PROCESAR-REGISTRO-2000-PROCESAR-REGISTRO


I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2

   
   
   
      
   4100-VALIDACION-FORMAL

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  32883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO-2"   perform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398200-VALIDACION-SEMANTICA"     3399400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403     move JURAD-id-tipo to TIP-IDE-BDIIVIDE404JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411 move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423SW-ID-BDIIVIDE = 1424*es un id inválido425 call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429    existe id, a ver si el nombre coincide430    if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432    display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*    validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437        perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439 end-if.440441Zoom   Ctrl+C to stop

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
   
   
   
      
   4200-VALIDACION-SEMANTICA
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85030-UBICA-EXTPERFORM 85030-UBICA-EXT617*Ubica cedula de extranjeria en archivo del DAS618=============================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622END-READ623IF SW-ID-BDIIVIDE = 0624 MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"    RMB0013      4628$IF HACERMATCH = "SI"RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE             RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                   RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*    2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*    2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                            REGISTRO DIRECC .639*    2017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640*                         ORDENAN DE ACUERDO A LO DEFINIDO641*2017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642*                      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                          DE ESTANDARIZACION DE NOMBRES DE645*    COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                     A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  *          PROBABLE AUMENTANDO UN PESO CON BASE A LA651* R.MARTINEZ   *          CONFORMACION DE LA DIRECCION O DEL TELEFONO652*******************************************************************653* RMB0003 * DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOS654* MAR-15-2003  * PERMISOS DE ACCESO A LA BASE DE DATOS DE655* R.MARTINEZ   *DIRECCIONES656*******************************************************************657* RMB0004  * VEC001 - SE CORRIGE PROBLEMA EN EL VECTOR DE TELE658* ABR-15-2003  *          FONOS YA QUE USABA LA FECHA DE DIRECCIONES659* R.MARTINEZ   *          Y NO LA V-FECHATEL660*******************************************************************661* RMB0005      * UBI001 - SE CORRIGE PROBLEMA DE REFLEGAR EN EL662* ABR-15-2003  * INFORME LA MISMA DIRECCION COMO R,L,C DIF-MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEYREAD BDIIDAS INVALID KEYMOVE 1 TO SW-ID-BDIIVIDEMOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409     MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410  MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411     IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416     MOVE 2 TO BLOQUES-INPUT-VALNOM417                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418    END-IF419             END-IF420             PERFORM 10000-MATCH-NOMBRES-VALNOM421             IF MATCH-OK-OUT-VALNOM = 0422            MOVE 1 TO SW-NOMBRES-BDIIVIDE423         END-IF424 END-IF425   END-IF426 ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002      4427          MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428 END-IF                                   FAC0002      4429  END-IF                                                      FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441     EVALUATE TIP-IDE-BDIIVIDE442       WHEN 1443         PERFORM 85010-UBICA-CEDULA444       WHEN 2445         PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4Zoom   Ctrl+C to stop
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   1104064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA   
   
   
      
   I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406

4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA110406
4000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2
100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111
   
   
      
      Error 
   
   
      
      
14
   
   
      
       
   
   
      
      El numero de id no se encuentra en el archivo maestro100-VALIDACION-FORMAL
2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro
   
   
      
      4210-VALIDACION-ID-NO-FIGURA2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA
   
   
      
      513-VALIDA-EN-CSV22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J001Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0001200032202010044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSV  4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOM4421IF MATCH-OK-OUT-VALNOM = 04422MOVE 1 TO SW-NOMBRES-BDIIVIDE4423END-IF4424END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IFFAC0002      4429END-IFFAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 4ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE NOM-VAL-BDIIVIDE228 513-VALIDA-EN-CSV.229Ddisplay "513-VALIDA-EN-CSV"     4230Ddisplay "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E231**************************************************************232* Valida si la identificación está en la base de datos alterna233**************************************************************234*hace validacion de tipo de identificacion235MOVE TIPOID-E TO TIP-IDE-BDIIVIDE236MOVE NUMID-E TO NUM-IDE-BDIIVIDE237*retorna SW-TID-BDIIVIDE=0 si el num id no está dentro238*del rango que corresponde al tipo de id239display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE240" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE241" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE242PERFORM 80400-VALIDAR-TIPO-ID243display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE244" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE245" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE246IF SW-TID-BDIIVIDE = 0247*el tipo de id es OK248Ddisplay "el n° de ID está dentro de su rango"249IF HACER-MATCH = ZEROS250*      abre archivos y carga la tabla de direcciones251*       estandar, solo la primera vez252IF OPEN-DIR = ZEROS253D      display "carga tabla DIRESTAN"254      OPEN INPUT MAESTRO-DIRECC255             OPEN INPUT BDLCLI256       OPEN INPUT SUSCRIPTOR257OPEN INPUT MAESTRO-CREDIT258                 OPEN INPUT MAESTRO-CHECK259                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN260                 MOVE 1 TO OPEN-DIR261             END-IF262*            abre archivos y carga la tabla de direcciones263             MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH264             MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH265*            Se recorre toda la estructura bdacsv para la identificacion       4266*        buscada. En caso de hallar registros se procede a realizar el     4267*      match268D    display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH269D      " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH270D    " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH271D      " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH272    PERFORM 1000-U-RECORRER-CSV-BDAMATCH273D      display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHBreak-point encountered display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-Edisplay "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-EAnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More      


        
         


        
         


        
      display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-EMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE   


        
         


        
         


        
      display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-ID492*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002      4493*================================================================494    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE            FAC0002      4495    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"         FAC0002      4496    EVALUATE TIP-IDE-BDIIVIDE                                 FAC0002      4497      WHEN 1                                                  FAC0002      4498   IF NUM-IDE-BDIIVIDE-R > 9999999999     FAC0002      4499     MOVE 1 TO SW-TID-BDIIVIDE   FAC0002      4500  END-IF                        FAC0002      4501  WHEN 2                                              FAC0002      4502   IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006C      4503     (NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005      4504     MOVE 1 TOTID-BDIIVIDE    FAC0002      4505  END-IF                                               FAC0002      4506 WHEN 3                      FAC0002      4507  IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000 FAC0005      4508     MOVE 1 TOTID-BDIIVIDE    FAC0002      4509  END-IF                                               FAC0002      4510END-EVALUATE.          FAC0002      4511512 80500-ELIMINAR-DIGITO-CHEQUEO.                       FAC0004      4513*================================================================514*80500-ELIMINAR-DIGITO-CHEQUEO.                           FAC0004      4515*Elimina el digito de chequeo y cambia el tipo de identificacion516*de acuerdo a los rangos para tipo id = 2 y 3517*================================================================518IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004      4519NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005      4520(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004      4521NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005      4522MOVE 3 TO TIP-IDE-BDIIVIDE     FAC0004      4523END-IF                                     FAC0004      4524IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004      4525NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005      4526 (NUM-IDE-BDIIVIDE-R >= 8000000000 AND            FAC0004      4527NUM-IDE-BDIIVIDE-R  <= 9999999999)         FAC0005      4528MOVE 2 TO TIP-IDE-BDIIVIDE                FAC0004      4529 END-IF                                                      FAC0004      4530 IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004      4531 (NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004      4532 (NUM-IDE-BDIIVIDE-R >= 8000000000 AND              FAC0004      4533 NUM-IDE-BDIIVIDE-R <= 9999999999)) OR                   FAC0005      4534 (TIP-IDE-BDIIVIDE = 3 AND                       FAC0004      4535 (NUM-IDE-BDIIVIDE-R >= 6000000000 AND   FAC0004      4536NUM-IDE-BDIIVIDE-R <  8000000000))     FAC0005      4537 MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDE      FAC0004    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002    EVALUATE TIP-IDE-BDIIVIDEFAC0002    EVALUATE TIP-IDE-BDIIVIDEFAC0002    END-EVALUATE.FAC0002    END-EVALUATE.FAC0002    241     " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE242     PERFORM 80400-VALIDAR-TIPO-ID243 display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE244 " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE245 " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE246IF SW-TID-BDIIVIDE = 0247*  el tipo de id es OK248Ddisplay "el n° de ID está dentro de su rango"249  IF HACER-MATCH = ZEROS250*       abre archivos y carga la tabla de direcciones251*      estandar, solo la primera vez252   IF OPEN-DIR = ZEROS253D       display "carga tabla DIRESTAN"254      OPEN INPUT MAESTRO-DIRECC255      OPEN INPUT BDLCLI256          OPEN INPUT SUSCRIPTOR257       OPEN INPUT MAESTRO-CREDIT258      OPEN INPUT MAESTRO-CHECK259             PERFORM 06000-U-CARGAR-TABLA-DIRESTAN260MOVE 1 TO OPEN-DIR261             END-IF262*            abre archivos y carga la tabla de direcciones263             MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH264             MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH265*            Se recorre toda la estructura bdacsv para la identificacion       4266*            buscada. En caso de hallar registros se procede a realizar el     4267*       match268D    display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH269D    " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH270D   " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH271D   " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH272       PERFORM 1000-U-RECORRER-CSV-BDAMATCH273D       display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH274D    " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH275D    " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH276D    " MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH277   MOVE 1 TO HACERMATCH-LEEMSTRS278       IF IDE-TIPO-BDAMATCH = 1279           IF TIPOID-E = 1 OR 4280            INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL281            "," BY " ", ";" BY " "282       END-IF283        MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM284        MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM285       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM286       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
        

      
        

      
        

      display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0display "el n° de ID está dentro de su rango"
        

      
        

      
        

      display "el n° de ID está dentro de su rango"IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROSIF OPEN-DIR = ZEROSMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHdisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
        

      
        

      
        

      display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH6963* MATCH6964******************************************************************6965MOVE 0 TO IDE-TIPO-BDAMATCH6966MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003      6967MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                   RMB0003      6968MOVE 0 TO MAX-CUENTAS-BDAMATCH.6969 IF ABIERTO-BDAMATCH  = 06970 OPEN INPUT  BDACSV6971MOVE 1 TO ABIERTO-BDAMATCH6972 END-IF.6973 INITIALIZE LLAVE-BDACSV.6974MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .6975 MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .6976MOVE 0 TO FIN-BDAMATCH .6977MOVE 0 TO PROCESAR-BDAMATCH .6978START BDACSV  KEY > LLAVE-BDACSV6979INVALID KEY6980MOVE 1 TO FIN-BDAMATCH6981NOT INVALID KEY6982READ BDACSV IGNORE LOCK NEXT RECORD6983    AT END6984        MOVE 1 TO FIN-BDAMATCH6985 END-READ6986END-START.6987 PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =6988                          NUM-IDE-INPUT-BDAMATCH  OR6989      TIPO-ID-BDACSV  NOT =6990                          TIP-IDE-INPUT6991 MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD026992 READ SUSCRIPTOR IGNORE LOCK6993 INVALID KEY6994 MOVE 0 TO PROCESAR-BDAMATCH6995 NOT INVALID KEY6996  MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004      6997 END-READ6998 IF PROCESAR-BDAMATCH = 1                 RMB0004      6999IF ESTADO-ABD02 = 1            RMB0004      7000 IF IND-BLOQUEO-BDACSV <> "B"RMB0004      7001MOVE 1 TO PROCESAR-BDAMATCHRMB0004      7002IF FUENTE-REG-BDACSV <= 01                   RMB0004      7003PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004      7004LSE  RMB0004      7005   PERFORM 1100-LLENAR-AUX-BDAMATCH RMB0004      7006END-IF                                           RMB0004      7007ELSE                                    RMB0004      70080 TO PROCESAR-BDAMATCH                      RMB0004    MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003    MOVE 0 TO MAX-CUENTAS-BDAMATCH.MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0IF ABIERTO-BDAMATCH  = 0INITIALIZE LLAVE-BDACSV.INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVSTART BDACSV  KEY > LLAVE-BDACSVREAD BDACSV IGNORE LOCK NEXT RECORDREAD BDACSV IGNORE LOCK NEXT RECORDEND-START.END-START.PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =7025        END-IFRMB0004      7026     END-PERFORM.7027IF MAX-CUENTAS-BDAMATCH > 07028   IF APELLIDO-INPUT-BDAMATCH <> SPACES AND4      7029      MAX-CUENTAS-BDAMATCH > 1      4      7030      PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004      7031      PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004      7032   PERFORM 1200-PROC-REG-CSV-BDAMATCHRMB0004      7033END-IF                    RMB0004      7034   PERFORM 9000-U-REALIZAR-BDAMATCH7035   IF NOM-OUTPUTMATCH <> SPACES ANDRMB0004      7036      (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)         RMB0004      7037      MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004      7038      PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004      7039      MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004      7040   END-IF                       RMB0004      7041IF NOM-OUTPUT-BDAMATCH <> SPACES7042MOVE 1 TO IDE-TIPO-BDAMATCH7043END-IF7044END-IF.7045 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004      7046MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQRMB0004      7047MOVE 0 TO I-MAQ  RMB0004      7048INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004      7049        INITIAL "Y/O"                                  RMB0004      7050OR"Y\O"                            RMB0004      7051OR" Y/OTRO "                     RMB0004      7052OR" Y/OTRA "                      RMB0004      7053     OR      " Y\OTRO "                 RMB0004      7054     OR      " Y\OTRA "    RMB0004      7055  OR      " Y OTRO "RMB0004      7056OR      " Y OTRA "          RMB0004      7057IF I-MAQ < 45 AND I-MAQ > 2RMB0004      7058ADD 1 TO I-MAQ                         7059MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004      7060ELSE                             7061IF I-MAQ < 45             62ADD 1 TO I-MAQ                     63MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)    64END-IF                                 65END-IF                                           66MOVE 0 TO SW-BORRAR-MAQ    67MOVE 1 TO I-MAQ.                                   68PERFORM UNTIL I-MAQ > 45    69MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ    70IF TILDE-MAQ                             IF MAX-CUENTAS-BDAMATCH > 06980      MOVE 1 TO FIN-BDAMATCH6981      NOT INVALID KEY6982         READ BDACSV IGNORE LOCK NEXT RECORD6983         AT END6984         MOVE 1 TO FIN-BDAMATCH6985   END-READ6986END-START.6987PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =6988      NUM-IDE-INPUT-BDAMATCH  OR6989                              TIPO-ID-BDACSV  NOT =6990                              TIP-IDE-INPUT-BDAMATCH6991MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD026992READ SUSCRIPTOR IGNORE LOCK6993INVALID KEY6994   MOVE 0 TO PROCESAR-BDAMATCH6995   NOT INVALID KEY6996      MOVE 1 TO PROCESAR-BDAMATCHRMB0004      6997END-READ6998IF PROCESAR-BDAMATCH = 1RMB0004      6999      IF ESTADO-ABD02 = 1RMB0004    00              IF IND-BLOQUEO-BDACSV <> "B"    01            MOVE 1 TO PROCESAR-BDAMATCH                     02            IF FUENTE-REG-BDACSV <= 01    03               PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCH        04    ELSE         05  PERFORM 1100-LLENAR-AUX-BDAMATCH    06    END-IF            07 ELSE                 08    MOVE 0 TO PROCESAR-BDAMATCH    09 END-IF               10ELSE              11 MOVE 0 TO PROCESAR-BDAMATCH    12      END-IF                   13END-IF            14IF PROCESAR-BDAMATCH = 115      PERFORM 1200-PROC-REG-CSV-BDAMATCH16END-IF17READ BDACSV IGNORE LOCK   NEXT RECORD18AT END19   MOVE 1 TO FIN-BDAMATCH20   END-READ21   IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    22      MOVE 1 TO FIN-BDAMATCH*> SE ABLIGA A TIP    23      MOVE 0 TO MAX-CUENTAS-BDAMATCH*> EFICIENCIA Y    24    MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA    25 END-IF         4271D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4272  PERFORM 1000-U-RECORRER-CSV-BDAMATCH4273Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH4274D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH4275D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH4276D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH4277        MOVE 1 TO HACERMATCH-LEEMSTRS4278        IF IDE-TIPO-BDAMATCH = 14279IF TIPOID-E = 1 OR 44280INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL4281"," BY " ", ";" BY " "4282         END-IF4283         MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM4284      MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM4285   MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM4286      MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4287   PERFORM 10000-MATCH-NOMBRES-VALNOM4288D         display "10000-MATCH-NOMBRES-VALNOM"4289D        display "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM4290D      " " NOM-OUTPUT-BDAMATCH4291   IF MATCH-OK-OUT-VALNOM = 14292    MOVE 1 TO IDE-TIPO-BDAMATCH4293ELSE4294IF W-BLOQUES > 04295       MOVE 0 TO IDE-TIPO-BDAMATCH4296END-IF42974298END-IF42994300IF IDE-TIPO-BDAMATCH = 14301      MOVE TIPOID-E TO TIP-VAL4302   MOVE NUMID-E TO CED-VAL4303      MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA4304         PERFORM 9800-FILTRAR-ALFABETICO4305         MOVE CADENA-SALE TO  NOM-VAL4306      MOVE ZEROS TO FEC-EXP-VAL4307         MOVE SPACES TO MUN-EXP-VAL4308         MOVE SPACES TO DEP-EXP-VAL4309         MOVE SPACES TO VIG-VAL4310      MOVE SPACES TO GENERO-VAL4311         MOVE SPACES TO EDAD-VAL4312         MOVE SPACES TO EDAD-RANGO4313      ADD 1 TO SI-EXISTE-CSV4314  END-IF4315END-IF4316END-IF.


      


      


      display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSMOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1END-IFEND-IFEND-IF.END-IF.3548*valida si la identificación está en la base de datos alterna3549PERFORM 513-VALIDA-EN-CSV3550 IF IDE-TIPO-BDAMATCH = 03551 IF TIP-IDE-BDIIVIDE = 13552*es una cédula3553 MOVE 04 TO CODIGO-ERROR3554else3555*no es una cédula3556MOVE 03 TO CODIGO-ERROR3557END-IF3558END-IF.355935603561 4300-MODIFICAR-BDIIALE.3562Ddisplay "4300-MODIFICAR-BDIIALE"3563******************************************************************3564* Se impacta el archivo BDIIALE con una o dos inserciones,3565* modificaciones o eliminaciones segun haya o no demandas y3566* embargos3567******************************************************************3568initialize REG-BDIIALE35693570*si hay demandas3571if JURAD-demandas-vigentes > zero3572or JURAD-demandas-terminadas > zero3573move "J001" to LLASEC-BDIIALE3574*arma datos de demandas3575move JURAD-demandas-vigentes to D-vigentes3576move JURAD-demandas-terminadas to D-terminados3577string "20" JURAD-demandas-fecha-ultima3578delimited size into D-fecha-ultima3579perform 4300-MODIFICAR-BDIIALE-DATOS3580end-if.35813582*si hay embargos3583if JURAD-embargos-vigentes > zero3584or JURAD-embargos-terminados > zero3585move "J002" to LLASEC-BDIIALE3586*arma datos de embargos3587move JURAD-embargos-vigentes to D-vigentes3588move JURAD-embargos-terminados to D-terminados3589string "20" JURAD-embargos-fecha-ultimo3590delimited size into D-fecha-ultima3591perform 4300-MODIFICAR-BDIIALE-DATOS3592end-if.3593IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1MOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROREND-IFEND-IFEND-IF.Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressreg-bdiiale.                                                            j

u

r

a

d

-

r

e

g

 

 

 

END-IF.
-MODIFICAR-BDIIALE.JURAD-REG<W-S>I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111:   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    END-IF.
0-MODIFICAR-BDIIALE.AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   END-IF.321si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325 perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347Numero de identificacion348if JURAD-id-numeroX is not numeric349call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356tipo-novedad = "E"357    exit paragraph358end-if359Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR861862 4900-GRABAR-ERROR.863Ddisplay "4900-GRABAR-ERROR"864******************************************************************865* El registro de JURAD tiene error: se graba en el archivo ERRS866* con indicacion del error detectado867******************************************************************86move JURAD-reg to ERRS-reg86move E-errores-reg to ERRS-causa-rechazo870*lista de los codigos de los errores del registro871 move E-errores-reg to ERRS-causa-rechazo87write ERRS-reg87evaluate ERRS-fs87when "00"87continue87when other877             display "Error al grabar el archivo de errores "878         display "Nombre del archivo: " ERRS-file-name879             display "File status: " ERRS-fs880             perform 9000-CANCELAR-PROGRAMA881             goback882 end-evaluate.883884885 4320-ARMAR-TEXTO-ALERTA.886Ddisplay "4320-ARMAR-TEXTO-ALERTA"887****************************************************************888* Hace el reemplazo de los valores adecuados en los templates889* de las linea de alerta que corresponde890****************************************************************891*segun se trate de demandas o embargos89if JURAD-demandas-vigentes not = 089or JURAD-demandas-terminadas not = 0894     set LAx to 1895     move high-values to LA-valores89    move JURAD-demandas-vigentes to LA-num897* >>>> esto esta anulado x que no se como hacer para que lo compile898*    unstring LA-numX into LA-descarte LA-valor(1)89    delimited by all space90    move LA-numx(9:12) to LA-valor(1)90move JURAD-demandas-terminadas to LA-num902* >>>> esto esta anulado x que no se como hacer para que lo compile90    unstring LA-numX into LA-descarte LA-valor(2)904*    delimited by all space90move LA-numx(9:12) to LA-valor(2)906
      
      
      display "4900-GRABAR-ERROR"move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fscontinuecontinueend-evaluate.end-evaluate.323if E-hay-error = "SI"324         perform 4900-GRABAR-ERROR325     perform 4240-CONTAR-TIPO-CUENTA326         exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345move 05 to codigo-error346end-if347*    Numero de identificacion348 if JURAD-id-numeroX is not numeric349         call "PONERR" using "03" JURAD-reg E-errores350     end-if351     if JURAD-id-numero not > 0352         call "PONERR" using "04" JURAD-reg E-errores353 end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361 call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364     if JURAD-demandas-vigentes is not numeric365 call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numericperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide51402=cédula OK, nombre no coincide515*03=NIT no figura516*04=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*    cuenta tipo 7: 03 04 05524525 IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526    ADD 1 TO W-CONT-TIPO-6527ELSE528IF CODIGO-ERROR = 03 OR 04 OR 05529        ADD 1 TO W-CONT-TIPO-7530     ELSE531*        registros correctos, repetidos o no532    ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534        IF TIPOID-E = 2 OR 3535        ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537     END-IF538 END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546 MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548*valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550 IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7END-IF.END-IF.324perform 4900-GRABAR-ERROR325         perform 4240-CONTAR-TIPO-CUENTA326     exit paragraph327     end-if328329 perform 4240-CONTAR-TIPO-CUENTA330331intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333 add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349 call "PONERR" using "03" JURAD-reg E-errores350end-if351 if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*    Nombres y Apellidos360 if JURAD-nombre = spaces361         call "PONERR" using "05" JURAD-reg E-errores362     end-if363*    Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365    call "PONERR" using "06" JURAD-reg E-errores366 end-if367*Numero de demandas terminadas368if JURAD-demandas-terminadas is not numeric369call "PONERR" using "07" JURAD-reg E-erroresexit paragraph264*controla el reg y lo aplica si es OK26000-PROCESAR-REGISTRO-226move JURAD-reg to JURAD-reg-anterior26    add 1 to REG-LEIDOS26when "10"269*    fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes27    de que se terminara el archivo27    display "Falta el reg de totales del archivo JURAD "27    display "Nombre del archivo: " P-file-name27display "File status: " JURAD-fs27display "Ultimo registro leido: " N-reg-leidos27display JURAD-reg-anterior277         perform 9000-CANCELAR-PROGRAMA278 when other279*        error de lectura: cancelacion del proceso280         display "Error en lectura del archivo JURAD "281         display "Nombre del archivo: " P-file-name282     display "File status: " JURAD-fs28    display "Ultimo registro leido: " N-reg-leidos28display JURAD-reg-anterior28perform 9000-CANCELAR-PROGRAMA28evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************29move "NO" to E-hay-error297298*validacion del tipo de movimiento299 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"0    call "PONERR" using "01" JURAD-reg E-errores0end-if020si es el registro "T" hay que señalar el fin de proceso0tipo-novedad = "T"0move "SI" to IND-fin-proceso0    perform 4800-PROCESO-REG-T07     exit paragraph0end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57lectura del proximo registro58read JURAD59evaluate JURAD-fs60when "00"61D "62D" "63Ddisplay JURAD-reg64*    controla el reg y lo aplica si es OK65 perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*de que se terminara el archivo72    display "Falta el reg de totales del archivo JURAD "73display "Nombre del archivo: " P-file-name74display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76     display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78     when other79*        error de lectura: cancelacion del proceso80         display "Error en lectura del archivo JURAD "81         display "Nombre del archivo: " P-file-name82    display "File status: " JURAD-fs83display "Ultimo registro leido: " N-reg-leidos84     display JURAD-reg-anterior85    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************Zoom   Ctrl+C to stop4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS

4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA
   
      
         0   04000-PROCESAR-REGISTRO00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO
   
      
         0   033-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-I

Insercion de alerta nueva que ya existe  key: 400000163597999999000J002Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO
   
      
         0   000-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002

Registro de input:I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTROInsercion de alerta nueva que ya existe  key: 400000163597999999000J002
Registro de input:

I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Registro de input:
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   130411  32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261Ddisplay " "3262Ddisplay " "3263Ddisplay JURAD-reg3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopdisplay "4000-PROCESAR-REGISTRO"display "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   

         

         

         display "4000-PROCESAR-REGISTRO-2"   94* La informacion esta leida en JURAD-reg95****************************************************************96 move "NO" to E-hay-error9798*    validacion del tip movimiento99     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"300         call "PONERR" using "01" JURAD-reg E-errores301 end-if302303*si es el registro "T" hay que señalar el fin de proceso304if JURAD-tipo-novedad = "T"305 move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313 move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323 if E-hay-error = "SI"324perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339**Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressjurad-reg.                                                                        "T"move "NO" to E-hay-errorvalidacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"JURAD-REG<W-S>I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411:   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    move "NO" to E-hay-error validacion del tipo de movimiento if JURAD-tipo-novedad not = "I" and "M" and "E" andAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stopI400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520   110406

Datos en la alerta: 0000600045202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2   
      
         0   0
   4100-VALIDACION-FORMAL110406
Datos en la alerta: 000060004520201104

4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if33093310add 1 to N-reg-leidos33113312*validacion formal de los datos3313move 0 to codigo-error3314perform 4100-VALIDACION-FORMAL3315if E-hay-error = "SI"3316perform 4900-GRABAR-ERROR3317*perform 4240-CONTAR-TIPO-CUENTA3318exit paragraph3319end-if33203321*si la validacion formal dio OK se hace validacion semantica3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"3324perform 4900-GRABAR-ERROR3325perform 4240-CONTAR-TIPO-CUENTA3326exit paragraph3327end-if33283329perform 4240-CONTAR-TIPO-CUENTA33303331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.3334333533363337 4100-VALIDACION-FORMAL.3338Ddisplay "4100-VALIDACION-FORMAL"3339******************************************************************ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove "NO" to E-hay-errorperform 4200-VALIDACION-SEMANTICA   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4200-VALIDACION-SEMANTICA   396397 4200-VALIDACION-SEMANTICA.398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403move JURAD-id-tipo to TIP-IDE-BDIIVIDE404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R405 move JURAD-nombre to NOMBRE-BDIIVIDE406407move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413IF TIP-IDE-BDIIVIDE = 2 OR 3414     MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415END-IF416MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*Valida el numero de identificación contra las bases de418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419del nombre reportado420*Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423 if SW-ID-BDIIVIDE = 1424*    es un id inválido425    call "PONERR" using "14" JURAD-reg E-errores426*valida contra la base alterna42710-VALIDACION-ID-NO-FIGURA428else429*    existe id, a ver si el nombre coincide430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide431        call "PONERR" using "15" JURAD-reg E-errores432display "novedad:  " JURAD-nombre433         display "registro: " NOM-LEIDO-BDIIVIDE434*        validación en base alterna435        perform 4220-VALIDA-NOMBRE-NO-COINCIDE436else437perform 4222-VALIDA-NOMBRE-COINCIDE438end-if439     end-if.440441Zoom   Ctrl+C to stop110406
Datos en la alerta: 000060004520201104

4320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
      
         0   0
   4200-VALIDACION-SEMANTICADatos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stopDatos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA

4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    Zoom   Ctrl+C to stopDatos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA

4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451MOVE 1 TO SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002      4465NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003      4466MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002      4467ELSEFAC0002      4468IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002      4469NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005      4470(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003      4471NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005      4472MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002      4473*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004      4474*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004      4475*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004      4476*END-IFFAC0004      4477ELSEFAC0002      4478IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002      4479NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005      4480(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002      4481NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005      4482MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002      4483ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002      4484END-IF.FAC0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopEVALUATE TIP-IDE-BDIIVIDE9315                END-PERFORM9316     END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319         BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328 VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332     IF TIP-ID-INPUT-VALNOM  NOT = 29333        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334                 "." BY " ","-" BY " ","," BY " ",9335                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336            "Y" BY "G","H" BY "G","I" BY "G"9337            PERFORM VARYING I-VALNOM FROM 1 BY 19338                  UNTIL I-VALNOM >= 669339         IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340             AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341            MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342         END-IF9343    END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "      ",                RMB0002      9347"." BY " ", " LTDA " BY "      ", RMB0002      9348" LIMITADA " BY "          ",RMB      9349 " CIA " BY "     ", " COMPA/IA " BY "",RMB0002      9350 " INVERSIONES " BY "             ",              RMB0002      9351 " EMPRESA " BY "         ",                      RMB0002      9352 " CORPORACION " BY "",RMB0002      9353   " DE " BY "", " LA " BY "", " DEL " BY "",RMB      9354 " S " BY "   ", " A " BY "   "        RMB      9355" Y " BY "   "                        GJ3      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALL  RMB      9357" S.A. " BY "      ",               RMB0002      9358"." BY " ", " LTDA " BY "      ",RMB      9359 " LIMITADA " BY "          ", RMB      9360 " CIA " BY "", " COMPA/IA " BY "",RMB    Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   UNSTRING Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCADENA-VALNOM<W-S>A ARGAS NGLO RGESSO                                                                                 :   CADENA-VALNOM<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CADENA-VALNOM      DELIMITED BY ALL " " INTO    BASURA-VALNOM-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)-VALNOM(4) VM-INPUT-VALNOM(5)AnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   MOVE SPACES TO VECTOR-INPUT-VALNOM.   UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTOZoom   Ctrl+C to stopDatos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA

4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopUNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stopDatos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA

4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000266423SIMONE MARTINEZ033002201312060070rt20   1101064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
I400000266423SIMONE MARTINEZ033002201312060070rt20   110106Error 11 Numero de embargos terminados: debe ser numerico4900-GRABAR-ERROR4000-PROCESAR-REGISTRO

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   1301114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                          9374UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9375BASURA-VALNOM9376VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)9377VM-OK-VALNOM(4) VM-OK-VALNOM(5)9378VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)9379VM-OK-VALNOM(9) VM-OK-VALNOM(10)9380VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)9381VM-OK-VALNOM(14) VM-OK-VALNOM(15)9382VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)9383VM-OK-VALNOM(19) VM-OK-VALNOM(20).9384***********HACE LA VALIDACION BLOQUE A BLOQUE********************9385MOVE 1 TO I-VALNOM.9386MOVE 0 TO BLOQOK-AUX-VALNOM.9387PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   MOVE 1 TO MATCH-OK-OUT-VALNOMMOVE 1 TO MATCH-OK-OUT-VALNOM4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0END-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEdisplay "4222-VALIDA-NOMBRE-COINCIDE"   


         


         


      display "4222-VALIDA-NOMBRE-COINCIDE"initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66 move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68 move 1 TO SW-BDIIALE69not invalid key70 move 0 to SW-BDIIALE71read BDIIALE next record72    at end73     move 1 to SW-BDIIALE74end-read75end-start7677perform until SW-BDIIALE = 178 or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE79or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE80if FUENTE-BDIIALE = 99000381and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD82and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD83    and BLOQUEO-BDIIALE = 084*encontrado85move 1 to SW-BDIIALE86         end-if87     if SW-BDIIALE = 088             read BDIIALE next record at end89                 move 1 to SW-BDIIALE90             end-read91     end-if92end-perform.9394if TIP-IDE-BDIIVIDE = 195    if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 196     move 07 to CODIGO-ERROR97else98        if ESTADO-VIG-BDIIREGI = 2199move 06 to CODIGO-ERROR500add 1 to NO-COINCIDE-REGIS501                 add 1 to CONT-FALLECIDOS502         end-if503         end-if504     end-if.505506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del códigostart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003if SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 136    else37        perform 4222-VALIDA-NOMBRE-COINCIDE38    end-if39end-if.404142 4220-VALIDA-NOMBRE-NO-COINCIDE.43Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"44******************************************************************45* Validación de IDs que figuran OK pero el nombre no coincide46******************************************************************47*nombre no coincide48IF TIP-IDE-BDIIVIDE = 149*    es una cédula50    MOVE 02 TO CODIGO-ERROR51ELSE52*no es una cédula53MOVE 01 TO CODIGO-ERROR54END-IF.555657 4222-VALIDA-NOMBRE-COINCIDE.58Ddisplay "4222-VALIDA-NOMBRE-COINCIDE"59******************************************************************60* Validación de IDs que figuran OK pero el nombre coincide61******************************************************************62*nombre coincide: busca ID en BDIIALE63initialize LLAVE-BDIIALE64move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE65move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE66move 990003 to FUENTE-BDIIALE67start BDIIALE key not < LLAVE-BDIIALE INVALID KEY68move 1 TO SW-BDIIALE69not invalid key70move 0 to SW-BDIIALE471read BDIIALE next record472at end473move 1 to SW-BDIIALE474read475start476477perform until SW-BDIIALE = 1478     or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE479 or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE480         if FUENTE-BDIIALE = 990003481     and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDend-ifend-if.end-if.321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327     end-if328329     perform 4240-CONTAR-TIPO-CUENTA330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344         call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346     end-if347Numero de identificacion348f JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355*no se controlan356if JURAD-tipo-novedad = "E"357exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365call "PONERR" using "06" JURAD-reg E-errores366end-ifif E-hay-error = "SI"perform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA506507 4240-CONTAR-TIPO-CUENTA.508Ddisplay "4240-CONTAR-TIPO-CUENTA"509******************************************************************510*Conteo de los registros por "tipo", dependiendo del código511*de error:512*00=OK513*01=NIT OK, nombre no coincide514*02=cédula OK, nombre no coincide515*03=NIT no figura51604=cédula no figura pero está en base alterna517*05=tipo id no es 1|2|3|4518*06=cédula ... ESTADO-VIG-BDIIREGI = 21519*07=cédula ... ESTADO-VIG-BDIIREGI = 12520*521*cuenta tipo 5: sin error522*    cuenta tipo 6: 01 02 06 07523*cuenta tipo 7: 03 04 05524525     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07526         ADD 1 TO W-CONT-TIPO-6527 ELSE528    IF CODIGO-ERROR = 03 OR 04 OR 05529    ADD 1 TO W-CONT-TIPO-7530ELSE531*        registros correctos, repetidos o no532         ADD 1 TO W-CONT-TIPO-5533*        si es una empresa534    IF TIPOID-E = 2 OR 3535      ADD 1 TO W-CONT-TIPO-5-PJ536        END-IF537END-IF538END-IF.539540541 4210-VALIDACION-ID-NO-FIGURA.542Ddisplay "4210-VALIDACION-ID-NO-FIGURA"543******************************************************************544* Validación de IDs que no figuran en las bases normales545******************************************************************546MOVE 0 TO HACER-MATCH547MOVE 0 TO IDE-TIPO-BDAMATCH548valida si la identificación está en la base de datos alterna549PERFORM 513-VALIDA-EN-CSV550IF IDE-TIPO-BDAMATCH = 0551    IF TIP-IDE-BDIIVIDE = 1

      

      

      display "4240-CONTAR-TIPO-CUENTA"IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5IF TIPOID-E = 2 OR 3Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsCODIGO-ERROR<W-S>00                 -7:   CODIGO-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   CODIGO-ERROR = 03 OR  ADD 1 TO W-CONT-TIPO-7EAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF TIPOID-E = 2 OR 3END-IFEND-IFEND-IF.END-IF.330331*    intento de actualizacion de BDIIALE332 perform 4300-MODIFICAR-BDIIALE333     add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344 call "PONERR" using "02" JURAD-reg E-errores345     move 05 to codigo-error346 end-if347Numero de identificacion348     if JURAD-id-numeroX is not numeric349    call "PONERR" using "03" JURAD-reg E-errores350end-if351if JURAD-id-numero not > 0352call "PONERR" using "04" JURAD-reg E-errores353end-if354*si el movimiento es una eliminacion los datos subsiguientes355no se controlan356if JURAD-tipo-novedad = "E"357 exit paragraph358end-if359*Nombres y Apellidos360if JURAD-nombre = spaces361call "PONERR" using "05" JURAD-reg E-errores362end-if363*Numero de demandas vigentes364if JURAD-demandas-vigentes is not numeric365         call "PONERR" using "06" JURAD-reg E-errores366 end-if367*    Numero de demandas terminadas368     if JURAD-demandas-terminadas is not numeric369         call "PONERR" using "07" JURAD-reg E-errores370end-if371*Fecha ultima demanda vigente YYMMDD372 if JURAD-demandas-fecha-ultima is not numeric373    call "PONERR" using "08" JURAD-reg E-errores374end-if375move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASPerform-level      Exit View

      

      

      

      

      perform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   add 1 to N-reg-OK.264*controla el reg y lo aplica si es OK265     perform 4000-PROCESAR-REGISTRO-2266    move JURAD-reg to JURAD-reg-anterior267    add 1 to REG-LEIDOS268when "10"269*fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes271*        de que se terminara el archivo272     display "Falta el reg de totales del archivo JURAD "273         display "Nombre del archivo: " P-file-name274         display "File status: " JURAD-fs275         display "Ultimo registro leido: " N-reg-leidos276     display JURAD-reg-anterior277    perform 9000-CANCELAR-PROGRAMA278when other279*error de lectura: cancelacion del proceso280    display "Error en lectura del archivo JURAD "281     display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285    perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00    call "PONERR" using "01" JURAD-reg E-errores01 end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05     move "SI" to IND-fin-proceso06    perform 4800-PROCESO-REG-T07exit paragraph0809Zoom   Ctrl+C to stop
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE      0   0
   
   
   4000-PROCESAR-REGISTROI400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520   130111

Error 14 El numero de id no se encuentra en el archivo maestro4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO      0   0
   
   
   130111
Error 14 El numero de id no se encuentra en el archivo maestro

4210-VALIDACION-ID-NO-FIGURA513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO   0   0
   
   
   Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA

513-VALIDA-EN-CSVTIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV

TIPOID-E:4 NUMID-E:00000244359SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   120406513-VALIDA-EN-CSV
TIPOID-E:4 NUMID-E:00000244359

SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   120406  3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if3309ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove JURAD-reg to JURAD-reg-anteriordisplay "4000-PROCESAR-REGISTRO-2"   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress   jurad-reg.                                                                                          display "4000-PROCESAR-REGISTRO-2"                     ****************************************************trola los datos de un registro de JURAD y si es OK la actualizar el archivo de alertas en lineaJURAD-REG<W-S>   I400000163598xxxxxx                                       0330432013101002204520120406              :   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    display "4000-PROCESAR-REGISTRO-2"                    ****************************************************ntrola los datos de un registro de JURAD y si es OK ra actualizar el archivo de alertas en lineaAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   513-VALIDA-EN-CSV
TIPOID-E:4 NUMID-E:00000244359

SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   120406   0   0
   
   
   
     3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if3309AnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More
         
         
         display "4000-PROCESAR-REGISTRO-2"   move "NO" to E-hay-errorZoom   Ctrl+C to stopTIPOID-E:4 NUMID-E:00000244359
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:


SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-2

   0   0
   
   
   
   4100-VALIDACION-FORMALSALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL  3264*controla el reg y lo aplica si es OK3265perform 4000-PROCESAR-REGISTRO-23266move JURAD-reg to JURAD-reg-anterior3267add 1 to REG-LEIDOS3268when "10"3269*fin del archivo de input:3270*esto es un error, no se encontro el registro "T" antes3271*de que se terminara el archivo3272display "Falta el reg de totales del archivo JURAD "3273display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281display "Nombre del archivo: " P-file-name3282display "File status: " JURAD-fs3283display "Ultimo registro leido: " N-reg-leidos3284display JURAD-reg-anterior3285perform 9000-CANCELAR-PROGRAMA3286end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usa3293* para actualizar el archivo de alertas en linea3294* La informacion esta leida en JURAD-reg3295****************************************************************3296move "NO" to E-hay-error32973298*validacion del tipo de movimiento3299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"3300call "PONERR" using "01" JURAD-reg E-errores3301end-if33023303*si es el registro "T" hay que señalar el fin de proceso3304if JURAD-tipo-novedad = "T"3305move "SI" to IND-fin-proceso3306perform 4800-PROCESO-REG-T3307exit paragraph3308end-if3309ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopmove "NO" to E-hay-error320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325 perform 4240-CONTAR-TIPO-CUENTA326 xit paragraph327 end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338Ddisplay "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343if JURAD-id-tipo not = "1" and "2" and "3" and "4"344call "PONERR" using "02" JURAD-reg E-errores345         move 05 to codigo-error346 end-if347*    Numero de identificacion348     if JURAD-id-numeroX is not numeric349         call "PONERR" using "03" JURAD-reg E-errores350     end-if351     if JURAD-id-numero not > 0352    call "PONERR" using "04" JURAD-reg E-errores353end-if354si el movimiento es una eliminacion los datos subsiguientes355*no se controlan56if JURAD-tipo-novedad = "E"57    exit paragraph58end-if59Nombres y Apellidos60nombre = spaces61call "PONERR" using "05" JURAD-reg E-errores62end-if63*Numero de demandas vigentes64if JURAD-demandas-vigentes is not numeric65call "PONERR" using "06" JURAD-reg E-erroresBreak-point encountered    perform 4200-VALIDACION-SEMANTICA   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 4200-VALIDACION-SEMANTICA   9697 4200-VALIDACION-SEMANTICA.98Ddisplay "4200-VALIDACION-SEMANTICA"   99****************************************************************400* Validacion del numero de identificacion y de su relacion con401* el nombre402****************************************************************403move JURAD-id-tipo to TIP-IDE-BDIIVIDE404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R405move JURAD-nombre to NOMBRE-BDIIVIDE406407 move JURAD-id-tipo to TIPOID-E408move JURAD-id-numero to NUMID-E409move JURAD-nombre to NOMBRE-E410411move 1 to SW-VERIFNOM-BDIIVIDE412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE413     IF TIP-IDE-BDIIVIDE = 2 OR 3414     MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE415     END-IF416     MOVE 2 TO NUM-BLOQUES-BDIIVIDE417*    Valida el numero de identificación contra las bases de418datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia419*del nombre reportado420*Retorna SW-ID-BDIIVIDE=1 si hay error421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe423 if SW-ID-BDIIVIDE = 1424*    es un id inválido42514426*    valida contra la base alterna427    perform 4210-VALIDACION-ID-NO-FIGURA428else429*    existe id, a ver si el nombre coincide430     if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide431         call "PONERR" using "15" JURAD-reg E-errores432        display "novedad:  " JURAD-nombre433    display "registro: " NOM-LEIDO-BDIIVIDE434*        validación en base alterna435         perform 4220-VALIDA-NOMBRE-NO-COINCIDE436    else437    perform 4222-VALIDA-NOMBRE-COINCIDE438    end-if439 end-if.440441Zoom   Ctrl+C to stopSALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL
   0   0
   
   
   
   4200-VALIDACION-SEMANTICA
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:


el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR240-CONTAR-TIPO-CUENTA000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA22-NOMBRE-COINCIDE40-CONTAR-TIPO-CUENTA300-MODIFICAR-BDIIALE
-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE00-MODIFICAR-BDIIALE-DATOS33-LEER-BDIIALE-RANDOM00-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA33-REGRABAR-BDIIALE000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-2100-VALIDACION-FORMAL2SEMANTICA  33963397 4200-VALIDACION-SEMANTICA.3398Ddisplay "4200-VALIDACION-SEMANTICA"                                       3399****************************************************************3400* Validacion del numero de identificacion y de su relacion con3401* el nombre3402****************************************************************3403move JURAD-id-tipo to TIP-IDE-BDIIVIDE3404move JURAD-id-numero to NUM-IDE-BDIIVIDE-R3405move JURAD-nombre to NOMBRE-BDIIVIDE34063407move JURAD-id-tipo to TIPOID-E3408move JURAD-id-numero to NUMID-E3409move JURAD-nombre to NOMBRE-E34103411move 1 to SW-VERIFNOM-BDIIVIDE3412move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE3413IF TIP-IDE-BDIIVIDE = 2 OR 33414MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE3415END-IF3416MOVE 2 TO NUM-BLOQUES-BDIIVIDE3417*Valida el numero de identificación contra las bases de3418*datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia3419*del nombre reportado3420*Retorna SW-ID-BDIIVIDE=1 si hay error3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431call "PONERR" using "15" JURAD-reg E-errores3432display "novedad:  " JURAD-nombre3433display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436else3437perform 4222-VALIDA-NOMBRE-COINCIDE3438end-if3439end-if.34403441ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stop   perform 80100-VALIDAR-IDENTIFICACION   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   perform 80100-VALIDAR-IDENTIFICACION   4375* y verifica la coincidencia del nombre reportado4376*===================================*4377    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378               NOMBRES-AUX-W-BDIIVIDE4379    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002      4382END-IF                                 FAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC        FAC0002      4384  MOVE ZEROS TO SW-ASGTIPIDFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387  MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IF                        FAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390  MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IF                                                FAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1        FAC0002      4394    PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395 END-IF                       FAC0002      4396  IF SW-VALTIPID-BDIIVIDE = 1                          FAC0002      4397     PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002      4398  END-IF             FAC0002      4399  IF SW-DIGCHEQUEO-BDIIVIDE = 1       FAC0004      4400    PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004      4401  END-IF                                          FAC0004      4402 IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403 (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405 INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407  IF SW-VERIFNOM-BDIIVIDE = 14408  MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409 MOVE -BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413    NUM-BLOQUES-BDIIVIDE <> ZEROS4414   MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415    ELSE IF TIP-ID-INPUT-VALNOM = 14416        MOVE 2 TO BLOQUES-INPUT-VALNOM4417         ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418       END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoom   Ctrl+C to stop
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:


el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4375* y verifica la coincidencia del nombre reportado4376*===================================*4377INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM4378NOMBRES-AUX-W-BDIIVIDE4379INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"4380IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002      4381MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002      4382END-IFFAC0002      4383IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002      4384MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002      4385END-IFFAC0002      4386IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002      4387MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002      4388END-IFFAC0002      4389IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003      4390MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003      4391END-IFFAC0003      4392IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS4393IF SW-ASGTIPID-BDIIVIDE = 1FAC0002      4394PERFORM 80300-ASIGNAR-TIPO-IDFAC0002      4395END-IFFAC0002      4396IF SW-VALTIPID-BDIIVIDE = 1FAC0002      4397PERFORM 80400-VALIDAR-TIPO-IDFAC0002      4398END-IFFAC0002      4399IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004      4400PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004      4401END-IFFAC0004      4402IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004      4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMPERFORM 80200-VALIDAR-ID   Break-point encountered AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   PERFORM 80200-VALIDAR-ID   439*Dependiendo del tipo de identificacion440441 EVALUATE TIP-IDE-BDIIVIDE442WHEN 1443     PERFORM 85010-UBICA-CEDULA444   WHEN 2445  PERFORM 85020-UBICA-NIT446   WHEN 3447     PERFORM 85020-UBICA-NIT448WHEN 4449     PERFORM 85030-UBICA-EXT450   WHEN OTHER451  MOVE 1 TO SW-ID-BDIIVIDE452 END-EVALUATE.453454 80300-ASIGNAR-TIPO-ID.                    2      4455*================================================================456*80300-ASIGNAR-TIPO-ID.                                           FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE459*================================================================460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"      4462IF (NUM-IDE-BDIIVIDE-R >= 1 AND      4463   NUM-IDE-BDIIVIDE-R  <= 99999999) OR2    64(NUM-IDE-BDIIVIDE-R >= 1000000000 AND2    65   NUM-IDE-BDIIVIDE-R  <  8000000000)3    66   MOVE 1 TO TIP-IDE-BDIIVIDE 2    67ELSE                                                     68 IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002    69    NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005    70    (NUM-IDE-BDIIVIDE-R >= 8000000000 AND  FAC0003    71    NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005    72 MOVE 2 TO TIP-IDE-BDIIVIDE                 FAC0002    73* IF NUM-ID-R >= 8000000000       FAC0004    74*    MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004    75*    MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004    76*END-IF                               FAC0004    77ELSE                             FAC0002    78IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002    79NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005    80(NUM-IDE-BDIIVIDE-R >= 6000000000 AND FAC0002    81NUM-IDE-BDIIVIDE-R  <  8000000000)      FAC0005    82MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002    83ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002    84END-IF.                              FAC0002    EVALUATE TIP-IDE-BDIIVIDEPERFORM 85030-UBICA-EXTPERFORM 85030-UBICA-EXT617*Ubica cedula de extranjeria en archivo del DAS618=============================619MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS620MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS621READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE622END-READ623IF SW-ID-BDIIVIDE = 0624 MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.625copy BDLDIR.PROC.626*BDLDIR.PROC.v.0028627$SET CONSTANT HACERMATCH"NO"    RMB0013      4628$IF HACERMATCH = "SI"RMB0013      4629$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********RMB0013      4630$ELSE             RMB0013      4631$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********RMB0013      4632$END                   RMB0013      4633******************************************************************634* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS635* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.636*    2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO637*    2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL638*                            REGISTRO DIRECC .639*    2017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE640*                         ORDENAN DE ACUERDO A LO DEFINIDO641*2017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE642*                      ORDENAN DE ACUERDO A LO DEFINIDO643*06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS644*                          DE ESTANDARIZACION DE NOMBRES DE645*    COMPONENTES DE LAS DIRECCIONES646*6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO647*                     A LAS TABLAS DE SINONIMOS LEIDA.648*******************************************************************649* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS650* FEB-15-2003  *          PROBABLE AUMENTANDO UN PESO CON BASE A LA651* R.MARTINEZ   *          CONFORMACION DE LA DIRECCION O DEL TELEFONO652*******************************************************************653* RMB0003 * DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOS654* MAR-15-2003  * PERMISOS DE ACCESO A LA BASE DE DATOS DE655* R.MARTINEZ   *DIRECCIONES656*******************************************************************657* RMB0004  * VEC001 - SE CORRIGE PROBLEMA EN EL VECTOR DE TELE658* ABR-15-2003  *          FONOS YA QUE USABA LA FECHA DE DIRECCIONES659* R.MARTINEZ   *          Y NO LA V-FECHATEL660*******************************************************************661* RMB0005      * UBI001 - SE CORRIGE PROBLEMA DE REFLEGAR EN EL662* ABR-15-2003  * INFORME LA MISMA DIRECCION COMO R,L,C DIF-MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEYREAD BDIIDAS INVALID KEYIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.403         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404       PERFORM 80200-VALIDAR-ID                                                4405  INITIALIZE NOM-VAL-BDIIVIDE406  MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE407  IF SW-VERIFNOM-BDIIVIDE = 1408     MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM409     MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM410  MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM411     IF SW-ID-BDIIVIDE = 0412             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND413                NUM-BLOQUES-BDIIVIDE <> ZEROS414                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM415             ELSE IF TIP-ID-INPUT-VALNOM = 1416     MOVE 2 TO BLOQUES-INPUT-VALNOM417                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM418    END-IF419             END-IF420             PERFORM 10000-MATCH-NOMBRES-VALNOM421             IF MATCH-OK-OUT-VALNOM = 0422            MOVE 1 TO SW-NOMBRES-BDIIVIDE423         END-IF424 END-IF425   END-IF426 ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002      4427          MOVE 1 TO SW-ID-BDIIVIDE                       FAC0002      4428 END-IF                                   FAC0002      4429  END-IF                                                      FAC0002      4430    ELSE MOVE 1 TO SW-ID-BDIIVIDE431    END-IF.432433 80200-VALIDAR-ID.434*===================================*435*80200-VALIDAR-ID.436*Validacion del numero de identificacion437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:438*BDIAREGI, BDIADAS, BDIADIAN respectivamente439*Dependiendo del tipo de identificacion440*===================================*441     EVALUATE TIP-IDE-BDIIVIDE442       WHEN 1443         PERFORM 85010-UBICA-CEDULA444       WHEN 2445         PERFORM 85020-UBICA-NIT446       WHEN 3447         PERFORM 85020-UBICA-NIT448       WHEN 4Zoom   Ctrl+C to stop
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:


el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  4403(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002      4404PERFORM 80200-VALIDAR-ID                                                4405INITIALIZE NOM-VAL-BDIIVIDE4406MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE4407IF SW-VERIFNOM-BDIIVIDE = 14408MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM4409MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM4410MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM4411IF SW-ID-BDIIVIDE = 04412IF NUM-BLOQUES-BDIIVIDE NUMERIC AND4413NUM-BLOQUES-BDIIVIDE <> ZEROS4414MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM4415ELSE IF TIP-ID-INPUT-VALNOM = 14416MOVE 2 TO BLOQUES-INPUT-VALNOM4417ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM4418END-IF4419END-IF4420PERFORM 10000-MATCH-NOMBRES-VALNOM4421IF MATCH-OK-OUT-VALNOM = 04422MOVE 1 TO SW-NOMBRES-BDIIVIDE4423END-IF4424END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427MOVE 1 TO SW-ID-BDIIVIDEFAC0002      4428END-IFFAC0002      4429END-IFFAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442WHEN 14443PERFORM 85010-UBICA-CEDULA4444WHEN 24445PERFORM 85020-UBICA-NIT4446WHEN 34447PERFORM 85020-UBICA-NIT4448WHEN 4ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopINITIALIZE NOM-VAL-BDIIVIDE9315       END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO9319           BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334 "." BY " ","-" BY " ","," BY " ",9335   "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336      "Y" BY "G","H" BY "G","I" BY "G"9337         PERFORM VARYING I-VALNOM FROM 1 BY 19338                  UNTIL I-VALNOM >= 669339    IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341      MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342              END-IF9343       END-PERFORM9344ELSE9345         INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346           " S.A. " BY "      ",     RMB0002      9347           "." BY " ", " LTDA " BY "",RMB0002      9348           " LIMITADA " BY "          ",RMB0002      9349           " CIA " BY "     ", " COMPA/IA " BY "          ",RMB0002      9350           " INVERSIONES " BY "             ",RMB0002      9351           " EMPRESA " BY "         ", RMB0002      9352           " CORPORACION " BY "      ",RMB0002      9353      " DE " BY "    ", " LA " BY "", " DEL " BY "",RMB0002      9354    " S " BY "   ", " A " BY "   "RMB0002      9355  " Y " BY "   "          GJC0003      9356  INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357  " S.A. " BY "      ",RMB0002      9358    "." BY " ", " LTDA " BY "",RMB0002      9359  " LIMITADA " BY "    ",RMB0002      9360    " CIA " BY "", " COMPA/IA " BY "",RMB0002    Break-point encountered    MOVE SPACES TO VECTOR-INPUT-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:


el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9315END-PERFORM9316END-IF.9317MOVE SPACES TO VECTOR-INPUT-VALNOM.                                       9318UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9319BASURA-VALNOM9320VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)9321VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)9322VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)9323VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)9324VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)9325VM-INPUT-VALNOM(14)9326VM-INPUT-VALNOM(15)9327VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)9328VM-INPUT-VALNOM(19)9329VM-INPUT-VALNOM(20)9330******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********9331MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.9332IF TIP-ID-INPUT-VALNOM  NOT = 29333INSPECT NOMBRE-AUX-VALNOM REPLACING ALL9334"." BY " ","-" BY " ","," BY " ",9335"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",9336"Y" BY "G","H" BY "G","I" BY "G"9337PERFORM VARYING I-VALNOM FROM 1 BY 19338UNTIL I-VALNOM >= 669339IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC9340AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC9341MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)9342END-IF9343END-PERFORM9344ELSE9345INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9346" S.A. " BY "",RMB0002      9347"." BY " ", " LTDA " BY "",RMB0002      9348" LIMITADA " BY "",RMB0002      9349" CIA " BY "", " COMPA/IA " BY "",RMB0002      9350" INVERSIONES " BY "",RMB0002      9351" EMPRESA " BY "",RMB0002      9352" CORPORACION " BY "",RMB0002      9353" DE " BY "", " LA " BY "", " DEL " BY "",RMB0002      9354" S " BY "   ", " A " BY "   "RMB0002      9355" Y " BY "   "GJC0003      9356INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002      9357" S.A. " BY "",RMB0002      9358"." BY " ", " LTDA " BY "",RMB0002      9359" LIMITADA " BY "",RMB0002      9360" CIA " BY "", " COMPA/IA " BY "",RMB0002    ZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-INPUT-VALNOM.   71MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM7273OK-VALNOM.      747576OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)77OK-VALNOM(4) VM-OK-VALNOM(5)78OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)79OK-VALNOM(9) VM-OK-VALNOM(10)80OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)81OK-VALNOM(14) VM-OK-VALNOM(15)82OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)83OK-VALNOM(19) VM-OK-VALNOM(20).84***********HACE LA VALIDACION BLOQUE A BLOQUE********************85MOVE 1 TO I-VALNOM.86     MOVE 0 TO BLOQOK-AUX-VALNOM.87PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES88  MOVE 1 TO J-VALNOM89PERFORM UNTIL J-VALNOM > 2090IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)91ADD 1 TO BLOQOK-AUX-VALNOM92MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)93           VM-INPUT-VALNOM(I-VALNOM)94MOVE 21 TO J-VALNOM95ELSE96MOVE 0 TO M-VALNOM97INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM98  FOR CHARACTERS BEFORE INITIAL "*"99IF M-VALNOM >= 15400    MOVE 0 TO M-VALNOM401      INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM402         FOR CHARACTERS BEFORE INITIAL "N"403 END-IF404 IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20405    AND (14 - M-VALNOM > 0)            GJC0005      9406    COMPUTE INI-VALNOM = M-VALNOM + 2407    COMPUTE LON-VALNOM = 14 - M-VALNOM408    MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM409    IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =410       VM-INPUT-VALNOM(I-VALNOM + 1 ) AND411       PEDAZO-VALNOM(1:M-VALNOM) =412         VM-INPUT-VALNOM(I-VALNOM)413       ADD 1 TO BLOQOK-AUX-VALNOM414       MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)415                VM-INPUT-VALNOM(I-VALNOM)416       MOVE 21 TO J-VALNOMBreak-point encountered    MOVE SPACES TO VECTOR-OK-VALNOM.   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Zoom   Ctrl+C to stop
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:


el n° de ID está dentro de su rangoBDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   0BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:0000   04900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

I400000136711ARIAS NILO RIESCO0110232011041100905720   1304114000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA4222-VALIDA-NOMBRE-COINCIDE4240-CONTAR-TIPO-CUENTA4300-MODIFICAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J001Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0001100023202011044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4300-MODIFICAR-BDIIALE-DATOS4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA  9371MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM9372END-IF.9373MOVE SPACES TO VECTOR-OK-VALNOM.                                          9374UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO9375BASURA-VALNOM9376VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)9377VM-OK-VALNOM(4) VM-OK-VALNOM(5)9378VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)9379VM-OK-VALNOM(9) VM-OK-VALNOM(10)9380VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)9381VM-OK-VALNOM(14) VM-OK-VALNOM(15)9382VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)9383VM-OK-VALNOM(19) VM-OK-VALNOM(20).9384***********HACE LA VALIDACION BLOQUE A BLOQUE********************9385MOVE 1 TO I-VALNOM.9386MOVE 0 TO BLOQOK-AUX-VALNOM.9387PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES9388MOVE 1 TO J-VALNOM9389PERFORM UNTIL J-VALNOM > 209390IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)9391ADD 1 TO BLOQOK-AUX-VALNOM9392MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9393VM-INPUT-VALNOM(I-VALNOM)9394MOVE 21 TO J-VALNOM9395ELSE9396MOVE 0 TO M-VALNOM9397INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9398FOR CHARACTERS BEFORE INITIAL "*"9399IF M-VALNOM >= 159400MOVE 0 TO M-VALNOM9401INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM9402FOR CHARACTERS BEFORE INITIAL "N"9403END-IF9404IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 209405AND (14 - M-VALNOM > 0)GJC0005      9406COMPUTE INI-VALNOM = M-VALNOM + 29407COMPUTE LON-VALNOM = 14 - M-VALNOM9408MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM9409IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =9410VM-INPUT-VALNOM(I-VALNOM + 1 ) AND9411PEDAZO-VALNOM(1:M-VALNOM) =9412VM-INPUT-VALNOM(I-VALNOM)9413ADD 1 TO BLOQOK-AUX-VALNOM9414MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)9415VM-INPUT-VALNOM(I-VALNOM)9416MOVE 21 TO J-VALNOMZoomLevel=**Speed=5InsCapsNumScroll   Ctrl+C to stopMOVE SPACES TO VECTOR-OK-VALNOM.   427END-IF428PERFORM.429IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM     9430   MOVE 1 TO MATCH-OK-OUT-VALNOM431ELSE432  IF TIP-ID-INPUT-VALNOM <> 2433     PERFORM 10100-MATCH-APROXIMADO434  ELSE435     PERFORM 10100-MATCH-APROX-EMPRESAS436  END-IF437  IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM438     MOVE 1 TO MATCH-OK-OUT-VALNOM439  END-IF440     END-IF.441**********************************************************************442*10100-MATCH-APROXIMADO.443* EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS444*CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON445*LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.446**********************************************************************447 10100-MATCH-APROXIMADO.448IF BLOQOK-AUX-VALNOM > 0449MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM450ELSE451MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM452END-IF453MOVE 1 TO I-VALNOM.454PERFORM UNTIL I-VALNOM > 10455MOVE 1 TO J-VALNOM56PERFORM UNTIL J-VALNOM > 1057MOVE 0 TO LETRAS LETRAS-OK2-VALNOM58MOVE 1 TO K-VALNOM59MOVE 1 TO L-VALNOM60IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND61VM-OK-VALNOM   (J-VALNOM) NOT = SPACES62PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 1563IF VMM-INPUT(I-VALNOM,L-VALNOM) =64  VMM-OK-VALNOM  ,K-VALNOM)65  OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"GJC0003    66AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003    67    OR = "N"))             GJC0003    68IF VMM-OK (J-VALNOM,K-VALNOM) NOT= SPACES69  ADD 1 TO LETRAS-OK-VALNOM70  ADD 1 TO K-VALNOM71ADD 1 TO L-VALNOM72ELSEBreak-point encountered    IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   AnimateCARGAJUR.gnt/.o/.exe   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM   IF TIP-ID-INPUT-VALNOM <> 2IF TIP-ID-INPUT-VALNOM <> 2PERFORM 10100-MATCH-APROXIMADOPerform-level      Exit ViewPERFORM 10100-MATCH-APROXIMADOIF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOMEND-IF.END-IF.4419      END-IF4420        PERFORM 10000-MATCH-NOMBRES-VALNOM4421        IF MATCH-OK-OUT-VALNOM = 04422        MOVE 1 TO SW-NOMBRES-BDIIVIDE4423    END-IF4424  END-IF4425END-IF4426ELSE IF SW-TID-BDIIVIDE = 1FAC0002      4427   MOVE 1 TO SW-ID-BDIIVIDE       FAC0002      4428   END-IFFAC0002      4429END-IF                                        FAC0002      4430ELSE MOVE 1 TO SW-ID-BDIIVIDE4431END-IF.44324433 80200-VALIDAR-ID.4434*===================================*4435*80200-VALIDAR-ID.4436*Validacion del numero de identificacion4437*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:4438*BDIAREGI, BDIADAS, BDIADIAN respectivamente4439*Dependiendo del tipo de identificacion4440*===================================*4441EVALUATE TIP-IDE-BDIIVIDE4442  WHEN 14443 PERFORM 85010-UBICA-CEDULA4444  WHEN 24445    PERFORM 85020-UBICA-NIT4446  WHEN 34447  PERFORM 85020-UBICA-NIT4448WHEN 44449PERFORM 85030-UBICA-EXT4450WHEN OTHER4451SW-ID-BDIIVIDE4452END-EVALUATE.44534454 80300-ASIGNAR-TIPO-ID.                                 FAC0002      4455*================================================================4456*80300-ASIGNAR-TIPO-ID.                            FAC0002      4457*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA  FA2      4458*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-BDIIVIDE4459*================================================================4460INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002      4461INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002      4462IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002      4463NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002      4464(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002    IF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEMOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IFEND-IFEND-IFEND-IFEND-IFEND-IF3421perform 80100-VALIDAR-IDENTIFICACION                                      3422*SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe3423if SW-ID-BDIIVIDE = 13424*es un id inválido3425call "PONERR" using "14" JURAD-reg E-errores3426*valida contra la base alterna3427  perform 4210-VALIDACION-ID-NO-FIGURA3428else3429*existe id, a ver si el nombre coincide3430if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincide3431       call "PONERR" using "15" JURAD-reg E-errores3432         display "novedad:  " JURAD-nombre3433         display "registro: " NOM-LEIDO-BDIIVIDE3434*validación en base alterna3435             perform 4220-VALIDA-NOMBRE-NO-COINCIDE3436         else3437             perform 4222-VALIDA-NOMBRE-COINCIDE3438         end-if3439     end-if.344034413442 4220-VALIDA-NOMBRE-NO-COINCIDE.3443Ddisplay "4220-VALIDA-NOMBRE-NO-COINCIDE"3444******************************************************************3445* Validación de IDs que figuran OK pero el nombre no coincide3446******************************************************************3447*nombre no coincide3448IF TIP-IDE-BDIIVIDE = 13449*es una cédula3450  MOVE 02 TO CODIGO-ERROR3451ELSE3452*  no es una cédula345301 TO CODIGO-ERROR3454IF.345534563457 4222-VALIDA-NOMBRE-COINCIDE.3458D    display "4222-VALIDA-NOMBRE-COINCIDE"3459******************************************************************3460* Validación de IDs que figuran OK pero el nombre coincide3461******************************************************************3462*    nombre coincide: busca ID en BDIIALE3463 initialize LLAVE-BDIIALE3464move TIP to TIP-IDE-BDIIALE3465move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE3466move 990003 to FUENTE-BDIIALEif SW-ID-BDIIVIDE = 1if SW-NOMBRES-BDIIVIDE = 1*> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1*> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-errores10053 00.
10054marca al reg actual como erroneo10055move "SI" to E-hay-error1005610057*cuenta y muestra el registro de input10058 if reg-input not = reg-input-anterior10059add 1 to E-cont-regs-con-error10060    display " "10061 display reg-input10062move reg-input to reg-input-anterior10063move spaces to E-errores-reg10064move 2 to errIndex10065end-if1006610067*contabiliza el error en la tabla de errores10068set Ex to 110069search E-error varying Ex10070at end10071    display "--- falla en la tabla de errores ---" cod-error10072when E-codigo(Ex) = "00"10073add 1 to E-contador(Ex)10074         display "--- error tipo exotico: " cod-error10075     add 1 to E-contador(Ex)10076     when E-codigo(Ex) = cod-error10077         add 1 to E-contador(Ex)10078         display "Error " cod-error " " E-descripcion(Ex)10079 end-search1008010081agrega a la lista de errores del registro10082if errIndex < (300 - 59 - 3)10083    move cod-error to E-errores-reg(errIndex:2)10084 add 3 to errIndex10085move E-descripcion(Ex) to E-errores-reg(errIndex:59)10086    add 59 to errIndex10087end-if1008810089     exit program.100901009110092 end program PONERR.1009310094 end program CARGAJUR.1009510096******************************************************************10097******************************************************************10098move "SI" to E-hay-error09******************************************************************10* Rutina de conveniencia para procesar un error detectado en un11* registro de input12* Contabiliza el error en la tabla de errores, activa el indicador13* de registro con error, muestra el mensaje en la pantalla, cuenta14* el registro erroneo15******************************************************************16 ENVIRONMENT DIVISION.17 DATA DIVISION.18 WORKING-STORAGE SECTION.19******************************************************************20* Registro de input (primeros 86 caracteres)21 01  reg-input-anteriorpic x(86) value low-values.22* Posicion del proximo error en la lista de errores del reg23 01  errIndex                     pic 999 comp.24******************************************************************2526 LINKAGE SECTION.27******************************************************************28* Codigo del error detectado29 01  cod-error                    pic xx.30******************************************************************31* Registro de input (primeros 86 caracteres)32 01  reg-input                    pic x(86).33******************************************************************34* Tabla de errores de consistencia del input35 01 E-errores.36*indica si el registro actual tiene error37 03 E-hay-error               pic xx.38*errores del registro actual3903 E-errores-reg             pic x(300).40*contador de registros con error4103 E-cont-regs-con-error     pic 9(8).42*tabla de errores4303 E-erroroccurs 50 indexed Ex.4405 E-codigopic xx.45    05       pic x.4605 E-contadorpic 9(7).4705pic x.48         05 E-descripcionpic x(59).4950******************************************************************5152 PROCEDURE DIVISION using cod-error reg-input E-errores.53 00.54*marca al reg actual como erroneo5657*    cuenta y muestra el registro de input58     if reg-input not = reg-input-anterior59         add 1 to E-cont-regs-con-error60         display " "61         display reg-input62         move reg-input to reg-input-anterior63         move spaces to E-errores-reg64         move 2 to errIndex65     end-if6667*    contabiliza el error en la tabla de errores68     set Ex to 169     search E-error varying Ex70     at end71         display "--- falla en la tabla de errores ---" cod-error72when E-codigo(Ex) = "00"73         add 1 to E-contador(Ex)74         display "--- error tipo exotico: " cod-error75         add 1 to E-contador(Ex)76     when E-codigo(Ex) = cod-error77         add 1 to E-contador(Ex)78         display "Error " cod-error " " E-descripcion(Ex)79     end-search8081*    agrega a la lista de errores del registro82     if errIndex < (300 - 59 - 3)83     move cod-error to E-errores-reg(errIndex:2)84    add 3 to errIndex85     move E-descripcion(Ex) to E-errores-reg(errIndex:59)86    add 59 to errIndex87 end-if8889 exit program.909192 end program PONERR.9394 end program CARGAJUR.9596******************************************************************979899
if reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "Perform-level      Exit View




      




      




      




      display " " 3288
 3289 4000-PROCESAR-REGISTRO-2. 3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291**************************************************************** 3292* Controla los datos de un registro de JURAD y si es OK lo usa 3293* para actualizar el archivo de alertas en linea 3294* La informacion esta leida en JURAD-reg 3295**************************************************************** 3296move "NO" to E-hay-error 3297 3298*validacion del tipo de movimiento 3299 if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 3300    call "PONERR" using "01" JURAD-reg E-errores 3301end-if 3302 3303*si es el registro "T" hay que señalar el fin de proceso 3304if JURAD-tipo-novedad = "T" 3305move "SI" to IND-fin-proceso 3306perform 4800-PROCESO-REG-T 3307exit paragraph 3308end-if 3309 3310add 1 to N-reg-leidos 3311 3312*validacion formal de los datos 3313 move 0 to codigo-error 3314perform 4100-VALIDACION-FORMAL 3315if E-hay-error = "SI" 3316perform 4900-GRABAR-ERROR 3317*perform 4240-CONTAR-TIPO-CUENTA 3318exit paragraph 3319 3320 3321*si la validacion formal dio OK se hace validacion semantica 3322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI" 3324         perform 4900-GRABAR-ERROR 3325perform 4240-CONTAR-TIPO-CUENTA 3326         exit paragraph 3327end-if 3328 3329     perform 4240-CONTAR-TIPO-CUENTA 3330 3331*intento de actualizacion de BDIIALE3332perform 4300-MODIFICAR-BDIIALE3333add 1 to N-reg-OK.Break-point encountered    display "4000-PROCESAR-REGISTRO-2"   AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More                                       display "4000-PROCESAR-REGISTRO-2"   move "NO" to E-hay-errormove "NO" to E-hay-errorif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress"T"jurad-reg.                                                              if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"    call "PONERR" using "01" JURAD-reg E-erroresend-ifJURAD-REG<W-S>T 00000000028                                             772774        787861        :   JURAD-REG<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape    if JURAD-tipo-novedad not = "I" and "M" and "E" and     call "PONERR" using "01" JURAD-reg E-errores end-ifAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-T801802 48O-REG-T.803display "4800-PROCESO-REG-T"804**805* El registro leido en el archivo JURAD es tipo "T" con totales806* de control, y debería ser el ultimo del archivo807******************************************************************808* Control de los totales calculados contra los esperados809810*cantidad de registros I M E811 if function numval(JURADT-registros) = N-reg-leidos812    continue813else814    display " "815display "No coincide la cantidad de registros:"816     JURADT-registros " con los leidos:" N-reg-leidos817    move "SI" to E-hay-error818end-if819820*Sumas de cantidades de demandas y embargos821if function numval(JURADT-demandas-terminadas)822= N-demandas-terminadas823    continue824else825     display " "826    display "No coincide total de demandas terminadas:"827    JURADT-demandas-terminadas " con el calculado:"828    N-demandas-terminadas829move "SI" to E-hay-error830 end-if831832if function numval(JURADT-embargos-vigentes)833= N-embargos-vigentes834     continue835else836    display " "837display "No coincide total de embargos vigentes:"838JURADT-embargos-vigentes " con el calculado:"839N-embargos-vigentes840    move "SI" to E-hay-error841end-if842843if function numval(JURADT-embargos-terminados)844 = N-embargos-terminados845    continue846else                  display "4800-PROCESO-REG-T"move "NO" to E-hay-errormove "NO" to E-hay-errorif function numval(JURADT-registros) = N-reg-leidosif function numval(JUR   Exit from animator ?  Yes/No/Detach   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsJURADT-REGISTROS<W-S>00000000028:   JURADT-REGISTROS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   JURADT-registros) = N-regAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   ADT-registros) = NQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsN-REG-LEIDOS<W-S>00000028:   N-REG-LEIDOS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   N-reg-leidosAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if function numval(JURADT-registros) = N-reg-leidoscontinuecontinueif function numval(JURADT-demandas-terminadas)if function numval(JURADQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsJURADT-DEMANDAS-TERMINADAS<W-S>^^^^^^^:   JURADT-DEMANDAS-TERMINADAS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   JURADT-demandas-terminadas)adasAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if function numval(JURADT-demandas-terminadas)continueQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsN-DEMANDAS-TERMINADAS<W-S>^^^^^^^  :   N-DEMANDAS-TERMINADAS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   N-demandas-terminadas  continueseAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddressjurad-reg.                                                              N

-

d

e

m

a

n

d

a

s

-

v

i

g

e

n

t

e

s

demandas-terminadascontinue
display " "N-DEMANDAS-VIGENTES<W-S>^^^^^^^ :   N-DEMANDAS-VIGENTES<W-S>   F3=hex  F4=monitor^ v =up/down dataF7=parent F8=child F9=same level<Escape   -demandas-terminadas continueeAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   unction numval(JURQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsJURADT-REGISTROS<W-S>00000000028:   JURADT-REGISTROS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   JURADT-registros) = N-regAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   









Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsJURADT-DEMANDAS-TERMINADAS<W-S>^^^^^^^:   JURADT-DEMANDAS-TERMINADAS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   JURADT-demandas-terminadas)adasAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   










Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsJURADT-EMBARGOS-VIGENTES<W-S>^^^^^^^:   JURADT-EMBARGOS-VIGENTES<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   JURADT-embargos-vigentes)esAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   










Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsJURADT-EMBARGOS-TERMINADOS<W-S>^^^^^^^:   JURADT-EMBARGOS-TERMINADOS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   JURADT-embargos-terminados)adosAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   
Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsN-EMBARGOS-TERMINADOS<W-S>^^^^^^^  :   N-EMBARGOS-TERMINADOS<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   N-embargos-terminados  continueseAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsclear                                                            Entername[+offset]orhexaddress   N-demandas-vigentes.                                                                            c         o         n         t         a                  o         r         e         s                                                                                               Level=**Speed=5InsCapsNumScroll   osN-CONTADORES<W-S>   000000280000001000000000000000200000000000000000   000000000000000000000000000000000000000000000000   00000000000000000020000000000000000                         :   N-CONTADORES<W-S>   F3=hex  F4=monF7=parent F8=child F9=same leve   itor   ^ v =up/down datal                <                       Escape   Level=**Speed=5InsCapsNumScroll   dosAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   continue756display REG-BDIIALE757         perform 9000-CANCELAR-PROGRAMA758 end-evaluate.759760761 4333-REGRABAR-BDIIALE.762D    display "4333-REGRABAR-BDIIALE"763******************************************************************764* Regraba un registro modificado en BDIIALE765******************************************************************766not PROCESO-REAL767exit paragraph768nd-if769rewrite REG-BDIIALE770evaluate EST-BDIIALE771when "00"772add 1 to N-ale-modificadas773when other774display "Error al regrabar BDIIALE fs: " EST-BDIIALE775     " key: " LLAVE-BDIIALE776    display "Registro BDIIALE: "777    display REG-BDIIALE778perform 9000-CANCELAR-PROGRAMA779nd-evaluate.780781782 4333-ELIMINAR-BDIIALE.783Ddisplay "4333-ELIMINAR-BDIIALE"784******************************************************************785* Elimina un registro de BDIIALE786******************************************************************787not PROCESO-REAL788    exit paragraph789end-if790delete BDIIALE791evaluate EST-BDIIALE792when "00"793add 1 to N-ale-eliminadas794when other795display "Error al deletear BDIIALE fs: " EST-BDIIALE796    " key: " LLAVE-BDIIALE797display "Registro BDIIALE: "798    display REG-BDIIALE799    perform 9000-CANCELAR-PROGRAMA00end-evaluate.01801802 4800-PROCESO-REG-T.803Ddisplay "4800-PROCESO-REG-T"804******************************************************************805* El registro leido en el archivo JURAD es tipo "T" con totales806* de control, y debería ser el ultimo del archivo807******************************************************************808* Control de los totales calculados contra los esperados809     move "NO" to E-hay-error810*    cantidad de registros I M E811function numval(JURADT-registros) = N-reg-leidos812continue813lse814    display " "815    display "No coincide la cantidad de registros:"816    JURADT-registros " con los leidos:" N-reg-leidos817move "SI" to E-hay-error818end-if819820*Sumas de cantidades de demandas y embargos821if function numval(JURADT-demandas-terminadas)822= N-demandas-terminadas823continue824lse825display " "826display "No coincide total de demandas terminadas:"827         JURADT-demandas-terminadas " con el calculado:"828     N-demandas-terminadas829         move "SI" to E-hay-error830     end-if831832function numval(JURADT-embargos-vigentes)833= N-embargos-vigentes834    continue835else836    display " "837    display "No coincide total de embargos vigentes:"838JURADT-embargos-vigentes " con el calculado:"839    N-embargos-vigentes840move "SI" to E-hay-error841end-if842843if function numval(JURADT-embargos-terminados)844= N-embargos-terminados45    continue46elsePerform-level      Exit ViewPerform/Call Stack - view     Program Name                    Section Name                                                                                                                                                                                                                              Z =Zoom  ^ v =scroll  Q =Quit D =Detach V =View-threads <=ViewEscape         ...llo/temporales/CARGAJUR.gnt  4800-PROCESO-REG-T      ...llo/temporales/CARGAJUR.gnt  4000-PROCESAR-REGISTRO-2      ...llo/temporales/CARGAJUR.gnt  4000-PROCESAR-REGISTRO      ...llo/temporales/CARGAJUR.gnt  0000-PROGRAMA-PRINCIPAL              3806* de control, y debería ser el ultimo del archivo 3807****************************************************************** 3808* Control de los totales calculados contra los esperados 3809     move "NO" to E-hay-error 3810*    cantidad de registros I M E 3811     if function numval(JURADT-registros) = N-reg-leidos 3812         continue 3813else 3814display " " 3815         display "No coincide la cantidad de registros:" 3816         JURADT-registros " con los leidos:" N-reg-leidos 3817         move "SI" to E-hay-errorcontinuecontinueAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Perform-level      Exit ViewNo such command AnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   Perform-level      Exit ViewPerform/Call Stack - view     Program Name                    Section Name                                                                                                                                                                                                                              Z =Zoom  ^ v =scroll  Q =Quit D =Detach V =View-threads <=ViewEscape         ...llo/temporales/CARGAJUR.gnt  4800-PROCESO-REG-T      ...llo/temporales/CARGAJUR.gnt  4000-PROCESAR-REGISTRO-2      ...llo/temporales/CARGAJUR.gnt  4000-PROCESAR-REGISTRO      ...llo/temporales/CARGAJUR.gnt  0000-PROGRAMA-PRINCIPAL              3806* de control, y debería ser el ultimo del archivo 3807****************************************************************** 3808* Control de los totales calculados contra los esperados 3809     move "NO" to E-hay-error 3810*    cantidad de registros I M E 3811     if function numval(JURADT-registros) = N-reg-leidos 3812         continue 3813else 3814display " " 3815         display "No coincide la cantidad de registros:" 3816         JURADT-registros " con los leidos:" N-reg-leidos 3817         move "SI" to E-hay-errorcontinuecontinueAnimateCARGAJUR.gnt/.o/.exe      Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   continueif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)continuecontinueif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)continuecontinue5354*    si hubo cualquier cosa se invalida el proceso55 if E-hay-error = "SI"56         display "Error en registro T de totales de control"57         display "Nombre del archivo: " ERRS-file-name58         perform 9000-CANCELAR-PROGRAMA59     end-if.606162 4900-GRABAR-ERROR.63Ddisplay "4900-GRABAR-ERROR"64******************************************************************65* El registro de JURAD tiene error: se graba en el archivo ERRS66* con indicacion del error detectado67******************************************************************68move JURAD to ERRS-reg69move E-errores-reg to ERRS-causa-rechazo70*lista de los codigos de los errores del registro71move E-errores-reg to ERRS-causa-rechazo72 write ERRS-reg73evaluate ERRS-fs74    when "00"75    continue76    when other77    display "Error al grabar el archivo de errores "78    display "Nombre del archivo: " ERRS-file-name79    display "File status: " ERRS-fs80    perform 9000-CANCELAR-PROGRAMA81    goback82evaluate.838485 4320-ARMAR-TEXTO-ALERTA.86Ddisplay "4320-ARMAR-TEXTO-ALERTA"87****************************************************************88* Hace el reemplazo de los valores adecuados en los templates89* de las linea de alerta que corresponde90****************************************************************91*segun se trate de demandas o embargos92if JURAD-demandas-vigentes not = 093or JURAD-demandas-terminadas not = 094set LAx to 195    move high-values to LA-valores96    move JURAD-demandas-vigentes to LA-num97* >>>> esto esta anulado x que no se como hacer para que lo compile98*    unstring LA-numX into LA-descarte LA-valor(1)if E-Query-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsE-HAY-ERROR<W-S>NO                :   E-HAY-ERROR<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   E-hay-error = "SI" display "Error en r display "Nombre delAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   if E-hay-error = "SI"305move "SI" to IND-fin-proceso306     perform 4800-PROCESO-REG-T307    exit paragraph308end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313move 0 to codigo-error314     perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316         perform 4900-GRABAR-ERROR317*        perform 4240-CONTAR-TIPO-CUENTA318         exit paragraph319     end-if320321*si la validacion formal dio OK se hace validacion semantica322 perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324    perform 4900-GRABAR-ERROR325    perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338100-VALIDACION-FORMAL"339**340* Validacion formaldatos del input341******************************************************************342*    Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores345    move 05 to codigo-error346end-if347*Numero de identificacion348if JURAD-id-numeroX is not numeric349         call "PONERR" using "03" JURAD-reg E-errores350 end-ifexit paragraph260when "00"261Ddisplay " "262Ddisplay " "263D    display JURAD-reg264*controla el reg y lo aplica si es OK265    perform 4000-PROCESAR-REGISTRO-2266move JURAD-reg to JURAD-reg-anterior267     add 1 to REG-LEIDOS268when "10"269*    fin del archivo de input:270*    esto es un error, no se encontro el registro "T" antes271*de que se terminara el archivo272 display "Falta el reg de totales del archivo JURAD "273display "Nombre del archivo: " P-file-name274    display "File status: " JURAD-fs275display "Ultimo registro leido: " N-reg-leidos276     display JURAD-reg-anterior277    perform 9000-CANCELAR-PROGRAMA278when other279*error de lectura: cancelacion del proceso280display "Error en lectura del archivo JURAD "281display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284    display JURAD-reg-anterior285perform 9000-CANCELAR-PROGRAMA286 end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296     move "NO" to E-hay-error297298*validacion del tipo de movimiento299if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00call "PONERR" using "01" JURAD-reg E-errores010203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05    move "SI" to IND-fin-proceso305    move "SI" to IND-fin-proceso306 perform 4800-PROCESO-REG-T307 exit paragraph308 end-if309310add 1 to N-reg-leidos311312*validacion formal de los datos313move 0 to codigo-error314 perform 4100-VALIDACION-FORMAL315 if E-hay-error = "SI"316 perform 4900-GRABAR-ERROR317*perform 4240-CONTAR-TIPO-CUENTA318exit paragraph319end-if320321*si la validacion formal dio OK se hace validacion semantica322perform 4200-VALIDACION-SEMANTICA                                         3323if E-hay-error = "SI"324 perform 4900-GRABAR-ERROR325perform 4240-CONTAR-TIPO-CUENTA326exit paragraph327end-if328329perform 4240-CONTAR-TIPO-CUENTA330331*intento de actualizacion de BDIIALE332perform 4300-MODIFICAR-BDIIALE333add 1 to N-reg-OK.334335336337 4100-VALIDACION-FORMAL.338D    display "4100-VALIDACION-FORMAL"339******************************************************************340* Validacion formal de los datos del input341******************************************************************342*Tipo de identificacion Numero {1, 2, 3, 4}343 if JURAD-id-tipo not = "1" and "2" and "3" and "4"344    call "PONERR" using "02" JURAD-reg E-errores45move 05 to codigo-error4647*Numero de identificacion48 if JURAD-id-numeroX is not numeric49    call "PONERR" using "03" JURAD-reg E-errores50end-ifexit paragraph264*controla el reg y lo aplica si es OK2650AR-REGISTRO-2266move JURAD-reg to JURAD-reg-anterior267    add 1 to REG-LEIDOS268when "10"269*    fin del archivo de input:270*esto es un error, no se encontro el registro "T" antes271    de que se terminara el archivo272    display "Falta el reg de totales del archivo JURAD "273    display "Nombre del archivo: " P-file-name274    display "File status: " JURAD-fs275display "Ultimo registro leido: " N-reg-leidos276 display JURAD-reg-anterior277perform 9000-CANCELAR-PROGRAMA278when other279*error de lectura: cancelacion del proceso280     display "Error en lectura del archivo JURAD "281    display "Nombre del archivo: " P-file-name282    display "File status: " JURAD-fs283display "Ultimo registro leido: " N-reg-leidos284display JURAD-reg-anterior285perform 9000-CANCELAR-PROGRAMA286evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************292* Controla los datos de un registro de JURAD y si es OK lo usa293* para actualizar el archivo de alertas en linea294* La informacion esta leida en JURAD-reg295****************************************************************296     move "NO" to E-hay-error297298*    validacion del tipo de movimiento299     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"00         call "PONERR" using "01" JURAD-reg E-errores01 end-if0203*si es el registro "T" hay que señalar el fin de proceso04if JURAD-tipo-novedad = "T"05    move "SI" to IND-fin-proceso06     perform 4800-PROCESO-REG-T07    exit paragraph08end-if09move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOS46 perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"             47*cierra archivos y produce el reporte final48perform 7000-RUTINA-FINAL49goback.5051 4000-PROCESAR-REGISTRO.52Ddisplay "4000-PROCESAR-REGISTRO"53****************************************************************54* Proceso de un registro del archivo de entrada JURAD55* Lectura y control del file status del archivo56****************************************************************57*lectura del prox58read JURAD59evaluate JURAD-fs60"00"61Ddisplay " "62D "63DJURAD-reg64*controla el reg y lo aplica si es OK65perform 4000-PROCESAR-REGISTRO-266move JURAD-reg to JURAD-reg-anterior67add 1 to REG-LEIDOS68when "10"69*fin del archivo de input:70*esto es un error, no se encontro el registro "T" antes71*        de que se terminara el archivo72     display "Falta el reg de totales del archivo JURAD "73         display "Nombre del archivo: " P-file-name74         display "File status: " JURAD-fs75         display "Ultimo registro leido: " N-reg-leidos76         display JURAD-reg-anterior77         perform 9000-CANCELAR-PROGRAMA78when other79*error de lectura: cancelacion del proceso80     display "Error en lectura del archivo JURAD "81    display "Nombre del archivo: " P-file-name282display "File status: " JURAD-fs283    display "Ultimo registro leido: " N-reg-leidos284display JURAD-reg-anterior285     perform 9000-CANCELAR-PROGRAMA286end-evaluate.287288289 4000-PROCESAR-REGISTRO-2.290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************perform 7000-RUTINA-FINAL41324133 7000-RUTINA-FINAL.4134Ddisplay "7000-RUTINA-FINAL"4135******************************************************************4136* Registra hora de finalizacion4137     accept W-hora-fin from time41384139* Leer JURAD a ver si hay registros despues del "T"41404141* Close todos los archivos4142* $$$$ se agregaron varios archivos más4143 close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.41444145display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD4146* Emision de contadores de registros4147 display " "4148 display "Totales de registros:"4149 display " "4150* Totales tipo PESVNO4151DISPLAY "REGISTROS LEIDOS           :" REG-LEIDOS4152DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS4153DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R4154DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS4155 DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS4156 DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN4157 DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS4158DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN4159DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO4160display " "4161*porcentaje registros procesados OK4162compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos4163display N-editp100 "% de registros correctos"4164*porcentaje registros inconsistentes4165 compute N-editp100 rounded = 100.0 * E-cont-regs-con-error4166/ N-reg-leidos4167display N-editp100 "% de registros inconsistentes"4168*cantidad de registros leídos (excluído el registro "T")4169move N-reg-leidos to N-edit4170display N-edit "Registros IME en el archivo de entrada"4171*cantidad de registros procesados sin error4172move N-reg-OK to N-edit4173display N-edit "Registros procesados sin error"41744175* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la4176* definicion de estos contadores4177*    move N-reg-tipo-I-OK to N-edit
      
      
      display "7000-RUTINA-FINAL"accept W-hora-fin from timeaccept W-hora-fin from timeclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
      
      
      display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay " "
      
      
      display " "display "Totales de registros:"
      
      
      display "Totales de registros:"display " "
      
      
      display " "DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS
      
      
      DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS
      
      
      DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R
      
      
      DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-RDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
      
      
      DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS
      
      
      DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN
      
      
      DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS
      
      
      DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN
      
      
      DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "TIPO IDENTIFICACION INVALIDO:" TIPO-ID-INVALIDO
      
      
      DISPLAY "TIPO IDENTIFICACION INVALIDO:" TIPO-ID-INVALIDOdisplay " "4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS

4333-LEER-BDIIALE-RANDOM4300-MODIFICAR-BDIIALE-IInsercion de alerta nueva que ya existe  key: 400000136711999999000J002Registro de input:I400000136711ARIAS NILO RIESCO0110232011041100905720   130411Datos en la alerta: 0000900057202013044320-ARMAR-TEXTO-ALERTA4333-REGRABAR-BDIIALE4000-PROCESAR-REGISTRO

I400000163598xxxxxx0330432013101002204520   1204064000-PROCESAR-REGISTRO-24100-VALIDACION-FORMAL4200-VALIDACION-SEMANTICA
I400000163598xxxxxx0330432013101002204520   120406Error 15 El nombre en el input no coincide con el registradonovedad:  xxxxxxregistro: KARAN  ABBOUD NAJAH4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

T 00000000028772774787861     
4000-PROCESAR-REGISTRO-24800-PROCESO-REG-T7000-RUTINA-FINALFecha de proceso: 20140104
Totales de registros:
REGISTROS LEIDOS:0000029REGISTROS CORRECTOS:0000000REGISTROS CORRECTOS REPETIDOS   :0000000REGISTROS NO COINCIDEN BDIIREGI :0000001REGISTROS DE FALLECIDOS:0000001REGISTROS NO COINCIDEN BDIIDIAN :0000000REGISTROS NO EXISTEN   BDIIREGI :0000000REGISTROS NO EXISTEN   BDIIDIAN :0000000TIPO IDENTIFICACION INVALIDO:0000000
   
      
     





  41324133 7000-RUTINA-FINAL.4134Ddisplay "7000-RUTINA-FINAL"4135******************************************************************4136* Registra hora de finalizacion4137accept W-hora-fin from time41384139* Leer JURAD a ver si hay registros despues del "T"41404141* Close todos los archivos4142* $$$$ se agregaron varios archivos más4143close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.41444145display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD4146* Emision de contadores de registros4147display " "4148display "Totales de registros:"4149display " "4150* Totales tipo PESVNO4151DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS4152DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS4153DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R4154DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS4155DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS4156DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN4157DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS4158DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN4159DISPLAY "TIPO IDENTIFICACION INVALIDO:" TIPO-ID-INVALIDO4160display " "4161*porcentaje registros procesados OK4162compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos4163display N-editp100 "% de registros correctos"4164*porcentaje registros inconsistentes4165compute N-editp100 rounded = 100.0 * E-cont-regs-con-error4166/ N-reg-leidos4167display N-editp100 "% de registros inconsistentes"4168*cantidad de registros leídos (excluído el registro "T")4169move N-reg-leidos to N-edit4170display N-edit "Registros IME en el archivo de entrada"4171*cantidad de registros procesados sin error4172move N-reg-OK to N-edit4173display N-edit "Registros procesados sin error"41744175* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la4176* definicion de estos contadores4177*move N-reg-tipo-I-OK to N-editAnimateCARGAJUR.gnt/.o/.exeLevel=**Speed=5InsCapsNumScroll   F1=help F2=view F3=align F4=exchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More
      
      display " "compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
      
      
      display N-editp100 "% de registros correctos"compute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-errordisplay N-editp100 "% de registros inconsistentes"
      
      
      display N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
      
      
      display N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"
      
      
      display N-edit "Registros procesados sin error"8384*    cantidad de registros con error85 move E-cont-regs-con-error to N-reg-con-error86     move N-reg-con-error to N-edit87     display N-edit "Registros con error"88*cantidades de alertas afectadas89if P-tipo-proceso = "04"90         move N-ale-borradas to N-edit91display N-edit92         "Alertas borradas previo al refresque total"93     end-if94move N-ale-insertadas to N-edit95display N-edit "Alertas insertadas"96move N-ale-modificadas to N-edit97     display N-edit "Alertas modificadas"98move N-ale-eliminadas to N-edit99N-edit "Alertas eliminadas"200move N-ale-ya-existe to N-edit201     display N-edit "Insercion de alerta existente"202move N-ale-no-existe to N-edit203display N-edit "Modif o elim de alerta inexistente".204205* Emision del reporte de errores206display " "207display "Totales por tipo de error detectado:"208perform varying Ex from 1 by 1 until Ex > 50209or E-codigo(Ex) = "00"210    if E-contador(Ex) not = 0211        move E-contador(ex) to E-edit212         display E-edit E-codigo(Ex) "-" E-descripcion(Ex)213    end-if214end-perform.215216217 9000-CANCELAR-PROGRAMA.218D"9000-CANCELAR-PROGRAMA"219******************************************************************220* Procedimiento standard de cancelacion de programa batch221******************************************************************222* TODO: hay un standard para comunicar una cancelacion de proceso?223display " "224pgm " - proceso cancelado"225goback returning 99.226227228 513-VALIDA-EN-CSV.move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"


      


      


      display N-edit "Registros con error"if P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-edit


      


      


      display N-editend-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"


      


      


      display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"


      


      


      display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"


      


      


      display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"


      


      


      display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".


      


      


      display N-edit "Modif o elim de alerta inexistente".display " "GoCARGAJUR.gnt/.o/.exe                                          0-9=speed  Zoom


      


      display " "display "Totales por tipo de error detectado:"   


      


      


      display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50   perform varying Ex from 1 by 1 until Ex > 50if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0move E-contador(ex) to E-edit   move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)   


      


      


      display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if   end-ifend-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0move E-contador(ex) to E-editAnimateCARGAJUR.gnt/.o/.exe   F5=where F6=look-up  F9/F10=word-</>   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   -contador(EQuery-data      Cursor-name Enter-name Monitor-off Hide/Org-monitorsEX<W-S>000000007:   EX<W-S>   clear F3=hex monitor                       ^ v =up/down dataF7=parent F8=child F9=same level                < Escape   Ex) not = 0tador(ex) tedit E-codiAnimateCARGAJUR.gnt/.o/.exe   view F3=alignexchange F5=where F6=look-up  F9/F10=word-</> Escape   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   GoCARGAJUR.gnt/.o/.exe                                          0-9=speed  Zoommove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)   


      


      


      display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if   end-ifend-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0move E-contador(ex) to E-edit   move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)   


      


      


      display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if   end-ifend-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0move E-contador(ex) to E-edit   move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)   


      


      


      display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if   end-ifend-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0move E-contador(ex) to E-edit   move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)   


      


      


      display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if   end-ifend-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0move E-contador(ex) to E-edit   move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)   


      


      


      display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if   end-ifend-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0move E-contador(ex) to E-edit   move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)   


      


      


      display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if   end-ifend-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.if E-contador(Ex) not = 0   if E-contador(Ex) not = 0end-perform.   end-perform.3247*cierra archivos y produce el reporte final3248 perform 7000-RUTINA-FINAL3249goback.32503251 4000-PROCESAR-REGISTRO.3252Ddisplay "4000-PROCESAR-REGISTRO"3253****************************************************************3254* Proceso de un registro del archivo de entrada JURAD3255* Lectura y control del file status del archivo3256****************************************************************3257*lectura del proximo registro3258read JURAD3259evaluate JURAD-fs3260when "00"3261D    display " "3262D    display " "3263D    display JURAD-reg3264*    controla el reg y lo aplica si es OK3265    perform 4000-PROCESAR-REGISTRO-23266    move JURAD-reg to JURAD-reg-anterior3267    add 1 to REG-LEIDOS3268when "10"3269*        fin del archivo de input:3270*    esto es un error, no se encontro el registro "T" antes3271*    de que se terminara el archivo3272    display "Falta el reg de totales del archivo JURAD "3273    display "Nombre del archivo: " P-file-name3274display "File status: " JURAD-fs3275display "Ultimo registro leido: " N-reg-leidos3276display JURAD-reg-anterior3277perform 9000-CANCELAR-PROGRAMA3278when other3279*error de lectura: cancelacion del proceso3280display "Error en lectura del archivo JURAD "3281         display "Nombre del archivo: " P-file-name3282     display "File status: " JURAD-fs3283         display "Ultimo registro leido: " N-reg-leidos3284         display JURAD-reg-anterior3285         perform 9000-CANCELAR-PROGRAMA3286     end-evaluate.328732883289 4000-PROCESAR-REGISTRO-2.3290Ddisplay "4000-PROCESAR-REGISTRO-2"                                        3291****************************************************************3292* Controla los datos de un registro de JURAD y si es OK lo usagoback.goback.      STOP RUN encountered goback.goback.AnimateCARGAJUR.gnt/.o/.exe   F5=where F6=look-up  F9/F10=word-</>   Step Go Zoom Perform Reset Break Env Query Find Locate Text Do View-threads More   STOP RUN/Error occurred in generated code program - option not allowed. 
   Exit from animator ?  Yes/No/Detach120406
Error 15 El nombre en el input no coincide con el registrado

novedad:  xxxxxxregistro: KARAN  ABBOUD NAJAH4220-VALIDA-NOMBRE-NO-COINCIDE4900-GRABAR-ERROR4240-CONTAR-TIPO-CUENTA4000-PROCESAR-REGISTRO

T 00000000028772774787861     
4000-PROCESAR-REGISTRO-24800-PROCESO-REG-T7000-RUTINA-FINALFecha de proceso: 20140104
Totales de registros:
REGISTROS LEIDOS:0000029REGISTROS CORRECTOS:0000000REGISTROS CORRECTOS REPETIDOS   :0000000REGISTROS NO COINCIDEN BDIIREGI :0000001REGISTROS DE FALLECIDOS:0000001REGISTROS NO COINCIDEN BDIIDIAN :0000000REGISTROS NO EXISTEN   BDIIREGI :0000000REGISTROS NO EXISTEN   BDIIDIAN :0000000TIPO IDENTIFICACION INVALIDO:000000035.7 % de registros correctos64.3 % de registros inconsistentes28 Registros IME en el archivo de entrada10 Registros procesados sin error18 Registros con errorAlertas borradas previo al refresque totalAlertas insertadasAlertas modificadasAlertas eliminadas20 Insercion de alerta existenteModif o elim de alerta inexistente
Totales por tipo de error detectado:1 02-Tipo de identificacion invalido, debe ser 1 2 3 41 07-Numero de demandas terminadas: debe ser numerico5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango1 11-Numero de embargos terminados: debe ser numerico4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango4 14-El numero de id no se encuentra en el archivo maestro2 15-El nombre en el input no coincide con el registrado
     






/d/iccol/desarrollo/temporales>^[[D  /d/iccol/desarrollo/temporales>
/d/iccol/desarrollo/temporales>
/d/iccol/desarrollo/temporales>fu
/d/iccol/desarrollo/fuentes>mv CARGAJUR.CBL ^[  /d/iccol/desarrollo/fuentes>mv CARGAJUR.CBL  CARGAJUR.cbl CARGAJUR.CBL CARGAJUR.cbl  c CARGAJUR.CBL CARGAJUR.cblp CARGAJUR.CBL CARGAJUR.cbl
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cp CARGAJUR.CBL CARGAJUR.cbl CARGAJUR.CBL CARGAJUR.cbl  v CARGAJUR.CBL CARGAJUR.cbli CARGAJUR.CBL CARGAJUR.cbli CARGAJUR.CBL             
"CARGAJUR.CBL" 1737 lines, 74096 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS."CARGAJUR.CBL" 1737 lines, 74096 characters
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1737 lines deletedNo lines in buffer:set noai noshmAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. MICROFOCUS with debugging mode.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.

      ******************************************************************
      * Archivos de base alterna
      ******************************************************************
           copy BDACSV.FS.

           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE           COPY ICBCRE.FS.

APPEND MODE           COPY BDLSTDCIU.FS.

APPEND MODE           COPY DIREST.FS.

APPEND MODE           COPY BDLNEWDIRBOG.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuación no está confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           COPY ICBDIR0001.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE           COPY ICBCRE.FD.

APPEND MODE           COPY BDLSTDCIU.FD.

APPEND MODE           COPY DIREST.FD.

APPEND MODE           COPY BDLNEWDIRBOG.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la búsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  IND-ALFABETICO              PIC  X(01).                      

APPEND MODE           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"

APPEND MODE                                            "G" "H" "I" "J" "K" "L" "M"

APPEND MODE                                            "N" "/" "O" "P" "Q" "R" "S"

APPEND MODE                                            "T" "U" "V" "W" "X" "Y" "Z"

APPEND MODE                                            "Ñ".

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE       01  SUSCRIPTOR-AUX               PIC 9(06).            

APPEND MODE       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.

APPEND MODE       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.

APPEND MODE       

APPEND MODE       01 MAS-DATOS.

APPEND MODE           03 I                         PIC 9(02) VALUE ZERO.

APPEND MODE           03 J                         PIC 9(02) VALUE ZERO.

APPEND MODE

APPEND MODE           COPY  BDLDIR.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7) value zero.

APPEND MODE           03 N-demandas-terminadas     pic 9(7) value zero.

APPEND MODE           03 N-embargos-vigentes       pic 9(7) value zero.

APPEND MODE           03 N-embargos-terminados     pic 9(7) value zero.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificación de alerta que no existe".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminación de alerta que no existe".

APPEND MODE           03 pic x(11) value "19 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Inserción de alerta que ya existe".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE      *    4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE      *    4240-CONTAR-TIPO-CUENTA

APPEND MODE      *    4210-VALIDACION-ID-NO-FIGURA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4800-PROCESO-REG-T

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1000-NOT-USED

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE      *    9800-FILTRAR-ALFABETICO

APPEND MODE     

APPEND MODE     

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE               add 1 to REG-LEIDOS

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE*******        perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualización de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE      *    parámetros para las rutinas de validación en BDIIVIDE

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE      *    algunas rutinas de COPYs usan estos datos

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE      *    switches de opciones de validación

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           if TIP-IDE-BDIIVIDE = 2 or 3

APPEND MODE               move 1 to SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           end-if

APPEND MODE           move 2 to NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el número de identificación contra las bases de

APPEND MODE      *    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia

APPEND MODE      *    del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id inválido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validación en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cédula

APPEND MODE               move 02 to CODIGO-ERROR

APPEND MODE           else

APPEND MODE      *        no es una cédula

APPEND MODE               move 01 to CODIGO-ERROR

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE           or FUENTE-BDIIALE > 990003

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4240-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del código

APPEND MODE      *    de error:

APPEND MODE      *    00=OK

APPEND MODE      *    01=NIT OK, nombre no coincide

APPEND MODE      *    02=cédula OK, nombre no coincide

APPEND MODE      *    03=NIT no figura

APPEND MODE      *    04=cédula no figura pero está en base alterna

APPEND MODE      *    05=tipo id no es 1|2|3|4

APPEND MODE      *    06=cédula ... ESTADO-VIG-BDIIREGI = 21

APPEND MODE      *    07=cédula ... ESTADO-VIG-BDIIREGI = 12

APPEND MODE      *

APPEND MODE      *    cuenta tipo 5: sin error

APPEND MODE      *    cuenta tipo 6: 01 02 06 07

APPEND MODE      *    cuenta tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            es 00: registros correctos

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificación está en la base de datos alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cédula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cédula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               call "PONERR" using "19" JURAD-reg E-errores

APPEND MODE               display "llave: " LLAVE-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           move spaces to LINEAS-BDIIALE

APPEND MODE           perform 4333-GRABAR-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE               "llave: " LLAVE-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           move spaces to LINEAS-BDIIALE

APPEND MODE           perform 4333-REGRABAR-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               "llave: " LLAVE-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Esta parte está anulada por falta de definición sobre el

APPEND MODE      *    formato del registro "T"

APPEND MODE           exit paragraph.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T-anulado.

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-vigentes)

APPEND MODE           = N-demandas-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas vigentes:"

APPEND MODE               JURADT-demandas-vigentes " con el calculado:"

APPEND MODE               N-demandas-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberían cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE      * $$$$ se agregaron varios archivos más

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      * Totales tipo PESVNO

APPEND MODE           DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5

APPEND MODE           DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6

APPEND MODE           DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros leídos (excluído el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificación está en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE TIPOID-E TO TIP-IDE-BDIIVIDE

APPEND MODE           MOVE NUMID-E TO NUM-IDE-BDIIVIDE

APPEND MODE      *    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro

APPEND MODE      *    del rango que corresponde al tipo de id

APPEND MODE           display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE

APPEND MODE           " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE

APPEND MODE           " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE

APPEND MODE           " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE

APPEND MODE           " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE      *        el tipo de id es OK

APPEND MODE               IF HACER-MATCH = ZEROS

APPEND MODE      *            abre archivos y carga la tabla de direcciones 

APPEND MODE      *            estandar, solo la primera vez

APPEND MODE                   IF OPEN-DIR = ZEROS

APPEND MODE                       OPEN INPUT MAESTRO-DIRECC

APPEND MODE                       OPEN INPUT BDLCLI

APPEND MODE                       OPEN INPUT SUSCRIPTOR

APPEND MODE                       OPEN INPUT MAESTRO-CREDIT

APPEND MODE                       OPEN INPUT MAESTRO-CHECK

APPEND MODE                       PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                       MOVE 1 TO OPEN-DIR

APPEND MODE                   END-IF

APPEND MODE      *            abre archivos y carga la tabla de direcciones 

APPEND MODE                   MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE                   MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE      *            Se recorre toda la estructura bdacsv para la identificacion

APPEND MODE      *            buscada. En caso de hallar registros se procede a realizar el

APPEND MODE      *            match

APPEND MODE                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE                   MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE                   IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                       IF TIPOID-E = 1 OR 4

APPEND MODE                           INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                           "," BY " ", ";" BY " "

APPEND MODE                       END-IF

APPEND MODE                       MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM

APPEND MODE                       MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM

APPEND MODE                       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                       PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                       IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                           MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                       ELSE

APPEND MODE                          IF W-BLOQUES > 0

APPEND MODE                              MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                          END-IF

APPEND MODE                       END-IF

APPEND MODE                   END-IF

APPEND MODE     

APPEND MODE                   IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                       MOVE TIPOID-E TO TIP-VAL

APPEND MODE                       MOVE NUMID-E TO CED-VAL

APPEND MODE                       MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                       PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                       MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                       MOVE ZEROS TO FEC-EXP-VAL

APPEND MODE                       MOVE SPACES TO MUN-EXP-VAL

APPEND MODE                       MOVE SPACES TO DEP-EXP-VAL

APPEND MODE                       MOVE SPACES TO VIG-VAL

APPEND MODE                       MOVE SPACES TO GENERO-VAL

APPEND MODE                       MOVE SPACES TO EDAD-VAL

APPEND MODE                       MOVE SPACES TO EDAD-RANGO

APPEND MODE                       ADD 1 TO SI-EXISTE-CSV

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

:w"CARGAJUR.CBL" 1649 lines, 69598 characters 
[2] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi CARGAJUR.CBL               /des-des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>ls -l CARGAJUR*
-rw-rw-r--   1 icjlud   icdatacr   61357 Jun 10 11:50 CARGAJUR-OLD.CBL
-rw-rw-r--   1 icjlud   icdatacr   74096 Jun 11 18:30 CARGAJUR.cbl
-rw-rw-r--   1 icdgd    icdatacr   69598 Jun 11 18:31 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
-rw-rw-r--   1 icjlud   icdatacr  134772 Jun 10 15:01 CARGAJUR.gnt
-rw-rw-r--   1 icjlud   icdatacr  439808 Jun 10 15:01 CARGAJUR.idy
-rw-rw-r--   1 icjlud   icdatacr  108544 Jun 10 15:01 CARGAJUR.int
-rw-rw-r--   1 icjlud   icdatacr 1201632 Jun 10 15:01 CARGAJUR.lst
-rw-rw-r--   1 icjlud   icdatacr 1005531 Jun 10 15:01 CARGAJUR.s
/d/iccol/desarrollo/fuentes>rm CARGAJUR-OLD.CBL CARGAJUR.CBL.old CARGAJUR.gnt CARGAJUR.idy CARGAJUR.int CARGAJUR.lst CARGAJUR.s
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm CARGAJUR-OLD.CBL CARGAJUR.CBL.old CARGAJUR.gnt>/d/iccol/desarrollo/fuentes>ls -l CARGAJUR*                                   /d/iccol/desarrollo/fuentes>
-rw-rw-r--   1 icjlud   icdatacr   74096 Jun 11 18:30 CARGAJUR.cbl
-rw-rw-r--   1 icdgd    icdatacr   69598 Jun 11 18:31 CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>vi

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~APPEND MODEa!sdiff -w 170 CARGAJUR.cbl CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.
1763 more lines/    [><|]  03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7).|03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7).|03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7).|03 N-embargos-terminados     pic 9(7) value zero.************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.////"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta inexistente".|"Modificación de alerta que no existe".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta inexistente".|"Eliminación de alerta que no existe".
>03 pic x(11) value "19 0000000 ".
>03 pic x(59) value
>"Inserción de alerta que ya existe".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02)./////88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"<
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
D    display "4000-PROCESAR-REGISTRO"<
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURAD//:g/^      D/dMOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCHELSEELSEIF W-BLOQUES > 0IF W-BLOQUES > 0MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCHEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VALMOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VALMOVE SPACES TO VIG-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-RANGOMOVE SPACES TO EDAD-RANGOADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY LEEMAESTROS.PROC.COPY LEEMAESTROS.PROC.//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
46 fewer lines$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS./Address search hit BOTTOM without matching pattern/   [|<>]  03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7).|03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7).|03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7).|03 N-embargos-terminados     pic 9(7) value zero.************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.////"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta inexistente".|"Modificación de alerta que no existe".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta inexistente".|"Eliminación de alerta que no existe".
>03 pic x(11) value "19 0000000 ".
>03 pic x(59) value
>"Inserción de alerta que ya existe".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02)./////88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"/if JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE|*    intento de actualización de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spaces/move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
>*    parámetros para las rutinas de validación en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
|*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
|*    switches de opciones de validaciónmove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3|if TIP-IDE-BDIIVIDE = 2 or 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE|move 1 to SW-DIGCHEQUEO-BDIIVIDEEND-IF|end-ifMOVE 2 TO NUM-BLOQUES-BDIIVIDE|move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificación contra las bases de|*    Valida el número de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide////////call "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-errores
display "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombre
display "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alterna
perform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDE
elseelse
perform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDE
end-ifend-if
end-if.end-if.


4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincide
IF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 14220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 02 TO CODIGO-ERROR|move 02 to CODIGO-ERRORELSE|else
*no es una cédula*no es una cédulaMOVE 01 TO CODIGO-ERROR|move 01 to CODIGO-ERROREND-IF.|end-if.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado*encontradomove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21///////end-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROREND-IFEND-IFEND-IF.END-IF./*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosJURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-GRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<///////
4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un error
if EST-BDIIALE not = "00"if EST-BDIIALE not = "00"
display "Modificacion de alerta inexistente "<
" key: " LLAVE-BDIIALE<
display "Registro de input: "<
display JURAD-reg<
display "Datos en la alerta: " INF-DATAHOST-BDIIALE<
add 1 to N-ale-no-existe<
call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existe
>exit paragraph
end-ifend-if
>
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valores
move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE/////////move D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALE
perform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALE
if EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.
perform 4333-REGRABAR-BDIIALE<
else<
perform 4333-GRABAR-BDIIALE<
end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<


4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E./////////
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelse
>call "PONERR" using "18" JURAD-reg E-erroresdisplay "Eliminacion de alerta inexistente "display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALE|"llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-errores<end-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "////////////No file  line 995 of 1718 --57%-- [3] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/fuentes>jobs
[3] + Stopped (SIGTSTP)        vi
[2] - Stopped (SIGTSTP)        vi CARGAJUR.CBL
[1]   Stopped (SIGTSTP)        vi $FUENTES/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>fg %2
vi CARGAJUR.CBL
05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

display "Eliminacion de alerta inexistente ""llave: " LLAVE-BDIIALEadd 1 to N-ale-no-existeend-if.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "23"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other
display "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.perform 9000-CANCELAR-PROGRAMAend-evaluate.4333-REGRABAR-BDIIALE.
******************************************************************
* Regraba un registro modificado en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
rewrite REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-modificadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-ELIMINAR-BDIIALE.
******************************************************************
* Elimina un registro de BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
delete BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-eliminadaswhen other
display "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4800-PROCESO-REG-T.
******************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo
******************************************************************
* Control de los totales calculados contra los esperadosmove "NO" to E-hay-error
*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidoscontinue$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS."CARGAJUR.CBL" line 1 of 1649 --0%-- :q/d/iccol/desarrollo/fuentes>jobs
[3] + Stopped (SIGTSTP)        vi
[1] - Stopped (SIGTSTP)        vi $FUENTES/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>fg %1
vi $FUENTES/CARGAJUR.CBL
$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************display "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existecall "PONERR" using "17" JURAD-reg E-erroresend-if
*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-E.
D    display "4300-MODIFICAR-BDIIALE-E"
******************************************************************
* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua
******************************************************************
*    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-erroresend-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-LEER-BDIIALE-RANDOM.
D    display "4333-LEER-BDIIALE-RANDOM"
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALE


     
    

    
"/d/iccol/desarrollo/fuentes/CARGAJUR.CBL" line 1002 of 1737 --57%-- :q/d/iccol/desarrollo/fuentes>jobs
[3] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/fuentes>fg
vi
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelse
>call "PONERR" using "18" JURAD-reg E-erroresdisplay "Eliminacion de alerta inexistente "display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALE|"llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-errores<end-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "[3] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/fuentes>vi CARGAJUR.CBL
"CARGAJUR.CBL" 1649 lines, 69598 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS."CARGAJUR.CBL" 1649 lines, 69598 characters/4333-01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31./*****************************************************************
******************************************************************
PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR
*    1000-RUTINA-INICIAL
*    1000-NOT-USED
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo////string "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.*    si hay embargosif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALE
*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.4300-MODIFICAR-BDIIALE-DATOS.
******************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
******************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadwhen "I"
add 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iwhen "M"
add 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mwhen "E"
add 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Ewhen other
*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAend-evaluate.4300-MODIFICAR-BDIIALE-I.
******************************************************************
* Insercion de una alerta nueva
******************************************************************
*    si el registro existia es un errorif EST-BDIIALE = "00"call "PONERR" using "19" JURAD-reg E-errores/display "llave: " LLAVE-BDIIALE
add 1 to N-ale-ya-existe
exit paragraph
end-if

*    completa los datos del registro
initialize ENCABEZADO-BDIIALE
move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE
FEC-REP-BDIIALE
move P-fecha-proceso-50 to FEC-VEN-BDIIALE
move 0 to BLOQUEO-BDIIALE
move D-datahost to INF-DATAHOST-BDIIALE
move spaces to LINEAS-BDIIALE
perform 4333-GRABAR-BDIIALE.
/

4300-MODIFICAR-BDIIALE-M.
******************************************************************
* Modificacion de una alerta existente
******************************************************************
*    si el registro no existia es un error
if EST-BDIIALE not = "00"
call "PONERR" using "17" JURAD-reg E-errores
"llave: " LLAVE-BDIIALE
add 1 to N-ale-no-existe
exit paragraph
end-if

*    reemplaza la fecha de reporte y los valores
move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE
move D-datahost to INF-DATAHOST-BDIIALE
move spaces to LINEAS-BDIIALE
perform 4333-REGRABAR-BDIIALE.when E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~?" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-REGRABAR-BDIIALE.
******************************************************************
* Regraba un registro modificado en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
rewrite REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-modificadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-ELIMINAR-BDIIALE.
******************************************************************
* Elimina un registro de BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
delete BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-eliminadaswhen other
display "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4800-PROCESO-REG-T.
******************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo
******************************************************************
* Control de los totales calculados contra los esperadosmove "NO" to E-hay-error
*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidoscontinue44*******************************************************************    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
call "PONERR" using "18" JURAD-reg E-erroresdisplay "Eliminacion de alerta inexistente ""llave: " LLAVE-BDIIALEadd 1 to N-ale-no-existeend-if.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "23"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other
display "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "when other*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAend-evaluate.4300-MODIFICAR-BDIIALE-I.
******************************************************************
* Insercion de una alerta nueva
******************************************************************
*    si el registro existia es un errorif EST-BDIIALE = "00"call "PONERR" using "19" JURAD-reg E-erroresdisplay "llave: " LLAVE-BDIIALEadd 1 to N-ale-ya-existeexit paragraphend-if*    completa los datos del registroinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove spaces to LINEAS-BDIIALEperform 4333-GRABAR-BDIIALE.4300-MODIFICAR-BDIIALE-M.
******************************************************************
* Modificacion de una alerta existente
******************************************************************
*    si el registro no existia es un errorif EST-BDIIALE not = "00"call "PONERR" using "17" JURAD-reg E-errores"llave: " LLAVE-BDIIALEadd 1 to N-ale-no-existeexit paragraphend-if*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove spaces to LINEAS-BDIIALEperform 4333-REGRABAR-BDIIALE.4300-MODIFICAR-BDIIALE-E.
******************************************************************
* Eliminacion de una alerta
******************************************************************
*    elimina el registro4300-MODIFICAR-BDIIALE-E.******************************************************************
* Eliminacion de una alerta
******************************************************************
*    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
call "PONERR" using "18" JURAD-reg E-erroresdisplay "Eliminacion de alerta inexistente ""llave: " LLAVE-BDIIALEadd 1 to N-ale-no-existeend-if.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "23"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other




     
    

    
display "Error al grabar BDIIALE fs: " EST-BDIIALE:w"CARGAJUR.CBL" 1648 lines, 69538 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>jobs
[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
[3] - Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/fuentes>fg %3
vi
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelse
>call "PONERR" using "18" JURAD-reg E-erroresdisplay "Eliminacion de alerta inexistente "display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALE|"llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-errores<end-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anterior///////when "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if./display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.<
****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(1)<
*delimited by all space<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(2)<
*delimited by all space<move LA-numx(9:12) to LA-valor(2)<
<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
* >>>> da error en el end-if<
*string LA-parte(LAx, 1) LA-valor(1)<
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)<
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)<
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)<
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)<
*LA-parte(LAx, 10) LA-valor(10)<4320-ARMAR-TEXTO-ALERTA.<****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(1)<
*delimited by all space<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(2)<
*delimited by all space<move LA-numx(9:12) to LA-valor(2)<
<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
* >>>> da error en el end-if<
*string LA-parte(LAx, 1) LA-valor(1)<
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)<
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)<
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)<
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)<
*LA-parte(LAx, 10) LA-valor(10)<
*delimited by high-value<end-if.<
<
<
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?


     


1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se deberían cargar, aunque sea de manera* blanco, me parece que se deberían cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadowhen "00"when "00"*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNODISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"/Address search hit BOTTOM without matching pattern:q!/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %3jobs     /des-des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>/x CARGAJURx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/fuentes>

real    0m0.10s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/fuentes>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2

CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130
411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130
411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130
411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130
411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120
406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA"qq" 562 lines, 20270 charactersTIPO IDENTIFICACION INVALIDO    :000000035.7 % de registros correctos
    64.3 % de registros inconsistentes
28 Registros IME en el archivo de entrada
10 Registros procesados sin error
18 Registros con error
Alertas borradas previo al refresque total
Alertas insertadas
Alertas modificadas
Alertas eliminadas
20 Insercion de alerta existente
Modif o elim de alerta inexistente

Totales por tipo de error detectado:
1 02-Tipo de identificacion invalido, debe ser 1 2 3 4
1 07-Numero de demandas terminadas: debe ser numerico
5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango
1 11-Numero de embargos terminados: debe ser numerico
4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4 14-El numero de id no se encuentra en el archivo maestro
2 15-El nombre en el input no coincide con el registrado

Inicio de Programa:  2014/06/11 18:45:26
Fin de Programa:     2014/06/11 18:45:26

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/fuentes>^DYou have stopped jobs
/d/iccol/desarrollo/fuentes>jobs
[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
4300-MODIFICAR-BDIIALE-E.******************************************************************
* Eliminacion de una alerta
******************************************************************
*    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
call "PONERR" using "18" JURAD-reg E-errores"llave: " LLAVE-BDIIALEadd 1 to N-ale-no-existeend-if.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "23"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other
display "Error al grabar BDIIALE fs: " EST-BDIIALE:q/d/iccol/desarrollo/fuentes>^D
