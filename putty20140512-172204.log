=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.05.12 17:22:04 =~=~=~=~=~=~=~=~=~=~=~=
login as: icdgd
Using keyboard-interactive authentication.
Password: 
Last login: Mon May 12 14:59:47 2014 from 172.16.10.23
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icdgd@codes /d/iccol/desarrollo
$ ^[  $ view ./objetos/BDIIALEDB2.lst$  ./objetos/BDIIALEDB2.lst    $ c ./objetos/BDIIALEDB2.lst$ ca ./objetos/BDIIALEDB2.lst$ cat ./objetos/BDIIALEDB2.lst$ cat
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   1
* /d/iccol/desarrollo/fuentes/BDIIALEDB2.CBL
* Options: int("BDIIALEDB2.int") anim csi verbose nolist sourceasm endp
*          list("BDIIALEDB2.lst")
     1* BDIIALE.V01.001
     2 IDENTIFICATION DIVISION.
     3* ******************************************************** *
     4* PROGRAMA PARA PROBAR LA NUEVA RUTINA DE ALERTAS          *
     5* ******************************************************** *
     6 PROGRAM-ID. SCOTCAR.
     7 AUTHOR. RMARTINEZ.
     8 DATE-WRITTEN. 2008/09/01
     9 DATE-COMPILED. 08-May-14 10:27.
    10 ENVIRONMENT DIVISION.
    11 CONFIGURATION SECTION.
    12 SOURCE-COMPUTER. MICROFOCUS.
    13 OBJECT-COMPUTER. MICROFOCUS.
    14 INPUT-OUTPUT SECTION.
    15 FILE-CONTROL.
*   16     COPY BDIIALE-PLANO.FS.
    17* BDIIALE-PLANO.FS.v.01.001
    18* MAESTROS DE GRUPOS,ALERTAS Y RELACIONES
    19     SELECT BDIIALE-PLANO  ASSIGN TO DISK TITLE-BDIIALE-PLANO
    20            ORGANIZATION IS LINE SEQUENTIAL
    21            ACCESS MODE  IS SEQUENTIAL
    22            LOCK MODE IS AUTOMATIC.
*   23     COPY BDIIALE.FS.
    24* BDIIALE-FS.v01.0001
    25* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTOTRES
    26
    27$SET CONSTANT SW-STATUS-BDIIALE"NO"
    28     SELECT BDIIALE
    29            ASSIGN TO DISK MAES-BDIIALE-TITLE
    30            ORGANIZATION IS INDEXED
    31            ACCESS MODE IS DYNAMIC
    32            RECORD KEY IS LLAVE-BDIIALE
    33$IF SW-STATUS-BDIIALE = "NO"
    34$DISPLAY ".............COMPILANDO BDIIALE SIN STATUS.........."
    35$ELSE
    36$DISPLAY ".............COMPILANDO BDIIALE CON STATUS.........."
    37X           FILE STATUS IS EST-BDIIALE
    38$END
    39            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*   40     COPY ICBCRE.FS.
    41* EST029.v.02.003
    42* MAESTRO DE OBLIGACIONES DE CARTERA Y TARJETA DE CREDITO REPORTADAS
    43* POR LOS DIFERENTES SUSCRIPTORES
    44 $SET IDXFORMAT"8"
    45
    46     SELECT MAESTRO-CREDIT
    47            ASSIGN TO DISK MAES-CREDIT-TITLE
    48            ORGANIZATION IS INDEXED
    49            ACCESS MODE IS DYNAMIC
    50            RECORD KEY IS LLAVE-MAES-CREDIT
    51*           ALTERNATE RECORD KEY IS LLAVE-MAES-CREDIT-ALT
    52            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    53
    54 $SET IDXFORMAT"0"
*   55     COPY ICBSUS.FS.
    57$SET CONSTANT SW-STATUS-ICBSUS"NO"
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   2
* .FS)ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/ICBSUS.F
    58     SELECT SUSCRIPTOR
    59            ASSIGN TO DISK SUSCRIPTOR-TITLE
    60            ORGANIZATION IS INDEXED
    61            ACCESS MODE IS DYNAMIC
    62            RECORD KEY IS LLAVE-SUSCRIP
    63$IF SW-STATUS-ICBSUS = "NO"
    64$DISPLAY ".............COMPILANDO ICBSUS SIN STATUS.........."
    65$ELSE
    66$DISPLAY ".............COMPILANDO ICBSUS CON STATUS.........."
    67X           FILE STATUS IS COD-RETORNO-ICBSUS
    68$END
    69            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    70
*   71     COPY  ICBCHK0001.FS.                                         GDT0002
    72*ICBCHK0001.FS.v.01.0001
    73******************************************************************
    74* EST027.v.02.002                                                *
    75* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO*
    76* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES                     *
    77******************************************************************
    78 $SET IDXFORMAT"8"
    79
    80     SELECT  MAESTRO-CHECK  ASSIGN TO  MAES-CHECK-TITLE
    81             ORGANIZATION          IS  INDEXED
    82             ACCESS         MODE   IS  DYNAMIC
    83             RECORD         KEY    IS  LLAVE-MAES-CHECK
    84             LOCK           MODE   IS  MANUAL WITH LOCK ON RECORD.
    85
    86 $SET IDXFORMAT"0"
*   87     COPY ICBDIR.FS.
    88* ICBDIR-fs.v01.002
    89* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    90* POR LOS DIFERENTES SUSCRIPTORES
    91 $SET IDXFORMAT"8"
    92
    93$SET CONSTANT SW-STATUS-ICBDIR"NO"
    94     SELECT MAESTRO-DIRECC
    95            ASSIGN TO DISK MAES-DIRECC-TITLE
    96            ORGANIZATION IS INDEXED
    97            ACCESS MODE IS DYNAMIC
    98            RECORD KEY IS LLAVE-DIRECC
    99$IF SW-STATUS-ICBDIR = "NO"
   100$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
   101$ELSE
   102$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
   103X           FILE STATUS IS EST-ICBDIR
   104$END
   105            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   106 $SET IDXFORMAT"0"
*  107     COPY BDACSV.FS.
   108* BDACSV-FS.V.0001
   109* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
   110* DATOS OFICIALES DE REGIS, DIAN Y DAS
   111     SELECT BDACSV
   112            ASSIGN TO DISK "$DATABASE/BDACSV"
   113            ORGANIZATION IS INDEXED
   114            ACCESS MODE IS DYNAMIC
   115            RECORD KEY IS LLAVE-BDACSV
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   3
* )FS)ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/BDACSV.F
   116            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  117     COPY ICBCON.FS.
   118* EST005.v.02.002
   119* ARCHIVO QIE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
   120* TIPO 5
   121     SELECT INDEXADO
   122            ASSIGN TO DISK INDEXADO-TITLE
   123            ORGANIZATION IS INDEXED
   124            ACCESS MODE IS DYNAMIC
   125            RECORD KEY IS LLAVE-INDEX
   126            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  127     COPY BDIIREGI.FS.
   128* BDIIREGI.v.03.0001
   129*===============================================================
   130* ESTRUCTURA DEL ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
   131*===============================================================
   132 $SET IDXFORMAT"8"
   133
   134$SET CONSTANT SW-STATUS-BDIIREGI"NO"
   135     SELECT BDIIREGI
   136            ASSIGN TO DISK TITLE-BDIIREGI
   137            ORGANIZATION IS INDEXED
   138            ACCESS MODE IS DYNAMIC
   139            RECORD KEY IS LLAVE-BDIIREGI
   140$IF SW-STATUS-BDIIREGI = "NO"
   141$DISPLAY ".............COMPILANDO BDIIREGI SIN STATUS.........."
   142$ELSE
   143$DISPLAY ".............COMPILANDO BDIIREGI CON STATUS.........."
   144X           FILE STATUS IS COD-RETORNO-BDIIREGI
   145$END
   146            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   147
   148$SET IDXFORMAT"0"
*  149     COPY BDIIDAS.FS.
   150* BDIIDAS.v.03.0001
   151*=====================================================================
   152* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA, PROPORCIONADAS POR EL DAS
   153*=====================================================================
   154$SET CONSTANT SW-STATUS-BDIIDAS"NO"
   155     SELECT BDIIDAS ASSIGN TO DISK TITLE-BDIIDAS
   156           ORGANIZATION IS INDEXED
   157           ACCESS MODE IS DYNAMIC
   158           RECORD KEY IS LLAVE-BDIIDAS
   159$IF SW-STATUS-BDIIDAS = "NO"
   160$DISPLAY ".............COMPILANDO BDIIDAS SIN STATUS.........."
   161$ELSE
   162$DISPLAY ".............COMPILANDO BDIIDAS CON STATUS.........."
   163X           FILE STATUS IS COD-RETORNO-BDIIDAS
   164$END
   165            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  166     COPY BDIIDIAN.FS.
   167* BDIIDIAN.v.03.0001
   168*==================================================================
   169* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADAS
   170* POR LA DIAN
   171*==================================================================
   172$SET CONSTANT SW-STATUS-BDIIDIAN"NO"
   173     SELECT BDIIDIAN ASSIGN TO DISK TITLE-BDIIDIAN
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   4
* )FS)ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/BDIIDIAN
   174            ORGANIZATION IS INDEXED
   175            ACCESS MODE  IS DYNAMIC
   176            RECORD KEY   IS LLAVE-BDIIDIAN
   177$IF SW-STATUS-BDIIDIAN = "NO"
   178$DISPLAY ".............COMPILANDO BDIIDIAN SIN STATUS.........."
   179$ELSE
   180$DISPLAY ".............COMPILANDO BDIIDIAN CON STATUS.........."
   181X           FILE STATUS IS COD-RETORNO-BDIIDIAN
   182$END
   183            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  184     COPY ICSALMIN.FS.
   185* ICSALMIN.FS.v.01.001
   186* MAESTRO DE SALARIOS MINIMOS LEGALES
   187     SELECT ICSALMIN  ASSIGN TO DISK "$DATOS/ICSALMIN.DAT"
   188            ORGANIZATION IS LINE SEQUENTIAL
   189            ACCESS MODE  IS SEQUENTIAL
   190            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   191*ADICIONALES DE DIRECCIONES
*  192     COPY BDLSTDCIU.FS.
   193* BDLSTDCIU-FS.v.0001
   194******************************************************************
   195* DEFINICION DE ARCHIVO DE ACEPCIONES DE CIUDADES.               *
   196******************************************************************
   197     SELECT BDLSTDCIU
   198            ASSIGN TO DISK TITLE-BDLSTDCIU
   199            ORGANIZATION IS INDEXED
   200            ACCESS MODE IS DYNAMIC
   201            RECORD KEY IS LLAVE-BDLSTDCIU
   202            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  203     COPY BDLNEWDIRBOG.FS.
   204* BDLNEWDIRBOG-FS.0002
   205* ARCHIVO DE NUEVAS DIRECCIONES DE BOGOTA
   206************************************************************************
   207* RMB0002    * DIRB02  SE CAMBIA AL DIRECTORIO $DIRECCIONES EL ARCHIVO
   208* R.MARTINEZ *         DE NUEVA NOMENCLATURA
   209* 26/FEB/2007*
   210************************************************************************
   211     SELECT BDLNEWDIRBOG
   212            ASSIGN TO DISK "$DIRECCIONES/BDLNEWDIRBOG"            RMB0002
   213            ORGANIZATION IS INDEXED
   214            ACCESS MODE IS DYNAMIC
   215            RECORD KEY IS LLAVE-BDLNEWDIRBOG
   216            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  217     COPY DIREST.FS.
   218*DIREST-FS.v.0001
   219******************************************************************
   220* ARCHIVO DE ESTANDARIZACION DE DIRECCIONES                      *
   221******************************************************************
   222     SELECT DIREST ASSIGN TO DISK TITLE-DIREST
   223            ORGANIZATION  IS LINE SEQUENTIAL.
*  224     COPY BDLCLI.FS.
   225*BDLCLI-FS.v.0001
   226*ARCHIVO DE  CLIENTES DE BASE DE DATOS DE LOCALIZACION CON INDICADOR Y
   227*PRIVILEGIO ACTUALIZADO.
   228    SELECT BDLCLI
   229            ASSIGN TO DISK BDLCLI-TITLE
   230            ORGANIZATION IS INDEXED
   231            ACCESS MODE IS DYNAMIC
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   5
* FS))ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/BDLCLI.F
   232            RECORD KEY IS LLAVE-BDLCLI
   233            LOCK MODE IS AUTOMATIC.
   234*ADICIONALES DE DIRECCIONES +
*  235     COPY BDLDIRESTR.FS.
   236* DBLDIRESTR.v.01.0000
   237*================================================================*
   238* ESTRUCTURA ARCHIVO INDEXADO DESTINADO PARA EL MANEJO DE ESTRATO*
   239* SOCIOECONOMICO                                                 *
   240*================================================================*
   241 $SET IDXFORMAT"8"
   242 $SET CONSTANT SW-STATUS-BDLDIRESTR"NO"
   243     SELECT BDLDIRESTR
   244            ASSIGN TO DISK "$DIRECCIONES/BDLDIRESTR"
   245            ORGANIZATION IS INDEXED
   246            ACCESS MODE IS DYNAMIC
   247            RECORD KEY IS LLAVE-BDLDIRESTR
   248 $IF SW-STATUS-BDLDIRESTR = "NO"
   249 $DISPLAY "...........COMPILANDO BDLDIRESTR SIN STATUS..........."
   250 $ELSE
   251 $DISPLAY "...........COMPILANDO BDLDIRESTR CON STATUS..........."
   252X           FILE STATUS IS COD-RETORNO-BDLDIRESTR
   253 $END
   254            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   255 $SET IDXFORMAT"0"
*  256     COPY ICBDIM.FS.
   257* ICBDIM.v.01.0001.0001
   258*===============================================================
   259* ESTRUCTURA DEL ARCHIVO DE CARGA CONSUMIDORES Y DATACAS
   260*===============================================================
   261*
   262*****************************************************************
   263$SET IDXFORMAT"8"
   264$SET CONSTANT SW-STATUS-ICBDIM"NO"
   265     SELECT ICBDIM
   266            ASSIGN TO DISK TITLE-ICBDIM
   267            ORGANIZATION IS INDEXED
   268            ACCESS MODE IS DYNAMIC
   269            RECORD KEY IS LLAVE-ICBDIM WITH DUPLICATES
   270$IF SW-STATUS-ICBDIM = "NO"
   271$DISPLAY ".............COMPILANDO ICBDIM   SIN STATUS.........."
   272$ELSE
   273$DISPLAY ".............COMPILANDO ICBDIM   CON STATUS.........."
   274X           FILE STATUS IS COD-RETORNO-ICBDIM
   275$END
   276            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   277
   278$SET IDXFORMAT"0"
*  279     COPY DUPCIUDAD.FS.
   280* TABAL DE CIUDADES QUE SE REPITEN.
   282     SELECT DUPCIUDAD ASSIGN TO DISK "$DIRECCIONES/DUPCIUDAD.DAT"
   283                    ORGANIZATION IS LINE SEQUENTIAL
   284                    ACCESS MODE IS SEQUENTIAL.
*  285     COPY BDLDIRACE.FS.
   286*BDLDIRACE-FS.v.0001
   287******************************************************************
   288* ARCHIVO DE ACEPCIONES DE DIRECCIONES                      *
   289******************************************************************
   290* RGH0001       * MOD001 - ESTANDARIZACION DE MANEJO DE ARCHIVOS *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   6
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDIRAC
   291* R. GALVIS H.  *          BDLDIRACE FILE STATUS                 *
   292* ENE. 01/2010  *                                                *
   293* INTERSCHEMES. *                                                *
   294*               *                                                *
   295******************************************************************
   296$SET CONSTANT SW-STATUS-BDLDIRACE"NO"                             RGH0001
   297 SELECT BDLDIRACE
   298        ASSIGN TO DISK TITLE-BDLDIRACE
   299        ORGANIZATION IS INDEXED
   300        ACCESS MODE IS DYNAMIC
   301        RECORD KEY IS LLAVE-BDLDIRACE
   302*       FILE STATUS IS COD-RETORNO-BDLDIRACE                      RGH0001
   303$IF SW-STATUS-BDLDIRACE = "NO"                                    RGH0001
   304$DISPLAY ".............COMPILANDO BDLDIRACE SIN STATUS.........." RGH0001
   305$ELSE                                                             RGH0001
   306$DISPLAY ".............COMPILANDO BDLDIRACE CON STATUS.........." RGH0001
   307X           FILE STATUS IS COD-RETORNO-BDLDIRACE                  RGH0001
   308$END                                                              RGH0001
   309        LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  310     COPY BDLMAIEXC.FS.
   311*BDLMAIEXC-FS.v.0001
   312******************************************************************
   313* ARCHIVO DE EXCLUSION DE MAILS                                  *
   314******************************************************************
   315* RGH0001       * MOD001 - ESTANDARIZACION DE MANEJO DE ARCHIVOS *
   316* R. GALVIS H.  *          BDLMAIEXC FILE STATUS                 *
   317* ENE. 01/2010  *                                                *
   318* INTERSCHEMES. *                                                *
   319******************************************************************
   320$SET CONSTANT SW-STATUS-BDLMAIEXC"NO"                             RGH0001
   321 SELECT BDLMAIEXC
   322        ASSIGN TO DISK TITLE-BDLMAIEXC
   323        ORGANIZATION IS INDEXED
   324        ACCESS MODE IS DYNAMIC
   325        RECORD KEY IS LLAVE-BDLMAIEXC
   326*       FILE STATUS IS COD-RETORNO-BDLMAIEXC                      RGH0001
   327$IF SW-STATUS-BDLMAIEXC = "NO"                                    RGH0001
   328$DISPLAY ".............COMPILANDO BDLMAIEXC SIN STATUS.........." RGH0001
   329$ELSE                                                             RGH0001
   330$DISPLAY ".............COMPILANDO BDLMAIEXC CON STATUS.........." RGH0001
   331X           FILE STATUS IS COD-RETORNO-BDLMAIEXC                  RGH0001
   332$END                                                              RGH0001
   333        LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  334     COPY BDLTELEXC.FS.
   335*BDLTELEXC-FS.v.0001
   336******************************************************************
   337* ARCHIVO DE EXCLUSIONES DE TELEFONOS                            *
   338******************************************************************
   339* RGH0001       * MOD001 - ESTANDARIZACION DE MANEJO DE ARCHIVOS *
   340* R. GALVIS H.  *          BDLTELEXC FILE STATUS                 *
   341* ENE. 01/2010  *                                                *
   342* INTERSCHEMES. *                                                *
   343******************************************************************
   344$SET CONSTANT SW-STATUS-BDLTELEXC"NO"                             RGH0001
   345 SELECT BDLTELEXC
   346        ASSIGN TO DISK TITLE-BDLTELEXC
   347        ORGANIZATION IS INDEXED
   348        ACCESS MODE IS DYNAMIC
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   7
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/BDLTELEX
   349        RECORD KEY IS LLAVE-BDLTELEXC
   350*       FILE STATUS IS COD-RETORNO-BDLTELEXC                      RGH0001
   351$IF SW-STATUS-BDLTELEXC = "NO"                                    RGH0001
   352$DISPLAY ".............COMPILANDO BDLTELEXC SIN STATUS.........." RGH0001
   353$ELSE                                                             RGH0001
   354$DISPLAY ".............COMPILANDO BDLTELEXC CON STATUS.........." RGH0001
   355X           FILE STATUS IS COD-RETORNO-BDLTELEXC                  RGH0001
   356$END                                                              RGH0001
   357        LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*  358     COPY BDLSTDMAI.FS.
   359* BDLSTDMAI-FS.v.0001
   360$SET CONSTANT SW-STATUS-BDLSTDMAI"NO"
   361******************************************************************
   362* DEFINICION DE ARCHIVO DE ACEPCIONES DE EMAILS  .               *
   363******************************************************************
   364     SELECT BDLSTDMAI
   365            ASSIGN TO DISK TITLE-BDLSTDMAI
   366            ORGANIZATION IS INDEXED
   367            ACCESS MODE IS DYNAMIC
   368            RECORD KEY IS LLAVE-BDLSTDMAI
   369$IF SW-STATUS-BDLSTDMAI = "NO"
   370$DISPLAY ".............COMPILANDO BDLSTDMAI SIN STATUS......."
   371$ELSE
   372$DISPLAY ".............COMPILANDO BDLSTDMAI CON STATUS......."
   373X           FILE STATUS IS COD-RETORNO-BDLSTDMAI
   374$END
   375            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   376 DATA DIVISION.
   377*
   378 FILE SECTION.
*  379     COPY BDIIALE.FD.
   380* BDIIALE-FD.v01.0003.
   381* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTORES
   382*----------------------------------------------------------------*
   383*****************************************************************
   384* RMB0003   * CIU001: SE INCLUYE EL CODIGO DE LA ALERTA DENTRO DE
   385* R.MARTINEZ* LA LLAVE, SE CAMBIA LA LONGITUD DE LLAVE-SECUNDARIA
   386* OCTUB/2006* Y SE MANEJAN ALERTAS DE TEXTO FIJO
   387******************************************************************
   388
   389 FD BDIIALE.
   390 01 REG-BDIIALE.
   391    02 LLAVE-BDIIALE.
   392       03 TIP-IDE-BDIIALE        PIC 9(01).
   393       03 NUM-IDE-BDIIALE        PIC 9(11).
   394       03 FUENTE-BDIIALE         PIC 9(06).
   395       03 COD-ALERTA-BDIIALE     PIC 9(03).                       RMB0003
   396       03 LLASEC-BDIIALE         PIC X(08).                       RMB0003
   397    02 ENCABEZADO-BDIIALE.
   398       03 FEC-NOV-BDIIALE        PIC 9(08).                       RMB0003
   399       03 FEC-VEN-BDIIALE        PIC 9(08).                       RMB0003
   400       03 FEC-REP-BDIIALE        PIC 9(08).                       RMB0003
   401       03 BLOQUEO-BDIIALE        PIC 9(01).
   402       03 FILLER-BDIIALE         PIC X(10).                       RMB0003
   403       03 INF-DATAHOST-BDIIALE   PIC X(18).                       RMB0003
   404       03 LINEAS-BDIIALE.                                         RMB0003
   405          04 LINEA1-BDIIALE      PIC X(50).                       RMB0003
   406          04 LINEA2-BDIIALE      PIC X(50).                       RMB0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   8
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALE.
   407       03 FILLER REDEFINES LINEAS-BDIIALE.                        RMB0003
   408          04 DATOS-BDIIALE       PIC X(100).                      RMB0003
   409
*  410     COPY ICBSUS.FD.
   413*******************************************************************
   414* FAC0011   * AMPLI2: SE CREA CAMPO CON SENAL USO DE M O P POR
   415* F.CUADROS *         DATAHOST
   416* FEB.2003  *
   417*******************************************************************
   418* FAC0012      * MOD012: SE AMPLIA EL CAMPO DE NOMBRE A 56 CARACTERES
   419* F.CUADROS    * Y EL CAMPO DIR-SUSCRIP PASA DE 45 A 29 CARACTERES.
   420* JUL.29/2003  * SE UTILIZA ASI EL FILLER QUE TENIA DE 16 POSICIONES
   421******************************************************************
   422* GJC0013      * REPETI: SE ADICIONA CAMPO QUE PERMITE QUE EL
   423* G.JIMENEZ    * PROGRAMA FACULIS IDENTIFIQUE SI SE DEBEN ELIMINAR
   424* SEP.15/2003  * LAS CONSULTAS REPETIDAS O NO.
   425******************************************************************
   426* GJC0014      * NEWCAM: CREACION DE NUEVO CAMPO INDICADOR DE SI SE
   427* G.JIMENEZ    * DEBE MOSTRAR EL ENDEUDAMIENTO GLOBAL A PARTIR DEL
   428* ENE. 07/2004 * HABITO DE PAGO.
   429******************************************************************
   430* FAC0015      * FRAU01: INCLUSION DE INDICADOR PARA PREGUNTAS DE
   431* F.CUADROS C. * FRAUDE
   432* JUN. 04/2004 *
   433******************************************************************
   434* FAC0016      * SISSSO: INCLUSION DE INDICADOR PARA SUSCRIPTORES
   435* F.CUADROS C. * COMO CLIENTES PILOTO SISTEMA SUI.
   436* DIC. 02/2004 * VALORES VALIDOS: 0-SISTEMA ACTUAL, 1-PASO MANUAL
   437*              * A SUI, 2-PASO AUTOMATICO A SUI.
   438******************************************************************
   439* FAC0017      * PAIS01: INCLUSION DE FECHA DE ACTUALIZACION DE
   440* F.CUADROS C. * ENDEUDAMIENTO GLOBAL
   441* MAR. 14/2005 *
   442******************************************************************
   443* RMB0018      * OUTV01: INDICADOR QUE OBLIGA A USAR CONSULTAS SOLO
   444* R.MARTINEZ   * A TRAVES DE DATA WEB
   445* ABR. 21/2005 *
   446******************************************************************
   447* GJC0019      * INFACT: SE INCLUYE FLAG PARA INDICAR SI EN LOS
   448* G.JIMENEZ    * INFORMES GENERADOS POR LA ACTUALIZACION SE GUAR-
   449* JUNIO/2005   * DAN TITULOS -0-SI  -1-NO
   450******************************************************************
   451* NDG0020      * SIRI01 : SE INCLUYE FLAG PARA EL MANEJO DE LA   *
   452* N.DUARTE     *          APLICACION EN FORMA DISTRIBUIDA EN LOS *
   453* 16/09/2005   *          BANCOS. 0 - EN DATACREDITO 1 - BANCOS. *
   454******************************************************************
   455* GJC0021      * BLQCNS : SE INCLUYE INDICADOR PARA MANEJO DE    *
   456* G.JIMENEZ    *          BLOQUEO PARA CONSULTAS                 *
   457* NOV. 01/2005 *                                                 *
   458******************************************************************
   459* FAC0022      * INDALI: SE INCLUYE INDICADOR PARA ALINEACION DE *
   460* F.CUADROS C. * CUENTAS DE HABITO DE PAGO 0-NO ALINEA 1-DERECHA *
   461* MAR.17/2006  *
   462******************************************************************
   463* FAC0023      * INDCUP: SE INCLUYE INDICADOR PARA CUPO EXCLUSIVO*
   464* F.CUADROS C. * DE UNA ENTIDAD SOLO PARA TDC.                   *
   465* JUN.13/2006  * VALORES IND-CUPO-EXCLSVO: 1(SI), 0(NO).         *
   466******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page   9
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBSUS.F
   467* FAC0024      * RCNCER: SE INCLUYE LA FECHA DE ACTUALIZACIN DE *
   468* F.CUADROS C. * DIRECCIONES EN ARCHIVO ICBDIR.                  *
   469* JUL.05/2006  *                                                 *
   470******************************************************************
   471* GJC0025      * ASIGNA: SE CREA CAMPO PARA IDENTIFICAR EL NUMERO*
   472* G.JIMENEZ C. * DE CONSULTAS DE HISTORIA DE CREDITO PERMITIDAS  *
   473* JUL.27/2006  * ES PERMITIR N TRAMAS LARGAS POR UNA TRAMA CORTA *
   474******************************************************************
   475* GJC0026      * LOTPDF: CREACION DE INDICADOR QUE IDENTIFICA SI *
   476* G.JIMENEZ C. * LAS CONSULTAS EN LOTE SE DEBEN ENTREGAR EN FORMA*
   477* ABR.28/2008  * TO PDF O TECTO COMO SIEMPRE SE HA HECHO         *
   478******************************************************************
   479* GJC0027      * RAZON1: SE CREA CAMPO PARA INDICAR SI AL SUSCRIP*
   480* G.JIMENEZ C. * TOR SE LE DEBEN ENTREGAR O NO LAS RAZONES ADVER-*
   481* NOV.25/2008  * SAS DE LOS SCORES N- NO (DEFAULT) S-SI          *
   482******************************************************************
   483* GJC0028      * ART-13: CREACION DE CAMPO QUE PERMITE AL ICGCON *
   484* G.JIMENEZ C. * IDENTIFICAR SI DEBE APLICAR O NO EL ARTICULO 13 *
   485* FEB.25/2009  * DE LA LEY. DOBLE DEL TIEMPO DE LA MORA N-NO     *
   486*              * S- SI -DEFAULT
   487******************************************************************
   488* GJC0029      * CBITMH: DEFINICION DE CAMPOS PARA SABER SI YA   *
   489* G.JIMENEZ C. *         SE ESTA ACTUALIZANDO CON EL NUEVO ACTUA-*
   490* JULIO /2009  *         LIZADOR O NO.                           *
   491******************************************************************
   492* GJC0030      * NWACT1: SE INCLUYE CAMPO PARA MANEJO DE CAMPO   *
   493* G.JIMENEZ C. *         QUE INDICA SI EL SUSCRIPTOR TIENE EL    *
   494* OCTUBRE/2009 *         MAESTRO CERTIFICADO O NO AS: 0-NO CERTI*
   495*              *         FICADO, 1-CERTIFICADO CON DISENO DE 800 *
   496*              * RAYAS1: SE CREA INDICADOR PARA IDENTIFICAR SI SE*
   497*              *         DEBEN MOSTRAR GUIONES EN EL VECTOR DE   *
   498*              *         COMPORTAMIENTO O ESPACIOS EN POSICIONES *
   499*              *         ANTERIRORES A LA FECHA DE ENTRADA A DTC *
   500******************************************************************
   501* GJC0031      * PRJUR1: SE INCLUYE CAMPO PARA MANEJO DE COSNULTAS
   502* G.JIMENEZ C. *         DE PERSONAS JURIDICAS                   *
   503* FEB/2010     *         CONSULTA PER.NATURAL=PER JURIDICA (MISMO*
   504*              *         PRODUCTO) = 0
   505*              *         CONSULTA CON CODIGO DIFERENTE DE PRODUCTO
   506*              *          = 1
   507*              * CSVPAR: SE INCLUYE CAMPO PARA MANEJO PARAMETRICO*
   508*              *         DE LA INFORMACION DE CSV CUANDO SE HACE *
   509*              *         CONSULTA DATAHOST O WEBSERVICE          *
   510******************************************************************
   511* GJC0032      * SEPRES: SE INCLUYE INDICADOR PARA MANEJAR LA SE-*
   512* G.JIMENEZ C. *         PARACION DE ERRORES E INCONSISTENCIAS EN*
   513* SEP/2010     *         LA ACTUALIZACION: 1-CADA 65000 REGISTROS*
   514*              *         2-CADA 1400000 Y 3-SIN SEPARACION       *
   515******************************************************************
   516* GJC0033      * FECMOD: SE INCLUYE FECHA DE ULTIMA MODIFICACION *
   517* G.JIMENEZ C. *         DEL REGISTRO PARA PODER CONSERVAR LA    *
   518* AGOSTO/2012  *         HISTORIA DE LOS CAMBIOS                 *
   519******************************************************************
   520* RMB0035      * LOCAL1  SE ADICIONAN FLAGS PARA HABILITAR EL    *
   521* R.martinez   *         USO DE LOS DATOS DE LOCALIZACION EN EL  *
   522* Octubre/2012 *         MAESTRO DE DIRECCIONES ICBDIR           *
   523*              *         S=HABILTA EL CAMPO,N=INHIBE EL CAMPO    *
   524******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  10
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBSUS.F
   525* CAV0036      * ENTREG: SE INCLUYE EL CAMPO PARA IDENTIFICAR    *
   526* C.VELASCO.   *         LA ENTIDAD REGULADORA DE CADA CODIGO    *
   527* FEBRERO/2013 *         DE SUSCRIPTOR.                          *
   528*              * CONTRJ: SE INCLUYE EL CAMPO PARA IDENTIFICAR SI *
   529*              *         LA ENTIDAD ENVIA NUMERO DE OBLIGACION  Y*
   530*              *         NUMERO DE TARJETA.                      *
   531*              *         S - SI ENVIA TARJETA, OTRO VALOR - NO   *
   532******************************************************************
   533 FD  SUSCRIPTOR.
   534 01  REG-SUSCRIPTOR.
   535     03  COD-SUSCRIP-ABD02       PIC 9(6).
   536     03  LLAVE-SUSCRIP   REDEFINES COD-SUSCRIP-ABD02
   537                                 PIC X(6).
   538     03  COD-TIPCTA-ABD02        PIC 99    COMP-3.
   539     03  NOM-SUSCRIP-ABD02       PIC X(56).                       FAC0012
   540     03  DIR-SUSCRIP-ABD02       PIC X(29).                       FAC0012
   541     03  FILLER REDEFINES DIR-SUSCRIP-ABD02.
   542*        04 FILLER               PIC X(16).                       FAC0012
   543         04 NOM-COR1-ABD02       PIC X(14).
   544         04 NOM-COR2-ABD02       PIC X(14).
   545         04 IND-COR-ABD02        PIC 9.
   546     03  FEC-NUEACT-ABD02        PIC 9(06) COMP-3.                VHF0009
   547     03  FACT-FIJA-ABD02         PIC 9(7)  COMP-3.
   548     03  IND-REGIST-ABD02        PIC 99    COMP-3.
   549     03  ESTADO-ABD02            PIC 9     COMP-3.
   550     03  FECHA-ING-ABD02         PIC 9(4)  COMP-3.
   551     03  FECHA-RET-ABD02         PIC 9(4)  COMP-3.
   552     03  F-ULT-ACT-ABD02         PIC 9(4)  COMP-3.
   553     03  NIT-SUSCRIP-S-ABD02     PIC 9(11) COMP-3.
   554     03  IND-AMPLIACION-ABD02    PIC 9.                           AMPINF5
   555     03  IND-PREPAGOS-ABD02      PIC 9.                           PREPAG1
   556     03  F-ACT-VAL-ABD02         PIC 9(6).                        AMPVAL1
   557     03  FEC-ACTEND-ABD02        PIC 9(06).                       FAC0017
   558     03  IND-PREG-FRAUDE-ABD02   PIC X(01).                       FAC0015
   559     03  FECHA-CREA-ABD02        PIC 9(06) COMP-3.                FAC0008
   560     03  IND-ENTREGA-INF-ABD02   PIC 9.                           FAC0008
   561     03  IND-RAZON-BLQ-ABD02     PIC 9.                           FAC0008
   562     03  F-ACT-SECREAL-ABD02     PIC 9(06) COMP-3.                VHF0009
   563     03  MES-1-SECREAL-ABD02     PIC 9(01).                       VHF0009
   564     03  MES-2-SECREAL-ABD02     PIC 9(01).                       VHF0009
   565     03  MES-3-SECREAL-ABD02     PIC 9(01).                       VHF0009
   566     03  MES-4-SECREAL-ABD02     PIC 9(01).                       VHF0009
   567     03  IND-CUOTA-AFIL-ABD02    PIC 9(01).                       FAC0010
   568     03  SENAL-DATAHOST-ABD02    PIC X(1).                        FAC0011
   569     03  IND-REPETIDAS-ABD02     PIC X(1).                        GJC013
   570     03  IND-ENDEUD-ABD02        PIC 9.                           GJC0014
   571     03  IND-PILOTO-ABD02        PIC 9.                           FAC0016
   572     03  IND-SOLOWEB-ABD02       PIC 9.                           RMB0018
   573     03  FLAG-INFOR-ACT          PIC 9.                           GJC0019
   574     03  IND-REMOTO-ABD02        PIC 9.                           NDG0020
   575     03  BLQ-CONS-ABD02          PIC 9.                           GJC0021
   576     03  IND-ALINEA-CTA-ABD02    PIC 9(01).                       FAC0022
   577     03  IND-CUPO-EXCLSVO-ABD02  PIC 9(01).                       FAC0023
   578     03  FEC-ACTDIR-ABD02        PIC 9(06) COMP-3.                FAC0024
   579     03  NRO-ASIGNAS-ABD02       PIC 9(02).                       GJC0025
   580     03  PDF-ABD02               PIC X(01).  *> S OR N            GJC0026
   581     03  ENTREGA-RAZONES-ABD02   PIC X(01).  *> S O N             GJC0027
   582     03  APLICA-ART13-ABD02      PIC X(01).  *> S o N             GJC0028
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  11
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBSUS.F
   583     03  FORM-NUEVO-ABD02        PIC X(01).  *> S o N             GJC0029
   584     03  FEC-NOV-FORM-NUEVO-ABD02 PIC 9(06) COMP-3.               GJC0029
   585     03  CERTIFICADO-ABD02       PIC 9(01).  *> 0-NO 1-SI DE 800  GJC0030
   586     03  RAYAS-ABD02             PIC X(01).  *> N-NO S-SI         GJC0030
   587     03  CSV-ABD02               PIC 9(01).  *> 0-NO 1-SI         GJC0031
   588     03  OTRO-PROD-JUR-ABD02     PIC X(01).  *> N-NO S-SI         GJC0031
   589     03  IND-SEPARA-RES-ABD02    PIC 9(01).                       GJC0032
   590     03  FEC-MOD-REG-ABD02       PIC 9(08).                       GJC0033
   591     03  DIRRES-ABD02            PIC X(01).                       RMB0034
   592     03  TELRES-ABD02            PIC X(01).                       RMB0034
   593     03  DIRLAB-ABD02            PIC X(01).                       RMB0034
   594     03  TELLAB-ABD02            PIC X(01).                       RMB0034
   595     03  DIRCOR-ABD02            PIC X(01).                       RMB0034
   596     03  TELCEL-ABD02            PIC X(01).                       RMB0034
   597     03  E-MAIL-ABD02            PIC X(01).                       RMB0034
   598     03  ENTID-REGULA-ABD02      PIC X(01).                       CAV0036
   599     03  IND-CONTRAT-TARJ-ABD02  PIC X(01).                       CAV0036
   600     03  FILLER-ABD02-2          PIC X(05).                       CAV0036
   601*    03  FILLER-ABD02-2          PIC X(07).                       CAV0036
   602*    03  FILLER-ABD02-2          PIC X(14).                       RMB0034
   603*     03  FILLER-ABD02-2          PIC X(22).                      GJC0033
*  604     COPY ICBCRE.FD.
   605* ICBCRE-FD.v.02.0013
   606* MAESTRO OBLIGACIONES DE CARTERA Y TARJETAS DE CREDITO REPORTADAS
   607* POR LOS DIFERENTES SUSCRIPTORES
   608*----------------------------------------------------------------*
   609******************************************************************
   610* VHF0008     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   611* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
   612* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   613* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   614* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   615*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   616*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   617*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   618*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   619******************************************************************
   620* FAC0009     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD07 EN*
   621* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD07 PARA INDICAR *
   622*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   623* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD07 QUE *
   624*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   625******************************************************************
   626* JGR0010     * REGVEC - SE REUTILIZAN CAMPOS PARA PODER GRABAR  *
   627* JAIRO GOMEZ.*          LOS VECTORES HISTORICOS DEL TERCERO Y   *
   628*             *          CUARTO AO DE HISTORIA CREDITICIA       *
   629* 09/AGO/2007 *                                                  *
   630******************************************************************
   631* GJC0011     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   632* G. JIMENEZ  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   633* 09/AGO/2007 *          CREDITO. REDEFINEN LOS CAMPOS CREADOS   *
   634*             *          PARA EL MANEJO DE LOS 4 TRIMESTRES DE   *
   635*             *          ENDEUDAMIENTO                           *
   636******************************************************************
   637* GJC0012     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   638* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   639* OCTUBRE/2010*          SON MS DE 10                           *
   640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  12
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBCRE.F
   641* CAV0013     * MICROC - SE REDEFINE  CAMPO IND-BLOQUEO-R-ABD07  *
   642* C. VELASCO. *          DE PIC 9 A PIC X PARA ALMACENAR MAS DE  *
   643* 19/SEP/2011.*          10 POSIBLES VALORES PARA TIPO GARANTIA. *
   644******************************************************************
   645 FD  MAESTRO-CREDIT.
   646 01  COMPLETO-ABD07.
   647     03  LLAVE-MAES-CREDIT.
   648         05  LLAVE-MAES-CREDIT-PRI.
   649             07  TIPO-ID-ABD07     PIC 9.
   650             07  NUM-ID-ABD07      PIC 9(11).
   651         05  LLAVE-MAES-CREDIT-ALT.
   652             07  COD-SUS-ABD07     PIC 9(6).
   653             07  COD-CTA-ABD07     PIC 99.
   654             07  NUM-CTA-ABD07     PIC X(18).
   655             07  NUM-CTA-VEN16-ABD07 REDEFINES NUM-CTA-ABD07.      AMPLIA
   656                 09  NUM-CTA-VEN-ABD07 PIC 9(16).                  AMPLIA
   657                 09  GARANTE-VEN-ABD07 PIC 99.                     AMPLIA
   658     03  IND-BLOQUEO-ABD07         PIC 9     COMP-3.
   659     03  FECHA-APERT-ABD07         PIC 9(4)  COMP-3.
   660     03  FECHA-VENC-ABD07          PIC 9(4)  COMP-3.
   661     03  CUANTIA-ABD07             PIC 9(5)  COMP-3.
   662     03  CALIFIC-ABD07             PIC 9     COMP-3.
   663     03  TIP-CALIFIC-ABD07         PIC 9     COMP-3.
   664     03  NOV-REPORT-ABD07          PIC 99    COMP-3.
   665     03  FEC-NOVEDAD-ABD07         PIC 9(4)  COMP-3.
   666     03  NUM-MORAS30-ABD07         PIC 99    COMP-3.
   667     03  ESTADO-MES-ABD07          PIC 9(12) COMP-3.
   668     03  VECTOR-HIS-1-ABD07        PIC 9(12) COMP-3     *> AO 1   JGR0010
   669         REDEFINES                 ESTADO-MES-ABD07.               JGR0010
   670     03  MORA-MAXIMA-ABD07         PIC 9     COMP-3.
   671     03  ADJETIVO1-ABD07           PIC 9     COMP-3.
   672     03  FEC-MEN-ADJ-ABD07         PIC 9(4)  COMP-3.
   673     03  ADJETIVO2-ABD07           PIC 9     COMP-3.
   674     03  FEC-MAY-ADJ-ABD07         PIC 9(4)  COMP-3.
   675     03  ADJETIVO3-ABD07           PIC 9     COMP-3.
   676     03  ART15-ABD07               PIC 9     COMP-3.
   677     03  IND-MODIFICACION-ABD07    PIC 9     COMP-3               VHF0008
   678         REDEFINES                 ART15-ABD07.                   VHF0008
   679     03  RECLAMO-ABD07             PIC 9(5)  COMP-3.
   680     03  RECLAMO-ABD07-RR          REDEFINES RECLAMO-ABD07        FAC0008
   681                                   PIC 9(3).                      FAC0008
   682     03  RECLAMO-ABD07-R           REDEFINES RECLAMO-ABD07.       VHF0008
   683         05 IND-RECLAMO-ABD07      PIC 9(01).                     VHF0008
   684         05 REG-LOCK-ABD07         PIC 9(01).                     FAC0009
   685         05 FILLER-RECLAMO-ABD07   PIC 9(01).                     FAC0009
   686         05 TARJ-ESTADO-PLAST-ABD07    PIC 9(1)  REDEFINES        GJC0011
   687            FILLER-RECLAMO-ABD07.                                 GJC0011
   688         05 REAL-TERMINO-CONTRATO-ABD07 PIC 9(1) *> 1-DEFINIDO    GJC0011
   689            REDEFINES FILLER-RECLAMO-ABD07.      *> 2-INDEF       GJC0011
   690         05 IND-SUBSIDIO-HIPOTEC-ABD07 PIC 9(1)  *> 0-NO          GJC0011
   691            REDEFINES FILLER-RECLAMO-ABD07.      *> 1-SI          GJC0011
   692*    03  IND-BLOQUEO-R-ABD07       PIC 9     COMP-3.              CAV0013
   693     03  IND-BLOQUEO-R-ABD07       PIC X.                         CAV0013
   694     03  TIPO-GAR-DETALLE-ABD07    PIC X   REDEFINES *> TIPO DE   CAV0013
   695         IND-BLOQUEO-R-ABD07.     *> GARANTIA DETALLADO           CAV0013
   696     03  CALIFIC-R-ABD07           PIC 9     COMP-3.
   697     03  TIP-CALIFIC-R-ABD07       PIC 9     COMP-3.
   698     03  IND-MAPA-BITS-VLR-ABD07 REDEFINES TIP-CALIFIC-R-ABD07    FAC0007
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  13
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBCRE.F
   699                                   PIC 9     COMP-3.
   700     03  NOV-REPORT-R-ABD07        PIC 99    COMP-3.
   701     03  FEC-NOVEDAD-R-ABD07       PIC 9(4)  COMP-3.
   702     03  NUM-MORAS30-R-ABD07       PIC 99    COMP-3.
   703     03  MAPA-BITS-VLR-ABD07 REDEFINES NUM-MORAS30-R-ABD07        FAC0007
   704                                   PIC X(02).                     FAC0007
   705     03  ESTADO-MES-R-ABD07        PIC 9(12) COMP-3.
   706     03  VECTOR-HIS-3-ABD07        PIC 9(12) COMP-3     *> AO 3   JGR0010
   707         REDEFINES                 ESTADO-MES-R-ABD07.             JGR0010
   708     03  MORA-MAXIMA-R-ABD07       PIC 9     COMP-3.
   709     03  VALOR-INICIAL-ABD07       PIC 9(7)  COMP-3.               AMPLIA
   710*     03  CAMPOS-ENDEUDAMIENTO. *> SE ELIMINAN PARA CREAR NUEVOS  GJC0011
   711*                              *> CAMPOS                          GJC0011
   712*     05  VALOR-SALDO-DEUDA-ABD07-R           OCCURS 4 TIMES.     GJC0011
   713*         07  VALOR-SALDO-DEUDA-ABD07   PIC  9(7) COMP-3.         GJC0011
   714*     05  VALOR-DISPONIBLE-ABD07-R            OCCURS 4 TIMES.     GJC0011
   715*         07  VALOR-DISPONIBLE-ABD07    PIC  9(7) COMP-3.         GJC0011
   716*     05  VALOR-SALDO-MORA-ABD07-R            OCCURS 4 TIMES.     GJC0011
   717*         07  VALOR-SALDO-MORA-ABD07    PIC  9(7) COMP-3.         GJC0011
   718*     05  CALIFICACION-ABD07-R                OCCURS 4 TIMES.     GJC0011
   719*         07  CALIFICACION-ABD07        PIC  9    COMP-3.         GJC0011
   720     03  NUEVOS-CAMPOS-HISTORIA-CREDITO.                          GJC0011
   721* CAMPOS DE FECHAS QUE EXISTIAN PERO AHORA SON COMPLETAS          GJC0011
   722        05  FECHA-APERTURA-ABD07       PIC 9(8)  COMP-3.          GJC0011
   723        05  FECHA-VENCIMIENTO-ABD07    PIC 9(8)  COMP-3.          GJC0011
   724        05  FECHA-ADJETIVO1-ABD07      PIC 9(8)  COMP-3.          GJC0011
   725        05  FECHA-ADJETIVO2-ABD07      PIC 9(8) COMP-3.           GJC0011
   726        05  FECHA-ADJETIVO3-ABD07      PIC 9(8)  COMP-3.          GJC0011
   727* DEFINICIONES DE NUEVOS CAMPOS                                   GJC0011
   728         05  ESTADO-OBLIG-ABD07         PIC 9(2)  COMP-3.         GJC0011
   729         05  FECHA-ESTADO-OBLIG-ABD07   PIC 9(8)  COMP-3.         GJC0011
   730         05  FECHA-ESTADO-ORIGEN-ABD07  PIC 9(8)  COMP-3.         GJC0011
   731         05  FECHA-LIMITE-PAGO-ABD07    PIC 9(8)  COMP-3.         GJC0011
   732         05  TARJ-FEC-ESTADO-PLAST-ABD07 PIC 9(8) COMP-3.         GJC0011
   733         05  REAL-FEC-CLAUS-PERM-ABD07  PIC 9(8) COMP-3           GJC0011
   734             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
   735         05  FEC-SUBSIDIO-HIPOTEC-ABD07 PIC 9(8) COMP-3           GJC0011
   736             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
   737         05  TARJ-CLASE-ABD07           PIC 9(1)  COMP-3.         GJC0011
   738         05  TARJ-FRANQUICIA-ABD07      PIC 9(1)  COMP-3.         GJC0011
   739         05  PROBAB-INCUMP-ABD07        PIC 9(3)  COMP-3.         GJC0011
   740*        05  FILLER                     PIC 9(1)  COMP-3.         GJC0012
   741         05  RAZON-BLOQUEO-ABD07        PIC X(1).                 GJC0012
   742* CONTINUAN LOS CAMPOS QUE YA EXISTIAN ANTES                      GJC0011
   743     03  VALOR-SALDO-DEUDAM-ABD07   PIC 9(7)  COMP-3.              AMPLIA
   744     03  VALOR-DISPONIBLEM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
   745     03  VALOR-SALDO-MORAM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
   746     03  CALIFICACIONM-ABD07        PIC 9     COMP-3.              AMPLIA
   747     03  TIPO-MONEDA-ABD07          PIC 9     COMP-3.              AMPLIA
   748     03  TIPO-OBLIGACION-ABD07      PIC 9     COMP-3.              AMPLIA
   749     03  TIPO-GARANTIA-ABD07        PIC 9     COMP-3.              AMPLIA
   750     03  CUOTAS-CANCELADAS-ABD07    PIC 9(3)  COMP-3.              AMPLIA
   751     03  FECHA-DE-PAGO-ABD07        PIC 9(8)  COMP-3.              AMPLIA
   752     03  TOTAL-CUOTAS-ABD07         PIC 9(3)  COMP-3.              AMPLIA
   753     03  CUOTAS-EN-MORA-ABD07       PIC 9(3)  COMP-3.              AMPLIA
   754     03  SITUACION-ABD07            PIC X.                         AMPLIA
   755     03  FECHA-ACT-END-ABD07        PIC 9(6)  COMP-3.              AMPLIA
   756     03  CAMPOS-NUEVOS-NHC-ABD07 REDEFINES FECHA-ACT-END-ABD07.   GJC0011
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  14
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBCRE.F
   757         05  ESTADO-ORIGEN-ABD07        PIC 9(1)  COMP-3.         GJC0011
   758         05  CAMPOS-TARJETA-ABD07.                                GJC0011
   759             07 TARJ-MARCA-PRIV-ABD07   PIC 9(3)  COMP-3.         GJC0011
   760             07 REAL-CLAUS-PERM-ABD07   PIC 9(3) COMP-3           GJC0011
   761                REDEFINES TARJ-MARCA-PRIV-ABD07. *> MESES CLAUSULAGJC0011
   762         05 SITUACION-TITULAR-ABD07 PIC 9(1)  COMP-3.*> EJ.LIQ    GJC0012
   763     03  CONSECUTIVO-ABD07          PIC 99    COMP-3.              VMATCH
   764     03  FECHA-MORA-MAXIMA-ABD07    PIC 9(6)  COMP-3.              AMPLIA
   765     03  FECHA-ACTUALIZ-VALOR-ABD07 PIC 9(6)  COMP-3.              AMPLIA
   766*    03  FECHA-CARTERA-CASTIG-ABD07 PIC 9(6)  COMP-3.              AMPLIA
   767     03  FECHA-SITUACION-ABD07      PIC 9(6)  COMP-3.              AMPINF7
   768     03  VECTOR-2-ABD07             PIC 9(12) COMP-3.              AMPLIA
   769     03  VECTOR-HIS-2-ABD07         PIC 9(12) COMP-3               JGR0010
   770         REDEFINES                  VECTOR-2-ABD07.     *> AO 2   JGR0010
   771     03  PERIODICIDAD-PAGO-ABD07    PIC 9     COMP-3.              AMPINF5
   772     03  GARANTE-ABD07              PIC 9(2)  COMP-3.              AMPINF5
   773     03  FORMA-PAGO-TOTAL-ABD07     PIC 9     COMP-3.              AMPINF5
   774     03  MOROSIDAD-ABD07            PIC 9(3)  COMP-3.              AMPINF5
   775     03  NOV-REPORT2-ABD07          PIC 9(2).                      AMPINF7
   776     03  VECTOR-2-R-ABD07           PIC 9(12) COMP-3.              GJC0002
   777     03  VECTOR-HIS-4-ABD07         PIC 9(12) COMP-3    *> AO 4   JGR0010
   778         REDEFINES                  VECTOR-2-R-ABD07.              JGR0010
   779
*  780     COPY ICBCHK.FD.
   781* ICBCHK.-FD.v.0009
   782* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO
   783* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES
   784*----------------------------------------------------------------*
   785******************************************************************
   786* VHF0005     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   787* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
   788* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   789* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   790* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   791*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   792*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   793*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   794*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   795******************************************************************
   796* FAC0006     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD06 EN*
   797* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD06 PARA INDICAR *
   798*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   799* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD06 QUE *
   800*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   801******************************************************************
   802* CAV0007     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   803* C. VELASCO  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   804* 04/MAY/2009 *          CREDITO.                                *
   805******************************************************************
   806* CAV0008     * NHC002 - SE CAMBIA FECHA DE NOVEDAD ANTERIOR POR *
   807* C. VELASCO  *          FECHA DE ACTUALIZACION DE VALORES       *
   808* 04/ENE/2010 *                                                  *
   809******************************************************************
   810* GJC0009     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   811* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   812* OCTUBRE/2010*          SON MS DE 10                           *
   813******************************************************************
   814
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  15
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBCHK.F
   815 FD  MAESTRO-CHECK.
   816*    MASTER FILE OF CHECKING ACCOUNTS, TYPE = 2
   817 01  COMPLETO-ABD06.
   818     03  LLAVE-MAES-CHECK.
   819         05  LLAVE-MAES-CHECK-PRI.
   820             07  TIPO-ID-ABD06     PIC 9.
   821             07  NUM-ID-ABD06      PIC 9(11).
   822         05  LLAVE-MAES-CHECK-ALT.
   823             07  COD-SUS-ABD06     PIC 9(6).
   824             07  COD-CTA-ABD06     PIC 99.
   825             07  NUM-CTA-ABD06     PIC X(18).
   826     03  IND-BLOQUEO-ABD06         PIC 9     COMP-3.
   827     03  FECHA-APERT-ABD06         PIC 9(4)  COMP-3.
   828     03  CALIFIC-ABD06             PIC 9     COMP-3.
   829     03  TIP-CALIFIC-ABD06         PIC 9     COMP-3.
   830     03  NOV-REPORT-ABD06          PIC 99    COMP-3.
   831     03  FEC-NOVEDAD-ABD06         PIC 9(4)  COMP-3.
   832     03  NUM-EMBARGO-ABD06         PIC 99    COMP-3.
   833     03  FEC-ULT-EMB-ABD06         PIC 9(4)  COMP-3.
   834     03  ADJETIVO-ABD06            PIC 9     COMP-3.
   835     03  FEC-ADJETIVO-ABD06        PIC 9(4)  COMP-3.
   836     03  ART15-ABD06               PIC 9     COMP-3.
   837     03  IND-MODIFICACION-ABD06    PIC 9     COMP-3               VHF0005
   838         REDEFINES                 ART15-ABD06.                   VHF0005
   839     03  RECLAMO-ABD06             PIC 9(5)  COMP-3.
   840     03  RECLAMO-ABD06-RR          REDEFINES RECLAMO-ABD06        FAC0005
   841                                   PIC 9(3).                      FAC0005
   842     03  RECLAMO-ABD06-R           REDEFINES RECLAMO-ABD06.       VHF0005
   843         05 IND-RECLAMO-ABD06      PIC 9(01).                     VHF0005
   844         05 REG-LOCK-ABD06         PIC 9(01).                     FAC0006
   845         05 FILLER-RECLAMO-ABD06   PIC 9(01).                     FAC0006
   846
   847     03  CONSECUTIVO-ABD06         PIC 99    COMP-3.              VMATCH
   848*    03  FILLER-ABD06              PIC X(8).                      AMPLIA
   849     03  OFICINA-ABD06             PIC X(15).                     AMPINF5
   850     03  CIUDAD-ABD06              PIC X(6).                      AMPINF5
   852     03  FEC-NOVANT-ABD06          PIC 9(4) COMP-3.               FAC0004
   853     03  FECHA-ACTUALIZ-VALOR-ABD06  PIC 9(4) COMP-3              CAV0008
   854         REDEFINES FEC-NOVANT-ABD06.                              CAV0008
   855     03  NOVANT-ABD06              PIC 9(2) COMP-3.               FAC0004
   856*    03  FILLER-ABD06              PIC X(4).                      CAV0007
   857     03  IND-SOBREGIRO-ABD06       PIC 9(1).                      CAV0007
   858     03  COD-EST-TITUL-ABD06       PIC 9(1).                      CAV0007
   859     03  CALIFICACION-ABD06        PIC 9(1).                      CAV0007
   860     03  RAZON-BLOQUEO-ABD06       PIC X(1).                      GJC0009
*  861     COPY ICBDIR0001.FD.
   862* ICBDIR0001-FD.V01.007.
   863* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADAS
   864* POR LOS DIFERENTES SUSCRIPTORES
   865******************************************************************
   866* FAC0002      * AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DEL
   867* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DE
   868* FEB.15/2006  * DATACLIENTES.
   869******************************************************************
   870* VHF0003      * RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *
   871* VICTOR HUGO  *          DIRECCION ESTA CERTIFICADA POR LA      *
   872* FORERO       *          DIVISION DE DOCUMENTOS. TAMBIEN SE     *
   873* JUL.11/2006  *          CREARON CAMPOS QUE INDICAN SI LA       *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  16
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBDIR00
   874*              *          DIRECCION FUE GEOREFERENCIADA.         *
   875******************************************************************
   876* CAV0004      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *
   877* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA   *
   878* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION             *
   879******************************************************************
   880* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *
   881* VICTOR HUGO  *          SE ADICIONAN FECHAS INDEPENDIENTES PARA*
   882* FORERO       *          CADA TIPO DE DATOS DE LOCALIZACION     *
   883* JUL.25/2008  *                                                 *
   884******************************************************************
   885* RMB0006      * DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*
   886* R MARTINEZ   *          S DE RESICENCIA,LABORAL Y CORRESPONDENC*
   887* SEP/07/2011  *          CIA.                                   *
   888******************************************************************
   889* CAV0007      * FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *
   890* C.VELASCO    *          IDENTIFICAR CUANDO ESTABA VACIO Y SE   *
   891* OCT/25/2012  *          ACTUALIZO.                             *
   892******************************************************************
   893 FD  MAESTRO-DIRECC.
   894 01  REG-DIRECC.
   895     03  LLAVE-DIRECC.
   896         05  LLAVE-PRI-DIRECC.
   897             07  TIPO-ID-DIRECC    PIC 9(01).
   898             07  NUM-ID-DIRECC     PIC 9(13).                     FAC0002
   899         05  LLAVE-ALT-DIRECC.
   900             07  COD-SUS-DIRECC    PIC 9(06).
   901             07  COD-CTA-DIRECC    PIC 9(02).
   902             07  NUM-CTA-DIRECC    PIC X(18).
   903     03  FECAPE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   904     03  FECCRE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   905     03  FECACT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   906     03  CIURES-DIRECC             PIC X(20).                     FAC0002
   907     03  DPTRES-DIRECC             PIC X(20).                     FAC0002
   908     03  DIRRES-DIRECC             PIC X(60).                     FAC0002
   909     03  TELRES-DIRECC             PIC 9(12) COMP-3.              FAC0002
   910     03  FECRES-DIRECC             PIC 9(06) COMP-3.              FAC0002
   911     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005
   912     03  CIULAB-DIRECC             PIC X(20).                     FAC0002
   913     03  DPTLAB-DIRECC             PIC X(20).                     FAC0002
   914     03  DIRLAB-DIRECC             PIC X(60).                     FAC0002
   915     03  TELLAB-DIRECC             PIC 9(12) COMP-3.              FAC0002
   916     03  FECLAB-DIRECC             PIC 9(06) COMP-3.              FAC0002
   917     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005
   918     03  CIUCOR-DIRECC             PIC X(20).                     FAC0002
   919     03  DPTCOR-DIRECC             PIC X(20).                     FAC0002
   920     03  DIRCOR-DIRECC             PIC X(60).                     FAC0002
   921     03  FECCOR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   922     03  FECDCOR-DIRECC REDEFINES FECCOR-DIRECC PIC 9(06) COMP-3. VHF0005
   923     03  E-MAIL-DIRECC             PIC X(40).                     FAC0002
   924     03  TELCEL-DIRECC             PIC 9(12) COMP-3.              FAC0002
   925     03  FECOTR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   926     03  FECCEL-DIRECC REDEFINES FECOTR-DIRECC PIC 9(06) COMP-3.  VHF0005
   927     03  FECULT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   928***  LOS POSIBLES VALORES DE LOS SEIS SIGUIENTES CAMPOS SON       VHF0003
   929***  DE ACUERDO AL TIPO DE DIRECCION(RES-RESIDENCIAL, LAB-LABORAL,VHF0003
   930***  COR-CORRESPONDENCIA)                                         VHF0003
   931***     CER???-DIRECC:                                            VHF0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  17
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBDIR00
   932***        0 - DIRECCION NO HA SIDO CERTIFICADA                   VHF0003
   933***        1 - DIRECCION FUE CERTIFICADA EXITOSAMENTE             VHF0003
   934***        2 - DIRECCION CERTIFICADA SIN EXITO                    VHF0003
   935***     ADI???-DIRECC:                                            VHF0003
   936***       00 - DIRECCION NO HA SIDO GEOREFERENCIADA               VHF0003
   937***       01 - DIRECCION FUE GEOREFERENCIADA EXITOSAMENTE         VHF0003
   938***       02 - DIRECCION GEOREFERENCIADA SIN EXITO                VHF0003
   939     03  CERRES-DIRECC             PIC 9(01).                     VHF0003
   940     03  ADIRES-DIRECC             PIC 9(02).                     VHF0003
   941     03  CERLAB-DIRECC             PIC 9(01).                     VHF0003
   942     03  ADILAB-DIRECC             PIC 9(02).                     VHF0003
   943     03  CERCOR-DIRECC             PIC 9(01).                     VHF0003
   944     03  ADICOR-DIRECC             PIC 9(02).                     VHF0003
   945     03  INDCSV-DIRECC             PIC 9(01).                     CAV0004
   946     03  FECTRES-DIRECC            PIC 9(06) COMP-3.              VHF0005
   947     03  FECTLAB-DIRECC            PIC 9(06) COMP-3.              VHF0005
   948     03  FECMAIL-DIRECC            PIC 9(06) COMP-3.              VHF0005
   949*    03  FILLER-DIRECC             PIC X(40).                     VHF0005
   950*    03  FILLER-DIRECC             PIC X(28).                     RMB0006
   951     03  CODDANE-RES-DIRECC        PIC 9(08) COMP-3.              RMB0006
   952     03  CODDANE-LAB-DIRECC        PIC 9(08) COMP-3.              RMB0006
   953     03  CODDANE-COR-DIRECC        PIC 9(08) COMP-3.              RMB0006
   954     03  FLAG-DIRRES-DIRECC        PIC X.                         CAV0007
   955     03  FLAG-TELRES-DIRECC        PIC X.                         CAV0007
   956     03  FLAG-DIRLAB-DIRECC        PIC X.                         CAV0007
   957     03  FLAG-TELLAB-DIRECC        PIC X.                         CAV0007
   958     03  FLAG-DIRCOR-DIRECC        PIC X.                         CAV0007
   959     03  FLAG-CELULAR-DIRECC       PIC X.                         CAV0007
   960     03  FLAG-EMAIL-DIRECC         PIC X.                         CAV0007
   961*    03  FILLER-DIRECC             PIC X(13).                     CAV0007
   962     03  FILLER-DIRECC             PIC X(06).                     CAV0007
*  963     COPY BDACSV.FD.
   964* BDACSV-FD.v.0003
   965* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
   966* DATOS OFICIALES DE REGIS, DIAN Y DAS
   967******************************************************************
   968* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
   969* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
   970* R.MARTINEZ *          POR T7
   971******************************************************************
   972* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
   973* OCT-12-2012*          DE REGISTRADURIA INCOMPLETA DE FUENTE
   974* LUIS GOMEZ *          CONFIABLE
   975******************************************************************
   976 FD  BDACSV.
   977 01  REG-BDACSV.
   978     03 LLAVE-BDACSV.
   979        05  TIPO-ID-BDACSV    PIC 9(01).
   980        05  NUM-ID-BDACSV     PIC 9(15).
   981        05  COD-SUS-BDACSV    PIC 9(06).
   982        05  COD-CTA-BDACSV    PIC 9(02).
   983        05  NUM-CTA-BDACSV    PIC X(25).
   984     03  NOMBRE-BDACSV        PIC X(45).
   985     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.                 STT0003
   986        05 APELLIDO1-BDACSV      PIC X(16).                       STT0003
   987        05 APELLIDO2-BDACSV      PIC X(16).                       STT0003
   988        05 DES-NOMBRE1-BDACSV    PIC X(12).                       STT0003
   989     05  IND-UNIFICADO-BDACSV    PIC 9(01).                       STT0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  18
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDACSV.F
   990     03  FECHA-CREA-BDACSV       PIC 9(08).
   991     03  NUM-PORTAF-BDACSV    PIC 9(02).
   992     03  IND-NOMBRE-BDACSV    PIC 9(02).
   993     03  MEJOR-PORTAF-BDACSV  PIC 9(02).
   994     03  IND-ACTUALIZ-BDACSV  PIC 9(02).
   995     03  FUENTE-REG-BDACSV    PIC 9(02).
   996     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADO           RMB0002
   997     03  TIPO7-6-BDACSV       PIC X(01). *> 5=T6,1=T7             RMB0002
   998*    03  FILLER               PIC X(50).                          STT0003
   999     03  CAMPOS-REGISTRADURIA-BDACSV.                             STT0003
  1000         05  DES-NOMBRE2-BDACSV    PIC X(12).                     STT0003
  1001         05  FECHA-EXPEDI-BDACSV   PIC 9(8).                      STT0003
  1002         05  DEP-EXP-BDACSV        PIC 9(02).                     STT0003
  1003         05  MUNIC-EXP-BDACSV      PIC 9(03).                     STT0003
  1004         05  ESTADO-VIG-BDACSV     PIC 9(02).                     STT0003
  1005         05  FECHA-NACIMNTO-BDACSV PIC 9(08).                     STT0003
  1006         05  IND-SEXO-BDACSV       PIC X.                         STT0003
  1007         05  IND-ESTADO-BDACSV     PIC 9.                         STT0003
  1008         05  IND-CONSULADO-BDACSV  PIC 9(1).                      STT0003
  1009         05  COD-CONSULADO-BDACSV  PIC 9(3).                      STT0003
  1010     03  FILLER                    PIC X(07).                     STT0003
  1011*    03  FILLER               PIC X(48).
  1012
  1013
  1014
* 1015     COPY ICBCON001.FD.
  1016* ICBCON-FD.0007
  1017* ARCHIVO QUE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
  1018* TIPO 5
  1019*******************************************************************
  1020* RMB003       * FENA001: PARA LAS CONSULTAS REPETIDAS (MISMO DIA *
  1021* R.MARTINEZ.  * SUSCRIPTOR, CLAVE) SE DEJA UN SOLA CONSULTA Y LA *
  1022* JULIO 30/2001* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
  1023*              * NUM-CONS-IND.                                    *
  1024*----------------------------------------------------------------**
  1025* RMB003       * SCR002: PARA MANEJO DE PREFILTRO SE REDEFINEN    *
  1026* R.MARTINEZ.  * CAMPOS.                                          *
  1027* AGOS. 30/2002* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
  1028*----------------------------------------------------------------**
  1029* GJC0004      * AMPLI1: AMPLIACION DEL ARCHIVO DE CONSULTA DE    *
  1030* G.JIMENEZ.   * 50 A 123 POSICIONES, SE AMPLIA CON FILLER DE 50  *
  1031* ENE.03/2003  * CARACTERES.                                      *
  1032* FAC0004      * INCLUSION DE NUEVOS CAMPOS                       *
  1033* ENE.22/2003  *                                                  *
  1034*----------------------------------------------------------------**
  1035* RMB0005      * T7T5V2: SE INCLUYE APELLIDO USADO EN LA CONSULTA *
  1036* R.MARTINEZ.  *         PARA MANEJO DE T7 QUE SE CONVIERTE EN T5 *
  1037* AGOS. 30/2007*         DUANDO TIENE UNA HUELLA DE CONSULTA      *
  1038*----------------------------------------------------------------**
  1039* ABB0006      * NHDC01: SE INCLUYE MARCA PARA IDENTIFICAR SI LA  *
  1040* ALBEIRO B.   *         CONSULTA ES DE HC+                       *
  1041* JUNIO 2010   *         NHDC-IND=S,N                             *
  1042*----------------------------------------------------------------**
  1043* CAV0007      * PRO001: MANEJO DE PRODUCTO ALFANUMERICAMENTE,    *
  1044* C.VELASCO.   *         REDEFINEN CAMPOS A PIC X.                *
  1045* JULIO 2013   *                                                  *
  1046*----------------------------------------------------------------**
  1047 FD  INDEXADO.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  19
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBCON00
  1048*    FILE OF SUCCESSFUL INQUIRIES, FOR BILLING AND SUSPICIOUS
  1049*    NUMBER OF CREDIT INQUIRIES
  1050 01  REG-INDEX.
  1051     03  COD-SUSCRIP-IND         PIC 9(6).
  1052     03  FEC-CONSUL-IND          PIC 9(6).
  1053     03  LLAVE-INDEX.
  1054         05  TIP-ID-IND          PIC 9.
  1055         05  NUM-ID-IND          PIC 9(11).
  1056         05  CONSECUTIVO-IND     PIC 9(2).
  1057*    SCORES 0=score10,1-9= SCORE1-9
  1058     03  SCO-PRE-INDEX           PIC 9.
  1059     03  CIUDAD-CONS-IND         PIC 9(2).
  1060     03  OFICINA-CONS-IND        PIC X(15).
  1061     03  NUM-CONS-IND            PIC 99.                           RMB003
  1062     03  FILLER-INDEX.
  1063         05 PRE-SCORE-INDEX      PIC X VALUE SPACES.
  1064         05 PUN-SCORE-INDEX      PIC S9(05) COMP-3.
  1065     03  RAZCON-IND              PIC 99.                          GJC0004
  1066     03  TIP-SCORE-IND           PIC 9(3).                        FAC0004
  1067     03  TIPO-SCORE-IND-R REDEFINES TIP-SCORE-IND.                CAV0007
  1068         05 FILLER               PIC X(01).                       CAV0007
  1069         05 TIP-SCORE-IND-R      PIC X(02).                       CAV0007
  1070     03  CLASIFICA-IND           PIC X(2).                        FAC0004
  1071     03  CALIFICA-IND            PIC S9(3)V99.                    FAC0004
  1072     03  CLAVE-IND               PIC X(5).                        FAC0004
  1073     03  CONTADOR-IND            PIC 9(3).                        FAC0004
  1074     03  APELLIDO-IND            PIC X(15).                       RMB0005
  1075     03  NHDC-IND                PIC X(01).                       ABB0006
  1076     03  FILLER-1-INDEX          PIC X(34).                       ABB0006
* 1077     COPY BDIIREGI.FD.
  1078* BDIIREGI.v.03.0006
  1079*=================================================================
  1080* ESTRUCTURA DEL ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
  1081*=================================================================
  1082* GJC0002   * BLQTUT * CAMPO PARA MARCAR LAS IDENDIFICACIONES
  1083* G.JIMENEZ * QUE HAN SIDO BLOQUEADAS POR TUTELAS PERDIDAS
  1084* SEPT.18/03*
  1085******************************************************************
  1086* FAC0003   * FECMOD * FECHA DE CREACION Y DE MODIFICACION DE LAS
  1087* F.CUADROS * IDENTIFICACIONES. ADEMAS INCLUSION DE INDICADOR CON
  1088* SEPT.16/05* LA FUENTE: A-ARCHIVO REGIS, C-COMUNICACION ESCRITA
  1089*           * REGISTRADURIA, S-SOLICITUD INTERNA CAS.
  1090******************************************************************
  1091* GJC0004   * INDMOD * SE CREA CAMPO PARA DEJAR INDICADOR DE MOFI-
  1092* F.CUADROS * FICACIONES, QUEDA IGUAL QUE EN EL OTRO INDICADOR
  1093* ENERO/2007* LA FUENTE: A-ARCHIVO REGIS, C-COMUNICACION ESCRITA
  1094*           * REGISTRADURIA, S-SOLICITUD INTERNA CAS T-TERCERO.
  1095******************************************************************
  1096* CAV0005   *CONSUL * SE ADICIONAN LOS CAMPOS PARA IDENTIFICAR
  1097* C.VELASCO *QUE LA CEDULA CORRESPONDE A UN CONSULADO Y EL CODIGO
  1098* ABRIL/2007*DEL CONSULADO ,ARCHIVO CONSULADOS.DAT, PAIS Y CIUDAD
  1099******************************************************************
  1100* CAV0006   *INDE01 * SE ADICIONAN LOS CAMPOS PARA IDENTIFICAR
  1101* C.VELASCO *         SI EL REGISTRO CORRESPONDE A INDEPENDIENTE
  1102* SEPTI/2013*         DE CAMARA C O BURO. (INDEPTES CON TIPO ID 9)
  1103*                     SE MARCA CAMPO IND-CREACION-BDIIREGI = "I"
  1104******************************************************************
  1105 FD  BDIIREGI.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  20
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIREGI
  1106 01  REG-BDIIREGI.
  1107     03  LLAVE-BDIIREGI          PIC 9(12).
  1108     03  LLAVE-BDIIREGI-R        REDEFINES LLAVE-BDIIREGI.
  1109         05  TIPO-ID-BDIIREGI    PIC 9.
  1110         05  CEDULA-BDIIREGI     PIC 9(11).
  1111     03  DES-NOMBRE1-BDIIREGI    PIC X(12).
  1112     03  DES-NOMBRE2-BDIIREGI    PIC X(12).
  1113     03  APELLIDO1-BDIIREGI      PIC X(16).
  1114     03  APELLIDO2-BDIIREGI      PIC X(16).
  1115     03  ESTADO-CIVIL-BDIIREGI   PIC 9.
  1116     03  FECHA-EXPEDI-BDIIREGI.
  1117         05  SIGLO-EXP-BDIIREGI  PIC 9(2).
  1118         05  FECHA-EXP-BDIIREGI  PIC 9(6).
  1119     03  INF-NUMERICA-BDIIREGI   PIC 9(7).
  1120     03  INF-NUMERICA-BDIIREGI-R REDEFINES INF-NUMERICA-BDIIREGI.
  1121         05 DEP-EXP-BDIIREGI     PIC 99.
  1122         05 MUNIC-EXP-BDIIREGI   PIC 999.
  1123         05 ESTADO-VIG-BDIIREGI  PIC 99.
  1124     03  FECHA-NACIMNTO-BDIIREGI.
  1125         05  SIGLO-NAC-BDIIREGI  PIC 9(2).
  1126         05  FECHA-NAC-BDIIREGI  PIC 9(6).
  1127     03  FECHA-EDICTO-BDIIREGI.
  1128         05  SIGLO-EDI-BDIIREGI  PIC 9(2).
  1129         05  FECHA-EDI-BDIIREGI  PIC 9(6).
  1130     03  IND-SEXO-BDIIREGI       PIC X.
  1131     03  IND-ESTADO-BDIIREGI     PIC 9.
  1132     03  NUM-RESOLUC-BDIIREGI    PIC 9(4).
  1133     03  ANO-RESOLUC-BDIIREGI    PIC 9(2).
  1134     03  BLOQUEO-TUTELA-BDIIREGI PIC X(1).                        GJC0002
  1135     03  FECHA-CREAC-BDIIREGI    PIC 9(8).                        FAC0003
  1136     03  FECHA-MODIF-BDIIREGI    PIC 9(8).                        FAC0003
  1137     03  IND-MODIF-BDIIREGI      PIC X(1).                        FAC0003
  1138     03  IND-CREACION-BDIIREGI REDEFINES                          GJC0004
  1139              IND-MODIF-BDIIREGI PIC X(1).                        GJC0004
  1140     03  IND-CAMBIO-BDIIREGI     PIC X(1).                        GJC0004
  1141     03  IND-CONSULADO-BDIIREGI  PIC 9(1).                        CAV0005
  1142     03  COD-CONSULADO-BDIIREGI  PIC 9(3).                        CAV0005
  1143     03  ES-IND-CAMARA-BDIIREGI  PIC 9(1).                        CAV0006
  1144     03  ES-IND-BURO-BDIIREGI    PIC 9(1).                        CAV0006
  1145     03  FILLER-BDIIREGI         PIC X(27).                       CAV0006
  1146*----------------------------------------------------------------*
* 1147     COPY BDIIDIAN.FD.
  1148* BDIIDIAN.v.03.0004
  1149*==================================================================
  1150* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADAS
  1151* POR LA DIAN
  1152*==================================================================
  1153* FAC0002 * INCIIU* INCLUSION DE CODIGO DE ACTIVIDAD ECONOMICA- CIIU
  1154* JUL.17/2003 * Y FECHA DE INSCRIPCION
  1155*==================================================================
  1156* CAV0003 * INDMOD* INCLUSION DE FECHA-CREACION,FECHA-MODIFCACION E
  1157* C. VELASCO  * INDICADOR MODIFICACION: A-ARCHIVO DIAN,
  1158* OCT/25/2007 * C-COMUNICACION DIAN, S-SOLICTUD CAS.
  1159*==================================================================
  1160* RMB0004     * INDE01* INCLUSION DE MARCAS PARA :
  1161* R.MARTINEZ  *       A)  ES CLIENTE DE EXPERIAN-DATACREDITO
  1162* SEP/20/2013 *       B)  CLIENTE QUE VERA A LOS INDEPENDIENTES
  1163* C.VELASCO.  *       SE CREA CAMPO FECHA-MODIF-INDE-BDIIDIAN
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  21
* )S))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIDIAN
  1164*==================================================================
  1165 FD  BDIIDIAN.
  1166 01  REG-BDIIDIAN.
  1167     03 LLAVE-BDIIDIAN.
  1168        05 NITS-BDIIDIAN            PIC X(11).
  1169        05 NITS-R-BDIIDIAN REDEFINES NITS-BDIIDIAN
  1170                                    PIC 9(11).
  1171     03 DIGITO-CONTROL-BDIIDIAN     PIC X(01).
  1172     03 DESCRIPCION1-BDIIDIAN       PIC X(80).
  1173     03 DESCRIPCION1-BDIIDIAN-R REDEFINES DESCRIPCION1-BDIIDIAN.
  1174        05 DESCRIPCION-BDIIDIAN     PIC X(79).
  1175        05 ESTADO-BDIIDIAN          PIC 9.
  1176     03 COD-CIIU-BDIIDIAN           PIC 9(4).                     FAC0002
  1177     03 FEC-INSCRIP-BDIIDIAN        PIC 9(8).                     FAC0002
  1178     03 FECHA-CREAC-BDIIDIAN        PIC 9(8).                     CAV0003
  1179     03 FECHA-MODIF-BDIIDIAN        PIC 9(8).                     CAV0003
  1180     03 IND-MODIF-BDIIDIAN          PIC X(1).                     CAV0003
  1181     03 ES-CLIENTE-DATACR-BDIIDIAN  PIC X(1). *> S,N              RMB0004
  1182     03 VE-INDEPENDIENTES-BDIIDIAN  PIC X(1). *> S,N              RMB0004
  1183     03 FECHA-MODIF-INDE-BDIIDIAN   PIC 9(04). *> AAMM            CAV0004
  1184*    03 FILLER-BDIIDIAN             PIC X(19).                    RMB0004
  1185     03 FILLER-BDIIDIAN             PIC X(13).                    CAV0004
* 1186     COPY BDIIDAS.FD.
  1187* BDIIDAS.v.03.0002
  1188*====================================================================
  1189* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA SUMINISTRADAS POR EL DAS
  1190*====================================================================
  1191* CAV0002 * INDMOD* INCLUSION DE FECHA-CREACION FECHA MODIFCACION E
  1192* C. VELASCO  * INDICADOR MODIFICACION, A-ARCHIVO DAS,
  1193* OCT/25/2007 * C-COMUNICACION DAS, S-SOLICTUD CAS.
  1194*==================================================================
  1195 FD  BDIIDAS.
  1196 01  REG-BDIIDAS.
  1197     03 LLAVE-BDIIDAS.
  1198        05 TIPO-ID-BDIIDAS           PIC 9.
  1199        05 NUM-ID-BDIIDAS            PIC 9(11).
  1200     03 NACIO-BDIIDAS                PIC X(15).
  1201     03 NOMBRE-BDIIDAS               PIC X(45).
  1202     03 FECHA-CREAC-BDIIDAS          PIC 9(8).                    CAV0002
  1203     03 FECHA-MODIF-BDIIDAS          PIC 9(8).                    CAV0002
  1204     03 IND-MODIF-BDIIDAS            PIC X(1).                    CAV0002
  1205     03 FILLER-BDIIDAS               PIC X(31).                   CAV0002
* 1206     COPY ICSALMIN.FD.
  1207* ICSALMIN.FD.v.01.001
  1208* MAESTRO DE SALARIOS MINIMOS LEGALES  FECHA(YYYY)
  1209******************************************************************
  1210 FD  ICSALMIN.
  1211 01  COMPLETO-ICSALMIN.
  1212     03  FECHA-ICSALMIN        PIC 9(4).
  1213     03  VALOR-ICSALMIN        PIC 9(8).
* 1214     COPY BDIIALE-PLANO.FD.
  1215* BDIIALE-PLANO.FD.v.01.001
  1216* MAESTROS DE GRUPOS,ALERTAS Y RELACIONES
  1217******************************************************************
  1218 FD  BDIIALE-PLANO.
  1219 01 REG-BDIIALE-PLANO                    PIC X(1000).
  1220*ADICIONALES DE DIRECCIONES
* 1221     COPY BDLSTDCIU.FD.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  22
* .FD)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLSTDCI
  1222* BDLSTDCIU-FD.v.0002
  1223******************************************************************
  1224* ESTRUCTURA DE ARCHIVO DE ACEPCIONES DE CIUDADES.               *
  1225******************************************************************
  1226******************************************************************
  1227* RGH0002       * MOD002 - INCLUIR CAMPOS EN EL FILLER           *
  1228* R. GALVIS H.  *          ACTIVO                                *
  1229* ENE. 01/2010  *          ULTFEC                                *
  1230* INTERSCHEMES. *          ULTUSR                                *
  1231******************************************************************
  1232 FD BDLSTDCIU.
  1233 01 REG-BDLSTDCIU.
  1234    02 LLAVE-BDLSTDCIU   PIC X(30).
  1235    02 CIUDAD-BDLSTDCIU  PIC X(30).
  1236    02 CODIGO-BDLSTDCIU  PIC 9(08).
  1237*   02 FILLER            PIC X(30).                               RGH0002
  1238    02 ACTIVO-BDLSTDCIU  PIC X(01).                               RGH0002
  1239    02 ULTFEC-BDLSTDCIU  PIC X(08).                               RGH0002
  1240    02 ULTUSR-BDLSTDCIU  PIC X(08).                               RGH0002
  1241    02 FILLER            PIC X(13).                               RGH0002
* 1242     COPY BDLNEWDIRBOG.FD.
  1245 FD BDLNEWDIRBOG.
  1246 01 REG-BDLNEWDIRBOG.
  1247    02 LLAVE-BDLNEWDIRBOG.
  1248       03 AVENIDA-BDLNEWDIRBOG         PIC X(02).
  1249       03 NUMEROS-BDLNEWDIRBOG.
  1250          04 CODIGO-BDLNEWDIRBOG OCCURS 10 TIMES.
  1251             05 NUMCOD-BDLNEWDIRBOG    PIC 9(05).
  1252    02 DIRORI-BDLNEWDIRBOG             PIC X(60).
  1253    02 DIRNEW-BDLNEWDIRBOG             PIC X(60).
* 1254     COPY DIREST.FD.
  1255*DIREST-FD.v.0002
  1256******************************************************************
  1257* ARCHIVO DE ESTANDARIZACION DE DIRECCIONES                      *
  1258******************************************************************
  1259* RMB0002   * AMPL01 : SE AMPLIO LA ESTRUCTURA PARA ADMITIR CO-  *
  1260* SEPT/2006 *          MENTARIOS Y FECHAS DE ACTULIZACION        *
  1261******************************************************************
  1262 FD  DIREST.
  1263 01  REG-DIREST.
  1264     03  DIR-ORIG-DIREST         PIC X(20).
  1265     03  DIR-ESTAN-DIREST        PIC X(10).
  1266     03  FILLER                  PIC X(100).                      RMB0002
* 1267     COPY BDLCLI.FD.
  1268*BDLCLI-FD.v.00003
  1269*ARCHIVO DE CLIENTES DE BASE DE DATOS LOCALIZACION CON INDICADOR Y
  1270*PRIVILEGIO ACTUALIZADOS.
  1271*INDICADOR : 0 = NO AUTORIZADO    1 = SI AUTORIZADO
  1272*PRIVILEGIO: 1 = LOS AUTORIZADOS  2 = TODAS LAS DIRECCIONES
  1273************************************************************
  1274*NDG0002    * INF-CR  : INDICADOR SI EL SUSCRIPTOR ENTREGA *
  1275*N.DUARTE   *           INFORMACION CREDITICIA             *
  1276*FEB/2003   *             0 - NO ENTREGA INFORMACION       *
  1277*           *             1 - SI ENTREGA INFORMACION       *
  1278*           * VALDB   : INDICADOR PARA VALIDAR LA BASE DE  *
  1279*           *           DATOS CUANDO GENERE EL REPORTE     *
  1280*           *             S - SI VALIDA CONTRA BASE DATOS  *
  1281*           *             N - NO VALIDA CONTRA BASE DATOS  *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  23
* FD))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLCLI.F
  1282*           *                                              *
  1283************************************************************
  1284*RMB0003    * BLOQ01  : INDICADOR PARA BLOQUEAR LA INFORMA *
  1285*R.MARTINEZ *           CION DE UN NIT                     *
  1286*OCT-1-2011 *           "B" = INFORMACION BLOQUEADA        *
  1287************************************************************
  1288 FD  BDLCLI.
  1289 01  COMPLETO-BDLCLI.
  1290     03  LLAVE-BDLCLI.
  1291         05  NIT-ID-BDLCLI           PIC 9(11).
  1292     03  INDICADOR-BDLCLI            PIC 9(01).
  1293     03  PRIVILEGIO-BDLCLI           PIC 9(01).
  1294     03  INF-CREDITICIA-BDLCLI       PIC 9(01).                    NDG0002
  1295     03  VALIDAR-DB-BDLCLI           PIC X(01).                    NDG0002
  1296     03  IND-BLOQUEO-INF-BDLCLI      PIC X(01).  *> B=BLOQUEADA    RMB0003
  1297*    03  FILLER                      PIC X(98).                    RMB0003
  1298     03  FILLER                      PIC X(97).                    RMB0003
  1299*ADICIONALES DE DIRECCIONES +
* 1300     COPY BDLDIRESTR.FD.
  1301* BDLDIRESTR.v.01.0000
  1302*================================================================*
  1303* ARCHIVO MAESTRO CON INFORMACION DE ESTRATO                     *
  1304*================================================================*
  1305* ARCHIVO INDEXADO DESTINADO PARA EL MANEJO DE ESTRATO           *
  1306* SOCIOECONOMICO                                                 *
  1307*================================================================*
  1308 FD BDLDIRESTR.
  1309 01 REG-BDLDIRESTR.
  1310   03 LLAVE-BDLDIRESTR.
  1311     05 CIUDAD-BDLDIRESTR                 PIC X(20).
  1312     05 DIRECC-BDLDIRESTR                 PIC X(60).
  1313     05 DANE-BDLDIRESTR                   PIC 9(08).
  1314   03 DATOS-BDLDIRESTR.
  1315     05 CODDANE-BDLDIRESTR                PIC X(08).
  1316     05 ESTR-BDLDIRESTR                   PIC X.
  1317     05 CUIEST-BDLDIRESTR                 PIC X(20).
  1318     05 DEPEST-BDLDIRESTR                 PIC X(20).
  1319     05 DIREST-BDLDIRESTR                 PIC X(60).
  1320     05 PRBENT-BDLDIRESTR                 PIC X(03).
  1321     05 IND-GST-BDLDIRESTR                PIC X(03).
  1322     05 IND-DIRENC-BDLDIRESTR             PIC X(03).
* 1323     COPY ICBDIM.FD.
  1324* ICBDIM.v.01.0001.0001
  1325*=================================================================
  1326* ESTRUCTURA DEL ARCHIVO DE CARGA CONSUMIDORES Y DATACAS
  1327*=================================================================
  1328*
  1329*================================================================*=
  1330 FD  ICBDIM.
  1331 01  REG-ICBDIM.
  1332     03 LLAVE-ICBDIM.
  1333        05 TIPO-IDEN-ICBDIM         PIC 9(01).
  1334        05 NUM-ID-ICBDIM            PIC 9(11).
  1335        05 ORIGEN-ICBDIM            PIC 9(01).
  1336     03 E-MAIL-ICBDIM               PIC X(40).
  1337     03 TEL-CEL-ICBDIM              PIC 9(12).
  1338     03 FECHA-APERT-ICBDIM.
  1339        05 A-FAPE-ICBDIM            PIC 9(04).
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  24
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICBDIM.F
  1340        05 M-FAPE-ICBDIM            PIC 9(02).
  1341        05 D-FAPE-ICBDIM            PIC 9(02).
  1342     03 FECHA-ACT-ICBDIM.
  1343        05 A-ACT-ICBDIM             PIC 9(04).
  1344        05 M-ACT-ICBDIM             PIC 9(02).
  1345        05 D-ACT-ICBDIM             PIC 9(02).
* 1346     COPY DUPCIUDAD.FD.
  1348*TABLA DE CIUDADES QUE SE REPITEN
  1349 FD  DUPCIUDAD.
  1350  01 REG-DUPCIUDAD               PIC X(20).
* 1351     COPY BDLDIRACE.FD.
  1352*BDLDIRACE-FD.v.0000
  1353******************************************************************
  1354* ARCHIVO DE ACEPCIONES DE DIRECCIONES                      *
  1355******************************************************************
  1356*
  1357******************************************************************
  1358 FD  BDLDIRACE.
  1359 01  REG-BDLDIRACE.
  1360     03  LLAVE-BDLDIRACE.
  1361         05  DIR-ORIG-BDLDIRACE     PIC X(20).
  1362     03  DIR-ESTAN-BDLDIRACE        PIC X(10).
  1363     03  FILLER                     PIC X(100).
* 1364     COPY BDLMAIEXC.FD.
  1365*BDLMAIEXC-FD.v.0001
  1366******************************************************************
  1367* ARCHIVO DE EXCLUSIONES PARA MAILS                              *
  1368******************************************************************
  1369*
  1370******************************************************************
  1371******************************************************************
  1372* RGH0001       * MOD001 - ESTANDARIZACION NOMBRE DE VARIABLES   *
  1373* R. GALVIS H.  *          CON SUFIJO                            *
  1374* ENE. 01/2010  *                                                *
  1375* INTERSCHEMES. *                                                *
  1376******************************************************************
  1377 FD  BDLMAIEXC.
  1378 01  REG-BDLMAIEXC.
  1379     03  LLAVE-BDLMAIEXC.
  1380*        05  MAIL-EXCLU              PIC X(60).                   RGH0001
  1381         05  MAIL-EXCLU-BDLMAIEXC    PIC X(60).
  1382
* 1383     COPY BDLTELEXC.FD.
  1384*BDLTELEXC-FD.v.0001
  1385******************************************************************
  1386* ARCHIVO DE EXCLUSIONES DE TELEFONOS                            *
  1387******************************************************************
  1388*
  1389******************************************************************
  1390******************************************************************
  1391* RGH0001       * MOD001 - ESTANDARIZACION NOMBRE DE VARIABLES   *
  1392* R. GALVIS H.  *          CON SUFIJO                            *
  1393* ENE. 01/2010  *                                                *
  1394* INTERSCHEMES. *                                                *
  1395******************************************************************
  1396
  1397 FD  BDLTELEXC.
  1398 01  REG-BDLTELEXC.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  25
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLTELEX
  1399     03  LLAVE-BDLTELEXC.
  1400*        05  TEL-EXCLU              PIC X(12).                    RGH0001
  1401         05  TEL-EXCLU-BDLTELEXC    PIC X(12).
  1402
* 1403     COPY BDLSTDMAI.FD.
  1404* BDLSTDMAI-FD.v.0001
  1405******************************************************************
  1406* ESTRUCTURA DE ARCHIVO DE ACEPCIONES DE EMAILS                  *
  1407******************************************************************
  1408 FD  BDLSTDMAI.
  1409 01  REG-BDLSTDMAI.
  1410     02 LLAVE-BDLSTDMAI   PIC X(30).
  1411     02 DOMINIO-BDLSTDMAI PIC X(30).
  1412     02 ACTIVA-BDLSTDMAI  PIC X(01). *>A=ACTIVA,N=INACTIVA
  1413     02 FECCRE-BDLSTDMAI  PIC X(08).
  1414     02 FECMOD-BDLSTDMAI  PIC X(08).
  1415     02 FILLER            PIC X(23).
  1416
  1417* ******************************************************* *
  1418 WORKING-STORAGE SECTION.
  1419* ******************************************************* *
* 1420 COPY BDIIALEDB2.WS.
  1421* BDIIALE-WS.v02.0001
  1422* VARIABLES RELACIONADAS CON EL MOTOR DE ALERTAS DEL SISTEMA
  1423* CON LA NUEVA VERSION 2
  1424******************************************************************
  1425 01 PARAMETROS-INPUT-BDIIALE.
  1426    02 TIPIDE-INPUT-BDIIALE            PIC 9.
  1427    02 NUMIDE-INPUT-BDIIALE            PIC 9(11).
  1428    02 PRODUC-INPUT-BDIIALE.                    *> PRODUCTO ICBPRO
  1429       03 V-PRODUC-INPUT-BDIIALE OCCURS 21 TIMES PIC XX.
  1430    02 MOSTRAR-BBVA-INPUT-BDIIALE      PIC 9(1). *>0=NO,1=SI
  1431    02 ES-INDEPENDIENTE-INPUT-BDIIALE  PIC 9(1). *>0=NO,1=SI
  1432    02 APELLIDO-INPUT-BDIIALE          PIC X(15).
  1433    02 PROD-HC-INPUT-BDIIALE           PIC X(02). *> PRODUCTO HC
  1434    02 LOG-INPUT-BDIIALE               PIC 9(01)  *> 0=NO,1=SI
  1435                                       VALUE 0.
  1436 01 PARAMETROS-OUTPUT-BDIIALE.
  1437    02 MX-ALE-OUTPUT-BDIIALE.
  1438       03 V-ALE-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC X(4).
  1439       03 V-NFU-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC X(14).
  1440       03 V-DE1-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC X(50).
  1441       03 V-DE2-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC X(50).
  1442       03 V-HOS-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC X(18).
  1443    02 MN-ALE-OUTPUT-BDIIALE.
  1444       03 V-FUE-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC 9(6).
  1445       03 V-FEC-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC 9(8).
  1446       03 V-FVN-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC 9(8).
  1447       03 V-FMD-OUTPUT-BDIIALE  OCCURS 101 TIMES PIC 9(8).
  1448 01 M-GRU-DEFAULT-BDIIALE.
  1449       03 V-GRU-DEFAULT-BDIIALE  OCCURS 21 TIMES  PIC X(4).
  1450 01 M-PRO-DEFAULT-BDIIALE.
  1451       03 V-PRO-DEFAULT-BDIIALE  OCCURS 21 TIMES  PIC X(2).
  1452 01 M-COB-DEFAULT-BDIIALE.
  1453       03 V-COB-DEFAULT-BDIIALE  OCCURS 21 TIMES  PIC X(3).
  1454 01 MATRIZ-GRUCLA-BDIIALE.
  1455    02 M-GRU-GRUCLA-BDIIALE.
  1456       03 V-GRU-GRUCLA-BDIIALE     OCCURS 21 TIMES  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  26
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  1457    02 M-PRO-GRUCLA-BDIIALE.
  1458       03 V-PRO-GRUCLA-BDIIALE     OCCURS 21 TIMES  PIC X(2).
  1459    02 M-HUBOALE-GRUCLA-BDIIALE.
  1460       03 V-HUBOALE-GRUCLA-BDIIALE OCCURS 21 TIMES  PIC 9(3).
  1461    02 M-CUALALE-GRUCLA-BDIIALE.
  1462       03 V-CUAL-GRUCLA-BDIIALE OCCURS 21 TIMES.
  1463          04 V-CUALALE-GRUCLA-BDIIALE OCCURS 10 TIMES  PIC X(4).
  1464    02 M-COB-GRUCLA-BDIIALE.
  1465       03 V-COB-GRUCLA-BDIIALE     OCCURS 21 TIMES  PIC X(3).
  1466**********************************************************************
  1467* ESTRUCTURAS DE DATOS DONDE SE CARGA LA INFORMACION DB2
  1468**********************************************************************
  1469 01 M-GRUPOS-BDIIALE.
  1470    02 FILLER OCCURS   21 TIMES.
  1471       03 V-GRU-GRUPOS-BDIIALE           PIC X(04). *>GRUPO
  1472       03 V-NOM-GRUPOS-BDIIALE           PIC X(50). *>NOMBRE
  1473       03 V-COB-GRUPOS-BDIIALE           PIC X(03). *>TIPO:COB,NCO,LEY
  1474       03 V-PRO-GRUPOS-BDIIALE           PIC X(2).  *>PRODUCTO
  1475 01 M-ALEGRU-BDIIALE.
  1476    02 FILLER OCCURS 1001 TIMES.
  1477       03 V-ALE-ALEGRU-BDIIALE           PIC X(4). *>CODIGO ALERTA
  1478       03 V-GRU-ALEGRU-BDIIALE           PIC X(4). *>GRUPO  ALERTA
  1479       03 V-APUALE-ALEGRU-BDIIALE        PIC 9(4).
  1480 01 M-ALERTAS-BDIIALE.
  1481    02 FILLER OCCURS 1001 TIMES.
  1482       03 V-ALE-ALERTAS-BDIIALE          PIC X(04). *>CODIGO DE ALERTA
  1483       03 V-OPC-ALERTAS-BDIIALE          PIC 9(02). *>SUB TIPO DE LA ALERT
  1484       03 V-TIP-ALERTAS-BDIIALE          PIC X(01). *>C=CALCU,P=PRECALCU
  1485       03 V-ESG-ALERTAS-BDIIALE          PIC X(01). *>DEFAULT:S=SI,N=NO
  1486       03 V-FUE-ALERTAS-BDIIALE          PIC 9(06). *>FUENTE DE ALERTA
  1487       03 V-NOM-ALERTAS-BDIIALE          PIC X(20). *>NOMBRE(RUTINA)
  1488       03 V-DE1-ALERTAS-BDIIALE          PIC X(50). *>DESCRIPCION 1
  1489       03 V-DE2-ALERTAS-BDIIALE          PIC X(50). *>DESCRIPCION 2
  1490    02 M-FLAG-ALERTAS-BDIIALE.
  1491       03 V-FLAG-ALERTAS-BDIIALE OCCURS 1001 TIMES PIC 9(1).
  1492******************************************************************
  1493 01 TITLES-BDIIALE.
  1494    02 MAES-BDIIALE-TITLE        PIC X(20)
  1495                             VALUE "$DATABASE/BDIIALE".
  1496    02 LOG-BDIIALE-TITLE.
  1497       03 FILLER                 PIC X(22)
  1498                             VALUE "$DATABASE/BDIIALE-LOG-".
  1499       03 FECHA-LOG-BDIIALE-TITLE   PIC 9(8) VALUE 0.
  1500 01 REG-LOG-BDIIALE.
  1501    02 TIPIDE-LOG-BDIIALE                  PIC 9(01).
  1502    02 NUMIDE-LOG-BDIIALE                  PIC 9(11).
  1503    02 FECHA-LOG-BDIIALE                   PIC 9(14).
  1504    02 PRODUCTO-LOG-BDIIALE                PIC X(02).
  1505    02 INF-LOG-BDIIALE                     PIC X(500).
  1506*******************************************************************
  1507 01 INDICES-BDIIALE.
  1508    02 A-BDIIALE                         PIC 9(5) VALUE 0.
  1509    02 I-BDIIALE                         PIC 9(5) VALUE 0.
  1510    02 J-BDIIALE                         PIC 9(5) VALUE 0.
  1511    02 K-BDIIALE                         PIC 9(5) VALUE 0.
  1512    02 L-BDIIALE                         PIC 9(5) VALUE 0.
  1513    02 W-BDIIALE                         PIC 9(5) VALUE 0.
  1514    02 Z-BDIIALE                         PIC 9(5) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  27
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  1515    02 DIR-BDIIALE                       PIC 9(5) VALUE 0.
  1516    02 RELLENO-BDIIALE                   PIC X(24) VALUE SPACES.
  1517    02 MESES-BDIIALE                     PIC 9(5) VALUE 0.
  1518    02 DIAS-BDIIALE                      PIC 9(5) VALUE 0.
  1519    02 SMLMV-BDIIALE                     PIC 9(10) VALUE 0.
  1520    02 HAY-ALERTA-BDIIALE                PIC 9(5) VALUE 0.
  1521    02 W-FECHA-BDIIALE                   PIC 9(8) VALUE 0.
  1522    02 CURRENT-DATE-BDIIALE              PIC 9(8) VALUE 0.
  1523    02 FILLER REDEFINES CURRENT-DATE-BDIIALE.
  1524       03 SIG-ANO-CURRENT-DATE-BDIIALE   PIC 9(4).
  1525       03 MES-CURRENT-DATE-BDIIALE       PIC 9(2).
  1526       03 DIA-CURRENT-DATE-BDIIALE       PIC 9(2).
  1527    02 BEGIN-CORCHETE-BDIIALE            PIC 9(1) VALUE 0.
  1528    02 DEBUG-BDIIALE                     PIC 9(1) VALUE 0.
  1529    02 FIN-BDIIALE-PLANO                 PIC 9(1) VALUE 0.
  1530    02 FIN-ICSALMIN-BDIIALE              PIC 9(1) VALUE 0.
  1531    02 FIN-CREDIT-BDIIALE                PIC 9(1) VALUE 0.
  1532    02 FIN-ICMCHK-BDIIALE                PIC 9(1) VALUE 0.
  1533    02 FIN-CHECK-BDIIALE                 PIC 9(1) VALUE 0.
  1534    02 FIN-CONSU-BDIIALE                 PIC 9(1) VALUE 0.
  1535    02 FIN-ICBCON-BDIIALE                PIC 9(1) VALUE 0.
  1536    02 FIN-ARCHI-BDIIALE                 PIC 9(1) VALUE 0.
  1537    02 FIN-ICBDIR-BDIIALE                PIC 9(1) VALUE 0.
  1538    02 HAY-INQAPE-BDIIALE                PIC 9(1) VALUE 0.
  1539    02 MENS-ERR-BDIIALE                  PIC 9(1) VALUE 0.
  1540    02 TIPIDE-OTRID-BDIIALE              PIC 9    VALUE 0.
  1541    02 OPCION-ALE-BDIIALE                PIC 99    VALUE 0.
  1542    02 TEXTO-VARIABLE-BDIIALE            PIC X(200) VALUE SPACES.
  1543    02 FECHA-WR6-BDIIALE                 PIC 9(6)    VALUE 0.
  1544    02 FILLER REDEFINES FECHA-WR6-BDIIALE.
  1545       03 SIG-ANO-WR6-BDIIALE            PIC 9(4).
  1546       03 MES-WR6-BDIIALE                PIC 9(2).
  1547    02 FECHA-WRK-BDIIALE                 PIC 9(4)    VALUE 0.
  1548    02 FECHA-CON-BDIIALE                 PIC 9(8)    VALUE 0.
  1549    02 FILLER REDEFINES FECHA-CON-BDIIALE.
  1550       03 SIG-ANO-CON-BDIIALE            PIC 9(4).
  1551       03 FILLER REDEFINES SIG-ANO-CON-BDIIALE.
  1552          04 SIG-CON-BDIIALE             PIC 9(2).
  1553          04 ANO-CON-BDIIALE             PIC 9(2).
  1554       03 MES-CON-BDIIALE                PIC 9(2).
  1555       03 DIA-CON-BDIIALE                PIC 9(2).
  1556    02 FECHA-TAG-BDIIALE                 PIC 9(6)    VALUE 0.
  1557    02 FILLER REDEFINES FECHA-TAG-BDIIALE.
  1558       03 SIG-ANO-TAG-BDIIALE            PIC 9(4).
  1559       03 FILLER REDEFINES SIG-ANO-TAG-BDIIALE.
  1560          04 SIG-TAG-BDIIALE             PIC 9(2).
  1561          04 ANO-TAG-BDIIALE             PIC 9(2).
  1562       03 MES-TAG-BDIIALE                PIC 9(2).
  1563       03 DIA-TAG-BDIIALE                PIC 9(2).
  1564    02 FECHA-NOVEDAD-BDIIALE             PIC 9(6)    VALUE 0.
  1565    02 FILLER REDEFINES FECHA-NOVEDAD-BDIIALE.
  1566       03 SIG-ANO-NOV-BDIIALE            PIC 9(4).
  1567       03 FILLER REDEFINES SIG-ANO-NOV-BDIIALE.
  1568          04 SIG-NOV-BDIIALE             PIC 9(2).
  1569          04 ANO-NOV-BDIIALE             PIC 9(2).
  1570       03 MES-NOV-BDIIALE                PIC 9(2).
  1571    02 FECHA-APERTURA-BDIIALE            PIC 9(6)    VALUE 0.
  1572    02 FILLER REDEFINES FECHA-APERTURA-BDIIALE.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  28
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  1573       03 SIG-ANO-APE-BDIIALE            PIC 9(4).
  1574       03 FILLER REDEFINES SIG-ANO-APE-BDIIALE.
  1575          04 SIG-APE-BDIIALE             PIC 9(2).
  1576          04 ANO-APE-BDIIALE             PIC 9(2).
  1577       03 MES-APE-BDIIALE                PIC 9(2).
  1578    02 FECHA-INGRESO-BDIIALE             PIC 9(6)    VALUE 0.
  1579    02 FILLER REDEFINES FECHA-INGRESO-BDIIALE.
  1580       03 SIG-ANO-ING-BDIIALE            PIC 9(4).
  1581       03 FILLER REDEFINES SIG-ANO-ING-BDIIALE.
  1582          04 SIG-ING-BDIIALE             PIC 9(2).
  1583          04 ANO-ING-BDIIALE             PIC 9(2).
  1584       03 MES-ING-BDIIALE                PIC 9(2).
  1585 01  FECHA-SITMMAAAA-ORI-BDIIALE         PIC 9(6)    VALUE 0.
  1586 01  FILLER REDEFINES FECHA-SITMMAAAA-ORI-BDIIALE.
  1587     03 FECHA-SITMM-ORI-BDIIALE          PIC 9(2).
  1588     03 FECHA-SITAAAA-ORI-BDIIALE        PIC 9(4).
  1589 01  FECHA-SITAAAAMM-BDIIALE             PIC 9(6)    VALUE 0.
  1590 01  FILLER REDEFINES FECHA-SITAAAAMM-BDIIALE.
  1591     03 FECHA-SITAAAA-BDIIALE            PIC 9(4).
  1592     03 FECHA-SITMM-BDIIALE              PIC 9(2).
  1593 01  FECHA-VALAAAAMM-BDIIALE             PIC 9(6)    VALUE 0.
  1594 01  FILLER REDEFINES FECHA-VALAAAAMM-BDIIALE.
  1595     03 FECHA-VALAAAA-BDIIALE            PIC 9(4).
  1596     03 FECHA-VALMM-BDIIALE              PIC 9(2).
  1597  01 V-NOR-BDIIALE.
  1598     02 V-NOR1-BDIIALE                     PIC 9(12).
  1599     02 V-NOR2-BDIIALE                     PIC 9(12).
  1600  01 VECTORES-PLUS-BDIIALE.
  1601    02 VECTOR-MORA-PLUS-BDIIALE.
  1602       03 FILLER PIC X(25) VALUE "5PMPPPPPPPPP5555123411212".
  1603       03 FILLER PIC X(25) VALUE "3234124412341234999CRD999".
  1604    02 FILLER REDEFINES VECTOR-MORA-PLUS-BDIIALE.
  1605       03 V-MORA-PLUS-BDIIALE OCCURS 50 TIMES PIC X.
  1606 01 CARACTERISTICAS-BDIIALE.
  1607    02 CAR-SALDO-MICR-BDIIALE            PIC 9(12) VALUE 0.
  1608    02 CAR-M60-MAS-6M-BDIIALE            PIC 9(12) VALUE 0.
  1609    02 CAR-APE-INQ-3M-BDIIALE            PIC 9(12) VALUE 0.
  1610    02 CAR-ENT-INQ-2M-BDIIALE            PIC 9(12) VALUE 0.
  1611    02 CAR-CTA-CSV-BD-BDIIALE            PIC 9(12) VALUE 0.
  1612    02 CAR-CTA-OFI-BD-BDIIALE            PIC 9(12) VALUE 0.
  1613    02 CAR-HAY-BDOFIC-BDIIALE            PIC 9(12) VALUE 0.
  1614    02 CAR-DIR-NUM-1A-BDIIALE            PIC 9(12) VALUE 0.
  1615 01 M-APE3-BDIIALE.
  1616    02 FILLER OCCURS 21 TIMES.
  1617       03 V-MESES-APE3-BDIIALE           PIC 9(5).
  1618       03 V-NIT-APE3-BDIIALE             PIC 9(11).
  1619 01 M-CON60-BDIIALE.
  1620    02 FILLER OCCURS 21 TIMES.
  1621       03 V-NIT-CON60-BDIIALE             PIC 9(11).
* 1622 COPY ICFILE.WS.
  1623* ICFILE-WS.v.0043.
  1624* COPY PARA DIRECCIONAR LOS ARCHIVOS.
  1625*****************************************************************
  1626* RMB0008     * SE ADICIONA NOMBRE DE ARCHIVO DE BASE DE DATOS
  1627*R.MARTINEZ   * UNIVERSAL.
  1628******************************************************************
  1629* VHF0009     * SE ADICIONA TABLA DE CIIUS                       *
  1630* VICTOR HUGO *                                                  *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  29
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICFILE.W
  1631* FORERO      *                                                  *
  1632* DIC.01/2000 *                                                  *
  1633******************************************************************
  1634* VHF0010     * SE ADICIONAN COPYS PARA MANEJOS DE NOMBRES DE :  *
  1635* VICTOR HUGO * NOMCCB - CAMARA DE COMERCIO DE BOGOTA            *
  1636* FORERO      * NOMREG - REGISTRADURIA                           *
  1637* SEP.10/2001 * NOMDAS - DAS                                     *
  1638*             * NMDIAN - DIAN                                    *
  1639******************************************************************
  1640* VHF0011     * SE ADICIONAN NOMBRES DE ARCHIVO DE NOMBRES DE    *
  1641* VICTOR HUGO * BYINGTON                                         *
  1642* FORERO      *                                                  *
  1643* FEB.18/2002 *                                                  *
  1644******************************************************************
  1645* FAC0012     * BDIEND - SE ADICIONAN RUTAS DE ARCHIVOS PARA     *
  1646* F.CUADROS   * MANEJO DE ENDEUDAMIENTO GLOBAL                   *
  1647* SEP.04/2002 *                                                  *
  1648* GJC0012     * DTCLOG - SE ADICIONA NOMBRE DEL ARCHIVO DE LOG DE*
  1649* G.JIMENEZ   * MODIFIFICACIONES EN LINEA Y DATACIUDADANOS       *
  1650* OCT.29/2002 *                                                  *
  1651******************************************************************
  1652* VHF0013     * ARCHIVOS ASOCIADOS CON SISTEMA DATACIUDADANOS    *
  1653* VICTOR HUGO * DTCING - ARCHIVO DE INGRESOS FALLIDOS            *
  1654* FORERO      * DTCFAL - MUESTRA LA ULTIMA TRANSACCION ANTES DE  *
  1655* ENE.16/2003 *          LAS BAJADAS DEL SISTEMA NORMAL O ANORMAL*
  1656*             * DTCMDF - CONTIENE CONSECUTIVOS DE RADICACION Y   *
  1657*             *          ENTRADA-ENTIDAD                         *
  1658*             * DTCTRA - LOG DE INSTRUCCIONES SQL FALLIDAS       *
  1659* GJC0013     * BDL001 - NOMBRE DE ARCHIVO DE CLIENTES DE DIREC- *
  1660*             *          CIONES Y TELEFONOS                      *
  1661*             * DTCABD - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1662*             *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1663*             *          RRIENTES CON RECLAMOS VIGENTES          *
  1664******************************************************************
  1665* GJC0014     * DTCAB1 - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1666* G.JIMENEZ   *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1667* ENE.16/2003 *          RRIENTES CON RECLAMOS VIGENTES AJUSTE EN*
  1668*             *          NOMBRE                                  *
  1669******************************************************************
  1670* FAC0015     * WEB001 - INCLUSION DE NOMBRES DE ARCHIVOS PARA   *
  1671* F.CUADROS C.*          MANEJO DE CLAVES WEB                    *
  1672* FEB.14/2003 *                                                  *
  1673******************************************************************
  1674* FAC0016     * MODBDI - INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1675* F.CUADROS C.*          BDII: BASES DE DATOS DE IDENTIFICACION, *
  1676* MAR.03/2003 *          CON NUEVOS DISENOS.                     *
  1677******************************************************************
  1678* GJC0017     * DTCCOM - CREACION DEL ARCHIVO DE COMENTARIOS DEL *
  1679* G.JIMENEZ   *          SISTEMA DE DATACIUDADANOS.              *
  1680* JUN.05/2003 *                                                  *
  1681* VHF0017     * DTCNHB - DIRECCIONA ARCHIVO DE DIAS NO HABILES   *
  1682* VICTOR HUGO * ICDACT - SE ADICIONA NOMBRE DE ARCHIVO DE        *
  1683* FORERO      *          ESTADISTICAS DE SUSCRIPTORES ICDACT     *
  1684******************************************************************
  1685* FAC0018     * MODDIR-  INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1686* F.CUADROS C.*          ACTALOG Y VALVEST EN NUEVA RUTA         *
  1687* JUL.09/2003 *          en $TRABAJO/logs                        *
  1688******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  30
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICFILE.W
  1689* GJC0019     * CONRAZ-  INCLUSION DE NOMBRE DE ESTRUCTURA CONRAZ*
  1690* G.JIMENEZ  .*                                                  *
  1691* SEP.11/2003 *                                                  *
  1692******************************************************************
  1693* GJC0020     * FRAUDE - INCLUSION DE MANEJO DE ARCHIVO FRALOG   *
  1694* G.JIMENEZ  .*                                                  *
  1695* OCT.14/2004 *                                                  *
  1696******************************************************************
  1697* GJC0021     * PRODUC - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1698* G.JIMENEZ   *          PRODUCTOS                               *
  1699* ABR/2005    *                                                  *
  1700******************************************************************
  1701* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1702* F.CUADROS   *          FRAINQ.DAT                              *
  1703* JUN.23/2005 *                                                  *
  1704******************************************************************
  1705* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO            *
  1706* F.CUADROS   *          HISTORICO PARA MICROCREDITO             *
  1707* SEP.02/2005 *                                                  *
  1708******************************************************************
  1709* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE       *
  1710* F.CUADROS   *          LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1711* OCT.28/2005 *          TIPO 8                                  *
  1712*             *                                                  *
  1713******************************************************************
  1714* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1715* F.CUADROS   *          PARA PROCESOS DEL AREA DE CALIDAD.      *
  1716* OCT.17/2006 *                                                  *
  1717******************************************************************
  1718* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE         *
  1719* F.CUADROS   *          PREGUNTAS GRUPALES PARA FRAINQGR        *
  1720* SEP.11/2007 *                                                  *
  1721******************************************************************
  1722* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE         *
  1723* F.LOZANO T. *          SCORES MENSUALES.                       *
  1724* OCT.31/2007 *                                                  *
  1725******************************************************************
  1726* CAV0027     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOG     *
  1727* C.VELASCO   *          DE LOS PROCESOS DE CALIDAD EJECUTADOS   *
  1728* MAR.05/2009 * LOGDRP - RUTA ARCHIVO PARA ACTUALIZAR DRP        *
  1729******************************************************************
  1730* EAL0028     * ICMVLR - INCLUSION DE RUTA DE ARCHIVOS ICMVLR    *
  1731* E.ALVAREZ   *          PARA PROCESAR 48 MESES DEL ARCHIVO      *
  1732* JUN.19/2009 *                                                  *
  1733******************************************************************
  1734* RGH0029     * MOD029 - MODIFICAR LONGUITUD DE VARIABLES        *
  1735* R.GALVIS    *          MAES-DIRECTORY ARCHIVOS ICMVLR          *
  1736* JUL.09/2009 *          DE 17 A 16 POSICIONES                   *
  1737*             * CHEQ01 - SE INCLUYE DEFINICION DE MAESTRO DE     *
  1738*             *          CHEQUES                                 *
  1739******************************************************************
  1740* VHF0030     * ICMCLN - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1741* V.FORERO    *          CLIENTES                                *
  1742* SEP.28/2009 *                                                  *
  1743******************************************************************
  1744* CAV0031     * NHC002 - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1745* C.VELASCO   *          MARCAS PRIVADAS PARA TARJETAS           *
  1746* OCT.09/2009 *                                                  *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  31
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICFILE.W
  1747******************************************************************
  1748* RGH0032       * MOD032 - INCLUIR ARCHIVOS DE RECONOCER +       *
  1749* R. GALVIS H.  *          BDLDIRACE                             *
  1750* ENE. 01/2010  *          BDLMAIEXC                             *
  1751* INTERSCHEMES. *          BDLTELEXC                             *
  1752******************************************************************
  1753* LAG0033       * SCOPRE - INCLUIR ARCHIVO SCOREPREC             *
  1754* AGO. 02/2010  *          BDLMAIEXC                             *
  1755* G.DESARROLLO  *          BDLTELEXC                             *
  1756* GJC0033       * FRZMYR - SE INCLUYE MANEJO DE ARCHIVO DE DES-  *
  1757* G.JIMENEZ     *          PLAZADOS Y SECUESTRADOS - FUERZA MA-  *
  1758* OCT./2010     *          YOR                                   *
  1759******************************************************************
  1760* GJC0034       * BDANOM - SE INCLUYE MANEJO DE ARCHIVO DE POR-  *
  1761* G.JIMENEZ     *          CENTAJE DE NOMBRES Y APELLIDOS BDANOM *
  1762* FEB./2011     *                                                *
  1763******************************************************************
  1764* CAV0035       * AJDANE - SE INCLUYE MANEJO DE ARCHIVO DANE DE  *
  1765* C.VELASCO     *          CIUDADES,DEPARTEAMENTOS Y CABECERAS O *
  1766* ABR./2011     *          CENTROS POBLADOS (DVPDANE)            *
  1767******************************************************************
  1768* CAV0036       * CARIND - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1769* C.VELASCO     *          CARACTERISTICAS USA PRECALCULADAS     *
  1770* MAY./2011     *          TITLE-CARACT-IND                      *
  1771******************************************************************
  1772* FARF037       * FRABDU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *
  1773* F.RODRIGUEZ   *          DE DATOS UNIVERSAL DE PREGUNTAS       *
  1774* JUN.22/2011   *                                                *
  1775******************************************************************
  1776* CAV0038       * AJCIIU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *
  1777* C.VELASCO.    *          HISTORICA DE CODIGOS CIIU Y ACTIVIDAD *
  1778* SEP.21/2011   *          ECONOMICA                             *
  1779******************************************************************
  1780* CAV0039       * MCREHI - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1781* C.VELASCO     *          ICMCREH QUE CONTIENE EL HISTORICO     *
  1782* JUN./2011     *          DE REGISTRO CERRADOS > 5 AOS         *
  1783******************************************************************
  1784* CAV0040       * NUECMP - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1785* C.VELASCO     *          ICMCONTTRJ  CONTIENE LA RELACION DE   *
  1786* 09/ABR./2013  *          CONTRATO-TARJETA PARA TIPO CTA = 02.  *
  1787******************************************************************
  1788* GJC0041       * VALOR1 - REQUERIMIENTO 15452 CREACION PRODUCTO *
  1789* G.JIMENEZ     *          VALORA. DEFINICION DE ARCHIVO QUE MA- *
  1790* 20/SEP./2013  *          NEJA LOS COBROS EN 2 MOMENTOS, UN     *
  1791*               *          QUE COBRA Y LOS OTROS NO
  1792******************************************************************
  1793* GLB0042       * EVID03 - MEJORAS SISTEMA EVIDENTE              *
  1794* GLOBANT       *          PROD00006585                          *
  1795* NOV-2013      * SPRINT3                                        *
  1796******************************************************************
  1797* JJM0043       * SCORPJ - SE INCLUYE UN NUEVO TITLE PARA EL     *
  1798* J. MELGAREJO  *          SCORE PJ.                             *
  1799* MAR-2014      * SCOSTB - SE INCLUYE UN NUEVO TITLE PARA EL     *
  1800*               *          SCORE STABILITY  (BDSCOREHIS)
  1801******************************************************************
  1802*
  1803 01  FILE-TITLES.
  1804     05  BDUUNI-TITLE        PIC X(80) VALUE "$BDU/BDUUNI".       RMB0008
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  32
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICFILE.W
  1805     05  NOMB-APEL-TITLE     PIC X(80) VALUE "$DATABASE/ICBNAP".
  1806     05  CLAVE-TITLE         PIC X(80) VALUE "$DATABASE/ICBCLA".
  1807     05  TERM-TITLE          PIC X(80) VALUE "$DATABASE/ICBTER".
  1808     05  MAES-PERSON-TITLE   PIC X(80) VALUE "$DATABASE/ICMPER".
  1809     05  MAES-CHECK-TITLE    PIC X(80) VALUE "$DATABASE/ICMCHK".
  1810     05  MAES-CREDIT-TITLE   PIC X(80) VALUE "$DATABASE/ICMCRE".
  1811     05  MAES-MICROC-TITLE   PIC X(80) VALUE "$DATABASE/ICMMCR".  DLM0001
  1812     05  MAES-ICMCHQ-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHQ".  GJC0029
  1813     05  INDEXADO-TITLE      PIC X(80) VALUE "$DATABASE/ICBCON".
  1814     05  SECUENCIAL-TITLE    PIC X(80) VALUE "$DATABASE/ICBTCO".
  1815     05  SUSCRIPTOR-TITLE    PIC X(80) VALUE "$DATABASE/ICBSUS".
  1816     05  ARCHNITS-TITLE      PIC X(80) VALUE "ICDIAN".
  1817     05  ARCHIVO-CLIENTE     PIC X(80) VALUE "$DATABASE/ICMCLI".
  1818     05  MAES-ICMCLN-TITLE   PIC X(80) VALUE "$DATABASE/ICMCLN".  VHF0030
  1819     05  ARCHIVO-PREPAGOS    PIC X(80) VALUE "$DATABASE/ICMPRE".
  1820     05  ARCHIVO-USUARIOS    PIC X(80) VALUE "$DATABASE/ICMUSU".
  1821     05  TITLE-SCODTB        PIC X(80) VALUE "$DATABASE/SCODTB".
  1822     05  TITLE-BDIRMAE1      PIC X(80) VALUE "$DATABASE/BDIRMAE1".
  1823     05  TITLE-BDIRMAE2      PIC X(80) VALUE "$DATABASE/BDIRMAE2".
  1824     05  TITLE-BDIRMAE3      PIC X(80) VALUE "$DATABASE/BDIRMAE3".
  1825     05  TITLE-BDIRMAE4      PIC X(80) VALUE "$DATABASE/BDIRMAE4".
  1826     05  TITLE-BDIRCTR       PIC X(80) VALUE "$DATABASE/BDIRCTR".
  1827     05  TITLE-BDIMHIS       PIC X(80) VALUE "$DATABASE/BDIMHIS". FAC0023
  1828     05  BDAPRVTR-TITLE      PIC X(80) VALUE "$DATABASE/BDAPRVTR".CAV0031
  1829     05  TITLE-DTCABD.
  1830         07 FILLER           PIC X(13) VALUE "$DATOS/DTCABD".     GJC0014
  1831         07 ANOMESDIA-DTCABD PIC 9(08) VALUE ZEROS.               GJC0014
  1832     05  BDLCLI-TITLE        PIC X(80) VALUE "$DATABASE/BDLCLI".  GJC0013
  1833     05  SCOREPREC-TITLE     PIC X(80) VALUE "$DATOS/SCOREPREC".  LAG0033
  1834     05  ARCHIVO-LOGS        PIC X(80) VALUE
  1835         "/ic/datacred/desarrollo/logs/ICL325".
  1836     05  ARCHIVO-TEMPORAL    PIC X(80) VALUE
  1837                                 "$TEMPORALES/TEMPORAL".
  1838     05  ESTAD-CADUC         PIC X(80) VALUE
  1839                                 "$TEMPORALES/ESTCAD.DAT".
  1840     05  MATRIZ-CADUC        PIC X(80) VALUE
  1841                                 "$DATABASE/ICTCAD".
  1842     05  ETQ-CIN             PIC X(80) VALUE
  1843                                 "$TEMPORALES/ICINCO.DAT".
  1844     05  RECLACOM-TITLE      PIC X(80) VALUE "$DATABASE/ICMRCM".
  1845     05  RECLAMOS-TITLE      PIC X(80) VALUE "$DATABASE/ICMRCL".
  1846     05 MAESTRO-FACUCLI      PIC X(80) VALUE "$DATABASE/FACUCLI".
  1847     05 TITLE-FACUCLP        PIC X(80) VALUE "$DATABASE/FACUCLP".
  1848     05 TITLE-FACUAUT        PIC X(80) VALUE "$DATABASE/FACUAUT".
  1849     05 TITLE-FACULOG        PIC X(80) VALUE "$DATABASE/FACULOG".
  1850     05 TITLE-FACUPAR        PIC X(80) VALUE
  1851                                 "$DATABASE/FACUPAR.DAT".
  1852     05 MAES-ICMCREH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCREH". CAV0039
  1853     05 MAES-ICMCHKH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHKH". CAV0039
  1854     05 MAES-ICMCHQH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHQH". CAV0039
  1855
  1856     05 TITLE-CIIU          PIC X(80) VALUE "$DATABASE/ICTCIIU".  VHF0009
  1857     05 TITLE-BDINCCB       PIC X(80) VALUE "$ICREGIS/BDINCCB".   VHF0010
  1858     05 TITLE-BDINREG       PIC X(80) VALUE "$ICREGIS/BDINREG".   VHF0010
  1859     05 TITLE-BDINDAS       PIC X(80) VALUE "$ICREGIS/BDINDAS".   VHF0010
  1860     05 TITLE-BDINDIAN      PIC X(80) VALUE "$ICREGIS/BDINDIAN".  VHF0010
  1861     05 TITLE-CONRAZ        PIC X(80)                             GJC0019
  1862                            VALUE "$DATABASE/CONRAZ.DAT".         GJC0019
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  33
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICFILE.W
  1863     05 TITLE-FRALOG        PIC x(80) VALUE "$DATABASE/FRALOG".   GJC0020
  1864     05 TITLE-FRAINQ        PIC X(80) VALUE                       FAC0022
  1865                            "$DATABASE/FRAINQ.DAT".               FAC0022
  1866     05 TITLE-FRAINQGR      PIC X(80) VALUE                       CAV0025
  1867                            "$DATABASE/FRAINQGR.DAT".             CAV0025
  1868     05 TITLE-BDSCORES.                                           FLT0026
  1869        07 FILLER           PIC X(15) VALUE "$SCORES/BDSCORE".    FLT0026
  1870        07 T-FECHA-PROC     PIC 9(04).                            FLT0026
  1871     05 TITLE-ICBPRO        PIC x(80) VALUE "$DATABASE/ICBPRO".   GJC0021
  1872     05 TITLE-DTRLLA        PIC x(80) VALUE "$DATABASE/DTRLLA".
  1873     05 TITLE-DTCLOG        PIC X(80) VALUE "$DATABASE/DTCLOG".   GJC0012
  1874     05 TITLE-DTCCOM        PIC X(80) VALUE "$DATABASE/DTCCOM".   GJC0017
  1875     05 TITLE-DTCING        PIC X(80) VALUE "$DATABASE/DTCING".   VHF0013
  1876     05 TITLE-DTCFAL        PIC X(80) VALUE "$DATABASE/DTCFAL".   VHF0013
  1877     05 TITLE-DTCMDF        PIC X(80) VALUE "$DATABASE/DTCMDF".   VHF0013
  1878     05 TITLE-DTCTRA        PIC X(80) VALUE "$DATABASE/DTCTRA".   VHF0013
  1879     05 TITLE-BDINBYN       PIC X(80) VALUE "$ICREGIS/BDINBYN".   VHF0011
  1880     05 SI-BDIEMSUP         PIC X(80) VALUE "$DBSUPER/BDIEMSUP".  FAC0012
  1881     05 TITLE-BDIEMSUP      PIC X(80) VALUE "$DBSUPER/BDIESU".    FAC0023
  1882     05 TITLE-UTLESTACT     PIC X(80) VALUE "$DATABASE/UTLESTACT".GLB0042
  1883     05 SI-BDIEENTI         PIC X(80) VALUE "$DBSUPER/BDIEENTI".  FAC0012
  1884     05 SI-BDIEMPER         PIC X(80) VALUE "$DBSUPER/BDIEMPER".  FAC0012
  1885     05 SI-BDIETEMA         PIC X(80) VALUE "$DBSUPER/BDIETEMA".  FAC0012
  1886     05 SI-BDIEAPER         PIC X(80) VALUE "$DBSUPER/BDIEAPER".  FAC0012
  1887     05 SI-BDIEMENT         PIC X(80) VALUE "$DBSUPER/BDIEMENT".  FAC0012
  1888     05 SI-BDIEMOVI         PIC X(80) VALUE "$DBSUPER/BDIEMOVI".  FAC0012
  1889     05 SI-BDIEHSUP         PIC X(80) VALUE "$DBSUPER/BDIEHSUP".  FAC0012
  1890     05 SI-BDIERECL         PIC X(80) VALUE "$DBSUPER/BDIERECL".  FAC0012
  1891     05 SI-BDIEMTOT         PIC X(80) VALUE "$DBSUPER/BDIEMTOT".  FAC0012
  1892     05 NOMBRE-WEB-SAL.                                           FAC0015
  1893        07 NOM-DUE-WEB-SAL PIC X(15) VALUE "$DATOS/WEB-SAL.".     FAC0015
  1894        07 FECHA-WEB-SAL   PIC 9(8).                              FAC0015
  1895     05 NOMBRE-RAS-SAL.                                           FAC0015
  1896        07 NOM-DUE-WEB-SAL PIC X(15) VALUE "$DATOS/RAS-SAL.".     FAC0015
  1897        07 FECHA-RAS-SAL   PIC 9(8).                              FAC0015
  1898     05 NOMBRE-CLAVE-WEB.                                         FAC0015
  1899        07 NOMBRE-WEB-W    PIC X(80) VALUE "$DATABASE/ARCH-WEB".  FAC0015
  1900     05 NOMBRE-RAS-LOG.                                           FAC0015
  1901        07 NOM-RAS-LOG     PIC X(19) VALUE                        FAC0015
  1902                           "$DATOS/WEB-RAS.LOG.".                 FAC0015
  1903        07 FECHA-RAS-LOG   PIC 9(8).                              FAC0015
  1904     05 TITLE-BDIIDIAN     PIC X(80)  VALUE "$DATABASE/BDIIDIAN". FAC0016
  1905     05 TITLE-BDIIREGI     PIC X(80)  VALUE "$ICREGIS/BDIIRE".    FAC0016
  1906     05 TITLE-BDIIDAS      PIC X(80)  VALUE "$DATABASE/BDIIDAS".  FAC0016
  1907     05 TITLE-DTCNHAB      PIC X(80)  VALUE "$DATABASE/DTCNHAB".  VHF0017
  1908     05 TITLE-ICDACT       PIC X(80)  VALUE                       VHF0017
  1909                           "$TEMPORALES/ICDACT.DAT".              VHF0017
  1910     05 NOMBRE-ACTALOG     PIC X(80)  VALUE                       FAC0018
  1911                           "$TRABAJO/logs/ACTALOG".               FAC0018
  1912     05 NOMBRE-VALVEST     PIC X(80)  VALUE                       FAC0018
  1913                           "$TRABAJO/logs/VALVEST.DAT".           FAC0018
  1914     05 NOMBRE-CALIDLOG.                                          CAV0027
  1915        07 NOM-CALIDLOG    PIC X(23)  VALUE                       CAV0027
  1916                           "$TRABAJO/logs/CALIDLOG-".             CAV0027
  1917        07 FCH-CALIDLOG    PIC 9(8).                              CAV0027
  1918     05 NOMBRE-CALIDDRP.                                          CAV0027
  1919        07 NOM-CALIDDRP    PIC X(24) VALUE                        CAV0027
  1920                           "$TEMPORALES/CALIDAD-DRP.".            CAV0027
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  34
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/ICFILE.W
  1921        07 FCH-CALIDDRP    PIC 9(8).                              CAV0027
  1922     05  MAES-ICMVLR-TITLE.                                       EAL0028
  1923         07 MAES-DIRECTORY1          PIC X(16) VALUE              RGH0029
  1924                                              "$VALORES/ICMVLR-". EAL0028
  1925         07 MAES-FILE1               PIC X(63).                   EAL0028
  1926                                                                  EAL0028
  1927     05  MAES-ICMVLR-TITLE2.                                      EAL0028
  1928         07 MAES-DIRECTORY2          PIC X(16) VALUE              RGH0029
  1929                                              "$VALORES/ICMVLR-". EAL0028
  1930         07 MAES-FILE2               PIC X(63).                   EAL0028
  1931                                                                  EAL0028
  1932     05  MAES-ICMVLR-TITLE3.                                      EAL0028
  1933         07 MAES-DIRECTORY3          PIC X(16) VALUE              RGH0029
  1934                                              "$VALORES/ICMVLR-". EAL0028
  1935         07 MAES-FILE3               PIC X(63).                   EAL0028
  1936                                                                  EAL0028
  1937     05  MAES-ICMVLR-TITLE4.                                      EAL0028
  1938         07 MAES-DIRECTORY4          PIC X(16) VALUE              RGH0029
  1939                                              "$VALORES/ICMVLR-". EAL0028
  1940         07 MAES-FILE4               PIC X(63).                   EAL0028
  1941                                                                  EAL0028
  1942     05  MAES-ICMVLR-TITLE5.                                      EAL0028
  1943         07 MAES-DIRECTORY5          PIC X(16) VALUE              RGH0029
  1944                                              "$VALORES/ICMVLR-". EAL0028
  1945         07 MAES-FILE5               PIC X(63).                   EAL0028
  1946                                                                  EAL0028
  1947     05  MAES-ICMVLR-TITLE6.                                      EAL0028
  1948         07 MAES-DIRECTORY6          PIC X(16) VALUE              RGH0029
  1949                                              "$VALORES/ICMVLR-". EAL0028
  1950         07 MAES-FILE6               PIC X(63).                   EAL0028
  1951     05 TITLE-BDLDIRACE  PIC X(80) VALUE "$DATABASE/BDLDIRACE".   RGH0032
  1952     05 TITLE-BDLMAIEXC  PIC X(80) VALUE "$DATABASE/BDLMAIEXC".   RGH0032
  1953     05 TITLE-BDLTELEXC  PIC X(80) VALUE "$DATABASE/BDLTELEXC".   RGH0032
  1954     05 TITLE-BDANOM     PIC X(80) VALUE "$DATABASE/BDANOM".      GJC0034
  1955     05 TITLE-FRZMYR     PIC X(80) VALUE "$DATABASE/FRZMYR".      GJC0033
  1956     05 TITLE-DVPDANE    PIC X(80) VALUE "$DATABASE/DVPDANE.DAT". CAV0035
  1957     05 TITLE-CARACT-IND PIC X(80) VALUE                          CAV0036
  1958                                   "$DATABASE/CARACTUSA-INDCL".   CAV0036
  1959     05 FRABDU-TITLE     PIC X(25) VALUE                          FARF037
  1960                                 "$VALORES/frabduact/FRABDU".     FARF037
  1961     05 FRABDV-TITLE     PIC X(29) VALUE                          FARF037
  1962                                 "$VALORES/frabduact/FRABDU.NEW". FARF037
  1963     05 MAES-ICMHCIIU-TITLE PIC X(80) VALUE "$DATABASE/ICMHCIIU". CAV0038
  1964     05 MAES-ICMCONTTRJ-TITLE PIC X(80) VALUE                     CAV0040
  1965                                    "$DATABASE/ICMCONTTRJ".       CAV0040
  1966     05 TITLE-ICBCOB     PIC X(16) VALUE "$DATABASE/ICBCOB".      GJC0041
  1967     05 TITLE-SCODAPJA   PIC X(37) VALUE "$DATABASE/SCODAPJA".    JJM0043
  1968 01 TITLE-BDSCOREHIS.                                             JJM0043
  1969    02 FILLER          PIC X(21) VALUE "$DATABASE/BDSCOREHIS.".   JJM0043
  1970    02 ANO-ANT-TITLE-BDSCOREHIS  PIC 9(04) VALUE 2013.            JJM0043
  1971    02 FILLER                    PIC X(01) VALUE "-".             JJM0043
  1972    02 ANO-ACT-TITLE-BDSCOREHIS  PIC 9(04) VALUE 2014.            JJM0043
* 1973 COPY LEEMAESTROS.WS.
  1974*LEEMAESTROS.WS.v.0003.
  1975********************************************************************
  1976* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA
  1977* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA
  1978* AMNISTIA (AMNISTIA21.WS).
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  35
* )D))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/LEEMAEST
  1979********************************************************************
  1980* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*
  1981* G.JIMENEZ  *          ENTREGUE LA NOVEDAT QUE LEY (EN 48). SI UN  *
  1982* MAY 18/2009*                                                       *
  1983**********************************************************************
  1984* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*
  1985* G.JIMENEZ  *          BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *
  1986* AGO 25/2009*          NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *
  1987*            *          PES,ETC) SI LAS DEBEN TENER EN CUENTA        *
  1988**********************************************************************
* 1989 COPY BDAMATCH.WS.
  1990*BDAMATCH-WS.v.0003.
  1991********************************************************************
  1992* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
  1993* PORTAFOLI Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LOS
  1994* ARCHIVO BDACSV, ICBDIR ICMCRE E ICMCHK.
  1995********************************************************************
  1996* RMB0002 *VIGE01: SE CONTRARAN LAS CUENTAS CON ADEJETIVOS DE
  1997*         *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL MEJOR PORTAFOLIO
  1998********************************************************************
  1999* RMB0003     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO     *
  2000* R-MARTINEZ. *          DEL PORTAFOLIO .                          *
  2001* 5-SEP-2011  * FUEN01 - NCLUIR  FUENTES EXTERNAS                  *
  2002*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH          *
  2003*             * NOMB01 - MAQUILLAR EL MEJOR NOMBRE EN PRESENTACION *
  2004********************************************************************
  2005 01 VARIABLES-MAQ.                                                RMB0003
  2006     03 I-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
  2007     03 J-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
  2008     03 SW-BORRAR-MAQ            PIC 9(03)  VALUE 0.              RMB0003
  2009     03 NOMBRE-INPMAQ-ORI        PIC X(45)  VALUE SPACES.         RMB0003
  2010     03 NOMBRE-OUTMAQ-OK         PIC X(45)  VALUE SPACES.         RMB0003
  2011     03 NOMBRE-INPMAQ-X.                                          RMB0003
  2012        04 FILLER                PIC X(02)  VALUE "A ".           RMB0003
  2013        04 NOMBRE-INPMAQ         PIC X(45)  VALUE SPACES.         RMB0003
  2014     03 PARTICULAS-INPMAQ.                                        RMB0003
  2015        04 BASURA-INPMAQ            PIC X(45).                    RMB0003
  2016        04 P1-INPMAQ                PIC X(45).                    RMB0003
  2017        04 P2-INPMAQ                PIC X(45).                    RMB0003
  2018        04 P3-INPMAQ                PIC X(45).                    RMB0003
  2019        04 P4-INPMAQ                PIC X(45).                    RMB0003
  2020        04 P5-INPMAQ                PIC X(45).                    RMB0003
  2021        04 P6-INPMAQ                PIC X(45).                    RMB0003
  2022        04 P7-INPMAQ                PIC X(45).                    RMB0003
  2023        04 P8-INPMAQ                PIC X(45).                    RMB0003
  2024        04 P9-INPMAQ                PIC X(45).                    RMB0003
  2025        04 P10-INPMAQ               PIC X(45).                    RMB0003
  2026 01  SIG-MAQ                     PIC X(1).                        RMB0003
  2027     88 SIG-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
  2028 01  ANT-MAQ                     PIC X(1).                        RMB0003
  2029     88 ANT-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
  2030 01  ACTUAL-MAQ                  PIC X(1).                        RMB0003
  2031     88 TILDE-MAQ   VALUE "" "" "" "" "" "" "" "" "" "".RMB0003
  2032     88 QUITAR-MAQ  VALUE  "'" ""  "`" '"' .                     RMB0003
  2033     88 BORRAR-MAQ  VALUE "-" "." "1" "2" "3" "4"                 RMB0003
  2034                          "5" "6" "7" "8" "9" '0' ")" "," .       RMB0003
  2035     88 ELIMINAR-MAQ VALUE "(" .                                  RMB0003
  2036     88 VALIDO-MAQ   VALUE "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"RMB0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  36
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  2037                           "K" "L" "M" "N" "O" "P" "Q" "R" "S"    RMB0003
  2038                           "T" "U" "V" "W" "X" "Y" "Z" " ".       RMB0003
  2039 01 LLAVE-AUX11-BDAMATCH.
  2040    02  TIPO-ID-AUX11-BDAMATCH    PIC 9(01).
  2041    02  NUM-ID-AUX11-BDAMATCH     PIC 9(11).
  2042    02  COD-SUS-AUX11-BDAMATCH    PIC 9(06).
  2043    02  COD-CTA-AUX11-BDAMATCH    PIC 9(02).
  2044    02  NUM-CTA-AUX11-BDAMATCH    PIC X(18).
  2045 01 LLAVE-AUX13-BDAMATCH.
  2046    02  TIPO-ID-AUX13-BDAMATCH    PIC 9(01).
  2047    02  NUM-ID-AUX13-BDAMATCH     PIC 9(13).
  2048    02  COD-SUS-AUX13-BDAMATCH    PIC 9(06).
  2049    02  COD-CTA-AUX13-BDAMATCH    PIC 9(02).
  2050    02  NUM-CTA-AUX13-BDAMATCH    PIC X(18).
  2051 01 VARIABLES-BDAMATCH.
  2052    02 I2-BDAMATCH                PIC 9(2).                       RMB0003
  2053    02 TIPCTA-BDAMATCH.                                           RMB0003
  2054*******2=CK,1=CR,2=BS,3=CC,4=OT,9=INVALIDO                        RMB0003
  2055       03 FILLER PIC X(30) VALUE "211422244444224442444433442444".RMB0003
  2056       03 FILLER PIC X(30) VALUE "444444444444444444442999999999".RMB0003
  2057       03 FILLER PIC X(30) VALUE "999999999999999999999999999999".RMB0003
  2058       03 FILLER PIC X(10) VALUE "9999999999".                    RMB0003
  2059    02 FILLER REDEFINES TIPCTA-BDAMATCH.                          RMB0003
  2060       03 V-TIPCTA-BDAMATCH  OCCURS 100 TIMES PIC 9.              RMB0003
  2061    02 APELLIDO-INPUT-BDAMATCH    PIC X(60) VALUE SPACES.         RMB0003
  2062    02 ENT-FIN-PORT-BDAMATCH      PIC 9(3)  VALUE 0.              RMB0003
  2063    02 ENT-UNICAS-PORT-BDAMATCH   PIC 9(3)  VALUE 0.              RMB0003
  2064    02 ENT-FIN-MEJ-PORT-BDAMATCH  PIC 9(3)  VALUE 0.              RMB0003
  2065    02 FALLECIDO-BDAMATCH         PIC 9(01) VALUE 0.              RMB0002
  2066    02 IDE-TIPO-BDAMATCH          PIC 9(01) VALUE 0.
  2067    02 ABIERTO-BDAMATCH           PIC 9(01) VALUE 0.
  2068    02 PROCESAR-BDAMATCH          PIC 9(01) VALUE 0.
  2069    02 FIN-BDAMATCH               PIC 9(01) VALUE 0.
  2070    02 NUM-IDE-INPUT-BDAMATCH     PIC 9(11).
  2071    02 TIP-IDE-INPUT-BDAMATCH     PIC 9(01).
  2072    02 I-GRU-BDAMATCH             PIC 9(5) VALUE 0.
  2073    02 GRU-NOM-BDAMATCH           PIC 9(5) VALUE 0.
  2074    02 MOVIDO-BDAMATCH            PIC 9(1) VALUE 0.
  2075    02 BUSCADO-D-BDAMATCH.
  2076       03 BUSCADO-BDAMATCH        PIC 9(3) VALUE 0.
  2077       03 FILLER                  PIC X(1) VALUE " ".
  2078    02 PORINSERTAR-D-BDAMATCH.
  2079       03 PORINSERTAR-BDAMATCH    PIC 9(03) VALUE 0.
  2080       03 FILLER                  PIC X(1) VALUE " ".
  2081    02 EXISTE-BDAMATCH            PIC 9(05) VALUE 0.
  2082    02 MEJOR-PORTAFOLIO-BDAMATCH  PIC 9(05) VALUE 0.
  2083    02 GRU-ANT-BDAMATCH           PIC 9(05) VALUE 0.
  2084    02 MAX-CUENTAS-BDAMATCH       PIC 9(05) VALUE 5.
  2085    02 MAX-REL-BDAMATCH           PIC 9(05) VALUE 5.
  2086    02 MAXREL-PER-BDAMATCH        PIC 9(05) VALUE 0.
  2087    02 FIN-FUENTE-BDAMATCH        PIC 9(05) VALUE 0.
  2088    02 FIL-BUS-BDAMATCH           PIC 9(05) VALUE 0.
  2089    02 COL-BUS-BDAMATCH           PIC 9(05) VALUE 0.
  2090    02 FIN-BUSCADO-BDAMATCH       PIC 9(05) VALUE 0.
  2091    02 LIBRE-BUSCADO-BDAMATCH     PIC 9(05) VALUE 0.
  2092    02 FIL-FUE-BDAMATCH           PIC 9(05) VALUE 0.
  2093    02 COL-FUE-BDAMATCH           PIC 9(05) VALUE 0.
  2094    02 I-BDAMATCH                 PIC 9(08) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  37
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  2095    02 J-BDAMATCH                 PIC 9(08) VALUE 0.
  2096    02 I-DIR-BDAMATCH             PIC 9(05) VALUE 0.
  2097    02 I-TEL-BDAMATCH             PIC 9(05) VALUE 0.
  2098    02 I-NOM-BDAMATCH             PIC 9(05) VALUE 0.
  2099    02 I-CTA-BDAMATCH             PIC 9(05) VALUE 0.
  2100    02 NUM-DIR-ANT-BDAMATCH       PIC X(50).
  2101    02 NUM-TEL-ANT-BDAMATCH       PIC 9(15).
  2102    02 CTA-DIR-ANT-BDAMATCH       PIC 9(05).
  2103    02 CTA-TEL-ANT-BDAMATCH       PIC 9(05).
  2104    02 CTA-NOM-ANT-BDAMATCH       PIC 9(05).
  2105    02 GRU-NOM-ANT-BDAMATCH       PIC 9(05).
  2106    02 TABLA-DIR-BDAMATCH.
  2107       03 T-DIR-BDAMATCH OCCURS 501 TIMES.
  2108          04 CTA-DIR-BDAMATCH     PIC 9(03).
  2109          04 NUM-DIR-BDAMATCH     PIC X(50).
  2110          04 NUM-CTAS-DIR-BDAMATCH PIC 9(03).
  2111          04 SUS-DIR-BDAMATCH     PIC 9(06).
  2112          04 LNG-DIR-BDAMATCH     PIC 9(03).
  2113    02 TABLA-TEL-BDAMATCH.
  2114       03 T-TEL-BDAMATCH   OCCURS 501 TIMES.
  2115          04 CTA-TEL-BDAMATCH     PIC 9(03).
  2116          04 NUM-TEL-BDAMATCH     PIC 9(15).
  2117          04 NUM-CTAS-TEL-BDAMATCH PIC 9(03).
  2118          04 SUS-TEL-BDAMATCH     PIC 9(06).
  2119    02 TABLA-NOM-BDAMATCH.
  2120       03 T-NOM-BDAMATCH OCCURS 501 TIMES.
  2121          04 CTA-NOM-BDAMATCH     PIC 9(03).
  2122          04 NOM-NOM-BDAMATCH     PIC X(60).
  2123          04 SUS-NOM-BDAMATCH     PIC 9(06).
  2124          04 GRU-NOMS-BDAMATCH     PIC 9(03).
  2125          04 LNG-NOM-BDAMATCH     PIC 9(02).
  2126    02 TABLA-CUENTAS-BDAMATCH.
  2127       03 T-CUENTAS-BDAMATCH OCCURS 501 TIMES.
  2128          04 CTA-CUENTAS-BDAMATCH PIC X(38).
  2129          04 CTA-FALLECIDO-BDAMATCH   PIC 9(1).                   RMB0002
  2130          04 FUEEXT-CUENTAS-BDAMATCH   PIC 9(1).                  RMB0003
  2131    02 TABLA-GRUNOM-BDAMATCH.
  2132       03 T-GRUNOM-BDAMATCH OCCURS 501 TIMES.
  2133          04 GRUPO-GRUNOM-BDAMATCH PIC 9(03).
  2134          04 NOM-GRUNOM-BDAMATCH   PIC X(60).
  2135          04 NUM-CTAS-GRUNOM-BDAMATCH PIC 9(03).
  2136          04 LNG-GRUNOM-BDAMATCH   PIC 9(02).
  2137          04 APE-GRUNOM-BDAMATCH   PIC 9(03).                     RMB0003
  2138    02  WS-PESOS-CUENTAS-BDAMATCH.
  2139      03  ESTA-CTA-BDAMATCH        PIC  9(01)  VALUE  ZEROS.
  2140      03  INV-BDAMATCH             PIC 9(04) VALUE ZEROS.
  2141      03  SUSC-CTAS-BDAMATCH       PIC 9(06) VALUE ZEROS.
  2142      03  SUSC-GRUPO-BDAMATCH.
  2143        05  SUSC-GRUP-SUS-BDAMATCH PIC  9(06)  VALUE  ZEROS.
  2144        05  SUSC-GRUP-GRU-BDAMATCH PIC  9(03)  VALUE  ZEROS.
  2145      03  PESO-CTAS-TOT-BDAMATCH   PIC 9(12) VALUE ZEROS.
  2146      03  PESOS-CTRL-BDAMATCH      PIC 9(12) VALUE ZEROS.
  2147      03  NOM-LIMPI-BDAMATCH       PIC X(60) VALUE SPACES.
  2148      03  CTA-A-BUSCAR-BDAMATCH    PIC 9(03) VALUE ZEROS.
  2149      03  PESO-TEL-BDAMATCH        PIC 9(02) VALUE 1.
  2150      03  PESO-DIR-BDAMATCH        PIC 9(02) VALUE 3.
  2151      03  PESO-NOM-BDAMATCH        PIC 9(02) VALUE 9.
  2152      03  POSIC-TEL-BDAMATCH       PIC 9(02) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  38
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  2153      03  POSIC-DIR-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2154      03  POSIC-NOM-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2155      03  POSIC-GRU-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2156      03  NRO-VECES-1-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2157      03  NRO-VECES-2-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2158      03  NRO-VECES-3-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2159      03  POSIC-SUMA-BDAMATCH      PIC 9(03) VALUE ZEROS.
  2160      03  POSIC-SUSC-BDAMATCH      PIC 9(03) VALUE ZEROS.
  2161      03  POSIC-SUS-GRU-BDAMATCH   PIC 9(03) VALUE ZEROS.
  2162 01 V-INTERRELAC-BDAMATCH.
  2163    02 CARAC-REL-BDAMATCH  OCCURS 501 TIMES PIC X(03).
  2164    02 FILA-REL-BDAMATCH OCCURS 501 TIMES.
  2165       03 COLUMNA-REL-BDAMATCH OCCURS 501 TIMES.
  2166          04 CAJA-BDAMATCH         PIC 9(03).
  2167          04 DELIMITADOR-BDAMATCH  PIC X(01).
  2168 01 VARIABLES-NOMBRES-BDAMATCH.
  2169    03 LIM-BDAMATCH                PIC  9(03) VALUE 500.
  2170    03 DIR-INPUT-BDAMATCH          PIC  X(60).
  2171    03 DIR-OUTPUT-BDAMATCH         PIC  X(60).
  2172    03 CTA-INPUT-BDAMATCH          PIC  X(38).
  2173    03 TEL-INPUT-BDAMATCH          PIC  9(15).
  2174    03 TEL-OUTPUT-BDAMATCH         PIC  9(15).
  2175    03 NOM-INPUT-BDAMATCH          PIC  X(60).
  2176    03 NOM-OUTPUT-BDAMATCH         PIC  X(60).
  2177    03 NUM-MUERTOS-OUTPUT-BDAMATCH PIC  9(03).                    RMB0002
  2178    03 NUM-CTAS-OUTPUT-BDAMATCH    PIC  9(03).                    RMB0002
  2179    03 VALCTA-OUTPUT-BDAMATCH      PIC  9(01).
  2180    03 CAR-ANT-BDAMATCH            PIC  X(01).
  2181    03 CAR-ACT-BDAMATCH            PIC  9(01).
  2182    03 T-CARDIR-BDAMATCH.
  2183       04 V-CARDIR-BDAMATCH       OCCURS 60 TIMES PIC X(01).
  2184    03 T-CARTOT-BDAMATCH.
  2185       04 V-CARTOT-BDAMATCH       OCCURS 10 TIMES PIC 9(05).
  2186 01  TABLA-SUSC-DIR-BDAMATCH.
  2187   03  REG-SUSC-DIR-BDAMATCH   OCCURS 501 TIMES
  2188       ASCENDING KEY IS COD-SUSC-DIR-BDAMATCH  INDEXED BY
  2189                                               IND-DIR-BDAMATCH.
  2190     05  COD-SUSC-DIR-BDAMATCH     PIC 9(06).
  2191     05  FLAG-YA-CTA-BDAMATCH      PIC 9(01).
  2192     05  FLAG-YA-DIR-BDAMATCH      PIC 9(01).
  2193     05  FLAG-YA-TEL-BDAMATCH      PIC 9(01).
  2194     05  FLAG-YA-NOM-BDAMATCH      PIC 9(01).
  2195 01  TABLA-SUSC-NOMBRE-BDAMATCH.
  2196   03  REG-SUSC-NOM-BDAMATCH        OCCURS 501 TIMES
  2197       ASCENDING  KEY  IS  KEY-SUSC-NOM-BDAMATCH  INDEXED
  2198                           BY IND-NOM-BDAMATCH.
  2199     05  KEY-SUSC-NOM-BDAMATCH.
  2200       07  COD-SUSC-NOM-BDAMATCH   PIC 9(06).
  2201       07  GRUPO-SUS-NOM-BDAMATCH  PIC 9(03).
* 2202 COPY AMNISTIA21.WS.
  2203* AMNISTIA21.v.0004
  2204*******************************************************************
  2205* VARIABLES DEFINIDAS PARA APLICACION DE LEYES, AMNISTIA, PARA
  2206* CLEENTES SEGUN FECHA DE PROMULGACION DE LA LEY
  2207*******************************************************************
  2208* JGR  FECHA:20/08/2007 06:19:07 p.m.
  2209* CAV  FECHA:16/01/2008
  2210******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  39
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  2211* DLM0002    | HISTOR - PERMITIR EJECUCION HISTORICA DE LA AMNIS-*
  2212* 29-JUL-2008|    TIA. LA VARIABLE WS-FECHA-HISTORICA DESDE EL   *
  2213* DARIO LASSO|    PROGRAMA DEBE COLOCARSE CON LA FECHA DESEADA.  *
  2214******************************************************************
  2215* GJC0003    | LEY002 - DEFINICIONES PARA APLICACION DE LEY DEFINI*
  2216* G. JIMENEZ |  TIVO. DOBLE EL TIEMPODE LA MORA                   *
  2217* 23-ENE-2009|                                                    *
  2218*******************************************************************
  2219* GJC0004    | CADUC1 - SE DEFINEN LAS VARIABLES NECESARIAS PARA  *
  2220* G. JIMENEZ |          HACER CADUCIDAD SOBRE EL VECTOR ANTES DE  *
  2221* 23-ENE-2009|          INICIAR APLICACION DE ARTICULO 13         *
  2222*******************************************************************
  2223 01  ABD07-AMNIST21             PIC  X(220) VALUE SPACES.
  2224 01  MESES-FALTAN-AMNIST21      PIC  9(03)  VALUE 999.
  2225 01  FECHA-INI-AMNIST21         PIC 9(06) VALUE ZEROS.
  2226 01  FECHA-INI-AMNIST21-R REDEFINES FECHA-INI-AMNIST21.
  2227     03 ANO-INI-AMNIST21        PIC 9(04).
  2228     03 MES-INI-AMNIST21        PIC 9(02).
  2229 01  VERSION-AMNIST21           PIC 9      VALUE ZEROS.
  2230 01  MESES-GRACIA-AMNIST21      PIC 9(02)  VALUE 06.
  2231 01  MESES-CANCELAC-AMNIST21    PIC 9(02)  VALUE 12.
  2232
  2233 01  WORK-CLIENTE-AMNIST21.
  2234     03 CTAS-MEN12-AMNIST21     PIC  9(01) VALUE ZEROS.
  2235     03 CTAS-MAY12-AMNIST21     PIC  9(01) VALUE ZEROS.
  2236     03 MESES-NOV-AMNIST21      PIC  9(04) VALUE ZEROS.
  2237     03 MESES-VEC-AMNIST21      PIC  9(04) VALUE ZEROS.
  2238     03 MESES-GRC-AMNIST21      PIC  9(04) VALUE ZEROS.
  2239     03 MORAS-ACTUAL-AMNIST21   PIC  9(05) VALUE ZEROS.
  2240     03 TIPO-ID-MAES-AMNIST21   PIC  9(01) VALUE ZEROS.
  2241     03 NUM-ID-MAES-AMNIST21    PIC  9(11) VALUE ZEROS.
  2242     03 K-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2243     03 L-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2244     03 M-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2245     03 X-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2246     03 Z-AMNIST21              PIC  9(03)  VALUE ZEROS.          GJC0003
  2247     03 IND-APLICO-CAD-AMNIST21 PIC  9(01) VALUE ZEROS.           GJC0004
  2248     03 FEC-NOVEDAD-AMNIST21.
  2249        05 ANO-NOV-AMNIST21     PIC  9(04) VALUE ZEROS.
  2250        05 MES-NOV-AMNIST21     PIC  9(02) VALUE ZEROS.
  2251     03 FECHA-AUX-AMNIST21      PIC  9(04).
  2252     03 FECHA-AUX-AMNIST21-R REDEFINES FECHA-AUX-AMNIST21.
  2253        05 MES-AUX-AMNIST21     PIC  9(02).
  2254        05 ANO-AUX-AMNIST21     PIC  9(02).
  2255*---------------------------------------------------------------*
  2256 01  LLAVE-INI-AMNIST21.
  2257     03 TIPO-ID-AMNIST21        PIC  9.
  2258     03 NUM-ID-AMNIST21         PIC  9(11).
  2259     03 COD-SUS-AMNIST21        PIC  9(6).
  2260     03 COD-CTA-AMNIST21        PIC  99.
  2261     03 NUM-CTA-AMNIST21        PIC  X(18).
  2262*---------------------------------------------------------------*
  2263 01  REG-SUSCRIPTOR-AMNISTIA21  PIC X(220).
  2264*01  SW-CANDIDATO-AMNIST21      PIC 9(01) VALUE ZEROS.            GJC0003
  2265*---------------------------------------------------------------*
  2266 01  MUMERO-ID-AMNIST21.
  2267     03 SW-AMNIST21             PIC  9(01) VALUE ZEROS.
  2268     03 SW-SALIR-VECT           PIC  9(01) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  40
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  2269     03 TIPO-ID-INI-AMNIST21    PIC  9(01) VALUE ZEROS.
  2270     03 NUME-ID-INI-AMNIST21    PIC  9(11) VALUE ZEROS.
  2271*---------------------------------------------------------------*
  2272 01  FECHA-MILENIO-AMNIST21.
  2273     03 FMILENIO-SIGLO-AMNIST21 PIC  9(02).
  2274     03 FMILENIO-ANIO-AMNIST21  PIC  9(02).
  2275     03 FMILENIO-MES-AMNIST21   PIC  9(02).
  2276*---------------------------------------------------------------*
  2277*   PRUEBAS  FECHA 200608                                       *
  2278*---------------------------------------------------------------*
  2279 01  FECHA-HOY-AMNIST21         PIC X(08).
  2280 01  FECHA-HOY-AMNIST21-R  REDEFINES FECHA-HOY-AMNIST21.
  2281     03 FECHA-SYS-AMNIST21.
  2282        05 ANO-HOY-AMNIST21     PIC 9(04).
  2283        05 MES-HOY-AMNIST21     PIC 9(02).
  2284     03 DIA-HOY-AMNIST21        PIC 9(02).
  2285*---------------------------------------------------------------*
  2286 01  FECHA-GRACIA-AMNIST21.
  2287     05 ANO-GRACIA-AMNIST21     PIC  9(04) VALUE ZEROS.
  2288     05 MES-GRACIA-AMNIST21     PIC  9(02) VALUE ZEROS.
  2289*---------------------------------------------------------------
  2290 01  VECTOR-AMNISTA21.
  2291     03 VECTOR1-AMNIST21        PIC 9(12) VALUE ZEROS.
  2292     03 VECTOR2-AMNIST21        PIC 9(12) VALUE ZEROS.
  2293     03 VECTOR3-AMNIST21        PIC 9(12) VALUE ZEROS.
  2294     03 VECTOR4-AMNIST21        PIC 9(12) VALUE ZEROS.
  2295*---------------------------------------------------------------
  2296 01  VECT-AMNIST21.
  2297     03 VECT1-AMNIST21          PIC 9(12).
  2298     03 VECT2-AMNIST21          PIC 9(12).
  2299     03 VECT3-AMNIST21          PIC 9(12).
  2300     03 VECT4-AMNIST21          PIC 9(12).
  2301     03 HISTORIA-TOTAL-AMNIST21.
  2302        05 VECTOR-TOT-AMNIST21  PIC X(48).
  2303     03 FILLER REDEFINES HISTORIA-TOTAL-AMNIST21.
  2304        05 V-VEC-AMNIST21  OCCURS 48 TIMES PIC X.
  2305*---------------------------------------------------------------
  2306*TABLA QUE IDENTIFICA EL ESTADO DEL REGISTRO POR LA NOVEDAD
  2307* 0-OBLIGACION CANCELADA
  2308* 1-OBLIGACIONES ABIERTAS
  2309*---------------------------------------------------------------
  2310 01  TAB-VIGENTES-AMNIST21.
  2311     03 TABLA-VIGENTES-AMNIST21.
  2312        05 FILLER        PIC X(10)   VALUE  "1000000000".
  2313        05 FILLER        PIC X(10)   VALUE  "0011111111".
  2314        05 FILLER        PIC X(10)   VALUE  "1111111111".
  2315        05 FILLER        PIC X(10)   VALUE  "1111111111".
  2316        05 FILLER        PIC X(10)   VALUE  "1111101101".
  2317     03 TABLA-VIGENTES-AMNIST21-R REDEFINES
  2318        TABLA-VIGENTES-AMNIST21.
  2319        05 TAB-VIG-CART-AMNIST21   OCCURS 50 TIMES  PIC 9(01).
  2320*---------------------------------------------------------------*
  2321 01  TABLAS-CR-AMNIST21.
  2322     03 TABLA-NOV-CAR-AMNIST21.                                   GJC0003
  2323        05  FILLER  PIC X(35) VALUE                               GJC0003
  2324            "01 01 5 AL DIA         1718192001 5".                GJC0003
  2325        05  FILLER  PIC X(35) VALUE                               GJC0003
  2326            "02 02 5 TDC NO RECLAMAD0000000000 0".                GJC0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  41
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  2327        05  FILLER  PIC X(35) VALUE                               GJC0003
  2328            "08 03 5 TDC CANC.MALMAN0000000000 0".                GJC0003
  2329        05  FILLER  PIC X(35) VALUE                               GJC0003
  2330            "04 04 5 TDC ROBADA     0000000000 0".                GJC0003
  2331        05  FILLER  PIC X(35) VALUE                               GJC0003
  2332            "05 05 5 CANCEL.VOLUNTAR0000000000 0".                GJC0003
  2333        05  FILLER  PIC X(35) VALUE                               GJC0003
  2334            "06 06 5 CANCEL.MMX<60  0000000000 0".                GJC0003
  2335        05  FILLER  PIC X(35) VALUE                               GJC0003
  2336            "07 07 5 TDC EXTRAVIADA 0000000000 0".                GJC0003
  2337        05  FILLER  PIC X(35) VALUE                               GJC0003
  2338            "03 08 5 PAGO VOLUNT.SAT0000000000 0".                GJC0003
  2339        05  FILLER  PIC X(35) VALUE                               GJC0003
  2340            "03 09 5 PAGO.MMX.A.30  09EEEEEE08 0".                GJC0003
  2341        05  FILLER  PIC X(35) VALUE                               GJC0003
  2342            "03 10 5 PAGO.MMX.A.60  0910EEEE08 0".                GJC0003
  2343        05  FILLER  PIC X(35) VALUE                               GJC0003
  2344            "03 11 5 PAGO.MORA.90   091011EE08 0".                GJC0003
  2345        05  FILLER  PIC X(35) VALUE                               GJC0003
  2346            "03 12 5 PAGO.VOL.MOR1200910111208 0".                GJC0003
  2347        05  FILLER  PIC X(35) VALUE                               GJC0003
  2348            "01 13 5 MORA.30.AL.DIA 1727282913 1".                GJC0003
  2349        05  FILLER  PIC X(35) VALUE                               GJC0003
  2350            "01 14 5 MORA.60.AL.DIA 3031323314 2".                GJC0003
  2351        05  FILLER  PIC X(35) VALUE                               GJC0003
  2352            "01 15 5 MORA.90.AL.DIA 3435363715 3".                GJC0003
  2353        05  FILLER  PIC X(35) VALUE                               GJC0003
  2354            "01 16 5 MORA.120.AL.DIA3839404116 4".                GJC0003
  2355        05  FILLER  PIC X(35) VALUE                               GJC0003
  2356            "12 17 1 ESTA.MORA.30   1718192013 1".                GJC0003
  2357        05  FILLER  PIC X(35) VALUE                               GJC0003
  2358            "13 18 2 ESTA.MORA.60   2118192014 2".                GJC0003
  2359        05  FILLER  PIC X(35) VALUE                               GJC0003
  2360            "14 19 3 ESTA.MORA.90   2223192015 3".                GJC0003
  2361        05  FILLER  PIC X(35) VALUE                               GJC0003
  2362            "15 20 4 ESTA.MORA.120  2425262016 4".                GJC0003
  2363        05  FILLER  PIC X(35) VALUE                               GJC0003
  2364            "12 21 1 FU.60.Y.ESTA.302118192014 2".                GJC0003
  2365        05  FILLER  PIC X(35) VALUE                               GJC0003
  2366            "12 22 1 FU.90.Y.ESTA.302223192015 3".                GJC0003
  2367        05  FILLER  PIC X(35) VALUE                               GJC0003
  2368            "13 23 2 FU.90.Y.ESTA.602223192015 3".                GJC0003
  2369        05  FILLER  PIC X(35) VALUE                               GJC0003
  2370            "12 24 1 FU.120.ESTA.30 2425262016 4".                GJC0003
  2371        05  FILLER  PIC X(35) VALUE                               GJC0003
  2372            "13 25 2 FU.120.ESTA.60 2425262016 4".                GJC0003
  2373        05  FILLER  PIC X(35) VALUE                               GJC0003
  2374            "14 26 3 FU.120.ESTA.90 2425262016 4".                GJC0003
  2375        05  FILLER  PIC X(35) VALUE                               GJC0003
  2376            "13 27 2 RE.30.ESTA.60  2127282914 2".                GJC0003
  2377        05  FILLER  PIC X(35) VALUE                               GJC0003
  2378            "14 28 3 RE.30.Y.ESTA.902223282915 3".                GJC0003
  2379        05  FILLER  PIC X(35) VALUE                               GJC0003
  2380            "15 29 4 RE.30.ESTA.120 2425262916 4".                GJC0003
  2381        05  FILLER  PIC X(35) VALUE                               GJC0003
  2382            "12 30 1 RE.60.Y.ESTA.303031323314 2".                GJC0003
  2383        05  FILLER  PIC X(35) VALUE                               GJC0003
  2384            "13 31 2 RE.60.Y.ESTA.602131323314 2".                GJC0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  42
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  2385        05  FILLER  PIC X(35) VALUE                               GJC0003
  2386            "14 32 3 RE.60.Y.ESTA.902223323315 3".                GJC0003
  2387        05  FILLER  PIC X(35) VALUE                               GJC0003
  2388            "15 33 4 RE.60.ESTA.120 2425263316 4".                GJC0003
  2389        05  FILLER  PIC X(35) VALUE                               GJC0003
  2390            "12 34 1 RE.90.Y.ESTA.303435363715 3".                GJC0003
  2391        05  FILLER  PIC X(35) VALUE                               GJC0003
  2392            "13 35 2 RE.90.Y.ESTA.603435363715 3".                GJC0003
  2393        05  FILLER  PIC X(35) VALUE                               GJC0003
  2394            "14 36 3 RE.90.Y.ESTA.902223363715 3".                GJC0003
  2395        05  FILLER  PIC X(35) VALUE                               GJC0003
  2396            "15 37 4 RE.90.ESTA.120 2425263716 4".                GJC0003
  2397        05  FILLER  PIC X(35) VALUE                               GJC0003
  2398            "12 38 1 RE.120.ESTA.30 3839404116 4".                GJC0003
  2399        05  FILLER  PIC X(35) VALUE                               GJC0003
  2400            "13 39 2 RE.120.ESTA.60 3839404116 4".                GJC0003
  2401        05  FILLER  PIC X(35) VALUE                               GJC0003
  2402            "14 40 3 RE.120.ESTA.90 3839404116 4".                GJC0003
  2403        05  FILLER  PIC X(35) VALUE                               GJC0003
  2404            "15 41 4 RE.120.ESTA.1202425264116 4".                GJC0003
  2405        05  FILLER  PIC X(35) VALUE                               GJC0003
  2406            "20 42   ADJ.NO.LOCALIZA0000000000 0".                GJC0003
  2407        05  FILLER  PIC X(35) VALUE                               GJC0003
  2408            "21 43   ADJ.CTA.COBRADO0000000000 0".                GJC0003
  2409        05  FILLER  PIC X(35) VALUE                               GJC0003
  2410            "22 44   FALLECIDO      0000000000 0".                GJC0003
  2411        05  FILLER  PIC X(35) VALUE                               GJC0003
  2412            "09 45 4 CARTERA.CASTIGA0000000000 4".                GJC0003
  2413        05  FILLER  PIC X(35) VALUE                               GJC0003
  2414            "10 46 5 CARTERA.RECUPER0000000000 5".                GJC0003
  2415        05  FILLER  PIC X(35) VALUE                               GJC0003
  2416            "11 47 4 DUDOSO.RECAUDO 0000000000 4".                GJC0003
  2417        05  FILLER  PIC X(35) VALUE                               GJC0003
  2418            "23 48   CONSULTA       0000000000 0".                GJC0003
  2419        05  FILLER  PIC X(35) VALUE                               GJC0003
  2420            "49 49 5 NO RENOVADA    0000000000 0".                GJC0003
  2421        05  FILLER  PIC X(35) VALUE                               GJC0003
  2422            "50                     0000000000 0".                GJC0003
  2423     03  TABLA-NOV-CAR-AMNIST21-R  REDEFINES
  2424                                     TABLA-NOV-CAR-AMNIST21.
  2425         05  TAB-NOV-CARTERA-AMNIST21   OCCURS  50  TIMES.
  2426             07 NOV-CART-CODINT-AMNIST21 PIC 9(02).
  2427             07 FILLER                   PIC X.                   GJC0003
  2428             07 NOV-CART-COD-AMNIST21    PIC 9(02).
  2429             07 FILLER                   PIC X.                   GJC0003
  2430             07 NOV-CART-MORA-AMNIST21   PIC 9(01).               GJC0003
  2431             07 FILLER                   PIC X.                   GJC0003
  2432             07 NOV-CART-NOM-AMNIST21    PIC X(15).
  2433             07 NOV-CRUCES-AMNIST21   OCCURS 5 TIMES PIC X(2).    GJC0003
  2434             07 FILLER                   PIC X.                   GJC0003
  2435             07 NOV-CART-MORMAX-AMNIST21 PIC 9(01).               GJC0003
  2436*---------------------------------------------------------------*
  2437* DEFINICION DE VARIABLES DE AMBIENTE
  2438*---------------------------------------------------------------*
  2439  01 VAR-AMBIENTE-AMNIST21          PIC X(10) VALUE "FECHA_AMNI".
  2440  01 VAR-AMB-HOY-AMNIST21           PIC X(10) VALUE "FECHA_HOY ". GJC0003
  2441  01 VAR-FEC-AMB-AMNIST21.                                        GJC0003
  2442     03 ANO-VAR-FEC-AMB-AMNIST21    PIC 9(04).                    GJC0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  43
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  2443     03 MES-VAR-FEC-AMB-AMNIST21    PIC 9(02).                    GJC0003
  2444     03 DIA-VAR-FEC-AMB-AMNIST21    PIC 9(02).                    GJC0003
  2445* 01  WS-FECHA-HISTORICA         PIC  9(08) VALUE  ZEROS.         GJC0003
  2446* 01                       REDEFINES  WS-FECHA-HISTORICA.         GJC0003
  2447*   03  WS-FECHA-HIST-ANNO       PIC  9(04).                      GJC0003
  2448*   03  WS-FECHA-HIST-MES        PIC  9(02).                      GJC0003
  2449*   03  WS-FECHA-HIST-DIA        PIC  9(02).                      GJC0003
  2450
  2451*----------------------------------------------------------------*
  2452*DEFINICION DE LAS VALIABLES QUE SE UTILIZAN PARA EL CALCULO DE  *
  2453*LEY ARTICULO 13 DOBLE DEL TIEMPO DE LA MORA
  2454*----------------------------------------------------------------*
  2455  01 VAR-LEY-DOBLE-DE-MORA-AMNIST21.                              GJC0003
  2456     03 SW-ART13-AMNIST21   PIC 9 VALUE 1. *> APLICAR SIEMPRE LEY GJC0003
  2457     03 VECTORES-13-AMNIST21.                                     GJC0003
  2458* VECTOR DE MORAS DE LA PERSONA                                   GJC0003
  2459        05 VECTOR-MORAS-IDE-13-AMNIST21 PIC X(100) VALUE ALL "5". GJC0003
  2460        05 VEC-MOR-IDE-13-AMNIST21 REDEFINES                      GJC0003
  2461           VECTOR-MORAS-IDE-13-AMNIST21 PIC 9 OCCURS 100 TIMES.   GJC0003
  2462* VECTOR DE LA CUENTA REAL                                        GJC0003
  2463        05 VECTOR-TOT-CTA-AMNIST21.                               GJC0003
  2464           07  VECTOR-4-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2465           07  VECTOR4-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2466               VECTOR-4-CTA-AMNIST21  PIC X(12).                  GJC0003
  2467           07  VECTOR-3-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2468           07  VECTOR3A-CTA-AMNIST21 REDEFINES                    GJC0003
  2469               VECTOR-3-CTA-AMNIST21  PIC X(12).                  GJC0003
  2470           07  VECTOR-2-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2471           07  VECTOR2-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2472               VECTOR-2-CTA-AMNIST21  PIC X(12).                  GJC0003
  2473           07  VECTOR-1-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2474           07  VECTOR1-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2475               VECTOR-1-CTA-AMNIST21  PIC X(12).                  GJC0003
  2476           07  MOR-EST-CTA-AMNIST21   PIC 9     VALUE 0.          GJC0003
  2477        05 VEC-TOT-CTA-AMNIST21 REDEFINES                         GJC0003
  2478              VECTOR-TOT-CTA-AMNIST21 OCCURS 49 TIMES PIC 9.      GJC0003
  2479* VECTOR DE LA CUENTA SOBRE EL QUE SE BUSCA SI SE PERDONA         GJC0003
  2480       05 VECTOR-TOT-CTA2-AMNIST21.                               GJC0003
  2481           07  VECTOR-4-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2482           07  VECTOR4-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2483               VECTOR-4-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2484           07  VECTOR-3-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2485           07  VECTOR3A-CTA2-AMNIST21 REDEFINES                   GJC0003
  2486               VECTOR-3-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2487           07  VECTOR-2-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2488           07  VECTOR2-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2489               VECTOR-2-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2490           07  VECTOR-1-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2491           07  VECTOR1-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2492               VECTOR-1-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2493           07  MOR-EST-CTA2-AMNIST21   PIC 9     VALUE 0.         GJC0003
  2494           07  MOR-MORA-CTA2-AMNIST21  PIC 9     VALUE 1.         GJC0003
  2495        05 VEC-TOT-CTA2-AMNIST21 REDEFINES                        GJC0003
  2496              VECTOR-TOT-CTA2-AMNIST21 OCCURS 50 TIMES PIC 9.     GJC0003
  2497* VECTOR DE CUENTA EN 100 POSICIONES NORMALIZADO                  GJC0003
  2498        05 VECTOR-100-CTA-AMNIST21     PIC X(101).                GJC0003
  2499        05 VEC-100-CTA-AMNIST21 REDEFINES                         GJC0003
  2500           VECTOR-100-CTA-AMNIST21 pic 9 OCCURS 101 TIMES.        GJC0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  44
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  2501* VECTOR DE LAPSOS DE MORAS                                       GJC0003
  2502        05 VECTOR-LAPSOS OCCURS 30 TIMES.                         GJC0003
  2503           07 PERDON-GRUPO-AMNIST21  PIC 9(01).                   GJC0003
  2504           07 INI-GRUPO-AMNIST21     PIC 9(02).                   GJC0003
  2505           07 LONG-GRUPO-AMNIST21    PIC 9(02).                   GJC0003
  2506                                                                  GJC0003
  2507     03 VARIALES-MORAS-13-AMNIST21.                               GJC0003
  2508        05 LONG-LAPSO-13-AMNIST21 PIC 9(02) VALUE 0.              GJC0003
  2509        05 MAX-LONG-LAPSO-13-AMNIST21 PIC 9(02).                  GJC0003
  2510     03  OTRAS-VAR-13-AMNIS21.                                    GJC0003
  2511        05 CINCOS-AMNIST21        PIC X(100) VALUE ALL "5".       GJC0003
  2512        05 UNOS-AMNIST21          PIC X(100) VALUE ALL "1".       GJC0003
  2513        05 MAYOR-LAPSO-AMNIST21   PIC 9(02).                      GJC0003
  2514        05 SALIR-AMNIST21         PIC 9.                          GJC0003
  2515        05 CTA-PERDONADA-AMNIST21 PIC 9.                          GJC0003
  2516        05 LAPSO-AMNIST21         PIC 9(02).                      GJC0003
  2517        05 MESES-MORAS-AMNIST21   PIC 9(02).                      GJC0003
  2518        05 ESTOY-MOROSO-AMNIST21  PIC 9.                          GJC0003
  2519        05 MESES-AMNIST21         PIC 9(3).                       GJC0003
  2520        05 FEC-NOV-AUX-AMNIST21 PIC 9(4).                         GJC0003
  2521        05 FEC-NOV-AUX1-AMNIST21 PIC 9(4).                        GJC0003
  2522        05 FEC-SIT-45Y47-AMNIST21 PIC 9(6).                       GJC0003
  2523        05 FEC-SIT-45Y47-R-AMNIST21 REDEFINES                     GJC0003
  2524           FEC-SIT-45Y47-AMNIST21.                                GJC0003
  2525           07 MES-SIT-AMNIST21     PIC 9(02).                     GJC0003
  2526           07 ANO-SIT-AMNIST21     PIC 9(04).                     GJC0003
  2527*DEFINICION DE VARIABLES PARA HACER RECALCULO DE ESTADO Y OTROS CAGJC0003
  2528 01 VARIABLES-RECALCULO.                                          GJC0003
  2529    03 HISTORIA-TOTAL-AMNIST21.                                   GJC0003
  2530       05 VECTOR-1-AMNIST21        PIC X(12).                     GJC0003
  2531       05 VECTOR-2-AMNIST21        PIC X(12).                     GJC0003
  2532       05 VECTOR-3-AMNIST21        PIC X(12).                     GJC0003
  2533       05 VECTOR-4-AMNIST21        PIC X(12).                     GJC0003
  2534       05 EST-HIST-AMNIST21        PIC X(1).                      GJC0003
  2535    03 FILLER REDEFINES HISTORIA-TOTAL-AMNIST21.                  GJC0003
  2536       05 V-VECTOR-AMNIST21   OCCURS 49 TIMES PIC X.              GJC0003
  2537    03 FIN-AMNIST21                 PIC 9 VALUE 0.                GJC0003
  2538    03 FIN-MATRIZ-AMNIST21          PIC 99 VALUE 0.               GJC0003
  2539    03 ESTADO-AMNIST21              PIC 99.                       GJC0003
  2540    03 ESTADO-INI-AMNIST21          PIC 99.                       GJC0003
  2541    03 ESTADO-FIN-AMNIST21          PIC 99.                       GJC0003
  2542    03 ESTADO-INI48-AMNIST21          PIC 99.                     GJC0003
  2543    03 ESTADO-FIN48-AMNIST21          PIC 99.                     GJC0003
  2544    03 FECHA-AMNIST21.                                            GJC0003
  2545       05 ANO-T-AMNIST21            PIC 9(4).                     GJC0003
  2546       05 FILLER REDEFINES ANO-T-AMNIST21.                        GJC0003
  2547          07 SIGLO-AMNIST21         PIC 99.                       GJC0003
  2548          07 ANO-AMNIST21           PIC 9(2).                     GJC0003
  2549       05 MES-AMNIST21              PIC 9(2).                     GJC0003
  2550    03 FECHA-1-AMNIST21.                                          GJC0003
  2551       05 ANO-T-1-AMNIST21          PIC 9(4).                     GJC0003
  2552       05 FILLER REDEFINES ANO-T-1-AMNIST21.                      GJC0003
  2553          07 SIGLO-1-AMNIST21       PIC 99.                       GJC0003
  2554          07 ANO-1-AMNIST21         PIC 9(2).                     GJC0003
  2555       05 MES-1-AMNIST21            PIC 9(2).                     GJC0003
  2556    03 FEC-INI-MOR-AMNIST21         PIC 9(6).                     GJC0003
  2557    03 MES-MORA-MAX-AMNIST21        PIC 9(2).                     GJC0003
  2558    03 MES-MORA-MAX-48-AMNIST21        PIC 9(2).                  GJC0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  45
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  2559    03 FEC-MM-AA-AMNIST21           PIC 9(4).                     GJC0003
  2560    03 FEC-MM-AAAA-AMNIST21         PIC 9(6).                     GJC0003
  2561    03 NOV-ENT-AMNIST21             PIC 9(02).                    GJC0003
  2562    03 FEC-NOV-AMNIST21             PIC 9(04).                    GJC0003
  2563    03 FEC-MORMAX-AMNIST21          PIC 9(06).                    GJC0003
  2564    03 FEC-MORMAX-48-AMNIST21       PIC 9(06).                    GJC0003
  2565    03 MORMAX-AMNIST21              PIC 9(01).                    GJC0003
  2566    03 MORMAX48-AMNIST21            PIC 9(01).                    GJC0003
  2567    03 NUM-MOR30-AMNIST21           PIC 9(02).                    GJC0003
  2568    03 NUM-MOR30-48-AMNIST21        PIC 9(02).                    GJC0003
  2569    03 NOV-SAL-AMNIST21             PIC 9(02).                    GJC0003
  2570    03 FEC-NOV-48-AMNIST21          PIC 9(04).                    GJC0003
  2571    03 NOV-SAL-48-AMNIST21          PIC 9(02).                    GJC0003
  2572    03 POSICION-INI-AMNIST21        PIC 9(03).                    GJC0003
  2573
  2574
* 2575 COPY VALNOM.WS.
  2580* GJC0002    * VALMEJ :SE CREAN ANUEVOS CAMPOS PARA MEJORAR LA VALIDACION
  2581* G.JIMENEZ  * DE NIT. PARA MEJORA TAMBIEN SE AMPLIA TAMANO DE VARIABLES
  2582* MARZO/2003 *
  2583*************************************************************************
  2584  01 VARIABLES-VALNOM.
  2585     03 VECTOR-INPUT-VALNOM.
  2586       04 VM-INPUT-VALNOM     OCCURS 20 TIMES .
  2587          05 VMM-INPUT-VALNOM OCCURS 15 TIMES PIC X.
  2588     03 VECTOR-OK-VALNOM.
  2589       04 VM-OK-VALNOM         OCCURS 20 TIMES.
  2590          05 VMM-OK-VALNOM    OCCURS 15 TIMES PIC X.
  2591     03 BLOQOK-AUX-VALNOM           PIC 9(2).
  2592     03 CADENA-VALNOM.
  2593        04 FILLER                   PIC X(2) VALUE "A ".
  2594        04 NOMBRE-AUX-VALNOM        PIC X(65).
  2595        04 FILLER REDEFINES NOMBRE-AUX-VALNOM.
  2596           05 VNOM-AUX-VALNOM OCCURS 65 TIMES PIC X.
  2597     03 BASURA-VALNOM               PIC X(10).
  2598     03 BLOQUES-INPUT-VALNOM        PIC 9(2).
  2599     03 NOMBRE-INPUT-VALNOM         PIC X(65).
  2600     03 FILLER REDEFINES NOMBRE-INPUT-VALNOM.
  2601        05 V-NOMBRE-VALNOM          PIC X OCCURS 65 TIMES.
  2602     03 NOMBOK-INPUT-VALNOM         PIC X(65).
  2603     03 FILLER REDEFINES NOMBOK-INPUT-VALNOM.
  2604        05 V-NOMBOK-VALNOM          PIC X OCCURS 65 TIMES.
  2605     03 TIP-ID-INPUT-VALNOM         PIC 9(02).
  2606     03 MATCH-OK-OUT-VALNOM         PIC 9(01).
  2607     03 A-VALNOM                    PIC 9(05).
  2608     03 I-VALNOM                    PIC 9(05).                    GJC0002
  2609     03 J-VALNOM                    PIC 9(05).                    GJC0002
  2610     03 K-VALNOM                    PIC 9(05).                    GJC0002
  2611     03 L-VALNOM                    PIC 9(05).                    GJC0002
  2612     03 M-VALNOM                    PIC 9(05).                    GJC0002
  2613     03 INI-VALNOM                  PIC 9(02).
  2614     03 LON-VALNOM                  PIC 9(02).
  2615     03 LETRAS-OK-VALNOM            PIC 9(02).
  2616     03 LETRAS-OK2-VALNOM           PIC 9(02).
  2617     03 TOTLET-OK-VALNOM            PIC 9(02).
  2618     03 TOTLET-INP-VALNOM           PIC 9(02).
  2619     03 PEDAZO-VALNOM               PIC X(15).
  2620     03 POR-TOT-VALNOM              PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  46
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/VALNOM.W
  2621     03 POR-INP-VALNOM              PIC 9(05).
  2622     03 APROX-TOT-VALNOM            PIC 9(05).
  2623     03 APROX-INP-VALNOM            PIC 9(05).
  2624     03 VECTORES-VALNOM.                                          GJC0002
  2625        04 FILLER                   OCCURS 256 TIMES.             GJC0002
  2626           05 CONT-LET-INPUT-VALNOM PIC 9(2).                     GJC0002
  2627           05 CONT-LET-OK-VALNOM    PIC 9(2).                     GJC0002
  2628     03 VAL-APELLIDO-VALNOM         PIC 9.                        GJC0002
* 2629 COPY DIRECC.WS.
  2634* VHF0004     * SE ADICIONAN NOMBRES DE ARCHIVOS DE              *
  2635* VICTOR HUGO * ESTANDARIZACION DE DIRECCIONES                  *
  2636* FORERO      *                                                  *
  2637* JUL.08/2002 *                                                  *
  2638******************************************************************
  2639* FAC0005     * HDIR01 * INCLUSION RUTA PARA MAESTRO HISTORICO DE*
  2640* F.CUADROS C.* DIRECCIONES                                      *
  2641* MAR.04/2003 *                                                  *
  2643* FAC0006     * BDLLOC * AMPLIACION DE LAS OCURRENCIAS DEL VECTOR*
  2644* F.CUADROS C.* T-LOCALIZACION PARA NUEVOS CAMPOS DE MAESTROS DEL*
  2645* DIC.11/2003 * CLUB BDLCLI
  2647* FAC0007     * AMPDIR * AMPLIACIN DE LA ESTRUCTURA DE ARCHIVOS*
  2648* F.CUADROS C.* ICBDIR Y BDUHDIR. SE AMPLIAN LOS TAMAOS DE LOS *
  2649* FEB.14/2006 * CAMPOS: TELFONOS, DIRECCIONES, CIUDADES, DPTOS.*
  2651* VHF0008     * RCNCER - SE INCLUYE TITULO DE ARCHIVO DE        *
  2652* VICTOR HUGO *          ACEPCIONES DE CIUDADES PARA OPTIMIZAR  *
  2653* FORERO      *          PRODUCTO RECONOCER.                    *
  2654* JUL.06/2006 *                                                 *
  2655* FAC0008     *          SE INCLUYEN CONTROLES EN HISTRICO PARA*
  2656* JUL.18/2006 *          GEORREFERENCIACIN                     *
  2657*****************************************************************
  2658* CAV0009      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI  *
  2659* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA  *
  2660* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION            *
  2661*****************************************************************
  2662* VHF0010      * FASEII - SE ADICIONAN NUEVAS VARIABLES PARA EL  *
  2663* VICTOR HUGO  *          ACTUALIZADOR                           *
  2664* FORERO       *                                                 *
  2665* JUL.25/2008  *                                                 *
  2666******************************************************************
  2667 01 CONTADORES-DIRECC.
  2668    03 TOTAL-DIRECC            PIC 9(8) VALUE 0.
  2669    03 CAMBIOS-DIRECC          PIC 9(8) VALUE 0.
  2670    03 SINCAMBIOS-DIRECC       PIC 9(8) VALUE 0.
  2671    03 CREACIONES-DIRECC       PIC 9(8) VALUE 0.
  2672    03 ERRORES-DIRECC          PIC 9(8) VALUE 0.
  2673    03 CAMPOSVACIOS-DIRECC     PIC 9(8) VALUE 0.
  2674    03 MENOSACTUAL-DIRECC      PIC 9(8) VALUE 0.
  2675    03 ERRLLAVE-DIRECC         PIC 9(8) VALUE 0.
  2676 01 VARIABLES-DIRECC.
  2677    03 IND-DIRECC              PIC 9 VALUE 0.
  2678    03 FECHA6-DIRECC           PIC 9(06).
  2679    03 ERROR-DIRECC            PIC 9 VALUE 0.
  2680    03 CAMBIO-DIRECC           PIC 9 VALUE 0.
  2681    03 REG-CSV-DIRECC          PIC 9(1).                          CAV0009
  2682    03 MAES-DIRECC-TITLE PIC X(50) VALUE "$DIRECCIONES/ICBDIR".
  2683    03 TITLE-DIREST            PIC X(40) VALUE                    VHF0004
  2684       "$DIRECCIONES/DIREST".                                     VHF0004
  2685    03 TITLE-DIRCON            PIC X(40) VALUE                    VHF0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  47
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/DIRECC.W
  2686       "$DIRECCIONES/DIRCON".                                     VHF0004
  2687    03 VALLOC-DIRECC.
  2688       04 T-LOCALIZACION OCCURS 15 TIMES PIC 9.                   FAC0006
  2689    03 MAES-BDUHDIR-TITLE PIC X(20) VALUE "$DIRECCIONES/BDUHDIR". FAC0005
  2690    03 TITLE-BDLSTDCIU    PIC X(80)  VALUE "$DATABASE/BDLSTDCIU". VHF0008
  2691 01 VARIABLES-TRAB-DIRECC.                                        FAC0003
  2692    03 TEL-W1                  PIC X(12).                         FAC0007
  2693    03 TEL-W2                  PIC X(12).                         FAC0007
  2694    03 TEL-WW2                 PIC X(12).                         FAC0007
  2695    03 CAR-W                   PIC 9(1).                          FAC0003
  2696    03 CAR-WW                  PIC 9(2).                          FAC0003
  2697    03 NUM-CAR-W               PIC 9(2).                          FAC0003
  2698 01 VARIABLES-NEW-DIRECC.                                         VHF0010
  2699    03 SW-HACER-CAMBIO         PIC 9.                             VHF0010
  2700    03 DIR-ACTUAL              PIC X(60).                         VHF0010
  2701    03 DIR-NUEVA               PIC X(60).                         VHF0010
  2702 01 REG-BDUHDIR-WS.                                               FAC0005
  2703    03  LLAVE-BDUHDIR-WS.                                         FAC0005
  2704        05  LLAVE-PRI-BDUHDIR-WS.                                 FAC0005
  2705            07  TIPO-ID-BDUHDIR-WS    PIC 9(01).                  FAC0005
  2706            07  NUM-ID-BDUHDIR-WS     PIC 9(13).                  FAC0007
  2707        05  LLAVE-ALT-BDUHDIR-WS.                                 FAC0005
  2708            07  COD-SUS-BDUHDIR-WS    PIC 9(06).                  FAC0005
  2709            07  COD-CTA-BDUHDIR-WS    PIC 9(02).                  FAC0005
  2710            07  NUM-CTA-BDUHDIR-WS    PIC X(18).                  FAC0005
  2711        05  LLAVE-CONSEC-BDUHDIR-WS.                              FAC0005
  2712            07  NUM-CONSEC-BDUHDIR-WS PIC 9(3).                   FAC0005
  2713     03  FECAPE-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  2714     03  FECCRE-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  2715     03  FECACT-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  2716     03  CIURES-BDUHDIR-WS            PIC X(20).                  FAC0007
  2717     03  DPTRES-BDUHDIR-WS            PIC X(20).                  FAC0007
  2718     03  DIRRES-BDUHDIR-WS            PIC X(60).                  FAC0007
  2719     03  TELRES-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  2720*    03  FECRES-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  2721     03  FECDRES-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  2722     03  CIULAB-BDUHDIR-WS            PIC X(20).                  FAC0007
  2723     03  DPTLAB-BDUHDIR-WS            PIC X(20).                  FAC0007
  2724     03  DIRLAB-BDUHDIR-WS            PIC X(60).                  FAC0007
  2725     03  TELLAB-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  2726*    03  FECLAB-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  2727     03  FECDLAB-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  2728     03  CIUCOR-BDUHDIR-WS            PIC X(20).                  FAC0007
  2729     03  DPTCOR-BDUHDIR-WS            PIC X(20).                  FAC0007
  2730     03  DIRCOR-BDUHDIR-WS            PIC X(60).                  FAC0007
  2731*    03  FECCOR-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  2732     03  FECDCOR-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  2733     03  E-MAIL-BDUHDIR-WS            PIC X(40).                  FAC0007
  2734     03  TELCEL-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  2735*    03  FECOTR-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  2736     03  FECCEL-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  2737     03  FECSIS-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  2738     03  FECSUS-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  2739     03  FECULT-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  2740     03  CERRES-BDUHDIR-WS            PIC 9(01).                  FAC0008
  2741     03  ADIRES-BDUHDIR-WS            PIC 9(02).                  FAC0008
  2742     03  CERLAB-BDUHDIR-WS            PIC 9(01).                  FAC0008
  2743     03  ADILAB-BDUHDIR-WS            PIC 9(02).                  FAC0008
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  48
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/DIRECC.W
  2744     03  CERCOR-BDUHDIR-WS            PIC 9(01).                  FAC0008
  2745     03  ADICOR-BDUHDIR-WS            PIC 9(02).                  FAC0008
  2746     03  INDCSV-BDUHDIR-WS            PIC 9(01).                  CAV0009
  2747     03  FECTRES-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  2748     03  FECTLAB-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  2749     03  FECMAIL-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  2750*    03  FILLER-BDUHDIR-WS            PIC X(40).                  VHF0010
  2751     03  FILLER-BDUHDIR-WS            PIC X(28).                  VHF0010
  2752
  2753
  2754********************************************************************
  2755* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
  2756* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
  2757 01  HACERMATCH-LEEMSTRS        PIC 9(01)  VALUE 1.
  2758 01  AMNISTIA21-LEEMSTRS        PIC 9(01)  VALUE 1.
  2759********************************************************************
  2760 01  SW-LECTURA-MAESTROS        PIC 9(01)  VALUE ZEROS.
  2761 01  TIP-IDE-ANT-LEEMSTRS       PIC 9(01)  VALUE ZEROS.
  2762 01  NUM-IDE-ANT-LEEMSTRS       PIC 9(11)  VALUE ZEROS.
  2763 01  REG-ICMCRE-LEEMSTRS        PIC X(220) VALUE SPACES.
  2764 01  REG-ICMCHK-LEEMSTRS        PIC X(94)  VALUE SPACES.
  2765 01  REG-ICBSUS-LEEMSTRS        PIC X(200) VALUE SPACES.
  2766 01  REG-ICBDIR-LEEMSTRS        PIC X(483) VALUE SPACES.
  2767 01  TIPO-ID-LEEMSTRS           PIC 9(01)  VALUE ZEROS.
  2768 01  NRO-ID-LEEMSTRS            PIC 9(11)  VALUE ZEROS.
  2769 01  SW-FCHGRACIA-LEEMSTRS      PIC 9(01)  VALUE ZEROS.
  2770 01  SW-NOV-48-LEEMSTRS         PIC 9(01)  VALUE 1.               GJC0002
  2771 01  SW-ELIMINA-BBVA-LEEMSTRS   PIC 9(01)  VALUE 0. *> 0-NO 1-SI  GJC0003
  2772*COPY BDLDIR.WS.
* 2773 COPY BDLDI2.WS.
  2774*BDLDI2-WS.v.0025
  2775*******************************************************************
  2776* RMB0002      * ALG001 - SE AUMENTAN LAS VARIABLES NECESARIAS POR
  2777*              * ALG001 - EL CAMBIO EN EL ORDEN DE LA DIRECCION MAS
  2778* FEB-15-2003  *          PROBABLE AUMENTANDO UN PESO CON BASE A LA
  2779* R.MARTINEZ   *          CONFORMACION DE LA DIRECCION O DEL TELEFONO
  2780*******************************************************************
  2781* RMB0003      * DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOS
  2782* MAR-15-2003  *          PERMISOS DE ACCESO A LA BASE DE DATOS DE
  2783* R.MARTINEZ   *          DIRECCIONES
  2784*******************************************************************
  2785* VHF0004      * ESTAN1 - SE AUMENTAN LOS TAMANOS DE VARIABLES
  2786* MAY-27-2003  *          PARA PERMITIR MAXIMO HASTA 30 PARTICULAS
  2787* V.FORERO     *          PARA UNA DIRECCION
  2788*******************************************************************
  2789* FAC0005      * AMPDIR - AMPLIACION DE LA ESTRUCTURA DE ARCHIVO
  2790* F.CUADROS C. *          ICBDIR
  2791* FEB.15/2006  * DOMICI - SEAL PARA MATCH DE DOMICILIACION
  2792*******************************************************************
  2793* RMB0006      * RCNCER - OPTIMIZACION PARA PRODUCTO RECONOCER.  *
  2794* R.MARTINEZ   *          SE CAMBIAN VARIABLES QUE UTILIZA LA    *
  2795* JUN.15/2006  *          RUTINA PARA ESTANDARIZACION ADEMAS DE  *
  2796*              *          LA DEFINICION DE NUEVAS VARIABLES PARA *
  2797*              *          OPTIMIZACION (VER DETALLES EN PATCH DE *
  2798*              *          BDLDIR.PROC).
  2799******************************************************************
  2800* GJC0007      * NWDIRB - VARIABLES PARA IDENTIFICAR CUANDO UNA  *
  2801* G.JIMENEZ    *          DIRECCION DE BOGOTA TIENE NUEVA NOMEN- *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  49
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  2802* FEBRERO/2007 *          CLATURA                                *
  2803******************************************************************
  2804* HGO0008      * UNIDIR - UNIFICAR DIRECCIONES QUE TENGAN        *
  2805* H.GARCIA     *          COINCIDENCIAS CON OTRAS DIRECCIONES CON*
  2806* MARZO/2009   *          MAYOR CANTIDAD DE INFORMACION - INCLUIR*
  2807* INTERSCHEMES *          EN LA SALIDA EL CAMPO FECHA ULTIMO REP *
  2808*              * TELEXC - SE UNIFICAN TELEFONOS QUE COINCIDAN CON*
  2809*              *          LOS ULTIMOS 7 NUMEROS DEL TELEFONO. SE *
  2810*              *          CREA TABLA PARA LA EXCLUSION DE TELEFO-*
  2811*              *          NOS. SE AGREGA EN EL REPORTE FECHA     *
  2812*              *          ULTIMO REPORTE.                        *
  2813******************************************************************
  2814* RGH0009      * TELEX9 - UTILIZAR REDEFINICION PARA VARIABLE    *
  2815* R.GALVIS     *          V-TELFIN-BDLDIR                        *
  2816* MARZO/2009   *                                                 *
  2817* INTERSCHEMES *                                                 *
  2818******************************************************************
  2819* HGO0010       * TEXTEL - Se agregan nuevas exclusiones en la   *
  2820* H. GARCIA O.  *          tabla de telefonos y se amplia el     *
  2821* SEP.01/2009   *          numero de ocurrencias                 *
  2822* INTERSCHEMES  *                                                *
  2823******************************************************************
  2824* HGO0011       * PYSPAR - AJUSTE QUE BUSCAR GENERAR CALIFICACION*
  2825* H. GARCIA O.  *          PARA LA PRIMERA Y SEGUNDA PARTICULA Y *
  2826* SEP. 27/2009  *          LUEGO UNIFICAR TENIENDO EN CUENTA ESTE*
  2827* INTERSCHEMES. *          CRITERIO                              *
  2828******************************************************************
  2829* HGO0012       * RECPF2 - AJUSTE VALIDACION TABLAS DE ACEPCIONES*
  2830* H. GARCIA O.  *          Y EXCLUSIONES                         *
  2831* SEP. 17/2009  *                                                *
  2832* INTERSCHEMES. *                                                *
  2833******************************************************************
  2834******************************************************************
  2835* RGH0013       * MOD013 - ESTANDARIZACION DE MANEJO DE ARCHIVOS *
  2836* R. GALVIS H.  *          BDLSTDCIU                             *
  2837* ENE. 01/2010  *          BDLDIRACE                             *
  2838* INTERSCHEMES. *          BDLMAIEXC                             *
  2839*               *          BDLTELEXC                             *
  2840******************************************************************
  2841* RMB0014       * CELU01 - INCLUIR LOS CELULARES DEL ARCHIVO     *
  2842* R. MARTINEZ.  *          DE DIRECCIONES EN LA TABLA DE CELULAR *
  2843* MAR. 25/2010  *                                                *
  2844******************************************************************
  2845* PJV0015       * CELU02 - INCLUIR INDICATIVO DE CELULARES QUE   *
  2846* P. VARGAS  .  *          INICIEN POR 314.                      *
  2847* MAY. 31/2010  *                                                *
  2848******************************************************************
  2849* PJV0016      * NN0016 - AJUSTE, PARA EVITAR QUE SE REPITAN     *
  2850* P.VARGAS     *          DIRECCIONES EN EL MISMO REPORTE CUNADO *
  2851* JUL 01/2010  *          SE TRATAN DE NUEVAS NOMENCLATURAS EN   *
  2852* DATACREDITO  *          BOGOTA.                                *
  2853******************************************************************
  2854* PJV0017      * AMP017 -SE AMPLIAN LOS LIMITES DE LAS TABLAS DE *
  2855* P.VARGAS     *         ACEPCIONES QUE SE CARGAN EN MEMORIA.    *
  2856* SEP 09/2010  *         TAMBIEN SE AJUSTA PARA EVITAR LA        *
  2857* DATACREDITO  *         REPETICION DE DIRECCIONES PARA UNA MISMA*
  2858*              *         IDENTIFICACION.                         *
  2859******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  50
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  2860* FARF018      * PLNCHQ - SE AINTEGRA LAS REGLAS DESARROLLADAS   *
  2861* Jul.17-2012  *  DESARROLLADAS POR RMB PARA EL PLAN DE CHOQUE.  *
  2862* FRANKLIN.R.  *                                                 *
  2863******************************************************************
  2864* FARF019       * AJCIUU - SE AINTEGRA EL AJUSTE DESARROLLADO POR
  2865* Sep.11-2012   * RMB QUE CAMBIA LA BUSQUEDA DEL CIU PARA QUE NO
  2866* FRANKLIN.R.   * FALLE CUANDO SE UTILIZA FUERA DE LA RUTINA
  2867*               * PRINCIPAL.
  2868******************************************************************
  2869* ABB0020      * NCAM18 -SE CREAN NUEVOS CAMPOS EN TRAMAS:       *
  2870* ALBEIRO      *         ZONA                ZONADIR             *
  2871* BERNAL       *         FECHA DE CREACION   FECCRE              *
  2872* Oct 04/2012  *         NUMERO DE ENTIDADES NUMENT              *
  2873*              *                                                 *
  2874*              * FCRGCR- SE INTEGRA EL AJUSTE DE FECHAS DE       *
  2875*              *  DIRECCIONES DE CUENTAS CERRADAS DESARROLLADO   *
  2876*              *  POR RMB.                                       *
  2877*
  2878*              * NCAM19 -SE CREA NUEVOS CAMPOS:                  *
  2879*              *      TIPODI = 1=Res,2=Lab,4=Cor,3=Res+Lab       *
  2880*              *               5=Res+Cor, 6=Lab+Cor,7=Res+Lab+Cor*
  2881*              *      TIPOTE = 1=Res,2=Lab,3=Res+Lab             *
  2882******************************************************************
  2883* FARF021       * AJCONT - SE AINTEGRA EL AJUSTE DESARROLLADO POR
  2884* Nov.13-2012   * RMB QUE PERMITE HACER UNA CORRELACION ENTRE LAS
  2885* FRANKLIN.R.   * DIRECCIONES FINALES Y LAS DIRECCIONES INCICIALES
  2886*               * DE DONDE SALIERON.
  2887*               * SE AJUSTA EL TAMAO DEL CORREO DE 36 A 40.
  2888******************************************************************
  2889* ABB0022      * NCAM22 -NUEVOS CAMPOS DESCRIPCION               *
  2890* ALBEIRO      *                                                 *
  2891* BERNAL       *                                                 *
  2892*Nov 15/2012   * *                                               *
  2893******************************************************************
  2894* FARF023       * CARACT - SE INTEGRA EL DESARROLLO DE
  2895* Oct.08-2013   * CARACTERISTICAS DE RICARDO MARTINEZ.
  2896* FRANKLIN.R.   *
  2897******************************************************************
  2898* FARF024       * TELDIA - SE GUARDA LA INFORMACION DEL CODIGO
  2899* Ene.30-2014   * DANE DE LA CIUDAD DEL TELEFONO REPPORTADO
  2900* FRANKLIN.R.   *
  2901******************************************************************
  2902* FARF025       * NEWORD - VARIABLES PARA EL CONTROLAR EL NUEVO
  2903* Feb.18-2014   *  ORDENAMIENTO.
  2904* FRANKLIN.R.   *
  2905******************************************************************
  2906*
  2907 01  M-CONTEOS-TEX.                                               FARF021
  2908     02 V-CONTEOS-TEX OCCURS 100 TIMES.                           FARF021
  2909        03 V-TEX-CONTEO1                  PIC X(30).              FARF021
  2910        03 V-TEX-CONTEO2                  PIC X(30).              FARF021
  2911        03 V-TEX-CONTEO3                  PIC X(30).              FARF021
  2912        03 V-TEX-CONTEO4                  PIC X(30).              FARF021
  2913        03 V-TEX-CONTEO5                  PIC X(30).              FARF021
  2914        03 V-TEX-CONTEO6                  PIC X(30).              FARF021
  2915        03 V-TEX-CONTEO7                  PIC X(30).              FARF021
  2916        03 V-TEX-CONTEO8                  PIC X(30).              FARF021
  2917        03 V-TEX-CONTEO9                  PIC X(30).              FARF021
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  51
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  2918*
  2919 01  M-CONTEOS-NUM.                                               FARF021
  2920     02 V-CONTEOS-NUM OCCURS 100 TIMES.                           FARF021
  2921        03 V-NUM-CONTEO1                  PIC 9(18).              FARF021
  2922        03 V-NUM-CONTEO3                  PIC 9(18) .             FARF021
  2923        03 V-NUM-CONTEO4                  PIC 9(18) .             FARF021
  2924        03 V-NUM-CONTEO5                  PIC 9(18) .             FARF021
  2925        03 V-NUM-CONTEO6                  PIC 9(18) .             FARF021
  2926        03 V-NUM-CONTEO7                  PIC 9(18) .             FARF021
  2927        03 V-NUM-CONTEO8                  PIC 9(18) .             FARF021
  2928        03 V-NUM-CONTEO9                  PIC 9(18) .             FARF021
  2929
  2930 01  FECHAS-BDLDI2.                                               ABB0020
  2931     02 FEC-AAAAMM-BDLDI2              PIC 9(06).                 ABB0020
  2932     02 FEC-MMAA-BDLDI2                PIC 9(04).                 ABB0020
  2933     02 CTA-ACTIVA                     PIC 9(01).                 ABB0020
  2934*
  2935 01 PARAMETROS-BDLDIR.                                            RMB0006
  2936    02 POLITICA-EXC-CAL-DIR-BDLDIR    PIC 9(02) VALUE 0.          RMB0006
  2937    02 POLITICA-EXC-MAL-DIR-BDLDIR    PIC 9(02) VALUE 1.          RMB0006
  2938*** PARAMETROS DE INDICADOR DE DIRECCION CERTIFICADA              RMB0006
  2939    02 DIRCER-BDLDIR                  PIC 9(01).                  RMB0006
  2940*** PARAMETROS DE PUNTOS ADICIONALES                              RMB0006
  2941    02 PTSADI-BDLDIR                  PIC 9(02).                  RMB0006
  2942*** PARANETRO DE CIUDAD ORIGINAL                                  RMB0006
  2943    02 CIUDAD-BDLDIR                  PIC X(20).                  RMB0006
  2944 01 VARIABLES-CIU.                                                RMB0006
  2945    02 I-CIU-BDLDIR                   PIC 9(04).                  RMB0006
  2946    02 J-CIU-BDLDIR                   PIC 9(04).                  RMB0006
  2947    02 CIUDAD-ESTANDAR-CIU-BDLDIR     PIC X(30).                  RMB0006
  2948    02 PATRON-CIU-BDLDIR              PIC 9(03) VALUE 0.          RMB0006
  2949    02 CAMPO-CIU-BDLDIR               PIC X(30) VALUE SPACES.     RMB0006
  2950    02 CODIGO-DANE-CIU-BDLDIR         PIC X(08) VALUE SPACES.     RMB0006
  2951    02 CODIGO-DANE-N-CIU-BDLDIR       REDEFINES                   RMB0006
  2952       CODIGO-DANE-CIU-BDLDIR         PIC 9(08).                  RMB0006
  2953
  2954    02 CODANE-BDLDI2                  PIC 9(08).                  ABB0020
  2955    02 CODIGO-RES                     PIC 9(08).
  2956    02 CODIGO-LAB                     PIC 9(08).
  2957    02 CODIGO-COR                     PIC 9(08).
  2958    02 COD-DPTO                       PIC 9(02) VALUE 0.
  2959    02 FIN-DUPCIUDAD                  PIC 9(01) VALUE 0.
  2960    02 CON-DUPCIUDAD                  PIC 9(03) VALUE 1.
  2961    02 CON1-DUPCIUDAD                 PIC 9(03) VALUE 0.
  2962    02 DUPCIUDAD-BDLDIR               PIC X(20).
  2963    02 SW-DUPCIUDAD                   PIC 9(01) VALUE 0.
  2964
  2965    02 LLAVE-AUX21-CIU-BDLDIR.                                    RMB0006
  2966       03 FILLER                      PIC X(01) VALUE SPACES.     RMB0006
  2967       03 LLAVE-AUX-CIU-BDLDIR        PIC X(20) VALUE SPACES.     RMB0006
  2968    02 OPEN-BDLSTDCIU-BDLDIR          PIC 9(01) VALUE 0.          RMB0006
  2969    02 OPEN-BDLMAIEXC-BDLDIR          PIC 9(01) VALUE 0.          RGH0013
  2970    02 OPEN-BDLTELEXC-BDLDIR          PIC 9(01) VALUE 0.          RGH0013
  2971    02 BASURA-CIU-BDLDIR              PIC X(01) VALUE SPACES.     RMB0006
  2972 01 VARIABLES-TELEXC.                                             HGO0008
  2973     03  W-OCURR                      PIC 99999.                  HGO0008
  2974     03  W-I                          PIC 99999.                  HGO0008
  2975     03  W-POSIUNI                    PIC 99999.                  HGO0008
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  52
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  2976     03  W-TELANT                     PIC X(12).                  HGO0008
  2977     03  W-TELDES                     PIC X(12).                  HGO0008
  2978     03  W-POSANT                     PIC 99999.                  HGO0008
  2979     03  W-POSDES                     PIC 99999.                  HGO0008
  2980     03  W-POSRC                      PIC 99999.                  HGO0008
  2981     03  SW-1                         PIC 9.                      HGO0008
  2982     03  SW-2                         PIC 9.                      HGO0008
  2983     03  SW-ENCUENTRA-PI              PIC 9.                      HGO0008
  2984     03  W-POSI                       PIC 99999.                  HGO0008
  2985     03  LONGCOMP-EXCLU               PIC 99999.                  HGO0008
  2986     03  POSI-EXCLU                   PIC 99999.                  HGO0008
  2987     03  IQ                           PIC 99999.                  HGO0008
  2988     03  FIN-BDLTELEXC-BDLDIR         PIC 9(01) VALUE ZEROS.      RGH0013
  2989*TELEXC 01  TELS-EXCLU.                                           HGO0012
  2990*TELEXC     03 FILLER                     PIC X(12) VALUE "     00HGO0012
  2991*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  2992*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  2993*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  2994*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  2995*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  2996*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  2997*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  2998*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  2999*TELEXC     03 FILLER                     PIC X(12) VALUE "     10HGO0012
  3000*TEXTEL     03 FILLER                     PIC X(12) VALUE "     11HGO0012
  3001*TEXTEL     03 FILLER                     PIC X(12) VALUE "     12HGO0012
  3002*TEXTEL     03 FILLER                     PIC X(12) VALUE "     14HGO0012
  3003*TEXTEL     03 FILLER                     PIC X(12) VALUE "     14HGO0012
  3004*TEXTEL     03 FILLER                     PIC X(12) VALUE "     17HGO0012
  3005*TEXTEL     03 FILLER                     PIC X(12) VALUE "     19HGO0012
  3006*TEXTEL     03 FILLER                     PIC X(12) VALUE "     19HGO0012
  3007*TEXTEL     03 FILLER                     PIC X(12) VALUE "     19HGO0012
  3008*TEXTEL     03 FILLER                     PIC X(12) VALUE "     19HGO0012
  3009*TEXTEL     03 FILLER                     PIC X(12) VALUE "     19HGO0012
  3010*TEXTEL     03 FILLER                     PIC X(12) VALUE "     19HGO0012
  3011*TEXTEL     03 FILLER                     PIC X(12) VALUE "     19HGO0012
  3012*TELEXC     03 FILLER                     PIC X(12) VALUE "       HGO0012
  3013*TELEXC     03 FILLER                     PIC X(12) VALUE "       HGO0012
  3014*TELEXC 01  FILLER                        REDEFINES TELS-EXCLU.   HGO0012
  3015*TEXTEL*TELEXC     02 T-TELS-EXCLU               PIC X(12) OCCURS HGO0012
  3016*TEXTEL     02 T-TELS-EXCLU               PIC X(12) OCCURS 24 TIMEHGO0012
  3017 01  FEC-AUX-BDLDIR                 PIC 9(06).                    RMB0014
  3018 01  TEL-AUX-BDLDIR                 PIC 9(12).                    RMB0014
  3019 01  FILLER REDEFINES TEL-AUX-BDLDIR.                             RMB0014
  3020     04 P1-TEL-AUX-BDLDIR           PIC 9(2).                     RMB0014
  3021     04 P2-TEL-AUX-BDLDIR           PIC 9(3).                     RMB0014
  3022        88 ES-CELULAR-BDLDIR
  3023           VALUES 300,301,304,303,304,305,306,307,308,309, *>TIGO FARF032
  3024                  310,311,312,313,314,320,321,            *>CLARO FARF032
  3025                  315,316,317,318,                     *>MOVISTAR FARF032
  3026                  350.                                  *>AVANTEL FARF032
  3027     04 P3-TEL-AUX-BDLDIIR          PIC 9(7).                     RMB0014
  3028*
  3029*
  3030*CELU01 88 ES-CELULAR-BDLDIR VALUES 300,301,   *>TIGO           RMB0014
  3031*CELU02*                              310,311,312,313,313,320,321,PJV0015
  3032*CELU02                               310,311,312,313,314,320,321,PJV0015
  3033*CELU01                               315,316,317,  *>MOVISTAR    RMB0014
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  53
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3034*CELU01                               350,          *>AVANTEL     RMB0014
  3035*CELU01                               302,303,304,305,306,307,308,RMB0014
  3036*CELU01                               309,318,319,322,323,324,325,RMB0014
  3037*CELU01                               351,352,353,354,355. *>ASIGNRMB0014
  3038*CELU01 4 P3-TEL-AUX-BDLDIIR          PIC 9(7).                   RMB0014
  3039*                                                                 FARF032
  3040 01  VIAS-PRINCIPALES-BDLDIR.                                     FARF032
  3041     02 FILLER       PIC X(5) VALUE "CL   ".                      FARF032
  3042     02 FILLER       PIC X(5) VALUE "KR   ".                      FARF032
  3043     02 FILLER       PIC X(5) VALUE "AV KR".                      FARF032
  3044     02 FILLER       PIC X(5) VALUE "TV   ".                      FARF032
  3045     02 FILLER       PIC X(5) VALUE "AC   ".                      FARF032
  3046     02 FILLER       PIC X(5) VALUE "AK   ".                      FARF032
  3047     02 FILLER       PIC X(5) VALUE "AUTOP".                      FARF032
  3048     02 FILLER       PIC X(5) VALUE "AV   ".                      FARF032
  3049     02 FILLER       PIC X(5) VALUE "CIR  ".                      FARF032
  3050     02 FILLER       PIC X(5) VALUE "DG   ".                      FARF032
  3051     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3052     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3053     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3054     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3055     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3056     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3057     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3058     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3059     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3060     02 FILLER       PIC X(5) VALUE "     ".                      FARF032
  3061 01  FILLER REDEFINES VIAS-PRINCIPALES-BDLDIR.                    FARF032
  3062     02 V-VIAS-PRIN-BDLDIR OCCURS 20 TIMES PIC X(5).              FARF032
  3063*
  3064 01  VARIABLES-BDLDIR.                                            RMB0006
  3065     03 TEL-OK-BDLDIR                  PIC 9(05) VALUE 0.         RMB0006
  3066     03 TABLA-TELFINALES-BDLDIR.                                  RMB0006
  3067        04 T-TELFINALES-BDLDIR         OCCURS 100 TIMES.          RMB0006
  3068*          05 V-TELFIN-BDLDIR          PIC X(12).                 HGO0008
  3069*          05 V-TELFIN-BDLDIR.                                    RGH0009
  3070           05 V-TELFIN-BDLDIR          PIC X(12).                 RGH0009
  3071           05 V-TELFIN-BDLDIR-R        REDEFINES                  RGH0009
  3072              V-TELFIN-BDLDIR.                                    RGH0009
  3073              10 V-TELFIN-BDLDIR-1     PIC X(05).                 HGO0008
  3074              10 V-TELFIN-BDLDIR-2     PIC X(07).                 HGO0008
  3075           05 V-CIUTELFIN-BDLDIR       PIC X(20).                 RMB0006
  3076           05 V-FECTELFIN-BDLDIR       PIC 9(06).                 RMB0006
  3077           05 V-TIPTELFIN-BDLDIR       PIC X(01).                 RMB0006
  3078           05 V-NUMTELFIN-BDLDIR       PIC 9(03).                 RMB0006
  3079           05 V-SUSTELFIN-BDLDIR       PIC 9(06).                 RMB0006
  3080           05 V-HASTELFIN-BDLDIR       PIC X(50).                 RMB0006
  3081           05 V-VECTELFIN-BDLDIR       PIC X(50).                 RMB0006
  3082           05 V-CALTELFIN-BDLDIR       PIC 9(03).                 RMB0006
  3083           05 V-FECULTTELFIN-BDLDIR    PIC 9(06).                 HGO0008
  3084           05 V-DEPTELFIN-BDLDIR       PIC X(20).
  3085           05 V-FECCRETELFIN-BDLDIR    PIC 9(06).                 ABB0020
  3086           05 V-NUMENTTELFIN-BDLDIR    PIC 9(06).                 ABB0020
  3087           05 V-TIPOTEFIN-BDLDIR       PIC 9(01).                 ABB0020
  3088           05 V-SEC01TELFIN-BDLDIR     PIC 9(03).                 FARF021
  3089           05 V-SECUNI01TELFIN-BDLDIR  PIC 9(03).                 FARF021
  3090           05 V-CODDANETELFIN-BDLDIR   PIC 9(08).                 FARF024
  3091*
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  54
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3092     03 TABLA-TEL-BDLDIR.                                         RMB0006
  3093        04 T-TEL-BDLDIR                OCCURS 100 TIMES.          RMB0006
  3094           05 V-TELEFONO-BDLDIR        PIC X(12).                 RMB0006
  3095           05 V-CIUDADTEL-BDLDIR       PIC X(20).                 RMB0006
  3096           05 V-TIPOTEL-BDLDIR         PIC X(15).                 RMB0006
  3097           05 V-FECHATEL-BDLDIR        PIC 9(06).                 RMB0006
  3098           05 V-SUSTEL-BDLDIR          PIC 9(06).                 RMB0006
  3099           05 V-HASTEL-BDLDIR          PIC X(50).                 RMB0006
  3100           05 V-FECULTTEL-BDLDIR       PIC 9(06).                 HGO0008
  3101
  3102           05 V-DEPTEL-BDLDIR          PIC X(20).                 HGO0008
  3103           05 V-FECCRETEL-BDLDIR       PIC 9(06).                 ABB0020
  3104           05 V-NUMENTTEL-BDLDIR       PIC 9(06).                 ABB0020
  3105           05 V-TIPOTE-BDLDIR          PIC 9(01).                 ABB0020
  3106           05 V-SEC00TEL-BDLDIR        PIC 9(03).                 FARF021
  3107           05 V-SECUNI00TEL-BDLDIR     PIC 9(03).                 FARF021
  3108           05 V-CODDANETEL-BDLDIR      PIC 9(08).                 FARF024
  3109
  3110
  3111     03 NUMTEL-BDLDIR                  PIC X(12).                 RMB0006
  3112     03 DIR-OK-BDLDIR                  PIC 9(05).                 RMB0006
  3113*
  3114     03 TABLA-DIRFINALES-BDLDIR.                                  RMB0006
  3115*       TABLA 01DIRXXX                                            FARF021
  3116        04 T-DIRFINALES-BDLDIR         OCCURS 100 TIMES.          RMB0006
  3117           05 V-DIRFIN-BDLDIR          PIC X(60).                 RMB0006
  3118           05 V-PRIPARTFIN-BDLDIR      PIC X(60).                 HGO0011
  3119           05 V-SEGPARTFIN-BDLDIR      PIC X(60).                 HGO0011
  3120           05 V-CIUFIN-BDLDIR          PIC X(20).                 RMB0006
  3121           05 V-TIPFIN-BDLDIR          PIC X(01).                 RMB0006
  3122           05 V-FECFIN-BDLDIR          PIC 9(06).                 RMB0006
  3123           05 V-NUMFIN-BDLDIR          PIC 9(03).                 RMB0006
  3124           05 V-SUSFIN-BDLDIR          PIC 9(06).                 RMB0006
  3125           05 V-HASDIRFIN-BDLDIR       PIC X(100).                RMB0006
  3126           05 V-PRIDIGFIN-BDLDIR       PIC 9(10).                 RMB0006
  3127           05 V-VECFIN-BDLDIR          PIC X(12).                 RMB0006
  3128           05 V-STAFIN-BDLDIR          PIC X(60).                 RMB0006
  3129           05 V-CALFIN-BDLDIR          PIC 9(03).                 RMB0006
  3130           05 V-CALFIN-PART1-BDLDIR    PIC 9(03).                 HGO0011
  3131           05 V-CALFIN-PART2-BDLDIR    PIC 9(03).                 HGO0011
  3132           05 V-FECULTFIN-BDLDIR       PIC 9(06).                 HGO0008
  3133           05 V-NUENOMFIN-BDLDIR       PIC 9(01).                 HGO0008
  3134           05 V-NUMDIRFIN-BDLDIR       PIC X(60).                 HGO0008
  3135
  3136           05 V-DANEFIN-BDLDIR         PIC 9(08).
  3137           05 V-DEPFIN-BDLDIR          PIC X(20).
  3138           05 V-ESTFIN-BDLDIR          PIC X(02).
  3139           05 V-PRBFIN-BDLDIR          PIC X(03).                 HGO0012
  3140           05 V-ZONAFIN-BDLDIR         PIC X(01).                 ABB0020
  3141           05 V-FECCREFIN-BDLDIR       PIC 9(06).                 ABB0020
  3142           05 V-NUMENTFIN-BDLDIR       PIC 9(06).                 ABB0020
  3143           05 V-TIPODIFIN-BDLDIR       PIC 9(01).                 ABB0020
  3144           05 V-NN01DIRFIN-BDLDIR      PIC 9(01).                 FARF021
  3145           05 V-SEC01DIRFIN-BDLDIR     PIC 9(03).                 FARF021
  3146           05 V-SECUNI01DIRFIN-BDLDIR  PIC 9(03).                 FARF021
  3147           05 V-SCORE-DADIRFIN-BDLDIR  PIC 9(5)V9(2).             FARF025
  3148*
  3149     03 V-DANEFIN-BDLDIR-AUX           PIC 9(08).                 FARF019
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  55
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3150*
  3151    03 TABLA-DIRFINALESFIN-BDLDIR.                                HGO0008
  3152*      TABLA 02DIRXXX                                             FARF021
  3153       04 T-DIRFINALESFIN-BDLDIR      OCCURS 100 TIMES.           HGO0008
  3154          05 V-DIRFINFIN-BDLDIR       PIC X(60).                  HGO0008
  3155          05 V-PRIPARTFINFIN-BDLDIR   PIC X(60).                  HGO0011
  3156          05 V-SEGPARTFINFIN-BDLDIR   PIC X(60).                  HGO0011
  3157          05 V-CIUFINFIN-BDLDIR       PIC X(20).                  HGO0008
  3158          05 V-TIPFINFIN-BDLDIR       PIC X(01).                  HGO0008
  3159          05 V-FECFINFIN-BDLDIR       PIC 9(06).                  HGO0008
  3160          05 V-NUMFINFIN-BDLDIR       PIC 9(03).                  HGO0008
  3161          05 V-SUSFINFIN-BDLDIR       PIC 9(06).                  HGO0008
  3162          05 V-HASDIRFINFIN-BDLDIR    PIC X(100).                 HGO0008
  3163          05 V-PRIDIGFINFIN-BDLDIR    PIC 9(10).                  HGO0008
  3164          05 V-VECFINFIN-BDLDIR       PIC X(12).                  HGO0008
  3165          05 V-STAFINFIN-BDLDIR       PIC X(60).                  HGO0008
  3166          05 V-CALFINFIN-BDLDIR       PIC 9(03).                  HGO0008
  3167          05 V-CALFINFIN-PART1-BDLDIR PIC 9(03).                  HGO0011
  3168          05 V-CALFINFIN-PART2-BDLDIR PIC 9(03).                  HGO0011
  3169          05 V-FECULTFINFIN-BDLDIR    PIC 9(06).                  HGO0008
  3170          05 V-NUENOMFINFIN-BDLDIR    PIC 9(01).                  HGO0008
  3171          05 V-NUMDIRFINFIN-BDLDIR    PIC X(60).                  HGO0008
  3172
  3173          05 V-DANEFINFIN-BDLDIR      PIC 9(08).
  3174          05 V-DEPFINFIN-BDLDIR       PIC X(20).
  3175          05 V-ESTFINFIN-BDLDIR       PIC X(02).
  3176          05 V-PRBFINFIN-BDLDIR       PIC X(03).                  HGO0012
  3177          05 V-ZONAFINFIN-BDLDIR      PIC X(01).                  ABB0020
  3178          05 V-FECCREFINFIN-BDLDIR    PIC 9(06).                  ABB0020
  3179          05 V-NUMENTFINFIN-BDLDIR    PIC 9(06).                  ABB0020
  3180          05 V-TIPODIFINFIN-BDLDIR    PIC 9(01).                  ABB0020
  3181          05 V-NN02DIRFINFIN-BDLDIR   PIC 9(01).                  FARF021
  3182          05 V-SEC02DIRFINFIN-BDLDIR  PIC 9(03).                  FARF021
  3183          05 V-SECUNI02DIRFINFIN-BDLDIR PIC 9(03).                FARF021
  3184          05 V-SCORE-DADIRFINFIN-BDLDIR PIC 9(5)V9(2).            FARF025
  3185
  3186
  3187     03 T-DIRFINALESAUX-BDLDIR.                                   HGO0008
  3188        04 V-DIRFINAUX-BDLDIR          PIC X(60).                 HGO0008
  3189        04 V-PRIPARTFINAUX-BDLDIR      PIC X(60).                 HGO0011
  3190        04 V-SEGPARTFINAUX-BDLDIR      PIC X(60).                 HGO0011
  3191        04 V-CIUFINAUX-BDLDIR          PIC X(20).                 HGO0008
  3192        04 V-TIPFINAUX-BDLDIR          PIC X(01).                 HGO0008
  3193        04 V-FECFINAUX-BDLDIR          PIC 9(06).                 HGO0008
  3194        04 V-NUMFINAUX-BDLDIR          PIC 9(03).                 HGO0008
  3195        04 V-SUSFINAUX-BDLDIR          PIC 9(06).                 HGO0008
  3196        04 V-HASDIRFINAUX-BDLDIR       PIC X(100).                HGO0008
  3197        04 V-PRIDIGFINAUX-BDLDIR       PIC 9(10).                 HGO0008
  3198        04 V-VECFINAUX-BDLDIR          PIC X(12).                 HGO0008
  3199        04 V-STAFINAUX-BDLDIR          PIC X(60).                 HGO0008
  3200        04 V-CALFINAUX-BDLDIR          PIC 9(03).                 HGO0008
  3201        04 V-CALFINAUX-PART1-BDLDIR    PIC 9(03).                 HGO0011
  3202        04 V-CALFINAUX-PART2-BDLDIR    PIC 9(03).                 HGO0011
  3203        04 V-FECULTFINAUX-BDLDIR       PIC 9(06).                 HGO0008
  3204        04 V-NUENOMFINAUX-BDLDIR       PIC 9(01).                 HGO0008
  3205        04 V-NUMDIRFINAUX-BDLDIR       PIC X(60).                 HGO0008
  3206
  3207        04 V-DANEFINAUX-BDLDIR         PIC 9(08).
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  56
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3208        04 V-DEPFINAUX-BDLDIR          PIC X(20).
  3209        04 V-ESTFINAUX-BDLDIR          PIC X(02).
  3210        04 V-PRBFINAUX-BDLDIR          PIC X(03).                 HGO0012
  3211        04 V-ZONAFINAUX-BDLDIR         PIC X(01).                 ABB0020
  3212        04 V-FECCREFINAUX-BDLDIR       PIC 9(06).                 ABB0020
  3213        04 V-NUMENTFINAUX-BDLDIR       PIC 9(06).                 ABB0020
  3214        04 V-TIPODIFINAUX-BDLDIR       PIC 9(01).                 ABB0020
  3215        04 V-NN02DIRFINAUX-BDLDIR      PIC 9(01).                 FARF021
  3216        04 V-SEC02DIRFINAUX-BDLDIR     PIC 9(03).                 FARF021
  3217        04 V-SECUNI02DIRINAUX-BDLDIR   PIC 9(03).                 FARF021
  3218        04 V-SCORE-DADIRAUX-BDLDIR     PIC 9(5)V9(2).             FARF025
  3219
  3220
  3221     03 TABLA-DIR-BDLDIR.                                         RMB0006
  3222        04 T-DIR-BDLDIR                OCCURS 100 TIMES.          RMB0006
  3223           05 T-NUMDIR-BDLDIR .                                   RMB0006
  3224              06 V-NUMDIR-BDLDIR       OCCURS 10 TIMES PIC 9(5).  RMB0006
  3225           05 V-CIUDADDIR-BDLDIR       PIC X(20).                 RMB0006
  3226           05 V-DIRECCION-BDLDIR       PIC X(60).                 RMB0006
  3227           05 V-TIPODIR-BDLDIR         PIC X(01).                 RMB0006
  3228           05 V-FECHADIR-BDLDIR        PIC 9(06).                 RMB0006
  3229           05 V-SUSDIR-BDLDIR          PIC 9(06).                 RMB0006
  3230           05 V-HASDIR-BDLDIR          PIC X(100).                RMB0006
  3231           05 V-PRIDIG-BDLDIR          PIC 9(10).                 RMB0006
  3232           05 V-FECULT-BDLDIR          PIC 9(06).                 HGO0008
  3233           05 V-NUENOM-BDLDIR          PIC 9(01) VALUES 0.        HGO0008
  3234
  3235           05 V-DANEDIR-BDLDIR         PIC 9(08).
  3236           05 V-DEPTODIR-BDLDIR        PIC X(20).
  3237           05 V-ESTRATODIR-BDLDIR      PIC X(02).
  3238           05 V-PRBENTDIR-BDLDIR       PIC X(03).                 HGO0012
  3239           05 V-ZONADIR-BDLDIR         PIC X(01).                 ABB0020
  3240           05 V-FECCRE-BDLDIR          PIC 9(06).                 ABB0020
  3241           05 V-NUMENT-BDLDIR          PIC 9(06).                 ABB0020
  3242           05 V-TIPODI-BDLDIR          PIC 9(01).                 ABB0020
  3243           05 V-INDGESTION-BDLDIR      PIC X(03).                 FARF023
  3244           05 V-ENCONTRADA-BDLDIR      PIC X(03).                 FARF023
  3245           05 V-DIRNN00DIR-BDLDIR      PIC X(30).                 FARF021
  3246           05 V-SEC00DIR-BDLDIR        PIC 9(03).                 FARF021
  3247           05 V-SECUNI00DIR-BDLDIR     PIC 9(03).                 FARF021
  3248
  3249
  3250     03   TABLA-FECHADIR-AUX-BDLDIR.                              RMB0006
  3251           04 O-FECHADIR-AUX-BDLDIR    OCCURS 100 TIMES.          RMB0006
  3252              05 V-FECHADIR-AUX-BDLDIR PIC 9(06).                 RMB0006
  3253
  3254    03 CEL-OK-BDLDIR                  PIC 9(05) VALUE 0.
  3255    03 TABLA-CELFINALES-BDLDIR.
  3256       04 T-CELFINALES-BDLDIR         OCCURS 100 TIMES.
  3257          05 V-CELFIN-BDLDIR          PIC X(12).
  3258          05 V-CELFIN-BDLDIR-R        REDEFINES
  3259             V-CELFIN-BDLDIR.
  3260             10 V-CELFIN-BDLDIR-1     PIC X(05).
  3261             10 V-CELFIN-BDLDIR-2     PIC X(07).
  3262          05 V-FECCELFIN-BDLDIR       PIC 9(06).
  3263          05 V-NUMCELFIN-BDLDIR       PIC 9(03).
  3264          05 V-SUSCELFIN-BDLDIR       PIC 9(06).
  3265          05 V-HASCELFIN-BDLDIR       PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  57
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3266          05 V-VECCELFIN-BDLDIR       PIC X(50).
  3267          05 V-CALCELFIN-BDLDIR       PIC 9(03).
  3268          05 V-FECULTCELFIN-BDLDIR    PIC 9(06).
  3269          05 V-ORIGENCELFIN-BDLDIR    PIC 9(01).
  3270          05 V-INDICACELFIN-BDLDIR    PIC 9(01).
  3271          05 V-FECCRECELFIN-BDLDIR    PIC 9(06).                  ABB0020
  3272          05 V-NUMENTCELFIN-BDLDIR    PIC 9(06).                  ABB0020
  3273          05 V-SEC01CELFIN-BDLDIR     PIC 9(03).                  FARF021
  3274          05 V-SECUNI01CELFIN-BDLDIR  PIC 9(03).                  FARF021
  3275*
  3276    03 TABLA-CEL-BDLDIR.
  3277       04 T-CEL-BDLDIR                OCCURS 100 TIMES.
  3278          05 V-CELULAR-BDLDIR         PIC X(12).
  3279          05 V-FECHACEL-BDLDIR        PIC 9(06).
  3280          05 V-SUSCEL-BDLDIR          PIC 9(06).
  3281          05 V-HASCEL-BDLDIR          PIC X(50).
  3282          05 V-FECULTCEL-BDLDIR       PIC 9(06).
  3283          05 V-ORIGENCEL-BDLDIR       PIC 9(01).
  3284          05 V-FECCRECEL-BDLDIR       PIC 9(06).                  ABB0020
  3285          05 V-NUMENTCEL-BDLDIR       PIC 9(06).                  ABB0020
  3286          05 V-SEGMENTO-BDLDIR        PIC X(1). *>Lab,Res,Cel,Dim FARF023
  3287          05 V-SEC00CEL-BDLDIR        PIC 9(03).                  FARF021
  3288          05 V-SECUNI00CEL-BDLDIR     PIC 9(03).                  FARF021
  3289*
  3290    03 NUMCEL-BDLDIR                  PIC X(12).
  3291    03 MAIL-OK-BDLDIR                 PIC 9(05) VALUE 0.
  3292    03 TABLA-MAILFINALES-BDLDIR.
  3293       04 T-MAILFINALES-BDLDIR        OCCURS 100 TIMES.
  3294          05 V-MAILFIN-BDLDIR         PIC X(40).                  FARF021
  3295          05 V-FECMAILFIN-BDLDIR      PIC 9(06).
  3296          05 V-NUMMAILFIN-BDLDIR      PIC 9(03).
  3297          05 V-SUSMAILFIN-BDLDIR      PIC 9(06).
  3298          05 V-HASMAILFIN-BDLDIR      PIC X(50).
  3299          05 V-VECMAILFIN-BDLDIR      PIC X(50).
  3300          05 V-CALMAILFIN-BDLDIR      PIC 9(03).
  3301          05 V-FECULTMAILFIN-BDLDIR   PIC 9(06).
  3302          05 V-ORIGENMAILFIN-BDLDIR   PIC 9(01).
  3303          05 V-INDICAMAILFIN-BDLDIR   PIC 9(01).
  3304          05 V-FECCREMAILFIN-BDLDIR   PIC 9(06).                  ABB0020
  3305          05 V-NUMENTMAILFIN-BDLDIR   PIC 9(06).                  ABB0020
  3306          05 V-SEC01MAILFIN-BDLDIR    PIC 9(03).                  FARF021
  3307          05 V-SECUNI01MAILFIN-BDLDIR PIC 9(03).                  FARF021
  3308*
  3309    03 TABLA-MAIL-BDLDIR.
  3310       04 T-MAIL-BDLDIR               OCCURS 100 TIMES.
  3311          05 V-MAIL-BDLDIR            PIC X(40).                  FARF021
  3312          05 V-FECHAMAIL-BDLDIR       PIC 9(06).
  3313          05 V-SUSMAIL-BDLDIR         PIC 9(06).
  3314          05 V-HASMAIL-BDLDIR         PIC X(50).
  3315          05 V-FECULTMAIL-BDLDIR      PIC 9(06).
  3316          05 V-ORIGENMAIL-BDLDIR      PIC 9(01).
  3317          05 V-FECCREMAIL-BDLDIR      PIC 9(06).                  ABB0020
  3318          05 V-NUMENTMAIL-BDLDIR      PIC 9(06).                  ABB0020
  3319          05 V-SEC00MAIL-BDLDIR       PIC 9(03).                  FARF021
  3320          05 V-SECUNI00MAIL-BDLDIR    PIC 9(03).                  FARF021
  3321*
  3322    03 NUMMAIL-BDLDIR                 PIC X(40).                  FARF021
  3323    03 TABLA-DUPCIUDAD.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  58
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3324       04 T-DUPCIUDAD                 OCCURS 100 TIMES.
  3325          05 CIUDAD-DUPCIUDAD         PIC X(20).
  3326    03 TABLA-TRA-BDLDIR.                                          ABB0022
  3327******************************************************************ABB0022
  3328*   VECTOR DE 100 POSICIONES QUE GUARDA LAS DESCRIPCIONES DE LOS *ABB0022
  3329*   CAMPOS NUEVOS ZONA, TIPO DE DIRECCION Y TIPO DE TELEFONO     *ABB0022
  3330*        V-ZON-BDLDIR  ZONA                                      *ABB0022
  3331*        V-TDI-BDLDIR  TIPO DE DIRECCION                         *ABB0022
  3332*        V-TTE-BDLDIR  TIPO DE TELEFONO                          *ABB0022
  3333*                                                                *ABB0022
  3334******************************************************************ABB0022
  3335       04 T-TRA-BDLDIR                OCCURS 100 TIMES.           ABB0022
  3336          05 V-ZON-BDLDIR             PIC X(03).                  ABB0022
  3337          05 V-TDI-BDLDIR             PIC X(15).                  ABB0022
  3338          05 V-TTE-BDLDIR             PIC X(15).                  ABB0022
  3339******************************************************************ABB0022
  3340*   TABLA QUE CONTIENE EL VECTOR DE COMPORTAMIENTO DE DIRECCIONES*ABB0022
  3341*   EN LOS ULTIMOS 24 MESES ANTERIORES AL MES ACTUAL             *ABB0022
  3342*        T-MES-BDLDIR AAAAMM ANNO MES                            *ABB0022
  3343*        T-VRE-BDLDIR VECTOR DIRECCION RESIDENCIA(I=IGUAL,N=NUEVA*ABB0022
  3344*        T-VLA-BDLDIR VECTOR DIRECCION LABORAL                   *ABB0022
  3345*        T-VCR-BDLDIR VECTOR DIRECCION CORRESPONDENCIA           *ABB0022
  3346*                                                                *ABB0022
  3347******************************************************************ABB0022
  3348    03 TABLA-VEC-BDLDIR.                                          ABB0022
  3349       04 T-MES-BDLDIR                PIC 9(06) OCCURS 24 TIMES.  ABB0022
  3350       04 T-VRE-BDLDIR                PIC X(24).                  ABB0022
  3351       04 T-VLA-BDLDIR                PIC X(24).                  ABB0022
  3352       04 T-VCR-BDLDIR                PIC X(24).                  ABB0022
  3353    03 FECHA-VEC-BDLDIR               PIC 9(08).                  ABB0022
  3354    03 FECHA-VEC-BDLDIR-R REDEFINES FECHA-VEC-BDLDIR.             ABB0022
  3355       04 ANOMES-VEC-BDLDIR           PIC 9(06).                  ABB0022
  3356       04 ANOMES-VEC-BDLDIR-R REDEFINES ANOMES-VEC-BDLDIR.        ABB0022
  3357          05 ANO-VEC-BDLDIR           PIC 9(04).                  ABB0022
  3358          05 MES-VEC-BDLDIR           PIC 9(02).                  ABB0022
  3359       04 DIA-VEC-BDLDIR              PIC 9(02).                  ABB0022
  3360    03 I-TRA-BDLDIR                   PIC 9(04).                  ABB0022
  3361    03 J-TRA-BDLDIR                   PIC 9(04).                  ABB0022
  3362    03 K-TRA-BDLDIR                   PIC 9(04).                  ABB0022
  3363    03 W-RES-BDLDIR                   PIC 9(01).                  ABB0022
  3364    03 W-LAB-BDLDIR                   PIC 9(01).                  ABB0022
  3365    03 W-CRR-BDLDIR                   PIC 9(01).                  ABB0022
  3366    03 TABLA-SUS-BDLDIR.                                          ABB0020
  3367       04 T-SUS-BDLDIR                OCCURS 100 TIMES.           ABB0020
  3368          05 V-SUS-BDLDIR             PIC 9(11).                  ABB0020
  3369    03 N-SUS-BDLDIR                   PIC 9(11).                  ABB0020
  3370    03 I-SUS-BDLDIR                   PIC 9(04).                  ABB0020
  3371    03 J-SUS-BDLDIR                   PIC 9(04).                  ABB0020
  3372    03 K-SUS-BDLDIR                   PIC 9(04).                  ABB0020
  3373    03 I-RES-BDLDIR                   PIC 9(01).                  ABB0020
  3374    03 I-LAB-BDLDIR                   PIC 9(01).                  ABB0020
  3375    03 I-COR-BDLDIR                   PIC 9(01).                  ABB0020
  3376    03 I-SDT-BDLDIR                   PIC 9(01).                  ABB0020
  3377
  3378    03 FECHA-RUTINA-BDLDIR.                                       RMB0006
  3379       05 ANO-RUTINA-BDLDIR           PIC 9(04).                  RMB0006
  3380       05 MES-RUTINA-BDLDIR           PIC 9(02).                  RMB0006
  3381    03 VEC-HIS-BDLDIR                 PIC X(12).                  RMB0006
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  59
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3382    03 NUMDIR-BDLDIR                  PIC X(50).                  RMB0006
  3383    03 DIRECCION-BDLDIR               PIC X(60).                  HGO0011
  3384    03 T-CARDIR-BDLDIR.                                           RMB0006
  3385       04 V-CARDIR-BDLDIR             OCCURS 60 TIMES PIC X(01).  RMB0006
  3386    03 T-CARTOT-BDLDIR.                                           RMB0006
  3387       04 V-CARTOT-BDLDIR             OCCURS 10 TIMES PIC 9(05).  RMB0006
  3388    03 CAR-ANT-BDLDIR                 PIC X(01).                  RMB0006
  3389    03 CAR-ACT-BDLDIR                 PIC 9(01).                  RMB0006
  3390    03 FECHA-MEJOR-BDLDIR             PIC 9(06) VALUE 0.          RMB0006
  3391    03 IND-DIRCER-BDLDIR              PIC 9(01) VALUE 0.          RMB0006
  3392    03 SEC-BDLDIR                     PIC 9(03).                  FARF021
  3393    03 UNI-BDLDIR                     PIC 9(03).                  FARF021
  3394    03 COMPO                          PIC 9(05) VALUE 0.          HGO0008
  3395    03 RMAYOR                         PIC 9(01) VALUE 0.          HGO0008
  3396    03 CAMBIO                         PIC 9(01) VALUE 0.          HGO0008
  3397    03 NN                             PIC 9(01) VALUE 0.          HGO0008
  3398    03 CONTA                          PIC 9(05) VALUE 0.          HGO0008
  3399    03 CONTA1                         PIC 9(05) VALUE 0.          HGO0008
  3400    03 DIRECCION                      PIC X(60) VALUE SPACES.     HGO0008
  3401    03 DIRECCION1                     PIC X(60) VALUE SPACES.     HGO0008
  3402    03 DIRECCION2                     PIC X(60) VALUE SPACES.     HGO0008
  3403*
  3404     03 E-BDLDIR                       PIC 9(05) VALUE 0.         HGO0008
  3405     03 F-BDLDIR                       PIC 9(05) VALUE 0.         HGO0008
  3406     03 G-BDLDIR                       PIC 9(05) VALUE 0.         HGO0008
  3407     03 H-BDLDIR                       PIC 9(05) VALUE 0.         HGO0008
  3408     03 HAY-NUMEROS4-VIAS-BDLDIR       PIC 9(05) VALUE 0.         FARF032
  3409     03 HAY-NUMEROS-BDLDIR             PIC 9(05) VALUE 0.         FARF032
  3410     03 HAY-LETRAS-BDLDIR              PIC 9(05) VALUE 0.         FARF032
  3411     03 HAY-MASDE3-REPETIDAS-BDLDIR    PIC 9(05) VALUE 0.         FARF032
  3412     03 CONT-REPETIDAS-BDLDIR          PIC 9(05) VALUE 0.         FARF032
  3413     03 HAY-PRIMERA-MALA-BDLDIR        PIC 9(05) VALUE 0.         FARF032
  3414     03 I-BDLDIR                       PIC 9(05) VALUE 0.         RMB0006
  3415     03 J-BDLDIR                       PIC 9(05) VALUE 0.         RMB0006
  3416     03 J1-BDLDIR                      PIC 9(05) VALUE 0.         HGO0011
  3417     03 J2-BDLDIR                      PIC 9(05) VALUE 0.         HGO0011
  3418     03 CONTADOR-TEMPORAL-BDLDIR       PIC 9(03).                 HGO0011
  3419     03 M-BDLDIR                       PIC 9(05) VALUE 0.         RMB0006
  3420     03 N-BDLDIR                       PIC 9(05) VALUE 0.         RMB0006
  3421     03 K-BDLDIR                       PIC 9(05) VALUE 0.         RMB0006
  3422     03 II-BDLDIR                      PIC 9(05) VALUE 0.         RMB0006
  3423     03 JJ-BDLDIR                      PIC 9(05) VALUE 0.         RMB0006
  3424     03 NUM-OK-SEND-BDLDIR             PIC 9(05) VALUE 0.         RMB0006
  3425     03 I-STA-BDLDIR                   PIC 9(05) VALUE 0.         RMB0006
  3426     03 J-STA-BDLDIR                   PIC 9(05) VALUE 0.         RMB0006
  3427     03 K-STA-BDLDIR                   PIC 9(05) VALUE 0.         RMB0006
  3428     03 II-STA-BDLDIR                  PIC 9(05) VALUE 0.         RMB0006
  3429     03 JJ-STA-BDLDIR                  PIC 9(05) VALUE 0.         RMB0006
  3430     03 KK-STA-BDLDIR                  PIC 9(05) VALUE 0.         RMB0006
  3431     03 CALIFICA-DIR-BDLDIR            PIC 9(03) VALUE 0.         RMB0006
  3432     03 SW-PART-VAL-BDLDIR             PIC 9(01) VALUE 0.         HGO0012
  3433     03 CON-PART-ESTANDARIZADA-BDLDIR  PIC 9(03) VALUE 0.         HGO0011
  3434     03 CALIFICA-DIRPART1-BDLDIR       PIC 9(03) VALUE 0.         HGO0011
  3435     03 CALIFICA-DIRPART2-BDLDIR       PIC 9(03) VALUE 0.         HGO0011
  3436     03 CALIFICA-REAL-BDLDIR           PIC 9(03) VALUE 0.         RMB0006
  3437     03 CAMPOS-N-DIR-BDLDIR            PIC 9(03) VALUE 0.         RMB0006
  3438     03 COSI-DIR-BDLDIR                PIC 9(09) VALUE 0.         RMB0006
  3439     03 RESI-DIR-BDLDIR                PIC 9(09) VALUE 0.         RMB0006
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  60
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3440     03 TELE-DIR-BDLDIR                PIC 9(12) VALUE 0.         RMB0006
  3441*** NOMBRE DEL ARCHIVO DE DIRECCIONES CERTIFICADAS                RMB0006
  3442    03 TITLE-BDLSTDCER                PIC X(80) VALUE             RMB0006
  3443       "$DATABASE/BDLSTDCER".                                     RMB0006
  3444*** LA SIGUIENTE VARIBALE INDICA EL TIPO DE DATO EN PROCESO ASI:  RMB0006
  3445*** R - RESIDENCIA                                                RMB0006
  3446*** L - LABORAL                                                   RMB0006
  3447*** C - CORRESPONDENCIA                                           RMB0006
  3448    03 IND-DATO-BDLDIR                PIC X(01).                  RMB0006
  3449*** VARIABLE QUE CONTIENE LA SUMATORIA DE LOS DIGITOS DE LAS      RMB0006
  3450*** PARTICULAS NUMERICAS DE UNA DIRECCION                         RMB0006
  3451    03 SUM-DIGITOS-BDLDIR             PIC 9(10).                  RMB0006
  3452    03 CAL-TEL-BDLDIR                 PIC 9(03) VALUE 0.          RMB0006
  3453    02 TELEFONO-BDLDIR                PIC 9(12) VALUE 0.          RMB0006
  3454    02 MAIL-BDLDIR                    PIC X(40).                  FARF021
  3455    02 CAL-MAIL-BDLDIR                PIC 9(03) VALUE 0.
  3456***************************VARIABLES DE STANDARIZAR************** RMB0006
  3457 01 DIRACC-BDLDIR-BDLDIR.                                         RMB0006
  3458    03 VALIDACION-DIR-OUT-BDLDIR      PIC 9(01).                  RMB0006
  3459    03 PRIVILEGIO-INPUT-BDLDIR        PIC 9(01).                  RMB0006
  3460    03 NIT-CONSULTANTE-INPUT-BDLDIR   PIC 9(11).                  RMB0006
  3461 01  FDA-DIREST-BDLDIR                PIC 9(01).                  RMB0006
  3462 01  IND-TIPCAR-BDLDIR                PIC X(01).                  RMB0006
  3463 01  TIPCAR-WS-BDLDIR                 PIC X(01).                  RMB0006
  3464 01  ENC-DIREST-BDLDIR                PIC 9(01).                  RMB0006
  3465* 01 TABLA-DIR-ESTANDAR-BDLDIR         OCCURS 500 TIMES           RMB0006
  3466 01 TABLA-DIR-ESTANDAR-BDLDIR         OCCURS 2000 TIMES           PJV0017
  3467    ASCENDING KEY IS DIR-ORIGINAL-BDLDIR                          RMB0006
  3468    INDEXED   BY  I-DIR-ESTANDAR-BDLDIR.                          RMB0006
  3469    03 DIR-ORIGINAL-BDLDIR            PIC X(20).                  RMB0006
  3470    03 DIR-ESTANDAR-BDLDIR            PIC X(10).                  RMB0006
  3471* 01 TABLA-DIR-COMPUESTAS-BDLDIR.                                 RMB0006
  3472*    03 DIR-COMPUESTAS-AST-BDLDIR      PIC X(20) OCCURS 90 TIMES. RMB0006
  3473*    03 DIR-COMPUESTAS-BLN-BDLDIR      PIC X(20) OCCURS 90 TIMES. RMB0006
  3474*    03 DIR-COMPUESTAS-LON-BDLDIR      PIC 9(02) OCCURS 90 TIMES. RMB0006
  3475*    03 DIR-COMPUESTAS-TIP-BDLDIR      PIC 9(01) OCCURS 90 TIMES. RMB0006
  3476 01 TABLA-DIR-COMPUESTAS-BDLDIR.                                  PJV0017
  3477    03 DIR-COMPUESTAS-AST-BDLDIR      PIC X(20) OCCURS 500 TIMES. PJV0017
  3478    03 DIR-COMPUESTAS-BLN-BDLDIR      PIC X(20) OCCURS 500 TIMES. PJV0017
  3479    03 DIR-COMPUESTAS-LON-BDLDIR      PIC 9(02) OCCURS 500 TIMES. PJV0017
  3480    03 DIR-COMPUESTAS-TIP-BDLDIR      PIC 9(01) OCCURS 500 TIMES. PJV0017
  3481 01 TIP-NUEVA-DIRECCION-BDLDIR.                                   RMB0006
  3482    03 TIP-NVA-DIR-BDLDIR             PIC X(01) OCCURS 60 TIMES.  RMB0006
  3483 01 NUEVA-DIRECCION-BDLDIR.                                       RMB0006
  3484    03 NVA-DIR-BDLDIR                 PIC X(60) OCCURS 60 TIMES.  RMB0006
  3485 01 DIRECCION-A-ESTANDARIZAR-BDLDIR.                              RMB0006
  3486    03 DIR-A-EST-BDLDIR               PIC X(01) OCCURS 60 TIMES.  RMB0006
  3487*** VARIABLES QUE CONTIENE LA CIUDAD ORIGINAL                     RMB0006
  3488 01 CIUDAD-RES-A-ESTANDAR-BDLDIR      PIC X(20).                  RMB0006
  3489 01 CIUDAD-LAB-A-ESTANDAR-BDLDIR      PIC X(20).                  RMB0006
  3490 01 CIUDAD-COR-A-ESTANDAR-BDLDIR      PIC X(20).                  RMB0006
  3491 01 PART-A-ESTANDARIZAR-BDLDIR.                                   RMB0006
  3492    03 PART-A-ESTAN-BDLDIR            PIC X(01) OCCURS 60 TIMES.  RMB0006
  3493 01 PART-ESTANDARIZADA-BDLDIR         PIC X(60).                  RMB0006
  3494 01 PRIPART-ESTANDARIZADA-BDLDIR      PIC X(60).                  HGO0011
  3495 01 SEGPART-ESTANDARIZADA-BDLDIR      PIC X(60).                  HGO0011
  3496 01 DIRECCION-ESTANDARIZADA-BDLDIR    PIC X(60).                  RMB0006
  3497 01 DIRECCION-AUX-BDLDIR              PIC X(60).                  RMB0006
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  61
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.W
  3498 01 DIRECCION-62-BDLDIR.                                          RMB0006
  3499    03 FILLER                         PIC X(01) VALUE SPACES.     RMB0006
  3500    03 DIRECCION-60-BDLDIR            PIC X(60).                  RMB0006
  3501    03 FILLER                         PIC X(01) VALUE SPACES.     RMB0006
  3502 01 DIR-COMPUESTAS-BLN-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006
  3503 01 DIR-COMPUESTAS-AST-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006
  3504 01 CASO-NUMEROLETRA-BDLDIR           PIC 9(01) VALUE 0.          RMB0006
  3505 01 VAR-RUTINA-NEWDIRBOG-BDLDIR.                                  GJC0007
  3506    02 LETRA-BDLDIR             PIC X.                            GJC0007
  3507    02 ORDEN-ASCII-BDLDIR       PIC 9(03) VALUE 0.                GJC0007
  3508    02 TOTAL-ASCII-BDLDIR       PIC 9(10).                        GJC0007
  3509    02 NN8-BDLDIR               PIC 9(05).                        GJC0007
  3510    02 NN9-BDLDIR               PIC 9(05).                        GJC0007
  3511    02 NN10-BDLDIR              PIC 9(05).                        GJC0007
  3512    02 I-MEJ-BDLDIR          PIC 9(3) VALUE 0.                    GJC0007
  3513    02 J-MEJ-BDLDIR          PIC 9(3) VALUE 0.                    GJC0007
  3514    02 K-MEJ-BDLDIR          PIC 9(3) VALUE 0.                    GJC0007
  3515*   02 CAR-ANT-BDLDIR        PIC X(1) VALUE SPACES.               GJC0007
  3516*   02 CAR-ACT-BDLDIR        PIC 9(1) VALUE 0.                    GJC0007
  3517    02 T-L-BDLDIR.                                                GJC0007
  3518       03 L-BDLDIR OCCURS 30 TIMES PIC X(20).                     GJC0007
  3519    02 T-NUMMEJ-BDLDIR.                                           GJC0007
  3520       04 V-NUMMEJ-BDLDIR    OCCURS 10 TIMES PIC 9(5).            GJC0007
  3521    02 T-CARMEJ-BDLDIR.                                           GJC0007
  3522       04 V-CARMEJ-BDLDIR OCCURS 60 TIMES PIC X.                  GJC0007
  3523    02 T-LETRAS-BDLDIR.                                           GJC0007
  3524       04 V-LETRAS-BDLDIR OCCURS 200 TIMES PIC X.                 GJC0007
  3525 01 VAR-NEWDIR.                                                   GJC0007
  3526    02 OPEN-BDLNEWDIRBOG-BDLDIR     PIC 9 VALUE 0.                GJC0007
  3527    02 HAY-BDLNEWDIRBOG-BDLDIR      PIC 9 VALUE 0.                GJC0007
  3528    02 CIUDAD-BTA-BDLDIR            PIC X(15).                    GJC0007
  3529    02 DIRECCION-BTA-BDLDIR         PIC X(60).                    GJC0007
  3530    02 SW-NN                        PIC 9 VALUE 0.                PJV0016
  3531*
  3532* variables para indicar el ordenamiento del modelo
  3533 01  SW-NEWORD                      PIC 9 VALUE 0.                FARF025
  3534 01  SW-NEWORDPN                    PIC 9 VALUE 0.                FARF025
  3535 01  SW-NEWORDPJ                    PIC 9 VALUE 0.                FARF025
  3536*ADICIONALES DE DIRECCIONES +
* 3537 COPY BDLSTDMAI.WS.
  3538*BDLSTDMAI.WS.0001
  3539**********************************************************************
  3540*VARIABLES PARA ACEPCIONES DE EMAILS
  3541**********************************************************************
  3542 01  VARIABLES-BDLSTDMAI.
  3543     02 TITLE-BDLSTDMAI              PIC X(80) VALUE
  3544        "$DATABASE/BDLSTDMAI" .
  3545     02 WS-OPEN-BDLSTDMAI            PIC 9 VALUE 0.
  3546     02 WS-NOHAY-BDLSTDMAI           PIC 9 VALUE 0.
  3547     02 WS-REGL-BDLSTDMAI            PIC 9 VALUE 0.
  3548     02 WS-ACEP-BDLSTDMAI            PIC 9 VALUE 0.
  3549     02 WS-I-BDLSTDMAI               PIC 9(5) VALUE 0.
  3550     02 WS-J-BDLSTDMAI               PIC 9(5) VALUE 0.
  3551     02 WS-P1-BDLSTDMAI              PIC X(60) VALUE SPACES.
  3552     02 WS-P2-BDLSTDMAI              PIC X(60) VALUE SPACES.
  3553     02 WS-P3-BDLSTDMAI              PIC X(60) VALUE SPACES.
  3554     02 WS-MAIL-BDLSTDMAI            PIC X(60) VALUE SPACES.
  3555     02 WS-ACEP-MAIL-BDLSTDMAI       PIC X(60) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  62
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLSTDMA
  3556     02 WS-REGL-MAIL-BDLSTDMAI       PIC X(60) VALUE SPACES.
  3557     02 WS-ORIG-MAIL-BDLSTDMAI       PIC X(60) VALUE SPACES.
  3558*
* 3559 COPY DEPTOSDANE.WS.
  3560*DEPTOSDANE-WS.v.0002
  3561******************************************************************
  3562* TABLA DE DEPARTAMENTOS CODIFICACION DANE                       *
  3563* REQ196   * para estandarizar se cambia BOGOTA,D.C POR          *
  3564* G.DESARR.* BOGOTA, D.C.                                        *
  3565* 6/MAY/10 *                                                     *
  3566******************************************************************
  3567 01  TABLA-DEPTOS-DANE.
  3568     03 FILLER    PIC X(20) VALUE "                    ". *>001
  3569     03 FILLER    PIC X(20) VALUE "                    ". *>002
  3570     03 FILLER    PIC X(20) VALUE "                    ". *>003
  3571     03 FILLER    PIC X(20) VALUE "                    ". *>004
  3572     03 FILLER    PIC X(20) VALUE "ANTIOQUIA           ". *>005
  3573     03 FILLER    PIC X(20) VALUE "                    ". *>006
  3574     03 FILLER    PIC X(20) VALUE "                    ". *>007
  3575     03 FILLER    PIC X(20) VALUE "ATLANTICO           ". *>008
  3576     03 FILLER    PIC X(20) VALUE "                    ". *>009
  3577     03 FILLER    PIC X(20) VALUE "                    ". *>000
  3578     03 FILLER    PIC X(20) VALUE "BOGOTA, D.C.        ". *>011
  3579     03 FILLER    PIC X(20) VALUE "                    ". *>012
  3580     03 FILLER    PIC X(20) VALUE "BOLIVAR             ". *>013
  3581     03 FILLER    PIC X(20) VALUE "                    ". *>014
  3582     03 FILLER    PIC X(20) VALUE "BOYACA              ". *>015
  3583     03 FILLER    PIC X(20) VALUE "                    ". *>016
  3584     03 FILLER    PIC X(20) VALUE "CALDAS              ". *>017
  3585     03 FILLER    PIC X(20) VALUE "CAQUETA             ". *>018
  3586     03 FILLER    PIC X(20) VALUE "CAUCA               ". *>019
  3587     03 FILLER    PIC X(20) VALUE "CESAR               ". *>020
  3588     03 FILLER    PIC X(20) VALUE "                    ". *>021
  3589     03 FILLER    PIC X(20) VALUE "                    ". *>022
  3590     03 FILLER    PIC X(20) VALUE "CORDOBA             ". *>023
  3591     03 FILLER    PIC X(20) VALUE "                    ". *>024
  3592     03 FILLER    PIC X(20) VALUE "CUNDINAMARCA        ". *>025
  3593     03 FILLER    PIC X(20) VALUE "                    ". *>026
  3594     03 FILLER    PIC X(20) VALUE "CHOCO               ". *>027
  3595     03 FILLER    PIC X(20) VALUE "                    ". *>028
  3596     03 FILLER    PIC X(20) VALUE "                    ". *>029
  3597     03 FILLER    PIC X(20) VALUE "                    ". *>030
  3598     03 FILLER    PIC X(20) VALUE "                    ". *>031
  3599     03 FILLER    PIC X(20) VALUE "                    ". *>032
  3600     03 FILLER    PIC X(20) VALUE "                    ". *>033
  3601     03 FILLER    PIC X(20) VALUE "                    ". *>034
  3602     03 FILLER    PIC X(20) VALUE "                    ". *>035
  3603     03 FILLER    PIC X(20) VALUE "                    ". *>036
  3604     03 FILLER    PIC X(20) VALUE "                    ". *>037
  3605     03 FILLER    PIC X(20) VALUE "                    ". *>038
  3606     03 FILLER    PIC X(20) VALUE "                    ". *>039
  3607     03 FILLER    PIC X(20) VALUE "                    ". *>040
  3608     03 FILLER    PIC X(20) VALUE "HUILA               ". *>041
  3609     03 FILLER    PIC X(20) VALUE "                    ". *>042
  3610     03 FILLER    PIC X(20) VALUE "                    ". *>043
  3611     03 FILLER    PIC X(20) VALUE "LA GUAJIRA          ". *>044
  3612     03 FILLER    PIC X(20) VALUE "                    ". *>045
  3613     03 FILLER    PIC X(20) VALUE "                    ". *>046
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  63
* S)))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/DEPTOSDA
  3614     03 FILLER    PIC X(20) VALUE "MAGDALENA           ". *>047
  3615     03 FILLER    PIC X(20) VALUE "                    ". *>048
  3616     03 FILLER    PIC X(20) VALUE "                    ". *>049
  3617     03 FILLER    PIC X(20) VALUE "META                ". *>050
  3618     03 FILLER    PIC X(20) VALUE "                    ". *>051
  3619     03 FILLER    PIC X(20) VALUE "NARI/O              ". *>052
  3620     03 FILLER    PIC X(20) VALUE "                    ". *>053
  3621     03 FILLER    PIC X(20) VALUE "NORTE DE SANTANDER  ". *>054
  3622     03 FILLER    PIC X(20) VALUE "                    ". *>055
  3623     03 FILLER    PIC X(20) VALUE "                    ". *>056
  3624     03 FILLER    PIC X(20) VALUE "                    ". *>057
  3625     03 FILLER    PIC X(20) VALUE "                    ". *>058
  3626     03 FILLER    PIC X(20) VALUE "                    ". *>059
  3627     03 FILLER    PIC X(20) VALUE "                    ". *>060
  3628     03 FILLER    PIC X(20) VALUE "                    ". *>061
  3629     03 FILLER    PIC X(20) VALUE "                    ". *>062
  3630     03 FILLER    PIC X(20) VALUE "QUINDIO             ". *>063
  3631     03 FILLER    PIC X(20) VALUE "                    ". *>064
  3632     03 FILLER    PIC X(20) VALUE "                    ". *>065
  3633     03 FILLER    PIC X(20) VALUE "RISARALDA           ". *>066
  3634     03 FILLER    PIC X(20) VALUE "                    ". *>067
  3635     03 FILLER    PIC X(20) VALUE "SANTANDER           ". *>068
  3636     03 FILLER    PIC X(20) VALUE "                    ". *>069
  3637     03 FILLER    PIC X(20) VALUE "SUCRE               ". *>070
  3638     03 FILLER    PIC X(20) VALUE "                    ". *>071
  3639     03 FILLER    PIC X(20) VALUE "                    ". *>072
  3640     03 FILLER    PIC X(20) VALUE "TOLIMA              ". *>073
  3641     03 FILLER    PIC X(20) VALUE "                    ". *>074
  3642     03 FILLER    PIC X(20) VALUE "                    ". *>075
  3643     03 FILLER    PIC X(20) VALUE "VALLE DEL CAUCA     ". *>076
  3644     03 FILLER    PIC X(20) VALUE "                    ". *>077
  3645     03 FILLER    PIC X(20) VALUE "                    ". *>078
  3646     03 FILLER    PIC X(20) VALUE "                    ". *>079
  3647     03 FILLER    PIC X(20) VALUE "                    ". *>080
  3648     03 FILLER    PIC X(20) VALUE "ARAUCA              ". *>081
  3649     03 FILLER    PIC X(20) VALUE "                    ". *>082
  3650     03 FILLER    PIC X(20) VALUE "                    ". *>083
  3651     03 FILLER    PIC X(20) VALUE "                    ". *>084
  3652     03 FILLER    PIC X(20) VALUE "CASANARE            ". *>085
  3653     03 FILLER    PIC X(20) VALUE "PUTUMAYO            ". *>086
  3654     03 FILLER    PIC X(20) VALUE "                    ". *>087
  3655     03 FILLER    PIC X(20) VALUE "SAN ANDRES ISLA     ". *>088
  3656     03 FILLER    PIC X(20) VALUE "                    ". *>089
  3657     03 FILLER    PIC X(20) VALUE "                    ". *>090
  3658     03 FILLER    PIC X(20) VALUE "AMAZONAS            ". *>091
  3659     03 FILLER    PIC X(20) VALUE "                    ". *>092
  3660     03 FILLER    PIC X(20) VALUE "                    ". *>093
  3661     03 FILLER    PIC X(20) VALUE "GUANIA              ". *>094
  3662     03 FILLER    PIC X(20) VALUE "GUAVIARE            ". *>095
  3663     03 FILLER    PIC X(20) VALUE "                    ". *>096
  3664     03 FILLER    PIC X(20) VALUE "VAUPES              ". *>097
  3665     03 FILLER    PIC X(20) VALUE "                    ". *>098
  3666     03 FILLER    PIC X(20) VALUE "VICHADA             ". *>099
  3667 01  TABLA-DEPTOS-DANE-R  REDEFINES TABLA-DEPTOS-DANE.
  3668     03 T-NOM-DEP-DANE           PIC X(20) OCCURS 99 TIMES.
  3669 01 VARIABLES-PROPIAS.
  3670    02 LINEA                  PIC X(80) VALUE SPACES.
  3671    02 COMANDO                PIC X(80) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  64
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/DEPTOSDA
  3672    02 FIN-CREDIT             PIC 9(1) VALUE 0.
  3673    02 MAX-PER                PIC 9(8) VALUE 0.
  3674    02 PER-BD                 PIC 9(8) VALUE 0.
  3675    02 LLAVE-AUX              PIC X(38) VALUE SPACES.
  3676    02 I                      PIC 9(08) VALUE ZEROS.
  3677    02 J                      PIC 9(08) VALUE ZEROS.
  3678$SET CONSTANT HACERMATCH"SI"
  3679$SET CONSTANT AMNISTIA21"SI"
  3680* ******************************************************** *
  3681 PROCEDURE DIVISION.
  3682 0010-PROGRAMA-PRINCIPAL.
  3683********************************************************** *
  3684*     DE ACUEDO A LA OPCION SE REALIZA LA FUNCION ADECUADA
  3685*******************************************************************
  3686        ACCEPT LINEA   FROM COMMAND-LINE.
  3687        UNSTRING LINEA DELIMITED BY ALL " " INTO
  3688           COMANDO DEBUG-BDIIALE MAX-PER
  3689        EVALUATE COMANDO
  3690         WHEN        "ALERTAS"
  3691           PERFORM 0020-APERTURA-ARCHIVOS
  3692           PERFORM 1000-ALERTAS
  3693           PERFORM 0060-CERRAR-ARCHIVOS
  3694         WHEN        "BUSCAR"
  3695           PERFORM 0020-APERTURA-ARCHIVOS
  3696           PERFORM 1000-BUSCAR
  3697         WHEN        "ACTUALIZAR"
  3698           PERFORM 1000-ACTUALIZAR
  3699         WHEN ANY
  3700           DISPLAY "OPCION INVALIDA !!!!"
  3701           STOP RUN
  3702        END-EVALUATE.
  3703        STOP RUN.
  3704* ******************************************************** *
  3705 0020-APERTURA-ARCHIVOS.
  3706      MOVE "$DATABASE/BDIIALE" TO MAES-BDIIALE-TITLE.
  3707      OPEN INPUT BDIIALE.
  3708      OPEN INPUT MAESTRO-CREDIT.
  3709      OPEN INPUT MAESTRO-CHECK.
  3710      OPEN INPUT SUSCRIPTOR.
  3711      OPEN INPUT BDIIREGI.
  3712      OPEN INPUT BDIIDIAN  .
  3713      OPEN INPUT BDIIDAS.
  3714      OPEN INPUT INDEXADO.
  3715*     OPEN ADICIONALES PARA DIRECCIONES
  3716      OPEN INPUT MAESTRO-DIRECC.
  3717      OPEN INPUT BDLCLI.
  3718      PERFORM 06000-U-CARGAR-TABLA-DIRESTAN.
  3719 1000-ACTUALIZAR                      .
  3720      OPEN I-O BDIIALE.
  3721      READ BDIIALE NEXT AT END MOVE 1 TO FIN-CREDIT.
  3722      PERFORM UNTIL FIN-CREDIT = 1
  3723         MOVE 20171212  TO FEC-VEN-BDIIALE
  3724         REWRITE REG-BDIIALE INVALID KEY
  3725            DISPLAY "ERROR REWRITE",LLAVE-BDIIALE
  3726         END-REWRITE
  3727         READ BDIIALE NEXT AT END MOVE 1 TO FIN-CREDIT
  3728         END-READ
  3729      END-PERFORM.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  65
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/DEPTOSDA
  3730 1000-BUSCAR.
  3731     IF MAX-PER = ZEROS OR SPACES
  3732        MOVE 1000 TO MAX-PER
  3733     END-IF.
  3734     MOVE 1 TO PER-BD.
  3735     READ MAESTRO-CREDIT NEXT AT END MOVE 1 TO FIN-CREDIT.
  3736     PERFORM UNTIL FIN-CREDIT = 1 OR PER-BD > MAX-PER
  3737        MOVE LLAVE-MAES-CREDIT TO LLAVE-AUX
  3738        MOVE TIPO-ID-ABD07 TO TIPIDE-INPUT-BDIIALE
  3739        MOVE NUM-ID-ABD07  TO NUMIDE-INPUT-BDIIALE
  3740        MOVE "B9C9D9"      TO PRODUC-INPUT-BDIIALE
  3741        MOVE 0             TO MOSTRAR-BBVA-INPUT-BDIIALE
  3742        MOVE 0             TO ES-INDEPENDIENTE-INPUT-BDIIALE
  3743        MOVE "LOPEZ"       TO APELLIDO-INPUT-BDIIALE
  3744        MOVE ZEROS         TO PROD-HC-INPUT-BDIIALE
  3745        PERFORM 0000-RUTINA-ALERTAS-BDIIALE
  3746        MOVE 1 TO I
  3747        PERFORM UNTIL I > 100 OR V-ALE-OUTPUT-BDIIALE(I) = SPACES
  3748           IF V-ALE-OUTPUT-BDIIALE(I)(2:3) <> "999"
  3749              DISPLAY TIPIDE-INPUT-BDIIALE  ";"
  3750                      NUMIDE-INPUT-BDIIALE ";"
  3751                      V-ALE-OUTPUT-BDIIALE(I) ";"
  3752           END-IF
  3753           ADD 1 TO I
  3754        END-PERFORM
  3755        ADD 1 TO PER-BD
  3756        PERFORM 1100-UBICAR-PERSONA
  3757     END-PERFORM.
  3758 1100-UBICAR-PERSONA.
  3759     MOVE LLAVE-AUX TO LLAVE-MAES-CREDIT.
  3760     MOVE ALL "9" TO LLAVE-MAES-CREDIT-ALT
  3761     START MAESTRO-CREDIT KEY > LLAVE-MAES-CREDIT
  3762           INVALID KEY MOVE 1 TO FIN-CREDIT
  3763     END-START
  3764     IF FIN-CREDIT = 0
  3765        READ MAESTRO-CREDIT NEXT AT END
  3766             MOVE 1 TO FIN-CREDIT
  3767        END-READ
  3768     END-IF.
  3769 1000-ALERTAS.
  3770     PERFORM 1100-PEDIR-DATOS.
  3771     PERFORM 1200-PROCESAR UNTIL TIPIDE-INPUT-BDIIALE = ZEROS
  3772                           OR    TIPIDE-INPUT-BDIIALE = SPACES.
  3773
  3774 1100-PEDIR-DATOS.
  3775     DISPLAY "FAVOR DAR IDENTIFICACION ID NUMIDE APE BBVA TEC"
  3776     MOVE SPACES TO LINEA
  3777     ACCEPT LINEA
  3778     UNSTRING LINEA DELIMITED BY ALL " " INTO
  3779        TIPIDE-INPUT-BDIIALE
  3780        NUMIDE-INPUT-BDIIALE
  3781        APELLIDO-INPUT-BDIIALE
  3782        MOSTRAR-BBVA-INPUT-BDIIALE
  3783        ES-INDEPENDIENTE-INPUT-BDIIALE
  3784        PROD-HC-INPUT-BDIIALE
  3785     IF TIPIDE-INPUT-BDIIALE <> ZEROS AND
  3786        TIPIDE-INPUT-BDIIALE <> SPACES
  3787        DISPLAY "FAVOR DAR PRODUCTOS CONTRADOS AABBCC"
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  66
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/DEPTOSDA
  3788        MOVE SPACES TO LINEA
  3789        ACCEPT PRODUC-INPUT-BDIIALE
  3790     END-IF.
  3791 1200-PROCESAR.
  3792     IF APELLIDO-INPUT-BDIIALE = SPACES
  3793        MOVE "PEREZ" TO APELLIDO-INPUT-BDIIALE
  3794     END-IF
  3795     IF MOSTRAR-BBVA-INPUT-BDIIALE = ZEROS OR SPACES
  3796        MOVE 0 TO MOSTRAR-BBVA-INPUT-BDIIALE
  3797     END-IF
  3798     IF ES-INDEPENDIENTE-INPUT-BDIIALE  = ZEROS OR SPACES
  3799        MOVE 0 TO ES-INDEPENDIENTE-INPUT-BDIIALE
  3800     END-IF
  3801     IF PROD-HC-INPUT-BDIIALE           = ZEROS OR SPACES
  3802        MOVE "00"  TO PROD-HC-INPUT-BDIIALE
  3803     END-IF
  3804     MOVE 1 TO LOG-INPUT-BDIIALE.
  3805     PERFORM 0000-RUTINA-ALERTAS-BDIIALE.
  3806     PERFORM 9000-DEBUG-TABLAS-BDIIALE.
  3807     PERFORM 1100-PEDIR-DATOS.
  3808 0060-CERRAR-ARCHIVOS.
  3809     EXIT.
* 3810 COPY BDIIALEDB2.PROC.
  3811* BDIIALE.PROC.v02.0001
  3812******************************************************************
  3813* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE PERMITEN EXTRACTAR
  3814* LAS ALERTAS DEL SISTEMA
  3815******************************************************************
  3816 0000-RUTINA-ALERTAS-BDIIALE.
  3817**********************************************************************
  3818*0000-RUTINA-ALERTAS-BDIIALE.
  3819*    SE PROCEDE A CALCULAR LAS ALERTAS DE LA IDENTIFICACION DADA
  3820*    DE ACUERDO A LOS GRUPOS CONTRATADOS POR EL SUSCRIPTOR
  3821**********************************************************************
  3822     PERFORM 1000-VERSI-CARGA-ALEDB2-BDIIALE.
  3823     PERFORM 2000-CAL-CARACT-BDIIALE.
  3824     PERFORM 3000-PROCESE-ALERTAS-BDIIALE.
  3825     IF LOG-INPUT-BDIIALE = 1
  3826        PERFORM 4000-GENERAR-LOG-BDIIALE
  3827     END-IF.
  3828 1000-VERSI-CARGA-ALEDB2-BDIIALE.
  3829******************************************************************
  3830*1000-VERSI-CARGA-ALEDB2-BDIIALE.
  3831*    SE VERIFICA SI HAY QUE CARGAR LOS ARCHIVOS PLANOS DE LAS
  3832*    DEFINICIONES VARIABLES DE ALERTAS,GRUPOS Y RELACIONES GENERADOS
  3833*    POR EL MODULO ADMINISTRADOR.
  3834*    SI HA CAMBIADO EL DIA SE REALIZA EL CARGUE DE NUEVO.
  3835******************************************************************
  3836     IF FUNCTION CURRENT-DATE(1:8) <> CURRENT-DATE-BDIIALE(1:8)
  3837        IF CURRENT-DATE-BDIIALE <> ZEROS AND LOG-INPUT-BDIIALE = 1
  3838           CLOSE BDIIALE-PLANO
  3839        END-IF
  3840        PERFORM 1100-CARGAR-ALEDB2-BDIIALE
  3841     END-IF.
  3842 1100-CARGAR-ALEDB2-BDIIALE.
  3843******************************************************************
  3844*1100-CARGAR-ALEDB2-BDIIALE.
  3845*    RUTINA QUE CARGA LAS ALERTAS DE LOS ARCHIVOS PLANOS DE LAS
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  67
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  3846*    DEFINICIONES VARIABLES DE ALERTAS,GRUPOS Y RELACIONES EN LAS
  3847*    ESTRUCTURAS EN MEMORIA DEL MOTOR DE ALERTAS
  3848*    CALCULA UN APUNTADOR INTERNO PARA LA TABLA DE ALERTAS PARA
  3849*    EFICIENCIA EN LAS BUSQUEDAS Y TOMA EL VALOR DEL SALARIO
  3850*    MINIMO VIGENTE DE LA TABLA OFICIAL.
  3851******************************************************************
  3852*    REGISTRAR LA FECHA DEL CARGUE
  3853     MOVE FUNCTION CURRENT-DATE(1:8) TO CURRENT-DATE-BDIIALE(1:8)
  3854     MOVE FUNCTION CURRENT-DATE(1:6) TO FECHA-TAG-BDIIALE(1:8)
  3855     MOVE SPACES TO M-GRUPOS-BDIIALE.
  3856     MOVE SPACES TO M-ALEGRU-BDIIALE.
  3857     MOVE SPACES TO M-ALERTAS-BDIIALE.
  3858*    CARGAR LA TABLA DE GRUPOS
  3859     MOVE "$DATABASE/BDIIALE-GRUPOS" TO TITLE-BDIIALE-PLANO
  3860     MOVE 0 TO FIN-BDIIALE-PLANO.
  3861     OPEN INPUT BDIIALE-PLANO.
  3862     READ BDIIALE-PLANO AT END MOVE 1 TO FIN-BDIIALE-PLANO.
  3863     MOVE 0 TO I-BDIIALE.
  3864     MOVE 0 TO J-BDIIALE.
  3865     MOVE SPACES TO M-GRU-DEFAULT-BDIIALE.
  3866     MOVE SPACES TO M-PRO-DEFAULT-BDIIALE.
  3867     MOVE SPACES TO M-COB-DEFAULT-BDIIALE.
  3868     PERFORM UNTIL FIN-BDIIALE-PLANO = 1
  3869       ADD 1 TO I-BDIIALE
  3870       UNSTRING REG-BDIIALE-PLANO DELIMITED BY ALL ";" INTO
  3871          V-GRU-GRUPOS-BDIIALE(I-BDIIALE)
  3872          V-NOM-GRUPOS-BDIIALE(I-BDIIALE)
  3873          V-COB-GRUPOS-BDIIALE(I-BDIIALE)
  3874          V-PRO-GRUPOS-BDIIALE(I-BDIIALE)
  3875       IF V-COB-GRUPOS-BDIIALE(I-BDIIALE) = "OBL"
  3876          ADD 1 TO J-BDIIALE
  3877          MOVE V-GRU-GRUPOS-BDIIALE(I-BDIIALE) TO
  3878               V-GRU-DEFAULT-BDIIALE(J-BDIIALE)
  3879          MOVE V-PRO-GRUPOS-BDIIALE(I-BDIIALE) TO
  3880               V-PRO-DEFAULT-BDIIALE(J-BDIIALE)
  3881          MOVE V-COB-GRUPOS-BDIIALE(I-BDIIALE) TO
  3882               V-COB-DEFAULT-BDIIALE(J-BDIIALE)
  3883       END-IF
  3884       READ BDIIALE-PLANO AT END MOVE 1 TO FIN-BDIIALE-PLANO
  3885       END-READ
  3886     END-PERFORM.
  3887     CLOSE BDIIALE-PLANO.
  3888*    CARGAR LA TABLA DE RELACIONES
  3889     MOVE "$DATABASE/BDIIALE-ALEGRU" TO TITLE-BDIIALE-PLANO
  3890     MOVE 0 TO FIN-BDIIALE-PLANO.
  3891     OPEN INPUT BDIIALE-PLANO.
  3892     READ BDIIALE-PLANO AT END MOVE 1 TO FIN-BDIIALE-PLANO.
  3893     MOVE 0 TO I-BDIIALE.
  3894     PERFORM UNTIL FIN-BDIIALE-PLANO = 1
  3895       ADD 1 TO I-BDIIALE
  3896       UNSTRING REG-BDIIALE-PLANO DELIMITED BY ALL ";" INTO
  3897          V-ALE-ALEGRU-BDIIALE(I-BDIIALE)
  3898          V-GRU-ALEGRU-BDIIALE(I-BDIIALE)
  3899       READ BDIIALE-PLANO AT END MOVE 1 TO FIN-BDIIALE-PLANO
  3900       END-READ
  3901     END-PERFORM.
  3902     CLOSE BDIIALE-PLANO.
  3903*    CARGAR LA TABLA DE ALERTAS
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  68
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  3904     MOVE "$DATABASE/BDIIALE-ALERTAS" TO TITLE-BDIIALE-PLANO
  3905     MOVE 0 TO FIN-BDIIALE-PLANO.
  3906     OPEN INPUT BDIIALE-PLANO.
  3907     READ BDIIALE-PLANO AT END MOVE 1 TO FIN-BDIIALE-PLANO.
  3908     MOVE 0 TO I-BDIIALE.
  3909     PERFORM UNTIL FIN-BDIIALE-PLANO = 1
  3910       ADD 1 TO I-BDIIALE
  3911       UNSTRING REG-BDIIALE-PLANO DELIMITED BY ALL ";" INTO
  3912          V-ALE-ALERTAS-BDIIALE(I-BDIIALE)
  3913          V-OPC-ALERTAS-BDIIALE(I-BDIIALE)
  3914          V-TIP-ALERTAS-BDIIALE(I-BDIIALE)
  3915          V-ESG-ALERTAS-BDIIALE(I-BDIIALE)
  3916          V-FUE-ALERTAS-BDIIALE(I-BDIIALE)
  3917          V-NOM-ALERTAS-BDIIALE(I-BDIIALE)
  3918          V-DE1-ALERTAS-BDIIALE(I-BDIIALE)
  3919          V-DE2-ALERTAS-BDIIALE(I-BDIIALE)
  3920       READ BDIIALE-PLANO AT END MOVE 1 TO FIN-BDIIALE-PLANO
  3921       END-READ
  3922     END-PERFORM.
  3923     CLOSE BDIIALE-PLANO.
  3924*    LLENAMOS EL APUNTADOR DE LA RELACION ALEGRU(I) APUNTA A ALERT
  3925*    POR RAZONES DE EFICIENCIA EN LAS BUSQUEDAS
  3926     MOVE 1 TO I-BDIIALE.
  3927     PERFORM UNTIL V-ALE-ALEGRU-BDIIALE(I-BDIIALE) = SPACES OR
  3928                                        I-BDIIALE  > 1000
  3929       MOVE 1 TO J-BDIIALE
  3930       MOVE 0 TO V-APUALE-ALEGRU-BDIIALE(I-BDIIALE)
  3931       PERFORM UNTIL V-ALE-ALERTAS-BDIIALE(J-BDIIALE) = SPACES OR
  3932                                           J-BDIIALE > 1000
  3933          IF V-ALE-ALEGRU-BDIIALE(I-BDIIALE) =
  3934             V-ALE-ALERTAS-BDIIALE(J-BDIIALE)
  3935             MOVE J-BDIIALE TO V-APUALE-ALEGRU-BDIIALE(I-BDIIALE)
  3936             MOVE 1000 TO J-BDIIALE
  3937          END-IF
  3938          ADD 1 TO J-BDIIALE
  3939       END-PERFORM
  3940       IF V-APUALE-ALEGRU-BDIIALE(I-BDIIALE) = ZEROS
  3941          DISPLAY "BDIIALE:NO SE ENCONTRO CODIGO TABLA ALERTAS="
  3942                  V-ALE-ALEGRU-BDIIALE(I-BDIIALE)
  3943       END-IF
  3944       ADD 1 TO I-BDIIALE
  3945     END-PERFORM.
  3946*    CARGAR SALARIO MINIMO.
  3947     OPEN INPUT ICSALMIN.
  3948     MOVE 0 TO FIN-ICSALMIN-BDIIALE.
  3949     READ ICSALMIN AT END MOVE 1 TO FIN-ICSALMIN-BDIIALE.
  3950     PERFORM UNTIL FIN-ICSALMIN-BDIIALE = 1
  3951       MOVE VALOR-ICSALMIN    TO SMLMV-BDIIALE
  3952       READ ICSALMIN AT END MOVE 1 TO FIN-ICSALMIN-BDIIALE
  3953       END-READ
  3954     END-PERFORM.
  3955     CLOSE ICSALMIN.
  3956     IF LOG-INPUT-BDIIALE = 1
  3957        MOVE CURRENT-DATE-BDIIALE TO FECHA-LOG-BDIIALE-TITLE
  3958        MOVE LOG-BDIIALE-TITLE    TO TITLE-BDIIALE-PLANO
  3959        OPEN EXTEND BDIIALE-PLANO
  3960     END-IF.
  3961 2000-CAL-CARACT-BDIIALE.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  69
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  3962***********************************************************************
  3963*2000-CAL-CARACT-BDIIALE.
  3964*    SE RECORREN LAS ESTRUCTURAS DONDE SEA NECESARIO EXTRAER INFORMACIO
  3965*    PARA LAS ALERTAS.SE REALIZA BAJO LA FILOSOFIA DE CARACTERISTICAS
  3966*    ESTO SE HACE PARA NO TENER QUE RECORRER EN CADA ALERTA UNA
  3967*    ESTRUCTURA DE INFORMACION .
  3968***********************************************************************
  3969     MOVE ZEROS TO M-APE3-BDIIALE.
  3970     MOVE ZEROS TO M-CON60-BDIIALE.
  3971     MOVE ZEROS TO CARACTERISTICAS-BDIIALE.
  3972     PERFORM 2100-ICMCHK-BDIIALE.
  3973     PERFORM 2200-ICMCRE-BDIIALE.
  3974     PERFORM 2300-ICBCON-BDIIALE.
  3975     PERFORM 2400-ICBDIR-BDIIALE.
  3976     PERFORM 2500-BDOFICIALES-BDIIALE.
  3977 2100-ICMCHK-BDIIALE.
  3978******************************************************************
  3979*2100-ICMCHK-BDIIALE.
  3980*    SE RECORRE EL MAESTRO DE CREDITO Y SE CALCULAN TODAS LAS
  3981*    CARACTERISTICAS NECESARIAS PARA ALERTAS :
  3982*       - SUMA DE SALDOS DE CREDITOS DE VIVIENDA
  3983*       - SUMA DE CUENTAS
  3984******************************************************************
  3985     INITIALIZE LLAVE-MAES-CHECK.
  3986     MOVE TIPIDE-INPUT-BDIIALE TO TIPO-ID-ABD06
  3987     MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-ABD06.
  3988     MOVE 0 TO FIN-ICMCHK-BDIIALE                                 RMB0147
  3989     PERFORM 0600-ASIGNA-ID-ICMCHK-START.                         RMB0198
  3990     START MAESTRO-CHECK  KEY > LLAVE-MAES-CHECK                  RMB0147
  3991        INVALID KEY MOVE 1 TO FIN-ICMCHK-BDIIALE                  RMB0147
  3992        NOT INVALID KEY                                           RMB0147
  3993           MOVE 1 TO SW-ELIMINA-BBVA-LEEMSTRS                     GJC0212
  3994           IF MOSTRAR-BBVA-INPUT-BDIIALE = 1
  3995              MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS                  GJC0241
  3996           END-IF                                                 GJC0241
  3997           PERFORM  3000-LEE-ICMCHK-SECUENCIAL                    RMB0198
  3998           IF  SW-LECTURA-MAESTROS  =  1                          RMB0198
  3999               MOVE 1 TO FIN-ICMCHK-BDIIALE                       RMB0198
  4000           END-IF                                                 RMB0198
  4001     END-START.                                                   RMB0147
  4002     PERFORM UNTIL TIPIDE-INPUT-BDIIALE NOT = TIPO-ID-ABD06
  4003        OR NUMIDE-INPUT-BDIIALE NOT = NUM-ID-ABD06 OR
  4004           FIN-ICMCHK-BDIIALE = 1
  4005        IF IND-BLOQUEO-ABD06 = 0                                  RMB0147
  4006           MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                RMB0147
  4007           READ SUSCRIPTOR WITH IGNORE LOCK                       RMB0147
  4008                  INVALID KEY                                     RMB0147
  4009                     MOVE 0 TO ESTADO-ABD02                       RMB0147
  4010           END-READ                                               RMB0147
  4011           IF ESTADO-ABD02 = 1
  4012              IF CONSECUTIVO-ABD06 = 01
  4013                 ADD 1 TO CAR-CTA-CSV-BD-BDIIALE
  4014              ELSE
  4015                 IF CONSECUTIVO-ABD06 = 00
  4016                    ADD 1 TO CAR-CTA-OFI-BD-BDIIALE
  4017                 END-IF
  4018              END-IF
  4019           END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  70
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4020        END-IF                                                    RMB0147
  4021        MOVE 1 TO SW-ELIMINA-BBVA-LEEMSTRS                        GJC0212
  4022        IF MOSTRAR-BBVA-INPUT-BDIIALE = 1
  4023           MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS                     GJC0241
  4024        END-IF                                                    GJC0241
  4025        PERFORM  3000-LEE-ICMCHK-SECUENCIAL                       RMB0198
  4026        IF  SW-LECTURA-MAESTROS  =  1                             RMB0198
  4027             MOVE 1 TO FIN-ICMCHK-BDIIALE                         RMB0198
  4028        END-IF                                                    RMB0198
  4029      END-PERFORM.                                                RMB0147
  4030 2200-ICMCRE-BDIIALE.
  4031******************************************************************
  4032*2200-ICMCRE-BDIIALE.
  4033*    SE RECORRE EL MAESTRO DE CREDITO Y SE CALCULAN TODAS LAS
  4034*    CARACTERISTICAS NECESARIAS PARA ALERTAS :
  4035*       - SUMA DE SALDOS DE CREDITOS DE VIVIENDA
  4036*       - SUMA DE CUENTAS
  4037******************************************************************
  4038     INITIALIZE LLAVE-MAES-CREDIT.                                RMB0147
  4039     MOVE TIPIDE-INPUT-BDIIALE TO TIPO-ID-ABD07
  4040     MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-ABD07.
  4041     MOVE 0 TO FIN-CREDIT-BDIIALE                                 RMB0147
  4042     PERFORM 0500-ASIGNA-ID-ICMCRE-START.                         RMB0198
  4043     START MAESTRO-CREDIT KEY > LLAVE-MAES-CREDIT                 RMB0147
  4044        INVALID KEY MOVE 1 TO FIN-CREDIT-BDIIALE                  RMB0147
  4045        NOT INVALID KEY                                           RMB0147
  4046           MOVE 1 TO SW-ELIMINA-BBVA-LEEMSTRS                     GJC0212
  4047           IF MOSTRAR-BBVA-INPUT-BDIIALE = 1
  4048              MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS                  GJC0241
  4049           END-IF                                                 GJC0241
  4050           PERFORM  1000-LEE-ICMCRE-SECUENCIAL                    RMB0198
  4051           IF  SW-LECTURA-MAESTROS  =  1                          RMB0198
  4052               MOVE 1 TO FIN-CREDIT-BDIIALE                       RMB0198
  4053           END-IF                                                 RMB0198
  4054     END-START.                                                   RMB0147
  4055     PERFORM UNTIL TIPIDE-INPUT-BDIIALE NOT = TIPO-ID-ABD07
  4056        OR NUMIDE-INPUT-BDIIALE NOT = NUM-ID-ABD07 OR
  4057           FIN-CREDIT-BDIIALE = 1
  4058        IF IND-BLOQUEO-ABD07 = 0                                  RMB0147
  4059           MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                RMB0147
  4060           READ SUSCRIPTOR WITH IGNORE LOCK                       RMB0147
  4061                  INVALID KEY                                     RMB0147
  4062                     MOVE 0 TO ESTADO-ABD02                       RMB0147
  4063           END-READ                                               RMB0147
  4064           IF ESTADO-ABD02 = 1
  4065              IF CONSECUTIVO-ABD07 = 01
  4066                 ADD 1 TO CAR-CTA-CSV-BD-BDIIALE
  4067              ELSE
  4068                 IF CONSECUTIVO-ABD07 = 00
  4069                    ADD 1 TO CAR-CTA-OFI-BD-BDIIALE
  4070                 END-IF
  4071              END-IF
  4072              PERFORM 2210-ICMCRE-MICR01-BDIIALE
  4073              PERFORM 2220-ICMCRE-MORA60-BDIIALE
  4074              PERFORM 2230-ICMCRE-APE3MS-BDIIALE
  4075           END-IF
  4076        END-IF                                                    RMB0147
  4077        MOVE 1 TO SW-ELIMINA-BBVA-LEEMSTRS                        GJC0212
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  71
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4078        IF MOSTRAR-BBVA-INPUT-BDIIALE = 1
  4079           MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS                     GJC0241
  4080        END-IF                                                    GJC0241
  4081        PERFORM  1000-LEE-ICMCRE-SECUENCIAL                       RMB0198
  4082        IF  SW-LECTURA-MAESTROS  =  1                             RMB0198
  4083             MOVE 1 TO FIN-CREDIT-BDIIALE                         RMB0198
  4084        END-IF                                                    RMB0198
  4085      END-PERFORM.                                                RMB0147
  4086 2210-ICMCRE-MICR01-BDIIALE.
  4087******************************************************************
  4088*2210-ICMCRE-MICR01-BDIIALE.
  4089*    SE CALCULA EL SALDO TOTAL PARA LAS CUENTAS ABIERTAS,PRINCIPAL
  4090*    Y DE CREDITOS DIFERENTE DE HIPOTECARIOS
  4091******************************************************************
  4092     IF GARANTE-ABD07 = 0                         *> PRINCIPAL
  4093        IF NOV-REPORT-ABD07 = 01 OR 45 OR 47  OR  *> ABIERTA
  4094          (NOV-REPORT-ABD07 >= 13 AND NOV-REPORT-ABD07 <= 41 )
  4095           IF COD-CTA-ABD07 = 13 OR               *> VIVIENDA
  4096            ((COD-CTA-ABD07 = 05 OR 06 OR 33 ) AND
  4097              TIPO-OBLIGACION-ABD07 = 3      )
  4098              ADD 0 TO CAR-SALDO-MICR-BDIIALE
  4099           ELSE
  4100              ADD VALOR-SALDO-DEUDAM-ABD07 TO
  4101                  CAR-SALDO-MICR-BDIIALE
  4102           END-IF
  4103        END-IF
  4104     END-IF.
  4105 2220-ICMCRE-MORA60-BDIIALE.
  4106******************************************************************
  4107*2220-ICMCRE-MORA60-BDIIALE.
  4108*    SE CALCULA SI LA IDENTIFICACION TIENE UNA MORA DE 60 O MAS
  4109*    EN LOS ULTIMOS 6 MESES
  4110******************************************************************
  4111     PERFORM 2221-NORMALIZAR-VEC-BDIIALE.
  4112*    SE CALCULAN LAS MORAS 60 O MAS PARA LAPZOS DE 6  MESES
  4113     INSPECT V-NOR-BDIIALE(19:6) TALLYING CAR-M60-MAS-6M-BDIIALE
  4114                                          FOR ALL "2"
  4115     INSPECT V-NOR-BDIIALE(19:6) TALLYING CAR-M60-MAS-6M-BDIIALE
  4116                                          FOR ALL "3"
  4117     INSPECT V-NOR-BDIIALE(19:6) TALLYING CAR-M60-MAS-6M-BDIIALE
  4118                                          FOR ALL "4"
  4119     INSPECT V-NOR-BDIIALE(19:6) TALLYING CAR-M60-MAS-6M-BDIIALE
  4120                                          FOR ALL "6"
  4121     INSPECT V-NOR-BDIIALE(19:6) TALLYING CAR-M60-MAS-6M-BDIIALE
  4122                                          FOR ALL "7".
  4123 2221-NORMALIZAR-VEC-BDIIALE.
  4124******************************************************************
  4125*2221-NORMALIZAR-VEC-BDIIALE.
  4126*    SE NORMALIZA EL VECTOR DE COMPORTAMIENTO RESPECTO A LA FECHA
  4127*    ACTUAL
  4128******************************************************************
  4129*    NORMALIZACION DE FECHAS
  4130     MOVE  FECHA-APERT-ABD07             TO FECHA-WRK-BDIIALE.
  4131     MOVE  FECHA-WRK-BDIIALE(1:2)        TO MES-APE-BDIIALE.
  4132     MOVE  FECHA-WRK-BDIIALE(3:2)        TO ANO-APE-BDIIALE.
  4133     IF  ANO-APE-BDIIALE  <  50
  4134       MOVE  20                          TO SIG-APE-BDIIALE
  4135     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  72
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4136       MOVE  19                          TO SIG-APE-BDIIALE
  4137     END-IF.
  4138     MOVE FEC-NOVEDAD-ABD07              TO FECHA-WRK-BDIIALE.
  4139     MOVE FECHA-WRK-BDIIALE(1:2)         TO MES-NOV-BDIIALE.
  4140     MOVE FECHA-WRK-BDIIALE(3:2)         TO ANO-NOV-BDIIALE.
  4141     IF  ANO-NOV-BDIIALE  <  50
  4142       MOVE  20                          TO SIG-NOV-BDIIALE
  4143     ELSE
  4144       MOVE  19                          TO SIG-NOV-BDIIALE
  4145     END-IF.
  4146     MOVE  FECHA-ING-ABD02               TO FECHA-WRK-BDIIALE.
  4147     MOVE  FECHA-WRK-BDIIALE(1:2)        TO MES-ING-BDIIALE.
  4148     MOVE  FECHA-WRK-BDIIALE(3:2)        TO ANO-ING-BDIIALE.
  4149     IF  ANO-ING-BDIIALE < 50
  4150       MOVE  20                          TO SIG-ING-BDIIALE
  4151     ELSE
  4152       MOVE  19                          TO SIG-ING-BDIIALE
  4153     END-IF.
  4154*
  4155     MOVE ESTADO-MES-ABD07 TO V-NOR2-BDIIALE.
  4156     MOVE VECTOR-2-ABD07   TO V-NOR1-BDIIALE.
  4157     IF FECHA-APERTURA-BDIIALE > FECHA-INGRESO-BDIIALE
  4158        MOVE FECHA-APERTURA-BDIIALE TO FECHA-INGRESO-BDIIALE
  4159     END-IF
  4160     IF FECHA-NOVEDAD-BDIIALE > FECHA-INGRESO-BDIIALE
  4161        COMPUTE MESES-BDIIALE =
  4162           ( SIG-ANO-NOV-BDIIALE * 12 + MES-NOV-BDIIALE ) -
  4163           ( SIG-ANO-ING-BDIIALE * 12 + MES-ING-BDIIALE )
  4164     ELSE
  4165        MOVE 0 TO MESES-BDIIALE
  4166     END-IF
  4167     IF MESES-BDIIALE < 24
  4168        COMPUTE MESES-BDIIALE = 24 - MESES-BDIIALE
  4169     ELSE
  4170        MOVE 0 TO MESES-BDIIALE
  4171     END-IF
  4172     PERFORM UNTIL MESES-BDIIALE = 0
  4173        MOVE "0" TO V-NOR-BDIIALE(MESES-BDIIALE:1)
  4174        SUBTRACT 1 FROM MESES-BDIIALE
  4175     END-PERFORM
  4176*    CASTIGADAS Y DUDOSO RECAUDO
  4177     IF NOV-REPORT-ABD07 = 45 OR 47
  4178        IF NOV-REPORT-ABD07 = 47
  4179           MOVE ALL "D" TO RELLENO-BDIIALE
  4180        ELSE
  4181           MOVE ALL "C" TO RELLENO-BDIIALE
  4182        END-IF
  4183        MOVE FECHA-SITUACION-ABD07 TO FECHA-SITMMAAAA-ORI-BDIIALE
  4184        MOVE FECHA-SITAAAA-ORI-BDIIALE TO FECHA-SITAAAA-BDIIALE
  4185        MOVE FECHA-SITMM-ORI-BDIIALE   TO FECHA-SITMM-BDIIALE
  4186        MOVE FECHA-ACTUALIZ-VALOR-ABD07 TO
  4187                                    FECHA-SITMMAAAA-ORI-BDIIALE
  4188        MOVE FECHA-SITAAAA-ORI-BDIIALE  TO FECHA-VALAAAA-BDIIALE
  4189        MOVE FECHA-SITMM-ORI-BDIIALE    TO FECHA-VALMM-BDIIALE
  4190        IF FECHA-VALAAAAMM-BDIIALE > FECHA-SITAAAAMM-BDIIALE
  4191           MOVE FECHA-VALAAAAMM-BDIIALE TO FECHA-SITAAAAMM-BDIIALE
  4192        END-IF
  4193        IF FECHA-SITAAAAMM-BDIIALE > FECHA-NOVEDAD-BDIIALE
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  73
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4194           COMPUTE MESES-BDIIALE =
  4195           ( FECHA-SITAAAA-BDIIALE * 12 + FECHA-SITMM-BDIIALE ) -
  4196           ( SIG-ANO-NOV-BDIIALE   * 12 + MES-NOV-BDIIALE     )
  4197           IF MESES-BDIIALE < 24
  4198              PERFORM UNTIL MESES-BDIIALE = 0
  4199                 MOVE V-NOR-BDIIALE(2:23) TO V-NOR-BDIIALE(1:23)
  4200                 MOVE RELLENO-BDIIALE(1:1) TO V-NOR-BDIIALE(24:1)
  4201                 SUBTRACT 1 FROM MESES-BDIIALE
  4202              END-PERFORM
  4203           ELSE
  4204              MOVE RELLENO-BDIIALE TO V-NOR-BDIIALE(1:24)
  4205           END-IF
  4206           MOVE  FECHA-SITAAAAMM-BDIIALE TO FECHA-NOVEDAD-BDIIALE
  4207        END-IF
  4208     END-IF.
  4209*    ADICIONAR NOVEDAD
  4210     MOVE V-NOR-BDIIALE(2:23) TO V-NOR-BDIIALE(1:23)
  4211     MOVE V-MORA-PLUS-BDIIALE(NOV-REPORT-ABD07) TO
  4212                                              V-NOR-BDIIALE(24:1)
  4213*    NORMALIZAR
  4214     IF FECHA-TAG-BDIIALE >= FECHA-NOVEDAD-BDIIALE
  4215        COMPUTE MESES-BDIIALE =
  4216        ( SIG-ANO-TAG-BDIIALE * 12 + MES-TAG-BDIIALE ) -
  4217        ( SIG-ANO-NOV-BDIIALE * 12 + MES-NOV-BDIIALE )
  4218        IF MESES-BDIIALE < 24
  4219           PERFORM UNTIL MESES-BDIIALE = 0
  4220             MOVE V-NOR-BDIIALE(2:23) TO V-NOR-BDIIALE(1:23)
  4221             MOVE "0"         TO V-NOR-BDIIALE(24:1)
  4222             SUBTRACT 1 FROM MESES-BDIIALE
  4223           END-PERFORM
  4224        ELSE
  4225           MOVE ALL "0"        TO V-NOR-BDIIALE
  4226        END-IF
  4227     ELSE
  4228        COMPUTE MESES-BDIIALE =
  4229        ( SIG-ANO-NOV-BDIIALE * 12 + MES-NOV-BDIIALE ) -
  4230        ( SIG-ANO-TAG-BDIIALE * 12 + MES-TAG-BDIIALE )
  4231        IF MESES-BDIIALE < 24
  4232           PERFORM UNTIL MESES-BDIIALE = 0
  4233             MOVE V-NOR-BDIIALE(1:23) TO V-NOR-BDIIALE(2:23)
  4234             MOVE "0"         TO V-NOR-BDIIALE(1:1)
  4235             SUBTRACT 1 FROM MESES-BDIIALE
  4236           END-PERFORM
  4237        ELSE
  4238           MOVE ALL "0" TO V-NOR-BDIIALE
  4239        END-IF
  4240     END-IF.
  4241*    REEMPLAZOS
  4242     INSPECT V-NOR-BDIIALE REPLACING ALL "0" BY ".".
  4243     INSPECT V-NOR-BDIIALE REPLACING ALL "5" BY "0".  *> AL DIA
  4244     INSPECT V-NOR-BDIIALE REPLACING ALL "7" BY ".".
  4245     INSPECT V-NOR-BDIIALE REPLACING ALL "8" BY ".".
  4246     INSPECT V-NOR-BDIIALE REPLACING ALL "9" BY ".".
  4247     INSPECT V-NOR-BDIIALE REPLACING ALL "M" BY "5".  *> CANCELADA MM
  4248     INSPECT V-NOR-BDIIALE REPLACING ALL "D" BY "6".  *> DUDOSO RECAUDO
  4249     INSPECT V-NOR-BDIIALE REPLACING ALL "C" BY "7".  *> CASTIGADA
  4250     INSPECT V-NOR-BDIIALE REPLACING ALL "R" BY "8".  *> RECUPERADA
  4251     INSPECT V-NOR-BDIIALE REPLACING ALL "P" BY "9".  *> PAGO TOTAL
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  74
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4252 2230-ICMCRE-APE3MS-BDIIALE.
  4253*****************************************************************
  4254*2230-ICMCRE-APE3MS-BDIIALE.
  4255*    SE REGISTRAN LOS NITS DE LAS CUENTAS ABIERTAS EN LOS ULTIMOS
  4256*    6 MESES
  4257*****************************************************************
  4258      COMPUTE MESES-BDIIALE =
  4259             ( SIG-ANO-APE-BDIIALE * 12 + MES-APE-BDIIALE ) -
  4260             ( SIG-ANO-TAG-BDIIALE * 12 + MES-TAG-BDIIALE ).
  4261      IF MESES-BDIIALE <= 6
  4262         MOVE 1 TO I-BDIIALE
  4263         PERFORM UNTIL I-BDIIALE > 20
  4264           IF V-NIT-APE3-BDIIALE(I-BDIIALE) = 0
  4265              MOVE NIT-SUSCRIP-S-ABD02 TO
  4266                   V-NIT-APE3-BDIIALE(I-BDIIALE)
  4267              MOVE MESES-BDIIALE TO
  4268                   V-MESES-APE3-BDIIALE(I-BDIIALE)
  4269              MOVE 20 TO I-BDIIALE
  4270           ELSE
  4271              IF V-NIT-APE3-BDIIALE(I-BDIIALE) =
  4272                                              NIT-SUSCRIP-S-ABD02
  4273                 IF MESES-BDIIALE <
  4274                                  V-MESES-APE3-BDIIALE(I-BDIIALE)
  4275                    MOVE MESES-BDIIALE TO
  4276                         V-MESES-APE3-BDIIALE(I-BDIIALE)
  4277                    MOVE 20 TO I-BDIIALE
  4278                 END-IF
  4279              END-IF
  4280           END-IF
  4281           ADD 1 TO I-BDIIALE
  4282         END-PERFORM
  4283      END-IF.
  4284 2300-ICBCON-BDIIALE.
  4285*****************************************************************
  4286*2300-ICBCON-BDIIALE.
  4287*    SE RECORRE LA ESTRUCTURA DE HUELLAS DE CONSULTA PARA
  4288*    CALCULAR LAS CARACTERISTICAS NECESARIAS
  4289*****************************************************************
  4290     INITIALIZE LLAVE-INDEX.
  4291     MOVE TIPIDE-INPUT-BDIIALE TO TIP-ID-IND
  4292     MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-IND.
  4293     MOVE 0 TO FIN-ICBCON-BDIIALE
  4294     START INDEXADO KEY > LLAVE-INDEX
  4295        INVALID KEY MOVE 1 TO FIN-ICBCON-BDIIALE
  4296     END-START.
  4297     IF FIN-ICBCON-BDIIALE = 0
  4298        READ INDEXADO IGNORE LOCK NEXT AT END
  4299             MOVE 1 TO FIN-ICBCON-BDIIALE
  4300        END-READ
  4301     END-IF
  4302     PERFORM UNTIL TIPIDE-INPUT-BDIIALE NOT = TIP-ID-IND OR
  4303         NUMIDE-INPUT-BDIIALE NOT = NUM-ID-IND           OR
  4304         FIN-ICBCON-BDIIALE = 1
  4305         MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  4306         READ SUSCRIPTOR WITH IGNORE LOCK
  4307                INVALID KEY
  4308                   MOVE 9 TO ESTADO-ABD02
  4309         END-READ
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  75
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4310         IF ESTADO-ABD02 = 0 OR 1
  4311            IF COD-SUSCRIP-IND < 900000 *> SOLO SUSCRIPTOR
  4312               PERFORM 2310-ICBCON-APE3MS-BDIIALE
  4313               PERFORM 2320-ICBCON-CON2MS-BDIIALE
  4314            END-IF
  4315         END-IF
  4316         READ INDEXADO IGNORE LOCK NEXT AT END
  4317              MOVE 1 TO FIN-ICBCON-BDIIALE
  4318         END-READ
  4319      END-PERFORM.
  4320 2310-ICBCON-APE3MS-BDIIALE.
  4321*****************************************************************
  4322*2310-ICBCON-APE3MS-BDIIALE.
  4323*    SE MIRA SI LA CONSULTA EN LOS ULTIMOS 3 MESES GENERO UNA
  4324*    APERTURA CON ESA ENTIDAD (NO USADA PARA UN FUTURO HECHA)
  4325*****************************************************************
  4326     MOVE FEC-CONSUL-IND(3:2) TO  MES-CON-BDIIALE(1:2)
  4327     MOVE FEC-CONSUL-IND(5:2) TO  ANO-CON-BDIIALE(1:2)
  4328     IF ANO-CON-BDIIALE < 50
  4329        MOVE 20 TO SIG-CON-BDIIALE
  4330     ELSE
  4331        MOVE 19 TO SIG-CON-BDIIALE
  4332     END-IF
  4333     COMPUTE MESES-BDIIALE =
  4334        ( SIG-ANO-TAG-BDIIALE * 12 + MES-TAG-BDIIALE ) -
  4335        ( SIG-ANO-CON-BDIIALE * 12 + MES-CON-BDIIALE )
  4336     IF MESES-BDIIALE >= 03
  4337        MOVE 0 TO HAY-INQAPE-BDIIALE
  4338        MOVE 1 TO I-BDIIALE
  4339        PERFORM UNTIL I-BDIIALE > 20 OR
  4340                   V-NIT-APE3-BDIIALE(I-BDIIALE) = ZEROS
  4341          IF NIT-SUSCRIP-S-ABD02 = V-NIT-APE3-BDIIALE(I-BDIIALE)
  4342             AND MESES-BDIIALE <= V-MESES-APE3-BDIIALE(I-BDIIALE)
  4343             MOVE 1 TO HAY-INQAPE-BDIIALE
  4344          END-IF
  4345          ADD 1 TO I-BDIIALE
  4346        END-PERFORM
  4347        IF HAY-INQAPE-BDIIALE = 0
  4348           ADD 1 TO CAR-APE-INQ-3M-BDIIALE
  4349        END-IF
  4350     END-IF.
  4351*    ALERTA A IMPLEMENTAR
  4352*    IF CAR-APE-INQ-3M-BDIIALE = 0 *> CONSULTA SIN APERTURA
  4353*       MOVE 1 TO HAY-ALERTA-BDIIALE
  4354*    END-IF.
  4355 2320-ICBCON-CON2MS-BDIIALE.
  4356*****************************************************************
  4357*2320-ICBCON-CON2MS-BDIIALE.
  4358*    SE CALCULA LAS ENTIDADES QUE REALIZARON CONSULTAS EN LOS
  4359*    ULTIMOS 2 MESES (SOLO SUSCRIPTORES)
  4360*****************************************************************
  4361     MOVE FEC-CONSUL-IND(1:2) TO  DIA-CON-BDIIALE(1:2)
  4362     MOVE FEC-CONSUL-IND(3:2) TO  MES-CON-BDIIALE(1:2)
  4363     MOVE FEC-CONSUL-IND(5:2) TO  ANO-CON-BDIIALE(1:2)
  4364     IF ANO-CON-BDIIALE < 50
  4365        MOVE 20 TO SIG-CON-BDIIALE
  4366     ELSE
  4367        MOVE 19 TO SIG-CON-BDIIALE
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  76
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4368     END-IF
  4369     COMPUTE DIAS-BDIIALE =
  4370        ( SIG-ANO-CURRENT-DATE-BDIIALE * 360  +
  4371          MES-CURRENT-DATE-BDIIALE * 30       +
  4372          DIA-CURRENT-DATE-BDIIALE            ) -
  4373        ( SIG-ANO-CON-BDIIALE * 360           +
  4374          MES-CON-BDIIALE * 30                +
  4375          DIA-CON-BDIIALE                     ).
  4376     MOVE 1 TO I-BDIIALE.
  4377     PERFORM UNTIL I-BDIIALE > 20
  4378        IF V-NIT-CON60-BDIIALE(I-BDIIALE) = ZEROS
  4379           IF DIAS-BDIIALE <= 60
  4380              MOVE  NIT-SUSCRIP-S-ABD02 TO
  4381                    V-NIT-CON60-BDIIALE(I-BDIIALE)
  4382              ADD 1 TO CAR-ENT-INQ-2M-BDIIALE
  4383              MOVE 20 TO I-BDIIALE
  4384           END-IF
  4385        ELSE
  4386           IF V-NIT-CON60-BDIIALE(I-BDIIALE) =
  4387                             NIT-SUSCRIP-S-ABD02
  4388              MOVE 20 TO I-BDIIALE
  4389           END-IF
  4390        END-IF
  4391        ADD 1 TO I-BDIIALE
  4392     END-PERFORM.
  4393 2400-ICBDIR-BDIIALE.
  4394*************************************************************
  4395*2400-ICBDIR-BDIIALE.
  4396*    SE RECORRE EL ARCHIVO ICBDIR REGISTRANDO LOS REGISTROS
  4397*    EN LAS RUTINAS DE RECONOCER PARA LUEGO CLACULAR LAS
  4398*    MEJORES DIRECCIONES
  4399*************************************************************
  4400     INITIALIZE LLAVE-DIRECC.
  4401     MOVE 0 TO FIN-ICBDIR-BDIIALE.
  4402     MOVE TIPIDE-INPUT-BDIIALE TO TIPO-ID-DIRECC.
  4403     MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-DIRECC.
  4404     START MAESTRO-DIRECC KEY >= LLAVE-DIRECC
  4405           INVALID KEY
  4406              MOVE 1 TO FIN-ICBDIR-BDIIALE
  4407           NOT INVALID KEY
  4408              READ MAESTRO-DIRECC IGNORE LOCK NEXT AT END
  4409                   MOVE 1 TO FIN-ICBDIR-BDIIALE
  4410              END-READ
  4411     END-START.
  4412     PERFORM 2010-U-INICIAR-TABLAS.
  4413     PERFORM UNTIL TIPIDE-INPUT-BDIIALE NOT = TIPO-ID-DIRECC OR
  4414             NUMIDE-INPUT-BDIIALE NOT = NUM-ID-DIRECC        OR
  4415             FIN-ICBDIR-BDIIALE = 1
  4416        PERFORM 2000-U-VALIDAR-ACCDIR
  4417        IF VALIDACION-DIR-OUT-BDLDIR = 1
  4418           PERFORM 2018-U-PASAR-REG-ICBDIR
  4419        END-IF
  4420        READ MAESTRO-DIRECC IGNORE LOCK NEXT RECORD AT END
  4421             MOVE 1 TO FIN-ICBDIR-BDIIALE
  4422        END-READ
  4423     END-PERFORM.
  4424     PERFORM 2017-U-ELEGIR-DIRECCIONES.
  4425 2500-BDOFICIALES-BDIIALE.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  77
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4426*************************************************************
  4427*2500-BDOFICIALES-BDIIALE.
  4428*    SE VERIFICA SI LA IDENTIFICACIN EXISTE EN ALGUNA DE LAS
  4429*    BASES DE DATOS OFICIALES DE VALIDACION
  4430*************************************************************
  4431     MOVE 1 TO CAR-HAY-BDOFIC-BDIIALE.
  4432     EVALUATE TIPIDE-INPUT-BDIIALE
  4433        WHEN 1
  4434          MOVE TIPIDE-INPUT-BDIIALE TO TIPO-ID-BDIIREGI
  4435          MOVE NUMIDE-INPUT-BDIIALE TO CEDULA-BDIIREGI
  4436          READ BDIIREGI IGNORE LOCK
  4437               INVALID KEY
  4438               MOVE 0 TO CAR-HAY-BDOFIC-BDIIALE
  4439         END-READ
  4440        WHEN 2
  4441          MOVE NUMIDE-INPUT-BDIIALE TO NITS-R-BDIIDIAN
  4442          READ BDIIDIAN IGNORE LOCK
  4443               INVALID KEY
  4444               MOVE 0 TO CAR-HAY-BDOFIC-BDIIALE
  4445         END-READ
  4446        WHEN 3
  4447          MOVE TIPIDE-INPUT-BDIIALE TO TIPO-ID-BDIIDAS
  4448          MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-BDIIDAS
  4449          READ BDIIDIAN IGNORE LOCK
  4450               INVALID KEY
  4451               MOVE 0 TO CAR-HAY-BDOFIC-BDIIALE
  4452         END-READ
  4453        WHEN 4
  4454          MOVE TIPIDE-INPUT-BDIIALE TO TIPO-ID-BDIIDAS
  4455          MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-BDIIDAS
  4456          READ BDIIDIAN IGNORE LOCK
  4457               INVALID KEY
  4458               MOVE 0 TO CAR-HAY-BDOFIC-BDIIALE
  4459         END-READ
  4460        WHEN ANY
  4461          MOVE 0 TO CAR-HAY-BDOFIC-BDIIALE
  4462     END-EVALUATE.
  4463 3000-PROCESE-ALERTAS-BDIIALE.
  4464**********************************************************************
  4465*3000-PROCESE-ALERTAS-BDIIALE.
  4466*    SE REALIZA EL PROCESO DE GENERACION DE LAS ALERTAS CONTRATADAS
  4467*    PARA LA IDENTIFICACION DADA.
  4468**********************************************************************
  4469     PERFORM 3100-INICIAR-ALE-CLA-BDIIALE.
  4470     PERFORM 3200-BUSCAR-ALE-SUSCR-BDIIALE.
  4471     PERFORM 3300-CALCULAR-ALE-SUSCR-BDIIALE.
  4472 3100-INICIAR-ALE-CLA-BDIIALE.
  4473***********************************************************************
  4474*3100-INICIAR-ALE-CLA-BDIIALE.
  4475*    DE INICIALIZAN LAS ESTRUCTURAS DE SALIDA Y SE TOMAN LOS PARAMETROS
  4476*    DE INPUT LLENANDO LAS ESTRUCTURAS DE TRABAJO
  4477***********************************************************************
  4478     MOVE SPACES TO M-GRU-GRUCLA-BDIIALE.
  4479     MOVE SPACES TO M-PRO-GRUCLA-BDIIALE.
  4480     MOVE ZEROS  TO M-HUBOALE-GRUCLA-BDIIALE.
  4481     MOVE SPACES TO M-CUALALE-GRUCLA-BDIIALE.
  4482     MOVE ZEROS  TO M-FLAG-ALERTAS-BDIIALE.
  4483     MOVE SPACES TO MX-ALE-OUTPUT-BDIIALE.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  78
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4484     MOVE ZEROS  TO MN-ALE-OUTPUT-BDIIALE.
  4485*    SE LLENAN LOS GRUPOS DEFAULT O DE LEY EN LOS GRUPOS A PROCESAR
  4486     MOVE M-GRU-DEFAULT-BDIIALE TO M-GRU-GRUCLA-BDIIALE
  4487     MOVE M-PRO-DEFAULT-BDIIALE TO M-PRO-GRUCLA-BDIIALE
  4488     MOVE M-COB-DEFAULT-BDIIALE TO M-COB-GRUCLA-BDIIALE
  4489     MOVE 1 TO I-BDIIALE.
  4490*    SE DETERMINA LA POSICION PARA ADICIONAR LO CONTRATADO
  4491     PERFORM UNTIL V-GRU-GRUCLA-BDIIALE(I-BDIIALE) = SPACES OR
  4492                                        I-BDIIALE > 20
  4493       ADD 1 TO I-BDIIALE
  4494     END-PERFORM.
  4495*    SE ADICIONAN LOS GRUPOS CONTRATADOS A LOS GRUPOS A PROCESAR
  4496     IF I-BDIIALE < 20
  4497        MOVE 1 TO J-BDIIALE
  4498        PERFORM UNTIL V-PRODUC-INPUT-BDIIALE(J-BDIIALE) = SPACES
  4499                                      OR  J-BDIIALE  > 21
  4500           MOVE 1 TO K-BDIIALE
  4501*          SE UBICA CUAL ES EL GRUPO PARA EL PRODUCTO
  4502           PERFORM UNTIL V-GRU-GRUPOS-BDIIALE(K-BDIIALE) = SPACES
  4503                                          OR  K-BDIIALE  > 21
  4504             IF V-PRO-GRUPOS-BDIIALE(K-BDIIALE) =
  4505                V-PRODUC-INPUT-BDIIALE(J-BDIIALE)
  4506                MOVE V-GRU-GRUPOS-BDIIALE(K-BDIIALE) TO
  4507                     V-GRU-GRUCLA-BDIIALE(I-BDIIALE)
  4508                MOVE V-PRODUC-INPUT-BDIIALE(J-BDIIALE) TO
  4509                     V-PRO-GRUCLA-BDIIALE(I-BDIIALE)
  4510                MOVE V-COB-GRUPOS-BDIIALE(K-BDIIALE) TO
  4511                     V-COB-GRUCLA-BDIIALE(I-BDIIALE)
  4512                     ADD 1 TO I-BDIIALE
  4513                MOVE 20 TO K-BDIIALE
  4514             END-IF
  4515             ADD 1 TO K-BDIIALE
  4516           END-PERFORM
  4517           ADD 1 TO J-BDIIALE
  4518        END-PERFORM
  4519     ELSE
  4520        DISPLAY "BDIIALE:ERROR NO HABIA ESPACIOS EN GRUCLA="
  4521                M-GRU-GRUCLA-BDIIALE
  4522     END-IF.
  4523 3200-BUSCAR-ALE-SUSCR-BDIIALE.
  4524******************************************************************
  4525*3200-BUSCAR-ALE-SUSCR-BDIIALE.
  4526*    PARA CADA GRUPO CONTRATADO POR EL CLIENTE SE DETERMINA
  4527*    CUALES SON LAS ALERTAS QUE SE DEBEN CALCULAR, ESTO SE HACE
  4528*    PRENDIENDO  EL FLAG V-FLAG-ALERTAS-BDIIALE(I)
  4529******************************************************************
  4530     MOVE 1 TO I-BDIIALE.
  4531*    MIENTRAS QUE HAYA GRUPOS CONTRATADOS
  4532     PERFORM UNTIL V-GRU-GRUCLA-BDIIALE(I-BDIIALE) = SPACES
  4533       MOVE 1 TO J-BDIIALE
  4534*      MIENTRAS QUE HAYA GRUPOS-CLAVE DEFINIDOS
  4535       PERFORM UNTIL V-ALE-ALEGRU-BDIIALE (J-BDIIALE) = SPACES OR
  4536                                           J-BDIIALE  > 1000
  4537*        SI EL GRUPO ESTA CONTRATADO
  4538         IF V-GRU-ALEGRU-BDIIALE(J-BDIIALE) =
  4539                                 V-GRU-GRUCLA-BDIIALE(I-BDIIALE)
  4540            MOVE V-APUALE-ALEGRU-BDIIALE(J-BDIIALE) TO K-BDIIALE
  4541*           PRENDA EL FLAG PARA QUE ESTA ALERTA SE CALCULE
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  79
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4542            MOVE 1 TO V-FLAG-ALERTAS-BDIIALE(K-BDIIALE)
  4543         END-IF
  4544         ADD 1 TO J-BDIIALE
  4545       END-PERFORM
  4546       ADD 1 TO I-BDIIALE
  4547     END-PERFORM.
  4548 3300-CALCULAR-ALE-SUSCR-BDIIALE.
  4549***********************************************************************
  4550*3300-CALCULAR-ALE-SUSCR-BDIIALE.
  4551*    DE ACUERDO A LOS FLAGS PRENDIDOS PARA LAS ALERTAS CONTRATADAS SE
  4552*    PROCEDEN A CALCULAR CADA UNA DE ESTAS
  4553***********************************************************************
  4554     MOVE 00 TO OPCION-ALE-BDIIALE. *> OPCION DEFAULT DE LA ALERTA
  4555     MOVE 1 TO I-BDIIALE
  4556     MOVE 1 TO Z-BDIIALE
  4557     PERFORM UNTIL V-ALE-ALERTAS-BDIIALE(I-BDIIALE) = SPACES OR
  4558                                         I-BDIIALE  > 1000
  4559        MOVE 0 TO HAY-ALERTA-BDIIALE
  4560        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4561           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0001"
  4562           PERFORM 3310-ALERTA-0001-BDIIALE
  4563        END-IF
  4564        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4565           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0002"
  4566           PERFORM 3310-ALERTA-0002-BDIIALE
  4567        END-IF
  4568        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4569           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0003"
  4570           PERFORM 3310-ALERTA-0003-BDIIALE
  4571        END-IF
  4572        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4573           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0004"
  4574           PERFORM 3310-ALERTA-0004-BDIIALE
  4575        END-IF
  4576        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4577           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0005"
  4578           PERFORM 3310-ALERTA-0005-BDIIALE
  4579        END-IF
  4580        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4581           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0006"
  4582           PERFORM 3310-ALERTA-0006-BDIIALE
  4583        END-IF
  4584        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4585           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0007"
  4586           PERFORM 3310-ALERTA-0007-BDIIALE
  4587        END-IF
  4588        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4589           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0008"
  4590           PERFORM 3310-ALERTA-0008-BDIIALE
  4591        END-IF
  4592        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4593           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0009"
  4594           PERFORM 3310-ALERTA-0009-BDIIALE
  4595        END-IF
  4596        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4597           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0010"
  4598           PERFORM 3310-ALERTA-0010-BDIIALE
  4599        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  80
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4600        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4601           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0011"
  4602           PERFORM 3310-ALERTA-0011-BDIIALE
  4603        END-IF
  4604        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4605           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0012"
  4606           PERFORM 3310-ALERTA-0012-BDIIALE
  4607        END-IF
  4608        IF V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4609           V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "0013"
  4610           PERFORM 3310-ALERTA-0013-BDIIALE
  4611        END-IF
  4612        IF HAY-ALERTA-BDIIALE = 1
  4613           PERFORM 3320-PONER-ALE-OUTPUT-BDIIALE
  4614           PERFORM 3330-PRENDER-USOGRUPO-BDIIALE
  4615        END-IF
  4616        ADD 1 TO I-BDIIALE
  4617     END-PERFORM.
  4618*    SE RECORREN TODAS LAS ALARMAS PARA VER CUALES DE LAS
  4619*    DEFAULT HAY QUE MANDAR (RUTINA 9999)
  4620     MOVE 1 TO I-BDIIALE
  4621     PERFORM UNTIL V-ALE-ALERTAS-BDIIALE(I-BDIIALE) = SPACES OR
  4622                                         I-BDIIALE  > 1000
  4623        IF  V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) = 1 AND
  4624           V-ESG-ALERTAS-BDIIALE (I-BDIIALE) = "S"   *> GRUPO
  4625           IF V-NOM-ALERTAS-BDIIALE (I-BDIIALE) =       "9999"
  4626              PERFORM 3310-ALERTA-9999-BDIIALE
  4627           END-IF
  4628        END-IF
  4629        ADD 1 TO I-BDIIALE
  4630     END-PERFORM.
  4631 3320-PONER-ALE-OUTPUT-BDIIALE.
  4632******************************************************************
  4633*3320-PONER-ALE-OUTPUT-BDIIALE.
  4634*    SE LLENA LOS CAMPOS OUTPUT CON LA INFORMACION DE LAS ALERTAS
  4635*    CON LAS CONVENCIONES ESTANDARES DE ACUERDO SI ES CALCULADA
  4636*    O PRECALCULADA (BDIIALE)
  4637******************************************************************
  4638     MOVE V-ALE-ALERTAS-BDIIALE(I-BDIIALE) TO
  4639          V-ALE-OUTPUT-BDIIALE(Z-BDIIALE).
  4640     IF V-TIP-ALERTAS-BDIIALE(I-BDIIALE) =  "C"  *> CALCULADA
  4641        IF OPCION-ALE-BDIIALE = 00    *>DEFAULT
  4642           MOVE I-BDIIALE TO A-BDIIALE
  4643           PERFORM 3321-LLENAR-CAMPOS-CALC-BDIIALE
  4644        ELSE
  4645           MOVE I-BDIIALE TO A-BDIIALE
  4646           ADD 1 TO A-BDIIALE
  4647           PERFORM UNTIL V-OPC-ALERTAS-BDIIALE(A-BDIIALE) = SPACES
  4648                                           OR  A-BDIIALE > 1000
  4649             IF V-OPC-ALERTAS-BDIIALE(A-BDIIALE) =
  4650                                               OPCION-ALE-BDIIALE
  4651                PERFORM 3321-LLENAR-CAMPOS-CALC-BDIIALE
  4652                MOVE 1000 TO A-BDIIALE
  4653             END-IF
  4654             ADD 1 TO A-BDIIALE
  4655           END-PERFORM
  4656        END-IF
  4657     END-IF.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  81
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4658     ADD 1 TO Z-BDIIALE.
  4659 3321-LLENAR-CAMPOS-CALC-BDIIALE.
  4660****************************************************************
  4661*3321-LLENAR-CAMPOS-CALC-BDIIALE.
  4662*    SE LLENAN LOS CAMPOS OUTPUT DE LAS ALERTAS QUE SON
  4663*    CALCULADAS (LOGICA INTERNA )
  4664****************************************************************
  4665*    SI NO FUE LLENADA DINAMICAMENTE (TEXTO-VARIABLE)
  4666     IF V-DE1-OUTPUT-BDIIALE(Z-BDIIALE) = SPACES
  4667        MOVE V-DE1-ALERTAS-BDIIALE(A-BDIIALE) TO
  4668             V-DE1-OUTPUT-BDIIALE(Z-BDIIALE)
  4669        MOVE V-DE2-ALERTAS-BDIIALE(A-BDIIALE) TO
  4670             V-DE2-OUTPUT-BDIIALE(Z-BDIIALE)
  4671     END-IF.
  4672     MOVE V-FUE-ALERTAS-BDIIALE(A-BDIIALE) TO
  4673                                V-FUE-OUTPUT-BDIIALE(Z-BDIIALE)
  4674     MOVE FUNCTION CURRENT-DATE(1:8)       TO
  4675                                V-FEC-OUTPUT-BDIIALE(Z-BDIIALE)
  4676                                V-FVN-OUTPUT-BDIIALE(Z-BDIIALE)
  4677                                V-FMD-OUTPUT-BDIIALE(Z-BDIIALE)
  4678     MOVE SPACES TO             V-HOS-OUTPUT-BDIIALE(Z-BDIIALE).
  4679 3330-PRENDER-USOGRUPO-BDIIALE.
  4680******************************************************************
  4681*3330-PRENDER-USOGRUPO-BDIIALE.
  4682*    PRENDER EL FLAG DE QUE EL GRUPO FUE ALERTADO (SE CALCULO
  4683*    ALGUNA ALERTA DE ESE GRUPO PARA EL SUSCRIPTOR)
  4684******************************************************************
  4685     MOVE 1 TO J-BDIIALE
  4686*    BUSQUE CUALES SON LOS GRUPOS DE LA ALERTA ENVIADA
  4687     PERFORM UNTIL V-ALE-ALEGRU-BDIIALE(J-BDIIALE) = SPACES
  4688                                     OR J-BDIIALE  > 1000
  4689       IF V-ALE-ALEGRU-BDIIALE(J-BDIIALE) =
  4690          V-ALE-ALERTAS-BDIIALE(I-BDIIALE)
  4691          MOVE 1 TO K-BDIIALE
  4692*         BUSQUE LA POSICION DEL GRUPO EN LA TABLA SUSCLA
  4693          PERFORM UNTIL V-GRU-GRUCLA-BDIIALE(K-BDIIALE) = SPACES
  4694                                OR  K-BDIIALE  > 20
  4695            IF V-GRU-GRUCLA-BDIIALE(K-BDIIALE) =
  4696               V-GRU-ALEGRU-BDIIALE(J-BDIIALE)
  4697*              SUMA LAS ALERTAS REALIZADAS EN EL GRUPO
  4698               ADD  1 TO V-HUBOALE-GRUCLA-BDIIALE(K-BDIIALE)
  4699               IF V-HUBOALE-GRUCLA-BDIIALE(K-BDIIALE) <= 10
  4700                  MOVE V-HUBOALE-GRUCLA-BDIIALE(K-BDIIALE) TO
  4701                       W-BDIIALE
  4702                  MOVE V-ALE-ALERTAS-BDIIALE(I-BDIIALE) TO
  4703                     V-CUALALE-GRUCLA-BDIIALE(K-BDIIALE,W-BDIIALE)
  4704               END-IF
  4705            END-IF
  4706            ADD 1 TO K-BDIIALE
  4707          END-PERFORM
  4708        END-IF
  4709        ADD 1 TO J-BDIIALE
  4710     END-PERFORM.
  4711 3311-PRECALCULADAS-BDIIALE.
  4712******************************************************************
  4713*3311-PRECALCULADAS-BDIIALE.
  4714*    SE RECORRE EL ARCHIVO DE ALERTAS BUSCANDO SI EXISTE EL CODIGO
  4715*    DE LA ALERTA PARA LA IDENTIFICACION EXAMINADA
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  82
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4716******************************************************************
  4717     MOVE TIPIDE-INPUT-BDIIALE TO TIP-IDE-BDIIALE.
  4718     MOVE NUMIDE-INPUT-BDIIALE TO NUM-IDE-BDIIALE.
  4719     MOVE ZEROS  TO FUENTE-BDIIALE
  4720     MOVE ZEROS  TO COD-ALERTA-BDIIALE
  4721     MOVE SPACES TO LLASEC-BDIIALE.
  4722     MOVE 0 TO HAY-ALERTA-BDIIALE.
  4723     MOVE 0 TO FIN-ARCHI-BDIIALE.
  4724     START BDIIALE KEY > LLAVE-BDIIALE
  4725           INVALID KEY
  4726              MOVE 0 TO HAY-ALERTA-BDIIALE
  4727              MOVE 1 TO FIN-ARCHI-BDIIALE
  4728           NOT INVALID KEY
  4729              READ BDIIALE IGNORE LOCK  NEXT RECORD
  4730                 AT END
  4731                    MOVE 0 TO HAY-ALERTA-BDIIALE
  4732                    MOVE 1 TO FIN-ARCHI-BDIIALE
  4733              END-READ
  4734     END-START.
  4735     PERFORM UNTIL FIN-ARCHI-BDIIALE = 1           OR
  4736        NUM-IDE-BDIIALE NOT = NUMIDE-INPUT-BDIIALE OR
  4737        TIP-IDE-BDIIALE NOT = TIPIDE-INPUT-BDIIALE
  4738*       SE CONSERVAN LA ACTUALES DONDE LA LLAVE ALTERNA ESTA VACIA
  4739        IF V-ALE-ALERTAS-BDIIALE(I-BDIIALE)(1:1) = "E"
  4740           IF LLASEC-BDIIALE = SPACES      AND
  4741              COD-ALERTA-BDIIALE(1:3) =
  4742              V-ALE-ALERTAS-BDIIALE(I-BDIIALE)(2:3)
  4743              PERFORM 3311-LLENAR-CAMPOS-PREC-BDIIALE
  4744           END-IF
  4745        ELSE
  4746*          PARA LOS DEMAS SE EXIJE QUE EL CODIGO DE LA ALERTA
  4747*          ESTE EN LLASEC Y QUE COD-ALERTA DEBE SER 000
  4748           IF LLASEC-BDIIALE(1:4) =
  4749              V-ALE-ALERTAS-BDIIALE(I-BDIIALE) AND
  4750              COD-ALERTA-BDIIALE = 000
  4751              PERFORM 3311-LLENAR-CAMPOS-PREC-BDIIALE
  4752           END-IF
  4753        END-IF
  4754        READ BDIIALE IGNORE LOCK NEXT RECORD
  4755             AT END
  4756                MOVE 1 TO FIN-ARCHI-BDIIALE
  4757        END-READ
  4758     END-PERFORM.
  4759 3311-LLENAR-CAMPOS-PREC-BDIIALE.
  4760******************************************************************
  4761*3311-LLENAR-CAMPOS-PREC-BDIIALE.
  4762* SE VERIFICA SI YA ES UNA LA ALERTA QUE HA CADUCADO PARA NO SACARLA
  4763* MAS. O SI ESTA BLOQUEADA NO MOSTRARLA
  4764******************************************************************
  4765     MOVE FUNCTION CURRENT-DATE(1:8) TO W-FECHA-BDIIALE
  4766     IF FEC-VEN-BDIIALE <  W-FECHA-BDIIALE OR
  4767                           BLOQUEO-BDIIALE > 0
  4768        MOVE 0 TO HAY-ALERTA-BDIIALE
  4769     ELSE
  4770        MOVE FEC-NOV-BDIIALE TO V-FEC-OUTPUT-BDIIALE(Z-BDIIALE)
  4771        MOVE FEC-VEN-BDIIALE TO V-FVN-OUTPUT-BDIIALE(Z-BDIIALE)
  4772        MOVE FEC-REP-BDIIALE TO V-FMD-OUTPUT-BDIIALE(Z-BDIIALE)
  4773        MOVE FUENTE-BDIIALE  TO V-FUE-OUTPUT-BDIIALE(Z-BDIIALE)
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  83
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4774        IF V-DE1-ALERTAS-BDIIALE(I-BDIIALE) = SPACES
  4775           MOVE LINEA1-BDIIALE  TO V-DE1-OUTPUT-BDIIALE(Z-BDIIALE)
  4776           MOVE LINEA2-BDIIALE  TO V-DE2-OUTPUT-BDIIALE(Z-BDIIALE)
  4777        ELSE
  4778           MOVE INF-DATAHOST-BDIIALE TO TEXTO-VARIABLE-BDIIALE
  4779           PERFORM 3311-ARMAR-TEXTO-BDIIALE
  4780        END-IF
  4781        MOVE INF-DATAHOST-BDIIALE TO
  4782                                V-HOS-OUTPUT-BDIIALE(Z-BDIIALE)
  4783        MOVE 1 TO HAY-ALERTA-BDIIALE
  4784     END-IF.
  4785 3311-ARMAR-TEXTO-BDIIALE.
  4786******************************************************************
  4787*3311-ARMAR-TEXTO-BDIIALE.
  4788*    SE ARMA EL TEXTO DE SALIDA REEMPLAZANDO LAS CADENAS [&&&&] POR
  4789*    LO QUE TIENE EN LA INFORMACION DEL DATAHOST
  4790******************************************************************
  4791     MOVE 1 TO J-BDIIALE.
  4792     MOVE 1 TO L-BDIIALE.
  4793     MOVE 1 TO K-BDIIALE.
  4794     MOVE 0 TO BEGIN-CORCHETE-BDIIALE
  4795     PERFORM UNTIL J-BDIIALE > 50
  4796       MOVE V-DE1-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE:1) TO
  4797            V-DE1-OUTPUT-BDIIALE(Z-BDIIALE)(L-BDIIALE:1)
  4798       IF V-DE1-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE:1) = "[" AND
  4799          V-DE1-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE + 1 :1) = "&"
  4800          SUBTRACT 1 FROM L-BDIIALE
  4801          MOVE 1 TO BEGIN-CORCHETE-BDIIALE
  4802       END-IF
  4803       IF V-DE1-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE:1) = "]" AND
  4804          BEGIN-CORCHETE-BDIIALE = 1
  4805          MOVE " " TO V-DE1-OUTPUT-BDIIALE(Z-BDIIALE)(L-BDIIALE:1)
  4806          SUBTRACT 1 FROM L-BDIIALE
  4807          MOVE 0 TO BEGIN-CORCHETE-BDIIALE
  4808       END-IF
  4809       IF BEGIN-CORCHETE-BDIIALE = 1
  4810          IF V-DE1-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE:1) = "&"
  4811             MOVE TEXTO-VARIABLE-BDIIALE(K-BDIIALE:1) TO
  4812             V-DE1-OUTPUT-BDIIALE(Z-BDIIALE)(L-BDIIALE:1)
  4813             ADD 1 TO K-BDIIALE
  4814          END-IF
  4815       END-IF
  4816       ADD 1 TO J-BDIIALE
  4817       ADD 1 TO L-BDIIALE
  4818     END-PERFORM.
  4819     MOVE 1 TO J-BDIIALE.
  4820     MOVE 1 TO L-BDIIALE.
  4821     MOVE 0 TO BEGIN-CORCHETE-BDIIALE
  4822     PERFORM UNTIL J-BDIIALE > 50
  4823       MOVE V-DE2-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE:1) TO
  4824            V-DE2-OUTPUT-BDIIALE(Z-BDIIALE)(L-BDIIALE:1)
  4825       IF V-DE2-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE:1) = "[" AND
  4826          V-DE2-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE + 1 :1) = "&"
  4827          SUBTRACT 1 FROM L-BDIIALE
  4828          MOVE 1 TO BEGIN-CORCHETE-BDIIALE
  4829       END-IF
  4830       IF V-DE2-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE:1) = "]"
  4831          MOVE " " TO V-DE2-OUTPUT-BDIIALE(Z-BDIIALE)(L-BDIIALE:1)
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  84
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4832          SUBTRACT 1 FROM L-BDIIALE
  4833          MOVE 0 TO BEGIN-CORCHETE-BDIIALE
  4834       END-IF
  4835       IF BEGIN-CORCHETE-BDIIALE = 1
  4836          IF V-DE2-ALERTAS-BDIIALE(I-BDIIALE)(J-BDIIALE:1) = "&"
  4837             MOVE TEXTO-VARIABLE-BDIIALE(K-BDIIALE:1) TO
  4838             V-DE2-OUTPUT-BDIIALE(Z-BDIIALE)(L-BDIIALE:1)
  4839             ADD 1 TO K-BDIIALE
  4840          END-IF
  4841       END-IF
  4842       ADD 1 TO J-BDIIALE
  4843       ADD 1 TO L-BDIIALE
  4844     END-PERFORM.
  4845 3310-ALERTA-0001-BDIIALE.
  4846**********************************************************************
  4847*3310-ALERTA-0001-BDIIALE.
  4848*    CALCULO DE LA ALERTA 0001  CEDULA EXTRAVIADA PRECALCULADA
  4849**********************************************************************
  4850     PERFORM 3311-PRECALCULADAS-BDIIALE.
  4851     IF DEBUG-BDIIALE = 1
  4852        PERFORM 9100-SIMULAR-ALERTA-BDIIALE
  4853     END-IF.
  4854 3310-ALERTA-0002-BDIIALE.
  4855**********************************************************************
  4856*3310-ALERTA-0002-BDIIALE.
  4857*    CALCULO DE LA ALERTA 0002 CEDULA ROBADA   PRECALCULADA
  4858**********************************************************************
  4859     PERFORM 3311-PRECALCULADAS-BDIIALE.
  4860     IF DEBUG-BDIIALE = 1
  4861        PERFORM 9100-SIMULAR-ALERTA-BDIIALE
  4862     END-IF.
  4863 3310-ALERTA-0003-BDIIALE.
  4864**********************************************************************
  4865*3310-ALERTA-0003-BDIIALE.
  4866*    CALCULO DE LA ALERTA 0003  FUERA DEL PAIS PRECALCULADA
  4867**********************************************************************
  4868     PERFORM 3311-PRECALCULADAS-BDIIALE.
  4869     IF DEBUG-BDIIALE = 1
  4870        PERFORM 9100-SIMULAR-ALERTA-BDIIALE
  4871     END-IF.
  4872 3310-ALERTA-0004-BDIIALE.
  4873**********************************************************************
  4874*3310-ALERTA-0004-BDIIALE.
  4875*    CALCULO DE LA ALERTA 0004 OBJETO DE SUPLANTACION PRECALCULADA
  4876**********************************************************************
  4877     PERFORM 3311-PRECALCULADAS-BDIIALE.
  4878     IF DEBUG-BDIIALE = 1
  4879        PERFORM 9100-SIMULAR-ALERTA-BDIIALE
  4880     END-IF.
  4881 3310-ALERTA-0005-BDIIALE.
  4882**********************************************************************
  4883*3310-ALERTA-0005-BDIIALE.
  4884*    CALCULO DE LA ALERTA 0005 ALERTA DE DOBLE IDENTIDAD
  4885*    SI EL PRODUCTO LLAMADOR ES PJ (61) NO SE DEBE GENERAR SI LA
  4886*    OPCION ES LA 02 (TECS) . ESTA SE GENERAR EN LA ALERTA 8
  4887**********************************************************************
  4888     MOVE "DATACREDITO"       TO V-NFU-OUTPUT-BDIIALE(Z-BDIIALE).
  4889     IF TIPIDE-INPUT-BDIIALE = 1 OR 2
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  85
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4890        IF TIPIDE-INPUT-BDIIALE = 1
  4891           MOVE 2 TO TIPIDE-OTRID-BDIIALE
  4892        ELSE
  4893           MOVE 1 TO TIPIDE-OTRID-BDIIALE
  4894        END-IF
  4895        PERFORM 3311-VERSITIENECTAS-BDIIALE
  4896     ELSE
  4897        MOVE 1 TO MENS-ERR-BDIIALE
  4898     END-IF.
  4899     IF MENS-ERR-BDIIALE = 0 OR DEBUG-BDIIALE = 1
  4900        MOVE 1 TO HAY-ALERTA-BDIIALE
  4901        IF ES-INDEPENDIENTE-INPUT-BDIIALE = 1
  4902           IF PROD-HC-INPUT-BDIIALE <> 61     *> HC PERSONA JURIDICA
  4903              MOVE 02   TO OPCION-ALE-BDIIALE
  4904           ELSE
  4905              MOVE 0 TO HAY-ALERTA-BDIIALE
  4906           END-IF
  4907        ELSE
  4908           IF TIPIDE-INPUT-BDIIALE = 1
  4909              MOVE 00 TO OPCION-ALE-BDIIALE
  4910           ELSE
  4911              MOVE 01 TO OPCION-ALE-BDIIALE
  4912           END-IF
  4913        END-IF
  4914     END-IF.
  4915     IF DEBUG-BDIIALE = 1
  4916        PERFORM 9100-SIMULAR-ALERTA-BDIIALE
  4917     END-IF.
  4918 3311-VERSITIENECTAS-BDIIALE.
  4919******************************************************************
  4920*3311-VERSITIENECTAS.
  4921* SE VERIFICA SI LA PERSONA TIENE CUENTAS EN HABITO DE PAGO PARA
  4922* INDICAR ESTO EN EL MENSAJE DE SALIDA.
  4923******************************************************************
  4924     MOVE 1 TO MENS-ERR-BDIIALE                                   RMB0147
  4925     INITIALIZE LLAVE-MAES-CHECK.                                 RMB0147
  4926     MOVE TIPIDE-OTRID-BDIIALE TO TIPO-ID-ABD06
  4927     MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-ABD06.
  4928     MOVE 0 TO FIN-CHECK-BDIIALE                                  RMB0147
  4929     PERFORM 0600-ASIGNA-ID-ICMCHK-START.                         RMB0198
  4930     START MAESTRO-CHECK KEY > LLAVE-MAES-CHECK                   RMB0147
  4931        INVALID KEY MOVE 1 TO FIN-CHECK-BDIIALE                   RMB0147
  4932        NOT INVALID KEY                                           RMB0147
  4933           MOVE 1 TO SW-ELIMINA-BBVA-LEEMSTRS
  4934           IF MOSTRAR-BBVA-INPUT-BDIIALE = 1
  4935              MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS                  GJC0241
  4936           END-IF                                                 GJC0241
  4937           PERFORM  3000-LEE-ICMCHK-SECUENCIAL                    RMB0198
  4938           IF  SW-LECTURA-MAESTROS  =  1                          RMB0198
  4939               MOVE 1 TO FIN-CHECK-BDIIALE                        RMB0198
  4940           END-IF                                                 RMB0198
  4941     END-START.                                                   RMB0147
  4942     PERFORM UNTIL TIPIDE-OTRID-BDIIALE NOT = TIPO-ID-ABD06 OR
  4943                   NUMIDE-INPUT-BDIIALE NOT = NUM-ID-ABD06  OR
  4944                   FIN-CHECK-BDIIALE = 1  OR MENS-ERR-BDIIALE = 0
  4945        IF IND-BLOQUEO-ABD06 = 0                                  RMB0147
  4946           MOVE COD-SUS-ABD06 TO COD-SUSCRIP-ABD02                RMB0147
  4947           READ SUSCRIPTOR WITH IGNORE LOCK                       RMB0147
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  86
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  4948              NOT INVALID KEY                                     RMB0147
  4949                  IF ESTADO-ABD02 = 1                             RMB0147
  4950                     MOVE 0 TO MENS-ERR-BDIIALE                   RMB0147
  4951                  END-IF                                          RMB0147
  4952           END-READ                                               RMB0147
  4953        END-IF                                                    RMB0147
  4954        MOVE 1 TO SW-ELIMINA-BBVA-LEEMSTRS                        GJC0212
  4955        IF MOSTRAR-BBVA-INPUT-BDIIALE = 1
  4956           MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS                     GJC0241
  4957        END-IF                                                    GJC0241
  4958        PERFORM  3000-LEE-ICMCHK-SECUENCIAL                       RMB0198
  4959        IF  SW-LECTURA-MAESTROS  =  1                             RMB0198
  4960            MOVE 1 TO FIN-CHECK-BDIIALE                           RMB0198
  4961        END-IF                                                    RMB0198
  4962     END-PERFORM.                                                 RMB0147
  4963     INITIALIZE LLAVE-MAES-CREDIT.                                RMB0147
  4964     MOVE TIPIDE-OTRID-BDIIALE TO TIPO-ID-ABD07
  4965     MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-ABD07.
  4966     MOVE 0 TO FIN-CREDIT-BDIIALE                                 RMB0147
  4967     PERFORM 0500-ASIGNA-ID-ICMCRE-START.                         RMB0198
  4968     START MAESTRO-CREDIT KEY > LLAVE-MAES-CREDIT                 RMB0147
  4969        INVALID KEY MOVE 1 TO FIN-CREDIT-BDIIALE                  RMB0147
  4970        NOT INVALID KEY                                           RMB0147
  4971           MOVE 1 TO SW-ELIMINA-BBVA-LEEMSTRS                     GJC0212
  4972           IF MOSTRAR-BBVA-INPUT-BDIIALE = 1
  4973              MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS                  GJC0241
  4974           END-IF                                                 GJC0241
  4975           PERFORM  1000-LEE-ICMCRE-SECUENCIAL                    RMB0198
  4976           IF  SW-LECTURA-MAESTROS  =  1                          RMB0198
  4977               MOVE 1 TO FIN-CREDIT-BDIIALE                       RMB0198
  4978           END-IF                                                 RMB0198
  4979     END-START.                                                   RMB0147
  4980     PERFORM UNTIL TIPIDE-OTRID-BDIIALE NOT = TIPO-ID-ABD07
  4981        OR NUMIDE-INPUT-BDIIALE NOT = NUM-ID-ABD07 OR
  4982           FIN-CREDIT-BDIIALE = 1 OR MENS-ERR-BDIIALE = 0
  4983        IF IND-BLOQUEO-ABD07 = 0                                  RMB0147
  4984           MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                RMB0147
  4985           READ SUSCRIPTOR WITH IGNORE LOCK                       RMB0147
  4986              NOT INVALID KEY                                     RMB0147
  4987                  IF ESTADO-ABD02 = 1                             RMB0147
  4988                     MOVE 0 TO MENS-ERR-BDIIALE                   RMB0147
  4989                  END-IF                                          RMB0147
  4990           END-READ                                               RMB0147
  4991        END-IF                                                    RMB0147
  4992        MOVE 1 TO SW-ELIMINA-BBVA-LEEMSTRS                        GJC0212
  4993        IF MOSTRAR-BBVA-INPUT-BDIIALE = 1
  4994           MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS                     GJC0241
  4995        END-IF                                                    GJC0241
  4996        PERFORM  1000-LEE-ICMCRE-SECUENCIAL                       RMB0198
  4997        IF  SW-LECTURA-MAESTROS  =  1                             RMB0198
  4998             MOVE 1 TO FIN-CREDIT-BDIIALE                         RMB0198
  4999        END-IF                                                    RMB0198
  5000      END-PERFORM.                                                RMB0147
  5001 3310-ALERTA-0006-BDIIALE.
  5002******************************************************************
  5003*3310-ALERTA-0006-BDIIALE.
  5004*    CALCULO DE LA ALERTA 0006 SIN INFORMACION EN LAS BASES
  5005*    OFICIALES DE LA REGIS,DAS,DIAN (CALCULADA)
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  87
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  5006******************************************************************
  5007     MOVE "B.D DATACREDITO"    TO V-NFU-OUTPUT-BDIIALE(Z-BDIIALE).
  5008     EVALUATE TIPIDE-INPUT-BDIIALE
  5009        WHEN 1
  5010          MOVE 00 TO OPCION-ALE-BDIIALE
  5011        WHEN 2
  5012          MOVE 01 TO OPCION-ALE-BDIIALE
  5013        WHEN 3
  5014          MOVE 01 TO OPCION-ALE-BDIIALE
  5015        WHEN 4
  5016          MOVE 02 TO OPCION-ALE-BDIIALE
  5017        WHEN ANY
  5018          MOVE 00 TO OPCION-ALE-BDIIALE
  5019     END-EVALUATE.
  5020     IF CAR-HAY-BDOFIC-BDIIALE = 0
  5021        MOVE 1 TO HAY-ALERTA-BDIIALE
  5022     END-IF.
  5023     IF DEBUG-BDIIALE = 1
  5024        MOVE 1 TO HAY-ALERTA-BDIIALE
  5025     END-IF.
  5026 3310-ALERTA-0007-BDIIALE.
  5027**********************************************************************
  5028*3310-ALERTA-0007-BDIIALE.
  5029*    SE VERIFICA SI ES UNA IDENTIFICACION ES TIPO 7 PARA CALCULAR LA
  5030*    ALERTA DEL APELLIDO DIFERENTE
  5031**********************************************************************
  5032     IF CAR-HAY-BDOFIC-BDIIALE = 0 AND
  5033        CAR-CTA-CSV-BD-BDIIALE = 0
  5034        PERFORM 3311-SI-ALERTA-0007-BDIIALE
  5035     END-IF.
  5036 3311-SI-ALERTA-0007-BDIIALE.
  5037**********************************************************************
  5038*3311-SI-ALERTA-0007-BDIIALE.
  5039*    CALCULO DE LA ALERTA 0007 BUSCA HUELLAS DE CONSULTA QUE HALLAN
  5040*    REGISTRADO UN APELLIDO DIFERENTE AL USADO EN EL LLAMADO ACTUAL
  5041*    (CALCULADA) . DADO QUE SE PUEDEN IR GENERANDO VARIAS, SE VAN
  5042*    MATRICULANDO LAS ALERTAS EN LA TABLA OUTPUT MENOS LA ULTIMA
  5043*    QUE EL MOTOR LA MATRICULARA AUTOMATICAMENTE
  5044**********************************************************************
  5045     MOVE TIPIDE-INPUT-BDIIALE TO TIP-ID-IND
  5046     MOVE NUMIDE-INPUT-BDIIALE TO NUM-ID-IND
  5047     MOVE 0 TO CONSECUTIVO-IND
  5048     MOVE 0 TO FIN-CONSU-BDIIALE
  5049     START INDEXADO KEY >  LLAVE-INDEX
  5050       INVALID KEY
  5051         MOVE 1 TO FIN-CONSU-BDIIALE
  5052       NOT INVALID KEY
  5053         READ INDEXADO IGNORE LOCK NEXT
  5054         AT END
  5055            MOVE 1 TO FIN-CONSU-BDIIALE
  5056         END-READ
  5057     END-START.
  5058     PERFORM UNTIL FIN-CONSU-BDIIALE = 1    OR
  5059        TIPIDE-INPUT-BDIIALE <> TIP-ID-IND  OR
  5060        NUMIDE-INPUT-BDIIALE <> NUM-ID-IND
  5061        IF APELLIDO-INPUT-BDIIALE <> SPACES AND
  5062           APELLIDO-IND <> SPACES
  5063           MOVE APELLIDO-IND           TO NOMBOK-INPUT-VALNOM
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  88
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  5064           MOVE APELLIDO-INPUT-BDIIALE TO NOMBRE-INPUT-VALNOM
  5065           MOVE 1                      TO TIP-ID-INPUT-VALNOM
  5066           MOVE 1                      TO BLOQUES-INPUT-VALNOM
  5067           PERFORM 10000-MATCH-NOMBRES-VALNOM
  5068        ELSE
  5069           MOVE 1 TO  MATCH-OK-OUT-VALNOM
  5070        END-IF
  5071        IF MATCH-OK-OUT-VALNOM = 0
  5072           MOVE COD-SUSCRIP-IND TO COD-SUSCRIP-ABD02
  5073           READ SUSCRIPTOR IGNORE LOCK NOT INVALID KEY
  5074              MOVE 1 TO HAY-ALERTA-BDIIALE
  5075              MOVE SPACES TO TEXTO-VARIABLE-BDIIALE
  5076              STRING
  5077                NOM-COR1-ABD02 DELIMITED BY SIZE
  5078                " "            DELIMITED BY SIZE
  5079                NOM-COR2-ABD02 DELIMITED BY SIZE
  5080                APELLIDO-IND   DELIMITED BY SIZE
  5081              INTO TEXTO-VARIABLE-BDIIALE
  5082              PERFORM 3311-ARMAR-TEXTO-BDIIALE
  5083              MOVE "B.D DATACREDITO" TO
  5084                               V-NFU-OUTPUT-BDIIALE(Z-BDIIALE)
  5085              PERFORM 3320-PONER-ALE-OUTPUT-BDIIALE *> PREMATRICULA
  5086           END-READ
  5087        END-IF
  5088        READ INDEXADO IGNORE LOCK NEXT
  5089           AT END
  5090              MOVE 1 TO FIN-CONSU-BDIIALE
  5091        END-READ
  5092     END-PERFORM.
  5093     IF HAY-ALERTA-BDIIALE = 1
  5094        SUBTRACT 1 FROM Z-BDIIALE *> PORQUE SE PREMATRICULARON
  5095     ELSE
  5096        IF DEBUG-BDIIALE = 1
  5097           MOVE "B.D DATACREDITO" TO
  5098                               V-NFU-OUTPUT-BDIIALE(Z-BDIIALE)
  5099           MOVE "BANCO DEL CARIBE             MARTINEZ " TO
  5100                                        TEXTO-VARIABLE-BDIIALE
  5101           PERFORM 3311-ARMAR-TEXTO-BDIIALE
  5102           MOVE 1 TO HAY-ALERTA-BDIIALE
  5103        END-IF
  5104     END-IF.
  5105 3310-ALERTA-0008-BDIIALE.
  5106**********************************************************************
  5107*3310-ALERTA-0008-BDIIALE.
  5108*    CALCULO DE LA ALERTA 0008 SIN ACTIVIDAD COMO TEC. ESTA ALERTA
  5109*    SOLO SE CALCULA PARA EL PRODUCTO PJ (61)  CALCULADA
  5110**********************************************************************
  5111     MOVE "B.D DATACREDITO"    TO V-NFU-OUTPUT-BDIIALE(Z-BDIIALE).
  5112     IF PROD-HC-INPUT-BDIIALE = 61     *> HC PERSONA JURIDICA
  5113        IF TIPIDE-INPUT-BDIIALE = 2
  5114           MOVE 1 TO HAY-ALERTA-BDIIALE
  5115           IF ES-INDEPENDIENTE-INPUT-BDIIALE = 1
  5116              MOVE 00 TO OPCION-ALE-BDIIALE
  5117           ELSE
  5118              MOVE 01 TO OPCION-ALE-BDIIALE
  5119           END-IF
  5120        END-IF
  5121     END-IF.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  89
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  5122     IF DEBUG-BDIIALE = 1
  5123        MOVE 1 TO HAY-ALERTA-BDIIALE
  5124     END-IF.
  5125 3310-ALERTA-0009-BDIIALE.
  5126**********************************************************************
  5127*3310-ALERTA-0009-BDIIALE.
  5128*    CALCULO DE LA ALERTA 0009  MICROCREDITO . SALDO EN HIPOTECARIOS
  5129*    MAYOR A 120 SALARIOS MINIMOS CALCULADA
  5130**********************************************************************
  5131     MOVE "B.D DATACREDITO"    TO V-NFU-OUTPUT-BDIIALE(Z-BDIIALE).
  5132     COMPUTE CAR-SALDO-MICR-BDIIALE = CAR-SALDO-MICR-BDIIALE * 1000.
  5133     IF CAR-SALDO-MICR-BDIIALE >= SMLMV-BDIIALE * 120
  5134        MOVE 1 TO HAY-ALERTA-BDIIALE
  5135     END-IF.
  5136     IF DEBUG-BDIIALE = 1
  5137        MOVE 1 TO HAY-ALERTA-BDIIALE
  5138     END-IF.
  5139 3310-ALERTA-0010-BDIIALE.
  5140*****************************************************************
  5141*3310-ALERTA-0010-BDIIALE.
  5142*    CALCULO DE LA ALERTA 0010 TRES O MAS DIRECCIONES REPORTADAS
  5143*    EN EL ULTIMO AO  CALCULADA
  5144*****************************************************************
  5145     MOVE "B.D DATACREDITO"    TO V-NFU-OUTPUT-BDIIALE(Z-BDIIALE).
  5146     MOVE 1 TO DIR-BDIIALE
  5147     PERFORM UNTIL V-FECFIN-BDLDIR(DIR-BDIIALE) = 0 OR
  5148                                                DIR-BDIIALE > 99
  5149       MOVE V-FECCREFIN-BDLDIR(DIR-BDIIALE) TO FECHA-WR6-BDIIALE
  5150       COMPUTE DIAS-BDIIALE =
  5151        ( SIG-ANO-CURRENT-DATE-BDIIALE * 360  +
  5152          MES-CURRENT-DATE-BDIIALE * 30       ) -
  5153        ( SIG-ANO-WR6-BDIIALE * 360           +
  5154          MES-WR6-BDIIALE * 30                )
  5155       IF DIAS-BDIIALE <= 360
  5156          ADD 1 TO CAR-DIR-NUM-1A-BDIIALE
  5157       END-IF
  5158       ADD 1 TO DIR-BDIIALE
  5159     END-PERFORM.
  5160     IF CAR-DIR-NUM-1A-BDIIALE >= 3
  5161        MOVE 1 TO HAY-ALERTA-BDIIALE
  5162     END-IF.
  5163     IF DEBUG-BDIIALE = 1
  5164        MOVE 1 TO HAY-ALERTA-BDIIALE
  5165     END-IF.
  5166 3310-ALERTA-0011-BDIIALE.
  5167**********************************************************************
  5168*3310-ALERTA-0011-BDIIALE.
  5169*    CALCULO DE LA ALERTA 0011 MORAS DE 60 CALCULADA
  5170**********************************************************************
  5171     MOVE "B.D DATACREDITO"    TO V-NFU-OUTPUT-BDIIALE(Z-BDIIALE).
  5172     IF CAR-M60-MAS-6M-BDIIALE > 0
  5173        MOVE 1 TO HAY-ALERTA-BDIIALE
  5174     END-IF
  5175     IF DEBUG-BDIIALE = 1
  5176        MOVE 1 TO HAY-ALERTA-BDIIALE
  5177     END-IF.
  5178 3310-ALERTA-0012-BDIIALE.
  5179**********************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  90
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  5180*3310-ALERTA-0012-BDIIALE.
  5181*    CALCULO DE LA ALERTA 0012 HUELLAS 60 DIAS CALCULADA
  5182**********************************************************************
  5183     MOVE "B.D DATACREDITO"    TO V-NFU-OUTPUT-BDIIALE(Z-BDIIALE).
  5184     IF CAR-ENT-INQ-2M-BDIIALE > 3
  5185        MOVE 1 TO HAY-ALERTA-BDIIALE
  5186     END-IF.
  5187     IF DEBUG-BDIIALE = 1
  5188        MOVE 1 TO HAY-ALERTA-BDIIALE
  5189     END-IF.
  5190 3310-ALERTA-0013-BDIIALE.
  5191**********************************************************************
  5192*3310-ALERTA-0013-BDIIALE.
  5193*    CALCULO DE LA ALERTA 0013 DEMANDAS JUDICIALES PRECALCULADA
  5194**********************************************************************
  5195     PERFORM 3311-PRECALCULADAS-BDIIALE.
  5196     IF DEBUG-BDIIALE = 1
  5197        IF HAY-ALERTA-BDIIALE = 0
  5198           MOVE "000020000420140315" TO TEXTO-VARIABLE-BDIIALE
  5199           PERFORM 3311-ARMAR-TEXTO-BDIIALE
  5200           MOVE I-BDIIALE TO A-BDIIALE
  5201           PERFORM 3321-LLENAR-CAMPOS-CALC-BDIIALE
  5202           MOVE 1 TO HAY-ALERTA-BDIIALE
  5203        END-IF
  5204     END-IF.
  5205 3310-ALERTA-9999-BDIIALE.
  5206**********************************************************************
  5207*3310-ALERTA-9999-BDIIALE.
  5208*    CALCULO DE LA ALERTA 9999  (ALERTA DEFAULT DE GRUPO)
  5209*    SE BUSCA SI PARA EL GRUPO NO SE GENERO ALGUNA ALERTA.
  5210*    LAS QUE VAYA ENCONTRANDO LAS COLOCA EN EL AREA OUTPUT
  5211**********************************************************************
  5212*    SE RECORRE EL RELACIONAMIENTO ALEGRU PARA DETERMINAR EL GRUPO
  5213     MOVE 1 TO J-BDIIALE.
  5214     PERFORM UNTIL V-ALE-ALEGRU-BDIIALE(J-BDIIALE) = SPACES OR
  5215                                        J-BDIIALE  > 1000
  5216       IF V-ALE-ALEGRU-BDIIALE(J-BDIIALE) =
  5217                               V-ALE-ALERTAS-BDIIALE(I-BDIIALE)
  5218          MOVE 1 TO K-BDIIALE
  5219*         SE RECORRE LOS GRUPOS CONTRATADO PARA VER SI EL BUSCADO
  5220*         TUVO ALGUNA ALERTA ENVIADA
  5221          PERFORM UNTIL V-GRU-GRUCLA-BDIIALE(K-BDIIALE) = SPACES
  5222                                          OR K-BDIIALE > 20
  5223            IF V-GRU-GRUCLA-BDIIALE(K-BDIIALE) =
  5224               V-GRU-ALEGRU-BDIIALE(J-BDIIALE)
  5225               IF V-HUBOALE-GRUCLA-BDIIALE(K-BDIIALE) = 0 OR
  5226                  DEBUG-BDIIALE = 1
  5227                  IF V-HUBOALE-GRUCLA-BDIIALE(K-BDIIALE) = 0
  5228                     MOVE V-ALE-ALERTAS-BDIIALE(I-BDIIALE) TO
  5229                          V-CUALALE-GRUCLA-BDIIALE(K-BDIIALE,1)
  5230                  END-IF
  5231                  MOVE "B.D DATACREDITO" TO
  5232                               V-NFU-OUTPUT-BDIIALE(Z-BDIIALE)
  5233                  PERFORM 3320-PONER-ALE-OUTPUT-BDIIALE
  5234               END-IF
  5235            END-IF
  5236            ADD 1 TO K-BDIIALE
  5237          END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  91
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  5238       END-IF
  5239       ADD 1 TO J-BDIIALE
  5240     END-PERFORM.
  5241 4000-GENERAR-LOG-BDIIALE.
  5242**********************************************************************
  5243*4000-GENERAR-LOG-BDIIALE.
  5244*    SI EL PARAMETRO DE LOG ESTA PRENDIDO SE GRABA UN REGISTRO
  5245*    CON LA INFORMACION DE LOS GRUPOS Y ALERTAS GENERADOS
  5246*    ESTE LOG SE RECICLA CADA DIA
  5247**********************************************************************
  5248     MOVE SPACES TO REG-LOG-BDIIALE.
  5249     MOVE TIPIDE-INPUT-BDIIALE  TO TIPIDE-LOG-BDIIALE
  5250     MOVE NUMIDE-INPUT-BDIIALE  TO NUMIDE-LOG-BDIIALE
  5251     MOVE FUNCTION CURRENT-DATE(1:14) TO FECHA-LOG-BDIIALE (1:14)
  5252     MOVE PROD-HC-INPUT-BDIIALE TO PRODUCTO-LOG-BDIIALE
  5253     MOVE 1 TO W-BDIIALE.
  5254     PERFORM UNTIL W-BDIIALE > 20 OR
  5255                   V-GRU-GRUCLA-BDIIALE(W-BDIIALE) = SPACES
  5256       STRING INF-LOG-BDIIALE DELIMITED BY "    "
  5257          V-GRU-GRUCLA-BDIIALE(W-BDIIALE)  DELIMITED BY SIZE
  5258          V-CUAL-GRUCLA-BDIIALE(W-BDIIALE) DELIMITED BY "    "
  5259          "!"
  5260       INTO INF-LOG-BDIIALE
  5261       ADD 1 TO W-BDIIALE
  5262     END-PERFORM.
  5263     WRITE REG-BDIIALE-PLANO FROM REG-LOG-BDIIALE.
  5264 9000-DEBUG-TABLAS-BDIIALE.
  5265**********************************************************************
  5266*9000-DEBUG-TABLAS-BDIIALE.
  5267*    RUTINA PARA REALIZAR DEBUG DE LAS ESTRUCTURAS UTILIZADAS EN EL
  5268*    MANEJO DE LAS ALERTAS. SE HABILITA CON EL FLAG DEBUG-BDIIALE = 1
  5269**********************************************************************
  5270     DISPLAY "================[ PRODUCTOS SUSCRIPTOR]============"
  5271     DISPLAY PRODUC-INPUT-BDIIALE
  5272     DISPLAY "==================================================="
  5273     DISPLAY "===================[ GRUPOS DEFAULT   ]============"
  5274     DISPLAY M-GRU-DEFAULT-BDIIALE
  5275     DISPLAY "==================================================="
  5276     DISPLAY "===================[ GRUPOS A PROCESAR]============"
  5277     DISPLAY M-GRU-GRUCLA-BDIIALE
  5278     DISPLAY "==================================================="
  5279     DISPLAY "===================[ TABLA DE ALERTAS ]============"
  5280     MOVE 1 TO I-BDIIALE
  5281     PERFORM UNTIL V-ALE-ALERTAS-BDIIALE(I-BDIIALE) = SPACES OR
  5282                                         I-BDIIALE > 1000
  5283       DISPLAY V-ALE-ALERTAS-BDIIALE(I-BDIIALE)  ";"
  5284               V-TIP-ALERTAS-BDIIALE(I-BDIIALE)  ";"
  5285               V-OPC-ALERTAS-BDIIALE(I-BDIIALE)  ";"
  5286               V-ESG-ALERTAS-BDIIALE(I-BDIIALE)  ";"
  5287               V-FUE-ALERTAS-BDIIALE(I-BDIIALE)  ";"
  5288               V-NOM-ALERTAS-BDIIALE(I-BDIIALE)  ";"
  5289               V-FLAG-ALERTAS-BDIIALE(I-BDIIALE) ";"
  5290       ADD 1 TO I-BDIIALE
  5291     END-PERFORM.
  5292     DISPLAY "==================================================="
  5293     DISPLAY "===================[ TABLA DE GRUPOS  ]============"
  5294     MOVE 1 TO I-BDIIALE
  5295     PERFORM UNTIL V-GRU-GRUPOS-BDIIALE(I-BDIIALE) = SPACES OR
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  92
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  5296                                        I-BDIIALE > 20
  5297       DISPLAY V-GRU-GRUPOS-BDIIALE(I-BDIIALE)  ";"
  5298               V-NOM-GRUPOS-BDIIALE(I-BDIIALE)  ";"
  5299               V-COB-GRUPOS-BDIIALE(I-BDIIALE)  ";"
  5300               V-PRO-GRUPOS-BDIIALE(I-BDIIALE)  ";"
  5301       ADD 1 TO I-BDIIALE
  5302     END-PERFORM.
  5303     DISPLAY "==================================================="
  5304     DISPLAY "===================[ TABLA DE RELACION]============"
  5305     MOVE 1 TO I-BDIIALE
  5306     PERFORM UNTIL V-ALE-ALEGRU-BDIIALE(I-BDIIALE) = SPACES OR
  5307                                        I-BDIIALE > 1000
  5308       DISPLAY V-ALE-ALEGRU-BDIIALE(I-BDIIALE)  ";"
  5309               V-GRU-ALEGRU-BDIIALE(I-BDIIALE)  ";"
  5310               V-APUALE-ALEGRU-BDIIALE(I-BDIIALE)  ";"
  5311       ADD 1 TO I-BDIIALE
  5312     END-PERFORM.
  5313     DISPLAY "==================================================="
  5314     DISPLAY "=========[GRUPOS CONTRATADOS ALERTADOS]============"
  5315     MOVE 1 TO I-BDIIALE
  5316     PERFORM UNTIL V-GRU-GRUCLA-BDIIALE(I-BDIIALE) = SPACES OR
  5317                                        I-BDIIALE > 20
  5318       DISPLAY V-GRU-GRUCLA-BDIIALE(I-BDIIALE)      ";"
  5319               V-PRO-GRUCLA-BDIIALE(I-BDIIALE)      ";"
  5320               V-COB-GRUCLA-BDIIALE(I-BDIIALE)      ";"
  5321               V-HUBOALE-GRUCLA-BDIIALE(I-BDIIALE)  ";"
  5322               V-CUAL-GRUCLA-BDIIALE(I-BDIIALE)     ";"
  5323       ADD 1 TO I-BDIIALE
  5324     END-PERFORM.
  5325     DISPLAY "==================================================="
  5326     DISPLAY "===================[ ALERTAS ENVIADAS ]============"
  5327     MOVE 1 TO I-BDIIALE
  5328     PERFORM UNTIL V-ALE-OUTPUT-BDIIALE(I-BDIIALE) = SPACES OR
  5329                                        I-BDIIALE > 100
  5330       DISPLAY V-ALE-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5331               V-FUE-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5332               V-NFU-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5333               V-FEC-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5334               V-FVN-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5335               V-FMD-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5336               V-DE1-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5337               V-DE2-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5338               V-HOS-OUTPUT-BDIIALE(I-BDIIALE)      ";"
  5339       ADD 1 TO I-BDIIALE
  5340     END-PERFORM.
  5341     DISPLAY "==================================================="
  5342     .
  5343 9100-SIMULAR-ALERTA-BDIIALE.
  5344**********************************************************************
  5345*9100-SIMULAR-ALERTA-BDIIALE.
  5346*    PARA EL CASO DE DEBUG SE GENERA SIEMPRE LA ALERTA LLENANDO TODOS
  5347*    LOS CAMPOS PERTINENTES
  5348**********************************************************************
  5349     IF DEBUG-BDIIALE = 1
  5350        IF HAY-ALERTA-BDIIALE = 0
  5351           MOVE SPACES TO TEXTO-VARIABLE-BDIIALE
  5352           PERFORM 3311-ARMAR-TEXTO-BDIIALE
  5353           MOVE I-BDIIALE TO A-BDIIALE
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  93
* ))))ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDIIALED
  5354           PERFORM 3321-LLENAR-CAMPOS-CALC-BDIIALE
  5355           MOVE 1 TO HAY-ALERTA-BDIIALE
  5356        END-IF
  5357     END-IF.
* 5358 COPY LEEMAESTROS.PROC.
  5359* LEEMAESTROS.PROC.v.0004
  5360* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
  5361* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
  5362* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
  5363******************************************************************
  5364* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
  5365* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
  5366* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*
  5367*           * GISTRO                                             *
  5368*           * NOV048 SE RECALCULA LA NOVEDAD EN 24 SI ASI LO SOLI*
  5369*           *        CITA EL PROGRAMA, EL DEFAULT ES 48
  5370******************************************************************
  5371* GJC0003   * BBVA01 SE INCLUYE LOGICA QUE BLOQUEA LAS CUETAS DE *
  5372* G. JIMENEZ*        BBVA SI EL SW DE ELIMINAR ESTA EN 1. ESTO   *
  5373* AGOST/2009*        TANTO PARA CUENTAS CORRIENTES COMO PARA     *
  5374*           *        CARTERA                                     *
  5375******************************************************************
  5376* GJC0004   * NEWBL1 PARA CUENTA SIN VALIDAR SE INCLUYE EL TIPO  *
  5377* G. JIMENEZ*        DE BLOQUEO 7 Y 8                            *
  5378* OCTUB/2011*        TANTO PARA CUENTAS CORRIENTES COMO PARA     *
  5379*           *        EL MAESTRO DE CARTERA                       *
  5380******************************************************************
  5381$SET CONSTANT HACERMATCH"NO"
  5382$SET CONSTANT AMNISTIA21"NO"
  5383
  5384$IF HACERMATCH = "SI"
  5385$DISPLAY "........COMPILANDO LEEMAESTROS CON MATCH **********
  5386$ELSE
  5387$DISPLAY "........COMPILANDO LEEMAESTROS SIN MATCH **********
  5388$END
  5389
  5390$IF AMNISTIA21 = "SI"
  5391$DISPLAY "........COMPILANDO LEEMAESTROS CON AMNISTIA *******
  5392$ELSE
  5393$DISPLAY "...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
  5394$END
  5395
* 5396 COPY BDAMATCH.PROC.
  5398* BDAMATCH.PROC.v.0005
  5399******************************************************************
  5400* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
  5401* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
  5402* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
  5403* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
  5404* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
  5405********************************************************************
  5406* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA      *
  5407* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
  5408* R.MARTINEZ  *          10 POSICIONES DE LAS MISMA.             *
  5409******************************************************************
  5410* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
  5411* R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
  5412*             *        MEJOR PORTAFOLIO
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  94
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5413* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
  5414*             *                  NUM-CTAS-OUTPUT-BDAMATCH
  5415*             *SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
  5416*             *        BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
  5417*             *        DE FRENADAS
  5418*****************************************************************
  5419* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
  5420* R-MARTINEZ. *          DEL PORTAFOLIO .                       *
  5421* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
  5422*             * BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV       *
  5423*             * FUEN01 - NCLUIR  FUENTES EXTERNAS               *
  5424*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH       *
  5425*             * LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7      *
  5426*             * NOMB01 - MAQUILLAR EL NOMBRE                    *
  5427*             * VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
  5428*             *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
  5429*****************************************************************
  5430* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
  5431* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
  5432* 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
  5433*             *          DECUENTA DE LA MISMA CUENTA            *
  5434*****************************************************************
  5435
  5436 1000-U-RECORRER-CSV-BDAMATCH.
  5437******************************************************************
  5438*1000-U-RECORRER-CSV-BDAMATCH.
  5439* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
  5440* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
  5441* MATCH
  5442******************************************************************
  5443     MOVE 0 TO IDE-TIPO-BDAMATCH
  5444     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .                     RMB0003
  5445     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                         RMB0003
  5446     MOVE 0 TO MAX-CUENTAS-BDAMATCH.
  5447     IF ABIERTO-BDAMATCH  = 0
  5448        OPEN INPUT  BDACSV
  5449        MOVE 1 TO ABIERTO-BDAMATCH
  5450     END-IF.
  5451     INITIALIZE LLAVE-BDACSV.
  5452     MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .
  5453     MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .
  5454     MOVE 0 TO FIN-BDAMATCH .
  5455     MOVE 0 TO PROCESAR-BDAMATCH .
  5456     START BDACSV  KEY > LLAVE-BDACSV
  5457           INVALID KEY
  5458              MOVE 1 TO FIN-BDAMATCH
  5459           NOT INVALID KEY
  5460              READ BDACSV IGNORE LOCK NEXT RECORD
  5461                 AT END
  5462                    MOVE 1 TO FIN-BDAMATCH
  5463              END-READ
  5464     END-START.
  5465     PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =
  5466                                      NUM-IDE-INPUT-BDAMATCH  OR
  5467                                      TIPO-ID-BDACSV  NOT =
  5468                                      TIP-IDE-INPUT-BDAMATCH
  5469        MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02
  5470        READ SUSCRIPTOR IGNORE LOCK
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  95
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5471           INVALID KEY
  5472              MOVE 0 TO PROCESAR-BDAMATCH
  5473           NOT INVALID KEY
  5474              MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004
  5475        END-READ
  5476        IF PROCESAR-BDAMATCH = 1                                  RMB0004
  5477           IF ESTADO-ABD02 = 1                                    RMB0004
  5478              IF IND-BLOQUEO-BDACSV <> "B"                        RMB0004
  5479                 MOVE 1 TO PROCESAR-BDAMATCH                      RMB0004
  5480                 IF FUENTE-REG-BDACSV <= 01                       RMB0004
  5481                    PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCH       RMB0004
  5482                 ELSE                                             RMB0004
  5483                    PERFORM 1100-LLENAR-AUX-BDAMATCH              RMB0004
  5484                 END-IF                                           RMB0004
  5485              ELSE                                                RMB0004
  5486                 MOVE 0 TO PROCESAR-BDAMATCH                      RMB0004
  5487              END-IF                                              RMB0004
  5488           ELSE                                                   RMB0004
  5489              MOVE 0 TO PROCESAR-BDAMATCH                         RMB0004
  5490           END-IF                                                 RMB0004
  5491        END-IF                                                    RMB0004
  5492        IF PROCESAR-BDAMATCH = 1
  5493           PERFORM 1200-PROC-REG-CSV-BDAMATCH
  5494        END-IF
  5495        READ BDACSV IGNORE LOCK   NEXT RECORD
  5496        AT END
  5497           MOVE 1 TO FIN-BDAMATCH
  5498        END-READ
  5499        IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004
  5500           MOVE 1 TO FIN-BDAMATCH               *> SE ABLIGA A TIPRMB0004
  5501           MOVE 0 TO MAX-CUENTAS-BDAMATCH       *> EFICIENCIA Y   RMB0004
  5502           MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
  5503        END-IF                                                    RMB0004
  5504     END-PERFORM.
  5505     IF MAX-CUENTAS-BDAMATCH > 0
  5506        IF APELLIDO-INPUT-BDAMATCH <> SPACES AND                  RMB0004
  5507           MAX-CUENTAS-BDAMATCH > 1                               RMB0004
  5508           PERFORM 1100-LLENAR-CSV-APE-BDAMATCH                   RMB0004
  5509           PERFORM 1100-LLENAR-AUX-BDAMATCH                       RMB0004
  5510           PERFORM 1200-PROC-REG-CSV-BDAMATCH                     RMB0004
  5511        END-IF                                                    RMB0004
  5512        PERFORM 9000-U-REALIZAR-BDAMATCH
  5513        IF NOM-OUTPUT-BDAMATCH <> SPACES AND                      RMB0004
  5514           (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)                      RMB0004
  5515           MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQ              RMB0004
  5516           PERFORM 1100-MAQUILLAR-NOMBRE-MAQ                      RMB0004
  5517           MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCH           RMB0004
  5518        END-IF                                                    RMB0004
  5519        IF NOM-OUTPUT-BDAMATCH <> SPACES
  5520           MOVE 1 TO IDE-TIPO-BDAMATCH
  5521        END-IF
  5522     END-IF.
  5523 1100-MAQUILLAR-NOMBRE-MAQ.                                       RMB0004
  5524     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
  5525     MOVE 0 TO I-MAQ                                              RMB0004
  5526     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004
  5527             INITIAL "Y/O"                                        RMB0004
  5528             OR      "Y\O"                                        RMB0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  96
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5529             OR      " Y/OTRO "                                   RMB0004
  5530             OR      " Y/OTRA "                                   RMB0004
  5531             OR      " Y\OTRO "                                   RMB0004
  5532             OR      " Y\OTRA "                                   RMB0004
  5533             OR      " Y OTRO "                                   RMB0004
  5534             OR      " Y OTRA "                                   RMB0004
  5535     IF I-MAQ < 45 AND I-MAQ > 2                                  RMB0004
  5536        ADD 1 TO I-MAQ                                            RMB0004
  5537        MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)                      RMB0004
  5538     ELSE                                                         RMB0004
  5539        IF I-MAQ < 45                                             RMB0004
  5540           ADD 1 TO I-MAQ                                         RMB0004
  5541           MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)                  RMB0004
  5542        END-IF                                                    RMB0004
  5543     END-IF                                                       RMB0004
  5544     MOVE 0 TO SW-BORRAR-MAQ                                      RMB0004
  5545     MOVE 1 TO I-MAQ.                                             RMB0004
  5546     PERFORM UNTIL I-MAQ > 45                                     RMB0004
  5547       MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ                  RMB0004
  5548       IF TILDE-MAQ                                               RMB0004
  5549          PERFORM 1000-CAMBIAR-TILDE-MAQ                          RMB0004
  5550          MOVE ACTUAL-MAQ TO NOMBRE-INPMAQ(I-MAQ:1)               RMB0004
  5551       END-IF                                                     RMB0004
  5552       IF FUNCTION ORD(ACTUAL-MAQ) < 31                           RMB0004
  5553          MOVE "." TO ACTUAL-MAQ                                  RMB0004
  5554       END-IF                                                     RMB0004
  5555       MOVE " " TO ANT-MAQ                                        RMB0004
  5556       IF I-MAQ > 1                                               RMB0004
  5557          COMPUTE J-MAQ = I-MAQ - 1                               RMB0004
  5558          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO ANT-MAQ                  RMB0004
  5559       END-IF                                                     RMB0004
  5560       MOVE " " TO SIG-MAQ                                        RMB0004
  5561       IF I-MAQ < 45                                              RMB0004
  5562          COMPUTE J-MAQ = I-MAQ + 1                               RMB0004
  5563          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO SIG-MAQ                  RMB0004
  5564       END-IF                                                     RMB0004
  5565       IF ACTUAL-MAQ = ")"                                        RMB0004
  5566          MOVE 0 TO SW-BORRAR-MAQ                                 RMB0004
  5567       END-IF                                                     RMB0004
  5568       IF SW-BORRAR-MAQ = 0                                       RMB0004
  5569          IF ELIMINAR-MAQ                                         RMB0004
  5570             MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                  RMB0004
  5571             IF I-MAQ > 1                                         RMB0004
  5572                MOVE 1 TO SW-BORRAR-MAQ                           RMB0004
  5573             END-IF                                               RMB0004
  5574          ELSE                                                    RMB0004
  5575             IF BORRAR-MAQ                                        RMB0004
  5576                MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)               RMB0004
  5577             ELSE                                                 RMB0004
  5578                IF QUITAR-MAQ                                     RMB0004
  5579                   COMPUTE J-MAQ = I-MAQ + 1                      RMB0004
  5580                   MOVE NOMBRE-INPMAQ(J-MAQ:) TO                  RMB0004
  5581                        NOMBRE-INPMAQ(I-MAQ:)                     RMB0004
  5582                   COMPUTE I-MAQ = I-MAQ - 1                      RMB0004
  5583                ELSE                                              RMB0004
  5584                   IF VALIDO-MAQ                                  RMB0004
  5585                      CONTINUE                                    RMB0004
  5586                   ELSE                                           RMB0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  97
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5587                      IF ANT-MAQ = "N" AND SIG-VOCAL-MAQ          RMB0004
  5588                         COMPUTE J-MAQ = I-MAQ + 1                RMB0004
  5589                         MOVE NOMBRE-INPMAQ(J-MAQ:) TO            RMB0004
  5590                              NOMBRE-INPMAQ(I-MAQ:)               RMB0004
  5591                         COMPUTE I-MAQ = I-MAQ - 1                RMB0004
  5592                      ELSE                                        RMB0004
  5593                         IF (ANT-VOCAL-MAQ AND SIG-VOCAL-MAQ) OR  RMB0004
  5594                            (ANT-VOCAL-MAQ AND SIG-MAQ = "N")     RMB0004
  5595                            IF (ANT-VOCAL-MAQ AND SIG-MAQ = "N")  RMB0004
  5596                               COMPUTE J-MAQ = I-MAQ + 1          RMB0004
  5597                               MOVE NOMBRE-INPMAQ(J-MAQ:) TO      RMB0004
  5598                                    NOMBRE-INPMAQ(I-MAQ:)         RMB0004
  5599                            ELSE                                  RMB0004
  5600                               MOVE "N" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5601                            END-IF                                RMB0004
  5602                         ELSE                                     RMB0004
  5603                            IF NOT ANT-VOCAL-MAQ AND              RMB0004
  5604                                   SIG-VOCAL-MAQ                  RMB0004
  5605                               MOVE "I" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5606                            ELSE                                  RMB0004
  5607                               MOVE " " TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5608                            END-IF                                RMB0004
  5609                         END-IF                                   RMB0004
  5610                      END-IF                                      RMB0004
  5611                   END-IF                                         RMB0004
  5612                END-IF                                            RMB0004
  5613             END-IF                                               RMB0004
  5614          END-IF                                                  RMB0004
  5615       ELSE                                                       RMB0004
  5616          MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                     RMB0004
  5617       END-IF                                                     RMB0004
  5618       ADD 1 TO I-MAQ                                             RMB0004
  5619     END-PERFORM.                                                 RMB0004
  5620     INITIALIZE PARTICULAS-INPMAQ                                 RMB0004
  5621     UNSTRING NOMBRE-INPMAQ-X DELIMITED BY ALL " "                RMB0004
  5622       INTO BASURA-INPMAQ P1-INPMAQ P2-INPMAQ P3-INPMAQ P4-INPMAQ RMB0004
  5623            P5-INPMAQ P6-INPMAQ P7-INPMAQ P8-INPMAQ P9-INPMAQ     RMB0004
  5624            P10-INPMAQ                                            RMB0004
  5625     MOVE SPACES TO NOMBRE-OUTMAQ-OK                              RMB0004
  5626     STRING P1-INPMAQ DELIMITED BY " "                            RMB0004
  5627            " " DELIMITED BY SIZE                                 RMB0004
  5628            P2-INPMAQ DELIMITED BY " "                            RMB0004
  5629            " " DELIMITED BY SIZE                                 RMB0004
  5630            P3-INPMAQ DELIMITED BY " "                            RMB0004
  5631            " " DELIMITED BY SIZE                                 RMB0004
  5632            P4-INPMAQ DELIMITED BY " "                            RMB0004
  5633            " " DELIMITED BY SIZE                                 RMB0004
  5634            P5-INPMAQ DELIMITED BY " "                            RMB0004
  5635            " " DELIMITED BY SIZE                                 RMB0004
  5636            P6-INPMAQ DELIMITED BY " "                            RMB0004
  5637            " " DELIMITED BY SIZE                                 RMB0004
  5638            P7-INPMAQ DELIMITED BY " "                            RMB0004
  5639            " " DELIMITED BY SIZE                                 RMB0004
  5640            P8-INPMAQ DELIMITED BY " "                            RMB0004
  5641            " " DELIMITED BY SIZE                                 RMB0004
  5642            P9-INPMAQ DELIMITED BY " "                            RMB0004
  5643            " " DELIMITED BY SIZE                                 RMB0004
  5644            P10-INPMAQ DELIMITED BY " "                           RMB0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  98
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5645            " " DELIMITED BY SIZE                                 RMB0004
  5646       INTO NOMBRE-OUTMAQ-OK.                                     RMB0004
  5647       INSPECT NOMBRE-OUTMAQ-OK                                   RMB0004
  5648         REPLACING ALL  " PE A " BY " PENA ".                     RMB0004
  5649  1000-CAMBIAR-TILDE-MAQ.                                         RMB0004
  5650       EVALUATE ACTUAL-MAQ                                        RMB0004
  5651          WHEN ""                                                RMB0004
  5652            MOVE "A" TO ACTUAL-MAQ                                RMB0004
  5653          WHEN ""                                                RMB0004
  5654            MOVE "E" TO ACTUAL-MAQ                                RMB0004
  5655          WHEN ""                                                RMB0004
  5656            MOVE "I" TO ACTUAL-MAQ                                RMB0004
  5657          WHEN ""                                                RMB0004
  5658            MOVE "O" TO ACTUAL-MAQ                                RMB0004
  5659          WHEN ""                                                RMB0004
  5660            MOVE "U" TO ACTUAL-MAQ                                RMB0004
  5661          WHEN ""                                                RMB0004
  5662            MOVE "A" TO ACTUAL-MAQ                                RMB0004
  5663          WHEN ""                                                RMB0004
  5664            MOVE "E" TO ACTUAL-MAQ                                RMB0004
  5665          WHEN ""                                                RMB0004
  5666            MOVE "I" TO ACTUAL-MAQ                                RMB0004
  5667          WHEN ""                                                RMB0004
  5668            MOVE "O" TO ACTUAL-MAQ                                RMB0004
  5669          WHEN ""                                                RMB0004
  5670            MOVE "U" TO ACTUAL-MAQ                                RMB0004
  5671        END-EVALUATE.                                             RMB0004
  5672 1100-LLENAR-CSV-APE-BDAMATCH.                                    RMB0004
  5673     INITIALIZE REG-BDACSV                                        RMB0004
  5674     MOVE TIP-IDE-INPUT-BDAMATCH TO  TIPO-ID-BDACSV               RMB0004
  5675     MOVE NUM-IDE-INPUT-BDAMATCH TO  NUM-ID-BDACSV                RMB0004
  5676     MOVE 980001         TO  COD-SUS-BDACSV COD-SUSCRIP-ABD02     RMB0004
  5677     MOVE 02             TO  COD-CTA-BDACSV                       RMB0004
  5678     MOVE "APELLID-01"   TO  NUM-CTA-BDACSV                       RMB0004
  5679     MOVE APELLIDO-INPUT-BDAMATCH TO  NOMBRE-BDACSV               RMB0004
  5680     MOVE ".-,"                   TO  NOMBRE-BDACSV(43:3)         RMB0004
  5681     MOVE 20110801       TO  FECHA-CREA-BDACSV                    RMB0004
  5682     MOVE 0              TO  NUM-PORTAF-BDACSV                    RMB0004
  5683     MOVE 0              TO  IND-NOMBRE-BDACSV                    RMB0004
  5684     MOVE 0              TO  MEJOR-PORTAF-BDACSV                  RMB0004
  5685     MOVE 0              TO  IND-ACTUALIZ-BDACSV                  RMB0004
  5686     MOVE 01             TO  FUENTE-REG-BDACSV.                   RMB0004
  5687 1100-LLENAR-AUX-BDAMATCH.                                        RMB0004
  5688***********************************************************************
  5689*1100-LLENAR-AUX-BDAMATCH.
  5690* SE LLENAN LOS CAMPOS DEL CSV EN AREAS AUXILIARES DE CONVERSION DE
  5691* TAMAO
  5692***********************************************************************
  5693     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .          RMB0004
  5694     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .          RMB0004
  5695     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .          RMB0004
  5696     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .          RMB0004
  5697     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .          RMB0004
  5698     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .          RMB0004
  5699     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .          RMB0004
  5700     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .          RMB0004
  5701     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .          RMB0004
  5702     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .          RMB0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page  99
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5703     MOVE 0 TO FALLECIDO-BDAMATCH.                                RMB0004
  5704 1100-UBICAR-CHKCRE-CSV-BDAMATCH.
  5705***********************************************************************
  5706*1100-UBICAR-CHKCRE-CSV-BDAMATCH.
  5707* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN
  5708* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH
  5709***********************************************************************
  5710     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .
  5711     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .
  5712     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .
  5713     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .
  5714     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .
  5715     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .
  5716     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .
  5717     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .
  5718     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .
  5719     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .
  5720     MOVE 0 TO FALLECIDO-BDAMATCH                                 RMB0003
  5721     IF COD-CTA-BDACSV = 01 OR 51
  5722        MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECK
  5723        READ MAESTRO-CHECK IGNORE LOCK INVALID KEY
  5724             MOVE 0 TO PROCESAR-BDAMATCH
  5725        NOT INVALID KEY                                           RMB0003
  5726            IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)                  RMB0004
  5727                AND CONSECUTIVO-ABD06 = 1
  5728               IF ADJETIVO-ABD06 = 1                              RMB0003
  5729                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003
  5730               END-IF                                             RMB0003
  5731            ELSE                                                  RMB0003
  5732               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003
  5733            END-IF                                                RMB0003
  5734        END-READ
  5735     ELSE
  5736        MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDIT
  5737        READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY
  5738             MOVE 0 TO PROCESAR-BDAMATCH
  5739        NOT INVALID KEY                                           RMB0003
  5740            IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)                  RMB0004
  5741               AND CONSECUTIVO-ABD07 = 1
  5742               IF ADJETIVO1-ABD07 = 1 OR                          RMB0003
  5743                  ADJETIVO2-ABD07 = 1 OR                          RMB0003
  5744                  ADJETIVO3-ABD07 = 1                             RMB0003
  5745                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003
  5746               END-IF                                             RMB0003
  5747            ELSE                                                  RMB0003
  5748               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003
  5749            END-IF                                                RMB0003
  5750        END-READ
  5751     END-IF.
  5752
  5753 1200-PROC-REG-CSV-BDAMATCH.
  5754***********************************************************************
  5755*1200-PROC-REG-CSV-BDAMATCH.
  5756* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
  5757* SI LO HAY
  5758***********************************************************************
  5759     IF MAX-CUENTAS-BDAMATCH = 0
  5760        PERFORM 1000-U-INICIALIZAR-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 100
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5761     END-IF.
  5762     MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.
  5763     MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLM
  5764     PERFORM 2000-U-INSERTAR-CTA-BDAMATCH.
  5765     MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.
  5766     PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.
  5767     MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.
  5768     READ MAESTRO-DIRECC IGNORE LOCK
  5769*         NOT INVALID KEY                                         RMB0004
  5770*             PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                 RMB0004
  5771          INVALID KEY                                             RMB0004
  5772              MOVE SPACES TO LLAVE-DIRECC                         RMB0004
  5773     END-READ.
  5774     IF LLAVE-DIRECC <> SPACES                                    RMB0004
  5775        PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                       RMB0004
  5776     END-IF.                                                      RMB0004
  5777
  5778 1210-DIRTEL-BDACSV-BDAMATCH.
  5779***********************************************************************
  5780*1210-DIRTEL-BDACSV-BDAMATCH.
  5781* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
  5782* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
  5783***********************************************************************
  5784     IF CIURES-DIRECC NOT = SPACES
  5785        IF DIRRES-DIRECC NOT = SPACES
  5786           MOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCH
  5787           PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5788        END-IF
  5789        IF TELRES-DIRECC > 0 AND
  5790           TELRES-DIRECC < 9999999999
  5791           MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCH
  5792           PERFORM 2000-U-INSERTAR-TEL-BDAMATCH
  5793        END-IF
  5794     END-IF.
  5795     IF CIULAB-DIRECC NOT = SPACES
  5796        IF DIRLAB-DIRECC NOT = SPACES
  5797           MOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCH
  5798           PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5799        END-IF
  5800        IF TELLAB-DIRECC > 0 AND
  5801           TELLAB-DIRECC < 9999999999
  5802           MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCH
  5803           PERFORM 2000-U-INSERTAR-TEL-BDAMATCH
  5804        END-IF
  5805     END-IF.
  5806     IF CIUCOR-DIRECC NOT = SPACES AND
  5807        DIRCOR-DIRECC NOT = SPACES
  5808        MOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCH
  5809        PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5810     END-IF.
  5811
  5812 8000-U-VER-CTAABD07-BDAMATCH.
  5813***********************************************************************
  5814*8000-U-VER-CTAABD07-BDAMATCH.
  5815*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
  5816*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
  5817*  DE BLOQUEO A 0
  5818***********************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 101
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5819     IF IDE-TIPO-BDAMATCH = 1
  5820        MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCH
  5821        PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH
  5822        IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9
  5823           MOVE 0 TO IND-BLOQUEO-ABD07
  5824        END-IF
  5825     END-IF.
  5826
  5827 8000-U-VER-CTAABD06-BDAMATCH.
  5828***********************************************************************
  5829*8000-U-VER-CTAABD06-BDAMATCH.
  5830*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
  5831*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
  5832*  DE BLOQUEO A 0
  5833***********************************************************************
  5834     IF IDE-TIPO-BDAMATCH = 1
  5835        MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCH
  5836        PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH
  5837        IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9
  5838           MOVE 0 TO IND-BLOQUEO-ABD06
  5839        END-IF
  5840     END-IF.
  5841
  5842*======================================================================
  5843 1000-U-INICIALIZAR-BDAMATCH.
  5844********************************************************************
  5845*1000-U-INICIALIZAR-BDAMATCH.
  5846* INPUT = VACIO
  5847* OUTPUT= VACIO
  5848* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION
  5849* DEl MATCH.
  5850********************************************************************
  5851     MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.
  5852     MOVE 0 TO I-CTA-BDAMATCH.
  5853     INITIALIZE TABLA-CUENTAS-BDAMATCH.                           RMB0004
  5854     INITIALIZE TABLA-DIR-BDAMATCH.
  5855     INITIALIZE TABLA-TEL-BDAMATCH.
  5856     INITIALIZE TABLA-NOM-BDAMATCH.
  5857     INITIALIZE TABLA-GRUNOM-BDAMATCH.
  5858     INITIALIZE V-INTERRELAC-BDAMATCH.
  5859     MOVE ZEROS   TO POSIC-SUSC-BDAMATCH
  5860                      POSIC-SUS-GRU-BDAMATCH
  5861     MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH
  5862     MOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.
  5863
  5864 2000-U-INSERTAR-DIR-BDAMATCH.
  5865********************************************************************
  5866*2000-U-INSERTAR-DIR-BDAMATCH.
  5867* INPUT = DIR-INPUT-BDAMATCH
  5868* OUTPUT= VACIO
  5869* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
  5870* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
  5871* LA DIRECCION CONTENGA ALGUN NUMERO
  5872********************************************************************
  5873     MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.
  5874     MOVE 1 TO I-BDAMATCH
  5875     MOVE 0 TO J-BDAMATCH
  5876     MOVE " " TO CAR-ANT-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 102
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5877     INITIALIZE T-CARTOT-BDAMATCH
  5878     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10            CAV0002
  5879       IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERIC
  5880          MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCH
  5881          IF CAR-ANT-BDAMATCH   NUMERIC
  5882             COMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)
  5883                     = V-CARTOT-BDAMATCH  (J-BDAMATCH)
  5884                     * 10 + CAR-ACT-BDAMATCH
  5885          ELSE
  5886             ADD 1 TO J-BDAMATCH
  5887             MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)
  5888                  TO V-CARTOT-BDAMATCH  (J-BDAMATCH)
  5889          END-IF
  5890       END-IF
  5891       MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCH
  5892       ADD 1 TO I-BDAMATCH
  5893     END-PERFORM.
  5894     SORT V-CARTOT-BDAMATCH   DESCENDING.
  5895     IF T-CARTOT-BDAMATCH   NOT = ZEROS AND
  5896        I-DIR-BDAMATCH < LIM-BDAMATCH
  5897        MOVE T-CARTOT-BDAMATCH TO
  5898             NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5899        MOVE SUSC-CTAS-BDAMATCH TO
  5900             SUS-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5901        MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5902        PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1
  5903                 UNTIL  POSIC-SUMA-BDAMATCH  >  10 OR
  5904                 V-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZERO
  5905           ADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)
  5906        END-PERFORM
  5907        ADD 1 TO I-DIR-BDAMATCH
  5908     END-IF.
  5909
  5910 2000-U-INSERTAR-TEL-BDAMATCH.
  5911********************************************************************
  5912*2000-U-INSERTAR-TEL-BDAMATCH.
  5913* INPUT = TEL-INPUT-BDAMATCH
  5914* OUTPUT= VACIO
  5915* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO
  5916* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
  5917********************************************************************
  5918     IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0
  5919        MOVE TEL-INPUT-BDAMATCH TO
  5920                                NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5921        MOVE SUSC-CTAS-BDAMATCH TO
  5922                                SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5923        MOVE I-CTA-BDAMATCH     TO
  5924                                CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5925        ADD 1 TO I-TEL-BDAMATCH
  5926     END-IF.
  5927
  5928 2000-U-INSERTAR-NOM-BDAMATCH.
  5929********************************************************************
  5930*2000-U-INSERTAR-NOM-BDAMATCH.
  5931* INPUT = NOM-INPUT-BDAMATCH
  5932* OUTPUT= VACIO
  5933* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE
  5934* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 103
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5935********************************************************************
  5936     IF I-NOM-BDAMATCH < LIM-BDAMATCH AND
  5937        NOM-INPUT-BDAMATCH <> SPACES
  5938        MOVE NOM-INPUT-BDAMATCH  TO
  5939             NOM-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5940                                   NOM-LIMPI-BDAMATCH
  5941        MOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5942        MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCH
  5943                            NRO-VECES-2-BDAMATCH
  5944        PERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1
  5945          UNTIL  NRO-VECES-1-BDAMATCH  >  60
  5946          IF NRO-VECES-1-BDAMATCH  >  1 AND
  5947           NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "
  5948             SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCH
  5949          END-IF
  5950          IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "
  5951            COMPUTE  NRO-VECES-2-BDAMATCH =
  5952                     60 - NRO-VECES-1-BDAMATCH
  5953            MOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +
  5954                  1:NRO-VECES-2-BDAMATCH)
  5955                TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)
  5956            IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +
  5957               1:NRO-VECES-2-BDAMATCH) = SPACES
  5958               MOVE  85           TO  NRO-VECES-1-BDAMATCH
  5959            END-IF
  5960          END-IF
  5961        END-PERFORM
  5962        INSPECT NOM-LIMPI-BDAMATCH
  5963                TALLYING       PESO-CTAS-TOT-BDAMATCH
  5964                FOR CHARACTERS BEFORE INITIAL " "
  5965        MOVE  PESO-CTAS-TOT-BDAMATCH TO
  5966              LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5967        IF FUENTE-REG-BDACSV >= 02                                RMB0004
  5968           MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)            RMB0004
  5969        END-IF                                                    RMB0004
  5970        MOVE  SUSC-CTAS-BDAMATCH TO
  5971              SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5972        ADD 1 TO I-NOM-BDAMATCH
  5973     END-IF.
  5974
  5975 2000-U-INSERTAR-CTA-BDAMATCH.
  5976********************************************************************
  5977*2000-U-INSERTAR-CTA-BDAMATCH.
  5978* INPUT = CTA-INPUT-BDAMATCH
  5979* OUTPUT= VACIO
  5980* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA
  5981* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
  5982********************************************************************
  5983     IF I-CTA-BDAMATCH < LIM-BDAMATCH AND
  5984        CTA-INPUT-BDAMATCH <> SPACES
  5985        ADD 1 TO I-CTA-BDAMATCH
  5986        MOVE CTA-INPUT-BDAMATCH TO
  5987             CTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)
  5988        MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
  5989        MOVE FALLECIDO-BDAMATCH TO                                RMB0003
  5990             CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)               RMB0003
  5991        IF FUENTE-REG-BDACSV >= 2                                 RMB0004
  5992           MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)      RMB0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 104
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  5993        END-IF                                                    RMB0004
  5994     END-IF.
  5995 3000-U-ORDENAR-DIR-BDAMATCH.
  5996********************************************************************
  5997*3000-U-ORDENAR-DIR-BDAMATCH.
  5998* INPUT = TABLA DE DIRECCIONES LLENA
  5999* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
  6000* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
  6001* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6002********************************************************************
  6003     SORT T-DIR-BDAMATCH
  6004          DESCENDING NUM-DIR-BDAMATCH
  6005          ASCENDING  CTA-DIR-BDAMATCH.
  6006     MOVE 1 TO I-CTA-BDAMATCH.
  6007     MOVE 0 TO FIL-FUE-BDAMATCH
  6008     MOVE 1 TO COL-FUE-BDAMATCH
  6009     MOVE 999                TO CTA-DIR-ANT-BDAMATCH
  6010     MOVE ALL "9"            TO NUM-DIR-ANT-BDAMATCH
  6011     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR
  6012                         CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0
  6013       IF NUM-DIR-ANT-BDAMATCH <>
  6014                                 NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)
  6015          ADD  1 TO FIL-FUE-BDAMATCH
  6016          MOVE 1 TO COL-FUE-BDAMATCH
  6017          MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  6018               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6019          MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6020          ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)
  6021          MOVE  I-CTA-BDAMATCH       TO  POSIC-SUMA-BDAMATCH
  6022          ADD 1 TO COL-FUE-BDAMATCH
  6023       ELSE
  6024          IF CTA-DIR-ANT-BDAMATCH <>
  6025             CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)
  6026             MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  6027               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6028             MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6029             ADD 1 TO COL-FUE-BDAMATCH
  6030          END-IF
  6031            ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)
  6032       END-IF
  6033       MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  6034                                          CTA-DIR-ANT-BDAMATCH
  6035       MOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  6036                                           NUM-DIR-ANT-BDAMATCH
  6037       ADD 1 TO I-CTA-BDAMATCH
  6038     END-PERFORM.
  6039     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6040
  6041 3000-U-ORDENAR-TEL-BDAMATCH.
  6042********************************************************************
  6043*3000-U-ORDENAR-TEL-BDAMATCH.
  6044* INPUT = TABLA DE TELEFONOS   LLENA
  6045* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS
  6046* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON
  6047* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6048********************************************************************
  6049     SORT T-TEL-BDAMATCH
  6050          DESCENDING NUM-TEL-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 105
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6051          ASCENDING  CTA-TEL-BDAMATCH .
  6052     MOVE 1 TO I-CTA-BDAMATCH.
  6053     MOVE 1 TO COL-FUE-BDAMATCH
  6054     MOVE 999      TO CTA-TEL-ANT-BDAMATCH
  6055     MOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCH
  6056     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH
  6057             OR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0
  6058             OR  FIL-FUE-BDAMATCH > LIM-BDAMATCH
  6059             OR  COL-FUE-BDAMATCH > LIM-BDAMATCH
  6060       IF NUM-TEL-ANT-BDAMATCH <>
  6061          NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6062          ADD  1 TO FIL-FUE-BDAMATCH
  6063          MOVE 1 TO COL-FUE-BDAMATCH
  6064          MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6065               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6066          MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6067          ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6068          MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCH
  6069          ADD 1 TO COL-FUE-BDAMATCH
  6070       ELSE
  6071          IF CTA-TEL-ANT-BDAMATCH <>
  6072             CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6073             MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6074                 CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6075             MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6076             ADD 1 TO COL-FUE-BDAMATCH
  6077          END-IF
  6078            ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)
  6079       END-IF
  6080       MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6081                                           CTA-TEL-ANT-BDAMATCH
  6082       MOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6083                                           NUM-TEL-ANT-BDAMATCH
  6084       ADD 1 TO I-CTA-BDAMATCH
  6085     END-PERFORM.
  6086     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6087
  6088 3000-U-ORDENAR-NOM-BDAMATCH.
  6089********************************************************************
  6090*3000-U-ORDENAR-NOM-BDAMATCH.
  6091* INPUT = TABLA DE NOMBRES     LLENA
  6092* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES
  6093* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
  6094* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6095********************************************************************
  6096     SORT T-NOM-BDAMATCH
  6097          DESCENDING NOM-NOM-BDAMATCH
  6098          DESCENDING LNG-NOM-BDAMATCH
  6099          ASCENDING  CTA-NOM-BDAMATCH .
  6100     MOVE 1 TO I-NOM-BDAMATCH.
  6101     MOVE 1 TO GRU-NOM-BDAMATCH.
  6102     MOVE GRU-NOM-BDAMATCH TO
  6103          GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).
  6104     MOVE GRU-NOM-BDAMATCH TO
  6105          GRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).
  6106     MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6107          NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).
  6108     MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 106
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6109          SUSC-GRUP-SUS-BDAMATCH
  6110     MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TO
  6111          SUSC-GRUP-GRU-BDAMATCH
  6112     PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6113     IF  INV-BDAMATCH  =  1
  6114       ADD   1        TO
  6115       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6116     END-IF
  6117     MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6118          LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6119     ADD 1 TO I-NOM-BDAMATCH.
  6120     PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCH
  6121             OR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0
  6122       MOVE 1 TO I-GRU-BDAMATCH
  6123       MOVE 0 TO MATCH-OK-OUT-VALNOM
  6124       PERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =
  6125               SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCH
  6126               OR MATCH-OK-OUT-VALNOM = 1
  6127         MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6128              NOMBRE-INPUT-VALNOM
  6129         MOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TO
  6130              NOMBOK-INPUT-VALNOM
  6131         IF  TIP-IDE-INPUT-BDAMATCH = 2 OR 3                      RMB0004
  6132            IF NUM-IDE-INPUT-BDAMATCH >= 600000000 AND            RMB0004
  6133               NUM-IDE-INPUT-BDAMATCH <= 999999999                RMB0004
  6134               MOVE 2 TO TIP-ID-INPUT-VALNOM                      RMB0004
  6135               MOVE 1 TO BLOQUES-INPUT-VALNOM                     RMB0004
  6136            ELSE                                                  RMB0004
  6137               MOVE 1 TO TIP-ID-INPUT-VALNOM                      RMB0004
  6138               MOVE 2 TO BLOQUES-INPUT-VALNOM                     RMB0004
  6139            END-IF                                                RMB0004
  6140         ELSE                                                     RMB0004
  6141            MOVE 1 TO TIP-ID-INPUT-VALNOM                         RMB0004
  6142            MOVE 2 TO BLOQUES-INPUT-VALNOM                        RMB0004
  6143         END-IF                                                   RMB0004
  6144         IF NOMBRE-INPUT-VALNOM(43:3) = ".-," OR                  RMB0004
  6145            NOMBOK-INPUT-VALNOM(43:3) = ".-,"                     RMB0004
  6146            MOVE 1 TO BLOQUES-INPUT-VALNOM                        RMB0004
  6147         END-IF                                                   RMB0004
  6148         PERFORM 10000-MATCH-NOMBRES-VALNOM
  6149         IF MATCH-OK-OUT-VALNOM = 1
  6150            MOVE I-GRU-BDAMATCH TO
  6151                 GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)
  6152            MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  6153                                 TO  SUSC-GRUP-SUS-BDAMATCH
  6154            MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6155                                 TO  SUSC-GRUP-GRU-BDAMATCH
  6156            IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDO       RMB0004
  6157               MOVE 1 TO APE-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)    RMB0004
  6158            END-IF                                                RMB0004
  6159            PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6160            IF  INV-BDAMATCH  =  1
  6161              ADD   1  TO
  6162       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6163            END-IF
  6164            IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >
  6165                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6166              MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 107
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6167                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6168              MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO            RMB0004
  6169                NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)             RMB0004
  6170            END-IF
  6171         END-IF
  6172         ADD 1 TO I-GRU-BDAMATCH
  6173       END-PERFORM
  6174       IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPO
  6175          ADD 1 TO GRU-NOM-BDAMATCH
  6176          MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6177               NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6178          MOVE GRU-NOM-BDAMATCH  TO
  6179               GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)
  6180          MOVE GRU-NOM-BDAMATCH  TO
  6181               GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLM
  6182          MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  6183                             TO  SUSC-GRUP-SUS-BDAMATCH
  6184          MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6185                             TO  SUSC-GRUP-GRU-BDAMATCH
  6186          PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6187          IF  INV-BDAMATCH  =  1
  6188            ADD   1   TO
  6189       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6190          END-IF
  6191          MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6192               LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6193       ELSE                                                    *>
  6194          MOVE GRU-NOM-BDAMATCH TO
  6195               GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLM
  6196       END-IF
  6197       ADD 1 TO I-NOM-BDAMATCH
  6198     END-PERFORM.
  6199     SORT T-NOM-BDAMATCH
  6200          DESCENDING NOM-NOM-BDAMATCH
  6201          DESCENDING GRU-NOMS-BDAMATCH
  6202          DESCENDING LNG-NOM-BDAMATCH
  6203          ASCENDING  CTA-NOM-BDAMATCH .
  6204     MOVE 1 TO I-CTA-BDAMATCH.
  6205     MOVE 1 TO COL-FUE-BDAMATCH
  6206     MOVE 999                TO CTA-NOM-ANT-BDAMATCH
  6207     MOVE ALL "9"            TO GRU-NOM-ANT-BDAMATCH
  6208     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH
  6209             OR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0
  6210             OR FIL-FUE-BDAMATCH > LIM-BDAMATCH
  6211             OR COL-FUE-BDAMATCH > LIM-BDAMATCH
  6212       IF GRU-NOM-ANT-BDAMATCH <>
  6213          GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)
  6214          ADD  1 TO FIL-FUE-BDAMATCH
  6215          MOVE 1 TO COL-FUE-BDAMATCH
  6216          MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6217               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6218          MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6219          ADD 1 TO COL-FUE-BDAMATCH
  6220       ELSE
  6221          IF CTA-NOM-ANT-BDAMATCH <>
  6222             CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)
  6223             MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6224                  CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 108
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6225             MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6226             ADD 1 TO COL-FUE-BDAMATCH
  6227          END-IF
  6228       END-IF
  6229       MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6230            CTA-NOM-ANT-BDAMATCH
  6231       MOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TO
  6232            GRU-NOM-ANT-BDAMATCH
  6233       ADD 1 TO I-CTA-BDAMATCH
  6234     END-PERFORM.
  6235     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6236
  6237 4000-U-INTERELACIONAR-BDAMATCH.
  6238********************************************************************
  6239*4000-U-INTERELACIONAR-BDAMATCH.
  6240* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS
  6241* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS
  6242* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
  6243* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6244********************************************************************
  6245*    PERFORM 1110-MOSTRAR-MATRIZ1                                 RMB0004
  6246     MOVE 1 TO MOVIDO-BDAMATCH    .
  6247     PERFORM UNTIL MOVIDO-BDAMATCH = 0
  6248        MOVE 0 TO MOVIDO-BDAMATCH
  6249        MOVE 1 TO FIL-BUS-BDAMATCH
  6250        PERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCH
  6251          MOVE 1 TO COL-BUS-BDAMATCH
  6252          PERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCH
  6253            IF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)
  6254               > 0
  6255            MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)
  6256                 TO BUSCADO-BDAMATCH
  6257               PERFORM 4100-BUSCAR-RELACION-BDAMATCH
  6258            ELSE
  6259               MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCH
  6260            END-IF
  6261            ADD 1 TO COL-BUS-BDAMATCH
  6262          END-PERFORM
  6263          ADD 1 TO FIL-BUS-BDAMATCH
  6264        END-PERFORM
  6265     END-PERFORM.
  6266
  6267 4100-BUSCAR-RELACION-BDAMATCH.
  6268********************************************************************
  6269*4100-BUSCAR-RELACION-BDAMATCH.
  6270* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
  6271********************************************************************
  6272     MOVE 1 TO FIL-FUE-BDAMATCH.
  6273     PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH
  6274        IF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCH
  6275           MOVE 0 TO EXISTE-BDAMATCH
  6276           INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6277              TALLYING EXISTE-BDAMATCH
  6278              FOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCH
  6279            ADD 1 TO EXISTE-BDAMATCH
  6280            IF EXISTE-BDAMATCH <= 2000
  6281                PERFORM 4110-MOVER-RELACIONES-BDAMATCH
  6282           END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 109
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6283        END-IF
  6284        ADD 1 TO FIL-FUE-BDAMATCH
  6285     END-PERFORM.
  6286
  6287 4110-MOVER-RELACIONES-BDAMATCH.
  6288********************************************************************
  6289*4110-MOVER-RELACIONES-BDAMATCH.
  6290* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
  6291* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
  6292********************************************************************
  6293       MOVE 0 TO FIN-FUENTE-BDAMATCH.
  6294       INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6295               TALLYING FIN-FUENTE-BDAMATCH
  6296               FOR CHARACTERS BEFORE INITIAL "000 "
  6297       COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4
  6298       MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.
  6299       INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)
  6300               TALLYING LIBRE-BUSCADO-BDAMATCH
  6301               FOR CHARACTERS BEFORE INITIAL "000 "
  6302       COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4
  6303       ADD 1 TO LIBRE-BUSCADO-BDAMATCH.
  6304       MOVE 1 TO COL-FUE-BDAMATCH.
  6305       PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCH
  6306          MOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TO
  6307                         PORINSERTAR-BDAMATCH
  6308          MOVE 0 TO EXISTE-BDAMATCH
  6309          INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)
  6310               TALLYING EXISTE-BDAMATCH
  6311              FOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCH
  6312          ADD 1 TO EXISTE-BDAMATCH
  6313          IF EXISTE-BDAMATCH > 2000
  6314            MOVE PORINSERTAR-BDAMATCH TO
  6315            CAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)
  6316            ADD 1 TO LIBRE-BUSCADO-BDAMATCH
  6317            MOVE 1 TO MOVIDO-BDAMATCH
  6318          END-IF
  6319          ADD 1 TO COL-FUE-BDAMATCH
  6320       END-PERFORM.
  6321       INITIALIZE
  6322            FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR
  6323
  6324 5000-U-MEJOR-PORTAFOL-BDAMATCH.
  6325********************************************************************
  6326*5000-U-MEJOR-PORTAFOL-BDAMATCH.
  6327* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL
  6328* PORTAFOLIO QUE TIENE MAS CUENTAS
  6329********************************************************************
  6330      MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.
  6331      MOVE 0 TO MAXREL-PER-BDAMATCH
  6332      MOVE 0 TO FIN-FUENTE-BDAMATCH.
  6333      MOVE 1 TO FIL-FUE-BDAMATCH.
  6334      MOVE 0 TO  PESOS-CTRL-BDAMATCH
  6335      PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH
  6336        INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6337               TALLYING FIN-FUENTE-BDAMATCH
  6338               FOR CHARACTERS BEFORE INITIAL "000 "
  6339        COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH    / 4
  6340        MOVE 0 TO PESO-CTAS-TOT-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 110
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6341        MOVE 1 TO POSIC-SUMA-BDAMATCH
  6342        MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH                   RMB0004
  6343        MOVE 0 TO  POSIC-SUSC-BDAMATCH                            RMB0004
  6344        MOVE 0 TO ENT-FIN-PORT-BDAMATCH                           RMB0004
  6345        MOVE 0 TO ENT-UNICAS-PORT-BDAMATCH                        RMB0004
  6346        PERFORM  VARYING  NRO-VECES-1-BDAMATCH  FROM  1  BY  1
  6347           UNTIL  NRO-VECES-1-BDAMATCH  >  FIN-FUENTE-BDAMATCH
  6348           MOVE
  6349        FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)(POSIC-SUMA-BDAMATCH:3)
  6350                TO  CTA-A-BUSCAR-BDAMATCH
  6351           IF CTA-A-BUSCAR-BDAMATCH > 0                           RMB0004
  6352            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(13:6)RMB0004
  6353                 TO SUSC-CTAS-BDAMATCH                            RMB0004
  6354            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(19:2)RMB0005
  6355                 TO I2-BDAMATCH                                   RMB0005
  6356            PERFORM 5100-CALCULAR-PESO-DIR-BDAMATCH               RMB0004
  6357            PERFORM 5200-CALCULAR-PESO-TEL-BDAMATCH               RMB0004
  6358            PERFORM 5300-CALCULAR-PESO-CTA-BDAMATCH               RMB0004
  6359           END-IF                                                 RMB0004
  6360           ADD 4 TO  POSIC-SUMA-BDAMATCH
  6361        END-PERFORM
  6362        PERFORM 5400-DEDUCIR-MEJ-PORT-BDAMATCH                    RMB0004
  6363        ADD 1 TO FIL-FUE-BDAMATCH
  6364      END-PERFORM.
  6365 5100-CALCULAR-PESO-DIR-BDAMATCH.                                 RMB0004
  6366     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1       RMB0004
  6367        UNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH OR           RMB0004
  6368        CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROS           RMB0004
  6369        IF CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH)                 RMB0004
  6370                                     =  CTA-A-BUSCAR-BDAMATCH     RMB0004
  6371          COMPUTE PESO-CTAS-TOT-BDAMATCH  =                       RMB0004
  6372                   PESO-CTAS-TOT-BDAMATCH +                       RMB0004
  6373          (NUM-CTAS-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) *          RMB0004
  6374                  PESO-DIR-BDAMATCH )                             RMB0004
  6375        END-IF                                                    RMB0004
  6376     END-PERFORM.                                                 RMB0004
  6377 5200-CALCULAR-PESO-TEL-BDAMATCH.                                 RMB0004
  6378     PERFORM VARYING NRO-VECES-2-BDAMATCH FROM 1 BY 1             RMB0004
  6379        UNTIL NRO-VECES-2-BDAMATCH > LIM-BDAMATCH OR              RMB0004
  6380        CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) = ZEROS            RMB0004
  6381        IF  CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH)                RMB0004
  6382                                      =  CTA-A-BUSCAR-BDAMATCH    RMB0004
  6383          COMPUTE  PESO-CTAS-TOT-BDAMATCH  =                      RMB0004
  6384             PESO-CTAS-TOT-BDAMATCH +                             RMB0004
  6385           (NUM-CTAS-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) *         RMB0004
  6386             PESO-TEL-BDAMATCH )                                  RMB0004
  6387        END-IF                                                    RMB0004
  6388     END-PERFORM.                                                 RMB0004
  6389 5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004
  6390******************************************************************
  6391*5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004
  6392* SE BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y SE CUENTAN SOLO
  6393* LAS ENTIDADES UNICAS Y LAS FINANCIERAS
  6394******************************************************************
  6395     SET IND-DIR-BDAMATCH TO 1.                                   RMB0004
  6396     SEARCH ALL REG-SUSC-DIR-BDAMATCH AT END                      RMB0004
  6397         MOVE 1 TO  INV-BDAMATCH                                  RMB0004
  6398       WHEN COD-SUSC-DIR-BDAMATCH(IND-DIR-BDAMATCH) =             RMB0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 111
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6399            SUSC-CTAS-BDAMATCH                                    RMB0004
  6400         MOVE 0 TO  INV-BDAMATCH                                  RMB0004
  6401     END-SEARCH.                                                  RMB0004
  6402     IF INV-BDAMATCH  =  1                                        RMB0004
  6403        AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCH                  RMB0004
  6404        COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004
  6405                                       + PESO-NOM-BDAMATCH        RMB0004
  6406        ADD   1                TO  POSIC-SUSC-BDAMATCH            RMB0004
  6407        MOVE SUSC-CTAS-BDAMATCH  TO                               RMB0004
  6408             COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)           RMB0004
  6409*       MOVE  SUSC-CTAS-BDAMATCH(1:2)  TO I2-BDAMATCH             RMB0005
  6410        IF I2-BDAMATCH > 0 AND I2-BDAMATCH <= 100                 RMB0005
  6411           IF V-TIPCTA-BDAMATCH(I2-BDAMATCH) = 1 OR 2             RMB0005
  6412              ADD 1 TO ENT-FIN-PORT-BDAMATCH                      RMB0005
  6413           END-IF                                                 RMB0005
  6414        END-IF                                                    RMB0005
  6415        ADD 1 TO ENT-UNICAS-PORT-BDAMATCH                         RMB0004
  6416     END-IF.                                                      RMB0004
  6417     IF FUEEXT-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH) = 1        RMB0004
  6418        ADD 1000 TO PESO-CTAS-TOT-BDAMATCH                        RMB0004
  6419     END-IF.                                                      RMB0004
  6420 5400-DEDUCIR-MEJ-PORT-BDAMATCH.                                  RMB0004
  6421     IF FIN-FUENTE-BDAMATCH > MAXREL-PER-BDAMATCH                 RMB0004
  6422        MOVE  FIN-FUENTE-BDAMATCH  TO  MAXREL-PER-BDAMATCH        RMB0004
  6423     END-IF                                                       RMB0004
  6424     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCH            RMB0004
  6425        MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004
  6426        MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004
  6427        MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH   RMB0004
  6428     ELSE                                                         RMB0004
  6429        IF PESO-CTAS-TOT-BDAMATCH  =  PESOS-CTRL-BDAMATCH         RMB0004
  6430           PERFORM 5410-DESEMPATAR-BDAMATCH                       RMB0004
  6431        END-IF                                                    RMB0004
  6432     END-IF.                                                      RMB0004
  6433 5410-DESEMPATAR-BDAMATCH.                                        RMB0004
  6434      IF ENT-FIN-PORT-BDAMATCH > ENT-FIN-MEJ-PORT-BDAMATCH        RMB0004
  6435         MOVE PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004
  6436         MOVE FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004
  6437         MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH  RMB0004
  6438      ELSE                                                        RMB0004
  6439         IF ENT-FIN-PORT-BDAMATCH = ENT-FIN-MEJ-PORT-BDAMATCH     RMB0004
  6440            IF APE-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) = 1 AND      RMB0004
  6441               NOM-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH)(43:3) <>     RMB0004
  6442                                                             ".-,"RMB0004
  6443               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
  6444               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
  6445               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004
  6446                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
  6447            ELSE                                                  RMB0004
  6448              IF LNG-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) >          RMB0004
  6449                 LNG-GRUNOM-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH)   RMB0004
  6450               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
  6451               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
  6452               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004
  6453                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
  6454            END-IF                                                RMB0004
  6455         END-IF                                                   RMB0004
  6456      END-IF.                                                     RMB0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 112
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6457 5000-U-VALIDAR-CUENTA-BDAMATCH.
  6458*********************************************************************
  6459*5000-U-VALIDAR-CUENTA-BDAMATCH.
  6460* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO
  6461* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH
  6462*********************************************************************
  6463     MOVE 0 TO VALCTA-OUTPUT-BDAMATCH
  6464     MOVE 1 TO I-BDAMATCH.
  6465     IF MEJOR-PORTAFOLIO-BDAMATCH > 0
  6466        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR
  6467          VALCTA-OUTPUT-BDAMATCH = 1 OR
  6468          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0
  6469          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)
  6470               TO J-BDAMATCH
  6471          IF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCH
  6472             MOVE 1 TO VALCTA-OUTPUT-BDAMATCH
  6473          END-IF
  6474          ADD 1 TO I-BDAMATCH
  6475        END-PERFORM
  6476     END-IF.
  6477*
  6478 6000-U-MEJOR-DIR-BDAMATCH.
  6479*********************************************************************
  6480*6000-U-MEJOR-DIR-BDAMATCH.
  6481*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION
  6482*********************************************************************
  6483     SORT T-DIR-BDAMATCH
  6484          DESCENDING  NUM-CTAS-DIR-BDAMATCH
  6485          DESCENDING       LNG-DIR-BDAMATCH
  6486          DESCENDING       NUM-DIR-BDAMATCH
  6487          DESCENDING       CTA-DIR-BDAMATCH.
  6488    MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.
  6489
  6490 6000-U-MEJOR-TEL-BDAMATCH.
  6491*********************************************************************
  6492*6000-U-MEJOR-TEL-BDAMATCH.
  6493*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO
  6494*********************************************************************
  6495     SORT T-TEL-BDAMATCH
  6496          DESCENDING  NUM-CTAS-TEL-BDAMATCH
  6497          DESCENDING       NUM-TEL-BDAMATCH
  6498          DESCENDING       CTA-TEL-BDAMATCH.
  6499    MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.
  6500*
  6501 6000-U-MEJOR-NOM-BDAMATCH.
  6502*********************************************************************
  6503*6000-U-MEJOR-NOM-BDAMATCH.
  6504*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE
  6505*********************************************************************
  6506     SORT T-GRUNOM-BDAMATCH
  6507          DESCENDING  NUM-CTAS-GRUNOM-BDAMATCH
  6508          DESCENDING  LNG-GRUNOM-BDAMATCH
  6509          DESCENDING  NOM-GRUNOM-BDAMATCH.
  6510     MOVE  ZEROS TO  ESTA-CTA-BDAMATCH.
  6511     PERFORM VARYING NRO-VECES-3-BDAMATCH  FROM  1 BY  1
  6512       UNTIL NRO-VECES-3-BDAMATCH  >  LIM-BDAMATCH
  6513          OR GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =  ZEROS
  6514          OR ESTA-CTA-BDAMATCH  =  1
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 113
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6515      PERFORM VARYING NRO-VECES-2-BDAMATCH  FROM  1 BY  1
  6516       UNTIL NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH
  6517          OR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROS
  6518          OR ESTA-CTA-BDAMATCH  =  1
  6519        IF  GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =
  6520            GRU-NOMS-BDAMATCH (NRO-VECES-2-BDAMATCH)
  6521         PERFORM VARYING NRO-VECES-1-BDAMATCH  FROM  1 BY  1
  6522          UNTIL NRO-VECES-1-BDAMATCH  >  LIM-BDAMATCH
  6523           OR CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
  6524              NRO-VECES-1-BDAMATCH) = 0
  6525           OR ESTA-CTA-BDAMATCH  =  1
  6526           IF  CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =
  6527               CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
  6528                             NRO-VECES-1-BDAMATCH)
  6529             MOVE GRU-NOMS-BDAMATCH(NRO-VECES-2-BDAMATCH) TO
  6530                  POSIC-SUS-GRU-BDAMATCH
  6531             MOVE NOM-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH) TO
  6532                  NOM-OUTPUT-BDAMATCH
  6533             MOVE 1 TO  ESTA-CTA-BDAMATCH
  6534           END-IF
  6535         END-PERFORM
  6536        END-IF
  6537      END-PERFORM
  6538     END-PERFORM.
  6539*
  6540 9000-U-REALIZAR-BDAMATCH.
  6541******************************************************************
  6542*9000-U-REALIZAR-BDAMATCH.
  6543* HACE EL LLAMADO DE LAS RUTINAS PARA ENCONTRAR DINALMENTE EL
  6544* MEJOR NOMBRE
  6545******************************************************************
  6546     MOVE  ZEROS                 TO  POSIC-SUSC-BDAMATCH
  6547     MOVE  ALL "9"               TO  TABLA-SUSC-DIR-BDAMATCH
  6548     PERFORM 3000-U-ORDENAR-DIR-BDAMATCH
  6549     PERFORM 3000-U-ORDENAR-TEL-BDAMATCH
  6550     PERFORM 3000-U-ORDENAR-NOM-BDAMATCH
  6551     PERFORM 4000-U-INTERELACIONAR-BDAMATCH
  6552     PERFORM 6000-U-MEJOR-DIR-BDAMATCH.
  6553     PERFORM 6000-U-MEJOR-TEL-BDAMATCH.
  6554     PERFORM 5000-U-MEJOR-PORTAFOL-BDAMATCH.
  6555     PERFORM 6000-U-MEJOR-NOM-BDAMATCH.
  6556*
  6557 9010-U-VER-FALLECIDO-BDAMATCH.
  6558*********************************************************************
  6559*9010-U-VER-FALLECIDO-BDAMATCH.
  6560* SE EXAMINAN TODAS LAS CUENTAS DEL MEJOR PORTAFOLIO, SE CUENTAN EL
  6561* NUMERO TOTAL DE CUENTAS Y DE CUENTAS CON FALLECIDO.
  6562*********************************************************************
  6563     MOVE 1 TO I-BDAMATCH.                                        RMB0003
  6564     IF MEJOR-PORTAFOLIO-BDAMATCH > 0                             RMB0003
  6565        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR                RMB0003
  6566          VALCTA-OUTPUT-BDAMATCH = 1 OR                           RMB0003
  6567          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003
  6568          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003
  6569               TO J-BDAMATCH                                      RMB0003
  6570          ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCH                       RMB0003
  6571          IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1               RMB0003
  6572             ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCH                 RMB0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 114
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDAMATCH
  6573          END-IF                                                  RMB0003
  6574          ADD 1 TO I-BDAMATCH                                     RMB0003
  6575        END-PERFORM                                               RMB0003
  6576     END-IF.                                                      RMB0003
  6577*                                                                 RMB0003
  6578 400-BUSCAR-SUSC-GRUPO-BDAMATCH.
  6579******************************************************************
  6580*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
  6581* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
  6582******************************************************************
  6583     SET IND-NOM-BDAMATCH TO 1.
  6584     SEARCH ALL REG-SUSC-NOM-BDAMATCH AT END
  6585         MOVE 1 TO  INV-BDAMATCH
  6586         WHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =
  6587              SUSC-GRUPO-BDAMATCH
  6588         MOVE 0 TO  INV-BDAMATCH
  6589     END-SEARCH.
  6590     IF  INV-BDAMATCH = 1
  6591     AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCH
  6592       ADD 1 TO  POSIC-SUS-GRU-BDAMATCH
  6593       MOVE SUSC-GRUP-SUS-BDAMATCH TO
  6594            COD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)
  6595       MOVE SUSC-GRUP-GRU-BDAMATCH TO
  6596            GRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)
  6597     END-IF.
* 6598 COPY AMNISTIA21.PROC.
  6599*AMNISTIA21.PROC.v.0013
  6600* OJO CAMBIO PARA QUE APLIQUE CON 2n y no 2n+1 y solo hasta que
  6601* FISICAMENTE SE HAYA RECIBIDO LA INFORMACIN
  6602****************************************************************
  6603
  6604* 21/01/2009
  6605******************************************************************
  6606*  Interpretacin tcnica de la Aplicacin la ley de habeas data
  6607*  para Datacredito segn la discusin del documento
  6608*  "Amnista - temas por definir" y la aplicacin de las
  6609*  definiciones dadas.
  6610*
  6611*  La aplicacin de la amnista a cuentas para un individuo
  6612*  se otorgar solo bajo las siguiente condiciones:
  6613*
  6614*  Para cualquier fecha de consulta al individuo despus de
  6615*  la aprobacin o vigencia de la ley
  6616*
  6617* -> S el individuo est al da en todas sus obligaciones
  6618*   (sin importar fecha de actualizacin)
  6619*
  6620* ->      S el individuo tiene cuentas canceladas que hayan
  6621*    tenido mora y llevan un ao o ms de cancelacin
  6622*
  6623* -> S la fecha de la consulta est dentro del
  6624*    periodo de gracia
  6625*
  6626*    = Se deben amnistiar dichas cuentas canceladas
  6627*
  6628* -> S la fecha de la consulta es posterior al
  6629*    periodo de gracia
  6630*
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 115
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  6631*    -> S no existe ninguna mora despus del
  6632*       periodo de gracia
  6633*
  6634*       = Se deben amnistiar dichas cuentas canceladas
  6635******************************************************************
  6636*  Colorarios:
  6637*
  6638* - Solo se amnistan las cuentas canceladas que tuvieron mora
  6639*
  6640* - El derecho a la amnista de obligaciones se pierde si incurre
  6641*   en mora el individuo despus del periodo de gracia
  6642*
  6643* - Solo se tiene el derecho a la amnista de cuentas si el
  6644*   individuo est con todas sus obligaciones al da
  6645*
  6646******************************************************************
  6647* DLM0002    | HISTOR - PERMITIR EJECUCION HISTORICA DE LA AMNIS-*
  6648* 29-JUL-2008|    TIA. LA VARIABLE WS-FECHA-HISTORICA DESDE EL   *
  6649* DARIO LASSO|    PROGRAMA DEBE COLOCARSE CON LA FECHA DESEADA.  *
  6650*            | AJUST1 - AJUSTES A LAS RUTINA DE CALCULO DE AMNIS-*
  6651*            |          TIA CON 48 POSICIONES                    *
  6652******************************************************************
  6653* CAV0003    | MORVEC - NO ASUMIR EL ESTADO DEL VECTOR PARA EL   *
  6654* 19-DIC-2008|    MES EN QUE SE HACE LA CONSULTA. SE CAMBIA LA   *
  6655* C. VELASCO |    CONDICION DE PRIMERA MORA DEL VECTOR DE MENOR  *
  6656*            |    A 12 MESES PARA NO AMNISTIAR A MENOR IGUAL A 12*
  6657******************************************************************
  6658* GJC0004    | LEY002 - POR SOLICITUD DE JURIDICO SE DEBE APLICAR*
  6659* 21-ENE-2009|    AMNISTIA A CARTERAS RECUPERADAS Y CANCELADAS   *
  6660* G. JIMENEZ |    POR MAL MANEJO AUNQUE NO TENGAN MORA MAXIMA >  *
  6661*            |    QUE 0. O VECTOR SIN HISTORIA                   *
  6662******************************************************************
  6663* GJC0005    | LEY003 - SE DEJA EL PERDON DE LAS CARTERAS RECUPE-*
  6664* 19-MAR-2009|    RADAS Y CANCELADAS POR MAL MANEJO CON IGUAL    *
  6665* G. JIMENEZ |    MANEJO QUE CUALQUIER OTRA CUENTA QUE HAYA TENI-*
  6666*            |    DO MORA.                                       *
  6667******************************************************************
  6668* GJC0006    | LEY004 - APLICACION DE ARTICULO 13 DE LA LEY 1266 *
  6669* 28-ENE-2009|    CORRESPONDIENTE A LA APLICACION DE CADUCIDADES *
  6670* G. JIMENEZ |    EN UN TIEMPO CORRESPONDIENTE AL DOBLE DE LA    *
  6671*            |    MORA                                           *
  6672******************************************************************
  6673* GJC0007    | LEY005 - AJUSTE A RECALCULO DE NOVEDAD PARA QUE SI*
  6674* 05-JUN-2009|    HAY CARTERA RECUPERADA O CANCELADA POR MAL MANE*
  6675* G. JIMENEZ |    JO SIN MORAS SOLO SE PERDONE EL ESTADO SI LA   *
  6676*            |    CUENTA TUVO PERDON DE OTRA FORMA NO            *
  6677******************************************************************
  6678* GJC0008    | LEY006 - AJUSTE PARA QUE CUANDO EN EL MES QUE SE  *
  6679* 09-JUN-2009|   CUMPLE EL TIEMPO DEL PERDON HAY MORA PARA LA    *
  6680* G. JIMENEZ |   IDENTIFICACION Y HAY QUE HACER DESPLAZAMIENTO SE*
  6681*            |   APLIQUE EL PERDON ADECUADAMENTE                 *
  6682*            |   SE TOMA LA FECHA DEL CURRENT DATE POR CADA TRAN-*
  6683*            |   SACCION QUE ENTRA A LA RUTINA
  6684******************************************************************
  6685* GJC0009    | LEY007 - SE CAMBIA LA APLICACION DE ARTICULO 13 DE*
  6686* 26-JUN-2009|   POR PERSONA A POR CUENTA                        *
  6687* G. JIMENEZ |                                                   *
  6688******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 116
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  6689* GJC0010    | BBVA01 - SE CREA LOGICA PARA QUE EN LA REVISION DE*
  6690* AGOSTO-2009|   LA AMNISTIA CUANDO SE MIRA AL CLIENTE SE ELIMINE*
  6691* G. JIMENEZ |   LA REVISION DE CUENTAS DEL BBVA                 *
  6692******************************************************************
  6693* GJC0011    | DBLMOR - SE CONTEMPLA EL CASO EN QUE EL TIEMPO EN *
  6694* AGOSTO-2011|   MORA HAYA SIDO MAYOR DE 24 MESES Y EL DOBLE DE  *
  6695* G. JIMENEZ |   ESTAS MORAS SIEMPRE DEBE SER 48                 *
  6696*            | PRSCRP - CUANDO UNA CUENTA TIENE PRESCIPCION NO SE*
  6697*            |   PUEDE APLICAR ARTCULO 21 PORQUE FINALMENTE NO  *
  6698*            |   PAGO Y SIEMPRE SE APLICA ARTICULO 13 A MENOS QUE*
  6699*            |   EL VECTOR SOLO TENGA MORAS DE 120 Y CEROS       *
  6700******************************************************************
  6701* GJC0012    | CADUC1 - SE HACEN LOS CAMBIOS NECESARIOS PARA     *
  6702* G. JIMENEZ |          HACER CADUCIDAD SOBRE EL VECTOR ANTES DE *
  6703* 23-ENE-2009|          INICIAR APLICACION DE ARTICULO 13        *
  6704*            | ESTA48 - SI SE APLIC ARTICULO 13 O CADUCIDAD
  6705******************************************************************
  6706* GJC0013    | LEY008 - SE HACE EL CAMBIO PARA NO EXAMINAR SI LA *
  6707* G. JIMENEZ |          PERSONA TIENE DERECHO A LA AMNISTIA, YA  *
  6708* 23-ENE-2014|          NO APLICA, SOLO ARTICULO 13. (C.VELASCO) *
  6709******************************************************************
  6710
  6711
  6712*200700-AMNISTIA-CLIENTES.                                       *
  6713* RUTINA QUE LEE EL ARCHIVO DE CARTERA PARA                      *
  6714* DETERMINAR SI EL CLIENTE ES OBJETO DE BENEFICIO DE AMNISTIA    *
  6715******************************************************************
  6716 200700-AMNISTIA-CLIENTES.
  6717*    PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0009
  6718     IF SW-FCHGRACIA-LEEMSTRS = ZEROS
  6719        IF FECHA-INI-AMNIST21 = ZEROS
  6720           PERFORM 200710-VALIDAR-FECHA-INI-AMNI
  6721        END-IF
  6722        COMPUTE MES-GRACIA-AMNIST21 = MES-INI-AMNIST21 +
  6723                                 MESES-GRACIA-AMNIST21
  6724        MOVE  ANO-INI-AMNIST21  TO  ANO-GRACIA-AMNIST21
  6725        IF MES-GRACIA-AMNIST21 > 12
  6726           COMPUTE MES-GRACIA-AMNIST21 = MES-GRACIA-AMNIST21 - 12
  6727           ADD   1         TO  ANO-GRACIA-AMNIST21
  6728        END-IF
  6729        MOVE 1 TO SW-FCHGRACIA-LEEMSTRS
  6730     END-IF
  6731     PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0009
  6732     IF FECHA-SYS-AMNIST21 >= FECHA-INI-AMNIST21
  6733        AND ANO-HOY-AMNIST21 < 2014                               GJC0013
  6734        IF TIPO-ID-ABD07 <> TIPO-ID-INI-AMNIST21  OR
  6735           NUM-ID-ABD07  <> NUME-ID-INI-AMNIST21
  6736           MOVE TIPO-ID-ABD07 TO TIPO-ID-INI-AMNIST21
  6737           MOVE NUM-ID-ABD07  TO NUME-ID-INI-AMNIST21
  6738           PERFORM 5000-EXAMINAR-AMINISTIA-PERSONA
  6739        END-IF
  6740     END-IF.
  6741
  6742******************************************************************
  6743 200710-VALIDAR-FECHA-INI-AMNI.
  6744******************************************************************
  6745     DISPLAY VAR-AMBIENTE-AMNIST21 UPON ENVIRONMENT-NAME
  6746     ACCEPT VAR-AMBIENTE-AMNIST21 FROM ENVIRONMENT-VALUE
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 117
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  6747     IF VAR-AMBIENTE-AMNIST21 = "FECHA_AMNI"
  6748        DISPLAY
  6749         "NO SE HA FIJADO LA VARIABLE DE AMBIENTE DE AMNISTIA"
  6750        STOP RUN
  6751     ELSE
  6752        IF VAR-AMBIENTE-AMNIST21 = SPACES
  6753           MOVE 208001 TO FECHA-INI-AMNIST21
  6754           MOVE 1 TO VERSION-AMNIST21
  6755           DISPLAY "EJECUCION SIN TOMAR AMNISTIA "
  6756                    FECHA-INI-AMNIST21
  6757        ELSE
  6758           MOVE VAR-AMBIENTE-AMNIST21(1:6) TO FECHA-INI-AMNIST21
  6759           IF ANO-INI-AMNIST21 > 2007 AND < 2030 AND
  6760              MES-INI-AMNIST21 > 0 AND < 13
  6761              DISPLAY
  6762              "EJECUCION DE PROG CON AMNISTIA INICIADO EN "
  6763               FECHA-INI-AMNIST21
  6764              MOVE VAR-AMBIENTE-AMNIST21(7:1) TO VERSION-AMNIST21
  6765              IF VERSION-AMNIST21 > 0 AND < 3
  6766                 DISPLAY
  6767                "EJECUCION DE PROG CON AMNISTIA CON RUTINA  "
  6768                 VERSION-AMNIST21
  6769              ELSE
  6770                 DISPLAY
  6771                "LA VERSION DE RUTINA DE AMNISTIA ES INVALIDA "
  6772                 VERSION-AMNIST21
  6773                 STOP RUN
  6774              END-IF
  6775           ELSE
  6776              DISPLAY
  6777              "FECHA DE EJECUCION DE AMNISTIA INVALIDA "
  6778               FECHA-INI-AMNIST21
  6779              STOP RUN
  6780           END-IF
  6781        END-IF
  6782     END-IF.
  6783     PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0008
  6784 200711-CALCULE-FECHA-HOY.                                        GJC0009
  6785******************************************************************
  6786* 200711-CALCULE-FECHA-HOY.
  6787* SE ASIGNA LA FECHA DEL DA PARA PODER REALIZAR EL MANEJO DE PROCESOS
  6788* HISTORICOS
  6789******************************************************************
  6790        MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21        GJC0009
  6791        DISPLAY VAR-AMB-HOY-AMNIST21 UPON ENVIRONMENT-NAME        GJC0009
  6792        ACCEPT VAR-AMB-HOY-AMNIST21 FROM ENVIRONMENT-VALUE        GJC0009
  6793        IF VAR-AMB-HOY-AMNIST21(1:9) = "FECHA_HOY"                GJC0009
  6794           MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21     GJC0009
  6795        ELSE                                                      GJC0009
  6796           IF VAR-AMB-HOY-AMNIST21 = SPACES                       GJC0009
  6797              MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21  GJC0009
  6798           ELSE                                                   GJC0009
  6799              MOVE VAR-AMB-HOY-AMNIST21 TO VAR-FEC-AMB-AMNIST21   GJC0009
  6800              IF (ANO-VAR-FEC-AMB-AMNIST21 < 2000 OR > 2030) OR   GJC0009
  6801                 (MES-VAR-FEC-AMB-AMNIST21 < 1 AND > 12) OR       GJC0009
  6802                 (DIA-VAR-FEC-AMB-AMNIST21 < 1 AND > 31)          GJC0009
  6803                 DISPLAY "FECHA DE VARIABLE DE AMBIENTE FECHA-HOY"GJC0009
  6804                 DISPLAY "ES INVALIDA, SE TOMA FECHA DEL DIA DE"  GJC0009
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 118
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  6805                 DISPLAY "HOY"                                    GJC0009
  6806              ELSE                                                GJC0009
  6807                 MOVE VAR-FEC-AMB-AMNIST21 TO FECHA-HOY-AMNIST21  GJC0009
  6808              END-IF                                              GJC0009
  6809           END-IF                                                 GJC0009
  6810        END-IF                                                    GJC0009
  6811     IF SW-FCHGRACIA-LEEMSTRS = 0                                 GJC0009
  6812     DISPLAY                                                      GJC0009
  6813     "PARA APLICACION DE ARTICULO 13 SE TOMA COMO FECHA DEL DIA " GJC0009
  6814     FECHA-HOY-AMNIST21                                           GJC0009
  6815     END-IF.                                                      GJC0009
  6816
  6817******************************************************************
  6818 5000-EXAMINAR-AMINISTIA-PERSONA.
  6819******************************************************************
  6820     MOVE  0     TO SW-AMNIST21
  6821     INITIALIZE   WORK-CLIENTE-AMNIST21                           CAV0002
  6822     MOVE  LLAVE-MAES-CREDIT TO  LLAVE-INI-AMNIST21               GJC0006
  6823     MOVE  TIPO-ID-ABD07     TO  TIPO-ID-MAES-AMNIST21            GJC0006
  6824     MOVE  NUM-ID-ABD07      TO  NUM-ID-MAES-AMNIST21             GJC0006
  6825     MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21        GJC0006
  6826     INITIALIZE VECTOR-MORAS-IDE-13-AMNIST21 REPLACING            GJC0006
  6827             ALPHANUMERIC DATA BY CINCOS-AMNIST21                 GJC0006
  6828     MOVE   0   TO  SW-AMNIST21                                   GJC0006
  6829     MOVE 999 TO MESES-FALTAN-AMNIST21                            GJC0006
  6830     PERFORM 200710-READ-ICMCRE-AMNISTIA                          GJC0006
  6831     IF MORAS-ACTUAL-AMNIST21 = ZEROS                             GJC0006
  6832        IF VERSION-AMNIST21 = 1                                   GJC0006
  6833           IF CTAS-MAY12-AMNIST21 = 1                             GJC0006
  6834              MOVE 1 TO SW-AMNIST21                               GJC0006
  6835           END-IF                                                 GJC0006
  6836        ELSE                                                      GJC0006
  6837           IF CTAS-MAY12-AMNIST21 = 1 AND                         GJC0006
  6838              CTAS-MEN12-AMNIST21 = 0                             GJC0006
  6839              MOVE 1 TO SW-AMNIST21                               GJC0006
  6840           END-IF                                                 GJC0006
  6841        END-IF                                                    GJC0006
  6842     END-IF                                                       GJC0006
  6843     PERFORM 200800-RESTAURAR-REGISTROS.                          GJC0006
  6844*    END-IF.                                                      GJC0006
  6845
  6846******************************************************************
  6847*200710-READ-ICMCRE-AMNISTIA.                                    *
  6848* RUTINA ENCARGADA DE LEER EL MAESTRO DE CARTERA  ICMCRE         *
  6849******************************************************************
  6850 200710-READ-ICMCRE-AMNISTIA.
  6851     INITIALIZE        LLAVE-MAES-CREDIT
  6852     MOVE  TIPO-ID-MAES-AMNIST21  TO  TIPO-ID-ABD07
  6853     MOVE  NUM-ID-MAES-AMNIST21   TO  NUM-ID-ABD07
  6854     START MAESTRO-CREDIT  KEY NOT < LLAVE-MAES-CREDIT
  6855           INVALID KEY
  6856                   MOVE 9 TO TIPO-ID-ABD07
  6857           NOT INVALID KEY
  6858                   READ MAESTRO-CREDIT NEXT
  6859                            AT  END
  6860                                MOVE 9 TO TIPO-ID-ABD07
  6861                   END-READ
  6862     END-START
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 119
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  6863     PERFORM UNTIL TIPO-ID-ABD07 NOT = TIPO-ID-MAES-AMNIST21 OR
  6864                   NUM-ID-ABD07  NOT = NUM-ID-MAES-AMNIST21       GJC0006
  6865*                         MORAS-ACTUAL-AMNIST21 > ZEROS           GJC0006
  6866           IF COD-SUS-ABD07 = 020050 OR 030050 OR 050050 OR       GJC0010
  6867                              130050                              GJC0010
  6868              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0010
  6869           END-IF                                                 GJC0010
  6870           IF NOV-REPORT-ABD07 > 0 AND NOV-REPORT-ABD07 < 51
  6871              PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  6872              IF IND-BLOQUEO-ABD07 = 0
  6873                 MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  6874                 READ SUSCRIPTOR  IGNORE LOCK
  6875                   INVALID KEY MOVE 0 TO ESTADO-ABD02
  6876                 END-READ
  6877                 IF ESTADO-ABD02 = 1
  6878                    IF MORAS-ACTUAL-AMNIST21 = 0                  GJC0006
  6879                       PERFORM 200720-AMNIST-OBLIGACIONES         GJC0006
  6880                    END-IF                                        GJC0006
  6881* SE DEBE HABILITAR ESTE LLAMADO SI SE QUIERE PERDON POR PERSONA  GJC0009
  6882* Y NO POR CUENTA                                                 GJC0009
  6883*PER                PERFORM 200760-LLENAR-VEC-MORAS-PERS          GJC0009
  6884                 END-IF
  6885              END-IF
  6886           END-IF
  6887           READ MAESTRO-CREDIT NEXT
  6888                AT  END
  6889                    MOVE 9 TO TIPO-ID-ABD07
  6890           END-READ
  6891     END-PERFORM.
  6892
  6893******************************************************************
  6894*200720-AMNIST-OBLIGACIONES.                                     *
  6895* DETERMINA SI EXISTEN MORAS ACTUALES Y LOS REGISTROS CON MORA   *
  6896* CANCELADOS QUE CULPLIERON EL TIEMPO ESTIPULA EN LA LEY (1 AO) *
  6897******************************************************************
  6898 200720-AMNIST-OBLIGACIONES.
  6899     IF NOV-CART-CODINT-AMNIST21(NOV-REPORT-ABD07) = 12 OR 13
  6900                                                     OR 14 OR 15
  6901                                                     OR 09 OR 11
  6902        ADD 1 TO MORAS-ACTUAL-AMNIST21
  6903     END-IF
  6904     IF ESTADO-OBLIG-ABD07 = 10                                   GJC0011
  6905        ADD 1 TO MORAS-ACTUAL-AMNIST21                            GJC0011
  6906     END-IF                                                       GJC0011
  6907     IF MORAS-ACTUAL-AMNIST21 = ZEROS AND
  6908       ((MORA-MAXIMA-ABD07 > ZEROS OR MORA-MAXIMA-R-ABD07 > ZEROS)GJC0004
  6909        OR (NOV-REPORT-ABD07 = 03 OR 46))                         GJC0004
  6910        PERFORM 200740-VER-ANTIGUEDAD-MORAS
  6911     END-IF.
  6912
  6913******************************************************************
  6914*200740-VER-ANTIGUEDAD-MORAS.                                    *
  6915* DETERMINA SI HAY MORAS MAYORES O MENORES A UN AO              *
  6916******************************************************************
  6917 200740-VER-ANTIGUEDAD-MORAS.
  6918     MOVE ZEROS TO MESES-VEC-AMNIST21 VECT1-AMNIST21
  6919                   VECTOR-TOT-AMNIST21 MESES-GRC-AMNIST21
  6920                   VECT2-AMNIST21 VECT3-AMNIST21 VECT4-AMNIST21
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 120
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  6921     PERFORM 200745-CALCULAR-MESES-A-HOY                          GJC0006
  6922     IF MESES-NOV-AMNIST21 >= 12
  6923        MOVE ZEROS TO MESES-VEC-AMNIST21
  6924     ELSE
  6925        COMPUTE MESES-VEC-AMNIST21 = MESES-CANCELAC-AMNIST21 -
  6926                MESES-NOV-AMNIST21
  6927     END-IF
  6928     IF FEC-NOVEDAD-AMNIST21 > FECHA-GRACIA-AMNIST21
  6929        COMPUTE MESES-GRC-AMNIST21 =
  6930             (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21) -
  6931             (ANO-GRACIA-AMNIST21 * 12 + MES-GRACIA-AMNIST21)
  6932     ELSE
  6933        MOVE ZEROS TO MESES-GRC-AMNIST21
  6934     END-IF
  6935        MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21
  6936        MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21
  6937        MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21
  6938        MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21
  6939        MOVE  1 TO K-AMNIST21
  6940        MOVE 12 TO L-AMNIST21
  6941        PERFORM UNTIL L-AMNIST21 = 0
  6942          MOVE VECT1-AMNIST21 (L-AMNIST21:1) TO
  6943               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6944          ADD 1 TO K-AMNIST21
  6945          SUBTRACT 1 FROM L-AMNIST21
  6946        END-PERFORM
  6947        MOVE 12 TO L-AMNIST21
  6948        PERFORM UNTIL L-AMNIST21 = 0
  6949          MOVE VECT2-AMNIST21 (L-AMNIST21:1) TO
  6950               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6951          ADD 1 TO K-AMNIST21
  6952          SUBTRACT 1 FROM L-AMNIST21
  6953        END-PERFORM
  6954        MOVE 12 TO L-AMNIST21
  6955        PERFORM UNTIL L-AMNIST21 = 0
  6956          MOVE VECT3-AMNIST21 (L-AMNIST21:1) TO
  6957               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6958          ADD 1 TO K-AMNIST21
  6959          SUBTRACT 1 FROM L-AMNIST21
  6960        END-PERFORM
  6961        MOVE 12 TO L-AMNIST21
  6962        PERFORM UNTIL L-AMNIST21 = 0
  6963          MOVE VECT4-AMNIST21 (L-AMNIST21:1) TO
  6964               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6965          ADD 1 TO K-AMNIST21
  6966          SUBTRACT 1 FROM L-AMNIST21
  6967        END-PERFORM
  6968        MOVE ZEROS TO SW-SALIR-VECT
  6969        PERFORM VARYING X-AMNIST21 FROM 1 BY 1 UNTIL
  6970                X-AMNIST21 >  48 OR
  6971                MORAS-ACTUAL-AMNIST21 > ZEROS OR
  6972                SW-SALIR-VECT > ZEROS
  6973         IF V-VEC-AMNIST21(X-AMNIST21) = "1" OR "2" OR "3" OR "4"
  6974             IF FECHA-SYS-AMNIST21 > FECHA-GRACIA-AMNIST21
  6975                IF X-AMNIST21 < MESES-GRC-AMNIST21
  6976                   ADD  1  TO  MORAS-ACTUAL-AMNIST21
  6977                END-IF
  6978             END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 121
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  6979             IF MORAS-ACTUAL-AMNIST21 = ZEROS
  6980                IF  X-AMNIST21 <= MESES-VEC-AMNIST21              CAV0003
  6981                    MOVE 1 TO CTAS-MEN12-AMNIST21
  6982                    MOVE 1 TO SW-SALIR-VECT
  6983                ELSE
  6984                    MOVE 1 TO CTAS-MAY12-AMNIST21
  6985                    MOVE 1 TO SW-SALIR-VECT
  6986                END-IF
  6987             END-IF
  6988         END-IF
  6989        END-PERFORM
  6990        IF X-AMNIST21 > 48 *> CASOS DE NO HAY MORA EN EL VECTOR
  6991           MOVE 1 TO CTAS-MAY12-AMNIST21
  6992        END-IF.                                                   GJC0005
  6993*****************************************************************
  6994*200745-CALCULAR-MESES-A-HOY.                             *
  6995*SE REALIZA EL CALCULO PARA DETERMINAR CUANTOS MESES DE DESACTUA-*
  6996*LIZACION O CIERRE TIENE LA CUENTA RESPECTO AL DIA DE HOY        *
  6997******************************************************************
  6998 200745-CALCULAR-MESES-A-HOY.                                     GJC0006
  6999     MOVE ZEROS              TO  FECHA-AUX-AMNIST21               GJC0006
  7000     MOVE FEC-NOVEDAD-ABD07  TO  FECHA-AUX-AMNIST21               GJC0006
  7001     PERFORM 200950-CONVIERTE-FECHA                               GJC0006
  7002     MOVE    ZEROS           TO  MESES-NOV-AMNIST21               GJC0006
  7003     COMPUTE MESES-NOV-AMNIST21 =                                 GJC0006
  7004          (ANO-HOY-AMNIST21 * 12 + MES-HOY-AMNIST21) -            GJC0006
  7005          (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21).             GJC0006
  7006*****************************************************************
  7007*200760-LLENAR-VEC-MORAS-PERS.                             *
  7008*DE CADA CUENTA QUE SE VA LEYENDO SE TOMAN LAS MORAS Y SE VA LLE-*
  7009* NANDO EL VECTOR DE MORAS DE TODA LA PERSONA                    *
  7010******************************************************************
  7011 200760-LLENAR-VEC-MORAS-PERS.                                    GJC0006
  7012     MOVE 0 TO K-AMNIST21                                         GJC0006
  7013     IF MORA-MAXIMA-ABD07 > 0 OR MORA-MAXIMA-R-ABD07 > 0          GJC0006
  7014        MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21          GJC0006
  7015        MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21          GJC0006
  7016        MOVE VECTOR-HIS-3-ABD07 TO VECTOR-3-CTA-AMNIST21          GJC0006
  7017        MOVE VECTOR-HIS-4-ABD07 TO VECTOR-4-CTA-AMNIST21          GJC0006
  7018        MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO          GJC0006
  7019             MOR-EST-CTA-AMNIST21                                 GJC0006
  7020        PERFORM 200745-CALCULAR-MESES-A-HOY                       GJC0006
  7021        IF MESES-NOV-AMNIST21 < 100                               GJC0006
  7022           COMPUTE K-AMNIST21 = 100 - MESES-NOV-AMNIST21          GJC0006
  7023        ELSE                                                      GJC0006
  7024           MOVE 0 TO K-AMNIST21                                   GJC0006
  7025        END-IF                                                    GJC0006
  7026        MOVE 49 TO L-AMNIST21                                     GJC0006
  7027        PERFORM UNTIL K-AMNIST21 = 0 OR L-AMNIST21 = 0            GJC0006
  7028          IF VEC-MOR-IDE-13-AMNIST21(K-AMNIST21) = 5              GJC0006
  7029             IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5      GJC0006
  7030                MOVE  1 TO VEC-MOR-IDE-13-AMNIST21(K-AMNIST21)    GJC0006
  7031             END-IF                                               GJC0006
  7032          END-IF                                                  GJC0006
  7033          COMPUTE K-AMNIST21 = K-AMNIST21 - 1                     GJC0006
  7034          COMPUTE L-AMNIST21 = L-AMNIST21 - 1                     GJC0006
  7035        END-PERFORM                                               GJC0006
  7036        IF MOR-EST-CTA-AMNIST21 <> 5                              GJC0006
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 122
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7037           MOVE 100 TO L-AMNIST21                                 GJC0006
  7038           PERFORM VARYING K-AMNIST21 FROM 1 BY 1 UNTIL           GJC0006
  7039               K-AMNIST21 > MESES-NOV-AMNIST21 OR L-AMNIST21 = 0  GJC0006
  7040              MOVE 1 TO VEC-MOR-IDE-13-AMNIST21(L-AMNIST21)       GJC0006
  7041              COMPUTE L-AMNIST21 = L-AMNIST21 - 1                 GJC0006
  7042           END-PERFORM                                            GJC0006
  7043        END-IF                                                    GJC0006
  7044     END-IF.                                                      GJC0006
  7045******************************************************************
  7046*200800-RESTAURAR-REGISTROS.                                      *
  7047* RUTINA ENCARGADA DE LEER EL REGISTRO ORIGINAL PARA AMNISTIAR   *
  7048******************************************************************
  7049 200800-RESTAURAR-REGISTROS.
  7050     MOVE LLAVE-INI-AMNIST21 TO LLAVE-MAES-CREDIT
  7051     READ MAESTRO-CREDIT INVALID KEY
  7052           DISPLAY " ERROR READ ICMCRE "
  7053     END-READ
  7054     IF REG-SUSCRIPTOR-AMNISTIA21 <> REG-SUSCRIPTOR
  7055        MOVE REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR
  7056     END-IF.
  7057
  7058 200850-AMNISTIA-REGISTROS.
  7059******************************************************************
  7060*200850-AMNISTIA-REGISTROS.                                      *
  7061* RUTINA ENCARGADA DE VALIDAR SI APLICA O NO AMNISTIA AL RESGISTR*
  7062******************************************************************
  7063       MOVE ZEROS TO MESES-VEC-AMNIST21 MESES-GRC-AMNIST21
  7064                     VECT1-AMNIST21 VECT2-AMNIST21 VECT3-AMNIST21
  7065                     VECT4-AMNIST21 VECTOR-TOT-AMNIST21
  7066       MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21
  7067       MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  7068       READ SUSCRIPTOR  IGNORE LOCK
  7069            INVALID KEY MOVE 0 TO ESTADO-ABD02
  7070       END-READ
  7071       IF ESTADO-ABD02 = 1
  7072        IF TAB-VIG-CART-AMNIST21(NOV-REPORT-ABD07) = 0 OR
  7073           ((NOV-REPORT-ABD07 = 13 OR 14 OR 15 OR 16) OR          CAV0002
  7074            (NOV-REPORT-R-ABD07 = 13 OR 14 OR 15 OR 16))          CAV0002
  7075          IF ((MORA-MAXIMA-ABD07 > ZEROS OR                       GJC0004
  7076              MORA-MAXIMA-R-ABD07 > ZEROS) OR                     GJC0004
  7077               (NOV-REPORT-ABD07 = 03 OR 46)) AND                 GJC0004
  7078              IND-BLOQUEO-ABD07 = 0                               CAV0002
  7079           MOVE  ZEROS              TO  FECHA-AUX-AMNIST21
  7080           MOVE  FEC-NOVEDAD-ABD07  TO  FECHA-AUX-AMNIST21
  7081           PERFORM 200950-CONVIERTE-FECHA
  7082           MOVE    ZEROS            TO  MESES-NOV-AMNIST21
  7083           COMPUTE MESES-NOV-AMNIST21 =
  7084                   (ANO-HOY-AMNIST21 * 12 + MES-HOY-AMNIST21) -
  7085                   (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21)
  7086           IF MESES-NOV-AMNIST21 >= 12
  7087              MOVE ZEROS TO MESES-VEC-AMNIST21
  7088           ELSE
  7089           COMPUTE MESES-VEC-AMNIST21 = MESES-CANCELAC-AMNIST21 -
  7090                   MESES-NOV-AMNIST21
  7091           END-IF
  7092           IF FEC-NOVEDAD-AMNIST21 > FECHA-GRACIA-AMNIST21
  7093              COMPUTE MESES-GRC-AMNIST21 =
  7094                 (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21) -
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 123
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7095                 (ANO-GRACIA-AMNIST21 * 12 + MES-GRACIA-AMNIST21)
  7096           ELSE
  7097              MOVE ZEROS TO MESES-GRC-AMNIST21
  7098           END-IF
  7099           MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21
  7100           MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21
  7101           MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21
  7102           MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21
  7103           MOVE  1 TO K-AMNIST21
  7104           MOVE 12 TO L-AMNIST21
  7105           PERFORM UNTIL L-AMNIST21 = 0
  7106             MOVE VECT1-AMNIST21 (L-AMNIST21:1) TO
  7107                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7108             ADD 1 TO K-AMNIST21
  7109             SUBTRACT 1 FROM L-AMNIST21
  7110           END-PERFORM
  7111           MOVE 12 TO L-AMNIST21
  7112           PERFORM UNTIL L-AMNIST21 = 0
  7113             MOVE VECT2-AMNIST21 (L-AMNIST21:1) TO
  7114                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7115             ADD 1 TO K-AMNIST21
  7116             SUBTRACT 1 FROM L-AMNIST21
  7117           END-PERFORM
  7118           MOVE 12 TO L-AMNIST21
  7119           PERFORM UNTIL L-AMNIST21 = 0
  7120             MOVE VECT3-AMNIST21 (L-AMNIST21:1) TO
  7121                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7122             ADD 1 TO K-AMNIST21
  7123             SUBTRACT 1 FROM L-AMNIST21
  7124           END-PERFORM
  7125           MOVE 12 TO L-AMNIST21
  7126           PERFORM UNTIL L-AMNIST21 = 0
  7127             MOVE VECT4-AMNIST21 (L-AMNIST21:1) TO
  7128                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7129             ADD 1 TO K-AMNIST21
  7130             SUBTRACT 1 FROM L-AMNIST21
  7131           END-PERFORM
  7132           MOVE ZEROS TO SW-SALIR-VECT
  7133           PERFORM VARYING X-AMNIST21 FROM 1 BY 1 UNTIL
  7134                   X-AMNIST21 >  48 OR
  7135                   SW-SALIR-VECT > ZEROS
  7136             IF V-VEC-AMNIST21(X-AMNIST21) = "1" OR "2" OR
  7137                                             "3" OR "4"
  7138                   IF X-AMNIST21 <= MESES-VEC-AMNIST21            CAV0003
  7139                      MOVE 1 TO SW-SALIR-VECT
  7140                   ELSE
  7141                        PERFORM 200870-APLICA-AMNISTIA            GJC0006
  7142                        MOVE 1 TO SW-SALIR-VECT                   GJC0004
  7143                   END-IF
  7144             END-IF
  7145           END-PERFORM
  7146           IF X-AMNIST21 > 48    *> CASOS EN QUE NO HAY MORA EN
  7147              PERFORM 200870-APLICA-AMNISTIA *>  EL VECTOR        GJC0006
  7148           END-IF
  7149          END-IF
  7150        END-IF
  7151       END-IF
  7152       MOVE  REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 124
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7153
  7154******************************************************************
  7155*200870-APLICA-AMNISTIA.                                         *
  7156* RUTINA ENCARGADA DE APLICAR LA AMNISTIA AL REGISTRO            *
  7157******************************************************************
  7158 200870-APLICA-AMNISTIA.                                          GJC0006
  7159     INITIALIZE VECTOR1-AMNIST21 VECTOR2-AMNIST21
  7160     MOVE 0 TO NUM-MORAS30-ABD07
  7161     MOVE 0 TO MORA-MAXIMA-ABD07
  7162     MOVE 0 TO FECHA-MORA-MAXIMA-ABD07
  7163     IF ADJETIVO1-ABD07 > 1
  7164        MOVE 0        TO ADJETIVO1-ABD07
  7165     END-IF
  7166     IF ADJETIVO2-ABD07 > 1
  7167            MOVE 0        TO ADJETIVO2-ABD07
  7168     END-IF
  7169     IF ADJETIVO3-ABD07 > 1
  7170            MOVE 0        TO ADJETIVO3-ABD07
  7171     END-IF
  7172     IF NOV-REPORT-ABD07 = 46
  7173        IF COD-CTA-ABD07 = 02
  7174           MOVE 06 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7175        ELSE
  7176           MOVE 08 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7177        END-IF
  7178     ELSE
  7179        IF NOV-REPORT-ABD07 = 03
  7180           MOVE 06 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7181        ELSE
  7182           IF NOV-REPORT-ABD07 = 09 OR 10 OR 11 OR 12
  7183              MOVE 08 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7184           ELSE
  7185              IF NOV-REPORT-ABD07 = 13 OR 14 OR 15 OR 16
  7186                 MOVE 01 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7187              END-IF
  7188           END-IF
  7189        END-IF
  7190     END-IF
  7191     MOVE ESTADO-MES-ABD07   TO VECTOR1-AMNIST21
  7192     MOVE VECTOR-2-ABD07     TO VECTOR2-AMNIST21
  7193     MOVE VECTOR-HIS-3-ABD07 TO VECTOR3-AMNIST21
  7194     MOVE VECTOR-HIS-4-ABD07 TO VECTOR4-AMNIST21
  7195     INSPECT VECTOR1-AMNIST21 REPLACING ALL "1" BY "8"
  7196     INSPECT VECTOR1-AMNIST21 REPLACING ALL "2" BY "8"
  7197     INSPECT VECTOR1-AMNIST21 REPLACING ALL "3" BY "8"
  7198     INSPECT VECTOR1-AMNIST21 REPLACING ALL "4" BY "8"
  7199     INSPECT VECTOR2-AMNIST21 REPLACING ALL "1" BY "8"
  7200     INSPECT VECTOR2-AMNIST21 REPLACING ALL "2" BY "8"
  7201     INSPECT VECTOR2-AMNIST21 REPLACING ALL "3" BY "8"
  7202     INSPECT VECTOR2-AMNIST21 REPLACING ALL "4" BY "8"
  7203     INSPECT VECTOR3-AMNIST21 REPLACING ALL "1" BY "8"
  7204     INSPECT VECTOR3-AMNIST21 REPLACING ALL "2" BY "8"
  7205     INSPECT VECTOR3-AMNIST21 REPLACING ALL "3" BY "8"
  7206     INSPECT VECTOR3-AMNIST21 REPLACING ALL "4" BY "8"
  7207     INSPECT VECTOR4-AMNIST21 REPLACING ALL "1" BY "8"
  7208     INSPECT VECTOR4-AMNIST21 REPLACING ALL "2" BY "8"
  7209     INSPECT VECTOR4-AMNIST21 REPLACING ALL "3" BY "8"
  7210     INSPECT VECTOR4-AMNIST21 REPLACING ALL "4" BY "8"
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 125
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7211     MOVE VECTOR1-AMNIST21 TO ESTADO-MES-ABD07
  7212     MOVE VECTOR2-AMNIST21 TO VECTOR-2-ABD07.
  7213     MOVE VECTOR3-AMNIST21 TO VECTOR-HIS-3-ABD07
  7214     MOVE VECTOR4-AMNIST21 TO VECTOR-HIS-4-ABD07.
  7215*****************************************************************
  7216*200900-APLICAR-ART13-REGISTRO.                                         *
  7217* RUTINA ENCARGADA DE APLICAR PERDON CON 8 AL DOBLE DEL TIEMPO DE*
  7218* LA MORA (ARTICULO 13 DE LA LEY). PARA PERDONAR SE APOYA EN EL
  7219* VECTOR DE MORAS DE TODA LA PERSONA
  7220******************************************************************
  7221 200900-APLICAR-ART13-REGISTRO.                                   GJC0006
  7222     MOVE 0 TO CTA-PERDONADA-AMNIST21                             GJC0006
  7223     MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21        GJC0006
  7224     MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                      GJC0006
  7225     IF IND-BLOQUEO-ABD07 = 0                                     GJC0006
  7226        READ SUSCRIPTOR  IGNORE LOCK                              GJC0006
  7227           INVALID KEY MOVE 0 TO ESTADO-ABD02                     GJC0006
  7228       END-READ                                                   GJC0006
  7229       IF ESTADO-ABD02 = 1                                        GJC0006
  7230* PRIMERO SE REVISA SI ES DUDOSO RECAUDO O CAN MM CON MORA EN 0   GJC0006
  7231* SE CAMBIA EL ESTADO SIN MS ANALISIS                            GJC0006
  7232          IF (NOV-REPORT-ABD07 = 46 OR NOV-REPORT-ABD07 = 03) AND GJC0006
  7233             (MORA-MAXIMA-ABD07 = 0 AND MORA-MAXIMA-R-ABD07 = 0)  GJC0006
  7234            IF NOV-REPORT-ABD07 = 03                              GJC0006
  7235               MOVE 06 TO NOV-REPORT-ABD07                        GJC0006
  7236                         NOV-REPORT-R-ABD07                       GJC0006
  7237            ELSE                                                  GJC0006
  7238              IF COD-CTA-ABD07 = 02                               GJC0006
  7239                 MOVE 06 TO NOV-REPORT-ABD07                      GJC0006
  7240                            NOV-REPORT-R-ABD07                    GJC0006
  7241              ELSE                                                GJC0006
  7242                 MOVE 08 TO NOV-REPORT-ABD07                      GJC0006
  7243                            NOV-REPORT-R-ABD07                    GJC0006
  7244              END-IF                                              GJC0006
  7245          ELSE                                                    GJC0006
  7246             IF MORA-MAXIMA-ABD07 = 0 AND MORA-MAXIMA-R-ABD07 = 0 GJC0006
  7247                MOVE 1 TO X-AMNIST21                              GJC0006
  7248             ELSE                                                 GJC0006
  7249                IF ESTADO-OBLIG-ABD07 <> 10                       GJC0011
  7250                   PERFORM 200930-ART13-CTA-CON-MORA              GJC0011
  7251                ELSE                                              GJC0011
  7252                   MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21     GJC0011
  7253                   MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21     GJC0011
  7254                   MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21     GJC0011
  7255                   MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21     GJC0011
  7256                   PERFORM VARYING L-AMNIST21 FROM 1 BY 1         GJC0011
  7257                        UNTIL L-AMNIST21 >12                      GJC0011
  7258                     IF (VECT1-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7259                                               4 AND <> 0) OR     GJC0011
  7260                        (VECT2-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7261                                               4 AND <> 0) OR     GJC0011
  7262                        (VECT3-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7263                                               4 AND <> 0) OR     GJC0011
  7264                        (VECT4-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7265                                               4 AND <> 0)        GJC0011
  7266                        MOVE 100 TO L-AMNIST21                    GJC0011
  7267                    END-IF                                        GJC0011
  7268                   END-PERFORM                                    GJC0011
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 126
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7269                   IF L-AMNIST21 >= 100                           GJC0011
  7270                      PERFORM 200930-ART13-CTA-CON-MORA           GJC0011
  7271                   END-IF                                         GJC0011
  7272                END-IF                                            GJC0011
  7273             END-IF                                               GJC0006
  7274          END-IF                                                  GJC0006
  7275     END-IF                                                       GJC0006
  7276* SE RECUPERA EL REGISTRO DE SUSCRIPTOR QUE ESTABA LEIDO          GJC0006
  7277     MOVE  REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR.           GJC0006
  7278*****************************************************************
  7279*200930-APLICAR-ART13-CTA-CON-MORA.                               *
  7280* A ESTA RUTINA SOLO LLEGAN CUENTAS QUE HAYAN TENIDO MORA.SU OBJE-*
  7281* TIVO ES VERIFICAR QUE LAPSOS DE MORA SE PUEDEN PERDONAR Y QUE   *
  7282* LAPSOS NO
  7283******************************************************************
  7284 200930-ART13-CTA-CON-MORA.                                       GJC0006
  7285     MOVE 0 TO CTA-PERDONADA-AMNIST21                             GJC0006
  7286     INITIALIZE K-AMNIST21 L-AMNIST21 Z-AMNIST21 X-AMNIST21       GJC0006
  7287                 M-AMNIST21                                       GJC0006
  7288                 IND-APLICO-CAD-AMNIST21                          GJC0012
  7290     INITIALIZE VECTOR-100-CTA-AMNIST21 REPLACING                 GJC0006
  7291             ALPHANUMERIC DATA BY CINCOS-AMNIST21(1:100)          GJC0006
  7292     PERFORM 200745-CALCULAR-MESES-A-HOY                          GJC0006
  7293     MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21             GJC0006
  7294     MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21             GJC0006
  7295     MOVE VECTOR-HIS-3-ABD07 TO VECTOR-3-CTA-AMNIST21             GJC0006
  7296     MOVE VECTOR-HIS-4-ABD07 TO VECTOR-4-CTA-AMNIST21             GJC0006
  7297     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0006
  7298          MOR-EST-CTA-AMNIST21                                    GJC0006
  7299*    PRIMERO SE LLENA EL VECTOR DE LA CUENTA EN 100 POSICIONES    GJC0006
  7300     IF MESES-NOV-AMNIST21 < 52                                   GJC0006
  7301        COMPUTE POSICION-INI-AMNIST21 = 52 - MESES-NOV-AMNIST21   GJC0006
  7302        MOVE POSICION-INI-AMNIST21 TO K-AMNIST21                  GJC0006
  7303        MOVE VECTOR-TOT-CTA-AMNIST21 TO                           GJC0006
  7304             VECTOR-100-CTA-AMNIST21(K-AMNIST21:49)               GJC0006
  7305             COMPUTE Z-AMNIST21 = K-AMNIST21 + 49                 GJC0006
  7306     ELSE                                                         GJC0006
  7307        PERFORM 200933-CADUCAR-MORAS                              GJC0012
  7308        MOVE  1 TO POSICION-INI-AMNIST21                          GJC0006
  7309        IF MESES-NOV-AMNIST21 <  100    *> <=                     GJC0006
  7310           COMPUTE L-AMNIST21 = 100 - MESES-NOV-AMNIST21          GJC0006
  7311              COMPUTE K-AMNIST21 = 50 - L-AMNIST21    *>49        GJC0006
  7312            MOVE VECTOR-TOT-CTA-AMNIST21(K-AMNIST21:L-AMNIST21) TOGJC0006
  7313                VECTOR-100-CTA-AMNIST21(1:L-AMNIST21)             GJC0006
  7314              COMPUTE Z-AMNIST21 = L-AMNIST21 + 1                 GJC0006
  7315        ELSE                                                      GJC0006
  7316           MOVE 1 TO Z-AMNIST21 K-AMNIST21                        GJC0006
  7317        END-IF                                                    GJC0006
  7318     END-IF                                                       GJC0006
  7319* SI EL ESTADO ACTUAL DE LA CUENTA ES MOROSO SE RELLENA DE MORAS  GJC0009
  7320* HASTA LA POSICION 100                                           GJC0009
  7321     IF (NOV-REPORT-ABD07 > 12 AND < 46) OR                       GJC0009
  7322        NOV-REPORT-ABD07 = 47                                     GJC0009
  7323        PERFORM UNTIL Z-AMNIST21 > 100                            GJC0006
  7324           IF NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) <> 5       GJC0008
  7325              MOVE 1 TO VEC-100-CTA-AMNIST21(Z-AMNIST21)          GJC0009
  7326           ELSE                                                   GJC0008
  7327             MOVE 2 TO VEC-100-CTA-AMNIST21(Z-AMNIST21)           GJC0008
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 127
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7328           END-IF                                                 GJC0008
  7329          ADD 1 TO Z-AMNIST21                                     GJC0006
  7330        END-PERFORM                                               GJC0006
  7331     ELSE
  7332        MOVE 1 TO  VEC-100-CTA-AMNIST21(100)
  7333     END-IF                                                       GJC0006
  7334* SE REEEMPLAZAN EN EL VECTOR LAS POSICONES QUE NO SON MORA POR   GJC0009
  7335* AL DIA                                                          GJC0009
  7336     MOVE 1 TO VEC-100-CTA-AMNIST21(101)                          GJC0006
  7337     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "0" BY "5"    GJC0006
  7338     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "6" BY "5"    GJC0006
  7339     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "7" BY "5"    GJC0006
  7340     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "8" BY "5"    GJC0006
  7341     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "9" BY "5"    GJC0006
  7342* SE INICIA EL RECORRIDO PARA HALLAR LOS LAPOS DE MORA Y LA MORA  GJC0006
  7343* CORRIDA                                                         GJC0006
  7344     MOVE 0 TO LAPSO-AMNIST21                                     GJC0006
  7345     MOVE 0 TO MAYOR-LAPSO-AMNIST21 SALIR-AMNIST21                GJC0006
  7346               ESTOY-MOROSO-AMNIST21 MESES-MORAS-AMNIST21         GJC0006
  7347     PERFORM VARYING Z-AMNIST21 FROM 1 BY 1 UNTIL Z-AMNIST21 > 30 GJC0006
  7348             MOVE ZEROS TO VECTOR-LAPSOS(Z-AMNIST21)              GJC0006
  7349     END-PERFORM                                                  GJC0006
  7350     PERFORM UNTIL K-AMNIST21 > 101 OR SALIR-AMNIST21 = 1         GJC0006
  7351        IF ESTOY-MOROSO-AMNIST21 = 1                              GJC0006
  7352           IF VEC-100-CTA-AMNIST21(K-AMNIST21) <> 5               GJC0006
  7353              ADD 1 TO MESES-MORAS-AMNIST21                       GJC0006
  7354           ELSE                                                   GJC0006
  7355              MOVE 0 TO ESTOY-MOROSO-AMNIST21                     GJC0006
  7356             MOVE K-AMNIST21 TO L-AMNIST21                        GJC0006
  7357           END-IF                                                 GJC0006
  7358        ELSE                                                      GJC0006
  7359           IF VEC-100-CTA-AMNIST21(K-AMNIST21) > 0 AND < 5        GJC0006
  7360              IF MESES-MORAS-AMNIST21 > 0                         GJC0006
  7361                 MOVE MESES-MORAS-AMNIST21 TO                     GJC0006
  7362                 LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)              GJC0006
  7363                 PERFORM 200935-VER-SI-DOBLE-MORA                 GJC0006
  7364              END-IF                                              GJC0006
  7365              ADD 1 TO LAPSO-AMNIST21                             GJC0006
  7366              MOVE 1 TO MESES-MORAS-AMNIST21                      GJC0006
  7367              MOVE 1 TO ESTOY-MOROSO-AMNIST21                     GJC0006
  7368              MOVE K-AMNIST21 TO                                  GJC0006
  7369                   INI-GRUPO-AMNIST21(LAPSO-AMNIST21)             GJC0006
  7370              MOVE 0 TO PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)     GJC0006
  7371           END-IF                                                 GJC0006
  7372        END-IF                                                    GJC0006
  7373        ADD 1 TO K-AMNIST21                                       GJC0006
  7374     END-PERFORM                                                  GJC0006
  7375     COMPUTE L-AMNIST21 = LAPSO-AMNIST21 + 1                      GJC0006
  7376     IF CTA-PERDONADA-AMNIST21 = 1 OR IND-APLICO-CAD-AMNIST21 = 1 GJC0012
  7377        PERFORM 200940-PERDONAR-VECTOR-CTA                        GJC0006
  7378        MOVE VECTOR-4-CTA-AMNIST21 TO VECTOR-HIS-4-ABD07          GJC0006
  7379        MOVE VECTOR-3-CTA-AMNIST21 TO VECTOR-HIS-3-ABD07          GJC0006
  7380        MOVE VECTOR-2-CTA-AMNIST21 TO VECTOR-HIS-2-ABD07          GJC0006
  7381        MOVE VECTOR-1-CTA-AMNIST21 TO VECTOR-HIS-1-ABD07          GJC0006
  7382        PERFORM 500000-RECONSTRUCCION-HISTORIA                    GJC0006
  7383        PERFORM 555000-MANEJO-RECUP-Y-MM                          GJC0007
  7384     END-IF.                                                      GJC0006
  7385
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 128
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7386******************************************************************
  7387*200933-CADUCAR-MORAS                                            *
  7388* A LAS CUENTAS CUYO VECTOR DE COMPORTAMIENTO NO CABE EN LAS 100
  7389* POSICIONES DEL VECTOR EN QUE SE CALCULA LA APLICACION DEL AR-  *
  7390* TICULO 13 SE APLICA LA CADUCIDAD SOBRE LO QUE LLEVA MAS DE
  7391* 48 MESES
  7392******************************************************************
  7393 200933-CADUCAR-MORAS.                                            GJC0012
  7394     IF NOV-REPORT-ABD07 < 13 OR  = 46                            GJC0012
  7395      PERFORM VARYING L-AMNIST21 FROM 1 BY 1 UNTIL L-AMNIST21 > 48GJC0012
  7396       IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5            GJC0012
  7397          MOVE 8 TO VEC-TOT-CTA-AMNIST21(L-AMNIST21)              GJC0012
  7398          IF IND-APLICO-CAD-AMNIST21 = 0                          GJC0012
  7399             MOVE 1 TO IND-APLICO-CAD-AMNIST21                    GJC0012
  7400          END-IF                                                  GJC0012
  7401       END-IF                                                     GJC0012
  7402      END-PERFORM                                                 GJC0012
  7403     END-IF.                                                      GJC0012
  7404
  7405******************************************************************
  7406*200935-VER-SI-DOBLE-MORA                                          *
  7407* VALIDA SI SE PUEDE PERDONAR O NO EL PERIODO DE GRACIA QUE SE
  7408*EST ANALIZANDO*
  7409******************************************************************
  7410 200935-VER-SI-DOBLE-MORA.                                        GJC0006
  7411     IF MESES-MORAS-AMNIST21 >  MAYOR-LAPSO-AMNIST21              GJC0006
  7412        COMPUTE X-AMNIST21 = (MESES-MORAS-AMNIST21 * 2) *> OJO + 1GJC0006
  7413     ELSE                                                         GJC0006
  7414        COMPUTE X-AMNIST21 = (MAYOR-LAPSO-AMNIST21 * 2) *> OJO + 1GJC0006
  7415     END-IF                                                       GJC0006
  7416     IF X-AMNIST21 > 48                                           GJC0011
  7417       MOVE 48 TO X-AMNIST21                                      GJC0011
  7418     END-IF                                                       GJC0011
  7419     IF X-AMNIST21 <= 101 - L-AMNIST21                            GJC0006
  7420        MOVE 0 TO M-AMNIST21                                      GJC0006
  7421        INSPECT VECTOR-100-CTA-AMNIST21(L-AMNIST21:X-AMNIST21)    GJC0006
  7422             TALLYING M-AMNIST21 FOR ALL                          GJC0006
  7423                      CINCOS-AMNIST21(1:X-AMNIST21)               GJC0006
  7424        IF M-AMNIST21 > 0                                         GJC0006
  7425* LAS 2 SIGUIENTES INSTRUCCIONES Y EL ELSE DEL IF SE DEBEN DESCO- GJC0009
  7426* MENTAREAR SI SE DECIDE APLICAR ARTICULO 13 POR PERSONA CUENTA   GJC0009
  7427*PER       COMPUTE MESES-AMNIST21 = L-AMNIST21 + X-AMNIST21 - 1   GJC0009
  7428*PER       IF VEC-MOR-IDE-13-AMNIST21(MESES-AMNIST21) = 5         GJC0009
  7429              MOVE 1 TO PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)     GJC0006
  7430              MOVE 1 TO CTA-PERDONADA-AMNIST21                    GJC0006
  7431              IF LAPSO-AMNIST21 > 1                               GJC0006
  7432                 COMPUTE Z-AMNIST21 = LAPSO-AMNIST21 - 1          GJC0006
  7433                 PERFORM UNTIL Z-AMNIST21 = 0                     GJC0006
  7434                    IF PERDON-GRUPO-AMNIST21(Z-AMNIST21) = 0      GJC0006
  7435                       MOVE 1 TO                                  GJC0006
  7436                         PERDON-GRUPO-AMNIST21(Z-AMNIST21)        GJC0006
  7437                       COMPUTE Z-AMNIST21 = Z-AMNIST21 - 1        GJC0006
  7438                    ELSE                                          GJC0006
  7439                       MOVE 0 TO Z-AMNIST21                       GJC0006
  7440                    END-IF                                        GJC0006
  7441                 END-PERFORM                                      GJC0006
  7442                 MOVE 0 TO MAYOR-LAPSO-AMNIST21                   GJC0006
  7443              END-IF                                              GJC0006
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 129
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7444*PER       ELSE                                                   GJC0009
  7445*PER          COMPUTE X-AMNIST21 =  X-AMNIST21 + L-AMNIST21       GJC0009
  7446*PER          ADD 1 TO  MESES-AMNIST21                            GJC0009
  7447*PER          PERFORM UNTIL X-AMNIST21 > 100 OR                   GJC0009
  7448*PER               PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)= 1       GJC0009
  7449*PER             IF VEC-100-CTA-AMNIST21(X-AMNIST21) = "5" OR "2" GJC0009
  7450*PER                IF VEC-MOR-IDE-13-AMNIST21(MESES-AMNIST21)    GJC0009
  7451*PER                      = "5"                                   GJC0009
  7452*PER                   MOVE 1 TO                                  GJC0009
  7453*PER                         PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)GJC0009
  7454*PER                   MOVE 1 TO CTA-PERDONADA-AMNIST21           GJC0009
  7455*PER                   IF LAPSO-AMNIST21 > 1                      GJC0009
  7456*PER                      MOVE LAPSO-AMNIST21 TO Z-AMNIST21       GJC0009
  7457*PER                      PERFORM UNTIL Z-AMNIST21 = 0            GJC0009
  7458*PER                         MOVE 1 TO                            GJC0009
  7459*PER                         PERDON-GRUPO-AMNIST21(Z-AMNIST21)    GJC0009
  7460*PER                         COMPUTE Z-AMNIST21 = Z-AMNIST21 - 1  GJC0009
  7461*PER                      END-PERFORM                             GJC0009
  7462*PER                      MOVE 0 TO MAYOR-LAPSO-AMNIST21          GJC0009
  7463*PER                   END-IF                                     GJC0009
  7464*PER                END-IF                                        GJC0009
  7465*PER             ELSE                                             GJC0009
  7466*PER               MOVE 105 TO X-AMNIST21                         GJC0009
  7467*PER             END-IF                                           GJC0009
  7468*PER             ADD 1 TO X-AMNIST21                              GJC0009
  7469*PER             ADD 1 TO MESES-AMNIST21                          GJC0009
  7470*PER          END-PERFORM                                         GJC0009
  7471*PER       END-IF                                                 GJC0009
  7472        ELSE                                                      GJC0006
  7473          IF MAYOR-LAPSO-AMNIST21 <                               GJC0006
  7474             LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)                  GJC0006
  7475              MOVE LONG-GRUPO-AMNIST21(LAPSO-AMNIST21) TO         GJC0006
  7476                                    MAYOR-LAPSO-AMNIST21          GJC0006
  7477          END-IF                                                  GJC0006
  7478        END-IF                                                    GJC0006
  7479     ELSE
  7480        MOVE 1 TO SALIR-AMNIST21                                  GJC0006
  7481     END-IF.                                                      GJC0006
  7482
  7483******************************************************************
  7484*200940-PERDONAR-VECTOR-CTA.                                     *
  7485* SE HACE EL PERDOS SOBRE CADA UNO DE LOS LAPSOS DE MORA SOBRE   *
  7486* LOS QUE LA CUENTA TIENE DERECHO A PERDON
  7487******************************************************************
  7488 200940-PERDONAR-VECTOR-CTA.                                      GJC0006
  7489     PERFORM VARYING LAPSO-AMNIST21 FROM 1 BY 1 UNTIL             GJC0006
  7490        LAPSO-AMNIST21 > 30                                       GJC0006
  7491       IF PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21) = 1               GJC0006
  7492          COMPUTE Z-AMNIST21 = INI-GRUPO-AMNIST21(LAPSO-AMNIST21) GJC0006
  7493                             - POSICION-INI-AMNIST21 + 1          GJC0006
  7494          MOVE 0 TO K-AMNIST21                                    GJC0006
  7495          PERFORM VARYING L-AMNIST21 FROM                         GJC0006
  7496            Z-AMNIST21 BY 1 UNTIL                                 GJC0006
  7497                K-AMNIST21 = LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)  GJC0006
  7498            IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5       GJC0006
  7499               MOVE 8 TO VEC-TOT-CTA-AMNIST21(L-AMNIST21)         GJC0006
  7500            END-IF                                                GJC0006
  7501            ADD 1 TO K-AMNIST21                                   GJC0006
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 130
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7502          END-PERFORM                                             GJC0006
  7503       ELSE                                                       GJC0006
  7504          MOVE 51 TO LAPSO-AMNIST21                               GJC0006
  7505       END-IF                                                     GJC0006
  7506     END-PERFORM.                                                 GJC0006
  7507
  7508******************************************************************
  7509*50000-RECONSTRUCCION-HISTORIA.
  7510*VOLTEA LOS VECTORES Y LLAMA A LAS RUTINAS QUE RECALCULAN EL ESTADO
  7511*DEJANDO FINALMENTE LOS VECTORES COMO DEBEN QUEDAR
  7512******************************************************************
  7513 500000-RECONSTRUCCION-HISTORIA.                                  GJC0006
  7514     MOVE 0 TO MES-MORA-MAX-AMNIST21  MES-MORA-MAX-48-AMNIST21.   GJC0006
  7515     INITIALIZE FEC-MORMAX-AMNIST21 FEC-MORMAX-48-AMNIST21.       GJC0006
  7516     MOVE NOV-REPORT-ABD07 TO ESTADO-AMNIST21 ESTADO-FIN-AMNIST21 GJC0006
  7517     MOVE FEC-NOVEDAD-ABD07 TO  FEC-MM-AA-AMNIST21                GJC0006
  7518     IF FEC-MM-AA-AMNIST21 (3:2) > 60                             GJC0006
  7519        MOVE 19 TO SIGLO-AMNIST21                                 GJC0006
  7520     ELSE                                                         GJC0006
  7521        MOVE 20 TO SIGLO-AMNIST21                                 GJC0006
  7522     END-IF                                                       GJC0006
  7523     MOVE FEC-MM-AA-AMNIST21 (1:2)  TO MES-AMNIST21               GJC0006
  7524     MOVE FEC-MM-AA-AMNIST21 (3:2)  TO ANO-AMNIST21               GJC0006
  7525     MOVE FECHA-AMNIST21  TO FEC-INI-MOR-AMNIST21.                GJC0006
  7526     PERFORM 500500-NUEVA-NOVEDAD                                 GJC0006
  7527     PERFORM 500600-CALCULO-FECHAMX                               GJC0006
  7528*    IF (ESTADO-FIN-AMNIST21 = 46 OR ESTADO-FIN-AMNIST21 = 03) ANDGJC0007
  7529*       (MORMAX-AMNIST21 = 0 AND MORMAX48-AMNIST21 = 0)           GJC0007
  7530*       IF ESTADO-FIN-AMNIST21 = 03                               GJC0007
  7531*          MOVE 06 TO NOV-REPORT-ABD07                            GJC0007
  7532*                     NOV-REPORT-R-ABD07                          GJC0007
  7533*       ELSE                                                      GJC0007
  7534*          IF COD-CTA-ABD07 = 02                                  GJC0007
  7535*             MOVE 06 TO NOV-REPORT-ABD07                         GJC0007
  7536*                     NOV-REPORT-R-ABD07                          GJC0007
  7537*          ELSE                                                   GJC0007
  7538*             MOVE 08 TO NOV-REPORT-ABD07                         GJC0007
  7539*                        NOV-REPORT-R-ABD07                       GJC0007
  7540*          END-IF                                                 GJC0007
  7541*     ELSE *> LINEAS CONVERTIDAS EN RUT 555000-MANEJO-RECUP-Y-MM  GJC0007
  7542*       MOVE ESTADO-FIN-AMNIST21 TO NOV-REPORT-ABD07              GJC0012
  7543        MOVE ESTADO-FIN48-AMNIST21 TO NOV-REPORT-R-ABD07          GJC0006
  7544                                      NOV-REPORT-ABD07            GJC0012
  7545*     END-IF                                                      GJC0007
  7546*    MOVE FEC-MORMAX-AMNIST21 TO FECHA-MORA-MAXIMA-ABD07          GJC0006
  7547*    MOVE NUM-MOR30-AMNIST21 TO NUM-MORAS30-ABD07                 GJC0006
  7548     MOVE FEC-MORMAX-48-AMNIST21 TO FECHA-MORA-MAXIMA-ABD07       GJC0006
  7549*    MOVE MORMAX-AMNIST21 TO MORA-MAXIMA-ABD07.                   GJC0006
  7550     MOVE MORMAX48-AMNIST21 TO MORA-MAXIMA-R-ABD07                GJC0006
  7551                               MORA-MAXIMA-ABD07.                 GJC0006
  7552     MOVE NUM-MOR30-48-AMNIST21 TO NUM-MORAS30-ABD07.             GJC0006
  7553  500500-NUEVA-NOVEDAD.
  7554******************************************************************
  7555* 50500-NUEVA-NOVEDAD.
  7556* CON EL VECTOR DE COMPORTAMIENTO PERDONADO Y SEGN LA NOVEDAD
  7557* ACTUAL, CALCULA CON LA MATRIZ DE RECONSTRUCCIN HISTRICA
  7558* LA NUEVA NOVEDAD DE LA OBLIGACIN
  7559******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 131
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7560     MOVE 0 TO NUM-MOR30-AMNIST21  NUM-MOR30-48-AMNIST21          GJC0006
  7561     MOVE 0 TO MORMAX-AMNIST21 MORMAX48-AMNIST21                  GJC0006
  7562     MOVE 0 TO FEC-MORMAX-AMNIST21   FEC-MORMAX-48-AMNIST21       GJC0006
  7563     MOVE 01 TO ESTADO-INI-AMNIST21 ESTADO-INI48-AMNIST21         GJC0006
  7564     PERFORM VARYING L-AMNIST21 FROM 1 BY 1 UNTIL L-AMNIST21 > 49 GJC0006
  7565      MOVE VEC-TOT-CTA-AMNIST21(L-AMNIST21) TO K-AMNIST21         GJC0006
  7566      IF K-AMNIST21 < 5 AND K-AMNIST21 > MORMAX48-AMNIST21        GJC0006
  7567      COMPUTE MES-MORA-MAX-48-AMNIST21 = (49 - L-AMNIST21) + 1    GJC0006
  7568         MOVE K-AMNIST21 TO MORMAX48-AMNIST21                     GJC0006
  7569      END-IF                                                      GJC0006
  7570      IF K-AMNIST21 = 1                                           GJC0006
  7571         ADD 1 TO NUM-MOR30-48-AMNIST21                           GJC0006
  7572      END-IF                                                      GJC0006
  7573      IF L-AMNIST21 > 24                                          GJC0006
  7574       IF K-AMNIST21 = 1                                          GJC0006
  7575          ADD 1 TO NUM-MOR30-AMNIST21                             GJC0006
  7576       END-IF                                                     GJC0006
  7577       IF K-AMNIST21 < 5 AND K-AMNIST21 > MORMAX-AMNIST21         GJC0006
  7578          COMPUTE  MES-MORA-MAX-AMNIST21 = (49 - L-AMNIST21) + 1  GJC0006
  7579          MOVE K-AMNIST21 TO MORMAX-AMNIST21                      GJC0006
  7580       END-IF                                                     GJC0006
  7581      END-IF                                                      GJC0006
  7582       IF L-AMNIST21 = 49                                         GJC0006
  7583          IF (ESTADO-AMNIST21 > 12 AND < 42) OR                   GJC0006
  7584             ESTADO-AMNIST21 = 01                                 GJC0006
  7585             MOVE NOV-CART-MORA-AMNIST21(ESTADO-AMNIST21) TO      GJC0006
  7586             ESTADO-FIN-AMNIST21                                  GJC0006
  7587             MOVE                                                 GJC0006
  7588             NOV-CRUCES-AMNIST21(ESTADO-INI-AMNIST21,             GJC0006
  7589                             ESTADO-FIN-AMNIST21)                 GJC0006
  7590                           TO ESTADO-FIN-AMNIST21                 GJC0006
  7591             MOVE NOV-CART-MORA-AMNIST21(ESTADO-AMNIST21) TO      GJC0006
  7592                  ESTADO-FIN48-AMNIST21                           GJC0006
  7593             MOVE NOV-CRUCES-AMNIST21(ESTADO-INI48-AMNIST21,      GJC0006
  7594                  ESTADO-FIN48-AMNIST21) TO ESTADO-FIN48-AMNIST21 GJC0006
  7595          ELSE                                                    GJC0006
  7596             IF ESTADO-AMNIST21 > 07 AND < 13                     GJC0006
  7597                COMPUTE ESTADO-FIN-AMNIST21 =                     GJC0006
  7598                        08 + MORMAX-AMNIST21                      GJC0006
  7599                COMPUTE ESTADO-FIN48-AMNIST21 =                   GJC0006
  7600                        08 + MORMAX48-AMNIST21                    GJC0006
  7601             ELSE                                                 GJC0006
  7602                MOVE ESTADO-AMNIST21 TO ESTADO-FIN-AMNIST21       GJC0006
  7603                MOVE ESTADO-AMNIST21 TO ESTADO-FIN48-AMNIST21     GJC0006
  7604             END-IF                                               GJC0006
  7605          END-IF                                                  GJC0006
  7606       ELSE                                                       GJC0006
  7607         IF K-AMNIST21 = 7 OR 8                                   GJC0006
  7608            MOVE 5 TO K-AMNIST21                                  GJC0006
  7609         END-IF                                                   GJC0006
  7610         IF K-AMNIST21 > 0 AND K-AMNIST21 < 6                     GJC0006
  7611            MOVE NOV-CRUCES-AMNIST21(ESTADO-INI48-AMNIST21,       GJC0006
  7612                                       K-AMNIST21) TO             GJC0006
  7613                 ESTADO-INI48-AMNIST21                            GJC0006
  7614         END-IF                                                   GJC0006
  7615         IF L-AMNIST21 > 24                                       GJC0006
  7616          IF K-AMNIST21 > 0 AND K-AMNIST21 < 6                    GJC0006
  7617             MOVE NOV-CRUCES-AMNIST21(ESTADO-INI-AMNIST21,        GJC0006
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 132
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7618                 K-AMNIST21) TO ESTADO-INI-AMNIST21               GJC0006
  7619          END-IF                                                  GJC0006
  7620         END-IF                                                   GJC0006
  7621       END-IF                                                     GJC0006
  7622     END-PERFORM.                                                 GJC0006
  7623
  7624******************************************************************
  7625*500600-CALCULO-FECHAMX.
  7626* CON EL VECTOR YA PERDONADO, CALCULA LA NUEVA FECHA DE MORA
  7627* MXIMA
  7628******************************************************************
  7629 500600-CALCULO-FECHAMX.                                          GJC0006
  7630     IF MES-MORA-MAX-AMNIST21 > 0                                 GJC0006
  7631        MOVE FEC-INI-MOR-AMNIST21 TO FECHA-AMNIST21               GJC0006
  7632        MOVE 1 TO L-AMNIST21                                      GJC0006
  7633        PERFORM 510000-ADDUNOTOI UNTIL L-AMNIST21=                GJC0006
  7634                MES-MORA-MAX-AMNIST21                             GJC0006
  7635**SE DEBE CONTROLAR SI L-AMNIST21SE PASA de 25  ******************GJC0006
  7636        MOVE ANO-T-AMNIST21 TO FEC-MM-AAAA-AMNIST21 (3:4)         GJC0006
  7637        MOVE MES-AMNIST21   TO FEC-MM-AAAA-AMNIST21 (1:2)         GJC0006
  7638        MOVE FEC-MM-AAAA-AMNIST21  TO FEC-MORMAX-AMNIST21         GJC0006
  7639     END-IF.                                                      GJC0006
  7640     IF MES-MORA-MAX-48-AMNIST21 > 0                              GJC0006
  7641        MOVE FEC-INI-MOR-AMNIST21 TO FECHA-AMNIST21               GJC0010
  7642        MOVE 1 TO L-AMNIST21                                      GJC0006
  7643        PERFORM 510000-ADDUNOTOI UNTIL L-AMNIST21 =               GJC0006
  7644                                          MES-MORA-MAX-48-AMNIST21GJC0006
  7645        MOVE ANO-T-AMNIST21 TO FEC-MM-AAAA-AMNIST21 (3:4)         GJC0006
  7646        MOVE MES-AMNIST21  TO FEC-MM-AAAA-AMNIST21 (1:2)          GJC0006
  7647        MOVE FEC-MM-AAAA-AMNIST21 TO FEC-MORMAX-48-AMNIST21       GJC0006
  7648     END-IF.                                                      GJC0006
  7649 555000-MANEJO-RECUP-Y-MM.                                        GJC0007
  7650******************************************************************
  7651*555000-MANEJO-RECUP-Y-MM
  7652* SOLO SE DEBE INVOCAR CUANDO UNA CUANTA ES PERDONADA Y SIRVE PARA
  7653* DEJAR UNA CUENTA QUE FUE RECUPERADA O CANCELADA POR MAL MANEJO
  7654* EN PAGO VOLUNTARIO O CANCELADA VOL SI NO QUEDARON MORAS
  7655******************************************************************
  7656     IF (ESTADO-FIN-AMNIST21 = 46 OR ESTADO-FIN-AMNIST21 = 03) ANDGJC0007
  7657        (MORMAX-AMNIST21 = 0 AND MORMAX48-AMNIST21 = 0)           GJC0007
  7658        IF ESTADO-FIN-AMNIST21 = 03                               GJC0007
  7659           MOVE 06 TO NOV-REPORT-ABD07                            GJC0007
  7660                      NOV-REPORT-R-ABD07                          GJC0007
  7661        ELSE                                                      GJC0007
  7662           IF COD-CTA-ABD07 = 02                                  GJC0007
  7663              MOVE 06 TO NOV-REPORT-ABD07                         GJC0007
  7664                      NOV-REPORT-R-ABD07                          GJC0007
  7665           ELSE                                                   GJC0007
  7666              MOVE 08 TO NOV-REPORT-ABD07                         GJC0007
  7667                         NOV-REPORT-R-ABD07                       GJC0007
  7668           END-IF                                                 GJC0007
  7669        END-IF                                                    GJC0007
  7670     END-IF.                                                      GJC0007
  7671********************************************************************
  7672*510000-ADDUNOTOI.
  7673* RETROCEDE UN MES EN EL TIEMPO TENIENDO EN CUENTA EL CAMBIO DE AO
  7674* Y SI LA INFORMACIN VALIDA DEL VECTOR HA TERMINADO, FINALIZA LA
  7675* REVISIN DE CADUCIDAD SOBRE EL VECTOR
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 133
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/AMNISTIA
  7676********************************************************************
  7677 510000-ADDUNOTOI.                                                GJC0006
  7678     ADD 1 TO L-AMNIST21                                          GJC0006
  7679     SUBTRACT 1 FROM MES-AMNIST21                                 GJC0006
  7680     IF MES-AMNIST21 = 0                                          GJC0006
  7681        MOVE 12 TO MES-AMNIST21                                   GJC0006
  7682        SUBTRACT 1 FROM ANO-T-AMNIST21                            GJC0006
  7683     END-IF.                                                      GJC0006
  7684
  7685******************************************************************
  7686*200950-CONVIERTE-FECHA                                          *
  7687* CONVIERTE FECHA DE FORMATO MMYY A YYYYMM                       *
  7688******************************************************************
  7689 200950-CONVIERTE-FECHA.
  7690     MOVE  MES-AUX-AMNIST21   TO  FMILENIO-MES-AMNIST21
  7691     MOVE  ANO-AUX-AMNIST21   TO  FMILENIO-ANIO-AMNIST21
  7692     IF ANO-AUX-AMNIST21   > 60
  7693        MOVE 19               TO  FMILENIO-SIGLO-AMNIST21
  7694     ELSE
  7695        MOVE 20               TO  FMILENIO-SIGLO-AMNIST21
  7696     END-IF
  7697     MOVE  FECHA-MILENIO-AMNIST21  TO  FEC-NOVEDAD-AMNIST21.
* 7698 COPY VALNOM.PROC.
  7699*VALNOM-PROC.v.0005
  7700******************************************************************
  7701* RUTINA CREADA PARA HACER LA VALIDACION DE NOMBRES CONTRA LOS
  7702* ARCHIVOS DE LA REGISTRADURIA, DIAN Y DAS, DEPENDIENDO DEL TIPO
  7703* DE IDENTIFICACION RECIBIDA.
  7704*    PARAMETROS
  7705*        BLOQUES-INPUT-VALNOM - NUMERO DE BLOQUES A VALIDAR
  7706*        NOMBRE-INPUT-VALNOM  - NOMBRE A VALIDAR
  7707*        NOMBOK-INPUT-VALNOM  - NOMBRE CORRECTO CON EL QUE SE
  7708*                               DEBE COMPARAR NOMBRE-INPUT-VALNOM
  7709*        TIP-ID-INPUT-VALNOM  - TIPO DE IDENTIFICACION A VALIDAR
  7710*    SALIDAS:
  7711*        MATCH-OK-OUT-VALNOM  - 0-NO HUBO       1-HUBO
  7712*******************************************************************
  7713* RMB0002   * VAL001: SE MEJORA LA VALIDACION DE NOMBRES EN PERSONAS
  7714* R.MARTINEZ* JURIDICAS
  7715* DIC.2002  *
  7716*******************************************************************
  7717* GJC0003    * VALMEJ :SE CREAN ANUEVOS CAMPOS PARA MEJORAR LA VALIDACION
  7718* G.JIMENEZ  * DE NIT. PARA MEJORA TAMBIEN SE AMPLIA TAMANO DE VARIABLES
  7719* MARZO/2003 * PARA CEDULAS, EL COMODIN QUE USUALMENTE CORRESPONDE A LA N
  7720*            * SOLO SE COMPARA CONTRA N O CONTRA BLANCOS
  7721*************************************************************************
  7722* GJC0004    * VALME1 :CON EL FIN DE AFINAR AUN MAS EL PROCESO DE VALIDA-
  7723* R.MARTINEZ * CION DE NOMBRES, EN EL MATCH A PROXIMADO DE PERSONAS NATU-
  7724* G.JIMENEZ  * RALES SE CAMBIA EL CALCULO FINAL PARA DETERMINAR SI UN BLO-
  7725* MARZO/2003 * QUE ES O NO VALIDO. PARA QUE UN NOMBRE QUE VENGA NUMERICO
  7726*            * NO SE CONVIERTA EN COMODIN, EN LAS SUSTITUCIONES POR *
  7727*            * SE VALIDA QUE EL CONTENIDO NO SEA NUMERICO.
  7728*************************************************************************
  7729* GJC0005    * VLNM01: LOS PROGRAMAS ABORTAN CUANDO ALGUNO DE LOS
  7730* G.JIMENEZ  *         PARAMETROS DE UN SUBSTRING QUEDA EN 0 O EN
  7731* NOV/2005   *         UN NUMERO MENOR QUE 0. EJ: NOMBRE(I:J) DONDE I O
  7732*            *         J ES 0.
  7733*************************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 134
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/VALNOM.P
  7734 10000-MATCH-NOMBRES-VALNOM.
  7735******************************************************************
  7736*10000-MATCH-NOMBRE-VALNOM.
  7737* SE BUSCA DETERMINAR SI EL NOMBRE DE LA PERSONA CONSULTADA HACE
  7738*       CON EL NOMBRE ENVIADO EN LA CONSULTA.
  7739******************************************************************
  7740     MOVE 0 TO MATCH-OK-OUT-VALNOM.
  7741     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
  7742     IF TIP-ID-INPUT-VALNOM  = 2
  7743         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
  7744           " S.A. " BY "      ",                                  RMB0002
  7745           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7746           " LIMITADA " BY "          ",                          RMB0002
  7747           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7748           " INVERSIONES " BY "             ",                    RMB0002
  7749           " EMPRESA " BY "         ",                            RMB0002
  7750           " CORPORACION " BY "             ",                    RMB0002
  7751           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7752           " S " BY "   ", " A " BY "   "                         RMB0002
  7753           " Y " BY "   "                                         GJC0003
  7754         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7755           " S.A. " BY "      ",                                  RMB0002
  7756           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7757           " LIMITADA " BY "          ",                          RMB0002
  7758           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7759           " INVERSIONES " BY "             ",                    RMB0002
  7760           " EMPRESA " BY "         ",                            RMB0002
  7761           " CORPORACION " BY "             ",                    RMB0002
  7762           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7763           " S " BY "   ", " A " BY "   "                         RMB0002
  7764           " Y " BY "   "                                         GJC0003
  7765         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
  7766                "." BY " ","-" BY " ",                            GJC0003
  7767                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7768                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7769         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
  7770                "." BY " ","-" BY " ",                            GJC0003
  7771                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7772                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7773         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
  7774     ELSE
  7775        INSPECT CADENA-VALNOM    REPLACING ALL
  7776                 "." BY " ","-" BY " ", "," BY " ",
  7777                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  7778                "Y" BY "G","H" BY "G","I" BY "G",
  7779                " DE " BY "    "," LA " BY "    ",
  7780                " DEL " BY "     "
  7781        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002
  7782                 "." BY " ","-" BY " ", "," BY " ",
  7783                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      RMB0002
  7784                "Y" BY "G","H" BY "G","I" BY "G",                 RMB0002
  7785                " DE " BY "    "," LA " BY "    ",                RMB0002
  7786                " DEL " BY "     "                                RMB0002
  7787                PERFORM VARYING I-VALNOM FROM 1 BY 1
  7788                        UNTIL I-VALNOM >= 66
  7789                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  7790                      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  7791                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 135
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/VALNOM.P
  7792                  END-IF
  7793                END-PERFORM
  7794     END-IF.
  7795     MOVE SPACES TO VECTOR-INPUT-VALNOM.
  7796     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
  7797                  BASURA-VALNOM
  7798      VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)
  7799      VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)
  7800      VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)
  7801      VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)
  7802      VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)
  7803      VM-INPUT-VALNOM(14)
  7804      VM-INPUT-VALNOM(15)
  7805      VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)
  7806      VM-INPUT-VALNOM(19)
  7807      VM-INPUT-VALNOM(20)
  7808******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********
  7809     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
  7810     IF TIP-ID-INPUT-VALNOM  NOT = 2
  7811        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
  7812                 "." BY " ","-" BY " ","," BY " ",
  7813                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  7814                "Y" BY "G","H" BY "G","I" BY "G"
  7815                PERFORM VARYING I-VALNOM FROM 1 BY 1
  7816                        UNTIL I-VALNOM >= 66
  7817                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  7818                      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  7819                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
  7820                  END-IF
  7821                END-PERFORM
  7822     ELSE
  7823         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7824           " S.A. " BY "      ",                                  RMB0002
  7825           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7826           " LIMITADA " BY "          ",                          RMB0002
  7827           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7828           " INVERSIONES " BY "             ",                    RMB0002
  7829           " EMPRESA " BY "         ",                            RMB0002
  7830           " CORPORACION " BY "             ",                    RMB0002
  7831           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7832           " S " BY "   ", " A " BY "   "                         RMB0002
  7833           " Y " BY "   "                                         GJC0003
  7834         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7835           " S.A. " BY "      ",                                  RMB0002
  7836           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7837           " LIMITADA " BY "          ",                          RMB0002
  7838           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7839           " INVERSIONES " BY "             ",                    RMB0002
  7840           " EMPRESA " BY "         ",                            RMB0002
  7841           " CORPORACION " BY "             ",                    RMB0002
  7842           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7843           " S " BY "   ", " A " BY "   "                         RMB0002
  7844           " Y " BY "   "                                         GJC0003
  7845        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003
  7846                "." BY " ","-" BY " ",                            GJC0003
  7847                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7848                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7849         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 136
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/VALNOM.P
  7850     END-IF.
  7851     MOVE SPACES TO VECTOR-OK-VALNOM.
  7852     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
  7853                  BASURA-VALNOM
  7854      VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)
  7855      VM-OK-VALNOM(4) VM-OK-VALNOM(5)
  7856      VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)
  7857      VM-OK-VALNOM(9) VM-OK-VALNOM(10)
  7858      VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)
  7859      VM-OK-VALNOM(14) VM-OK-VALNOM(15)
  7860      VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)
  7861      VM-OK-VALNOM(19) VM-OK-VALNOM(20).
  7862***********HACE LA VALIDACION BLOQUE A BLOQUE********************
  7863     MOVE 1 TO I-VALNOM.
  7864     MOVE 0 TO BLOQOK-AUX-VALNOM.
  7865     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES
  7866       MOVE 1 TO J-VALNOM
  7867       PERFORM UNTIL J-VALNOM > 20
  7868         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)
  7869            ADD 1 TO BLOQOK-AUX-VALNOM
  7870            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  7871                           VM-INPUT-VALNOM(I-VALNOM)
  7872            MOVE 21 TO J-VALNOM
  7873         ELSE
  7874            MOVE 0 TO M-VALNOM
  7875            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
  7876                    FOR CHARACTERS BEFORE INITIAL "*"
  7877            IF M-VALNOM >= 15
  7878               MOVE 0 TO M-VALNOM
  7879               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
  7880                    FOR CHARACTERS BEFORE INITIAL "N"
  7881            END-IF
  7882            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20
  7883               AND (14 - M-VALNOM > 0)                            GJC0005
  7884               COMPUTE INI-VALNOM = M-VALNOM + 2
  7885               COMPUTE LON-VALNOM = 14 - M-VALNOM
  7886               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM
  7887               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =
  7888                  VM-INPUT-VALNOM(I-VALNOM + 1 ) AND
  7889                  PEDAZO-VALNOM(1:M-VALNOM) =
  7890                  VM-INPUT-VALNOM(I-VALNOM)
  7891                  ADD 1 TO BLOQOK-AUX-VALNOM
  7892                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  7893                           VM-INPUT-VALNOM(I-VALNOM)
  7894                  MOVE 21 TO J-VALNOM
  7895                  ADD 1 TO I-VALNOM
  7896                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)
  7897               END-IF
  7898            END-IF
  7899         END-IF
  7900         ADD 1 TO J-VALNOM
  7901       END-PERFORM
  7902       ADD 1 TO I-VALNOM
  7903       IF I-VALNOM = 21
  7904          NEXT SENTENCE
  7905       END-IF
  7906     END-PERFORM.
  7907     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 137
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/VALNOM.P
  7908        MOVE 1 TO MATCH-OK-OUT-VALNOM
  7909     ELSE
  7910        IF TIP-ID-INPUT-VALNOM <> 2
  7911           PERFORM 10100-MATCH-APROXIMADO
  7912        ELSE
  7913           PERFORM 10100-MATCH-APROX-EMPRESAS
  7914        END-IF
  7915        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
  7916           MOVE 1 TO MATCH-OK-OUT-VALNOM
  7917        END-IF
  7918     END-IF.
  7919**********************************************************************
  7920*10100-MATCH-APROXIMADO.
  7921*     EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS
  7922*     CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON
  7923*     LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.
  7924**********************************************************************
  7925 10100-MATCH-APROXIMADO.
  7926     IF BLOQOK-AUX-VALNOM > 0
  7927        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM
  7928     ELSE
  7929        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM
  7930     END-IF
  7931     MOVE 1 TO I-VALNOM.
  7932     PERFORM UNTIL I-VALNOM > 10
  7933       MOVE 1 TO J-VALNOM
  7934       PERFORM UNTIL J-VALNOM > 10
  7935         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM
  7936         MOVE 1 TO K-VALNOM
  7937         MOVE 1 TO L-VALNOM
  7938         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND
  7939            VM-OK-VALNOM   (J-VALNOM) NOT = SPACES
  7940            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
  7941              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7942                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)
  7943                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"    GJC0003
  7944                 AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003
  7945                      OR = "N"))                                  GJC0003
  7946                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES
  7947                    ADD 1 TO LETRAS-OK-VALNOM
  7948                    ADD 1 TO K-VALNOM
  7949                    ADD 1 TO L-VALNOM
  7950                 ELSE
  7951                    MOVE 19 TO K-VALNOM
  7952                 END-IF
  7953              ELSE
  7954                 ADD 1   TO K-VALNOM
  7955                 IF K-VALNOM <= 15 AND L-VALNOM < 15
  7956                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =
  7957                       VMM-OK-VALNOM(J-VALNOM,K-VALNOM )
  7958                       ADD 1 TO L-VALNOM
  7959                    END-IF
  7960                 END-IF
  7961              END-IF
  7962            END-PERFORM
  7963            MOVE 1 TO K-VALNOM
  7964            MOVE 1 TO L-VALNOM
  7965            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 138
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/VALNOM.P
  7966              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7967                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)
  7968                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"    GJC0003
  7969                 AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003
  7970                      OR = "N"))                                  GJC0003
  7971                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES
  7972                    ADD 1 TO LETRAS-OK2-VALNOM
  7973                    ADD 1 TO K-VALNOM
  7974                    ADD 1 TO L-VALNOM
  7975                 ELSE
  7976                    MOVE 19 TO K-VALNOM
  7977                 END-IF
  7978              ELSE
  7979                 ADD 1   TO L-VALNOM
  7980                 IF L-VALNOM <= 15 AND K-VALNOM < 15
  7981                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7982                       VMM-OK-VALNOM(J-VALNOM,K-VALNOM + 1)
  7983                       ADD 1 TO K-VALNOM
  7984                    END-IF
  7985                 END-IF
  7986              END-IF
  7987            END-PERFORM
  7988         END-IF
  7989         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM
  7990            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM
  7991         END-IF
  7992         IF LETRAS-OK-VALNOM > 0
  7993            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM
  7994            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING
  7995                    TOTLET-INP-VALNOM
  7996                    FOR CHARACTERS BEFORE INITIAL " "
  7997            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING
  7998                    TOTLET-OK-VALNOM
  7999                    FOR CHARACTERS BEFORE INITIAL " "
  8000            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM
  8001            IF TOTLET-OK-VALNOM >= 3
  8002               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /
  8003                                       TOTLET-OK-VALNOM
  8004            END-IF
  8005            IF TOTLET-INP-VALNOM >= 3
  8006               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /
  8007                                       TOTLET-INP-VALNOM
  8008            END-IF
  8009            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM
  8010               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /
  8011                                 TOTLET-OK-VALNOM
  8012            ELSE
  8013               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /
  8014                                 TOTLET-INP-VALNOM
  8015            END-IF
  8016            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=
  8017                                  APROX-TOT-VALNOM) AND
  8018                 A-VALNOM >= 63
  8019****   display "%TOT=",POR-TOT-VALNOM, " %INP=", POR-INP-VALNOM,
  8020****           "A-VALNOM=", A-VALNOM
  8021*****       IF (POR-TOT-VALNOM >= APROX-TOT-VALNOM AND
  8022*****           POR-INP-VALNOM >= APROX-INP-VALNOM ) OR
  8023*****          ((POR-TOT-VALNOM >= APROX-TOT-VALNOM OR
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 139
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/VALNOM.P
  8024*****            POR-INP-VALNOM >= APROX-INP-VALNOM ) AND
  8025*****            A-VALNOM >= 70)
  8026               ADD 1 TO BLOQOK-AUX-VALNOM
  8027               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  8028                           VM-INPUT-VALNOM(I-VALNOM)
  8029            END-IF
  8030         END-IF
  8031         ADD 1 TO J-VALNOM
  8032       END-PERFORM
  8033       ADD 1 TO I-VALNOM
  8034     END-PERFORM.
  8035**********************************************************************
  8036*10100-MATCH-APROX-EMPRESAS
  8037*     EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS
  8038*     CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON
  8039*     LOS TIPOS DE IDENTIFICACION 2.
  8040**********************************************************************
  8041 10100-MATCH-APROX-EMPRESAS.
  8042   MOVE ZEROS TO TOTLET-INP-VALNOM
  8043   MOVE ZEROS TO LETRAS-OK2-VALNOM
  8044    MOVE ZEROS TO A-VALNOM                                        GJC0003
  8045   MOVE 1 TO K-VALNOM
  8046   PERFORM UNTIL K-VALNOM > 65
  8047     MOVE K-VALNOM  TO I-VALNOM
  8048     MOVE 1       TO J-VALNOM
  8049     MOVE ZEROS TO LETRAS-OK-VALNOM
  8050     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65
  8051        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
  8052           V-NOMBRE-VALNOM(I-VALNOM) <> "."
  8053           IF V-NOMBRE-VALNOM(I-VALNOM) =
  8054              V-NOMBOK-VALNOM(J-VALNOM)
  8055              ADD 1 TO LETRAS-OK-VALNOM
  8056              ADD 1 TO I-VALNOM
  8057              ADD 1 TO J-VALNOM
  8058           ELSE
  8059              ADD 1 TO J-VALNOM
  8060           END-IF
  8061        ELSE
  8062           ADD 1 TO I-VALNOM
  8063        END-IF
  8064     END-PERFORM
  8065     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM
  8066        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM
  8067     END-IF
  8068     ADD 1 TO K-VALNOM
  8069   END-PERFORM.
  8070   MOVE 1 TO I-VALNOM
  8071   PERFORM UNTIL I-VALNOM > 65
  8072     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
  8073        V-NOMBRE-VALNOM(I-VALNOM) <> "."
  8074        ADD 1 TO TOTLET-INP-VALNOM
  8075     END-IF
  8076     ADD 1 TO I-VALNOM
  8077   END-PERFORM.
  8078   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /
  8079                     TOTLET-INP-VALNOM.
  8080   IF A-VALNOM >= 75
  8081       ADD 1 TO BLOQOK-AUX-VALNOM
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 140
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/VALNOM.P
  8082   END-IF.
  8083    MOVE 0 TO K-VALNOM                                            GJC0003
  8084   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003
  8085      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003
  8086      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003
  8087               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003
  8088                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003
  8089                   TO I-VALNOM                                    GJC0003
  8090                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003
  8091              END-IF                                              GJC0003
  8092               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003
  8093                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003
  8094                    TO I-VALNOM                                   GJC0003
  8095                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003
  8096              END-IF                                              GJC0003
  8097      END-PERFORM                                                 GJC0003
  8098      MOVE 0 TO I-VALNOM                                          GJC0003
  8099       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003
  8100         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003
  8101            ADD 1 TO I-VALNOM                                     GJC0003
  8102            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003
  8103               CONT-LET-INPUT-VALNOM(J-VALNOM)                    GJC0003
  8104               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003
  8105            ELSE                                                  GJC0003
  8106               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003
  8107                                  (CONT-LET-INPUT-VALNOM(J-VALNOM)GJC0003
  8108                           *  100 /CONT-LET-OK-VALNOM(J-VALNOM))  GJC0003
  8109            END-IF                                                GJC0003
  8110         END-IF                                                   GJC0003
  8111      END-PERFORM                                                 GJC0003
  8112      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003
  8113       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003
  8114         ((A-VALNOM >= 35 AND A-VALNOM < 40) AND K-VALNOM > 85) ORGJC0003
  8115         ((A-VALNOM >= 25 AND A-VALNOM < 35) AND K-VALNOM = 100)  GJC0003
  8116         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003
  8117       END-IF                                                     GJC0003
  8118   END-IF.                                                        GJC0003
  8119
  8120 0500-ASIGNA-ID-ICMCRE-START.
  8121******************************************************************
  8122*0500-ASIGNA-ID-ICMCRE-START.
  8123******************************************************************
  8124        MOVE TIPO-ID-ABD07 TO TIPO-ID-LEEMSTRS
  8125        MOVE NUM-ID-ABD07  TO NRO-ID-LEEMSTRS.
  8126
  8127 0600-ASIGNA-ID-ICMCHK-START.
  8128******************************************************************
  8129*0600-ASIGNA-ID-ICMCHK-START.
  8130******************************************************************
  8131        MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRS
  8132        MOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.
  8133
  8134 1000-LEE-ICMCRE-SECUENCIAL.
  8135******************************************************************
  8136*1000-LEE-ICMCRE-SECUENCIAL.
  8137*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
  8138*    ARCHIVO:
  8139*    SW-LECTURA-MAESTROS  0: LECTURA OK
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 141
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/LEEMAEST
  8140*                         1: LECTURA CON ERROR O FIN ARCHIVO
  8141* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
  8142* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
  8143******************************************************************
  8144     MOVE 0 TO SW-LECTURA-MAESTROS
  8145     READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT END
  8146          MOVE 1 TO SW-LECTURA-MAESTROS
  8147     END-READ
  8148     IF SW-LECTURA-MAESTROS = 0
  8149      IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS AND
  8150          NUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR
  8151          (TIPO-ID-LEEMSTRS = ZEROS AND
  8152           NRO-ID-LEEMSTRS  = ZEROS)
  8153$       IF HACERMATCH = "SI"
  8154          IF HACERMATCH-LEEMSTRS = 1
  8155           IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS OR
  8156              NUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRS
  8157              MOVE 0 TO IDE-TIPO-BDAMATCH
  8158              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8159              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8160              IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  AND           GJC0004
  8161                                 CONSECUTIVO-ABD07 = 01           GJC0004
  8162                 PERFORM 7000-GUARDAR-REG-INICIALES
  8163                 MOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCH
  8164                 MOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCH
  8165                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8166                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8167                 MOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRS
  8168                 MOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRS
  8169              END-IF
  8170           END-IF
  8171          END-IF
  8172$       END
  8173        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8174           IF COD-SUS-ABD07 = 020050 OR 030050 OR                 GJC0003
  8175                              050050 OR 130050                    GJC0003
  8176              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0003
  8177           END-IF                                                 GJC0003
  8178        END-IF                                                    GJC0003
  8179$       IF AMNISTIA21 = "SI"
  8180           IF AMNISTIA21-LEEMSTRS = 1
  8181              PERFORM 200700-AMNISTIA-CLIENTES
  8182* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
  8183* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
  8184              IF SW-ELIMINA-BBVA-LEEMSTRS = 1                     GJC0003
  8185                 IF COD-SUS-ABD07 = 020050 OR 030050 OR           GJC0003
  8186                                    050050 OR 130050              GJC0003
  8187                    MOVE 4 TO IND-BLOQUEO-ABD07                   GJC0003
  8188                 END-IF                                           GJC0003
  8189              END-IF                                              GJC0003
  8190           END-IF
  8191           IF SW-ART13-AMNIST21 = 1                               GJC0002
  8192              IF IDE-TIPO-BDAMATCH = 1                            GJC0002
  8193                 IF HACERMATCH-LEEMSTRS = 1                       GJC0002
  8194                    PERFORM 8000-U-VER-CTAABD07-BDAMATCH          GJC0002
  8195                 END-IF                                           GJC0002
  8196              END-IF                                              GJC0002
  8197              PERFORM 200900-APLICAR-ART13-REGISTRO               GJC0002
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 142
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/LEEMAEST
  8198           END-IF                                                 GJC0002
  8199$       END
  8200        IF SW-AMNIST21 = 1
  8201           IF IDE-TIPO-BDAMATCH = 1                               GJC0002
  8202              IF HACERMATCH-LEEMSTRS = 1                          GJC0002
  8203                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH             GJC0002
  8204              END-IF                                              GJC0002
  8205           END-IF                                                 GJC0002
  8206           IF AMNISTIA21-LEEMSTRS = 1                             GJC0002
  8207              PERFORM 200850-AMNISTIA-REGISTROS                   GJC0002
  8208*             ELSE                                                GJC0002
  8209*                PERFORM 200850-AMNISTIA-REGISTROS                GJC0002
  8210*             END-IF                                              GJC0002
  8211           END-IF
  8212        ELSE
  8213           IF IDE-TIPO-BDAMATCH = 1
  8214              IF HACERMATCH-LEEMSTRS = 1
  8215                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  8216              END-IF
  8217           END-IF
  8218        END-IF
  8219
  8220      END-IF
  8221      IF SW-NOV-48-LEEMSTRS = 0  *>                               GJC0002
  8222         MOVE ZEROS TO VECTOR-HIS-3-ABD07                         GJC0002
  8223                       VECTOR-HIS-4-ABD07                         GJC0002
  8224           MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21       GJC0002
  8225           MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21       GJC0002
  8226           MOVE ZEROS TO VECTOR-3-CTA-AMNIST21                    GJC0002
  8227           MOVE ZEROS TO VECTOR-4-CTA-AMNIST21                    GJC0002
  8228     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0002
  8229          MOR-EST-CTA-AMNIST21                                    GJC0002
  8230        PERFORM 500000-RECONSTRUCCION-HISTORIA                    GJC0002
  8231      END-IF                                                      GJC0002
  8232     END-IF.
  8233     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8234
  8235 2000-LEE-ICMCRE-DINAMICO.
  8236******************************************************************
  8237*2000-LEE-ICMCRE-DINAMICO.
  8238*    LEEE MAESTRO ICMCRE EN FORMA DIMANICA Y VALIDA EL INVALID KEY
  8239*    DEL ARCHIVO:
  8240*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8241*                         1: LECTURA CON ERROR
  8242******************************************************************
  8243     MOVE 0 TO SW-LECTURA-MAESTROS
  8244     READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY
  8245          MOVE 1 TO SW-LECTURA-MAESTROS
  8246     END-READ
  8247     IF SW-LECTURA-MAESTROS = 0
  8248$       IF HACERMATCH = "SI"
  8249          IF HACERMATCH-LEEMSTRS = 1
  8250           IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS OR
  8251              NUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRS
  8252              MOVE 0 TO IDE-TIPO-BDAMATCH
  8253              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8254              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8255              IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  AND           GJC0004
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 143
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/LEEMAEST
  8256                                 CONSECUTIVO-ABD07 = 01           GJC0004
  8257                 PERFORM 7000-GUARDAR-REG-INICIALES
  8258                 MOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCH
  8259                 MOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCH
  8260                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8261                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8262                 MOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRS
  8263                 MOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRS
  8264              END-IF
  8265           END-IF
  8266         END-IF
  8267$       END
  8268        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8269           IF COD-SUS-ABD07 = 020050 OR 030050 OR                 GJC0003
  8270                              050050 OR 130050                    GJC0003
  8271              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0003
  8272           END-IF                                                 GJC0003
  8273        END-IF                                                    GJC0003
  8274$       IF AMNISTIA21 = "SI"
  8275           IF AMNISTIA21-LEEMSTRS = 1
  8276              PERFORM 200700-AMNISTIA-CLIENTES
  8277* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
  8278* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
  8279              IF SW-ELIMINA-BBVA-LEEMSTRS = 1                     GJC0003
  8280                 IF COD-SUS-ABD07 = 020050 OR 030050 OR           GJC0003
  8281                                    050050 OR 130050              GJC0003
  8282                    MOVE 4 TO IND-BLOQUEO-ABD07                   GJC0003
  8283                 END-IF                                           GJC0003
  8284              END-IF                                              GJC0003
  8285           END-IF
  8286           IF SW-ART13-AMNIST21 = 1                               GJC0002
  8287              IF IDE-TIPO-BDAMATCH = 1                            GJC0002
  8288                 IF HACERMATCH-LEEMSTRS = 1                       GJC0002
  8289                    PERFORM 8000-U-VER-CTAABD07-BDAMATCH          GJC0002
  8290                 END-IF                                           GJC0002
  8291              END-IF                                              GJC0002
  8292              PERFORM 200900-APLICAR-ART13-REGISTRO               GJC0002
  8293           END-IF                                                 GJC0002
  8294$       END
  8295        IF SW-AMNIST21 = 1
  8296           IF IDE-TIPO-BDAMATCH = 1                               GJC0002
  8297              IF HACERMATCH-LEEMSTRS = 1                          GJC0002
  8298                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH             GJC0002
  8299              END-IF                                              GJC0002
  8300           END-IF                                                 GJC0002
  8301           IF AMNISTIA21-LEEMSTRS = 1                             GJC0002
  8302              PERFORM 200850-AMNISTIA-REGISTROS                   GJC0002
  8303*             ELSE                                                GJC0002
  8304*                PERFORM 200850-AMNISTIA-REGISTROS                GJC0002
  8305*             END-IF                                              GJC0002
  8306           END-IF
  8307        ELSE
  8308           IF IDE-TIPO-BDAMATCH = 1
  8309              IF HACERMATCH-LEEMSTRS = 1
  8310                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  8311              END-IF
  8312           END-IF
  8313        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 144
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/LEEMAEST
  8314        IF SW-NOV-48-LEEMSTRS = 0                                 GJC0002
  8315           MOVE ZEROS TO VECTOR-HIS-3-ABD07                       GJC0002
  8316                       VECTOR-HIS-4-ABD07                         GJC0002
  8317           MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21       GJC0002
  8318           MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21       GJC0002
  8319           MOVE ZEROS TO VECTOR-3-CTA-AMNIST21                    GJC0002
  8320           MOVE ZEROS TO VECTOR-4-CTA-AMNIST21                    GJC0002
  8321     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0002
  8322          MOR-EST-CTA-AMNIST21                                    GJC0002
  8323          PERFORM 500000-RECONSTRUCCION-HISTORIA                  GJC0002
  8324        END-IF                                                    GJC0002
  8325     END-IF.
  8326     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8327
  8328 3000-LEE-ICMCHK-SECUENCIAL.
  8329******************************************************************
  8330*3000-LEE-ICMCHK-SECUENCIAL.
  8331*    LEEE MAESTRO ICMCHK EN FORMA SECUENCIAL Y VALIDA EL FIN DE
  8332*    ARCHIVO:
  8333*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8334*                         1: LECTURA CON ERROR O FIN ARCHIVO
  8335******************************************************************
  8336     MOVE 0 TO SW-LECTURA-MAESTROS
  8337     READ MAESTRO-CHECK NEXT RECORD IGNORE LOCK AT END
  8338          MOVE 1 TO SW-LECTURA-MAESTROS
  8339     END-READ
  8340     IF SW-LECTURA-MAESTROS = 0
  8341      IF (TIPO-ID-ABD06 = TIPO-ID-LEEMSTRS AND
  8342          NUM-ID-ABD06  = NRO-ID-LEEMSTRS) OR
  8343          (TIPO-ID-LEEMSTRS = ZEROS AND
  8344           NRO-ID-LEEMSTRS  = ZEROS)
  8345$       IF HACERMATCH = "SI"
  8346          IF HACERMATCH-LEEMSTRS = 1
  8347           IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS OR
  8348              NUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRS
  8349              MOVE 0 TO IDE-TIPO-BDAMATCH
  8350              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8351              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8352              IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  AND           GJC0004
  8353                                 CONSECUTIVO-ABD06 = 01           GJC0004
  8354                 PERFORM 7000-GUARDAR-REG-INICIALES
  8355                 MOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCH
  8356                 MOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCH
  8357                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8358                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8359                 MOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRS
  8360                 MOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRS
  8361              END-IF
  8362           END-IF
  8363           IF IDE-TIPO-BDAMATCH = 1
  8364              IF HACERMATCH-LEEMSTRS = 1
  8365                 PERFORM 8000-U-VER-CTAABD06-BDAMATCH
  8366              END-IF
  8367           END-IF
  8368          END-IF
  8369$       END
  8370        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8371           IF COD-SUS-ABD06 = 010050                              GJC0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 145
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/LEEMAEST
  8372              MOVE 4 TO IND-BLOQUEO-ABD06                         GJC0003
  8373           END-IF                                                 GJC0003
  8374        END-IF                                                    GJC0003
  8375        ADD 0 TO SW-LECTURA-MAESTROS
  8376      END-IF
  8377     END-IF.
  8378     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8379
  8380 4000-LEE-ICMCHK-DINAMICO.
  8381******************************************************************
  8382*4000-LEE-ICMCHK-DINAMICO.
  8383*    LEEE MAESTRO ICMCHK EN FORMA DIMANICA Y VALIDA EL INVALID KEY
  8384*    DEL ARCHIVO:
  8385*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8386*                         1: LECTURA CON ERROR
  8387******************************************************************
  8388     MOVE 0 TO SW-LECTURA-MAESTROS
  8389     READ MAESTRO-CHECK IGNORE LOCK INVALID KEY
  8390          MOVE 1 TO SW-LECTURA-MAESTROS
  8391     END-READ
  8392     IF SW-LECTURA-MAESTROS = 0
  8393$       IF HACERMATCH = "SI"
  8394          IF HACERMATCH-LEEMSTRS = 1
  8395           IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS OR
  8396              NUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRS
  8397              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8398              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8399              MOVE 0 TO IDE-TIPO-BDAMATCH
  8400              IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  AND           GJC0004
  8401                                 CONSECUTIVO-ABD06 = 01           GJC0004
  8402                 PERFORM 7000-GUARDAR-REG-INICIALES
  8403                 MOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCH
  8404                 MOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCH
  8405                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8406                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8407                 MOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRS
  8408                 MOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRS
  8409              END-IF
  8410           END-IF
  8411           IF IDE-TIPO-BDAMATCH = 1
  8412              IF HACERMATCH-LEEMSTRS = 1
  8413                 PERFORM 8000-U-VER-CTAABD06-BDAMATCH
  8414              END-IF
  8415           END-IF
  8416          END-IF
  8417$       END
  8418        ADD 0 TO SW-LECTURA-MAESTROS
  8419        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8420           IF COD-SUS-ABD06 = 010050                              GJC0003
  8421              MOVE 4 TO IND-BLOQUEO-ABD06                         GJC0003
  8422           END-IF                                                 GJC0003
  8423        END-IF                                                    GJC0003
  8424     END-IF.
  8425     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8426
  8427 7000-GUARDAR-REG-INICIALES.
  8428******************************************************************
  8429*7000-GUARDAR-REGISTROS-INICIALES.
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 146
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/LEEMAEST
  8430*    GUARDA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES DE
  8431*    EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR
  8432******************************************************************
  8433      MOVE SPACES TO REG-ICMCRE-LEEMSTRS REG-ICMCHK-LEEMSTRS
  8434                     REG-ICBSUS-LEEMSTRS REG-ICBDIR-LEEMSTRS
  8435      MOVE COMPLETO-ABD07  TO REG-ICMCRE-LEEMSTRS
  8436      MOVE COMPLETO-ABD06  TO REG-ICMCHK-LEEMSTRS
  8437      MOVE REG-SUSCRIPTOR  TO REG-ICBSUS-LEEMSTRS
  8438      MOVE REG-DIRECC      TO REG-ICBDIR-LEEMSTRS.
  8439
  8440 8000-RECUPERAR-REG-INICIALES.
  8441******************************************************************
  8442*8000-RECUPERA-REGISTROS-INICIALES.
  8443*    RECUPERA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES
  8444*    DE EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR
  8445******************************************************************
  8446      IF COMPLETO-ABD07  <> REG-ICMCRE-LEEMSTRS AND
  8447         REG-ICMCRE-LEEMSTRS <> SPACES
  8448         MOVE REG-ICMCRE-LEEMSTRS TO COMPLETO-ABD07
  8449         START MAESTRO-CREDIT KEY = LLAVE-MAES-CREDIT
  8450               NOT INVALID KEY
  8451               READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCK
  8452               END-READ
  8453         END-START
  8454      END-IF
  8455      IF COMPLETO-ABD06  <> REG-ICMCHK-LEEMSTRS AND
  8456         REG-ICMCHK-LEEMSTRS <> SPACES
  8457         MOVE REG-ICMCHK-LEEMSTRS TO COMPLETO-ABD06
  8458         START MAESTRO-CHECK  KEY = LLAVE-MAES-CHECK
  8459               NOT INVALID KEY
  8460               READ MAESTRO-CHECK NEXT RECORD IGNORE LOCK
  8461               END-READ
  8462         END-START
  8463      END-IF
  8464      IF REG-SUSCRIPTOR  <> REG-ICBSUS-LEEMSTRS AND
  8465         REG-ICBSUS-LEEMSTRS <> SPACES
  8466         MOVE REG-ICBSUS-LEEMSTRS TO REG-SUSCRIPTOR
  8467         START SUSCRIPTOR KEY = LLAVE-SUSCRIP
  8468               NOT INVALID KEY
  8469               READ SUSCRIPTOR NEXT RECORD IGNORE LOCK
  8470               END-READ
  8471         END-START
  8472      END-IF
  8473      IF REG-DIRECC      <> REG-ICBDIR-LEEMSTRS AND
  8474         REG-ICBDIR-LEEMSTRS <> SPACES
  8475         MOVE REG-ICBDIR-LEEMSTRS TO REG-DIRECC
  8476         START MAESTRO-DIRECC KEY = LLAVE-DIRECC
  8477               NOT INVALID KEY
  8478               READ MAESTRO-DIRECC NEXT RECORD IGNORE LOCK
  8479               END-READ
  8480         END-START
  8481      END-IF.
  8482*COPY BDLDIR.PROC.
* 8483 COPY BDLDI2.PROC.
  8484*BDLDI2.PROC.v.0041
  8485$SET CONSTANT HACERMATCH"NO"                                      RMB0013
  8486$IF HACERMATCH = "SI"                                             RMB0013
  8487$DISPLAY ".............COMPILANDO BDLDI2 CON MATCH **********     RMB0013
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 147
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8488$ELSE                                                             RMB0013
  8489$DISPLAY ".............COMPILANDO BDLDI2 SIN MATCH **********     RMB0013
  8490$END                                                              RMB0013
  8491******************************************************************
  8492* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS
  8493* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.
  8494*    2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO
  8495*    2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL
  8496*                            REGISTRO DIRECC .
  8497*    2017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE
  8498*                              ORDENAN DE ACUERDO A LO DEFINIDO
  8499*    2017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE
  8500*                              ORDENAN DE ACUERDO A LO DEFINIDO
  8501*    06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS
  8502*                                  DE ESTANDARIZACION DE NOMBRES DE
  8503*                                  COMPONENTES DE LAS DIRECCIONES
  8504*    6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO
  8505*                               A LAS TABLAS DE SINONIMOS LEIDA.
  8506*******************************************************************
  8507* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS
  8508* FEB-15-2003  *          PROBABLE AUMENTANDO UN PESO CON BASE A LA
  8509* R.MARTINEZ   *          CONFORMACION DE LA DIRECCION O DEL TELEFONO
  8510*******************************************************************
  8511* RMB0003      * DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOS
  8512* MAR-15-2003  *          PERMISOS DE ACCESO A LA BASE DE DATOS DE
  8513* R.MARTINEZ   *          DIRECCIONES
  8514*******************************************************************
  8515* RMB0004      * VEC001 - SE CORRIGE PROBLEMA EN EL VECTOR DE TELE
  8516* ABR-15-2003  *          FONOS YA QUE USABA LA FECHA DE DIRECCIONES
  8517* R.MARTINEZ   *          Y NO LA V-FECHATEL
  8518*******************************************************************
  8519* RMB0005      * UBI001 - SE CORRIGE PROBLEMA DE REFLEGAR EN EL
  8520* ABR-15-2003  *          INFORME LA MISMA DIRECCION COMO R,L,C DIF-
  8521* R.MARTINEZ   *          ENTE EN DETALLE Y RESUMEN
  8522*******************************************************************
  8523* VHF0006      * ESTAN1 - SE PERMITE QUE LAS PARTICULAS PARA
  8524* MAY-27-2003  *          ESTANDARIZAR SEAN DE HASTA 30 CARACTERES
  8525* V.FORERO     *
  8526*******************************************************************
  8527* RMB0007     * VALPRI- SE ARREGLA PROBLEMA DE SACAR TIPO-5 SI   *
  8528* R.MARTINEZ  *         LA PERSONA TENIA SOLO UNA CUENTA Y ESTABA*
  8529* MAR.13/2003 *         BLOQUEADA                                *
  8530******************************************************************
  8531* RMB0008     * VEC002- SE CORRIGE PROBLEMA ADICIONAL EN EL VECTO*
  8532* R.MARTINEZ  *         R DE TELEFONOS AL USAR LA FECHA DE LA    *
  8533* JUNIO /2003 *         DIRECCION                                *
  8534******************************************************************
  8535* FAC0009     * AMPDIR * AMPLIACIN DE LA ESTRUCTURA DE ARCHIVO  *
  8536* F.CUADROS C.*          ICBDIR. SE AMPLIAN LOS TAMAOS DE CAMPOS*
  8537* FEB.14/2006 *          TELFONOS, DIRECCIONES, CIUDADES, DPTOS.*
  8538*             * DOMICI - SEAL PARA MATCH DE DOMICILIACION
  8540* RMB0010     * RCNCER - OPTIMIZACION PARA PRODUCTO RECONOCER. SE*
  8541* R.MARTINEZ  *          INCLUYO ESTANDARIZACION DE CIUDADES CON *
  8542* JUN.15/2006 *          BASE EN ARCHIVO DE ESTANDARIZACION DE   *
  8543*             *          CIUDADES DE OUTSOURCING DE DOCUMENTOS,  *
  8544*             *          SE ADICIONARON NUEVAS PARTICULAS        *
  8545*             *          ESTANDARIZADAS PARA DIRECCIONES, SE     *
  8546*             *          OPTIMIZO ALGORITMO PAR SELECCION DE     *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 148
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8547*             *          TELEFONOS Y SE ADICIONARON LOS CONCEPTOS*
  8548*             *          DE DIRECCIONES CERTIFICADAS Y PUNTOS    *
  8549*             *          ADICIONALES (PARA GEOREFERENCIACION)    *
  8550******************************************************************
  8551* GJC0011     * NWDIRB - SE INCLUYE RUTINA EN LA QUE PARA LAS DI-*
  8552* G.JIMENEZ   *          RECCIONES DE BOGOTA IDENTIFICA SI EXIS- *
  8553* FEBRERO/2007*          TE NUEVA NOMENCLATURA                   *
  8554******************************************************************
  8555* RMB0012     * DIRB02 - SE ELIMINA LLENADO INOFICIOSO DE LA    -*
  8556* G.JIMENEZ   *          LLAVE DEL ARCHIVO DE NUEVA NOMENCLATURA *
  8557* FEB.26/2007 *          (ERROR    EN LCLZCN PROD = LOCALIZACION *
  8558******************************************************************
  8559* DLM0013     * UNLSUS - QUITAR EL LOCK AL MOMENTO DE LEER LOS   *
  8560* DARIO LASSO.*   REGISTROS.                                     *
  8561* RMB0013     * MATCH1 - MANEJO DEL MATCH DE NOMBRES A PARTIR DE *
  8562* R.MARTINEZ  *          LAS ESTRUCTURAS BASE DE DATACREDITO
  8563******************************************************************
  8564* CAV0014     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA      *
  8565* C. VELASCO. *          LA TABLA V-CARTOT-BDLDIR NO EXCEDA LAS  *
  8566* R.MARTINEZ  *          10 POSICIONES DE LAS MISMA.             *
  8567******************************************************************
  8568* VHF0015     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER  *
  8569* VICTOR HUGO *          SE MODIFICA EL ALOGORITMO PARA LA       *
  8570* FORERO      *          SELECCION DE LA MEJOR DIRECCION         *
  8571* JUL.25/2008 *                                                  *
  8572******************************************************************
  8573* RMB0016     * FECH01 - SE TOMA COMO DEFAULT LA FECHA DE APERTUR*
  8574* RICARDO MART*          COMO MEJOR FECHA, ESTO SI LA INDIVIDUAL *
  8575*             *          ESTA EN CEROS, CASO QUE SERIA UN ERROR  *
  8576* FEB.09/2009 *          LA MEJOR SIEMPRE ES LA INDIVIDUAL       *
  8577******************************************************************
  8578* AAM0017       * TELEXC - Se agrega validacin para la exclusin*
  8579* A. ALGARIN M. *          de telfonos y unificacin de los que *
  8580* MAR.12/2009   *          coincidan en los ltimos 7 nmeros.   *
  8581* INTERSCHEMES  *          Se agrega en la salida el campo fecha *
  8582*               *          ltimo reporte.                       *
  8583*               * UNIDIR - UNIFICAR DIRECCIONES QUE TENGAN       *
  8584*               *          COINCIDENCIAS CON OTRAS DIRECCIONES   *
  8585*               *          CON MAYOR CANTIDAD DE INFORMACION -   *
  8586*               *          INCLUIR EN LA SALIDA EL CAMPO FECHA   *
  8587*               *          ULTIMO REP                            *
  8588******************************************************************
  8589* AAM0018       * INIVAR - Se inicializa variable de control de  *
  8590* A. ALGARIN M. *          unificacin de direcciones.           *
  8591* MAR.26/2009   *                                                *
  8592* INTERSCHEMES  *                                                *
  8593******************************************************************
  8594* HGO0019       * UNIDI1 - Se ajusta para cuando exista una      *
  8595* H. GARCIA O.  *          direccion con basura y al estandarizar*
  8596* JUN.30/2009   *          no la tenga en cuenta                 *
  8597* INTERSCHEMES  *                                                *
  8598******************************************************************
  8599* HGO0020       * TEXTEL - Se agregan nuevas exclusiones en la   *
  8600* H. GARCIA O.  *          tabla de telefonos y se amplia el     *
  8601* SEP.01/2009   *          numero de ocurrencias                 *
  8602* INTERSCHEMES  *                                                *
  8603******************************************************************
  8604* HGO0021       * PYSPAR - AJUSTE QUE BUSCAR GENERAR CALIFICACION*
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 149
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8605* H. GARCIA O.  *          PARA LA PRIMERA Y SEGUNDA PARTICULA Y *
  8606* SEP. 07/2009  *          LUEGO UNIFICAR TENIENDO EN CUENTA ESTE*
  8607* INTERSCHEMES. *          CRITERIO                              *
  8608******************************************************************
  8609* HGO0022       * RECPF2 - AJUSTE VALIDACION TABLAS DE ACEPCIONES*
  8610* H. GARCIA O.  *          Y EXCLUSIONES                         *
  8611* SEP. 17/2009  *                                                *
  8612* INTERSCHEMES. *                                                *
  8613******************************************************************
  8614* RGH0023       * MOD023 - ESTANDARIZACION DE MANEJO DE ARCHIVOS *
  8615* R. GALVIS H.  *          BDLSTDCIU                             *
  8616* ENE. 01/2010  *          BDLDIRACE                             *
  8617* INTERSCHEMES. *          BDLMAIEXC                             *
  8618*               *          BDLTELEXC                             *
  8619******************************************************************
  8620* RGH0024      * MOD024 - PARA LAS DIRECCIONES QUE SE UNIFICAN   *
  8621* R.GALVIS     *          SE DEJA COMO FECHA DE ULTIMO REPORTE   *
  8622* FEB.16/2010  *          LA FECHA MAS RESIENTE DE LOS REGISTROS *
  8623* INTERSCHEMES *          QUE SE UNIFICAN                        *
  8624******************************************************************
  8625* RMB0025       * CELU01 - INCLUIR LOS CELULARES DEL ARCHIVO     *
  8626* R. MARTINEZ.  *          DE DIRECCIONES EN LA TABLA DE CELULAR *
  8627* MAR. 25/2010  *                                                *
  8628******************************************************************
  8629* PJV0026      * NN0026 - AJUSTE, PARA EVITAR QUE SE REPITAN     *
  8630* P.VARGAS     *          DIRECCIONES EN EL MISMO REPORTE CUNADO *
  8631* JUL 01/2010  *          SE TRATAN DE NUEVAS NOMENCLATURAS EN   *
  8632* DATACREDITO  *          BOGOTA.                                *
  8633******************************************************************
  8634* PJV0027      * AMP027 -SE AMPLIAN LOS LIMITES DE LAS TABLAS DE *
  8635* P.VARGAS     *         ACEPCIONES QUE SE CARGAN EN MEMORIA.    *
  8636* SEP 09/2010  *         TAMBIEN SE AJUSTA PARA EVITAR LA        *
  8637* DATACREDITO  *         REPETICION DE DIRECCIONES PARA UNA MISMA*
  8638*              *         IDENTIFICACION.                         *
  8639******************************************************************
  8640* PJV0028      * TEL028 -NO MOSTRAR TELFONOS NI CELULARES CON 1 *
  8641* P.VARGAS     *          9 EN LA POSICIN 7 DE DERECHA A       *
  8642* SEP 21/2010  *         IZQUIERDA                               *
  8643* DATACREDITO  * CAL028  SE CORRIGE CALIFICACION DE MOVILES      *
  8644*              *                                                 *
  8645******************************************************************
  8646* RMB0029      * BLOQ01 -SE ADICIONA CONTROL DE BLOQUEO DE       *
  8647* R.MARTINEZ   *         LA INFORMACION DE DIRECCIONES           *
  8648* OCT 01/2011  *                                                 *
  8649*
  8650* FARF029      * AJUCAL - SE AJUSTA PARA SUBIR DE 30 A 40 LOS
  8651* F.RODRIGUEZ  *          VALORES DE V-CALFIN-BDLDIR PARA
  8652* OCT 21/2011  *          DESEMPATAR POR FECHA
  8653*
  8654*              * AJUACE - SE AJUSTA PARA QUE  MUEVA LAS PARTICULAS
  8655*              *          DE LAS ACCEPCIONES COMPUESTAS.
  8656*              *
  8657******************************************************************
  8658* FARF030       * AJUDEP - SE AJUSTA PARA QUE CUANDO LA DIRECCION
  8659* DIC.06-2011   *          NO TENGA DIGITOS NUMERICOS MUEVA EL
  8660* FRANKLIN.R.   *          DEPARTAMENTO AL VECTOR                *
  8661******************************************************************
  8662* FARF031       * AJUFUR - SE AJUSTA LA RUTINA
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 150
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8663*               *  2020-UNIFICA-TELEFONOS PARA PARA QUE MUEVA LA
  8664* ABR.18-2012   *  LA FECHA DE ULTIMO REPORTE CUANDO SE MUEVA LA
  8665* FRANKLIN.R.   *  FECHA REPORTADO DESDE.
  8666*               *
  8667*               * AJNVDR - SE AJUSTA PARA QUE NO MARQUE LAS
  8668*               *  DIRECCIONES DE NUEVA NOMENCLATURA Y LAS INTEGRE
  8669*               *  CON LAS DIRECIONES QUE NO SON DE NUEVA
  8670*               *  NOMENCLATURA.
  8671******************************************************************
  8672* FARF032       * PLNCHQ - SE AINTEGRA LAS REGLAS DESARROLLADAS  *
  8673* Jul.17-2012   *  DESARROLLADAS POR RMB PARA EL PLAN DE CHOQUE. *
  8674* FRANKLIN.R.   *                                                *
  8675******************************************************************
  8676* FARF033       * AJCIUU - SE AINTEGRA EL AJUSTE DESARROLLADO POR
  8677* Sep.11-2012   * RMB QUE CAMBIA LA BUSQUEDA DEL CIU PARA QUE NO
  8678* FRANKLIN.R.   * FALLE CUANDO SE UTILIZA FUERA DE LA RUTINA
  8679*               * PRINCIPAL.
  8680******************************************************************
  8681* ABB0034      * NCAM18 -SE CREAN NUEVOS CAMPOS EN TRAMAS:       *
  8682* ALBEIRO      *         ZONA                ZONADIR             *
  8683* BERNAL       *         FECHA DE CREACION   FECCRE              *
  8684* Oct 04/2012  *         NUMERO DE ENTIDADES NUMENT              *
  8685*              *                                                 *
  8686*              * FCRGCR- SE INTEGRA EL AJUSTE DE FECHAS DE       *
  8687*              *  DIRECCIONES DE CUENTAS CERRADAS DESARROLLADO   *
  8688*              *  POR RMB.                                       *
  8689*              *                                                 *
  8690*              * NCAM19 -SE CREA NUEVOS CAMPOS:                  *
  8691*              *      TIPODI = 1=Res,2=Lab,4=Cor,3=Res+Lab       *
  8692*              *               5=Res+Cor, 6=Lab+Cor,7=Res+Lab+Cor*
  8693*              *      TIPOTE = 1=Res,2=Lab,3=Res+Lab             *
  8694******************************************************************
  8695* FARF035       * AJCONT - SE AINTEGRA EL AJUSTE DESARROLLADO POR
  8696* Nov.09-2012   * RMB QUE PERMITE HACER UNA CORRELACION ENTRE LAS
  8697* FRANKLIN.R.   * DIRECCIONES FINALES Y LAS DIRECCIONES INCICIALES
  8698*               * DE DONDE SALIERON
  8699******************************************************************
  8700* ABB0036      * NCAM20 -NUEVOS CAMPOS DESCRIPCION               *
  8701* ALBEIRO      *                                                 *
  8702* BERNAL       *                                                 *
  8703*Nov 15/2012   * *                                               *
  8704******************************************************************
  8705* FARF037       * LIMDIR - SE ADICIONAN UNA REGLAS DE LIMPIEZA Y
  8706* Feb.15-2013   * DE EXCLUSION EXPECIFICADAS POR MERCADEOD DE
  8707* FRANKLIN.R.   * PRODUCTO RECONOCER.
  8708*               *
  8709*               * AJCORR - SE AJUSTA LA CORRELACION A CERO EN LA
  8710*               * MATRIZ ORIGINAL CUANDO SE HACE UNA EXCLUSION  EN
  8711*               * LA MATRIZ  FINFIN, PARA QUE NO AFECTE LA NUEVA
  8712*               * NUMERACION DE CORRELACION.
  8713******************************************************************
  8714* FARF038       * AJEXMA - Se ajusta  la exclusion de correos para
  8715* Jul.03-2013   * que deje de ultimas el correo cuando lo excluye.
  8716* FRANKLIN.R.   *
  8717******************************************************************
  8718* FARF039       * ACEMAI - SE INTEGRA LA RUTINA DE ASEPCIONES DE
  8719* Jul.12-2013   * CORREO DESARROLLADA POR RICARDO MARTINEZ.
  8720* FRANKLIN.R.   *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 151
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8721*               * FACMAI - SE FACTORIZA EL CODIGO DEL MOVIMIENTO
  8722*               * DE LA TABLA MAIL A LA TABLA FINALMAIL.
  8723*               *
  8724*               * BOROTR - SE DEJA EN BLANCO LA OPCION OTR PARA LA
  8725*               * DESCRIPCION DE ZONAS DE DIRECCION
  8726******************************************************************
  8727* FARF040       * CODEUD - SE AJUSTA PARA QUE NO TOME LAS DIRECIONES
  8728* Sep.16-2013   * DE REGISTROS DE CODEUDORES
  8729* FRANKLIN.R.   *
  8730*               * AJACEP -SE AJUSTAN LAS ACEPCIONES DE DIRECIONES
  8731*               * ARCHIVO BDLDIRACE PARA QUE COINCIDAN CON LO
  8732*               * SOLICITADO CON COLSUBSIDIO. SE CAMBIA
  8733*               *        BRR por BR
  8734*               *        AP por APTO
  8735*               *        CORRG por CO
  8736*               *        CRT por CT
  8737******************************************************************
  8738* FARF041       * AJTAMD - Se ajusta  la limpieza de direcciones
  8739* Jul.03-2013   * para que no desborde para direciones de mas de .
  8740* FRANKLIN.R.   * 60 caracteres.
  8741******************************************************************
  8742*
  8743*-----------------INICIALIZACION               --------------------
  8744 2010-U-INICIAR-TABLAS.
  8745     MOVE 0 TO NUM-OK-SEND-BDLDIR.                                RMB0010
  8746     MOVE 1 TO DIR-OK-BDLDIR.                                     RMB0010
  8747     MOVE 1 TO TEL-OK-BDLDIR.                                     RMB0010
  8748
  8749     MOVE 1 TO CEL-OK-BDLDIR
  8750     MOVE 1 TO MAIL-OK-BDLDIR
  8751     INITIALIZE TABLA-CEL-BDLDIR
  8752     INITIALIZE TABLA-CELFINALES-BDLDIR
  8753     INITIALIZE TABLA-MAIL-BDLDIR
  8754     INITIALIZE TABLA-MAILFINALES-BDLDIR
  8755
  8756     INITIALIZE TABLA-DIR-BDLDIR.                                 RMB0010
  8757     INITIALIZE TABLA-TEL-BDLDIR.                                 RMB0010
  8758     INITIALIZE TABLA-DIRFINALES-BDLDIR.                          RMB0010
  8759     INITIALIZE TABLA-TELFINALES-BDLDIR.                          RMB0010
  8760     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.                       AAM0017
  8761     INITIALIZE T-DIRFINALESAUX-BDLDIR.                           AAM0017
  8762*    SE INICIALIZA LOS CAMPOS PARA LA CORRELACION
  8763     MOVE 1 TO I-BDLDIR.                                          FARF035
  8764     PERFORM UNTIL I-BDLDIR > 100                                 FARF035
  8765        MOVE I-BDLDIR TO V-SEC00DIR-BDLDIR(I-BDLDIR)              FARF035
  8766        MOVE I-BDLDIR TO V-SEC01DIRFIN-BDLDIR(I-BDLDIR)           FARF035
  8767        MOVE I-BDLDIR TO V-SEC02DIRFINFIN-BDLDIR(I-BDLDIR)        FARF035
  8768*                                                                 FARF035
  8769        MOVE I-BDLDIR TO V-SEC00TEL-BDLDIR(I-BDLDIR)              FARF035
  8770        MOVE I-BDLDIR TO V-SEC01TELFIN-BDLDIR(I-BDLDIR)           FARF035
  8771*                                                                 FARF035
  8772        MOVE I-BDLDIR TO V-SEC00CEL-BDLDIR(I-BDLDIR)              FARF035
  8773        MOVE I-BDLDIR TO V-SEC01CELFIN-BDLDIR(I-BDLDIR)           FARF035
  8774*                                                                 FARF035
  8775        MOVE I-BDLDIR TO V-SEC00MAIL-BDLDIR(I-BDLDIR)             FARF035
  8776        MOVE I-BDLDIR TO V-SEC01MAILFIN-BDLDIR(I-BDLDIR)          FARF035
  8777        ADD  1 TO I-BDLDIR                                        FARF035
  8778     END-PERFORM.                                                 FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 152
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8779*
  8780*--------------------- LLENADO DE DATOS  --------------------
  8781 2011-ESTANDARIZAR-CIUDAD.                                        RMB0010
  8782       PERFORM 2018-TOMAR-CIUDADES-ORIGINALES                     RMB0010
  8783       IF OPEN-BDLSTDCIU-BDLDIR = 0                               RMB0010
  8784          MOVE 1 TO OPEN-BDLSTDCIU-BDLDIR                         RMB0010
  8785          OPEN INPUT BDLSTDCIU                                    RMB0010
  8786*         IF COD-RETORNO-BDLSTDCIU <> "00"                        RGH0023
  8787*           DISPLAY "ICGDI2: ERROR ABRIENDO BDLSTDCIU",           RGH0023
  8788*           " FILE STATUS = " ,        COD-RETORNO-BDLSTDCIU      RGH0023
  8789*           STOP RUN                                              RGH0023
  8790*         END-IF                                                  RGH0023
  8791
  8792          OPEN INPUT BDLDIRESTR
  8793
  8794       END-IF.                                                    RMB0010
  8795       IF CIURES-DIRECC NOT = SPACES                              RMB0010
  8796           MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010
  8797           PERFORM 1000-PROCESAR-CIU                              RMB0010
  8798           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECC       RMB0010
  8799
  8800           MOVE CODIGO-DANE-CIU-BDLDIR TO CODIGO-RES
  8801
  8802        END-IF                                                    RMB0010
  8803        IF CIUCOR-DIRECC NOT = SPACES                             RMB0010
  8804           MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010
  8805           PERFORM 1000-PROCESAR-CIU                              RMB0010
  8806           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECC       RMB0010
  8807
  8808           MOVE CODIGO-DANE-CIU-BDLDIR TO CODIGO-COR
  8809
  8810        END-IF                                                    RMB0010
  8811        IF CIULAB-DIRECC NOT = SPACES                             RMB0010
  8812           MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010
  8813           PERFORM 1000-PROCESAR-CIU                              RMB0010
  8814           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECC       RMB0010
  8815
  8816           MOVE CODIGO-DANE-CIU-BDLDIR TO CODIGO-LAB
  8817
  8818        END-IF.                                                   RMB0010
  8819 1000-PROCESAR-CIU.                                               RMB0010
  8820     MOVE FUNCTION UPPER-CASE(LLAVE-BDLSTDCIU) TO LLAVE-BDLSTDCIU.RMB0010
  8821     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '"' BY " ".            RMB0010
  8822     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '*' BY " ".            RMB0010
  8823     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '_' BY " ".            RMB0010
  8824     MOVE 0 TO PATRON-CIU-BDLDIR CODIGO-DANE-CIU-BDLDIR.          RMB0010
  8825     MOVE SPACES TO CODIGO-DANE-CIU-BDLDIR.                       RMB0010
  8826     MOVE 0 TO I-CIU-BDLDIR.                                      RMB0010
  8827     INSPECT LLAVE-BDLSTDCIU TALLYING I-CIU-BDLDIR FOR ALL "BOGOT"RMB0010
  8828     IF I-CIU-BDLDIR > 0                                          RMB0010
  8829        MOVE 1 TO PATRON-CIU-BDLDIR                               RMB0010
  8830        MOVE "BOGOTA" TO LLAVE-BDLSTDCIU                          RMB0010
  8831     ELSE                                                         RMB0010
  8832        MOVE LLAVE-BDLSTDCIU TO LLAVE-AUX-CIU-BDLDIR              RMB0010
  8833        UNSTRING LLAVE-AUX21-CIU-BDLDIR DELIMITED BY ALL " " INTO RMB0010
  8834           BASURA-CIU-BDLDIR CODIGO-DANE-CIU-BDLDIR               RMB0010
  8835        INSPECT CODIGO-DANE-CIU-BDLDIR REPLACING ALL " " BY "0"   RMB0010
  8836     END-IF.                                                      RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 153
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8837     MOVE SPACES TO CAMPO-CIU-BDLDIR                              RMB0010
  8838     MOVE 1 TO I-CIU-BDLDIR J-CIU-BDLDIR                          RMB0010
  8839     PERFORM UNTIL I-CIU-BDLDIR > 30                              RMB0010
  8840        IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) <> " "                 RMB0010
  8841           IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) =                   RMB0010
  8842              ("(" OR "-" OR "." OR "," OR "/" OR "\" )           RMB0010
  8843                                  AND J-CIU-BDLDIR > 4            RMB0010
  8844              MOVE 50 TO I-CIU-BDLDIR                             RMB0010
  8845           ELSE                                                   RMB0010
  8846              IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) NOT NUMERIC      RMB0010
  8847                 MOVE LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1)             RMB0010
  8848                      TO CAMPO-CIU-BDLDIR(J-CIU-BDLDIR:1)         RMB0010
  8849                 ADD 1 TO J-CIU-BDLDIR                            RMB0010
  8850              END-IF                                              RMB0010
  8851           END-IF                                                 RMB0010
  8852        END-IF                                                    RMB0010
  8853        ADD 1 TO I-CIU-BDLDIR                                     RMB0010
  8854     END-PERFORM.                                                 RMB0010
  8855     IF CAMPO-CIU-BDLDIR = SPACES                                 RMB0010
  8856        IF CODIGO-DANE-CIU-BDLDIR NUMERIC AND                     RMB0010
  8857           CODIGO-DANE-N-CIU-BDLDIR > 01000000                    RMB0010
  8858           MOVE CODIGO-DANE-CIU-BDLDIR TO CAMPO-CIU-BDLDIR        RMB0010
  8859        END-IF                                                    RMB0010
  8860     END-IF.                                                      RMB0010
  8861     MOVE CAMPO-CIU-BDLDIR TO LLAVE-BDLSTDCIU                     RMB0010
  8862     READ BDLSTDCIU INVALID KEY                                   RMB0010
  8863            MOVE SPACES        TO CIUDAD-ESTANDAR-CIU-BDLDIR      RMB0010
  8864        NOT INVALID KEY                                           RMB0010
  8865            IF ACTIVO-BDLSTDCIU NOT = "N"                         HGO0022
  8866            MOVE CIUDAD-BDLSTDCIU TO CIUDAD-ESTANDAR-CIU-BDLDIR   RMB0010
  8867            END-IF                                                HGO0022
  8868
  8869            MOVE CODIGO-BDLSTDCIU TO CODIGO-DANE-CIU-BDLDIR
  8870
  8871     END-READ.                                                    RMB0010
  8872 2018-U-PASAR-REG-ICBDIR.
  8873******************************************************************
  8874* SE VERIFICA QUE NO SEAN MAS DE 500 DIRECCIONES LAS QUE SE VAN  *
  8875* A ENCADENAR                                                    *
  8876******************************************************************
  8877
  8878     IF NUM-OK-SEND-BDLDIR <= 500                                 RMB0010
  8879        PERFORM 2018-TOMAR-DATOS
  8880     END-IF.
  8881     ADD 1 TO NUM-OK-SEND-BDLDIR.                                 RMB0010
  8882
  8883 2018-TOMAR-CIUDADES-ORIGINALES.                                  RMB0010
  8884******************************************************************RMB0010
  8885*2018-TOMAR-CIUDADES-ORIGINALES.                                 *RMB0010
  8886*    TOMA LAS CIUDADES ORIGINALES DEL ARCHIVO DE DIRECCIONES     *RMB0010
  8887*    PARA CADA TIPO DE INFORMACION (RESIDENCIAL, LABORAL, ETC)   *RMB0010
  8888******************************************************************RMB0010
  8889     MOVE CIURES-DIRECC TO CIUDAD-RES-A-ESTANDAR-BDLDIR           RMB0010
  8890     MOVE CIULAB-DIRECC TO CIUDAD-LAB-A-ESTANDAR-BDLDIR           RMB0010
  8891     MOVE CIUCOR-DIRECC TO CIUDAD-COR-A-ESTANDAR-BDLDIR.          RMB0010
  8892
  8893 2018-TOMAR-DATOS.
  8894******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 154
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8895* SE TOMAN LOS DATOS DEL REGISTRO DE DIRECCIONES Y SE PASAN A LOS*
  8896* SIGUIENTES VECTORES:                                           *
  8897*        DIRECCIONES V-DIRECCION         DIRECCION
  8898*                    V-TIPODIR           UBICACION
  8899*                    V-CIUDADDIR         CIUDAD
  8900*                    V-SUSDIR            CODIGO SUSCRIPTOR
  8901*                    V-FECHADIR          FECHA MEJOR
  8902*                    V-TNUMDIR           VECTOR DE NUMEROS ORDENAD
  8903*                    V-HASDIR            STRING DE NUMEROS ORDENAD
  8904*                    V-FECCRE            FECHA EN LA QUE SE REPORTO
  8905*                                        POR PRIMERA VEZ
  8906*        TELEFONOS   V-TELEFONO          TELEFONO
  8907*                    V-TIPOTEL           UBICACION
  8908*                    V-CIUDTEL           CIUDAD
  8909*                    V-SUSTEL            CODIGO SUSCRIPTOR
  8910*                    V-FECHATEL          FECHA MEJOR
  8911*                    V-FECCRETEL         FECHA EN LA QUE SE REPORTO
  8912*                                        POR PRIMERA VEZ
  8913*        CELULARES   V-CELULAR           CELULAR
  8914*                    V-SUSCEL            CODIGO SUSCRIPTOR
  8915*                    V-FECHACEL          FECHA MEJOR
  8916*                    V-FECCRECEL         FECHA EN LA QUE SE REPORTO
  8917*                                        POR PRIMERA VEZ
  8918*        MAILS       V-MAIL              EMAIL
  8919*                    V-SUSMAIL           CODIGO SUSCRIPTOR
  8920*                    V-FECHAMAIL         FECHA MEJOR
  8921*                    V-FECCREMAIL        FECHA EN LA QUE SE REPORTO
  8922*                                        POR PRIMERA VEZ
  8923******************************************************************
  8924     PERFORM 2011-ESTANDARIZAR-CIUDAD.                            RMB0010
  8925     PERFORM 2011-EXTRACTAR-CEL-BDLDIR.                           RMB0025
  8926     IF CIURES-DIRECC NOT = SPACES
  8927        IF DIRRES-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010
  8928           MOVE DIRRES-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010
  8929           MOVE "R"           TO V-TIPODIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010
  8930                                 IND-DATO-BDLDIR                  RMB0010
  8931           MOVE CIURES-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010
  8932           MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010
  8933           MOVE DIRRES-DIRECC TO T-CARDIR-BDLDIR                  RMB0010
  8934           PERFORM 2019-ELEGIR-FECHA-DIR                          VHF0015
  8935           MOVE 1             TO V-NUMENT-BDLDIR(DIR-OK-BDLDIR)   ABB0034
  8936           MOVE 1             TO V-TIPODI-BDLDIR(DIR-OK-BDLDIR)   ABB0034
  8937           MOVE FECHA-MEJOR-BDLDIR                                 ABB0034
  8938                                 TO V-FECCRE-BDLDIR(DIR-OK-BDLDIR)ABB0034
  8939           MOVE FECHA-MEJOR-BDLDIR                                RMB0010
  8940                TO V-FECHADIR-BDLDIR(DIR-OK-BDLDIR)               RMB0010
  8941           MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017
  8942
  8943           MOVE CIURES-DIRECC TO CIUDAD-BDLDIRESTR
  8944                                 DUPCIUDAD-BDLDIR
  8945           MOVE DIRRES-DIRECC TO DIRECC-BDLDIRESTR
  8946           MOVE CODIGO-RES    TO DANE-BDLDIRESTR
  8947           MOVE CODIGO-RES(1:2) TO COD-DPTO
  8948           PERFORM 2018-BUSCAR-DUPCIUDAD
  8949           READ BDLDIRESTR INVALID KEY
  8950              MOVE ZEROS TO V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)
  8951                            V-PRBENTDIR-BDLDIR(DIR-OK-BDLDIR)     HGO0022
  8952              MOVE SPACES TO V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 155
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  8953                             V-ESTRATODIR-BDLDIR(DIR-OK-BDLDIR)
  8954              MOVE CODIGO-RES TO V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)  ABB0034
  8955           NOT INVALID KEY
  8956              MOVE CODDANE-BDLDIRESTR TO
  8957                                 V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)
  8958              MOVE DEPEST-BDLDIRESTR TO
  8959                                 V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
  8960              MOVE ESTR-BDLDIRESTR TO
  8961                              V-ESTRATODIR-BDLDIR(DIR-OK-BDLDIR)
  8962              MOVE PRBENT-BDLDIRESTR TO                           HGO0022
  8963                              V-PRBENTDIR-BDLDIR(DIR-OK-BDLDIR)   HGO0022
  8964           END-READ
  8965*
  8966           IF V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR) = SPACES
  8967           AND COD-DPTO > 0 AND SW-DUPCIUDAD = 0
  8968              MOVE T-NOM-DEP-DANE(COD-DPTO) TO
  8969                   V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
  8970           END-IF
  8971*
  8972           PERFORM 2018-CALCULAR-ZONA                             ABB0034
  8973           PERFORM 2020-U-BUSCAR-NUMEROS
  8974        END-IF
  8975*
  8976        IF TELRES-DIRECC > 0 AND TEL-OK-BDLDIR < 100 AND          RMB0010
  8977           TELRES-DIRECC < 9999999999
  8978           MOVE CIURES-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010
  8979                                 DUPCIUDAD-BDLDIR
  8980           MOVE TELRES-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010
  8981                                 V-HASTEL-BDLDIR(TEL-OK-BDLDIR)   RMB0010
  8982           MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010
  8983           MOVE "R"           TO V-TIPOTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010
  8984                                 IND-DATO-BDLDIR                  RMB0010
  8985           PERFORM 2019-ELEGIR-FECHA-TEL                          VHF0015
  8986           MOVE 1             TO V-NUMENTTEL-BDLDIR(TEL-OK-BDLDIR)ABB0034
  8987           MOVE 1             TO V-TIPOTE-BDLDIR   (TEL-OK-BDLDIR)ABB0034
  8988           MOVE FECHA-MEJOR-BDLDIR                                ABB0034
  8989                              TO V-FECCRETEL-BDLDIR(TEL-OK-BDLDIR)ABB0034
  8990           MOVE FECHA-MEJOR-BDLDIR                                RMB0010
  8991                TO V-FECHATEL-BDLDIR(TEL-OK-BDLDIR)               RMB0010
  8992           MOVE FECULT-DIRECC                                     AAM0017
  8993                TO V-FECULTTEL-BDLDIR(TEL-OK-BDLDIR)              AAM0017
  8994           PERFORM 2018-BUSCAR-DUPCIUDAD
  8995           MOVE CODIGO-RES(1:2) TO COD-DPTO
  8996           IF COD-DPTO > 0 AND SW-DUPCIUDAD = 0
  8997              MOVE T-NOM-DEP-DANE(COD-DPTO) TO
  8998                   V-DEPTEL-BDLDIR(TEL-OK-BDLDIR)
  8999           END-IF
  9000*
  9001           ADD 1 TO TEL-OK-BDLDIR                                 RMB0010
  9002        END-IF
  9003     END-IF.
  9004*
  9005     IF CIULAB-DIRECC NOT = SPACES                                FAC0009
  9006        IF DIRLAB-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010
  9007           MOVE DIRLAB-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010
  9008           MOVE "L"           TO V-TIPODIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010
  9009                                 IND-DATO-BDLDIR                  RMB0010
  9010           MOVE CIULAB-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 156
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9011           MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010
  9012           MOVE DIRLAB-DIRECC TO T-CARDIR-BDLDIR                  RMB0010
  9013           PERFORM 2019-ELEGIR-FECHA-DIR                          VHF0015
  9014           MOVE 1             TO V-NUMENT-BDLDIR(DIR-OK-BDLDIR)   ABB0034
  9015           MOVE 2             TO V-TIPODI-BDLDIR(DIR-OK-BDLDIR)   ABB0034
  9016           MOVE FECHA-MEJOR-BDLDIR                                ABB0034
  9017                              TO V-FECCRE-BDLDIR(DIR-OK-BDLDIR)   ABB0034
  9018           MOVE FECHA-MEJOR-BDLDIR                                RMB0010
  9019                TO V-FECHADIR-BDLDIR(DIR-OK-BDLDIR)               RMB0010
  9020           MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017
  9021
  9022           MOVE CIULAB-DIRECC TO CIUDAD-BDLDIRESTR
  9023                                 DUPCIUDAD-BDLDIR
  9024           MOVE DIRLAB-DIRECC TO DIRECC-BDLDIRESTR
  9025           MOVE CODIGO-LAB    TO DANE-BDLDIRESTR
  9026           MOVE CODIGO-LAB(1:2) TO COD-DPTO
  9027           PERFORM 2018-BUSCAR-DUPCIUDAD
  9028           READ BDLDIRESTR INVALID KEY
  9029              MOVE ZEROS TO V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)
  9030                            V-PRBENTDIR-BDLDIR(DIR-OK-BDLDIR)     HGO0022
  9031              MOVE SPACES TO V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
  9032                             V-ESTRATODIR-BDLDIR(DIR-OK-BDLDIR)
  9033              MOVE CODIGO-LAB TO V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)  ABB0034
  9034           NOT INVALID KEY
  9035              MOVE CODDANE-BDLDIRESTR TO
  9036                                 V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)
  9037              MOVE DEPEST-BDLDIRESTR TO
  9038                                 V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
  9039              MOVE ESTR-BDLDIRESTR TO
  9040                              V-ESTRATODIR-BDLDIR(DIR-OK-BDLDIR)
  9041              MOVE PRBENT-BDLDIRESTR TO                           HGO0022
  9042                              V-PRBENTDIR-BDLDIR(DIR-OK-BDLDIR)   HGO0022
  9043           END-READ
  9044           IF V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR) = SPACES
  9045           AND COD-DPTO > 0 AND SW-DUPCIUDAD = 0
  9046              MOVE T-NOM-DEP-DANE(COD-DPTO) TO
  9047                   V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
  9048           END-IF
  9049*
  9050           PERFORM 2018-CALCULAR-ZONA                             ABB0034
  9051           PERFORM 2020-U-BUSCAR-NUMEROS                          FAC0009
  9052        END-IF                                                    FAC0009
  9053*
  9054        IF TELLAB-DIRECC > 0 AND TEL-OK-BDLDIR < 100 AND          RMB0010
  9055           TELLAB-DIRECC < 9999999999                             FAC0009
  9056           MOVE CIULAB-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010
  9057                                 DUPCIUDAD-BDLDIR
  9058           MOVE TELLAB-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010
  9059                              V-HASTEL-BDLDIR(TEL-OK-BDLDIR)      RMB0010
  9060           MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010
  9061           MOVE "L"           TO V-TIPOTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010
  9062                                 IND-DATO-BDLDIR                  RMB0010
  9063           PERFORM 2019-ELEGIR-FECHA-TEL                          VHF0015
  9064           MOVE 1             TO V-NUMENTTEL-BDLDIR(TEL-OK-BDLDIR)ABB0034
  9065           MOVE 2             TO V-TIPOTE-BDLDIR   (TEL-OK-BDLDIR)ABB0034
  9066           MOVE FECHA-MEJOR-BDLDIR                                ABB0034
  9067                              TO V-FECCRETEL-BDLDIR(TEL-OK-BDLDIR)ABB0034
  9068           MOVE FECHA-MEJOR-BDLDIR                                RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 157
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9069                TO V-FECHATEL-BDLDIR(TEL-OK-BDLDIR)               RMB0010
  9070           MOVE FECULT-DIRECC                                     AAM0017
  9071                TO V-FECULTTEL-BDLDIR(TEL-OK-BDLDIR)              AAM0017
  9072
  9073           PERFORM 2018-BUSCAR-DUPCIUDAD
  9074           MOVE CODIGO-LAB(1:2) TO COD-DPTO
  9075           IF COD-DPTO > 0 AND SW-DUPCIUDAD = 0
  9076              MOVE T-NOM-DEP-DANE(COD-DPTO) TO
  9077                   V-DEPTEL-BDLDIR(TEL-OK-BDLDIR)
  9078           END-IF
  9079*
  9080           ADD 1 TO TEL-OK-BDLDIR                                 RMB0010
  9081        END-IF                                                    FAC0009
  9082     END-IF.                                                      FAC0009
  9083*
  9084     IF CIUCOR-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100 AND    RMB0010
  9085        DIRCOR-DIRECC NOT = SPACES
  9086        MOVE CIUCOR-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)   RMB0010
  9087        MOVE DIRCOR-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)   RMB0010
  9088        MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)     RMB0010
  9089        MOVE "C"           TO V-TIPODIR-BDLDIR(DIR-OK-BDLDIR)     RMB0010
  9090                              IND-DATO-BDLDIR                     RMB0010
  9091        MOVE DIRCOR-DIRECC TO T-CARDIR-BDLDIR                     RMB0010
  9092        PERFORM 2019-ELEGIR-FECHA-DIR                             VHF0015
  9093        MOVE 1             TO V-NUMENT-BDLDIR(DIR-OK-BDLDIR)      ABB0034
  9094        MOVE 4             TO V-TIPODI-BDLDIR(DIR-OK-BDLDIR)      ABB0034
  9095        MOVE FECHA-MEJOR-BDLDIR                                   ABB0034
  9096                           TO V-FECCRE-BDLDIR(DIR-OK-BDLDIR)      ABB0034
  9097        MOVE FECHA-MEJOR-BDLDIR                                   RMB0010
  9098             TO V-FECHADIR-BDLDIR(DIR-OK-BDLDIR)                  RMB0010
  9099        MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)      AAM0017
  9100
  9101        MOVE CIUCOR-DIRECC TO CIUDAD-BDLDIRESTR
  9102                              DUPCIUDAD-BDLDIR
  9103        MOVE DIRCOR-DIRECC TO DIRECC-BDLDIRESTR
  9104        MOVE CODIGO-COR    TO DANE-BDLDIRESTR
  9105        MOVE CODIGO-COR(1:2) TO COD-DPTO
  9106        PERFORM 2018-BUSCAR-DUPCIUDAD
  9107        READ BDLDIRESTR INVALID KEY
  9108           MOVE ZEROS TO V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)
  9109                       V-PRBENTDIR-BDLDIR(DIR-OK-BDLDIR)          HGO0022
  9110           MOVE SPACES TO V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
  9111                     V-ESTRATODIR-BDLDIR(DIR-OK-BDLDIR)
  9112           MOVE CODIGO-COR TO V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)     ABB0034
  9113        NOT INVALID KEY
  9114           MOVE CODDANE-BDLDIRESTR TO
  9115                              V-DANEDIR-BDLDIR(DIR-OK-BDLDIR)
  9116           MOVE DEPEST-BDLDIRESTR TO
  9117                              V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
  9118           MOVE ESTR-BDLDIRESTR TO
  9119                           V-ESTRATODIR-BDLDIR(DIR-OK-BDLDIR)
  9120           MOVE PRBENT-BDLDIRESTR TO                                HGO002
  9121                           V-PRBENTDIR-BDLDIR(DIR-OK-BDLDIR)      HGO0022
  9122        END-READ
  9123*
  9124        IF V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR) = SPACES
  9125        AND COD-DPTO > 0 AND SW-DUPCIUDAD = 0
  9126           MOVE T-NOM-DEP-DANE(COD-DPTO) TO
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 158
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9127              V-DEPTODIR-BDLDIR(DIR-OK-BDLDIR)
  9128        END-IF
  9129*
  9130        PERFORM 2018-CALCULAR-ZONA                                ABB0034
  9131        PERFORM 2020-U-BUSCAR-NUMEROS
  9132     END-IF.
  9133
  9134     IF TELCEL-DIRECC > 0 AND CEL-OK-BDLDIR < 100 AND
  9135        TELCEL-DIRECC < 9999999999
  9136        MOVE TELCEL-DIRECC TO V-CELULAR-BDLDIR(CEL-OK-BDLDIR)
  9137                          V-HASCEL-BDLDIR(CEL-OK-BDLDIR)
  9138        MOVE COD-SUS-DIRECC TO V-SUSCEL-BDLDIR(CEL-OK-BDLDIR)
  9139        PERFORM 2019-ELEGIR-FECHA-CEL
  9140        MOVE 1             TO V-NUMENTCEL-BDLDIR(CEL-OK-BDLDIR)   ABB0034
  9141        MOVE FECHA-MEJOR-BDLDIR                                   ABB0034
  9142             TO V-FECCRECEL-BDLDIR(CEL-OK-BDLDIR)                 ABB0034
  9143        MOVE FECHA-MEJOR-BDLDIR
  9144             TO V-FECHACEL-BDLDIR(CEL-OK-BDLDIR)
  9145        MOVE FECULT-DIRECC
  9146             TO V-FECULTCEL-BDLDIR(CEL-OK-BDLDIR)
  9147        MOVE 3 TO V-ORIGENCEL-BDLDIR(CEL-OK-BDLDIR)
  9148        ADD 1 TO CEL-OK-BDLDIR
  9149     END-IF.
  9150*
  9151     IF E-MAIL-DIRECC NOT = SPACES AND MAIL-OK-BDLDIR < 100
  9152*       enviamos a la rutina de acepciones y limpieza de mails
  9153        MOVE E-MAIL-DIRECC TO WS-MAIL-BDLSTDMAI                   FARF039
  9154        PERFORM 1000-CLEANCING-BDLSTDMAI                          FARF039
  9155        MOVE WS-ACEP-MAIL-BDLSTDMAI TO E-MAIL-DIRECC              FARF039
  9156        MOVE E-MAIL-DIRECC TO V-MAIL-BDLDIR(MAIL-OK-BDLDIR)
  9157                          V-HASMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9158        MOVE COD-SUS-DIRECC TO V-SUSMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9159        PERFORM 2019-ELEGIR-FECHA-MAIL
  9160        MOVE 1             TO V-NUMENTMAIL-BDLDIR(MAIL-OK-BDLDIR) ABB0034
  9161        MOVE FECHA-MEJOR-BDLDIR                                   ABB0034
  9162             TO V-FECCREMAIL-BDLDIR(MAIL-OK-BDLDIR)               ABB0034
  9163        MOVE FECHA-MEJOR-BDLDIR
  9164             TO V-FECHAMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9165        MOVE FECULT-DIRECC
  9166             TO V-FECULTMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9167        MOVE 3 TO V-ORIGENMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9168        ADD 1 TO MAIL-OK-BDLDIR
  9169     END-IF.
  9170*                                                                *ABB0034
  9171 2018-CALCULAR-ZONA.                                              ABB0034
  9172******************************************************************ABB0034
  9173*    A PARTIR DEL CODIGO DANE DE LA CIUDAD SE CALCULA LA ZONA    *ABB0034
  9174*    R RURAL, U URBANA - NO DETERMINADA                          *ABB0034
  9175*                                                                *ABB0034
  9176******************************************************************ABB0034
  9177     MOVE "-" TO V-ZONADIR-BDLDIR(DIR-OK-BDLDIR)                  ABB0034
  9178     MOVE V-DANEDIR-BDLDIR(DIR-OK-BDLDIR) TO CODANE-BDLDI2        ABB0034
  9179     IF CODANE-BDLDI2 NOT = ZEROS                                 ABB0034
  9180        IF CODANE-BDLDI2(6:3) = "000"                             ABB0034
  9181           MOVE "U" TO V-ZONADIR-BDLDIR(DIR-OK-BDLDIR)            ABB0034
  9182        ELSE                                                      ABB0034
  9183           MOVE "R" TO V-ZONADIR-BDLDIR(DIR-OK-BDLDIR)            ABB0034
  9184        END-IF                                                    ABB0034
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 159
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9185     END-IF.                                                      ABB0034
  9186******************************************************************ABB0034
  9187 2011-EXTRACTAR-CEL-BDLDIR.                                       RMB0025
  9188     MOVE TELLAB-DIRECC TO TEL-AUX-BDLDIR.                        RMB0025
  9189     IF ES-CELULAR-BDLDIR AND P1-TEL-AUX-BDLDIR = 0               RMB0025
  9190        MOVE "L"  TO IND-DATO-BDLDIR                              RMB0025
  9191        PERFORM 2019-ELEGIR-FECHA-TEL                             RMB0025
  9192        MOVE FECHA-MEJOR-BDLDIR TO FECHA-APERT-ICBDIM             RMB0025
  9193        MOVE FECULT-DIRECC      TO FEC-AUX-BDLDIR                 RMB0025
  9194        MOVE FEC-AUX-BDLDIR     TO FECHA-ACT-ICBDIM               RMB0025
  9195        MOVE TELLAB-DIRECC TO TEL-CEL-ICBDIM                      RMB0025
  9196        MOVE 3             TO ORIGEN-ICBDIM                       RMB0025
  9197        MOVE SPACES        TO E-MAIL-ICBDIM                       RMB0025
  9198        PERFORM 2018-U-PASAR-REG-ICBDIM                           RMB0025
  9199        MOVE 0             TO TELLAB-DIRECC                       RMB0025
  9200     END-IF.                                                      RMB0025
  9201     MOVE TELRES-DIRECC TO TEL-AUX-BDLDIR.                        RMB0025
  9202     IF ES-CELULAR-BDLDIR AND P1-TEL-AUX-BDLDIR = 0               RMB0025
  9203        MOVE "R"  TO IND-DATO-BDLDIR                              RMB0025
  9204        PERFORM 2019-ELEGIR-FECHA-TEL                             RMB0025
  9205        MOVE FECHA-MEJOR-BDLDIR TO FECHA-APERT-ICBDIM             RMB0025
  9206        MOVE FECULT-DIRECC      TO FEC-AUX-BDLDIR                 RMB0025
  9207        MOVE FEC-AUX-BDLDIR     TO FECHA-ACT-ICBDIM               RMB0025
  9208        MOVE TELRES-DIRECC  TO TEL-CEL-ICBDIM                     RMB0025
  9209        MOVE 3             TO ORIGEN-ICBDIM                       RMB0025
  9210        MOVE SPACES        TO E-MAIL-ICBDIM                       RMB0025
  9211        PERFORM 2018-U-PASAR-REG-ICBDIM                           RMB0025
  9212        MOVE 0             TO TELRES-DIRECC                       RMB0025
  9213     END-IF.                                                      RMB0025
  9214 2018-CARGA-DUPCIUDAD.
  9215******************************************************************
  9216*2018-CARGA-DUPCIUDAD.
  9217******************************************************************
  9218*     MOVE 1 TO CON-DUPCIUDAD
  9219     IF FIN-DUPCIUDAD = 0
  9220      READ DUPCIUDAD AT END MOVE 1 TO FIN-DUPCIUDAD
  9221      NOT AT END
  9222         MOVE REG-DUPCIUDAD TO T-DUPCIUDAD(CON-DUPCIUDAD)
  9223         ADD 1 TO CON-DUPCIUDAD
  9224      END-READ
  9225     END-IF.
  9226 2018-BUSCAR-DUPCIUDAD.
  9227*========================================================*
  9228*2018-BUSCAR-DUPCIUDAD.
  9229* Busca en tabla de memoria si existe la ciudad
  9230*========================================================*
  9231     MOVE 1 TO CON1-DUPCIUDAD
  9232     MOVE 0 TO SW-DUPCIUDAD
  9233     PERFORM UNTIL CON1-DUPCIUDAD > 99
  9234       IF CIUDAD-DUPCIUDAD(CON1-DUPCIUDAD) = DUPCIUDAD-BDLDIR
  9235         MOVE 1 TO SW-DUPCIUDAD
  9236         MOVE 100 TO CON1-DUPCIUDAD
  9237       END-IF
  9238       ADD 1 TO CON1-DUPCIUDAD
  9239     END-PERFORM.
  9240 2018-U-PASAR-REG-ICBDIM.
  9241******************************************************************
  9242* SE TOMAN LOS DATOS DEL REGISTRO DE ICBDIM Y SE PASAN A LOS     *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 160
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9243* SIGUIENTES VECTORES:                                           *
  9244*        CELULARES       V-CELULAR        CELULAR
  9245*                        V-SUSCEL         CODIGO SUSCRIPTOR
  9246*                        V-FECHACEL       FECHA MEJOR
  9247*        MAILS           V-MAIL           EMAIL
  9248*                        V-SUSMAIL        CODIGO SUSCRIPTOR
  9249*                        V-FECHAMAIL      FECHA MEJOR
  9250******************************************************************
  9251     IF TEL-CEL-ICBDIM > 0 AND CEL-OK-BDLDIR < 100 AND
  9252        TEL-CEL-ICBDIM < 9999999999
  9253        MOVE TEL-CEL-ICBDIM TO V-CELULAR-BDLDIR(CEL-OK-BDLDIR)
  9254                          V-HASCEL-BDLDIR(CEL-OK-BDLDIR)
  9255        PERFORM 2019-ELEGIR-FECHA-CELDIM
  9256        MOVE 1             TO V-NUMENTCEL-BDLDIR(CEL-OK-BDLDIR)   ABB0034
  9257        MOVE FECHA-MEJOR-BDLDIR                                   ABB0034
  9258                           TO V-FECCRECEL-BDLDIR(CEL-OK-BDLDIR)   ABB0034
  9259        MOVE FECHA-MEJOR-BDLDIR
  9260             TO V-FECHACEL-BDLDIR(CEL-OK-BDLDIR)
  9261        MOVE FECHA-ACT-ICBDIM
  9262             TO V-FECULTCEL-BDLDIR(CEL-OK-BDLDIR)
  9263        IF ORIGEN-ICBDIM = 1
  9264           MOVE 990003 TO V-SUSCEL-BDLDIR(CEL-OK-BDLDIR)
  9265        ELSE
  9266         IF ORIGEN-ICBDIM = 2                                     RMB0025
  9267            MOVE 990005 TO V-SUSCEL-BDLDIR(CEL-OK-BDLDIR)         RMB0025
  9268         ELSE                                                     RMB0025
  9269            MOVE COD-SUS-DIRECC TO V-SUSCEL-BDLDIR(CEL-OK-BDLDIR) RMB0025
  9270         END-IF                                                   RMB0025
  9271        END-IF
  9272        MOVE ORIGEN-ICBDIM TO V-ORIGENCEL-BDLDIR(CEL-OK-BDLDIR)
  9273        ADD 1 TO CEL-OK-BDLDIR
  9274     END-IF.
  9275     IF E-MAIL-ICBDIM NOT = SPACES AND MAIL-OK-BDLDIR < 100
  9276*       enviamos a la rutina de acepciones y limpieza de mails
  9277        MOVE E-MAIL-ICBDIM TO WS-MAIL-BDLSTDMAI                   FARF039
  9278        PERFORM 1000-CLEANCING-BDLSTDMAI                          FARF039
  9279        MOVE WS-ACEP-MAIL-BDLSTDMAI TO E-MAIL-ICBDIM              FARF039
  9280        MOVE E-MAIL-ICBDIM TO V-MAIL-BDLDIR(MAIL-OK-BDLDIR)
  9281                          V-HASMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9282        PERFORM 2019-ELEGIR-FECHA-CELDIM
  9283        MOVE 1             TO V-NUMENTMAIL-BDLDIR(MAIL-OK-BDLDIR) ABB0034
  9284        MOVE FECHA-MEJOR-BDLDIR                                   ABB0034
  9285                           TO V-FECCREMAIL-BDLDIR(MAIL-OK-BDLDIR) ABB0034
  9286        MOVE FECHA-MEJOR-BDLDIR
  9287             TO V-FECHAMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9288        MOVE FECHA-ACT-ICBDIM
  9289             TO V-FECULTMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9290        IF ORIGEN-ICBDIM = 1
  9291           MOVE 990003 TO V-SUSMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9292        ELSE
  9293           MOVE 990005 TO V-SUSMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9294        END-IF
  9295        MOVE ORIGEN-ICBDIM TO V-ORIGENMAIL-BDLDIR(MAIL-OK-BDLDIR)
  9296        ADD 1 TO MAIL-OK-BDLDIR
  9297     END-IF.
  9298
  9299 2019-ELEGIR-FECHA-DIR.                                           VHF0015
  9300******************************************************************RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 161
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9301*2019-ELEGIR-FECHA-DIR.                                          *VHF0015
  9302*    RUTINA PARA SELECCIONAR LA MEJOR FECHA DEL DATO EN PROCESO  *RMB0010
  9303******************************************************************RMB0010
  9304***  POR DEFECTO SE TOMA LA MEJOR FECHA ENTRE LA DE ACTUALIZACION RMB0010
  9305***  Y LA DE CREACION                                             RMB0010
  9306*    IF FECACT-DIRECC >  FECCRE-DIRECC                            RMB0016
  9307*       MOVE FECACT-DIRECC TO FECHA-MEJOR-BDLDIR                  RMB0016
  9308*    ELSE                                                         RMB0016
  9309*       MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR                  RMB0016
  9310*    END-IF.                                                      RMB0016
  9311     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0  RMB0016
  9312***  SI EXISTE LA FECHA ASOCIADA AL TIPO DE DATO SE TOMA COMO LA  RMB0010
  9313***  MEJOR
  9314     EVALUATE IND-DATO-BDLDIR                                     RMB0010
  9315        WHEN "R"                                                  RMB0010
  9316           IF FECDRES-DIRECC > 0                                  VHF0015
  9317              MOVE FECDRES-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015
  9318           END-IF                                                 RMB0010
  9319        WHEN "L"                                                  RMB0010
  9320           IF FECDLAB-DIRECC > 0                                  VHF0015
  9321              MOVE FECDLAB-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015
  9322           END-IF                                                 RMB0010
  9323        WHEN "C"                                                  RMB0010
  9324           IF FECDCOR-DIRECC > 0                                  VHF0015
  9325              MOVE FECDCOR-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015
  9326           END-IF                                                 RMB0010
  9327     END-EVALUATE.                                                RMB0010
  9328
  9329 2019-ELEGIR-FECHA-TEL.                                           VHF0015
  9330******************************************************************VHF0015
  9331*2019-ELEGIR-FECHA-TEL.                                          *VHF0015
  9332*    FECHAS PARA EL MEJOR TELEFONO                               *VHF0015
  9333*    RUTINA PARA SELECCIONAR LA MEJOR FECHA DEL DATO EN PROCESO  *VHF0015
  9334******************************************************************VHF0015
  9335***  POR DEFECTO SE TOMA LA MEJOR FECHA ENTRE LA DE ACTUALIZACION VHF0015
  9336***  Y LA DE CREACION                                             VHF0015
  9337*    IF FECACT-DIRECC >  FECCRE-DIRECC                            RMB0016
  9338*       MOVE FECACT-DIRECC TO FECHA-MEJOR-BDLDIR                  RMB0016
  9339*    ELSE                                                         RMB0016
  9340*       MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR                  RMB0016
  9341*    END-IF.                                                      RMB0016
  9342     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0  RMB0016
  9343***  SI EXISTE LA FECHA ASOCIADA AL TIPO DE DATO SE TOMA COMO LA  VHF0015
  9344***  MEJOR                                                        VHF0015
  9345     EVALUATE IND-DATO-BDLDIR                                     VHF0015
  9346        WHEN "R"                                                  VHF0015
  9347           IF FECTRES-DIRECC > 0                                  VHF0015
  9348              MOVE FECTRES-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015
  9349           END-IF                                                 VHF0015
  9350        WHEN "L"                                                  VHF0015
  9351           IF FECTLAB-DIRECC > 0                                  VHF0015
  9352              MOVE FECTLAB-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015
  9353           END-IF                                                 VHF0015
  9354     END-EVALUATE.                                                VHF0015
  9355
  9356 2019-ELEGIR-FECHA-CEL.
  9357******************************************************************
  9358*2019-ELEGIR-FECHA-CEL.                                          *
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 162
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9359*    FECHAS PARA EL MEJOR CELULAR                                *
  9360*    RUTINA PARA SELECCIONAR LA MEJOR FECHA DEL DATO EN PROCESO  *
  9361******************************************************************
  9362***  POR DEFECTO SE TOMA LA MEJOR FECHA ENTRE LA DE ACTUALIZACION
  9363***  Y LA DE CREACION
  9364     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0
  9365***  SI EXISTE LA FECHA ASOCIADA AL TIPO DE DATO SE TOMA COMO LA
  9366***  MEJOR
  9367     IF FECCEL-DIRECC > 0
  9368        MOVE FECCEL-DIRECC TO FECHA-MEJOR-BDLDIR
  9369     END-IF.
  9370 2019-ELEGIR-FECHA-CELDIM.
  9371******************************************************************
  9372*2019-ELEGIR-FECHA-CEL.                                          *
  9373*    FECHAS PARA EL MEJOR CELULAR                                *
  9374*    RUTINA PARA SELECCIONAR LA MEJOR FECHA DEL DATO EN PROCESO  *
  9375******************************************************************
  9376***  POR DEFECTO SE TOMA LA MEJOR FECHA ENTRE LA DE ACTUALIZACION
  9377***  Y LA DE CREACION
  9378     MOVE FECHA-APERT-ICBDIM TO FECHA-MEJOR-BDLDIR
  9379***  SI EXISTE LA FECHA ASOCIADA AL TIPO DE DATO SE TOMA COMO LA
  9380***  MEJOR
  9381*    IF FECHA-ACT-ICBDIM > 0
  9382*       MOVE FECHA-ACT-ICBDIM TO FECHA-MEJOR-BDLDIR
  9383*    END-IF.
  9384     IF FECHA-ACT-ICBDIM = 0
  9385        MOVE  FECHA-APERT-ICBDIM TO FECHA-MEJOR-BDLDIR
  9386     END-IF.
  9387 2019-ELEGIR-FECHA-MAIL.
  9388******************************************************************
  9389*2019-ELEGIR-FECHA-MAIL.                                         *
  9390*    FECHAS PARA EL MEJOR MAIL                                   *
  9391*    RUTINA PARA SELECCIONAR LA MEJOR FECHA DEL DATO EN PROCESO  *
  9392******************************************************************
  9393***  POR DEFECTO SE TOMA LA MEJOR FECHA ENTRE LA DE ACTUALIZACION
  9394***  Y LA DE CREACION
  9395     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0
  9396***  SI EXISTE LA FECHA ASOCIADA AL TIPO DE DATO SE TOMA COMO LA
  9397***  MEJOR
  9398     IF FECMAIL-DIRECC > 0
  9399        MOVE FECMAIL-DIRECC TO FECHA-MEJOR-BDLDIR
  9400     END-IF.
  9401
  9402 2020-U-BUSCAR-NUMEROS.
  9403     MOVE 1 TO I-BDLDIR.                                          RMB0010
  9404     MOVE 0 TO J-BDLDIR.                                          RMB0010
  9405     MOVE " " TO CAR-ANT-BDLDIR.                                  RMB0010
  9406     INITIALIZE T-CARTOT-BDLDIR.                                  RMB0010
  9407     PERFORM UNTIL I-BDLDIR > 60 OR J-BDLDIR >= 10                CAV0014
  9408       IF V-CARDIR-BDLDIR(I-BDLDIR) NUMERIC                       RMB0010
  9409          MOVE V-CARDIR-BDLDIR(I-BDLDIR) TO CAR-ACT-BDLDIR        RMB0010
  9410          IF CAR-ANT-BDLDIR NUMERIC                               RMB0010
  9411             COMPUTE V-CARTOT-BDLDIR(J-BDLDIR)                    RMB0010
  9412                     = V-CARTOT-BDLDIR(J-BDLDIR)                  RMB0010
  9413                     * 10 + CAR-ACT-BDLDIR                        RMB0010
  9414          ELSE
  9415             ADD 1 TO J-BDLDIR                                    RMB0010
  9416             MOVE V-CARDIR-BDLDIR(I-BDLDIR)                       RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 163
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9417                  TO V-CARTOT-BDLDIR(J-BDLDIR)                    RMB0010
  9418          END-IF
  9419       END-IF
  9420       MOVE V-CARDIR-BDLDIR(I-BDLDIR) TO CAR-ANT-BDLDIR           RMB0010
  9421       ADD 1 TO I-BDLDIR                                          RMB0010
  9422     END-PERFORM.
  9423     MOVE T-CARTOT-BDLDIR(1:10) TO V-PRIDIG-BDLDIR(DIR-OK-BDLDIR).RMB0010
  9424     SORT V-CARTOT-BDLDIR DESCENDING.                             RMB0010
  9425     MOVE 1 TO I-BDLDIR.                                          RMB0010
  9426     PERFORM UNTIL I-BDLDIR > J-BDLDIR                            RMB0010
  9427       MOVE V-CARTOT-BDLDIR(I-BDLDIR)                             RMB0010
  9428            TO V-NUMDIR-BDLDIR(DIR-OK-BDLDIR,I-BDLDIR)            RMB0010
  9429       ADD 1 TO I-BDLDIR                                          RMB0010
  9430     END-PERFORM.
  9431     MOVE T-CARTOT-BDLDIR    TO V-HASDIR-BDLDIR(DIR-OK-BDLDIR).   RMB0010
  9432     ADD 1 TO DIR-OK-BDLDIR.                                      RMB0010
  9433*                                                                *ABB0034
  9434 2017-CALCULAR-ENTIDADES.                                         ABB0034
  9435******************************************************************ABB0034
  9436*    CUENTA EL NUMERO DE ENTIDADES QUE REPORTAN LA MISMA         *ABB0034
  9437*    DIRECCION                                                   *ABB0034
  9438*                                                                *ABB0034
  9439******************************************************************ABB0034
  9440     MOVE 1 TO I-BDLDIR                                           ABB0034
  9441     PERFORM UNTIL I-BDLDIR >= DIR-OK-BDLDIR                      ABB0034
  9442       MOVE ZEROS TO I-RES-BDLDIR I-LAB-BDLDIR I-COR-BDLDIR       ABB0034
  9443       MOVE 1     TO K-BDLDIR                                     ABB0034
  9444       INITIALIZE TABLA-SUS-BDLDIR                                ABB0034
  9445       MOVE 1     TO I-SUS-BDLDIR                                 ABB0034
  9446       MOVE V-SUSDIR-BDLDIR(I-BDLDIR) TO COD-SUSCRIP-ABD02        ABB0034
  9447       PERFORM 2017-LEER-SUSCRIPTOR                               ABB0034
  9448       MOVE NIT-SUSCRIP-S-ABD02 TO V-SUS-BDLDIR(I-SUS-BDLDIR)     ABB0034
  9449       PERFORM UNTIL K-BDLDIR >= DIR-OK-BDLDIR                    ABB0034
  9450         IF V-DIRECCION-BDLDIR(I-BDLDIR) =                        ABB0034
  9451            V-DIRECCION-BDLDIR(K-BDLDIR)                          ABB0034
  9452            IF V-FECCRE-BDLDIR(I-BDLDIR) >                        ABB0034
  9453               V-FECCRE-BDLDIR(K-BDLDIR)                          ABB0034
  9454               MOVE V-FECCRE-BDLDIR(K-BDLDIR) TO                  ABB0034
  9455                    V-FECCRE-BDLDIR(I-BDLDIR)                     ABB0034
  9456            ELSE                                                  ABB0034
  9457               MOVE V-FECCRE-BDLDIR(I-BDLDIR) TO                  ABB0034
  9458                    V-FECCRE-BDLDIR(K-BDLDIR)                     ABB0034
  9459            END-IF                                                ABB0034
  9460            IF V-TIPODIR-BDLDIR(K-BDLDIR) = "R"                   ABB0034
  9461               MOVE 1 TO I-RES-BDLDIR                             ABB0034
  9462            END-IF                                                ABB0034
  9463            IF V-TIPODIR-BDLDIR(K-BDLDIR) = "L"                   ABB0034
  9464               MOVE 2 TO I-LAB-BDLDIR                             ABB0034
  9465            END-IF                                                ABB0034
  9466            IF V-TIPODIR-BDLDIR(K-BDLDIR) = "C"                   ABB0034
  9467               MOVE 4 TO I-COR-BDLDIR                             ABB0034
  9468            END-IF                                                ABB0034
  9469            MOVE V-SUSDIR-BDLDIR(K-BDLDIR) TO COD-SUSCRIP-ABD02   ABB0034
  9470            PERFORM 2017-LEER-SUSCRIPTOR                          ABB0034
  9471            MOVE NIT-SUSCRIP-S-ABD02 TO N-SUS-BDLDIR              ABB0034
  9472            MOVE 1 TO K-SUS-BDLDIR                                ABB0034
  9473            MOVE 0 TO J-SUS-BDLDIR                                ABB0034
  9474            PERFORM UNTIL K-SUS-BDLDIR > I-SUS-BDLDIR             ABB0034
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 164
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9475              IF N-SUS-BDLDIR = V-SUS-BDLDIR(K-SUS-BDLDIR)        ABB0034
  9476                 MOVE 1 TO J-SUS-BDLDIR                           ABB0034
  9477                 MOVE I-SUS-BDLDIR TO K-SUS-BDLDIR                ABB0034
  9478              END-IF                                              ABB0034
  9479              ADD 1 TO K-SUS-BDLDIR                               ABB0034
  9480            END-PERFORM                                           ABB0034
  9481            IF J-SUS-BDLDIR = 0                                   ABB0034
  9482               ADD  1 TO I-SUS-BDLDIR                             ABB0034
  9483               MOVE N-SUS-BDLDIR TO V-SUS-BDLDIR(I-SUS-BDLDIR)    ABB0034
  9484            END-IF                                                ABB0034
  9485         END-IF                                                   ABB0034
  9486         ADD 1 TO K-BDLDIR                                        ABB0034
  9487       END-PERFORM                                                ABB0034
  9488       COMPUTE I-SDT-BDLDIR =                                     ABB0034
  9489               I-RES-BDLDIR + I-LAB-BDLDIR + I-COR-BDLDIR         ABB0034
  9490       MOVE I-SDT-BDLDIR TO V-TIPODI-BDLDIR(I-BDLDIR)             ABB0034
  9491       MOVE I-SUS-BDLDIR TO V-NUMENT-BDLDIR(I-BDLDIR)             ABB0034
  9492       ADD 1 TO I-BDLDIR                                          ABB0034
  9493     END-PERFORM.                                                 ABB0034
  9494*                                                                *ABB0034
  9495 2017-LEER-SUSCRIPTOR.                                            ABB0034
  9496******************************************************************ABB0034
  9497*    LEE SUSCRIPTORES PARA OBTENER EL NIT                        *ABB0034
  9498******************************************************************ABB0034
  9499     READ SUSCRIPTOR IGNORE LOCK                                  ABB0034
  9500        INVALID KEY                                               ABB0034
  9501           MOVE COD-SUSCRIP-ABD02 TO NIT-SUSCRIP-S-ABD02          ABB0034
  9502     END-READ.                                                    ABB0034
  9503*                                                                *ABB0034
  9504*-----------------MEJORES DIRECCIONES -----------------------------
  9505 2017-U-ELEGIR-DIRECCIONES.
  9506*******************************************************************
  9507* SE UNIFICAN LAS DIRECCIONES Y SE ORDENAN POR EL CRITERIO DE LA
  9508* MEJOR FECHA Y EL NUMERO DE OCURRENCIAS.
  9509* LA RUTINA DEVUELVE UN ARREGLO CON ESTAS DIRECCIONES ORDENADAS
  9510*         05 V-DIRFIN       PIC X(60) DIRECCION                   FAC0009
  9511*         05 V-CIUFIN       PIC X(20) CIUDAD                      FAC0009
  9512*         05 V-TIPFIN       PIC X(01) UBICACION
  9513*         05 V-FECFIN       PIC 9(6)  FECHA MEJOR.
  9514*         05 V-NUMFIN       PIC 9(3)  NUMERO DE COINCIDENCIAS.
  9515*         05 V-SUSFIN       PIC 9(6)  CODIGO DE SUSCRIPTOR.
  9516*         05 V-HASDIRFIN    PIC X(50) STRING DE NUMEROS.
  9517*         05 V-FECCREFIN    PIC 9(06) FECHA REPORTE PEIMERA VEZ
  9518*******************************************************************
  9519     MOVE 0 TO J-BDLDIR.                                          RMB0010
  9520     MOVE 0 TO J2-BDLDIR                                          HGO0021
  9521     INITIALIZE DIRECCION-BDLDIR                                  HGO0021
  9522     IF DIR-OK-BDLDIR > 1                                         RMB0010
  9523*       se ordena por direccion original y tipo de direccion
  9524*       (R,L,C)
  9525        SORT T-DIR-BDLDIR                                         RMB0010
  9526*RCNCER             DESCENDING T-NUMDIR-BDLDIR V-TIPODIR-BDLDIR   HGO0021
  9527             DESCENDING V-DIRECCION-BDLDIR V-TIPODIR-BDLDIR       HGO0021
  9528        PERFORM 2017-CALCULAR-ENTIDADES                           ABB0034
  9529        MOVE ALL "9" TO NUMDIR-BDLDIR                             RMB0010
  9530        MOVE 1 TO I-BDLDIR                                        RMB0010
  9531        MOVE ALL "0" TO TABLA-FECHADIR-AUX-BDLDIR                 RMB0010
  9532        MOVE 1 TO K-BDLDIR                                        RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 165
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9533*       se unifica por direccion original
  9534        PERFORM UNTIL I-BDLDIR >= DIR-OK-BDLDIR                   RMB0010
  9535          IF T-NUMDIR-BDLDIR(I-BDLDIR) = ZEROS                    HGO0021
  9536             IF I-BDLDIR > 1                                      HGO0021
  9537                PERFORM 2017-CALCULAR-VECTOR-RES                  HGO0021
  9538                MOVE VEC-HIS-BDLDIR TO V-VECFIN-BDLDIR(J-BDLDIR)  HGO0021
  9539             END-IF                                               HGO0021
  9540*
  9541             MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                     HGO0021
  9542                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              HGO0021
  9543             ADD 1 TO K-BDLDIR                                    HGO0021
  9544             ADD 1 TO J-BDLDIR                                    HGO0021
  9545*            MOVEMOS LOS VALORES DE DIR A FIN
  9546             PERFORM 2017-MOVER-DIR-I-A-FIN-J                     FARF035
  9547             MOVE V-DIRECCION-BDLDIR(I-BDLDIR)                    HGO0021
  9548               TO DIRECCION-BDLDIR                                HGO0021
  9549             MOVE 1                  TO V-NUMFIN-BDLDIR(J-BDLDIR) HGO0021
  9550             MOVE T-NUMDIR-BDLDIR(I-BDLDIR)    TO NUMDIR-BDLDIR   HGO0021
  9551          END-IF                                                  HGO0021
  9552*
  9553*RCNCER          IF NUMDIR-BDLDIR NOT = T-NUMDIR-BDLDIR (I-BDLDIR)HGO0021
  9554          IF DIRECCION-BDLDIR NOT = V-DIRECCION-BDLDIR(I-BDLDIR)  HGO0021
  9555          AND T-NUMDIR-BDLDIR(I-BDLDIR) NOT = ZEROS               HGO0021
  9556             IF I-BDLDIR > 1                                      RMB0010
  9557                PERFORM 2017-CALCULAR-VECTOR-RES
  9558                MOVE VEC-HIS-BDLDIR TO V-VECFIN-BDLDIR(J-BDLDIR)  RMB0010
  9559             END-IF
  9560*
  9561             MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                     RMB0010
  9562                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              RMB0010
  9563             ADD 1 TO K-BDLDIR                                    RMB0010
  9564             ADD 1 TO J-BDLDIR                                    RMB0010
  9565*            MOVEMOS LOS VALORES DE DIR A FIN
  9566             PERFORM 2017-MOVER-DIR-I-A-FIN-J                     FARF035
  9567             MOVE V-DIRECCION-BDLDIR(I-BDLDIR)                    HGO0021
  9568               TO DIRECCION-BDLDIR                                HGO0021
  9569             MOVE 1                  TO V-NUMFIN-BDLDIR(J-BDLDIR) RMB0010
  9570             MOVE T-NUMDIR-BDLDIR(I-BDLDIR)    TO NUMDIR-BDLDIR   RMB0010
  9571          ELSE
  9572             IF T-NUMDIR-BDLDIR(I-BDLDIR) NOT = ZEROS             HGO0021
  9573             MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                     RMB0010
  9574                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              RMB0010
  9575             ADD 1 TO K-BDLDIR
  9576             ADD  1 TO V-NUMFIN-BDLDIR(J-BDLDIR)                  RMB0010
  9577             IF V-FECHADIR-BDLDIR(I-BDLDIR) >                     RMB0010
  9578                V-FECFIN-BDLDIR(J-BDLDIR)                         RMB0010
  9579                MOVE V-ZONADIR-BDLDIR(I-BDLDIR)                   ABB0034
  9580                  TO V-ZONAFIN-BDLDIR(J-BDLDIR)                   ABB0034
  9581                MOVE V-FECCRE-BDLDIR(I-BDLDIR)                    ABB0034
  9582                  TO V-FECCREFIN-BDLDIR(J-BDLDIR)                 ABB0034
  9583                MOVE V-NUMENT-BDLDIR(I-BDLDIR)                    ABB0034
  9584                  TO V-NUMENTFIN-BDLDIR(J-BDLDIR)                 ABB0034
  9585                MOVE V-TIPODI-BDLDIR(I-BDLDIR)                    ABB0034
  9586                  TO V-TIPODIFIN-BDLDIR(J-BDLDIR)                 ABB0034
  9587                MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                  RMB0010
  9588                     TO V-FECFIN-BDLDIR(J-BDLDIR)                 RMB0010
  9589                MOVE V-DIRECCION-BDLDIR(I-BDLDIR)                 RMB0010
  9590                     TO V-DIRFIN-BDLDIR(J-BDLDIR)                 RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 166
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9591                MOVE V-CIUDADDIR-BDLDIR(I-BDLDIR)                 RMB0010
  9592                     TO V-CIUFIN-BDLDIR(J-BDLDIR)                 RMB0010
  9593                MOVE V-TIPODIR-BDLDIR(I-BDLDIR)                   RMB0010
  9594                     TO V-TIPFIN-BDLDIR(J-BDLDIR)                 RMB0010
  9595                MOVE V-SUSDIR-BDLDIR (I-BDLDIR)                   RMB0010
  9596                     TO V-SUSFIN-BDLDIR(J-BDLDIR)                 RMB0010
  9597                MOVE V-FECULT-BDLDIR(I-BDLDIR)                    AAM0017
  9598                     TO V-FECULTFIN-BDLDIR(J-BDLDIR)              AAM0017
  9599*               MOVE V-FECULT-BDLDIR(I-BDLDIR)                    RGH0024
  9600*                    TO V-FECULTFIN-BDLDIR(J-BDLDIR)              RGH0024
  9601                IF V-FECULT-BDLDIR(I-BDLDIR) >                    RGH0024
  9602                   V-FECULTFIN-BDLDIR(J-BDLDIR)                   RGH0024
  9603                   MOVE V-FECULT-BDLDIR(I-BDLDIR)  TO             RGH0024
  9604                        V-FECULTFIN-BDLDIR(J-BDLDIR)              RGH0024
  9605                END-IF                                            RGH0024
  9606                MOVE V-NUENOM-BDLDIR(I-BDLDIR)                    AAM0017
  9607                     TO V-NUENOMFIN-BDLDIR(J-BDLDIR)              AAM0017
  9608
  9609                MOVE V-DANEDIR-BDLDIR(I-BDLDIR)
  9610                     TO V-DANEFIN-BDLDIR(J-BDLDIR)
  9611                MOVE V-DEPTODIR-BDLDIR(I-BDLDIR)
  9612                     TO V-DEPFIN-BDLDIR(J-BDLDIR)
  9613                MOVE V-ESTRATODIR-BDLDIR(I-BDLDIR)
  9614                     TO V-ESTFIN-BDLDIR(J-BDLDIR)
  9615                MOVE V-PRBENTDIR-BDLDIR(I-BDLDIR)                 HGO0022
  9616                     TO V-PRBFIN-BDLDIR(J-BDLDIR)                 HGO0022
  9617
  9618             END-IF
  9619             END-IF                                               HGO0021
  9620          END-IF
  9621*         MARCA EN LA INICIAL EN CUAL FINAL VA
  9622          MOVE V-SEC01DIRFIN-BDLDIR(J-BDLDIR) TO                  FARF035
  9623               V-SECUNI00DIR-BDLDIR(I-BDLDIR)                     FARF035
  9624          ADD 1 TO I-BDLDIR                                       RMB0010
  9625        END-PERFORM
  9626*
  9627        IF I-BDLDIR > 1                                           RMB0010
  9628           PERFORM 2017-CALCULAR-VECTOR-RES
  9629           MOVE VEC-HIS-BDLDIR TO V-VECFIN-BDLDIR(J-BDLDIR)       RMB0010
  9630        END-IF
  9631     END-IF.
  9632*    se inicia el procesos de estandarizar direccion
  9633     IF J-BDLDIR > 0                                              RMB0010
  9634        MOVE 1 TO I-BDLDIR                                        RMB0010
  9635        PERFORM UNTIL I-BDLDIR > J-BDLDIR                         RMB0010
  9636           MOVE V-DIRFIN-BDLDIR (I-BDLDIR)                        RMB0010
  9637                TO DIRECCION-A-ESTANDARIZAR-BDLDIR                RMB0010
  9638           EVALUATE V-TIPFIN-BDLDIR(I-BDLDIR)                     RMB0010
  9639              WHEN "R"                                            RMB0010
  9640                 MOVE CIUDAD-RES-A-ESTANDAR-BDLDIR                RMB0010
  9641                      TO CIUDAD-BDLDIR                            RMB0010
  9642                 MOVE 0 TO DIRCER-BDLDIR                          RMB0010
  9643                 MOVE 0 TO PTSADI-BDLDIR                          RMB0010
  9644                 IF CERRES-DIRECC NUMERIC                         RMB0010
  9645                    MOVE CERRES-DIRECC TO DIRCER-BDLDIR           RMB0010
  9646                 END-IF                                           RMB0010
  9647                 IF ADIRES-DIRECC NUMERIC                         RMB0010
  9648                    MOVE ADIRES-DIRECC TO PTSADI-BDLDIR           RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 167
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9649                 END-IF                                           RMB0010
  9650              WHEN "L"                                            RMB0010
  9651                 MOVE CIUDAD-LAB-A-ESTANDAR-BDLDIR                RMB0010
  9652                      TO CIUDAD-BDLDIR                            RMB0010
  9653                 MOVE 0 TO DIRCER-BDLDIR                          RMB0010
  9654                 MOVE 0 TO PTSADI-BDLDIR                          RMB0010
  9655                 IF CERLAB-DIRECC NUMERIC                         RMB0010
  9656                    MOVE CERLAB-DIRECC TO DIRCER-BDLDIR           RMB0010
  9657                 END-IF                                           RMB0010
  9658                 IF ADILAB-DIRECC NUMERIC                         RMB0010
  9659                    MOVE ADILAB-DIRECC TO PTSADI-BDLDIR           RMB0010
  9660                 END-IF                                           RMB0010
  9661              WHEN "C"                                            RMB0010
  9662                 MOVE CIUDAD-COR-A-ESTANDAR-BDLDIR                RMB0010
  9663                      TO CIUDAD-BDLDIR                            RMB0010
  9664                 MOVE 0 TO DIRCER-BDLDIR                          RMB0010
  9665                 MOVE 0 TO PTSADI-BDLDIR                          RMB0010
  9666                 IF CERCOR-DIRECC NUMERIC                         RMB0010
  9667                    MOVE CERCOR-DIRECC TO DIRCER-BDLDIR           RMB0010
  9668                 END-IF                                           RMB0010
  9669                 IF ADICOR-DIRECC NUMERIC                         RMB0010
  9670                    MOVE ADICOR-DIRECC TO PTSADI-BDLDIR           RMB0010
  9671                 END-IF                                           RMB0010
  9672           END-EVALUATE                                           RMB0010
  9673*
  9674           MOVE V-DANEFIN-BDLDIR(I-BDLDIR) TO                     FARF033
  9675                V-DANEFIN-BDLDIR-AUX                              FARF033
  9676           PERFORM 6100-U-ESTANDARIZAR-DIRECC
  9677           MOVE DIRECCION-ESTANDARIZADA-BDLDIR                    RMB0010
  9678                TO V-STAFIN-BDLDIR(I-BDLDIR)                      RMB0010
  9679           MOVE PRIPART-ESTANDARIZADA-BDLDIR TO                   HGO0021
  9680            V-PRIPARTFIN-BDLDIR(I-BDLDIR)                         HGO0021
  9681           MOVE SEGPART-ESTANDARIZADA-BDLDIR TO                   HGO0021
  9682            V-SEGPARTFIN-BDLDIR(I-BDLDIR)                         HGO0021
  9683           MOVE CALIFICA-DIR-BDLDIR TO V-CALFIN-BDLDIR(I-BDLDIR)  RMB0010
  9684           IF V-CALFIN-BDLDIR(I-BDLDIR) >= 30                     FARF029
  9685              MOVE 40 TO V-CALFIN-BDLDIR(I-BDLDIR)                FARF029
  9686           END-IF                                                 FARF029
  9687*
  9688           MOVE CALIFICA-DIRPART1-BDLDIR TO                       HGO0021
  9689            V-CALFIN-PART1-BDLDIR(I-BDLDIR)                       HGO0021
  9690           MOVE CALIFICA-DIRPART2-BDLDIR TO                       HGO0021
  9691            V-CALFIN-PART2-BDLDIR(I-BDLDIR)                       HGO0021
  9692***        SE ELIMINAN LAS DIRECCIONES MENORES A LA POLITICA      RMB0010
  9693           IF CALIFICA-DIR-BDLDIR < POLITICA-EXC-CAL-DIR-BDLDIR ORRMB0010
  9694              CALIFICA-DIR-BDLDIR = 0                             RMB0010
  9695              MOVE 0                  TO V-FECFIN-BDLDIR(I-BDLDIR)RMB0010
  9696           END-IF                                                 RMB0010
  9697           ADD 1 TO I-BDLDIR                                      RMB0010
  9698        END-PERFORM
  9699*       busca nueva nomenclatura de bogota
  9700        MOVE 1 TO I-BDLDIR                                        AAM0017
  9701        PERFORM UNTIL I-BDLDIR > J-BDLDIR                         AAM0017
  9702         MOVE V-CIUFIN-BDLDIR(I-BDLDIR)  TO CIUDAD-BTA-BDLDIR     AAM0017
  9703         MOVE V-STAFIN-BDLDIR(I-BDLDIR)  TO DIRECCION-BTA-BDLDIR  AAM0017
  9704         PERFORM 2590-NVA-DIRECC-BOGOTA                           AAM0017
  9705         IF HAY-BDLNEWDIRBOG-BDLDIR = 1                           AAM0017
  9706          MOVE DIRNEW-BDLNEWDIRBOG TO V-STAFIN-BDLDIR(I-BDLDIR)   AAM0017
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 168
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9707          MOVE 0 TO V-NUENOMFIN-BDLDIR(I-BDLDIR)                  FARF031
  9708          MOVE 1 TO V-NN01DIRFIN-BDLDIR(I-BDLDIR)                 FARF035
  9709* inicio comentario                                               FARF031
  9710*          MOVE 1 TO V-NUENOMFIN-BDLDIR(I-BDLDIR)                  AAM0017
  9711* fin comentario                                                  FARF031
  9712         END-IF                                                   AAM0017
  9713         ADD 1 TO I-BDLDIR                                        AAM0017
  9714        END-PERFORM                                               AAM0017
  9715*       calcula el hash de unificaciondesde la estandar
  9716        MOVE 1 TO I-BDLDIR                                        AAM0017
  9717        PERFORM UNTIL I-BDLDIR > J-BDLDIR                         AAM0017
  9718         MOVE V-STAFIN-BDLDIR(I-BDLDIR) TO DIRECCION              AAM0017
  9719         PERFORM 2017-VECTOR-UNO                                  AAM0017
  9720         MOVE DIRECCION1 TO V-NUMDIRFIN-BDLDIR(I-BDLDIR)          AAM0017
  9721         ADD 1 TO I-BDLDIR                                        AAM0017
  9722        END-PERFORM                                               AAM0017
  9723*       ordena las finales por si tiene nueva nomenclatura
  9724        MOVE 0 TO CAMBIO                                          AAM0017
  9725        MOVE 0 TO RMAYOR                                          AAM0018
  9726*UNIDIR        SORT T-DIRFINALES-BDLDIR DESCENDING V-NUMDIRFIN-BDLHGO0021
  9727*UNIDIR                                            V-NUENOMFIN-BDLHGO0021
  9728        SORT T-DIRFINALES-BDLDIR DESCENDING V-NUENOMFIN-BDLDIR    HGO0021
  9729*       unifica direcciones de nueva nomenclatura en matrix
  9730*       auxiliar
  9731        MOVE 1 TO J1-BDLDIR                                       HGO0021
  9732        MOVE 1 TO G-BDLDIR                                        HGO0021
  9733        PERFORM UNTIL J1-BDLDIR > J-BDLDIR                        HGO0021
  9734         IF V-NUENOMFIN-BDLDIR(J1-BDLDIR) = 1 AND                 HGO0021
  9735         V-STAFIN-BDLDIR(J1-BDLDIR) <> SPACES                     HGO0021
  9736            MOVE 0 TO CONTA                                       HGO0021
  9737            INSPECT V-NUMDIRFIN-BDLDIR(J1-BDLDIR) TALLYING CONTA  HGO0021
  9738            FOR CHARACTERS BEFORE INITIAL "  "                    HGO0021
  9739            COMPUTE H-BDLDIR = J1-BDLDIR + 1                      HGO0021
  9740            MOVE 0 TO SW-NN                                       PJV0026
  9741            PERFORM UNTIL H-BDLDIR > J-BDLDIR                     HGO0021
  9742              MOVE 1 TO SW-NN                                     PJV0026
  9743              MOVE 0 TO CONTA1                                    HGO0021
  9744              INSPECT V-NUMDIRFIN-BDLDIR(H-BDLDIR) TALLYING CONTA1HGO0021
  9745              FOR CHARACTERS BEFORE INITIAL "   "                 HGO0021
  9746               IF CONTA >= CONTA1 AND CONTA1 > 0 AND              HGO0021
  9747               (V-NUMDIRFIN-BDLDIR(J1-BDLDIR)(1:CONTA1) =         HGO0021
  9748               V-NUMDIRFIN-BDLDIR(H-BDLDIR)(1:CONTA1))            HGO0021
  9749                  PERFORM 2017-UNINN                              HGO0021
  9750               ELSE                                               HGO0021
  9751                  IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =          HGO0021
  9752                  V-NUMDIRFINAUX-BDLDIR                           HGO0021
  9753                     MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO       HGO0021
  9754                     T-DIRFINALESAUX-BDLDIR                       HGO0021
  9755                  END-IF                                          HGO0021
  9756               END-IF                                             HGO0021
  9757               ADD 1 TO H-BDLDIR                                  HGO0021
  9758            END-PERFORM                                           HGO0021
  9759            IF SW-NN = 0                                          PJV0026
  9760               MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO             PJV0026
  9761                    T-DIRFINALESAUX-BDLDIR                        PJV0026
  9762            END-IF                                                PJV0026
  9763*           se salva la secuencia antes de inicializar
  9764            MOVE V-SEC01DIRFIN-BDLDIR(J1-BDLDIR) TO SEC-BDLDIR    FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 169
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9765            INITIALIZE T-DIRFINALES-BDLDIR(J1-BDLDIR)             HGO0021
  9766            MOVE SEC-BDLDIR TO V-SEC01DIRFIN-BDLDIR(J1-BDLDIR)    FARF035
  9767            MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO             FARF035
  9768                 V-SECUNI01DIRFIN-BDLDIR(J1-BDLDIR)               FARF035
  9769            ADD 1 TO J2-BDLDIR                                    HGO0021
  9770            MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO SEC-BDLDIR  FARF035
  9771            MOVE T-DIRFINALESAUX-BDLDIR TO                        HGO0021
  9772               T-DIRFINALESFIN-BDLDIR(G-BDLDIR)                   HGO0021
  9773            MOVE SEC-BDLDIR TO V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR)  FARF035
  9774            INITIALIZE T-DIRFINALESAUX-BDLDIR                     PJV0026
  9775            ADD 1 TO G-BDLDIR                                     HGO0021
  9776            ADD 1 TO J1-BDLDIR                                    HGO0021
  9777         ELSE                                                     HGO0021
  9778            COMPUTE J1-BDLDIR = J-BDLDIR + 1                      HGO0021
  9779         END-IF                                                   HGO0021
  9780        END-PERFORM                                               HGO0021
  9781*       ordena por parte numerica y calificacion
  9782        SORT T-DIRFINALES-BDLDIR DESCENDING V-NUMDIRFIN-BDLDIR    HGO0021
  9783                                            V-CALFIN-BDLDIR       HGO0021
  9784                                            V-STAFIN-BDLDIR       HGO0021
  9785        COMPUTE J-BDLDIR = J-BDLDIR - J2-BDLDIR                   HGO0021
  9786        MOVE 1 TO J1-BDLDIR                                       HGO0021
  9787        PERFORM UNTIL J1-BDLDIR > J-BDLDIR                        HGO0021
  9788         MOVE 0 TO COMPO                                          AAM0017
  9789         INSPECT V-STAFIN-BDLDIR(J1-BDLDIR) TALLYING COMPO        HGO0021
  9790         FOR ALL SPACE BEFORE INITIAL "  "                        AAM0017
  9791         IF COMPO > 0 AND V-CALFIN-BDLDIR(J1-BDLDIR) > 0          HGO0021
  9792            MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO             FARF035
  9793                 V-SECUNI01DIRFIN-BDLDIR(J1-BDLDIR)               FARF035
  9794*          MOVE 0 TO CONTA                                         AAM0017
  9795*          INSPECT V-NUMDIRFIN-BDLDIR(J1-BDLDIR) TALLYING CONTA    HGO0021
  9796*          FOR CHARACTERS BEFORE INITIAL "  "                      AAM0017
  9797          COMPUTE H-BDLDIR = J1-BDLDIR + 1                        HGO0021
  9798          PERFORM UNTIL H-BDLDIR > J-BDLDIR                       HGO0021
  9799*           IF V-NUMDIRFIN-BDLDIR(H-BDLDIR) = SPACES               PJV0027
  9800*            MOVE ZEROS TO V-NUMDIRFIN-BDLDIR(H-BDLDIR)            PJV0027
  9801*           END-IF                                                 PJV0027
  9802*
  9803           IF V-NUMDIRFIN-BDLDIR(H-BDLDIR) = SPACES
  9804            MOVE ZEROS TO V-NUMDIRFIN-BDLDIR(H-BDLDIR)
  9805           END-IF
  9806*
  9807           MOVE 0 TO CONTA1                                       AAM0017
  9808           INSPECT V-NUMDIRFIN-BDLDIR(H-BDLDIR) TALLYING CONTA1   AAM0017
  9809           FOR CHARACTERS BEFORE INITIAL "   "                    AAM0017
  9810            IF (V-PRIPARTFIN-BDLDIR(J1-BDLDIR) =                  HGO0021
  9811              V-PRIPARTFIN-BDLDIR(H-BDLDIR) OR                    HGO0021
  9812              V-SEGPARTFIN-BDLDIR(J1-BDLDIR) =                    HGO0021
  9813              V-SEGPARTFIN-BDLDIR(H-BDLDIR) OR                    HGO0021
  9814              V-PRIPARTFIN-BDLDIR(J1-BDLDIR) =                    HGO0021
  9815              V-SEGPARTFIN-BDLDIR(H-BDLDIR) OR                    HGO0021
  9816              V-SEGPARTFIN-BDLDIR(J1-BDLDIR) =                    HGO0021
  9817              V-PRIPARTFIN-BDLDIR(H-BDLDIR))                      HGO0021
  9818             PERFORM 2017-UNIMAYOR                                AAM0017
  9819            ELSE                                                  AAM0017
  9820               IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =             HGO0021
  9821               V-NUMDIRFINAUX-BDLDIR                              HGO0021
  9822                  MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO          HGO0021
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 170
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9823                   T-DIRFINALESAUX-BDLDIR                         AAM0017
  9824               END-IF                                             HGO0021
  9825            END-IF                                                AAM0017
  9826*
  9827           ADD 1 TO H-BDLDIR                                      HGO0021
  9828          END-PERFORM                                             AAM0017
  9829*
  9830          IF H-BDLDIR > J-BDLDIR                                  HGO0021
  9831            IF ((V-CALFIN-PART1-BDLDIR(J1-BDLDIR) > 6 AND         HGO0021
  9832            V-STAFIN-BDLDIR(J1-BDLDIR) NOT =                      HGO0021
  9833            V-STAFINAUX-BDLDIR) OR                                HGO0021
  9834            (V-CALFIN-PART1-BDLDIR(J1-BDLDIR) > 6 AND             HGO0021
  9835            V-NUMDIRFIN-BDLDIR(J1-BDLDIR) = SPACES)) AND          HGO0021
  9836            V-DIRFIN-BDLDIR(J1-BDLDIR) NOT =                      HGO0021
  9837            V-DIRFINAUX-BDLDIR                                    HGO0021
  9838               MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO             HGO0021
  9839               T-DIRFINALESAUX-BDLDIR                             AAM0017
  9840            END-IF                                                HGO0021
  9841          END-IF                                                  HGO0021
  9842         END-IF                                                   AAM0017
  9843*
  9844         MOVE 0 TO CONTA1                                         HGO0021
  9845         INSPECT V-PRIPARTFIN-BDLDIR(J1-BDLDIR) TALLYING CONTA1   HGO0021
  9846         FOR CHARACTERS BEFORE INITIAL "   "                      HGO0021
  9847         IF V-CALFIN-PART1-BDLDIR(J1-BDLDIR) > 6 AND              HGO0021
  9848            V-CALFIN-BDLDIR(J1-BDLDIR) > 0 AND CONTA1 > 1         HGO0021
  9849            MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO SEC-BDLDIR  FARF035
  9850            MOVE T-DIRFINALESAUX-BDLDIR TO                        HGO0021
  9851            T-DIRFINALESFIN-BDLDIR(G-BDLDIR)                      HGO0021
  9852            MOVE SEC-BDLDIR TO V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR)  FARF035
  9853            ADD 1 TO G-BDLDIR                                     HGO0021
  9854         ELSE                                                     FARF035
  9855            IF CONTA1 > 0                                         FARF035
  9856              *> DIRECCION ELIMINADA POR NO CUMPLIR LO MINIMO     FARF035
  9857               MOVE 0 TO V-SECUNI01DIRFIN-BDLDIR(J1-BDLDIR)       FARF035
  9858            END-IF                                                FARF035
  9859         END-IF                                                   HGO0021
  9860         ADD 1 TO J1-BDLDIR                                       HGO0021
  9861        END-PERFORM                                               AAM0017
  9862        PERFORM PASAR-A-TABLA-FINAL                               PJV0027
  9863     END-IF.                                                      FARF035
  9864*    CONTEO DE ENTIDADES PARA DIRECCIONES                         FARF035
  9865     MOVE 1  TO I-BDLDIR.                                         FARF035
  9866     PERFORM UNTIL V-FECFIN-BDLDIR(I-BDLDIR) = 0                  FARF035
  9867                  OR I-BDLDIR > 100                               FARF035
  9868        MOVE  1 TO J-BDLDIR                                       FARF035
  9869        MOVE SPACES TO M-CONTEOS-TEX                              FARF035
  9870        MOVE ZEROS  TO M-CONTEOS-NUM                              FARF035
  9871        MOVE 0 TO I-RES-BDLDIR I-LAB-BDLDIR I-COR-BDLDIR          FARF035
  9872        MOVE 0 TO I-SDT-BDLDIR                                    FARF035
  9873        PERFORM UNTIL J-BDLDIR > 100                              FARF035
  9874           IF V-SECUNI00DIR-BDLDIR(J-BDLDIR) =                    FARF035
  9875              V-SEC01DIRFIN-BDLDIR(I-BDLDIR)                      FARF035
  9876              MOVE V-SUSDIR-BDLDIR(J-BDLDIR) TO COD-SUSCRIP-ABD02 FARF035
  9877              PERFORM 1000-CONTAR-SUSCRIPTORES                    FARF035
  9878              PERFORM 1000-CONTAR-TIPOS-UBICACION-DIR             FARF035
  9879           END-IF                                                 FARF035
  9880*                                                                 FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 171
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9881           ADD 1 TO J-BDLDIR                                      FARF035
  9882        END-PERFORM                                               FARF035
  9883*                                                                 FARF035
  9884        MOVE I-SDT-BDLDIR TO V-NUMENTFIN-BDLDIR(I-BDLDIR)         FARF035
  9885        COMPUTE V-TIPODIFIN-BDLDIR(I-BDLDIR) =                    FARF035
  9886                I-RES-BDLDIR * 1 +                                FARF035
  9887                I-LAB-BDLDIR * 2 +                                FARF035
  9888                I-COR-BDLDIR * 4                                  FARF035
  9889        ADD 1 TO I-BDLDIR                                         FARF035
  9890     END-PERFORM.                                                 FARF035
  9891*                                                                 FARF035
  9892*2017-MOVER-DIR-I-A-FIN-J                                         FARF035
  9893*    SE MUEVEN LOS ELEMENTOS DE LA MATRIZ DIR A LA MATRIZ FIN     FARF035
  9894*                                                                 FARF035
  9895 2017-MOVER-DIR-I-A-FIN-J.                                        FARF035
  9896     MOVE V-ZONADIR-BDLDIR(I-BDLDIR)                              ABB0034
  9897       TO V-ZONAFIN-BDLDIR(J-BDLDIR).                             ABB0034
  9898     MOVE V-FECCRE-BDLDIR(I-BDLDIR)                               ABB0034
  9899       TO V-FECCREFIN-BDLDIR(J-BDLDIR).                           ABB0034
  9900     MOVE V-NUMENT-BDLDIR(I-BDLDIR)                               ABB0034
  9901       TO V-NUMENTFIN-BDLDIR(J-BDLDIR).                           ABB0034
  9902     MOVE V-TIPODI-BDLDIR(I-BDLDIR)                               ABB0034
  9903       TO V-TIPODIFIN-BDLDIR(J-BDLDIR).                           ABB0034
  9904     MOVE V-DIRECCION-BDLDIR(I-BDLDIR)                            HGO0021
  9905       TO V-DIRFIN-BDLDIR(J-BDLDIR).                              HGO0021
  9906     MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                             HGO0021
  9907       TO V-FECFIN-BDLDIR(J-BDLDIR).                              HGO0021
  9908     MOVE V-CIUDADDIR-BDLDIR(I-BDLDIR)                            HGO0021
  9909       TO V-CIUFIN-BDLDIR(J-BDLDIR).                              HGO0021
  9910     MOVE V-TIPODIR-BDLDIR(I-BDLDIR)                              HGO0021
  9911       TO V-TIPFIN-BDLDIR(J-BDLDIR).                              HGO0021
  9912     MOVE V-SUSDIR-BDLDIR (I-BDLDIR)                              HGO0021
  9913       TO V-SUSFIN-BDLDIR(J-BDLDIR).                              HGO0021
  9914     MOVE V-HASDIR-BDLDIR (I-BDLDIR)                              HGO0021
  9915       TO V-HASDIRFIN-BDLDIR(J-BDLDIR).                           HGO0021
  9916     MOVE V-PRIDIG-BDLDIR (I-BDLDIR)                              HGO0021
  9917       TO V-PRIDIGFIN-BDLDIR(J-BDLDIR).                           HGO0021
  9918     MOVE V-FECULT-BDLDIR(I-BDLDIR)                               HGO0021
  9919       TO V-FECULTFIN-BDLDIR(J-BDLDIR).                           HGO0021
  9920     MOVE V-NUENOM-BDLDIR(I-BDLDIR)                               HGO0021
  9921       TO V-NUENOMFIN-BDLDIR(J-BDLDIR).                           HGO0021
  9922     MOVE V-DANEDIR-BDLDIR(I-BDLDIR)                              FARF030
  9923       TO V-DANEFIN-BDLDIR(J-BDLDIR).                             FARF030
  9924     MOVE V-DEPTODIR-BDLDIR(I-BDLDIR)                             FARF030
  9925       TO V-DEPFIN-BDLDIR(J-BDLDIR).                              FARF030
  9926     MOVE V-ESTRATODIR-BDLDIR(I-BDLDIR)                           FARF030
  9927       TO V-ESTFIN-BDLDIR(J-BDLDIR).                              FARF030
  9928     MOVE V-PRBENTDIR-BDLDIR(I-BDLDIR)                            FARF030
  9929       TO V-PRBFIN-BDLDIR(J-BDLDIR).                              FARF030
  9930*
  9931 1000-CONTAR-SUSCRIPTORES.                                        FARF035
  9932     PERFORM 2017-LEER-SUSCRIPTOR                                 FARF035
  9933     MOVE 1 TO K-BDLDIR                                           FARF035
  9934     PERFORM UNTIL NIT-SUSCRIP-S-ABD02 = V-NUM-CONTEO1(K-BDLDIR)  FARF035
  9935             OR V-NUM-CONTEO1(K-BDLDIR) = 0 OR K-BDLDIR > 100     FARF035
  9936        ADD 1 TO K-BDLDIR                                         FARF035
  9937     END-PERFORM.                                                 FARF035
  9938*                                                                 FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 172
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9939     IF V-NUM-CONTEO1(K-BDLDIR) = ZEROS                           FARF035
  9940        MOVE NIT-SUSCRIP-S-ABD02 TO  V-NUM-CONTEO1(K-BDLDIR)      FARF035
  9941        MOVE K-BDLDIR TO I-SDT-BDLDIR                             FARF035
  9942     END-IF.                                                      FARF035
  9943*
  9944 1000-CONTAR-TIPOS-UBICACION-DIR.                                 FARF035
  9945     IF V-TIPODIR-BDLDIR(J-BDLDIR) = "R"                          FARF035
  9946        MOVE 1 TO I-RES-BDLDIR                                    FARF035
  9947     END-IF.                                                      FARF035
  9948*                                                                 FARF035
  9949     IF V-TIPODIR-BDLDIR(J-BDLDIR) = "L"                          FARF035
  9950        MOVE 1 TO I-LAB-BDLDIR                                    FARF035
  9951     END-IF.                                                      FARF035
  9952*                                                                 FARF035
  9953     IF V-TIPODIR-BDLDIR(J-BDLDIR) = "C"                          FARF035
  9954        MOVE 1 TO I-COR-BDLDIR                                    FARF035
  9955     END-IF.                                                      FARF035
  9956*
  9957 1000-CONTAR-TIPOS-UBICACION-TEL.                                 FARF035
  9958     IF V-TIPOTEL-BDLDIR(J-BDLDIR) = "R"                          FARF035
  9959        MOVE 1 TO I-RES-BDLDIR                                    FARF035
  9960     END-IF.                                                      FARF035
  9961*                                                                 FARF035
  9962     IF V-TIPOTEL-BDLDIR(J-BDLDIR) = "L"                          FARF035
  9963        MOVE 1 TO I-LAB-BDLDIR                                    FARF035
  9964     END-IF.                                                      FARF035
  9965*
  9966 PASAR-A-TABLA-FINAL.                                             PJV0027
  9967     INITIALIZE T-DIRFINALESAUX-BDLDIR                            PJV0027
  9968     MOVE 1 TO CON-PART-ESTANDARIZADA-BDLDIR                      PJV0027
  9969*    PERFORM UNTIL CON-PART-ESTANDARIZADA-BDLDIR > J-BDLDIR       PJV0027
  9970     PERFORM UNTIL CON-PART-ESTANDARIZADA-BDLDIR > 100 OR         FARF035
  9971        V-DIRFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) = SPACESFARF035
  9972        IF V-STAFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) =    PJV0027
  9973              V-STAFINAUX-BDLDIR                                  PJV0027
  9974            MOVE V-STAFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)PJV0027
  9975              TO V-STAFINAUX-BDLDIR                               PJV0027
  9976           INITIALIZE                                             PJV0027
  9977             T-DIRFINALESFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)PJV0027
  9978*          SE ALMACENA LA SECUENCIA DEL REGISTRO IGUAL            FARF035
  9979*          PARA LUEGO SER RESTAURADA EN EL LOOP SIGUIENTE         FARF035
  9980           MOVE SEC-BDLDIR TO                                     FARF035
  9981         V-SECUNI02DIRFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)FARF035
  9982        ELSE                                                      PJV0027
  9983           MOVE V-STAFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) PJV0027
  9984             TO V-STAFINAUX-BDLDIR                                PJV0027
  9985*          SE GUARDA LA SECUENCIA POR SI SE BORRA UN REGISTR IGUALFARF035
  9986           MOVE                                                   FARF035
  9987            V-SEC02DIRFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)FARF035
  9988             TO SEC-BDLDIR                                        FARF035
  9989        END-IF                                                    PJV0027
  9990        ADD 1 TO CON-PART-ESTANDARIZADA-BDLDIR                    PJV0027
  9991     END-PERFORM                                                  PJV0027
  9992*                                                                 FARF035
  9993*    SE ACTUALIZA LA RELACION ENTRE LA TABLA 02 (FINAL) Y LO      FARF035
  9994*    QUE DEBE QUEDAR EN LA TABLA 00  (INICIAL)                    FARF035
  9995     MOVE 1 TO I-BDLDIR.                                          FARF035
  9996     PERFORM UNTIL I-BDLDIR > 100                                 FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 173
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
  9997        IF V-SECUNI00DIR-BDLDIR(I-BDLDIR) > 0                     FARF035
  9998           MOVE 1 TO J-BDLDIR                                     FARF035
  9999           PERFORM UNTIL J-BDLDIR > 100                           FARF035
 10000              IF V-SECUNI00DIR-BDLDIR(I-BDLDIR) =                 FARF035
 10001                 V-SEC01DIRFIN-BDLDIR(J-BDLDIR)                   FARF035
 10002                 MOVE V-SECUNI01DIRFIN-BDLDIR(J-BDLDIR) TO        FARF035
 10003                      SEC-BDLDIR                                  FARF035
 10004                 IF SEC-BDLDIR > 0                                FARF035
 10005                    IF V-SEC02DIRFINFIN-BDLDIR(SEC-BDLDIR) > 0    FARF035
 10006                       MOVE V-SECUNI01DIRFIN-BDLDIR(J-BDLDIR) TO  FARF035
 10007                            V-SECUNI00DIR-BDLDIR(I-BDLDIR)        FARF035
 10008                    ELSE *> SE RESTAURA LA SECUENCIA DEL          FARF035
 10009                         *> REGISTRO INICIALIZADO EN EL PASO ANTESFARF035
 10010                       MOVE V-SECUNI02DIRFINFIN-BDLDIR(SEC-BDLDIR)FARF035
 10011                            TO V-SECUNI00DIR-BDLDIR(I-BDLDIR)     FARF035
 10012                    END-IF                                        FARF035
 10013                 ELSE                                             FARF037
 10014                    MOVE 0 TO V-SECUNI00DIR-BDLDIR(I-BDLDIR)      FARF037
 10015                 END-IF                                           FARF035
 10016*                                                                 FARF035
 10017                 MOVE 200  TO J-BDLDIR                            FARF035
 10018              ELSE                                                FARF035
 10019                 ADD 1 TO J-BDLDIR                                FARF035
 10020              END-IF                                              FARF035
 10021           END-PERFORM                                            FARF035
 10022        END-IF                                                    FARF035
 10023        ADD 1 TO I-BDLDIR                                         FARF035
 10024     END-PERFORM.                                                 FARF035
 10025*                                                                 FARF035
 10026     MOVE TABLA-DIRFINALESFIN-BDLDIR TO TABLA-DIRFINALES-BDLDIR   PJV0027
 10027*    LAS DIRECCIONES NO RELACIONADAS SE COLOCAN EN 0              FARF035
 10028     MOVE 1  TO I-BDLDIR.                                         FARF035
 10029     PERFORM UNTIL I-BDLDIR > 100                                 FARF035
 10030        IF V-SECUNI00DIR-BDLDIR(I-BDLDIR) > 0                     FARF035
 10031           MOVE 1 TO J-BDLDIR                                     FARF035
 10032           PERFORM UNTIL J-BDLDIR > 100                           FARF035
 10033              IF V-SECUNI00DIR-BDLDIR(I-BDLDIR) =                 FARF035
 10034                 V-SEC01DIRFIN-BDLDIR(J-BDLDIR)                   FARF035
 10035                 IF  V-FECFIN-BDLDIR(J-BDLDIR) = ZEROS            FARF035
 10036                     MOVE 0 TO V-SECUNI00DIR-BDLDIR(I-BDLDIR)     FARF035
 10037                 END-IF                                           FARF035
 10038*                                                                 FARF035
 10039                 MOVE V-NN01DIRFIN-BDLDIR    (J-BDLDIR) TO        FARF035
 10040                      V-NUENOM-BDLDIR(I-BDLDIR)                   FARF035
 10041                 MOVE V-STAFIN-BDLDIR        (J-BDLDIR) TO        FARF035
 10042                      V-DIRNN00DIR-BDLDIR(I-BDLDIR)               FARF035
 10043                 MOVE 200  TO J-BDLDIR                            FARF035
 10044              ELSE                                                FARF035
 10045                 ADD 1 TO J-BDLDIR                                FARF035
 10046              END-IF                                              FARF035
 10047           END-PERFORM                                            FARF035
 10048        END-IF                                                    FARF035
 10049*                                                                 FARF035
 10050        ADD 1 TO I-BDLDIR                                         FARF035
 10051     END-PERFORM.                                                 FARF035
 10052*                                                                 FARF035
 10053     SORT T-DIRFINALES-BDLDIR DESCENDING V-CALFIN-BDLDIR          PJV0027
 10054                              DESCENDING V-FECFIN-BDLDIR          PJV0027
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 174
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10055                              DESCENDING V-NUMFIN-BDLDIR.         PJV0027
 10056*
 10057 2017-UNINN.                                                      AAM0017
 10058******************************************************************
 10059*2017-UNINN.                                                     *
 10060*    SE CALCULA UNIFICACION DE DIRECCIONES NUEVA NOMENCALTURA    *
 10061******************************************************************
 10062     IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT = V-NUMDIRFINAUX-BDLDIR HGO0021
 10063*       se mueve el elemnto j a la variable
 10064        MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO                    HGO0021
 10065             T-DIRFINALESAUX-BDLDIR                               HGO0021
 10066        PERFORM  2017-MOVER-H-TO-J
 10067     ELSE                                                         AAM0017
 10068        PERFORM  2017-MOVER-H-TO-J
 10069     END-IF.                                                      AAM0017
 10070*    se salva la secuencia antes de inicializar
 10071     MOVE V-SEC01DIRFIN-BDLDIR(H-BDLDIR) TO SEC-BDLDIR            FARF035
 10072     INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)                     HGO0021
 10073     MOVE SEC-BDLDIR TO V-SEC01DIRFIN-BDLDIR(H-BDLDIR)            FARF035
 10074     MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO                    FARF035
 10075          V-SECUNI01DIRFIN-BDLDIR(H-BDLDIR)                       FARF035
 10076     ADD 1 TO J2-BDLDIR.                                          HGO0021
 10077*
 10078 2017-UNIMAYOR.                                                   AAM0017
 10079******************************************************************
 10080*2017-UNIMAYOR.                                                  *
 10081*    SE CALCULA UNIFICACION DE DIRECCIONES MAS COMPLETAS         *
 10082******************************************************************
 10083     IF V-PRIPARTFIN-BDLDIR(J1-BDLDIR) =                          HGO0021
 10084        V-PRIPARTFIN-BDLDIR(H-BDLDIR) AND                         HGO0021
 10085        V-SEGPARTFIN-BDLDIR(J1-BDLDIR) =                          HGO0021
 10086        V-SEGPARTFIN-BDLDIR(H-BDLDIR)                             HGO0021
 10087        IF CONTA1 = 0                                             HGO0021
 10088           MOVE 1 TO CONTA1                                       HGO0021
 10089        END-IF                                                    HGO0021
 10090*
 10091        IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR)(1:CONTA1) =              HGO0021
 10092           V-NUMDIRFIN-BDLDIR(H-BDLDIR)(1:CONTA1)                 HGO0021
 10093           IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =                 HGO0021
 10094              V-NUMDIRFINAUX-BDLDIR OR
 10095              V-DIRFIN-BDLDIR(J1-BDLDIR) NOT =  V-DIRFINAUX-BDLDIRHGO0021
 10096*             se mueve el elemnto j a la variable
 10097              MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO              HGO0021
 10098                   T-DIRFINALESAUX-BDLDIR                         HGO0021
 10099              PERFORM  2017-MOVER-H-TO-J
 10100*             se salva la secuencia antes de inicializar
 10101              MOVE V-SEC01DIRFIN-BDLDIR(H-BDLDIR) TO SEC-BDLDIR   FARF035
 10102              INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)            HGO0021
 10103              MOVE SEC-BDLDIR TO V-SEC01DIRFIN-BDLDIR(H-BDLDIR)   FARF035
 10104              MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO           FARF035
 10105                   V-SECUNI01DIRFIN-BDLDIR(H-BDLDIR)              FARF035
 10106           ELSE                                                   HGO0021
 10107              PERFORM  2017-MOVER-H-TO-J
 10108              MOVE V-SEC01DIRFIN-BDLDIR(H-BDLDIR) TO SEC-BDLDIR   FARF035
 10109              INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)            HGO0021
 10110              MOVE SEC-BDLDIR TO V-SEC01DIRFIN-BDLDIR(H-BDLDIR)   FARF035
 10111              MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO           FARF035
 10112                   V-SECUNI01DIRFIN-BDLDIR(H-BDLDIR)              FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 175
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10113           END-IF                                                 HGO0021
 10114        ELSE                                                      HGO0021
 10115          IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =                  HGO0021
 10116             V-NUMDIRFINAUX-BDLDIR                                HGO0021
 10117               MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO             HGO0021
 10118                    T-DIRFINALESAUX-BDLDIR                        HGO0021
 10119          END-IF                                                  HGO0021
 10120        END-IF                                                    HGO0021
 10121     ELSE                                                         HGO0021
 10122        IF V-SEGPARTFIN-BDLDIR(J1-BDLDIR) =                       HGO0021
 10123           V-PRIPARTFIN-BDLDIR(H-BDLDIR)                          HGO0021
 10124           IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR)(1:CONTA1) =           HGO0021
 10125              V-NUMDIRFIN-BDLDIR(H-BDLDIR)(1:CONTA1)              HGO0021
 10126              IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =              HGO0021
 10127                 V-NUMDIRFINAUX-BDLDIR                            HGO0021
 10128*                se mueve el elemnto j a la variable
 10129                 MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO           HGO0021
 10130                      T-DIRFINALESAUX-BDLDIR                      HGO0021
 10131                 PERFORM  2017-MOVER-H-TO-J
 10132                 MOVE V-SEC01DIRFIN-BDLDIR(H-BDLDIR) TO SEC-BDLDIRFARF035
 10133                 INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)         HGO0021
 10134                 MOVE SEC-BDLDIR TO V-SEC01DIRFIN-BDLDIR(H-BDLDIR)FARF035
 10135                 MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO        FARF035
 10136                      V-SECUNI01DIRFIN-BDLDIR(H-BDLDIR)           FARF035
 10137              ELSE                                                HGO0021
 10138                 PERFORM  2017-MOVER-H-TO-J
 10139                 MOVE V-SEC01DIRFIN-BDLDIR(H-BDLDIR) TO SEC-BDLDIRFARF035
 10140                 INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)         HGO0021
 10141                 MOVE SEC-BDLDIR TO V-SEC01DIRFIN-BDLDIR(H-BDLDIR)FARF035
 10142                 MOVE V-SEC02DIRFINFIN-BDLDIR(G-BDLDIR) TO        FARF035
 10143                      V-SECUNI01DIRFIN-BDLDIR(H-BDLDIR)           FARF035
 10144              END-IF                                              HGO0021
 10145           ELSE                                                   HGO0021
 10146              IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =              HGO0021
 10147                 V-NUMDIRFINAUX-BDLDIR                            HGO0021
 10148                 MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO           HGO0021
 10149                      T-DIRFINALESAUX-BDLDIR                      HGO0021
 10150              END-IF                                              HGO0021
 10151           END-IF                                                 HGO0021
 10152        END-IF                                                    HGO0021
 10153     END-IF.                                                      HGO0021
 10154*
 10155******************************************************************
 10156*2017-MOVER-H-TO-J.                                                *
 10157*    SE MUEVEN LOS VALORES DEL ELEMENTO H AL J DE LA VARIABLE
 10158*    AUXILIAR                                                   *
 10159******************************************************************
 10160 2017-MOVER-H-TO-J.
 10161     COMPUTE V-NUMFINAUX-BDLDIR = V-NUMFINAUX-BDLDIR +            HGO0021
 10162             V-NUMFIN-BDLDIR(H-BDLDIR).                           HGO0021
 10163     IF V-CALFIN-BDLDIR(H-BDLDIR) > V-CALFINAUX-BDLDIR            HGO0021
 10164        MOVE V-CALFIN-BDLDIR(H-BDLDIR) TO                         HGO0021
 10165             V-CALFINAUX-BDLDIR                                   HGO0021
 10166     END-IF.                                                      HGO0021
 10167*                                                                 HGO0021
 10168     IF V-FECFIN-BDLDIR(H-BDLDIR) > V-FECFINAUX-BDLDIR            HGO0021
 10169        MOVE V-FECFIN-BDLDIR(H-BDLDIR) TO                         HGO0021
 10170             V-FECFINAUX-BDLDIR                                   HGO0021
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 176
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10171     END-IF.                                                      HGO0021
 10172*
 10173     IF V-FECULTFIN-BDLDIR(H-BDLDIR) >  V-FECULTFINAUX-BDLDIR     RGH0024
 10174        MOVE V-FECULTFIN-BDLDIR(H-BDLDIR) TO                      RGH0024
 10175             V-FECULTFINAUX-BDLDIR                                RGH0024
 10176     END-IF.                                                      RGH0024
 10177*
 10178     IF V-FECCREFIN-BDLDIR(H-BDLDIR) <  V-FECCREFINAUX-BDLDIR     RGH0024
 10179        MOVE V-FECCREFIN-BDLDIR(H-BDLDIR) TO                      RGH0024
 10180             V-FECCREFINAUX-BDLDIR                                RGH0024
 10181     END-IF.                                                      RGH0024
 10182*    se salva el flag de nueva nomenclatura
 10183     IF V-NN01DIRFIN-BDLDIR(H-BDLDIR) = 1                         FARF035
 10184         MOVE 1 TO V-NN02DIRFINAUX-BDLDIR                         FARF035
 10185     END-IF.                                                      FARF035
 10186*
 10187 2017-VECTOR-UNO.                                                 AAM0017
 10188******************************************************************
 10189*2017-VECTOR-UNO.                                                *
 10190*    SE CALCULA EL VECTOR DE COMPONENTES DE DIRECCION 1          *
 10191******************************************************************
 10192     MOVE 1 TO E-BDLDIR                                           AAM0017
 10193     MOVE 1 TO F-BDLDIR                                           AAM0017
 10194     MOVE SPACES TO DIRECCION1                                    AAM0017
 10195     PERFORM UNTIL E-BDLDIR > 60                                  AAM0017
 10196      IF DIRECCION(E-BDLDIR:1) IS NUMERIC                         AAM0017
 10197         OR DIRECCION(E-BDLDIR:1) = SPACES                        AAM0017
 10198       IF F-BDLDIR > 1                                            AAM0017
 10199        IF DIRECCION(E-BDLDIR:1) NOT = SPACES                     AAM0017
 10200         MOVE DIRECCION(E-BDLDIR:1) TO DIRECCION1(F-BDLDIR:1)     AAM0017
 10201         ADD 1 TO F-BDLDIR                                        AAM0017
 10202        END-IF                                                    AAM0017
 10203        IF DIRECCION(E-BDLDIR:1) = SPACES                         AAM0017
 10204           AND DIRECCION1(F-BDLDIR - 1:1) NOT = SPACES            AAM0017
 10205         MOVE DIRECCION(E-BDLDIR:1) TO DIRECCION1(F-BDLDIR:1)     AAM0017
 10206         ADD 1 TO F-BDLDIR                                        AAM0017
 10207        END-IF                                                    AAM0017
 10208       END-IF                                                     AAM0017
 10209       IF F-BDLDIR = 1 AND DIRECCION(E-BDLDIR:1) NOT = SPACES     AAM0017
 10210        MOVE DIRECCION(E-BDLDIR:1) TO DIRECCION1(F-BDLDIR:1)      AAM0017
 10211        ADD 1 TO F-BDLDIR                                         AAM0017
 10212       END-IF                                                     AAM0017
 10213      END-IF                                                      AAM0017
 10214      ADD 1 TO E-BDLDIR                                           AAM0017
 10215     END-PERFORM.                                                 AAM0017
 10216 2017-CALCULAR-VECTOR-RES.
 10217******************************************************************
 10218*2018-CALCULAR-VECTOR-RES-DI4.                                   *
 10219*    SE CALCULA EL VECTOR DE CAMBIOS DE DIRECCION                *
 10220******************************************************************
 10221     SORT O-FECHADIR-AUX-BDLDIR DESCENDING V-FECHADIR-AUX-BDLDIR. RMB0010
 10222     MOVE V-FECHADIR-AUX-BDLDIR(1) TO FECHA-RUTINA-BDLDIR.        RMB0010
 10223     MOVE 1 TO  JJ-BDLDIR.                                        RMB0010
 10224     MOVE 2 TO  II-BDLDIR.                                        RMB0010
 10225     MOVE SPACES TO VEC-HIS-BDLDIR.                               RMB0010
 10226     PERFORM 2017-UN-MES-ATRAS
 10227     PERFORM UNTIL II-BDLDIR >= K-BDLDIR OR                       RMB0010
 10228                   JJ-BDLDIR > 12                                 RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 177
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10229        IF FECHA-RUTINA-BDLDIR =                                  RMB0010
 10230           V-FECHADIR-AUX-BDLDIR(II-BDLDIR)                       RMB0010
 10231           MOVE "R" TO VEC-HIS-BDLDIR(JJ-BDLDIR:1)                RMB0010
 10232           ADD 1 TO JJ-BDLDIR                                     RMB0010
 10233           PERFORM 2017-UN-MES-ATRAS
 10234           ADD 1 TO II-BDLDIR                                     RMB0010
 10235         ELSE
 10236           IF FECHA-RUTINA-BDLDIR >                               RMB0010
 10237              V-FECHADIR-AUX-BDLDIR(II-BDLDIR)                    RMB0010
 10238              MOVE "I" TO VEC-HIS-BDLDIR(JJ-BDLDIR:1)             RMB0010
 10239              ADD 1 TO JJ-BDLDIR                                  RMB0010
 10240              PERFORM 2017-UN-MES-ATRAS
 10241           ELSE
 10242              ADD 1 TO II-BDLDIR                                  RMB0010
 10243           END-IF
 10244        END-IF
 10245     END-PERFORM.
 10246     MOVE ALL "0" TO TABLA-FECHADIR-AUX-BDLDIR.                   RMB0010
 10247     MOVE 1 TO K-BDLDIR.                                          RMB0010
 10248 2017-UN-MES-ATRAS.
 10249******************************************************************
 10250*2017-UN-MES-ATRAS.                                              *
 10251*    SE CALCULA EL MES ANTERIOR DE LA FECHA DADA PARA HACER LA   *
 10252*    LINEA DE BALANCE Y UBICAR EL VECTOR DE CAMBIOS DE DIRECCION *
 10253******************************************************************
 10254     SUBTRACT 1 FROM MES-RUTINA-BDLDIR.                           RMB0010
 10255     IF MES-RUTINA-BDLDIR = 0                                     RMB0010
 10256        SUBTRACT 1 FROM ANO-RUTINA-BDLDIR                         RMB0010
 10257        MOVE 12 TO MES-RUTINA-BDLDIR                              RMB0010
 10258     END-IF.
 10259*                                                                *ABB0034
 10260 2017-CALCULAR-ENTIDADES-TEL.                                     ABB0034
 10261******************************************************************ABB0034
 10262*    CUENTA EL NUMERO DE ENTIDADES QUE REPORTAN EL MISMO         *ABB0034
 10263*    TELEFONO                                                    *ABB0034
 10264******************************************************************ABB0034
 10265     MOVE 1 TO I-BDLDIR                                           ABB0034
 10266     PERFORM UNTIL I-BDLDIR >= TEL-OK-BDLDIR                      ABB0034
 10267       MOVE ZEROS TO I-RES-BDLDIR I-LAB-BDLDIR I-COR-BDLDIR       ABB0034
 10268       MOVE 1     TO K-BDLDIR                                     ABB0034
 10269       INITIALIZE TABLA-SUS-BDLDIR                                ABB0034
 10270       MOVE 1     TO I-SUS-BDLDIR                                 ABB0034
 10271       MOVE V-SUSTEL-BDLDIR(I-BDLDIR) TO COD-SUSCRIP-ABD02        ABB0034
 10272       PERFORM 2017-LEER-SUSCRIPTOR                               ABB0034
 10273       MOVE NIT-SUSCRIP-S-ABD02 TO V-SUS-BDLDIR(I-SUS-BDLDIR)     ABB0034
 10274       PERFORM UNTIL K-BDLDIR >= TEL-OK-BDLDIR                    ABB0034
 10275         IF V-TELEFONO-BDLDIR(I-BDLDIR) =                         ABB0034
 10276            V-TELEFONO-BDLDIR(K-BDLDIR)                           ABB0034
 10277            IF V-FECCRETEL-BDLDIR(I-BDLDIR) >                     ABB0034
 10278               V-FECCRETEL-BDLDIR(K-BDLDIR)                       ABB0034
 10279               MOVE V-FECCRETEL-BDLDIR(K-BDLDIR) TO               ABB0034
 10280                    V-FECCRETEL-BDLDIR(I-BDLDIR)                  ABB0034
 10281            ELSE                                                  ABB0034
 10282               MOVE V-FECCRETEL-BDLDIR(I-BDLDIR) TO               ABB0034
 10283                    V-FECCRETEL-BDLDIR(K-BDLDIR)                  ABB0034
 10284            END-IF                                                ABB0034
 10285            IF V-TIPOTEL-BDLDIR(K-BDLDIR) = "R"                   ABB0034
 10286               MOVE 1 TO I-RES-BDLDIR                             ABB0034
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 178
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10287            END-IF                                                ABB0034
 10288            IF V-TIPOTEL-BDLDIR(K-BDLDIR) = "L"                   ABB0034
 10289               MOVE 2 TO I-LAB-BDLDIR                             ABB0034
 10290            END-IF                                                ABB0034
 10291            IF V-TIPOTEL-BDLDIR(K-BDLDIR) = "C"                   ABB0034
 10292               MOVE 4 TO I-COR-BDLDIR                             ABB0034
 10293            END-IF                                                ABB0034
 10294            MOVE V-SUSTEL-BDLDIR(K-BDLDIR) TO COD-SUSCRIP-ABD02   ABB0034
 10295            PERFORM 2017-LEER-SUSCRIPTOR                          ABB0034
 10296            MOVE NIT-SUSCRIP-S-ABD02 TO N-SUS-BDLDIR              ABB0034
 10297            MOVE 1 TO K-SUS-BDLDIR                                ABB0034
 10298            MOVE 0 TO J-SUS-BDLDIR                                ABB0034
 10299            PERFORM UNTIL K-SUS-BDLDIR > I-SUS-BDLDIR             ABB0034
 10300              IF N-SUS-BDLDIR = V-SUS-BDLDIR(K-SUS-BDLDIR)        ABB0034
 10301                 MOVE 1 TO J-SUS-BDLDIR                           ABB0034
 10302                 MOVE I-SUS-BDLDIR TO K-SUS-BDLDIR                ABB0034
 10303              END-IF                                              ABB0034
 10304              ADD 1 TO K-SUS-BDLDIR                               ABB0034
 10305            END-PERFORM                                           ABB0034
 10306            IF J-SUS-BDLDIR = 0                                   ABB0034
 10307               ADD  1 TO I-SUS-BDLDIR                             ABB0034
 10308               MOVE N-SUS-BDLDIR TO V-SUS-BDLDIR(I-SUS-BDLDIR)    ABB0034
 10309            END-IF                                                ABB0034
 10310         END-IF                                                   ABB0034
 10311         ADD 1 TO K-BDLDIR                                        ABB0034
 10312       END-PERFORM                                                ABB0034
 10313       COMPUTE I-SDT-BDLDIR =                                     ABB0034
 10314               I-RES-BDLDIR + I-LAB-BDLDIR + I-COR-BDLDIR         ABB0034
 10315       MOVE I-SDT-BDLDIR TO V-TIPOTE-BDLDIR(I-BDLDIR)             ABB0034
 10316       MOVE I-SUS-BDLDIR TO V-NUMENTTEL-BDLDIR(I-BDLDIR)          ABB0034
 10317       ADD 1 TO I-BDLDIR                                          ABB0034
 10318     END-PERFORM.                                                 ABB0034
 10319*                                                                *ABB0034
 10320*-----------------MEJORES TELEFONOS     ---------------------------
 10321 2017-U-ELEGIR-TELEFONOS.
 10322*******************************************************************
 10323* SE UNIFICAN LAS TELEFONOS   Y SE ORDENAN POR EL CRITERIO DE LA
 10324* MEJOR FECHA Y EL NUMERO DE OCURRENCIAS.
 10325* LA RUTINA DEVUELVE UN ARREGLO CON ESTOS TELEFONOS   ORDENADOS
 10326*         05 V-TELFIN       PIC X(12) TELEFONO                    FAC0009
 10327*         05 V-CIUTELFIN    PIC X(20) CIUDAD                      FAC0009
 10328*         05 V-TIPTELFIN    PIC X(01) UBICACION
 10329*         05 V-FECTELFIN    PIC 9(6)  FECHA MEJOR.
 10330*         05 V-NUMTELFIN    PIC 9(3)  NUMERO DE COINCIDENCIAS.
 10331*         05 V-SUSTELFIN    PIC 9(6)  CODIGO DE SUSCRIPTOR.
 10332*         05 V-FECCRETELFIN PIC 9(6)  FECHA REPORTE PRIMERA VEZ
 10333*******************************************************************
 10334     MOVE 0 TO J-BDLDIR.                                          RMB0010
 10335     IF TEL-OK-BDLDIR > 1                                         RMB0010
 10336        SORT T-TEL-BDLDIR                                         RMB0010
 10337             DESCENDING V-TELEFONO-BDLDIR V-TIPOTEL-BDLDIR        RMB0010
 10338        PERFORM 2017-CALCULAR-ENTIDADES-TEL                       ABB0034
 10339        MOVE ALL "9" TO NUMTEL-BDLDIR                             RMB0010
 10340        MOVE 1 TO I-BDLDIR                                        RMB0010
 10341        MOVE ALL "0" TO TABLA-FECHADIR-AUX-BDLDIR                 RMB0010
 10342        MOVE 1 TO K-BDLDIR                                        RMB0010
 10343        PERFORM UNTIL I-BDLDIR >= TEL-OK-BDLDIR                   RMB0010
 10344          IF NUMTEL-BDLDIR NOT = V-TELEFONO-BDLDIR (I-BDLDIR)     RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 179
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10345             IF I-BDLDIR > 1                                      RMB0010
 10346                PERFORM 2017-CALCULAR-VECTOR-RES
 10347                MOVE VEC-HIS-BDLDIR                               RMB0010
 10348                     TO V-VECTELFIN-BDLDIR(J-BDLDIR)              RMB0010
 10349             END-IF
 10350             MOVE V-FECHATEL-BDLDIR(I-BDLDIR)                     RMB0010
 10351                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              RMB0010
 10352             ADD 1 TO K-BDLDIR                                    RMB0010
 10353             ADD 1 TO J-BDLDIR                                    RMB0010
 10354             MOVE V-FECCRETEL-BDLDIR(I-BDLDIR)                    ABB0034
 10355                  TO V-FECCRETELFIN-BDLDIR(J-BDLDIR)              ABB0034
 10356             MOVE V-NUMENTTEL-BDLDIR(I-BDLDIR)                    ABB0034
 10357                  TO V-NUMENTTELFIN-BDLDIR(J-BDLDIR)              ABB0034
 10358             MOVE V-TIPOTE-BDLDIR   (I-BDLDIR)                    ABB0034
 10359                  TO V-TIPOTEFIN-BDLDIR   (J-BDLDIR)              ABB0034
 10360             MOVE V-TELEFONO-BDLDIR (I-BDLDIR)                    RMB0010
 10361                  TO V-TELFIN-BDLDIR(J-BDLDIR)                    RMB0010
 10362             MOVE V-FECHATEL-BDLDIR(I-BDLDIR)                     RMB0010
 10363                  TO V-FECTELFIN-BDLDIR(J-BDLDIR)                 RMB0010
 10364             MOVE V-CIUDADTEL-BDLDIR(I-BDLDIR)                    RMB0010
 10365                  TO V-CIUTELFIN-BDLDIR(J-BDLDIR)                 RMB0010
 10366             MOVE V-TIPOTEL-BDLDIR(I-BDLDIR)                      RMB0010
 10367                  TO V-TIPTELFIN-BDLDIR(J-BDLDIR)                 RMB0010
 10368             MOVE V-SUSTEL-BDLDIR (I-BDLDIR)                      RMB0010
 10369                  TO V-SUSTELFIN-BDLDIR(J-BDLDIR)                 RMB0010
 10370             MOVE V-HASTEL-BDLDIR (I-BDLDIR)                      RMB0010
 10371                  TO V-HASTELFIN-BDLDIR(J-BDLDIR)                 RMB0010
 10372             MOVE 1  TO V-NUMTELFIN-BDLDIR(J-BDLDIR)              RMB0010
 10373             MOVE V-TELEFONO-BDLDIR(I-BDLDIR)  TO NUMTEL-BDLDIR   RMB0010
 10374             MOVE V-FECULTTEL-BDLDIR(I-BDLDIR)                    AAM0017
 10375                  TO V-FECULTTELFIN-BDLDIR(J-BDLDIR)              AAM0017
 10376
 10377             MOVE V-DEPTEL-BDLDIR(I-BDLDIR)
 10378                  TO V-DEPTELFIN-BDLDIR(J-BDLDIR)
 10379
 10380          ELSE
 10381             MOVE V-FECHATEL-BDLDIR(I-BDLDIR)                     RMB0010
 10382                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              RMB0010
 10383             ADD 1 TO K-BDLDIR                                    RMB0010
 10384             ADD 1 TO V-NUMTELFIN-BDLDIR(J-BDLDIR)                RMB0010
 10385             IF V-FECHATEL-BDLDIR(I-BDLDIR) >                     RMB0010
 10386                V-FECTELFIN-BDLDIR(J-BDLDIR)                      RMB0010
 10387                MOVE V-FECCRETEL-BDLDIR(I-BDLDIR)                 ABB0034
 10388                     TO V-FECCRETELFIN-BDLDIR(J-BDLDIR)           ABB0034
 10389                MOVE V-NUMENTTEL-BDLDIR(I-BDLDIR)                 ABB0034
 10390                     TO V-NUMENTTELFIN-BDLDIR(J-BDLDIR)           ABB0034
 10391                MOVE V-TIPOTE-BDLDIR   (I-BDLDIR)                 ABB0034
 10392                     TO V-TIPOTEFIN-BDLDIR   (J-BDLDIR)           ABB0034
 10393                MOVE V-FECHATEL-BDLDIR(I-BDLDIR)                  RMB0010
 10394                     TO V-FECTELFIN-BDLDIR(J-BDLDIR)              RMB0010
 10395                MOVE V-TELEFONO-BDLDIR (I-BDLDIR)                 RMB0010
 10396                     TO V-TELFIN-BDLDIR(J-BDLDIR)                 RMB0010
 10397                MOVE V-CIUDADTEL-BDLDIR(I-BDLDIR)                 RMB0010
 10398                     TO V-CIUTELFIN-BDLDIR(J-BDLDIR)              RMB0010
 10399                MOVE V-TIPOTEL-BDLDIR(I-BDLDIR)                   RMB0010
 10400                     TO V-TIPTELFIN-BDLDIR(J-BDLDIR)              RMB0010
 10401                MOVE V-SUSTEL-BDLDIR (I-BDLDIR)                   RMB0010
 10402                     TO V-SUSTELFIN-BDLDIR(J-BDLDIR)              RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 180
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10403                MOVE V-HASTEL-BDLDIR (I-BDLDIR)                   RMB0010
 10404                     TO V-HASTELFIN-BDLDIR(J-BDLDIR)              RMB0010
 10405                MOVE V-FECULTTEL-BDLDIR(I-BDLDIR)                 AAM0017
 10406                     TO V-FECULTTELFIN-BDLDIR(J-BDLDIR)           AAM0017
 10407
 10408                MOVE V-DEPTEL-BDLDIR(I-BDLDIR)
 10409                     TO V-DEPTELFIN-BDLDIR(J-BDLDIR)
 10410
 10411             END-IF
 10412          END-IF
 10413*
 10414          MOVE V-SEC01TELFIN-BDLDIR(J-BDLDIR) TO                  FARF035
 10415               V-SECUNI00TEL-BDLDIR(I-BDLDIR)                     FARF035
 10416          ADD 1 TO I-BDLDIR                                       RMB0010
 10417        END-PERFORM
 10418        IF I-BDLDIR > 1                                           RMB0010
 10419           PERFORM 2017-CALCULAR-VECTOR-RES
 10420           MOVE VEC-HIS-BDLDIR                                    RMB0010
 10421                TO V-VECTELFIN-BDLDIR(J-BDLDIR)                   RMB0010
 10422        END-IF
 10423     END-IF.
 10424     IF J-BDLDIR > 0                                              RMB0010
 10425        MOVE 1 TO I-BDLDIR                                        RMB0010
 10426        PERFORM UNTIL I-BDLDIR > J-BDLDIR                         RMB0010
 10427           MOVE V-TELFIN-BDLDIR(I-BDLDIR) TO TELEFONO-BDLDIR      RMB0010
 10428           PERFORM 2017-U-CALIFICAR-TELEFONOS                     RMB0010
 10429           MOVE CAL-TEL-BDLDIR TO V-CALTELFIN-BDLDIR(I-BDLDIR)    RMB0010
 10430*-------- Se Excluyen Telfonos segn tabla de exclusin --------*AAM0017
 10431           IF CAL-TEL-BDLDIR <> 0                                 AAM0017
 10432              PERFORM 2018-EVALUA-EXCLUSION-TEL                   AAM0017
 10433           END-IF                                                 AAM0017
 10434***        SE ELIMINAN LOS TELEFONOS CALIFICADOS EN CERO          RMB0010
 10435           IF CAL-TEL-BDLDIR = 0                                  RMB0010
 10436              MOVE 0 TO V-FECTELFIN-BDLDIR(I-BDLDIR)              RMB0010
 10437           END-IF                                                 RMB0010
 10438           ADD  1 TO I-BDLDIR                                     RMB0010
 10439        END-PERFORM                                               RMB0010
 10440        PERFORM 2020-UNIFICA-TELEFONOS                            AAM0017
 10441*                                                                 FARF035
 10442        MOVE 1 TO I-BDLDIR                                        FARF035
 10443        PERFORM UNTIL I-BDLDIR > 100                              FARF035
 10444           IF V-SECUNI00TEL-BDLDIR(I-BDLDIR) > 0                  FARF035
 10445              MOVE 1 TO J-BDLDIR                                  FARF035
 10446              PERFORM UNTIL J-BDLDIR > 100                        FARF035
 10447                 IF V-SECUNI00TEL-BDLDIR(I-BDLDIR) =              FARF035
 10448                    V-SEC01TELFIN-BDLDIR(J-BDLDIR)                FARF035
 10449                    IF  V-FECTELFIN-BDLDIR(J-BDLDIR) = 0          FARF035
 10450                        MOVE 0 TO V-SECUNI00TEL-BDLDIR(I-BDLDIR)  FARF035
 10451                    END-IF                                        FARF035
 10452                    MOVE 200  TO J-BDLDIR                         FARF035
 10453                 ELSE                                             FARF035
 10454                    ADD 1 TO J-BDLDIR                             FARF035
 10455                 END-IF                                           FARF035
 10456              END-PERFORM                                         FARF035
 10457           END-IF                                                 FARF035
 10458*
 10459           ADD 1 TO I-BDLDIR                                      FARF035
 10460        END-PERFORM                                               FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 181
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10461*
 10462        SORT T-TELFINALES-BDLDIR DESCENDING V-CALTELFIN-BDLDIR    RMB0010
 10463                                 DESCENDING V-FECTELFIN-BDLDIR    RMB0010
 10464                                 DESCENDING V-NUMTELFIN-BDLDIR    RMB0010
 10465        MOVE 1 TO I-BDLDIR                                        RMB0010
 10466     END-IF.                                                      RMB0010
 10467*    CONTEO DE ENTIDADES PARA TELEFONOS                           FARF035
 10468     MOVE 1  TO I-BDLDIR.                                         FARF035
 10469     PERFORM UNTIL V-FECTELFIN-BDLDIR(I-BDLDIR) = 0               FARF035
 10470                  OR I-BDLDIR > 100                               FARF035
 10471        MOVE  1 TO J-BDLDIR                                       FARF035
 10472        MOVE SPACES TO M-CONTEOS-TEX                              FARF035
 10473        MOVE ZEROS  TO M-CONTEOS-NUM                              FARF035
 10474        MOVE 0 TO I-RES-BDLDIR I-LAB-BDLDIR I-COR-BDLDIR          FARF035
 10475        MOVE 0 TO I-SDT-BDLDIR                                    FARF035
 10476        PERFORM UNTIL J-BDLDIR > 100                              FARF035
 10477           IF V-SECUNI00TEL-BDLDIR(J-BDLDIR) =                    FARF035
 10478              V-SEC01TELFIN-BDLDIR(I-BDLDIR)                      FARF035
 10479              MOVE V-SUSTEL-BDLDIR(J-BDLDIR) TO COD-SUSCRIP-ABD02 FARF035
 10480              PERFORM 1000-CONTAR-SUSCRIPTORES                    FARF035
 10481              PERFORM 1000-CONTAR-TIPOS-UBICACION-TEL             FARF035
 10482           END-IF
 10483*
 10484           ADD 1 TO J-BDLDIR                                      FARF035
 10485        END-PERFORM                                               FARF035
 10486*
 10487        MOVE I-SDT-BDLDIR TO V-NUMENTTELFIN-BDLDIR(I-BDLDIR)      FARF035
 10488        COMPUTE V-TIPOTEFIN-BDLDIR(I-BDLDIR) =                    FARF035
 10489                I-RES-BDLDIR * 1 +                                FARF035
 10490                I-LAB-BDLDIR * 2                                  FARF035
 10491        ADD 1 TO I-BDLDIR                                         FARF035
 10492     END-PERFORM.                                                 FARF035
 10493*
 10494*----------------- CALIFICAR TELEFONOS  --------------------------RMB0010
 10495 2017-U-CALIFICAR-TELEFONOS.                                      RMB0010
 10496     MOVE 1 TO M-BDLDIR                                           RMB0010
 10497     PERFORM UNTIL TELEFONO-BDLDIR(M-BDLDIR:1) NOT = "0"          RMB0010
 10498       ADD 1 TO M-BDLDIR                                          RMB0010
 10499       IF M-BDLDIR > 12                                           RMB0010
 10500          NEXT SENTENCE                                           RMB0010
 10501       END-IF                                                     RMB0010
 10502     END-PERFORM.                                                 RMB0010
 10503*
 10504     MOVE 0 TO CAL-TEL-BDLDIR                                     RMB0010
 10505     IF TELEFONO-BDLDIR(6:1) = "0" OR                             PJV0028
 10506        TELEFONO-BDLDIR(6:1) = "1" OR                             PJV0028
 10507        TELEFONO-BDLDIR(6:1) = "9"                                PJV0028
 10508        MOVE 1 TO M-BDLDIR                                        PJV0028
 10509     END-IF.                                                      PJV0028
 10510*
 10511     EVALUATE M-BDLDIR                                            RMB0010
 10512       WHEN 6                                                     RMB0010
 10513         MOVE 15 TO CAL-TEL-BDLDIR                                RMB0010
 10514       WHEN 4                                                     RMB0010
 10515         IF TELEFONO-BDLDIR(6:1) NOT = "0"                        RMB0010
 10516            IF TELEFONO-BDLDIR(4:1) = "9" OR "7" OR "5"           RMB0010
 10517               MOVE 15 TO CAL-TEL-BDLDIR                          RMB0010
 10518            END-IF                                                RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 182
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10519         END-IF                                                   RMB0010
 10520       WHEN 3                                                     RMB0010
 10521          IF TELEFONO-BDLDIR(6:1) NOT = "0"                       RMB0010
 10522             IF TELEFONO-BDLDIR(3:2) = "57" AND                   RMB0010
 10523                (TELEFONO-BDLDIR(5:1) NOT = "3" OR "9")           RMB0010
 10524                MOVE 15 TO CAL-TEL-BDLDIR                         RMB0010
 10525             END-IF                                               RMB0010
 10526             IF TELEFONO-BDLDIR(3:1) = "3"                        RMB0010
 10527*               APLICACION REGLA 10 EXCLUSION TELEFONOS(1)        FARF032
 10528                MOVE TELEFONO-BDLDIR TO TEL-AUX-BDLDIR            FARF032
 10529                IF ES-CELULAR-BDLDIR AND P1-TEL-AUX-BDLDIR = 0    FARF032
 10530                    MOVE 15 TO CAL-TEL-BDLDIR                     RMB0010
 10531                END-IF                                            FARF032
 10532             END-IF                                               RMB0010
 10533         END-IF                                                   RMB0010
 10534     END-EVALUATE.                                                RMB0010
 10535*
 10536*----------------- EVALUA EXCLUSION DE TELEFONOS ----------------*AAM0017
 10537 2018-EVALUA-EXCLUSION-TEL.                                       AAM0017
 10538*    OPEN INPUT BDLTELEXC                                         RGH0023
 10539     IF OPEN-BDLTELEXC-BDLDIR = 0                                 RGH0023
 10540        MOVE 1 TO OPEN-BDLTELEXC-BDLDIR                           RGH0023
 10541        OPEN INPUT BDLTELEXC                                      RGH0023
 10542     END-IF                                                       RGH0023
 10543*TELEXC     MOVE 1 TO IQ                                          HGO0022
 10544*TELEXC     PERFORM UNTIL IQ > 12 OR CAL-TEL-BDLDIR = 0           HGO0020
 10545*TEXTEL     PERFORM UNTIL IQ > 24 OR CAL-TEL-BDLDIR = 0           HGO0022
 10546     MOVE SPACES TO LLAVE-BDLTELEXC                               HGO0022
 10547     START BDLTELEXC KEY >= LLAVE-BDLTELEXC                       HGO0022
 10548*    MOVE 0 TO FIN-BDLTELEXC                                      RGH0023
 10549     MOVE 0 TO FIN-BDLTELEXC-BDLDIR                               RGH0023
 10550     READ BDLTELEXC NEXT RECORD                                   HGO0022
 10551*    AT END MOVE 1 TO FIN-BDLTELEXC                               RGH0023
 10552     AT END MOVE 1 TO FIN-BDLTELEXC-BDLDIR                        RGH0023
 10553     END-READ                                                     HGO0022
 10554*    PERFORM UNTIL FIN-BDLTELEXC = 1 OR CAL-TEL-BDLDIR = 0        RGH0023
 10555     PERFORM UNTIL FIN-BDLTELEXC-BDLDIR = 1 OR CAL-TEL-BDLDIR = 0 RGH0023
 10556        PERFORM 2019-BUSCA-POSINI-LONG-TELEXCLU                   AAM0017
 10557        IF POSI-EXCLU < 7                                         AAM0017
 10558*TELEXC           IF T-BDLTELEXC(IQ)(POSI-EXCLU:LONGCOMP-EXCLU)   HGO0022
 10559*          IF TEL-EXCLU(POSI-EXCLU:LONGCOMP-EXCLU)                RGH0023
 10560           IF TEL-EXCLU-BDLTELEXC(POSI-EXCLU:LONGCOMP-EXCLU)      RGH0023
 10561              = TELEFONO-BDLDIR(POSI-EXCLU:LONGCOMP-EXCLU)        AAM0017
 10562              MOVE 0 TO CAL-TEL-BDLDIR                            AAM0017
 10563           END-IF                                                 AAM0017
 10564        END-IF                                                    AAM0017
 10565*TELEXC        ADD 1 TO IQ                                        HGO0022
 10566        READ BDLTELEXC NEXT RECORD                                HGO0022
 10567*       AT END MOVE 1 TO FIN-BDLTELEXC                            RGH0023
 10568        AT END MOVE 1 TO FIN-BDLTELEXC-BDLDIR                     RGH0023
 10569        END-READ                                                  HGO0022
 10570*    END-PERFORM                                                  RGH0023
 10571     END-PERFORM.                                                 RGH0023
 10572*    CLOSE BDLTELEXC.                                             RGH0023
 10573******************************************************************AAM0017
 10574*2019-BUSCA-POSINI-LONG-TELEXCLU                                  AAM0017
 10575*    BUSCA POSICION INICIAL Y LONGITUD DE REGISTRO DE TELEFONOS A AAM0017
 10576*    EXCLUIR.                                                     AAM0017
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 183
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10577******************************************************************AAM0017
 10578 2019-BUSCA-POSINI-LONG-TELEXCLU.                                 AAM0017
 10579     MOVE 0                TO SW-ENCUENTRA-PI                     AAM0017
 10580     MOVE 1                TO W-POSI                              AAM0017
 10581*TELEXC     INSPECT T-BDLTELEXC(IQ) REPLACING ALL LOW-VALUES      HGO0022
 10582*    INSPECT TEL-EXCLU REPLACING ALL LOW-VALUES                   RGH0023
 10583     INSPECT TEL-EXCLU-BDLTELEXC REPLACING ALL LOW-VALUES         RGH0023
 10584                                        BY SPACES                 AAM0017
 10585     PERFORM UNTIL SW-ENCUENTRA-PI = 1 OR W-POSI > 12             AAM0017
 10586*TELEXC        IF T-BDLTELEXC(IQ)(W-POSI:1) NOT EQUAL " "         HGO0022
 10587*       IF TEL-EXCLU(W-POSI:1) NOT EQUAL " "                      RGH0023
 10588        IF TEL-EXCLU-BDLTELEXC(W-POSI:1) NOT EQUAL " "            RGH0023
 10589           MOVE 1          TO SW-ENCUENTRA-PI                     AAM0017
 10590           MOVE W-POSI     TO POSI-EXCLU                          AAM0017
 10591           COMPUTE LONGCOMP-EXCLU = 12 - ( W-POSI - 1 )           AAM0017
 10592        END-IF                                                    AAM0017
 10593        ADD 1              TO W-POSI                              AAM0017
 10594     END-PERFORM                                                  AAM0017
 10595     IF W-POSI > 12                                               AAM0017
 10596        MOVE 12            TO POSI-EXCLU                          AAM0017
 10597        MOVE 0             TO LONGCOMP-EXCLU                      AAM0017
 10598     END-IF.                                                      AAM0017
 10599******************************************************************AAM0017
 10600*2020-UNIFICA-TELEFONOS                                           AAM0017
 10601*    UNIFICA TELEFONOS REPETIDOS                                  AAM0017
 10602******************************************************************AAM0017
 10603 2020-UNIFICA-TELEFONOS.                                          AAM0017
 10604     SORT T-TELFINALES-BDLDIR DESCENDING V-TELFIN-BDLDIR-2        AAM0017
 10605     MOVE 1                      TO W-I                           AAM0017
 10606*    MOVE W-I                    TO W-POSRC                       AAM0017
 10607     MOVE 0                      TO SW-1 SW-2                     AAM0017
 10608     MOVE 0                      TO W-OCURR                       AAM0017
 10609     PERFORM UNTIL W-I > 99  OR SW-1 = 1                          AAM0017
 10610       IF V-CALTELFIN-BDLDIR(W-I) > 0                             AAM0017
 10611         MOVE 1                   TO SW-1                         AAM0017
 10612         MOVE W-I                 TO W-POSRC                      AAM0017
 10613         COMPUTE W-I = W-I - 1                                    AAM0017
 10614       END-IF                                                     AAM0017
 10615       ADD 1 TO W-I                                               AAM0017
 10616     END-PERFORM                                                  AAM0017
 10617     IF W-I < 100                                                 AAM0017
 10618       MOVE V-TELFIN-BDLDIR(W-POSRC) TO W-TELANT                  AAM0017
 10619       MOVE V-NUMTELFIN-BDLDIR(W-POSRC) TO W-OCURR                AAM0017
 10620       MOVE 0 TO SW-1                                             AAM0017
 10621     END-IF                                                       AAM0017
 10622     PERFORM UNTIL W-I > 99  OR SW-1 = 1                          AAM0017
 10623       MOVE V-TELFIN-BDLDIR(W-I + 1) TO W-TELDES                  AAM0017
 10624       MOVE 1                     TO W-POSIUNI                    AAM0017
 10625       IF W-TELDES(6:7) = "       "                               AAM0017
 10626        MOVE 1                    TO SW-1                         AAM0017
 10627       END-IF                                                     AAM0017
 10628       IF V-CALTELFIN-BDLDIR(W-I + 1) > 0                         AAM0017
 10629        IF W-TELANT(6:7) = W-TELDES(6:7)                          AAM0017
 10630         COMPUTE W-OCURR = W-OCURR +                              AAM0017
 10631                           V-NUMTELFIN-BDLDIR(W-I + 1)            AAM0017
 10632         MOVE 0 TO SW-2                                           AAM0017
 10633         PERFORM UNTIL W-POSIUNI > 12 OR SW-2 = 1                 AAM0017
 10634          INSPECT W-TELANT REPLACING ALL LOW-VALUES BY SPACES     AAM0017
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 184
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10635          INSPECT W-TELDES REPLACING ALL LOW-VALUES BY SPACES     AAM0017
 10636          IF W-TELANT(W-POSIUNI:1) <> "0"                         AAM0017
 10637           MOVE W-POSIUNI TO W-POSANT                             AAM0017
 10638           MOVE 1         TO SW-2                                 AAM0017
 10639          END-IF                                                  AAM0017
 10640          ADD 1           TO W-POSIUNI                            AAM0017
 10641         END-PERFORM                                              AAM0017
 10642         IF W-POSIUNI > 12                                        AAM0017
 10643          MOVE 12         TO W-POSANT                             AAM0017
 10644         END-IF                                                   AAM0017
 10645         MOVE 0           TO SW-2                                 AAM0017
 10646         MOVE 1           TO W-POSIUNI                            AAM0017
 10647         PERFORM UNTIL W-POSIUNI > 12 OR SW-2 = 1                 AAM0017
 10648          IF W-TELDES(W-POSIUNI:1) <> "0"                         AAM0017
 10649           MOVE W-POSIUNI TO W-POSDES                             AAM0017
 10650           MOVE 1         TO SW-2                                 AAM0017
 10651          END-IF                                                  AAM0017
 10652          ADD 1           TO W-POSIUNI                            AAM0017
 10653         END-PERFORM                                              AAM0017
 10654         IF W-POSIUNI > 12                                        AAM0017
 10655          MOVE 12         TO W-POSDES                             AAM0017
 10656         END-IF                                                   AAM0017
 10657         MOVE 0           TO SW-2                                 AAM0017
 10658         IF W-POSANT < W-POSDES                                   AAM0017
 10659*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017
 10660          IF V-FECTELFIN-BDLDIR(W-POSRC) <                        AAM0017
 10661             V-FECTELFIN-BDLDIR(W-I + 1)                          AAM0017
 10662           MOVE V-FECTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10663             TO V-FECTELFIN-BDLDIR(W-POSRC)                       AAM0017
 10664           MOVE V-FECULTTELFIN-BDLDIR(W-I + 1)                    FARF031
 10665             TO V-FECULTTELFIN-BDLDIR(W-POSRC)                    FARF031
 10666          END-IF                                                  AAM0017
 10667          IF V-CALTELFIN-BDLDIR(W-POSRC) <                        AAM0017
 10668             V-CALTELFIN-BDLDIR(W-I + 1)                          AAM0017
 10669           MOVE V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10670             TO V-CALTELFIN-BDLDIR(W-POSRC)                       AAM0017
 10671          END-IF                                                  AAM0017
 10672*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017
 10673          MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)                   AAM0017
 10674          MOVE 0 TO V-FECULTTELFIN-BDLDIR(W-I + 1)                FARF031
 10675          MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)                   AAM0017
 10676          MOVE V-SEC01TELFIN-BDLDIR(W-I + 1) TO SEC-BDLDIR        FARF035
 10677          MOVE V-SEC01TELFIN-BDLDIR(W-POSRC) TO                   FARF035
 10678               V-SECUNI00TEL-BDLDIR(SEC-BDLDIR)                   FARF035
 10679         ELSE                                                     AAM0017
 10680          IF W-POSANT = W-POSDES                                  AAM0017
 10681           IF V-NUMTELFIN-BDLDIR(W-POSRC) >                       AAM0017
 10682              V-NUMTELFIN-BDLDIR(W-I + 1)                         AAM0017
 10683*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017
 10684            IF V-FECTELFIN-BDLDIR(W-POSRC) <                      AAM0017
 10685               V-FECTELFIN-BDLDIR(W-I + 1)                        AAM0017
 10686             MOVE V-FECTELFIN-BDLDIR(W-I + 1)                     AAM0017
 10687               TO V-FECTELFIN-BDLDIR(W-POSRC)                     AAM0017
 10688             MOVE V-FECULTTELFIN-BDLDIR(W-I + 1)                  FARF031
 10689               TO V-FECULTTELFIN-BDLDIR(W-POSRC)                  FARF031
 10690            END-IF                                                AAM0017
 10691            IF V-CALTELFIN-BDLDIR(W-POSRC) <                      AAM0017
 10692               V-CALTELFIN-BDLDIR(W-I + 1)                        AAM0017
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 185
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10693             MOVE V-CALTELFIN-BDLDIR(W-I + 1)                     AAM0017
 10694               TO V-CALTELFIN-BDLDIR(W-POSRC)                     AAM0017
 10695            END-IF                                                AAM0017
 10696*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017
 10697            MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)                 AAM0017
 10698            MOVE 0 TO V-FECULTTELFIN-BDLDIR(W-I + 1)              FARF031
 10699            MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)                 AAM0017
 10700            MOVE V-SEC01TELFIN-BDLDIR(W-I + 1) TO SEC-BDLDIR      FARF035
 10701            MOVE V-SEC01TELFIN-BDLDIR(W-POSRC) TO                 FARF035
 10702                 V-SECUNI00TEL-BDLDIR(SEC-BDLDIR)                 FARF035
 10703           ELSE                                                   AAM0017
 10704            IF V-NUMTELFIN-BDLDIR(W-POSRC) =                      AAM0017
 10705               V-NUMTELFIN-BDLDIR(W-I + 1)                        AAM0017
 10706*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017
 10707             IF V-FECTELFIN-BDLDIR(W-POSRC) <                     AAM0017
 10708                V-FECTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10709              MOVE V-FECTELFIN-BDLDIR(W-I + 1)                    AAM0017
 10710                TO V-FECTELFIN-BDLDIR(W-POSRC)                    AAM0017
 10711              MOVE V-FECULTTELFIN-BDLDIR(W-I + 1)                 FARF031
 10712                TO V-FECULTTELFIN-BDLDIR(W-POSRC)                 FARF031
 10713             END-IF                                               AAM0017
 10714             IF V-CALTELFIN-BDLDIR(W-POSRC) <                     AAM0017
 10715                V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10716              MOVE V-CALTELFIN-BDLDIR(W-I + 1)                    AAM0017
 10717                TO V-CALTELFIN-BDLDIR(W-POSRC)                    AAM0017
 10718             END-IF                                               AAM0017
 10719*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017
 10720             IF V-CALTELFIN-BDLDIR(W-POSRC) >                     AAM0017
 10721                V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10722*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017
 10723              IF V-FECTELFIN-BDLDIR(W-POSRC) <                    AAM0017
 10724                 V-FECTELFIN-BDLDIR(W-I + 1)                      AAM0017
 10725               MOVE V-FECTELFIN-BDLDIR(W-I + 1)                   AAM0017
 10726                 TO V-FECTELFIN-BDLDIR(W-POSRC)                   AAM0017
 10727               MOVE V-FECULTTELFIN-BDLDIR(W-I + 1)                FARF031
 10728                 TO V-FECULTTELFIN-BDLDIR(W-POSRC)                FARF031
 10729              END-IF                                              AAM0017
 10730*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017
 10731              MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)               AAM0017
 10732              MOVE 0 TO V-FECULTTELFIN-BDLDIR(W-I + 1)            FARF031
 10733              MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)               AAM0017
 10734              MOVE V-SEC01TELFIN-BDLDIR(W-I + 1) TO SEC-BDLDIR    FARF035
 10735              MOVE V-SEC01TELFIN-BDLDIR(W-POSRC) TO               FARF035
 10736                   V-SECUNI00TEL-BDLDIR(SEC-BDLDIR)               FARF035
 10737             ELSE                                                 AAM0017
 10738              IF V-CALTELFIN-BDLDIR(W-POSRC) =                    AAM0017
 10739                 V-CALTELFIN-BDLDIR(W-I + 1)                      AAM0017
 10740*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017
 10741               IF V-FECTELFIN-BDLDIR(W-POSRC) <                   AAM0017
 10742                  V-FECTELFIN-BDLDIR(W-I + 1)                     AAM0017
 10743                MOVE V-FECTELFIN-BDLDIR(W-I + 1)                  AAM0017
 10744                  TO V-FECTELFIN-BDLDIR(W-POSRC)                  AAM0017
 10745                MOVE V-FECULTTELFIN-BDLDIR(W-I + 1)               FARF031
 10746                  TO V-FECULTTELFIN-BDLDIR(W-POSRC)               FARF031
 10747               END-IF                                             AAM0017
 10748*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017
 10749               IF V-FECTELFIN-BDLDIR(W-POSRC) >                   AAM0017
 10750                  V-FECTELFIN-BDLDIR(W-I + 1)                     AAM0017
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 186
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10751                MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)             AAM0017
 10752                MOVE 0 TO V-FECULTTELFIN-BDLDIR(W-I + 1)          FARF031
 10753                MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)             AAM0017
 10754                MOVE V-SEC01TELFIN-BDLDIR(W-I + 1) TO SEC-BDLDIR  FARF035
 10755                MOVE V-SEC01TELFIN-BDLDIR(W-POSRC) TO             FARF035
 10756                     V-SECUNI00TEL-BDLDIR(SEC-BDLDIR)             FARF035
 10757               ELSE                                               AAM0017
 10758                IF V-FECTELFIN-BDLDIR(W-POSRC) =                  AAM0017
 10759                   V-FECTELFIN-BDLDIR(W-I + 1)                    AAM0017
 10760                 MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)            AAM0017
 10761                 MOVE 0 TO V-FECULTTELFIN-BDLDIR(W-I + 1)         FARF031
 10762                 MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)            AAM0017
 10763                 MOVE V-SEC01TELFIN-BDLDIR(W-I + 1) TO SEC-BDLDIR FARF035
 10764                 MOVE V-SEC01TELFIN-BDLDIR(W-POSRC) TO            FARF035
 10765                      V-SECUNI00TEL-BDLDIR(SEC-BDLDIR)            FARF035
 10766                ELSE                                              AAM0017
 10767                 MOVE 1 TO SW-2                                   AAM0017
 10768                END-IF                                            AAM0017
 10769               END-IF                                             AAM0017
 10770              ELSE                                                AAM0017
 10771               MOVE 1 TO SW-2                                     AAM0017
 10772              END-IF                                              AAM0017
 10773             END-IF                                               AAM0017
 10774            ELSE                                                  AAM0017
 10775             MOVE 1 TO SW-2                                       AAM0017
 10776            END-IF                                                AAM0017
 10777           END-IF                                                 AAM0017
 10778          ELSE                                                    AAM0017
 10779           IF V-FECTELFIN-BDLDIR(W-POSRC) >                       AAM0017
 10780              V-FECTELFIN-BDLDIR(W-I + 1)                         AAM0017
 10781            MOVE V-FECTELFIN-BDLDIR(W-POSRC)                      AAM0017
 10782              TO V-FECTELFIN-BDLDIR(W-I + 1)                      AAM0017
 10783            MOVE V-FECULTTELFIN-BDLDIR(W-POSRC)                   FARF031
 10784              TO V-FECULTTELFIN-BDLDIR(W-I + 1)                   FARF031
 10785           END-IF                                                 AAM0017
 10786           IF V-CALTELFIN-BDLDIR(W-POSRC) >                       AAM0017
 10787              V-CALTELFIN-BDLDIR(W-I + 1)                         AAM0017
 10788            MOVE V-CALTELFIN-BDLDIR(W-POSRC)                      AAM0017
 10789              TO V-CALTELFIN-BDLDIR(W-I + 1)                      AAM0017
 10790           END-IF                                                 AAM0017
 10791*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017
 10792           MOVE 0        TO V-FECTELFIN-BDLDIR(W-POSRC)           AAM0017
 10793           MOVE 0        TO V-FECULTTELFIN-BDLDIR(W-POSRC)        FARF031
 10794           MOVE 0        TO V-CALTELFIN-BDLDIR(W-POSRC)           AAM0017
 10795           MOVE V-SEC01TELFIN-BDLDIR(W-POSRC) TO SEC-BDLDIR       FARF035
 10796           MOVE V-SEC01TELFIN-BDLDIR(W-I + 1) TO                  FARF035
 10797                V-SECUNI00TEL-BDLDIR(SEC-BDLDIR)                  FARF035
 10798           MOVE W-TELDES TO W-TELANT                              AAM0017
 10799           COMPUTE W-POSRC = W-I + 1                              AAM0017
 10800*          MOVE 1 TO SW-2                                         AAM0017
 10801          END-IF                                                  AAM0017
 10802         END-IF                                                   AAM0017
 10803         IF SW-2 = 1                                              AAM0017
 10804*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017
 10805          IF V-FECTELFIN-BDLDIR(W-POSRC) <                        AAM0017
 10806             V-FECTELFIN-BDLDIR(W-I + 1)                          AAM0017
 10807           MOVE V-FECTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10808             TO V-FECTELFIN-BDLDIR(W-POSRC)                       AAM0017
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 187
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10809            MOVE V-FECULTTELFIN-BDLDIR(W-I + 1)                   FARF031
 10810              TO V-FECULTTELFIN-BDLDIR(W-POSRC)                   FARF031
 10811          ELSE                                                    AAM0017
 10812           MOVE V-FECTELFIN-BDLDIR(W-POSRC)                       AAM0017
 10813             TO V-FECTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10814           MOVE V-FECULTTELFIN-BDLDIR(W-POSRC)                    FARF031
 10815             TO V-FECULTTELFIN-BDLDIR(W-I + 1)                    FARF031
 10816          END-IF                                                  AAM0017
 10817          IF V-CALTELFIN-BDLDIR(W-POSRC) <                        AAM0017
 10818             V-CALTELFIN-BDLDIR(W-I + 1)                          AAM0017
 10819           MOVE V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10820             TO V-CALTELFIN-BDLDIR(W-POSRC)                       AAM0017
 10821          ELSE                                                    AAM0017
 10822           MOVE V-CALTELFIN-BDLDIR(W-POSRC)                       AAM0017
 10823             TO V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017
 10824          END-IF                                                  AAM0017
 10825*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017
 10826          MOVE 0        TO V-FECTELFIN-BDLDIR(W-POSRC)            AAM0017
 10827          MOVE 0        TO V-FECULTTELFIN-BDLDIR(W-POSRC)         FARF031
 10828          MOVE 0        TO V-CALTELFIN-BDLDIR(W-POSRC)            AAM0017
 10829          MOVE V-SEC01TELFIN-BDLDIR(W-POSRC) TO SEC-BDLDIR        FARF035
 10830          MOVE V-SEC01TELFIN-BDLDIR(W-I + 1) TO                   FARF035
 10831               V-SECUNI00TEL-BDLDIR(SEC-BDLDIR)                   FARF035
 10832          MOVE W-TELDES TO W-TELANT                               AAM0017
 10833          COMPUTE W-POSRC = W-I + 1                               AAM0017
 10834         END-IF                                                   AAM0017
 10835        ELSE                                                      AAM0017
 10836         MOVE W-OCURR  TO V-NUMTELFIN-BDLDIR(W-POSRC)             AAM0017
 10837         MOVE W-TELDES TO W-TELANT                                AAM0017
 10838         COMPUTE W-POSRC = W-I + 1                                AAM0017
 10839         MOVE V-NUMTELFIN-BDLDIR(W-POSRC) TO W-OCURR              AAM0017
 10840        END-IF                                                    AAM0017
 10841       END-IF                                                     AAM0017
 10842       IF SW-1 = 1 AND V-CALTELFIN-BDLDIR(W-I + 1) < 1            AAM0017
 10843         MOVE W-OCURR  TO V-NUMTELFIN-BDLDIR(W-POSRC)             AAM0017
 10844       END-IF                                                     AAM0017
 10845       ADD 1 TO W-I                                               AAM0017
 10846     END-PERFORM.                                                 AAM0017
 10847*                                                                *ABB0034
 10848 2017-CALCULAR-ENTIDADES-CEL.                                     ABB0034
 10849******************************************************************ABB0034
 10850*    CUENTA EL NUMERO DE ENTIDADES QUE REPORTAN EL MISMO         *ABB0034
 10851*    CELULAR                                                     *ABB0034
 10852******************************************************************ABB0034
 10853     MOVE 1 TO I-BDLDIR                                           ABB0034
 10854     PERFORM UNTIL I-BDLDIR >= CEL-OK-BDLDIR                      ABB0034
 10855       MOVE 1     TO K-BDLDIR                                     ABB0034
 10856       INITIALIZE TABLA-SUS-BDLDIR                                ABB0034
 10857       MOVE 1 TO I-SUS-BDLDIR                                     ABB0034
 10858       MOVE V-SUSCEL-BDLDIR(I-BDLDIR) TO COD-SUSCRIP-ABD02        ABB0034
 10859       PERFORM 2017-LEER-SUSCRIPTOR                               ABB0034
 10860       MOVE NIT-SUSCRIP-S-ABD02 TO V-SUS-BDLDIR(I-SUS-BDLDIR)     ABB0034
 10861       PERFORM UNTIL K-BDLDIR >= CEL-OK-BDLDIR                    ABB0034
 10862         IF V-CELULAR-BDLDIR(I-BDLDIR) =                          ABB0034
 10863            V-CELULAR-BDLDIR(K-BDLDIR)                            ABB0034
 10864            IF V-FECCRECEL-BDLDIR(I-BDLDIR) >                     ABB0034
 10865               V-FECCRECEL-BDLDIR(K-BDLDIR)                       ABB0034
 10866               MOVE V-FECCRECEL-BDLDIR(K-BDLDIR) TO               ABB0034
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 188
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10867                    V-FECCRECEL-BDLDIR(I-BDLDIR)                  ABB0034
 10868            ELSE                                                  ABB0034
 10869               MOVE V-FECCRECEL-BDLDIR(I-BDLDIR) TO               ABB0034
 10870                    V-FECCRECEL-BDLDIR(K-BDLDIR)                  ABB0034
 10871            END-IF                                                ABB0034
 10872            MOVE V-SUSCEL-BDLDIR(K-BDLDIR) TO COD-SUSCRIP-ABD02   ABB0034
 10873            PERFORM 2017-LEER-SUSCRIPTOR                          ABB0034
 10874            MOVE NIT-SUSCRIP-S-ABD02 TO N-SUS-BDLDIR              ABB0034
 10875            MOVE 1 TO K-SUS-BDLDIR                                ABB0034
 10876            MOVE 0 TO J-SUS-BDLDIR                                ABB0034
 10877            PERFORM UNTIL K-SUS-BDLDIR > I-SUS-BDLDIR             ABB0034
 10878              IF N-SUS-BDLDIR = V-SUS-BDLDIR(K-SUS-BDLDIR)        ABB0034
 10879                 MOVE 1 TO J-SUS-BDLDIR                           ABB0034
 10880                 MOVE I-SUS-BDLDIR TO K-SUS-BDLDIR                ABB0034
 10881              END-IF                                              ABB0034
 10882              ADD 1 TO K-SUS-BDLDIR                               ABB0034
 10883            END-PERFORM                                           ABB0034
 10884            IF J-SUS-BDLDIR = 0                                   ABB0034
 10885               ADD 1 TO I-SUS-BDLDIR                              ABB0034
 10886               MOVE N-SUS-BDLDIR TO V-SUS-BDLDIR(I-SUS-BDLDIR)    ABB0034
 10887            END-IF                                                ABB0034
 10888         END-IF                                                   ABB0034
 10889         ADD 1 TO K-BDLDIR                                        ABB0034
 10890       END-PERFORM                                                ABB0034
 10891       MOVE I-SUS-BDLDIR TO V-NUMENTCEL-BDLDIR(I-BDLDIR)          ABB0034
 10892       ADD 1 TO I-BDLDIR                                          ABB0034
 10893     END-PERFORM.                                                 ABB0034
 10894*                                                                *ABB0034
 10895 2017-U-ELEGIR-CELULARES.
 10896*******************************************************************
 10897* SE UNIFICAN LOS CELULARES Y SE ORDENAN POR EL CRITERIO DE LA
 10898* MEJOR FECHA Y EL NUMERO DE OCURRENCIAS.
 10899* LA RUTINA DEVUELVE UN ARREGLO CON ESTOS CELULARES ORDENADOS
 10900*         05 V-CELFIN       PIC X(12) CELULAR
 10901*         05 V-FECCELFIN    PIC 9(6)  FECHA MEJOR.
 10902*         05 V-NUMCELFIN    PIC 9(3)  NUMERO DE COINCIDENCIAS.
 10903*         05 V-SUSCELFIN    PIC 9(6)  CODIGO DE SUSCRIPTOR.
 10904*         05 V-FECCRECELFIN PIC 9(6)  FECHA REPORTE PRIMERA VEZ
 10905*******************************************************************
 10906     MOVE 0 TO J-BDLDIR.
 10907     IF CEL-OK-BDLDIR > 1
 10908        SORT T-CEL-BDLDIR
 10909             DESCENDING V-CELULAR-BDLDIR
 10910        PERFORM 2017-CALCULAR-ENTIDADES-CEL                       ABB0034
 10911        MOVE ALL "9" TO NUMCEL-BDLDIR
 10912        MOVE 1 TO I-BDLDIR
 10913        MOVE ALL "0" TO TABLA-FECHADIR-AUX-BDLDIR
 10914        MOVE 1 TO K-BDLDIR
 10915        PERFORM UNTIL I-BDLDIR >= CEL-OK-BDLDIR
 10916          IF NUMCEL-BDLDIR NOT = V-CELULAR-BDLDIR (I-BDLDIR)
 10917             IF I-BDLDIR > 1
 10918                PERFORM 2017-CALCULAR-VECTOR-RES
 10919                MOVE VEC-HIS-BDLDIR
 10920                     TO V-VECCELFIN-BDLDIR(J-BDLDIR)
 10921             END-IF
 10922             MOVE V-FECHACEL-BDLDIR(I-BDLDIR)
 10923                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)
 10924             ADD 1 TO K-BDLDIR
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 189
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10925             ADD 1 TO J-BDLDIR
 10926             MOVE V-FECCRECEL-BDLDIR(I-BDLDIR)                    ABB0034
 10927                  TO V-FECCRECELFIN-BDLDIR(J-BDLDIR)              ABB0034
 10928             MOVE V-NUMENTCEL-BDLDIR(I-BDLDIR)                    ABB0034
 10929                  TO V-NUMENTCELFIN-BDLDIR(J-BDLDIR)              ABB0034
 10930             MOVE V-CELULAR-BDLDIR (I-BDLDIR)
 10931                  TO V-CELFIN-BDLDIR(J-BDLDIR)
 10932             MOVE V-FECHACEL-BDLDIR(I-BDLDIR)
 10933                  TO V-FECCELFIN-BDLDIR(J-BDLDIR)
 10934             MOVE V-SUSCEL-BDLDIR (I-BDLDIR)
 10935                  TO V-SUSCELFIN-BDLDIR(J-BDLDIR)
 10936             MOVE V-HASCEL-BDLDIR (I-BDLDIR)
 10937                  TO V-HASCELFIN-BDLDIR(J-BDLDIR)
 10938             MOVE 1  TO V-NUMCELFIN-BDLDIR(J-BDLDIR)
 10939             MOVE V-CELULAR-BDLDIR(I-BDLDIR)  TO NUMCEL-BDLDIR
 10940             MOVE V-FECULTCEL-BDLDIR(I-BDLDIR)
 10941                  TO V-FECULTCELFIN-BDLDIR(J-BDLDIR)
 10942             MOVE V-ORIGENCEL-BDLDIR(I-BDLDIR)
 10943                  TO V-ORIGENCELFIN-BDLDIR(J-BDLDIR)
 10944             MOVE 1 TO V-INDICACELFIN-BDLDIR(J-BDLDIR)
 10945          ELSE
 10946             MOVE V-FECHACEL-BDLDIR(I-BDLDIR)
 10947                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)
 10948             ADD 1 TO K-BDLDIR
 10949             ADD 1 TO V-NUMCELFIN-BDLDIR(J-BDLDIR)
 10950             IF V-FECHACEL-BDLDIR(I-BDLDIR) >
 10951                V-FECCELFIN-BDLDIR(J-BDLDIR)
 10952                MOVE V-FECCRECEL-BDLDIR(I-BDLDIR)                 ABB0034
 10953                     TO V-FECCRECELFIN-BDLDIR(J-BDLDIR)           ABB0034
 10954                MOVE V-NUMENTCEL-BDLDIR(I-BDLDIR)                 ABB0034
 10955                     TO V-NUMENTCELFIN-BDLDIR(J-BDLDIR)           ABB0034
 10956                MOVE V-FECHACEL-BDLDIR(I-BDLDIR)
 10957                     TO V-FECCELFIN-BDLDIR(J-BDLDIR)
 10958                MOVE V-CELULAR-BDLDIR (I-BDLDIR)
 10959                     TO V-CELFIN-BDLDIR(J-BDLDIR)
 10960                MOVE V-SUSCEL-BDLDIR (I-BDLDIR)
 10961                     TO V-SUSCELFIN-BDLDIR(J-BDLDIR)
 10962                MOVE V-HASCEL-BDLDIR (I-BDLDIR)
 10963                     TO V-HASCELFIN-BDLDIR(J-BDLDIR)
 10964                MOVE V-FECULTCEL-BDLDIR(I-BDLDIR)
 10965                     TO V-FECULTCELFIN-BDLDIR(J-BDLDIR)
 10966                MOVE V-ORIGENCEL-BDLDIR(I-BDLDIR)
 10967                     TO V-ORIGENCELFIN-BDLDIR(J-BDLDIR)
 10968                MOVE 1 TO V-INDICACELFIN-BDLDIR(J-BDLDIR)
 10969             END-IF
 10970          END-IF
 10971*
 10972          MOVE V-SEC01CELFIN-BDLDIR(J-BDLDIR) TO                  FARF035
 10973               V-SECUNI00CEL-BDLDIR(I-BDLDIR)                     FARF035
 10974          ADD 1 TO I-BDLDIR
 10975        END-PERFORM
 10976        IF I-BDLDIR > 1
 10977           PERFORM 2017-CALCULAR-VECTOR-RES
 10978           MOVE VEC-HIS-BDLDIR
 10979                TO V-VECCELFIN-BDLDIR(J-BDLDIR)
 10980        END-IF
 10981     END-IF.
 10982     IF J-BDLDIR > 0
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 190
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 10983        MOVE 1 TO I-BDLDIR
 10984        PERFORM UNTIL I-BDLDIR > J-BDLDIR
 10985           MOVE V-CELFIN-BDLDIR(I-BDLDIR) TO TELEFONO-BDLDIR
 10986           PERFORM 2017-U-CALIFICAR-CELULARES
 10987*          MOVE CAL-TEL-BDLDIR TO V-CALTELFIN-BDLDIR(I-BDLDIR)    PJV0028
 10988           MOVE CAL-TEL-BDLDIR TO V-CALCELFIN-BDLDIR(I-BDLDIR)    PJV0028
 10989*-------- Se Excluyen Telfonos segn tabla de exclusin --------*
 10990           IF CAL-TEL-BDLDIR <> 0
 10991              PERFORM 2018-EVALUA-EXCLUSION-TEL
 10992           END-IF
 10993***        SE ELIMINAN LOS TELEFONOS CALIFICADOS EN CERO
 10994           IF CAL-TEL-BDLDIR = 0
 10995              MOVE 0 TO V-FECCELFIN-BDLDIR(I-BDLDIR)
 10996           END-IF
 10997           ADD  1 TO I-BDLDIR
 10998        END-PERFORM
 10999*
 11000        MOVE 1 TO I-BDLDIR
 11001        PERFORM UNTIL I-BDLDIR > 100
 11002           IF V-SECUNI00CEL-BDLDIR(I-BDLDIR) > 0
 11003              MOVE 1 TO J-BDLDIR
 11004              PERFORM UNTIL J-BDLDIR > 100
 11005                 IF V-SECUNI00CEL-BDLDIR(I-BDLDIR) =
 11006                    V-SEC01CELFIN-BDLDIR(J-BDLDIR)
 11007                    IF  V-FECCELFIN-BDLDIR(J-BDLDIR) = 0
 11008                        MOVE 0 TO V-SECUNI00CEL-BDLDIR(I-BDLDIR)
 11009                    END-IF
 11010*
 11011                    MOVE 200  TO J-BDLDIR
 11012                 ELSE
 11013                    ADD 1 TO J-BDLDIR
 11014                 END-IF
 11015              END-PERFORM
 11016           END-IF
 11017*
 11018           ADD 1 TO I-BDLDIR
 11019        END-PERFORM
 11020*
 11021        SORT T-CELFINALES-BDLDIR DESCENDING V-INDICACELFIN-BDLDIR
 11022                                 ASCENDING V-ORIGENCELFIN-BDLDIR
 11023                                 DESCENDING V-CALCELFIN-BDLDIR
 11024                                 DESCENDING V-FECCELFIN-BDLDIR
 11025                                 DESCENDING V-NUMCELFIN-BDLDIR
 11026        MOVE 1 TO I-BDLDIR
 11027     END-IF.
 11028*    CONTEO DE ENTIDADES PARA CELULARES                           FARF035
 11029     MOVE 1  TO I-BDLDIR.                                         FARF035
 11030     PERFORM UNTIL V-FECCELFIN-BDLDIR(I-BDLDIR) = 0               FARF035
 11031                  OR I-BDLDIR > 100                               FARF035
 11032        MOVE  1 TO J-BDLDIR                                       FARF035
 11033        MOVE SPACES TO M-CONTEOS-TEX                              FARF035
 11034        MOVE ZEROS  TO M-CONTEOS-NUM                              FARF035
 11035        MOVE 0 TO I-RES-BDLDIR I-LAB-BDLDIR I-COR-BDLDIR          FARF035
 11036        MOVE 0 TO I-SDT-BDLDIR                                    FARF035
 11037        PERFORM UNTIL J-BDLDIR > 100                              FARF035
 11038           IF V-SECUNI00CEL-BDLDIR(J-BDLDIR) =                    FARF035
 11039              V-SEC01CELFIN-BDLDIR(I-BDLDIR)                      FARF035
 11040              MOVE V-SUSCEL-BDLDIR(J-BDLDIR) TO COD-SUSCRIP-ABD02 FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 191
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11041              PERFORM 1000-CONTAR-SUSCRIPTORES                    FARF035
 11042           END-IF                                                 FARF035
 11043*                                                                 FARF035
 11044           ADD 1 TO J-BDLDIR                                      FARF035
 11045        END-PERFORM                                               FARF035
 11046*                                                                 FARF035
 11047        MOVE I-SDT-BDLDIR TO V-NUMENTCELFIN-BDLDIR(I-BDLDIR)      FARF035
 11048        ADD 1 TO I-BDLDIR                                         FARF035
 11049     END-PERFORM.                                                 FARF035
 11050*
 11051*----------------- CALIFICAR CELULARES  --------------------------
 11052 2017-U-CALIFICAR-CELULARES.
 11053     MOVE 1 TO M-BDLDIR.
 11054     PERFORM UNTIL TELEFONO-BDLDIR(M-BDLDIR:1) NOT = "0"
 11055       ADD 1 TO M-BDLDIR
 11056       IF M-BDLDIR > 12
 11057          NEXT SENTENCE
 11058       END-IF
 11059     END-PERFORM.
 11060*
 11061     MOVE 0 TO CAL-TEL-BDLDIR.
 11062     IF TELEFONO-BDLDIR(6:1) = "0" OR                             PJV0028
 11063        TELEFONO-BDLDIR(6:1) = "1" OR                             PJV0028
 11064        TELEFONO-BDLDIR(6:1) = "9"                                PJV0028
 11065        MOVE 1 TO M-BDLDIR                                        PJV0028
 11066     END-IF.                                                      PJV0028
 11067*
 11068     EVALUATE M-BDLDIR
 11069       WHEN 3
 11070*        APLICACION REGLA 10 EXCLUSION TELEFONOS(1)               FARF032
 11071*        IF TELEFONO-BDLDIR(3:1) = "3"                            FARF032
 11072         MOVE TELEFONO-BDLDIR TO TEL-AUX-BDLDIR                   FARF032
 11073         IF ES-CELULAR-BDLDIR AND P1-TEL-AUX-BDLDIR = 0           FARF032
 11074            MOVE 15 TO CAL-TEL-BDLDIR
 11075         END-IF
 11076     END-EVALUATE.
 11077*                                                                *ABB0034
 11078 2017-CALCULAR-ENTIDADES-MAIL.                                    ABB0034
 11079******************************************************************ABB0034
 11080*    CUENTA EL NUMERO DE ENTIDADES QUE REPORTAN EL MISMO         *ABB0034
 11081*    EMAIL                                                       *ABB0034
 11082******************************************************************ABB0034
 11083     MOVE 1 TO I-BDLDIR                                           ABB0034
 11084     PERFORM UNTIL I-BDLDIR >= MAIL-OK-BDLDIR                     ABB0034
 11085        MOVE 1     TO K-BDLDIR                                    ABB0034
 11086        INITIALIZE TABLA-SUS-BDLDIR                               ABB0034
 11087        MOVE 1 TO I-SUS-BDLDIR                                    ABB0034
 11088        MOVE V-SUSMAIL-BDLDIR(I-BDLDIR) TO COD-SUSCRIP-ABD02      ABB0034
 11089        PERFORM 2017-LEER-SUSCRIPTOR                              ABB0034
 11090        MOVE NIT-SUSCRIP-S-ABD02 TO V-SUS-BDLDIR(I-SUS-BDLDIR)    ABB0034
 11091        PERFORM UNTIL K-BDLDIR >= MAIL-OK-BDLDIR                  ABB0034
 11092           IF V-MAIL-BDLDIR(I-BDLDIR) =                           ABB0034
 11093              V-MAIL-BDLDIR(K-BDLDIR)                             ABB0034
 11094              IF V-FECCREMAIL-BDLDIR(I-BDLDIR) >                  ABB0034
 11095                 V-FECCREMAIL-BDLDIR(K-BDLDIR)                    ABB0034
 11096                 IF V-FECCREMAIL-BDLDIR(K-BDLDIR) > ZEROS         ABB0034
 11097                    MOVE V-FECCREMAIL-BDLDIR(K-BDLDIR) TO         ABB0034
 11098                         V-FECCREMAIL-BDLDIR(I-BDLDIR)            ABB0034
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 192
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11099                 END-IF                                           ABB0034
 11100              ELSE                                                ABB0034
 11101                 IF V-FECCREMAIL-BDLDIR(I-BDLDIR) > ZEROS         ABB0034
 11102                    MOVE V-FECCREMAIL-BDLDIR(I-BDLDIR) TO         ABB0034
 11103                         V-FECCREMAIL-BDLDIR(K-BDLDIR)            ABB0034
 11104                 END-IF                                           ABB0034
 11105              END-IF                                              ABB0034
 11106*
 11107              MOVE V-SUSMAIL-BDLDIR(K-BDLDIR) TO COD-SUSCRIP-ABD02
 11108              PERFORM 2017-LEER-SUSCRIPTOR                        ABB0034
 11109              MOVE NIT-SUSCRIP-S-ABD02 TO N-SUS-BDLDIR            ABB0034
 11110              MOVE 1 TO K-SUS-BDLDIR                              ABB0034
 11111              MOVE 0 TO J-SUS-BDLDIR                              ABB0034
 11112              PERFORM UNTIL K-SUS-BDLDIR > I-SUS-BDLDIR           ABB0034
 11113                 IF N-SUS-BDLDIR = V-SUS-BDLDIR(K-SUS-BDLDIR)     ABB0034
 11114                    MOVE 1 TO J-SUS-BDLDIR                        ABB0034
 11115                    MOVE I-SUS-BDLDIR TO K-SUS-BDLDIR             ABB0034
 11116                 END-IF                                           ABB0034
 11117*
 11118                 ADD 1 TO K-SUS-BDLDIR                            ABB0034
 11119              END-PERFORM                                         ABB0034
 11120*
 11121              IF J-SUS-BDLDIR = 0                                 ABB0034
 11122                 ADD 1 TO I-SUS-BDLDIR                            ABB0034
 11123                 MOVE N-SUS-BDLDIR TO V-SUS-BDLDIR(I-SUS-BDLDIR)  ABB0034
 11124              END-IF                                              ABB0034
 11125           END-IF                                                 ABB0034
 11126*
 11127           ADD 1 TO K-BDLDIR                                      ABB0034
 11128        END-PERFORM                                               ABB0034
 11129        MOVE I-SUS-BDLDIR TO V-NUMENTMAIL-BDLDIR(I-BDLDIR)        ABB0034
 11130        ADD 1 TO I-BDLDIR                                         ABB0034
 11131     END-PERFORM.                                                 ABB0034
 11132*                                                                *ABB0034
 11133 2017-U-ELEGIR-MAILS.
 11134*******************************************************************
 11135* SE UNIFICAN LOS MAILS Y SE ORDENAN POR EL CRITERIO DE LA
 11136* MEJOR FECHA Y EL NUMERO DE OCURRENCIAS.
 11137* LA RUTINA DEVUELVE UN ARREGLO CON ESTOS MAILS ORDENADOS
 11138*      05 V-MAILFIN       PIC X(40) E-MAIL
 11139*      05 V-FECMAILFIN    PIC 9(6)  FECHA MEJOR.
 11140*      05 V-NUMMAILFIN    PIC 9(3)  NUMERO DE COINCIDENCIAS.
 11141*      05 V-SUSMAILFIN    PIC 9(6)  CODIGO DE SUSCRIPTOR.
 11142*      05 V-FECCREMAILFIN PIC 9(6)  FECHA REPORTE PRIMERA VEZ
 11143*******************************************************************
 11144     MOVE 0 TO J-BDLDIR.
 11145     IF MAIL-OK-BDLDIR > 1
 11146        SORT T-MAIL-BDLDIR
 11147             DESCENDING V-MAIL-BDLDIR
 11148        PERFORM 2017-CALCULAR-ENTIDADES-MAIL                      ABB0034
 11149        MOVE ALL "9" TO NUMMAIL-BDLDIR
 11150        MOVE 1 TO I-BDLDIR
 11151        MOVE ALL "0" TO TABLA-FECHADIR-AUX-BDLDIR
 11152        MOVE 1 TO K-BDLDIR
 11153*
 11154*       se mueve del tabla de mail a la tabla mailfin unificando
 11155*       por los mail iguales
 11156        PERFORM UNTIL I-BDLDIR >= MAIL-OK-BDLDIR
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 193
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11157           IF NUMMAIL-BDLDIR NOT = V-MAIL-BDLDIR (I-BDLDIR)
 11158              IF I-BDLDIR > 1
 11159                 PERFORM 2017-CALCULAR-VECTOR-RES
 11160                 MOVE VEC-HIS-BDLDIR
 11161                   TO V-VECMAILFIN-BDLDIR(J-BDLDIR)
 11162              END-IF
 11163*
 11164              MOVE V-FECHAMAIL-BDLDIR(I-BDLDIR)
 11165                TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)
 11166              ADD 1 TO K-BDLDIR
 11167              ADD 1 TO J-BDLDIR
 11168              PERFORM 2017-MOVER-DATOS-MAIL                       FARF039
 11169              MOVE 1  TO V-NUMMAILFIN-BDLDIR(J-BDLDIR)
 11170              MOVE V-MAIL-BDLDIR(I-BDLDIR)  TO NUMMAIL-BDLDIR
 11171
 11172           ELSE
 11173              MOVE V-FECHAMAIL-BDLDIR(I-BDLDIR)
 11174                TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)
 11175              ADD 1 TO K-BDLDIR
 11176              ADD 1 TO V-NUMMAILFIN-BDLDIR(J-BDLDIR)
 11177              IF V-FECHAMAIL-BDLDIR(I-BDLDIR) >
 11178                 V-FECMAILFIN-BDLDIR(J-BDLDIR)
 11179                 PERFORM 2017-MOVER-DATOS-MAIL                    FARF039
 11180              END-IF
 11181           END-IF
 11182*
 11183           MOVE V-SEC01MAILFIN-BDLDIR(J-BDLDIR) TO                FARF035
 11184                V-SECUNI00MAIL-BDLDIR(I-BDLDIR)                   FARF035
 11185           ADD 1 TO I-BDLDIR
 11186        END-PERFORM
 11187*
 11188        IF I-BDLDIR > 1
 11189           PERFORM 2017-CALCULAR-VECTOR-RES
 11190           MOVE VEC-HIS-BDLDIR
 11191             TO V-VECMAILFIN-BDLDIR(J-BDLDIR)
 11192        END-IF
 11193     END-IF.
 11194*
 11195     IF J-BDLDIR > 0
 11196        MOVE 1 TO I-BDLDIR
 11197*       OPEN INPUT BDLMAIEXC                                      RGH0023
 11198        IF OPEN-BDLMAIEXC-BDLDIR = 0                              RGH0023
 11199           MOVE 1 TO OPEN-BDLMAIEXC-BDLDIR                        RGH0023
 11200           OPEN INPUT BDLMAIEXC                                   RGH0023
 11201        END-IF                                                    RGH0023
 11202*
 11203        PERFORM UNTIL I-BDLDIR > J-BDLDIR
 11204*
 11205           MOVE V-MAILFIN-BDLDIR(I-BDLDIR) TO MAIL-BDLDIR
 11206                                              LLAVE-BDLMAIEXC     HGO0022
 11207           PERFORM 2017-U-CALIFICAR-MAIL
 11208           MOVE CAL-MAIL-BDLDIR TO V-CALMAILFIN-BDLDIR(I-BDLDIR)
 11209***        SE ELIMINAN LOS MAILS CALIFICADOS EN CERO
 11210           IF CAL-MAIL-BDLDIR = 0
 11211              MOVE 0 TO V-FECMAILFIN-BDLDIR(I-BDLDIR)
 11212              MOVE 0 TO V-INDICAMAILFIN-BDLDIR(I-BDLDIR)          FARF038
 11213           END-IF
 11214           ADD  1 TO I-BDLDIR
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 194
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11215        END-PERFORM
 11216*
 11217*       CLOSE BDLMAIEXC                                           RGH0023
 11218        MOVE 1 TO I-BDLDIR                                        FARF035
 11219        PERFORM UNTIL I-BDLDIR > 100                              FARF035
 11220           IF V-SECUNI00MAIL-BDLDIR(I-BDLDIR) > 0                 FARF035
 11221              MOVE 1 TO J-BDLDIR                                  FARF035
 11222              PERFORM UNTIL J-BDLDIR > 100                        FARF035
 11223                 IF V-SECUNI00MAIL-BDLDIR(I-BDLDIR) =             FARF035
 11224                    V-SEC01MAILFIN-BDLDIR(J-BDLDIR)               FARF035
 11225                    IF  V-FECMAILFIN-BDLDIR(J-BDLDIR) = 0         FARF035
 11226                        MOVE 0 TO V-SECUNI00MAIL-BDLDIR(I-BDLDIR) FARF035
 11227                    END-IF                                        FARF035
 11228                    MOVE 200  TO J-BDLDIR                         FARF035
 11229                 ELSE                                             FARF035
 11230                    ADD 1 TO J-BDLDIR                             FARF035
 11231                 END-IF                                           FARF035
 11232              END-PERFORM                                         FARF035
 11233           END-IF                                                 FARF035
 11234*                                                                 FARF035
 11235           ADD 1 TO I-BDLDIR                                      FARF035
 11236        END-PERFORM                                               FARF035
 11237       SORT T-MAILFINALES-BDLDIR DESCENDING V-INDICAMAILFIN-BDLDIR
 11238                                  ASCENDING V-ORIGENMAILFIN-BDLDIR
 11239                                  DESCENDING V-CALMAILFIN-BDLDIR
 11240                                  DESCENDING V-FECMAILFIN-BDLDIR
 11241                                  DESCENDING V-NUMMAILFIN-BDLDIR
 11242        MOVE 1 TO I-BDLDIR
 11243     END-IF.
 11244*                                                                 FARF035
 11245*    CONTEO DE ENTIDADES PARA EMAILS                              FARF035
 11246     MOVE 1  TO I-BDLDIR.                                         FARF035
 11247     PERFORM UNTIL V-FECMAILFIN-BDLDIR(I-BDLDIR) = 0              FARF035
 11248                  OR I-BDLDIR > 100                               FARF035
 11249        MOVE  1 TO J-BDLDIR                                       FARF035
 11250        MOVE SPACES TO M-CONTEOS-TEX                              FARF035
 11251        MOVE ZEROS  TO M-CONTEOS-NUM                              FARF035
 11252        MOVE 0 TO I-RES-BDLDIR I-LAB-BDLDIR I-COR-BDLDIR          FARF035
 11253        MOVE 0 TO I-SDT-BDLDIR                                    FARF035
 11254        PERFORM UNTIL  J-BDLDIR > 100                             FARF035
 11255           IF V-SECUNI00MAIL-BDLDIR(J-BDLDIR) =                   FARF035
 11256              V-SEC01MAILFIN-BDLDIR(I-BDLDIR)                     FARF035
 11257              MOVE V-SUSMAIL-BDLDIR(J-BDLDIR) TO COD-SUSCRIP-ABD02FARF035
 11258              PERFORM 1000-CONTAR-SUSCRIPTORES                    FARF035
 11259           END-IF                                                 FARF035
 11260*                                                                 FARF035
 11261           ADD 1 TO J-BDLDIR                                      FARF035
 11262        END-PERFORM                                               FARF035
 11263*                                                                 FARF035
 11264        MOVE I-SDT-BDLDIR TO V-NUMENTMAILFIN-BDLDIR(I-BDLDIR)     FARF035
 11265        ADD 1 TO I-BDLDIR                                         FARF035
 11266     END-PERFORM.                                                 FARF035
 11267*
 11268******************************************************************
 11269* 2017-MOVER-DATOS-MAIL.
 11270*    MUEVE LOS DATOS DE TABLA-MAIL-BDLDIR A LA
 11271*     TABLA-MAILFINALES-BDLDIR
 11272******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 195
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11273 2017-MOVER-DATOS-MAIL.                                           FARF039
 11274     MOVE V-FECCREMAIL-BDLDIR(I-BDLDIR)                           ABB0034
 11275       TO V-FECCREMAILFIN-BDLDIR(J-BDLDIR).                       ABB0034
 11276     MOVE V-NUMENTMAIL-BDLDIR(I-BDLDIR)                           ABB0034
 11277       TO V-NUMENTMAILFIN-BDLDIR(J-BDLDIR).                       ABB0034
 11278     MOVE V-FECHAMAIL-BDLDIR(I-BDLDIR)
 11279       TO V-FECMAILFIN-BDLDIR(J-BDLDIR).
 11280     MOVE V-MAIL-BDLDIR (I-BDLDIR)
 11281       TO V-MAILFIN-BDLDIR(J-BDLDIR).
 11282     MOVE V-SUSMAIL-BDLDIR (I-BDLDIR)
 11283       TO V-SUSMAILFIN-BDLDIR(J-BDLDIR).
 11284     MOVE V-HASMAIL-BDLDIR (I-BDLDIR)
 11285       TO V-HASMAILFIN-BDLDIR(J-BDLDIR).
 11286     MOVE V-FECULTMAIL-BDLDIR(I-BDLDIR)
 11287       TO V-FECULTMAILFIN-BDLDIR(J-BDLDIR).
 11288     MOVE V-ORIGENMAIL-BDLDIR(I-BDLDIR)
 11289       TO V-ORIGENMAILFIN-BDLDIR(J-BDLDIR).
 11290     MOVE 1 TO V-INDICAMAILFIN-BDLDIR(J-BDLDIR).
 11291*
 11292*----------------- CALIFICAR MAIL  --------------------------
 11293 2017-U-CALIFICAR-MAIL.
 11294     MOVE 0 TO CONTA
 11295     MOVE 0 TO CAL-MAIL-BDLDIR
 11296*
 11297*    verificamos si tiene el simbolo arroba
 11298     INSPECT MAIL-BDLDIR TALLYING CONTA FOR ALL "@"
 11299     IF CONTA = 1
 11300        MOVE 15 TO CAL-MAIL-BDLDIR
 11301     END-IF.
 11302*
 11303*    verificamos si tiene el punto.
 11304     IF CAL-MAIL-BDLDIR > 0
 11305        MOVE 0 TO CONTA
 11306        INSPECT MAIL-BDLDIR TALLYING CONTA FOR ALL "."
 11307        IF CONTA = 0
 11308           MOVE 0 TO CAL-MAIL-BDLDIR
 11309        END-IF
 11310     END-IF.
 11311*
 11312*    verificamos si tiene un caracter de control invalido.
 11313     IF CAL-MAIL-BDLDIR > 0                                       FARF035
 11314        MOVE 1 TO CONTA                                           FARF035
 11315*       se hace el ciclo hasta el tamao de la varibale.
 11316        PERFORM UNTIL CONTA > 40                                  FARF035
 11317           IF FUNCTION ORD(MAIL-BDLDIR(CONTA:1)) < 32             FARF035
 11318              MOVE 0 TO CAL-MAIL-BDLDIR                           FARF035
 11319              MOVE 50 TO CONTA                                    FARF035
 11320           END-IF                                                 FARF035
 11321*                                                                 FARF035
 11322           ADD 1 TO CONTA                                         FARF035
 11323        END-PERFORM                                               FARF035
 11324     END-IF.                                                      FARF035
 11325*
 11326*    verificamos si existe en el archivo de mail excluidos
 11327     IF CAL-MAIL-BDLDIR > 0
 11328        READ BDLMAIEXC NOT INVALID KEY                            HGO0022
 11329           MOVE 0 TO CAL-MAIL-BDLDIR                              HGO0022
 11330       END-READ                                                   HGO0022
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 196
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11331     END-IF.
 11332*
 11333*-----------------------------------------------------------------
 11334*         RUTINAS PARA LA ESTANDARIZACION DE DIRECCIONES
 11335*-----------------------------------------------------------------
 11336 06000-U-CARGAR-TABLA-DIRESTAN.
 11337******************************************************************
 11338*06000-CARGAR-TABLA-DIRESTAN.                                    *
 11339*    SE CARGA EN MEMORIA LA TABLA PARA ESTANDARIZACION DE        *
 11340*    DIRECCIONES                                                 *
 11341*    PARAMETROS
 11342*       INPUT      DECLARAR ARCHIVO DIREST
 11343*       OUTPUT     TABLA-DIR-ESTANDAR.
 11344*    CARGA EN MEMORIA ARCHIVO DE CIUDADES DUPLICADAS
 11345******************************************************************
 11346     INITIALIZE TABLA-DIR-COMPUESTAS-BDLDIR                       RMB0010
 11347*RCNCER     OPEN INPUT DIREST                                     HGO0022
 11348*    MOVE "$DATABASE/BDLDIRACE" TO TITLE-BDLDIRACE                RGH0023
 11349     OPEN INPUT BDLDIRACE                                         HGO0022
 11350     MOVE 0 TO FDA-DIREST-BDLDIR                                  RMB0010
 11351*STANDA     READ DIREST                                           HGO0022
 11352     READ BDLDIRACE NEXT RECORD                                   HGO0022
 11353        AT END
 11354           MOVE 1 TO FDA-DIREST-BDLDIR                            RMB0010
 11355     END-READ
 11356     MOVE 1 TO I-STA-BDLDIR                                       RMB0010
 11357     MOVE 1 TO J-STA-BDLDIR                                       RMB0010
 11358*    PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 500   RMB0010
 11359     PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 2000  PJV0027
 11360*RCNCER        IF DIR-ORIG-DIREST (1:4) <> "****"                 HGO0022
 11361*RCNCER           MOVE DIR-ORIG-DIREST                            HGO0022
 11362           MOVE DIR-ORIG-BDLDIRACE                                HGO0022
 11363                TO DIR-ORIGINAL-BDLDIR (I-STA-BDLDIR)             RMB0010
 11364*RCNCER           MOVE DIR-ESTAN-DIREST                           HGO0022
 11365           MOVE DIR-ESTAN-BDLDIRACE                               HGO0022
 11366                TO DIR-ESTANDAR-BDLDIR (I-STA-BDLDIR)             RMB0010
 11367           INITIALIZE M-BDLDIR                                    RMB0010
 11368*RCNCER           INSPECT DIR-ORIG-DIREST TALLYING M-BDLDIR FOR ALHGO0022
 11369           INSPECT DIR-ORIG-BDLDIRACE TALLYING M-BDLDIR           HGO0022
 11370            FOR ALL "*"                                           HGO0022
 11371           IF M-BDLDIR > 0                                        RMB0010
 11372              INITIALIZE M-BDLDIR                                 RMB0010
 11373*RCNCER              INSPECT DIR-ORIG-DIREST                      HGO0022
 11374              INSPECT DIR-ORIG-BDLDIRACE                          HGO0022
 11375                      TALLYING M-BDLDIR                           RMB0010
 11376                      FOR CHARACTERS BEFORE INITIAL " "           RMB0010
 11377              MOVE 0 TO DIR-COMPUESTAS-TIP-BDLDIR (J-STA-BDLDIR)  RMB0010
 11378              MOVE M-BDLDIR                                       RMB0010
 11379                   TO DIR-COMPUESTAS-LON-BDLDIR (J-STA-BDLDIR)    RMB0010
 11380*RCNCER              MOVE DIR-ORIG-DIREST                         HGO0022
 11381              MOVE DIR-ORIG-BDLDIRACE                             HGO0022
 11382                   TO DIR-COMPUESTAS-AST-BDLDIR (J-STA-BDLDIR)    RMB0010
 11383*RCNCER              INSPECT DIR-ORIG-DIREST REPLACING ALL "*" BY HGO0022
 11384              INSPECT DIR-ORIG-BDLDIRACE REPLACING ALL "*" BY " " HGO0022
 11385*RCNCER              MOVE DIR-ORIG-DIREST                         HGO0022
 11386              MOVE DIR-ORIG-BDLDIRACE                             HGO0022
 11387                   TO DIR-COMPUESTAS-BLN-BDLDIR (J-STA-BDLDIR)    RMB0010
 11388              ADD 1 TO J-STA-BDLDIR                               RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 197
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11389           END-IF                                                 RMB0010
 11390*RCNCER           IF DIR-ORIG-DIREST (1:1) = "/" OR "(" OR ")" OR HGO0022
 11391           IF DIR-ORIG-BDLDIRACE (1:1) = "/" OR "(" OR ")" OR     HGO0022
 11392                                      "=" OR "?"                  RMB0010
 11393              INITIALIZE M-BDLDIR                                 RMB0010
 11394*RCNCER              INSPECT DIR-ORIG-DIREST                      HGO0022
 11395              INSPECT DIR-ORIG-BDLDIRACE                          HGO0022
 11396                      TALLYING M-BDLDIR FOR CHARACTERS BEFORE     RMB0010
 11397                               INITIAL " "                        RMB0010
 11398              MOVE 1 TO DIR-COMPUESTAS-TIP-BDLDIR (J-STA-BDLDIR)  RMB0010
 11399              MOVE M-BDLDIR                                       RMB0010
 11400                   TO DIR-COMPUESTAS-LON-BDLDIR (J-STA-BDLDIR)    RMB0010
 11401*RCNCER              MOVE DIR-ORIG-DIREST                         HGO0022
 11402              MOVE DIR-ORIG-BDLDIRACE                             HGO0022
 11403                   TO DIR-COMPUESTAS-AST-BDLDIR (J-STA-BDLDIR)    RMB0010
 11404*RCNCER              EVALUATE  DIR-ORIG-DIREST (1:1)              HGO0022
 11405              EVALUATE  DIR-ORIG-BDLDIRACE (1:1)                  HGO0022
 11406                WHEN "/"                                          RMB0010
 11407*RCNCER                  INSPECT DIR-ORIG-DIREST REPLACING ALL "/"HGO0022
 11408                  INSPECT DIR-ORIG-BDLDIRACE REPLACING ALL "/"    HGO0022
 11409                     BY "0"                                       HGO0022
 11410                WHEN "("                                          RMB0010
 11411*RCNCER                  INSPECT DIR-ORIG-DIREST REPLACING ALL "("HGO0022
 11412                  INSPECT DIR-ORIG-BDLDIRACE REPLACING ALL "("    HGO0022
 11413                     BY "1"                                       HGO0022
 11414                WHEN ")"                                          RMB0010
 11415*RCNCER                  INSPECT DIR-ORIG-DIREST REPLACING ALL ")"HGO0022
 11416                  INSPECT DIR-ORIG-BDLDIRACE REPLACING ALL ")"    HGO0022
 11417                     BY "2"                                       HGO0022
 11418                WHEN "="                                          RMB0010
 11419*RCNCER                  INSPECT DIR-ORIG-DIREST REPLACING ALL "="HGO0022
 11420                  INSPECT DIR-ORIG-BDLDIRACE REPLACING ALL "="    HGO0022
 11421                     BY "5"                                       HGO0022
 11422                WHEN "?"                                          RMB0010
 11423*RCNCER                  INSPECT DIR-ORIG-DIREST REPLACING ALL "?"HGO0022
 11424                  INSPECT DIR-ORIG-BDLDIRACE REPLACING ALL "?"    HGO0022
 11425                     BY "7"                                       HGO0022
 11426              END-EVALUATE                                        RMB0010
 11427*RCNCER              MOVE DIR-ORIG-DIREST                         HGO0022
 11428              MOVE DIR-ORIG-BDLDIRACE                             HGO0022
 11429                   TO DIR-COMPUESTAS-BLN-BDLDIR (J-STA-BDLDIR)    RMB0010
 11430              ADD 1 TO J-STA-BDLDIR                               RMB0010
 11431           END-IF                                                 RMB0010
 11432           ADD 1 TO I-STA-BDLDIR                                  RMB0010
 11433*RCNCER        END-IF                                             HGO0022
 11434*RCNCER        READ DIREST                                        HGO0022
 11435        READ BDLDIRACE NEXT RECORD                                HGO0022
 11436           AT END                                                 RMB0010
 11437              MOVE 1 TO FDA-DIREST-BDLDIR                         RMB0010
 11438        END-READ                                                  RMB0010
 11439     END-PERFORM
 11440*    PERFORM UNTIL I-STA-BDLDIR >= 500                            RMB0010
 11441     PERFORM UNTIL I-STA-BDLDIR >= 2000                           PJV0027
 11442        MOVE "ZZZZZZZZZZZZZZZZZZZZ"                               RMB0010
 11443             TO DIR-ORIGINAL-BDLDIR (I-STA-BDLDIR)                RMB0010
 11444        MOVE SPACES                                               RMB0010
 11445             TO DIR-ESTANDAR-BDLDIR (I-STA-BDLDIR)                RMB0010
 11446        ADD 1 TO I-STA-BDLDIR                                     RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 198
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11447     END-PERFORM
 11448     OPEN INPUT DUPCIUDAD
 11449     PERFORM 2018-CARGA-DUPCIUDAD VARYING
 11450             CON-DUPCIUDAD FROM 1 BY 1 UNTIL CON-DUPCIUDAD > 99
 11451     CLOSE DUPCIUDAD
 11452     SORT TABLA-DIR-ESTANDAR-BDLDIR ASCENDING DIR-ORIGINAL-BDLDIR.RMB0010
 11453 6100-U-ESTANDARIZAR-DIRECC.
 11454******************************************************************
 11455*6100-ESTANDARIZAR-DIRECC.                                       *
 11456*    ESTA RUTINA TOMA LA DIRECCION DE ENTRADA Y LA ESTANDARIZA DE*
 11457*    ACUERDO A LA TABLA DE ESTADARIZACION DE DIRECCIONES         *
 11458*    APLICANDO ADEMAS REEMPLAZOS DE CARACTERES ESPECIALES        *
 11459*    PARAMETROS
 11460*       INPUT        DIRECCION-A-ESTANDARIZAR.
 11461*       OUTPUT       DIRECCION-ESTANDARIZADA.
 11462******************************************************************
 11463***  SE DESCARTAN LAS DIRECCIONES QUE CONTIENEN EL NOMBRE DE LA   RMB0010
 11464***  CIUDAD                                                       RMB0010
 11465     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (1:20) <> CIUDAD-BDLDIR   RMB0010
 11466        INSPECT DIRECCION-A-ESTANDARIZAR-BDLDIR                   RMB0010
 11467                REPLACING ALL "." BY " "                          RMB0010
 11468                              "-" BY " "                          RMB0010
 11469                              "'" BY " "                          RMB0010
 11470                              "#" BY " "                          RMB0010
 11471                              ":" BY " "                          RMB0010
 11472                              "/" BY " "                          RMB0010
 11473                              "," BY " "                          RMB0010
 11474                              "*" BY " "                          RMB0010
 11475                              "?" BY " "                          RMB0010
 11476                              "\" BY " "                          RMB0010
 11477                              "_" BY " "                          RMB0010
 11478                              ";" BY " "                          RMB0010
 11479                              "" BY " "                          RMB0010
 11480                              "+" BY " "                          RMB0010
 11481                              "" BY " "                          RMB0010
 11482                              "!" BY " "                          RMB0010
 11483                              "" BY " "                          RMB0010
 11484                              "^" BY " "                          RMB0010
 11485                              "`" BY " "                          RMB0010
 11486                              "" BY " "                          RMB0010
 11487                              "|" BY " "                          RMB0010
 11488                              "&" BY " "                          RMB0010
 11489                              "%" BY " "                          RMB0010
 11490                              "" BY " "                          RMB0010
 11491                              "[" BY " "                          RMB0010
 11492                              "]" BY " "                          RMB0010
 11493                              "{" BY " "                          RMB0010
 11494                              "}" BY " "                          RMB0010
 11495                              "~" BY " "                          RMB0010
 11496                              '"' BY " "                          RMB0010
 11497                              "(" BY " "                          RMB0010
 11498                              ")" BY " "                          RMB0010
 11499                              "" BY " "                          RMB0010
 11500                              "$" BY " "                          RMB0010
 11501                              "@" BY " "                          RMB0010
 11502                              "<" BY " "                          RMB0010
 11503                              ">" BY " "                          RMB0010
 11504                              "=" BY " "                          RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 199
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11505        MOVE FUNCTION UPPER-CASE (DIRECCION-A-ESTANDARIZAR-BDLDIR)RMB0010
 11506             TO DIRECCION-A-ESTANDARIZAR-BDLDIR                   RMB0010
 11507        PERFORM 6130-FILTRO-INICIAL                               RMB0010
 11508        MOVE 1 TO KK-STA-BDLDIR                                   RMB0010
 11509        INITIALIZE NUEVA-DIRECCION-BDLDIR                         RMB0010
 11510                   SUM-DIGITOS-BDLDIR                             RMB0010
 11511                   TIP-NUEVA-DIRECCION-BDLDIR                     RMB0010
 11512                   CON-PART-ESTANDARIZADA-BDLDIR                  HGO0021
 11513        MOVE 1 TO II-STA-BDLDIR                                   RMB0010
 11514        PERFORM UNTIL II-STA-BDLDIR > 60                          RMB0010
 11515           IF DIR-A-EST-BDLDIR (II-STA-BDLDIR) NUMERIC            RMB0010
 11516              MOVE "N" TO IND-TIPCAR-BDLDIR                       RMB0010
 11517              ADD   1  TO SUM-DIGITOS-BDLDIR                      RMB0010
 11518           ELSE                                                   RMB0010
 11519              MOVE "A" TO IND-TIPCAR-BDLDIR                       RMB0010
 11520           END-IF                                                 RMB0010
 11521*
 11522           INITIALIZE PART-A-ESTANDARIZAR-BDLDIR                  RMB0010
 11523           MOVE 1 TO JJ-STA-BDLDIR                                RMB0010
 11524           MOVE IND-TIPCAR-BDLDIR TO TIPCAR-WS-BDLDIR             RMB0010
 11525           PERFORM UNTIL II-STA-BDLDIR > 60 OR                    RMB0010
 11526                         JJ-STA-BDLDIR > 60 OR                    RMB0010
 11527                         IND-TIPCAR-BDLDIR <> TIPCAR-WS-BDLDIR OR RMB0010
 11528                         DIR-A-EST-BDLDIR (II-STA-BDLDIR) = SPACESRMB0010
 11529              MOVE DIR-A-EST-BDLDIR (II-STA-BDLDIR)               RMB0010
 11530                   TO PART-A-ESTAN-BDLDIR (JJ-STA-BDLDIR)         RMB0010
 11531              ADD 1 TO II-STA-BDLDIR                              RMB0010
 11532              ADD 1 TO JJ-STA-BDLDIR                              RMB0010
 11533              IF II-STA-BDLDIR <= 60                              RMB0010
 11534                 IF DIR-A-EST-BDLDIR (II-STA-BDLDIR) NUMERIC      RMB0010
 11535                    MOVE "N" TO IND-TIPCAR-BDLDIR                 RMB0010
 11536                    ADD   1  TO SUM-DIGITOS-BDLDIR                RMB0010
 11537                 ELSE                                             RMB0010
 11538                    MOVE "A" TO IND-TIPCAR-BDLDIR                 RMB0010
 11539                 END-IF                                           RMB0010
 11540              END-IF                                              RMB0010
 11541           END-PERFORM                                            RMB0010
 11542*
 11543           ADD 1 TO CON-PART-ESTANDARIZADA-BDLDIR                 HGO0021
 11544           IF TIPCAR-WS-BDLDIR = "A"                              RMB0010
 11545              PERFORM 6110-ESTANDARIZAR-PART                      RMB0010
 11546              IF PART-ESTANDARIZADA-BDLDIR <> SPACES              RMB0010
 11547                 IF CON-PART-ESTANDARIZADA-BDLDIR = 1             HGO0021
 11548                    MOVE PART-ESTANDARIZADA-BDLDIR TO             HGO0021
 11549                         PRIPART-ESTANDARIZADA-BDLDIR             HGO0021
 11550                 ELSE                                             HGO0021
 11551                    IF CON-PART-ESTANDARIZADA-BDLDIR = 2          HGO0021
 11552                       MOVE PART-ESTANDARIZADA-BDLDIR TO          HGO0021
 11553                           SEGPART-ESTANDARIZADA-BDLDIR           HGO0021
 11554                    END-IF                                        HGO0021
 11555                 END-IF                                           HGO0021
 11556*
 11557                 MOVE PART-ESTANDARIZADA-BDLDIR                   RMB0010
 11558                      TO NVA-DIR-BDLDIR (KK-STA-BDLDIR)           RMB0010
 11559                 IF ENC-DIREST-BDLDIR = 0                         RMB0010
 11560                    MOVE "S" TO TIP-NVA-DIR-BDLDIR(KK-STA-BDLDIR) RMB0010
 11561                 ELSE                                             RMB0010
 11562                    MOVE "A" TO TIP-NVA-DIR-BDLDIR(KK-STA-BDLDIR) RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 200
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11563                 END-IF                                           RMB0010
 11564*
 11565                 ADD 1 TO KK-STA-BDLDIR                           RMB0010
 11566*                                                                 FARF031
 11567*                REGLA DE LIMPIEZA 3 - PARTICULAS REPETIDAS AL    FARF031
 11568*                PRINCIPIO DE LA DIRECCION                        FARF031
 11569                 IF KK-STA-BDLDIR = 3 AND                         FARF031
 11570                    TIP-NVA-DIR-BDLDIR(2) = "S"                   FARF031
 11571                    IF NVA-DIR-BDLDIR(1) = NVA-DIR-BDLDIR(2)      FARF031
 11572                       MOVE SPACES TO TIP-NVA-DIR-BDLDIR(2)       FARF031
 11573                       MOVE SPACES TO NVA-DIR-BDLDIR(2)           FARF031
 11574                       MOVE SPACES TO SEGPART-ESTANDARIZADA-BDLDIRFARF031
 11575                       SUBTRACT 1 FROM KK-STA-BDLDIR              FARF031
 11576                       SUBTRACT 1                                 FARF031
 11577                          FROM CON-PART-ESTANDARIZADA-BDLDIR      FARF031
 11578                    END-IF                                        FARF031
 11579                 END-IF                                           FARF031
 11580              ELSE                                                HGO0021
 11581*                 IF PART-ESTANDARIZADA-BDLDIR = SPACES AND        HGO0021
 11582*                    PART-A-ESTANDARIZAR-BDLDIR = SPACES           HGO0021
 11583                    COMPUTE CON-PART-ESTANDARIZADA-BDLDIR =       HGO0021
 11584                            CON-PART-ESTANDARIZADA-BDLDIR - 1     HGO0021
 11585*                 END-IF                                           HGO0021
 11586              END-IF                                              RMB0010
 11587           ELSE                                                   RMB0010
 11588              IF PART-A-ESTANDARIZAR-BDLDIR <> SPACES             RMB0010
 11589                 IF CON-PART-ESTANDARIZADA-BDLDIR = 1             HGO0021
 11590                    MOVE PART-A-ESTANDARIZAR-BDLDIR TO            HGO0021
 11591                         PRIPART-ESTANDARIZADA-BDLDIR             HGO0021
 11592                 ELSE                                             HGO0021
 11593                    IF CON-PART-ESTANDARIZADA-BDLDIR = 2          HGO0021
 11594                       MOVE PART-A-ESTANDARIZAR-BDLDIR TO         HGO0021
 11595                            SEGPART-ESTANDARIZADA-BDLDIR          HGO0021
 11596                    END-IF                                        HGO0021
 11597                 END-IF                                           HGO0021
 11598*
 11599                 MOVE PART-A-ESTANDARIZAR-BDLDIR                  RMB0010
 11600                      TO NVA-DIR-BDLDIR (KK-STA-BDLDIR)           RMB0010
 11601                 MOVE "N" TO TIP-NVA-DIR-BDLDIR(KK-STA-BDLDIR)    RMB0010
 11602                 ADD 1 TO KK-STA-BDLDIR                           RMB0010
 11603              END-IF                                              RMB0010
 11604           END-IF                                                 RMB0010
 11605*
 11606           PERFORM UNTIL II-STA-BDLDIR > 60 OR                    RMB0010
 11607                   DIR-A-EST-BDLDIR (II-STA-BDLDIR) <> SPACES     RMB0010
 11608              ADD 1 TO II-STA-BDLDIR                              RMB0010
 11609           END-PERFORM                                            RMB0010
 11610        END-PERFORM                                               RMB0010
 11611*
 11612        INITIALIZE DIRECCION-ESTANDARIZADA-BDLDIR                 RMB0010
 11613        MOVE 2 TO JJ-STA-BDLDIR                                   RMB0010
 11614        MOVE NVA-DIR-BDLDIR (1) TO DIRECCION-ESTANDARIZADA-BDLDIR RMB0010
 11615        MOVE 0 TO CALIFICA-DIR-BDLDIR                             RMB0010
 11616        IF TIP-NVA-DIR-BDLDIR(1) = "S"                            RMB0010
 11617           MOVE 10 TO CALIFICA-DIRPART1-BDLDIR                    HGO0021
 11618           ADD 10 TO CALIFICA-DIR-BDLDIR                          HGO0021
 11619           ADD 10 TO CALIFICA-DIR-BDLDIR                          RMB0010
 11620        ELSE                                                      RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 201
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11621           IF TIP-NVA-DIR-BDLDIR(1) = "N"                         RMB0010
 11622              MOVE 6 TO CALIFICA-DIRPART1-BDLDIR                  HGO0021
 11623              ADD 6 TO CALIFICA-DIR-BDLDIR                        HGO0021
 11624              ADD 0 TO CALIFICA-DIR-BDLDIR                        RMB0010
 11625           ELSE                                                   RMB0010
 11626              MOVE 8 TO CALIFICA-DIRPART1-BDLDIR                  HGO0021
 11627*RCNCER              ADD 5 TO CALIFICA-DIR-BDLDIR                 HGO0021
 11628           END-IF                                                 RMB0010
 11629        END-IF                                                    RMB0010
 11630*
 11631        MOVE 0 TO CAMPOS-N-DIR-BDLDIR                             RMB0010
 11632        PERFORM UNTIL JJ-STA-BDLDIR >= KK-STA-BDLDIR              RMB0010
 11633           IF JJ-STA-BDLDIR = 2                                   RMB0010
 11634*RCNCER              IF NVA-DIR-BDLDIR(2) NOT = SPACES            HGO0021
 11635*RCNCER                 ADD 10 TO CALIFICA-DIR-BDLDIR             HGO0021
 11636*RCNCER              END-IF                                       HGO0021
 11637              IF TIP-NVA-DIR-BDLDIR(2) = "S"                      HGO0021
 11638                 MOVE 10 TO CALIFICA-DIRPART2-BDLDIR              HGO0021
 11639                 ADD 10 TO CALIFICA-DIR-BDLDIR                    HGO0021
 11640              ELSE                                                HGO0021
 11641                 IF TIP-NVA-DIR-BDLDIR(2) = "N"                   HGO0021
 11642                    MOVE 10 TO CALIFICA-DIRPART2-BDLDIR           HGO0021
 11643                    ADD 10 TO CALIFICA-DIR-BDLDIR                 HGO0021
 11644                 ELSE                                             HGO0021
 11645                    MOVE 8 TO CALIFICA-DIRPART2-BDLDIR            HGO0021
 11646                 END-IF                                           HGO0021
 11647              END-IF                                              HGO0021
 11648           ELSE                                                   RMB0010
 11649              IF TIP-NVA-DIR-BDLDIR(JJ-STA-BDLDIR) = "N"          RMB0010
 11650                 ADD 1 TO CAMPOS-N-DIR-BDLDIR                     RMB0010
 11651              END-IF                                              RMB0010
 11652           END-IF                                                 RMB0010
 11653*
 11654           STRING DIRECCION-ESTANDARIZADA-BDLDIR DELIMITED BY "  "RMB0010
 11655                  " "                     DELIMITED BY SIZE       RMB0010
 11656                 NVA-DIR-BDLDIR (JJ-STA-BDLDIR) DELIMITED BY "  " FARF026
 11657*RCNCER           NVA-DIR-BDLDIR (JJ-STA-BDLDIR) DELIMITED BY " " RMB0010
 11658               INTO DIRECCION-ESTANDARIZADA-BDLDIR                RMB0010
 11659           END-STRING                                             RMB0010
 11660*
 11661           ADD 1 TO JJ-STA-BDLDIR                                 RMB0010
 11662        END-PERFORM                                               RMB0010
 11663*
 11664        IF CAMPOS-N-DIR-BDLDIR > 1                                RMB0010
 11665           ADD 10 TO CALIFICA-DIR-BDLDIR                          RMB0010
 11666        END-IF                                                    RMB0010
 11667*
 11668        IF DIRECCION-ESTANDARIZADA-BDLDIR <> SPACES               RMB0010
 11669           IF POLITICA-EXC-MAL-DIR-BDLDIR = 1                     RMB0010
 11670              PERFORM 6140-ELIMINAR-DIR-MALAS                     RMB0010
 11671           END-IF                                                 RMB0010
 11672*
 11673           IF CALIFICA-DIR-BDLDIR > POLITICA-EXC-CAL-DIR-BDLDIR   RMB0010
 11674              PERFORM 6120-EVALUAR-ADICION-PUNTOS                 RMB0010
 11675           END-IF                                                 RMB0010
 11676*
 11677           IF CALIFICA-DIR-BDLDIR > 0                             FARF037
 11678               PERFORM 6150-LIMPIA-DIR-ESTANDARIZADA              FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 202
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11679           END-IF                                                 FARF037
 11680*
 11681        ELSE                                                      RMB0010
 11682           MOVE 0 TO CALIFICA-DIR-BDLDIR                          RMB0010
 11683        END-IF                                                    RMB0010
 11684     ELSE                                                         RMB0010
 11685        MOVE 0 TO CALIFICA-DIR-BDLDIR                             RMB0010
 11686     END-IF.                                                      RMB0010
 11687*
 11688     MOVE ZEROS TO V-DANEFIN-BDLDIR-AUX.                          FARF033
 11689*
 11690 6110-ESTANDARIZAR-PART.
 11691******************************************************************
 11692*6110-ESTANDARIZAR-PART.                                         *
 11693*    LA PARTICULA A ESTANDARIZAR SE BUSCA EN LA TABLA DE         *
 11694*    ESTANDARIZACION DE DIRECCIONES Y ES REEMPLAZADA, SI ES QUE  *
 11695*    SE ENCUENTRA                                                *
 11696******************************************************************
 11697*
 11698*    APLICACION DE REGLAS ESPECIALES DE LIMPIEZA                  FARF032
 11699*    REGLAS DE ESTANDARIZACION OBLIGADAS                          FARF032
 11700     IF KK-STA-BDLDIR = 1                                         FARF032
 11701        IF PART-A-ESTANDARIZAR-BDLDIR = "DA" *> REGLA 1           FARF032
 11702           MOVE "DG" TO PART-A-ESTANDARIZAR-BDLDIR                FARF032
 11703        END-IF                                                    FARF032
 11704*                                                                 FARF032
 11705        IF PART-A-ESTANDARIZAR-BDLDIR = "TR" *> REGLA 2           FARF032
 11706           MOVE "TV" TO PART-A-ESTANDARIZAR-BDLDIR                FARF032
 11707        END-IF                                                    FARF032
 11708     END-IF.                                                      FARF032
 11709*                                                                 FARF032
 11710     MOVE 0 TO ENC-DIREST-BDLDIR.                                 RMB0010
 11711     SEARCH ALL TABLA-DIR-ESTANDAR-BDLDIR                         RMB0010
 11712        AT END
 11713           MOVE 1 TO ENC-DIREST-BDLDIR                            RMB0010
 11714        WHEN DIR-ORIGINAL-BDLDIR (I-DIR-ESTANDAR-BDLDIR) =        RMB0010
 11715             PART-A-ESTANDARIZAR-BDLDIR                           RMB0010
 11716           SET JJ-STA-BDLDIR TO I-DIR-ESTANDAR-BDLDIR             RMB0010
 11717           MOVE DIR-ESTANDAR-BDLDIR (JJ-STA-BDLDIR)               RMB0010
 11718                TO PART-ESTANDARIZADA-BDLDIR                      RMB0010
 11719     END-SEARCH.
 11720*
 11721     IF ENC-DIREST-BDLDIR = 1                                     RMB0010
 11722        MOVE PART-A-ESTANDARIZAR-BDLDIR                           RMB0010
 11723             TO PART-ESTANDARIZADA-BDLDIR                         RMB0010
 11724     END-IF.
 11725*
 11726 6130-FILTRO-INICIAL.                                             RMB0010
 11727     MOVE 0 TO CASO-NUMEROLETRA-BDLDIR                            RMB0010
 11728     MOVE 1 TO M-BDLDIR                                           RMB0010
 11729     PERFORM UNTIL M-BDLDIR > 58 OR                               RMB0010
 11730       (DIRECCION-A-ESTANDARIZAR-BDLDIR(M-BDLDIR:1) <> SPACES AND RMB0010
 11731        DIRECCION-A-ESTANDARIZAR-BDLDIR(M-BDLDIR:1) NOT NUMERIC)  RMB0010
 11732       ADD 1 TO M-BDLDIR                                          RMB0010
 11733     END-PERFORM.                                                 RMB0010
 11734     IF M-BDLDIR > 1 AND < 58                                     RMB0010
 11735        IF DIRECCION-A-ESTANDARIZAR-BDLDIR(M-BDLDIR - 1:1) NUMERICRMB0010
 11736           MOVE 1 TO CASO-NUMEROLETRA-BDLDIR                      RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 203
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11737        END-IF                                                    RMB0010
 11738     END-IF                                                       RMB0010
 11739     MOVE 1 TO M-BDLDIR                                           RMB0010
 11740     MOVE DIRECCION-A-ESTANDARIZAR-BDLDIR TO DIRECCION-60-BDLDIR  RMB0010
 11741*    PERFORM UNTIL M-BDLDIR > 89 OR                               RMB0010
 11742     PERFORM UNTIL M-BDLDIR > 499 OR                              PJV0027
 11743                   DIR-COMPUESTAS-AST-BDLDIR (M-BDLDIR) = SPACES  RMB0010
 11744        IF DIR-COMPUESTAS-TIP-BDLDIR (M-BDLDIR) = 0 OR            RMB0010
 11745          (DIR-COMPUESTAS-TIP-BDLDIR (M-BDLDIR) = 1 AND           RMB0010
 11746           CASO-NUMEROLETRA-BDLDIR = 1)                           RMB0010
 11747           MOVE DIR-COMPUESTAS-LON-BDLDIR(M-BDLDIR) TO N-BDLDIR   RMB0010
 11748           INITIALIZE DIR-COMPUESTAS-BLN-AUX-BDLDIR               RMB0010
 11749                      DIR-COMPUESTAS-AST-AUX-BDLDIR               RMB0010
 11750           MOVE DIR-COMPUESTAS-BLN-BDLDIR(M-BDLDIR)(1:N-BDLDIR) TORMB0010
 11751                DIR-COMPUESTAS-BLN-AUX-BDLDIR(2:N-BDLDIR)         RMB0010
 11752           MOVE DIR-COMPUESTAS-AST-BDLDIR(M-BDLDIR)(1:N-BDLDIR) TORMB0010
 11753                DIR-COMPUESTAS-AST-AUX-BDLDIR(2:N-BDLDIR)         RMB0010
 11754           ADD 2 TO N-BDLDIR                                      RMB0010
 11755           INSPECT DIRECCION-62-BDLDIR  REPLACING ALL             RMB0010
 11756                   DIR-COMPUESTAS-BLN-AUX-BDLDIR(1:N-BDLDIR) BY   RMB0010
 11757                   DIR-COMPUESTAS-AST-AUX-BDLDIR(1:N-BDLDIR)      RMB0010
 11758        END-IF                                                    RMB0010
 11759        ADD 1 TO M-BDLDIR                                         RMB0010
 11760     END-PERFORM.                                                 RMB0010
 11761     MOVE DIRECCION-60-BDLDIR TO DIRECCION-A-ESTANDARIZAR-BDLDIR  RMB0010
 11762     MOVE 1 TO M-BDLDIR                                           RMB0010
 11763     PERFORM UNTIL M-BDLDIR > 58 OR    *>MEJORA                   RMB0010
 11764             DIRECCION-A-ESTANDARIZAR-BDLDIR(M-BDLDIR:1) <> SPACESRMB0010
 11765       ADD 1 TO M-BDLDIR                                          RMB0010
 11766     END-PERFORM.                                                 RMB0010
 11767     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "C "       RMB0010
 11768***     CALLE                                                     RMB0010
 11769        MOVE "! " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010
 11770     END-IF                                                       RMB0010
 11771     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "K "       RMB0010
 11772***     CARRERA                                                   RMB0010
 11773        MOVE "# " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010
 11774     END-IF.                                                      RMB0010
 11775     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "B "       RMB0010
 11776***     BARRIO                                                    RMB0010
 11777        MOVE "$ " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010
 11778     END-IF.                                                      RMB0010
 11779     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "D "       RMB0010
 11780***     DIAGONAL                                                  RMB0010
 11781        MOVE "% " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010
 11782     END-IF.                                                      RMB0010
 11783     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "T "       RMB0010
 11784***     TRANSVERSAL                                               RMB0010
 11785        MOVE "& " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010
 11786     END-IF.                                                      RMB0010
 11787
 11788 6120-EVALUAR-ADICION-PUNTOS.                                     RMB0010
 11789******************************************************************RMB0010
 11790*6120-EVALUAR-ADICION-PUNTOS.                                    *RMB0010
 11791*    ESTA PARTE DE LA RUTINA DETERMINA POR UN LADO SI LA         *RMB0010
 11792*    DIRECCION ES CERTIFICADA (CASO EN EL CUAL ADICIONA 50 A LA  *RMB0010
 11793*    CALIFICACION DEFINITIVA) O SI TIENE PUNTOS ADICIONALES POR  *RMB0010
 11794*    GEOREFERENCIACION (10 PUNTOS ADICIONALES)                   *RMB0010
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 204
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11795******************************************************************RMB0010
 11796     IF DIRCER-BDLDIR = 1                                         RMB0010
 11797***     DIRECCION CERTIFICADA EXITOSAMENTE                        RMB0010
 11798        ADD 50 TO CALIFICA-DIR-BDLDIR                             RMB0010
 11799     END-IF                                                       RMB0010
 11800     IF PTSADI-BDLDIR = 1                                         RMB0010
 11801***     DIRECCION GEOREFERENCIADA EXITOSAMENTE                    RMB0010
 11802        ADD 10 TO CALIFICA-DIR-BDLDIR                             RMB0010
 11803     END-IF.                                                      RMB0010
 11804
 11805 6140-ELIMINAR-DIR-MALAS.                                         RMB0010
 11806******************************************************************RMB0010
 11807*6140-ELIMINAR-DIR-MALAS.                                        *RMB0010
 11808*    SE CALIFICAN CON 0 DIRECCIONES MALAS                        *RMB0010
 11809******************************************************************RMB0010
 11810     MOVE CALIFICA-DIR-BDLDIR TO CALIFICA-REAL-BDLDIR             RMB0010
 11811     MOVE DIRECCION-ESTANDARIZADA-BDLDIR TO DIRECCION-AUX-BDLDIR  RMB0010
 11812*RCNCER     INSPECT DIRECCION-AUX-BDLDIR REPLACING ALL " " BY "0" HGO0021
 11813*RCNCER     IF DIRECCION-AUX-BDLDIR NUMERIC                       HGO0021
 11814*RCNCER        MOVE 0 TO CALIFICA-DIR-BDLDIR                      HGO0021
 11815*RCNCER     END-IF.                                               HGO0021
 11816****                                                              RMB0010
 11817     IF CALIFICA-DIR-BDLDIR > 0                                   RMB0010
 11818        MOVE 1 TO M-BDLDIR                                        RMB0010
 11819        MOVE 0 TO N-BDLDIR                                        RMB0010
 11820        PERFORM UNTIL M-BDLDIR > 60                               RMB0010
 11821          IF DIRECCION-ESTANDARIZADA-BDLDIR(M-BDLDIR:1) <> SPACES RMB0010
 11822             ADD 1 TO N-BDLDIR                                    RMB0010
 11823          END-IF                                                  RMB0010
 11824*
 11825          ADD 1 TO M-BDLDIR                                       RMB0010
 11826        END-PERFORM                                               RMB0010
 11827*
 11828        IF N-BDLDIR < 6                                           RMB0010
 11829           IF CALIFICA-DIR-BDLDIR < 25                            RMB0010
 11830              MOVE 0 TO CALIFICA-DIR-BDLDIR                       RMB0010
 11831           END-IF                                                 RMB0010
 11832        END-IF                                                    RMB0010
 11833     END-IF.                                                      RMB0010
 11834*
 11835*    REGLA EXCLUSION 4 : MENOS DE 8 CARACTERES                    FARF032
 11836     IF CALIFICA-DIR-BDLDIR > 0                                   FARF032
 11837        IF DIRECCION-ESTANDARIZADA-BDLDIR(8:) = SPACES            FARF032
 11838           MOVE 0 TO CALIFICA-DIR-BDLDIR                          FARF032
 11839        END-IF                                                    FARF032
 11840     END-IF.                                                      FARF032
 11841*                                                                 FARF032
 11842*    REGLA EXCLUSION 5 : SOLO TEXTO EN CIUDADES PRINCIPALES       FARF032
 11843     IF CALIFICA-DIR-BDLDIR > 0                                   FARF032
 11844        PERFORM 6141-NUMEROS-LETRAS-BDLDIR                        FARF032
 11845        IF HAY-NUMEROS-BDLDIR = 0 AND                             FARF033
 11846           V-DANEFIN-BDLDIR-AUX(3:6) = "001000" AND               FARF033
 11847           V-DANEFIN-BDLDIR-AUX(1:2) <> "25"                      FARF033
 11848           MOVE 0 TO CALIFICA-DIR-BDLDIR                          FARF033
 11849        END-IF                                                    FARF033
 11850     END-IF.                                                      FARF033
 11851*    INICIA COMENTARIO
 11852*        IF HAY-NUMEROS-BDLDIR = 0 AND                             FARF032
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 205
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11853*           V-DANEFIN-BDLDIR(I-BDLDIR)(3:6) = "001000" AND         FARF032
 11854*           V-DANEFIN-BDLDIR(I-BDLDIR)(1:2) <> "25"                FARF032
 11855*           MOVE 0 TO CALIFICA-DIR-BDLDIR                          FARF032
 11856*        END-IF                                                    FARF032
 11857*     END-IF.                                                      FARF032
 11858*    FIN COMENTARIO
 11859*                                                                 FARF032
 11860*    REGLA EXCLUSION 6 : SOLO NUMEROS EN LA DIRECCION             FARF032
 11861     IF CALIFICA-DIR-BDLDIR > 0                                   FARF032
 11862        IF HAY-LETRAS-BDLDIR = 0                                  FARF032
 11863           MOVE 0 TO CALIFICA-DIR-BDLDIR                          FARF032
 11864        END-IF                                                    FARF032
 11865     END-IF.                                                      FARF032
 11866*                                                                 FARF032
 11867*    REGLA EXCLUSION 7 : 3 O MAS NUMEROS IGUALES                  FARF032
 11868     IF CALIFICA-DIR-BDLDIR > 0                                   FARF032
 11869        PERFORM 6141-VER-PART-IGUALES-BDLDIR                      FARF032
 11870        IF HAY-MASDE3-REPETIDAS-BDLDIR = 1                        FARF032
 11871           MOVE 0 TO CALIFICA-DIR-BDLDIR                          FARF032
 11872        END-IF                                                    FARF032
 11873     END-IF.                                                      FARF032
 11874*                                                                 FARF032
 11875*    REGLA EXCLUSION 8 : ELIMIAR SI EMPIEZA POR AP O OF           FARF032
 11876     IF CALIFICA-DIR-BDLDIR > 0                                   FARF032
 11877        PERFORM 6141-VER-PRIMERA-PART-BDLDIR                      FARF032
 11878        IF HAY-PRIMERA-MALA-BDLDIR = 1                            FARF032
 11879           MOVE 0 TO CALIFICA-DIR-BDLDIR                          FARF032
 11880        END-IF                                                    FARF032
 11881     END-IF.                                                      FARF032
 11882*                                                                 FARF032
 11883*    REGLA EXCLUSION 9 : NUMERO DE 4 O MAS AFTER VIA PRINCIPAL    FARF032
 11884     IF CALIFICA-DIR-BDLDIR > 0                                   FARF032
 11885        PERFORM 6141-VER-NUM-AFTER-VIA-BDLDIR                     FARF032
 11886        IF HAY-NUMEROS4-VIAS-BDLDIR   = 1                         FARF032
 11887           MOVE 0 TO CALIFICA-DIR-BDLDIR                          FARF032
 11888        END-IF                                                    FARF032
 11889     END-IF.                                                      FARF032
 11890*
 11891*    REGLAS DE EXCLUSION 10 : ELIMINAR SI COMIENZA POR UNA
 11892*    PARTICULA ESPECIFICA.
 11893     IF CALIFICA-DIR-BDLDIR > 0                                   FARF037
 11894        MOVE 0 TO  JJ-BDLDIR *> sw de si excluye por regla 10     FARF037
 11895        PERFORM 6141-EXCL-POR-INICIO-PARTICULA                    FARF037
 11896        IF JJ-BDLDIR = 1                                          FARF037
 11897           MOVE 0 TO CALIFICA-DIR-BDLDIR                          FARF037
 11898        END-IF                                                    FARF037
 11899     END-IF.                                                      FARF037
 11900
 11901*    6141-EXCL-POR-INICIO-PARTICULA
 11902*    se eliminan direcciones que comiensen con ALTO,AP,BG,BL,BRR,
 11903*    CA,CIUD,CONJ,CORRG,CRT,DA,ED,ET,IN,KM,LC,LT,M,MT,MZ,MZANA,
 11904*    MZB,MZD,ND,NN,NR,NTE,OF,OT,PA,PD,PI,PL, PLA, PLAN, PLZ,PN,
 11905*    PQUE,PRJ,PS, PT,RA,SC,SCT,SCTR,SD,SE,SEC,SM, SMZ ,SUR,TO ,UN,
 11906*    URB,ZN
 11907*    si adicionalmente no contiene otras particulas. si la
 11908*    vairable JJ-BDLDIR queda con valor en 1, se debe excluir la
 11909*    direccion.
 11910*
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 206
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11911     6141-EXCL-POR-INICIO-PARTICULA.                              FARF037
 11912     EVALUATE NVA-DIR-BDLDIR(1)                                   FARF037
 11913     WHEN "ALTO"                                                  FARF037
 11914     WHEN "APTO"                                                  FARF040
 11915     WHEN "BG"                                                    FARF037
 11916     WHEN "BL"                                                    FARF037
 11917     WHEN "BR"                                                    FARF040
 11918     WHEN "CA"                                                    FARF037
 11919     WHEN "CIUD"                                                  FARF037
 11920     WHEN "CONJ"                                                  FARF037
 11921     WHEN "CO"                                                    FARF040
 11922     WHEN "CT"                                                    FARF040
 11923     WHEN "DA"                                                    FARF037
 11924     WHEN "ED"                                                    FARF037
 11925     WHEN "ET"                                                    FARF037
 11926     WHEN "IN"                                                    FARF037
 11927     WHEN "KM"                                                    FARF037
 11928     WHEN "LC"                                                    FARF037
 11929     WHEN "LT"                                                    FARF037
 11930     WHEN "M"                                                     FARF037
 11931     WHEN "MT"                                                    FARF037
 11932     WHEN "MZ"                                                    FARF037
 11933     WHEN "MZANA"                                                 FARF037
 11934     WHEN "MZB"                                                   FARF037
 11935     WHEN "MZD"                                                   FARF037
 11936     WHEN "ND"                                                    FARF037
 11937     WHEN "NN"                                                    FARF037
 11938     WHEN "NR"                                                    FARF037
 11939     WHEN "NTE"                                                   FARF037
 11940     WHEN "OF"                                                    FARF037
 11941     WHEN "OT"                                                    FARF037
 11942     WHEN "PA"                                                    FARF037
 11943     WHEN "PD"                                                    FARF037
 11944     WHEN "PI"                                                    FARF037
 11945     WHEN "PL"                                                    FARF037
 11946     WHEN "PLA"                                                   FARF037
 11947     WHEN "PLAN"                                                  FARF037
 11948     WHEN "PLZ"                                                   FARF037
 11949     WHEN "PN"                                                    FARF037
 11950     WHEN "PQUE"                                                  FARF037
 11951     WHEN "PRJ"                                                   FARF037
 11952     WHEN "PS"                                                    FARF037
 11953     WHEN "PT"                                                    FARF037
 11954     WHEN "RA"                                                    FARF037
 11955     WHEN "SC"                                                    FARF037
 11956     WHEN "SCT"                                                   FARF037
 11957     WHEN "SCTR"                                                  FARF037
 11958     WHEN "SD"                                                    FARF037
 11959     WHEN "SE"                                                    FARF037
 11960     WHEN "SEC"                                                   FARF037
 11961     WHEN "SM"                                                    FARF037
 11962     WHEN "SMZ"                                                   FARF037
 11963     WHEN "SUR"                                                   FARF037
 11964     WHEN "TO"                                                    FARF037
 11965     WHEN "UN"                                                    FARF037
 11966     WHEN "URB"                                                   FARF037
 11967     WHEN "VIA"                                                   FARF037
 11968     WHEN "VDA"                                                   FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 207
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 11969     WHEN "ZN"                                                    FARF037
 11970        MOVE 1 TO JJ-BDLDIR                                       FARF037
 11971     END-EVALUATE.                                                FARF037
 11972*
 11973*    si contiene la particula CL,KR,AV,DG,TV,AC,AK,AP es valida
 11974     IF JJ-BDLDIR = 1                                             FARF037
 11975        MOVE 2 TO M-BDLDIR  *> Recorre vector de particulas       FARF037
 11976        PERFORM UNTIL M-BDLDIR > CON-PART-ESTANDARIZADA-BDLDIR    FARF037
 11977           EVALUATE NVA-DIR-BDLDIR(M-BDLDIR)                      FARF037
 11978           WHEN "AC"                                              FARF037
 11979           WHEN "AK"                                              FARF037
 11980           WHEN "AV"                                              FARF037
 11981           WHEN "CL"                                              FARF037
 11982           WHEN "DG"                                              FARF037
 11983           WHEN "KR"                                              FARF037
 11984           WHEN "TV"                                              FARF037
 11985              MOVE 0 TO JJ-BDLDIR                                 FARF037
 11986              MOVE 60 TO M-BDLDIR                                 FARF037
 11987           END-EVALUATE                                           FARF037
 11988*
 11989           ADD 1 TO M-BDLDIR                                      FARF037
 11990        END-PERFORM                                               FARF037
 11991     END-IF.                                                      FARF037
 11992*
 11993*    si inicia por una de estas
 11994*    y contiene otra combinacion se puede no excluir              FARF037
 11995     IF JJ-BDLDIR = 1                                             FARF037
 11996        EVALUATE NVA-DIR-BDLDIR(1)                                FARF037
 11997        WHEN "BR"                                                 FARF040
 11998        WHEN "MZ"                                                 FARF037
 11999        WHEN "URB"                                                FARF037
 12000        WHEN "KM"                                                 FARF037
 12001        WHEN "BL"                                                 FARF037
 12002        WHEN "ET"                                                 FARF037
 12003        WHEN "CA"                                                 FARF037
 12004        WHEN "CONJ"                                               FARF037
 12005        WHEN "LT"                                                 FARF037
 12006        WHEN "SEC"                                                FARF037
 12007        WHEN "ALTO"                                               FARF037
 12008        WHEN "CIUD"                                               FARF037
 12009        WHEN "CT"                                                 FARF040
 12010        WHEN "SMZ"                                                FARF037
 12011        WHEN "ED"                                                 FARF037
 12012        WHEN "VIA"                                                FARF037
 12013        WHEN "VDA"                                                FARF037
 12014           PERFORM 6141-VERIFICA-OTRA-PARTICULA                   FARF037
 12015        END-EVALUATE                                              FARF037
 12016     END-IF.                                                      FARF037
 12017*
 12018*    6141-VERIFICA-OTRA-PARTICULA
 12019*    se verefica si cumple con la combinacion de otras particulas
 12020*    se utilizara la variable TIP-NUEVA-DIRECCION-BDLDIR como un
 12021*    arreglo de swiches para saber si la direccion tiene las
 12022*    otras particulas con la posiciones.
 12023*
 12024     6141-VERIFICA-OTRA-PARTICULA.                                FARF037
 12025*    llenamos el vectoe de swiches                                FARF037
 12026     INITIALIZE TIP-NUEVA-DIRECCION-BDLDIR.                       FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 208
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12027     MOVE 2 TO M-BDLDIR  *> Recorre vector de particulas          FARF037
 12028     PERFORM UNTIL M-BDLDIR > CON-PART-ESTANDARIZADA-BDLDIR       FARF037
 12029        EVALUATE NVA-DIR-BDLDIR(M-BDLDIR)                         FARF037
 12030        WHEN "CA"                                                 FARF037
 12031           MOVE "1" TO TIP-NVA-DIR-BDLDIR(01)                     FARF037
 12032        WHEN "URB"                                                FARF037
 12033           MOVE "1" TO TIP-NVA-DIR-BDLDIR(02)                     FARF037
 12034        WHEN "MZ"                                                 FARF037
 12035           MOVE "1" TO TIP-NVA-DIR-BDLDIR(03)                     FARF037
 12036        WHEN "BL"                                                 FARF037
 12037           MOVE "1" TO TIP-NVA-DIR-BDLDIR(04)                     FARF037
 12038        WHEN "APTO"                                               FARF040
 12039           MOVE "1" TO TIP-NVA-DIR-BDLDIR(05)                     FARF037
 12040        WHEN "KM"                                                 FARF037
 12041           MOVE "1" TO TIP-NVA-DIR-BDLDIR(06)                     FARF037
 12042        WHEN "FCA"                                                FARF037
 12043           MOVE "1" TO TIP-NVA-DIR-BDLDIR(07)                     FARF037
 12044        WHEN "AUTOP"                                              FARF037
 12045           MOVE "1" TO TIP-NVA-DIR-BDLDIR(08)                     FARF037
 12046        WHEN "VIA"                                                FARF037
 12047           MOVE "1" TO TIP-NVA-DIR-BDLDIR(09)                     FARF037
 12048        WHEN "VDA"                                                FARF037
 12049           MOVE "1" TO TIP-NVA-DIR-BDLDIR(10)                     FARF037
 12050        WHEN "VE"                                                 FARF037
 12051           MOVE "1" TO TIP-NVA-DIR-BDLDIR(11)                     FARF037
 12052        WHEN "CO"                                                 FARF040
 12053           MOVE "1" TO TIP-NVA-DIR-BDLDIR(12)                     FARF037
 12054        WHEN "BR"                                                 FARF040
 12055           MOVE "1" TO TIP-NVA-DIR-BDLDIR(13)                     FARF037
 12056        WHEN "CONJ"                                               FARF037
 12057           MOVE "1" TO TIP-NVA-DIR-BDLDIR(14)                     FARF037
 12058        WHEN "ED"                                                 FARF037
 12059           MOVE "1" TO TIP-NVA-DIR-BDLDIR(15)                     FARF037
 12060        WHEN "CIUD"                                               FARF037
 12061           MOVE "1" TO TIP-NVA-DIR-BDLDIR(16)                     FARF037
 12062        WHEN "LT"                                                 FARF037
 12063           MOVE "1" TO TIP-NVA-DIR-BDLDIR(17)                     FARF037
 12064        WHEN "TO"                                                 FARF037
 12065           MOVE "1" TO TIP-NVA-DIR-BDLDIR(18)                     FARF037
 12066        WHEN "ET"                                                 FARF037
 12067           MOVE "1" TO TIP-NVA-DIR-BDLDIR(19)                     FARF037
 12068        WHEN "SEC"                                                FARF037
 12069           MOVE "1" TO TIP-NVA-DIR-BDLDIR(20)                     FARF037
 12070        WHEN "LC"                                                 FARF037
 12071           MOVE "1" TO TIP-NVA-DIR-BDLDIR(21)                     FARF037
 12072        WHEN "PA"                                                 FARF037
 12073           MOVE "1" TO TIP-NVA-DIR-BDLDIR(22)                     FARF037
 12074        WHEN "PLAN"                                               FARF037
 12075           MOVE "1" TO TIP-NVA-DIR-BDLDIR(23)                     FARF037
 12076        END-EVALUATE                                              FARF037
 12077*
 12078        ADD 1 TO M-BDLDIR                                         FARF037
 12079     END-PERFORM .                                                FARF037
 12080*
 12081*    Si empieza con BRR y contiene MZ(03) y LT(17)
 12082*    Si empieza con BRR y contiene MZ(03) y SEC(20)
 12083*    Si empieza con BRR y contiene MZ(03) y URB(02)
 12084*    Si empieza con BRR y contiene MZ(03) y BL(04)
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 209
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12085*
 12086*    SI Empieza por BRR y contiene CA(01)
 12087     IF NVA-DIR-BDLDIR(1) = "BR"                                  FARF040
 12088        IF TIP-NVA-DIR-BDLDIR(03) = "1"                           FARF037
 12089           IF TIP-NVA-DIR-BDLDIR(17) = "1" OR                     FARF037
 12090              TIP-NVA-DIR-BDLDIR(20) = "1" OR                     FARF037
 12091              TIP-NVA-DIR-BDLDIR(02) = "1" OR                     FARF037
 12092              TIP-NVA-DIR-BDLDIR(04) = "1"                        FARF037
 12093              MOVE 0 TO JJ-BDLDIR                                 FARF037
 12094           END-IF                                                 FARF037
 12095        END-IF                                                    FARF037
 12096*
 12097        IF TIP-NVA-DIR-BDLDIR(01) = "1"                           FARF037
 12098           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12099        END-IF                                                    FARF037
 12100     END-IF.                                                      FARF037
 12101*
 12102*    si empieza por MZ y contiene CA(01)
 12103*    si empieza por MZ y contiene URB(02)
 12104*    Si empieza por MZ y contiene ET(19) y BRR(13)
 12105*
 12106*    Si empieza por MZ y contiene LT(17) y AP(05)
 12107*    Si empieza por MZ y contiene LT(17) y BRR(13)
 12108*    Si empieza por MZ y contiene LT(17) y ET(19)
 12109*    Si empieza por MZ y contiene LT(17) y LC(21)
 12110*    Si empieza por MZ y contiene LT(17) y PA(22)
 12111*    Si empieza por MZ y contiene LT(17) y PLAN(23)
 12112*    Si empieza por MZ y contiene LT(17) y VIA(09)
 12113*    Si empieza por MZ y contiene LT(17) y SEC(20)
 12114     IF NVA-DIR-BDLDIR(1) = "MZ"                                  FARF037
 12115        IF (TIP-NVA-DIR-BDLDIR(01) = "1") OR                      FARF037
 12116           (TIP-NVA-DIR-BDLDIR(02) = "1") OR                      FARF037
 12117           (TIP-NVA-DIR-BDLDIR(19) = "1"                          FARF037
 12118            AND TIP-NVA-DIR-BDLDIR(13) = "1")                     FARF037
 12119           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12120        END-IF                                                    FARF037
 12121*
 12122        IF TIP-NVA-DIR-BDLDIR(17) = "1"                           FARF037
 12123           IF TIP-NVA-DIR-BDLDIR(05) = "1" OR                     FARF037
 12124              TIP-NVA-DIR-BDLDIR(13) = "1" OR                     FARF037
 12125              TIP-NVA-DIR-BDLDIR(19) = "1" OR                     FARF037
 12126              TIP-NVA-DIR-BDLDIR(21) = "1" OR                     FARF037
 12127              TIP-NVA-DIR-BDLDIR(22) = "1" OR                     FARF037
 12128              TIP-NVA-DIR-BDLDIR(23) = "1" OR                     FARF037
 12129              TIP-NVA-DIR-BDLDIR(09) = "1" OR                     FARF037
 12130              TIP-NVA-DIR-BDLDIR(20) = "1"                        FARF037
 12131              MOVE 0 TO JJ-BDLDIR                                 FARF037
 12132           END-IF                                                 FARF037
 12133        END-IF                                                    FARF037
 12134     END-IF.                                                      FARF037
 12135*
 12136*    si empieza por URB y contiene MZ(03)
 12137*
 12138*    si empieza con URB y contiene BL(04) y AP(05).
 12139*    Si empieza por URB y contiene BL(04) y CA(01)
 12140*
 12141*    Si empieza por URB y contiene ET(19) y CA(01)
 12142*    Si empieza por URB y contiene SEC(20) y AP(05)
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 210
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12143*
 12144     IF NVA-DIR-BDLDIR(1) = "URB"                                 FARF037
 12145        IF (TIP-NVA-DIR-BDLDIR(03) = "1" ) OR                     FARF037
 12146           (TIP-NVA-DIR-BDLDIR(04) = "1"                          FARF037
 12147            AND (TIP-NVA-DIR-BDLDIR(05) = "1"                     FARF037
 12148                 OR TIP-NVA-DIR-BDLDIR(01) = "1")) OR             FARF037
 12149           (TIP-NVA-DIR-BDLDIR(19) = "1"                          FARF037
 12150            AND TIP-NVA-DIR-BDLDIR(01) = "1") OR                  FARF037
 12151           (TIP-NVA-DIR-BDLDIR(20) = "1"                          FARF037
 12152            AND TIP-NVA-DIR-BDLDIR(05) = "1")                     FARF037
 12153           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12154        END-IF                                                    FARF037
 12155     END-IF.                                                      FARF037
 12156*
 12157*    si empieza con KM y contiene FCA(07) .
 12158*    si empieza con KM y contiene AUTOP(08)
 12159*    si empieza con Km y contiene VIA(09)
 12160*    si empieza con Km Y contiene VDA(10) o VE(11)
 12161*    Si empieza por KM y contiene CORRG(12)
 12162*    si empieza con KM y contiene URB(02)
 12163*
 12164*    Si empieza con KM y contiene CA(01) y CONJ(14)
 12165     IF NVA-DIR-BDLDIR(1) = "KM"                                  FARF037
 12166        IF (TIP-NVA-DIR-BDLDIR(07) = "1") OR                      FARF037
 12167           (TIP-NVA-DIR-BDLDIR(08) = "1") OR                      FARF037
 12168           (TIP-NVA-DIR-BDLDIR(09) = "1") OR                      FARF037
 12169           (TIP-NVA-DIR-BDLDIR(10) = "1") OR                      FARF037
 12170           (TIP-NVA-DIR-BDLDIR(11) = "1") OR                      FARF037
 12171           (TIP-NVA-DIR-BDLDIR(12) = "1") OR                      FARF037
 12172           (TIP-NVA-DIR-BDLDIR(02) = "1") OR                      FARF037
 12173           (TIP-NVA-DIR-BDLDIR(01) = "1"                          FARF037
 12174            AND TIP-NVA-DIR-BDLDIR(14) = "1")                     FARF037
 12175           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12176        END-IF                                                    FARF037
 12177     END-IF.                                                      FARF037
 12178*
 12179*    si empieza con BL y contiene AP(05) y URB(02)
 12180*    si empieza con BL y contiene AP(05) y BRR(13)
 12181*    si empieza con BL y contiene AP(05) y CONJ(14)
 12182*    si empieza con BL y contiene AP(05) y ED(15)
 12183*    si empieza con BL y contiene AP(05) y CIUD(16)
 12184*    Si empieza con BL y contiene AP(05) y ET(19)
 12185*    Si empieza con BL y contiene AP(05) y SEC(20)
 12186*    Si empieza con BL y contiene AP(05) Y MZ(03)(igual a MZ y AP)
 12187*
 12188*    Si empieza con BL y contiene CA(01) y MZ(03)(igual a MZ y CA)
 12189*    Si empieza con BL y contiene CA(01) y BRR(13)
 12190     IF NVA-DIR-BDLDIR(1) = "BL"                                  FARF037
 12191        IF TIP-NVA-DIR-BDLDIR(05) = "1"                           FARF037
 12192           IF TIP-NVA-DIR-BDLDIR(02) = "1" OR                     FARF037
 12193              TIP-NVA-DIR-BDLDIR(13) = "1" OR                     FARF037
 12194              TIP-NVA-DIR-BDLDIR(14) = "1" OR                     FARF037
 12195              TIP-NVA-DIR-BDLDIR(15) = "1" OR                     FARF037
 12196              TIP-NVA-DIR-BDLDIR(16) = "1" OR                     FARF037
 12197              TIP-NVA-DIR-BDLDIR(19) = "1" OR                     FARF037
 12198              TIP-NVA-DIR-BDLDIR(20) = "1" OR                     FARF037
 12199              TIP-NVA-DIR-BDLDIR(03) = "1"                        FARF037
 12200              MOVE 0 TO JJ-BDLDIR                                 FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 211
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12201           END-IF                                                 FARF037
 12202        END-IF                                                    FARF037
 12203*                                                                 FARF037
 12204        IF (TIP-NVA-DIR-BDLDIR(01) = "1") AND                       FARF03
 12205           (TIP-NVA-DIR-BDLDIR(03) = "1"                          FARF037
 12206            OR TIP-NVA-DIR-BDLDIR(13) = "1")                      FARF037
 12207           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12208        END-IF                                                    FARF037
 12209     END-IF.                                                      FARF037
 12210*
 12211*    si empieza con ET y contiene CA(01) y BRR(13) .
 12212*    si empieza con ET y contiene MZ(03) y LT(17) y BRR(13)
 12213     IF NVA-DIR-BDLDIR(1) = "ET"                                  FARF037
 12214        IF TIP-NVA-DIR-BDLDIR(13) = "1"                           FARF037
 12215           IF (TIP-NVA-DIR-BDLDIR(01) = "1") OR                   FARF037
 12216              (TIP-NVA-DIR-BDLDIR(03) = "1"                       FARF037
 12217               AND TIP-NVA-DIR-BDLDIR(17) = "1")                  FARF037
 12218              MOVE 0 TO JJ-BDLDIR                                 FARF037
 12219           END-IF                                                 FARF037
 12220        END-IF                                                    FARF037
 12221     END-IF.                                                      FARF037
 12222*
 12223*    si empieza con CA y contiene KM(06).
 12224*    si empieza con CA y contiene LT(17) y URB(02)
 12225*    si empieza con CA y contiene LT(17) y BRR(13)
 12226*
 12227*    Si empieza por CA y portiene MZ(03) y ET(19)
 12228*    Si empieza por CA y portiene MZ(03) y SEC(20)
 12229     IF NVA-DIR-BDLDIR(1) = "CA"                                  FARF037
 12230        IF (TIP-NVA-DIR-BDLDIR(06) = "1") OR                      FARF037
 12231           (TIP-NVA-DIR-BDLDIR(17) = "1"                          FARF037
 12232            AND (TIP-NVA-DIR-BDLDIR(02) = "1"                     FARF037
 12233                 OR TIP-NVA-DIR-BDLDIR(13) = "1"))                FARF037
 12234           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12235        END-IF                                                    FARF037
 12236*
 12237        IF (TIP-NVA-DIR-BDLDIR(03) = "1"  AND                     FARF037
 12238           (TIP-NVA-DIR-BDLDIR(19) = "1"                          FARF037
 12239            OR TIP-NVA-DIR-BDLDIR(20) = "1"))                     FARF037
 12240           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12241        END-IF                                                    FARF037
 12242     END-IF.                                                      FARF037
 12243*
 12244*    si empieza con CONJ y contiene BL(04) y AP(05) .
 12245*    si empieza con CONJ y contiene TO(18) y AP(05) .
 12246     IF NVA-DIR-BDLDIR(1) = "CONJ"                                FARF037
 12247        IF (TIP-NVA-DIR-BDLDIR(05) = "1" AND                      FARF037
 12248            (TIP-NVA-DIR-BDLDIR(04) = "1"                         FARF037
 12249             OR TIP-NVA-DIR-BDLDIR(18) = "1"))                     FARF037
 12250           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12251        END-IF                                                    FARF037
 12252     END-IF.                                                      FARF037
 12253*    si empieza con LT y contiene MZ(03) y CA(01)
 12254*    Si empieza por LT y portiene MZ(03) y BRR(13)
 12255*    Si empieza por LT y portiene MZ(03) y SEC(20)
 12256
 12257     IF NVA-DIR-BDLDIR(1) = "LT" AND                              FARF037
 12258        TIP-NVA-DIR-BDLDIR(03) = "1"                              FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 212
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12259        IF TIP-NVA-DIR-BDLDIR(01) = "1" OR                        FARF037
 12260           TIP-NVA-DIR-BDLDIR(13) = "1" OR                        FARF037
 12261           TIP-NVA-DIR-BDLDIR(20) = "1"                           FARF037
 12262           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12263        END-IF                                                    FARF037
 12264     END-IF.                                                      FARF037
 12265*
 12266*    si empieza con SEC y contiene MZ(03) y LT(17).
 12267*    si empieza con SEC y contiene MZ(03) y CA(01).
 12268*    Si empieza por SEC y contiene MZ(03) y ET(19)
 12269
 12270*    si empieza con SEC y contiene TO(18) y AP(05).
 12271*    si empieza con SEC y contiene BL(04) y AP(05) .
 12272*
 12273*    Si empieza por SEC y contiene CA(01) y ET(19)
 12274     IF NVA-DIR-BDLDIR(1) = "SEC"                                 FARF037
 12275        IF TIP-NVA-DIR-BDLDIR(03) = "1"                           FARF037
 12276           IF TIP-NVA-DIR-BDLDIR(17) = "1" OR                     FARF037
 12277              TIP-NVA-DIR-BDLDIR(01) = "1" OR                     FARF037
 12278              TIP-NVA-DIR-BDLDIR(19) = "1"                        FARF037
 12279              MOVE 0 TO JJ-BDLDIR                                 FARF037
 12280           END-IF                                                 FARF037
 12281        END-IF                                                    FARF037
 12282*
 12283        IF TIP-NVA-DIR-BDLDIR(05) = "1"                           FARF037
 12284           IF TIP-NVA-DIR-BDLDIR(18) = "1" OR                     FARF037
 12285              TIP-NVA-DIR-BDLDIR(04) = "1"                        FARF037
 12286              MOVE 0 TO JJ-BDLDIR                                 FARF037
 12287           END-IF                                                 FARF037
 12288        END-IF                                                    FARF037
 12289*
 12290        IF TIP-NVA-DIR-BDLDIR(01) = "1" AND                       FARF037
 12291           TIP-NVA-DIR-BDLDIR(19) = "1"                           FARF037
 12292           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12293        END-IF                                                    FARF037
 12294     END-IF.                                                      FARF037
 12295*
 12296*    Si empieza con ALTO y contiene KM(06) y LT(17)
 12297*    Si empieza con ALTO y contiene MZ(03) y LT(17)
 12298*    Si empieza con ALTO y contiene TO(18) y AP(05)
 12299*
 12300     IF NVA-DIR-BDLDIR(1) = "ALTO"                                FARF037
 12301        IF (TIP-NVA-DIR-BDLDIR(06) = "1"                          FARF037
 12302            AND TIP-NVA-DIR-BDLDIR(17) = "1") OR                  FARF037
 12303           (TIP-NVA-DIR-BDLDIR(03) = "1"                          FARF037
 12304            AND TIP-NVA-DIR-BDLDIR(17) = "1")  OR                 FARF037
 12305           (TIP-NVA-DIR-BDLDIR(18) = "1"                          FARF037
 12306            AND TIP-NVA-DIR-BDLDIR(05) = "1")                     FARF037
 12307           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12308        END-IF                                                    FARF037
 12309     END-IF.                                                      FARF037
 12310*
 12311*    Si empieza por CIUD y contiene BL(04) y AP(05)
 12312*    Si empieza por CIUD y contiene BL(04) y CA(01)
 12313     IF NVA-DIR-BDLDIR(1) = "CIUD"                                FARF037
 12314        IF (TIP-NVA-DIR-BDLDIR(04) = "1"  AND                     FARF037
 12315           (TIP-NVA-DIR-BDLDIR(05) = "1"                          FARF037
 12316            OR TIP-NVA-DIR-BDLDIR(01) = "1"))                     FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 213
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12317           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12318        END-IF                                                    FARF037
 12319     END-IF.                                                      FARF037
 12320*
 12321*    Si empieza por CRT y contiene KM(06)
 12322     IF NVA-DIR-BDLDIR(1) = "CT" AND                              FARF040
 12323        TIP-NVA-DIR-BDLDIR(06) = "1"                              FARF037
 12324        MOVE 0 TO JJ-BDLDIR                                       FARF037
 12325     END-IF.                                                      FARF037
 12326*
 12327*    Si empieza por SMZ y contiene MZ(03) y CA(01)
 12328     IF NVA-DIR-BDLDIR(1) = "SMZ"                                 FARF037
 12329        IF TIP-NVA-DIR-BDLDIR(03) = "1"  AND                      FARF037
 12330           TIP-NVA-DIR-BDLDIR(01) = "1"                           FARF037
 12331           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12332        END-IF                                                    FARF037
 12333     END-IF.                                                      FARF037
 12334*
 12335*    Si empieza con ED y contiene BL(04) y AP(05)
 12336     IF NVA-DIR-BDLDIR(1) = "ED"                                  FARF037
 12337        IF TIP-NVA-DIR-BDLDIR(04) = "1"  AND                      FARF037
 12338           TIP-NVA-DIR-BDLDIR(05) = "1"                           FARF037
 12339           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12340        END-IF                                                    FARF037
 12341     END-IF.                                                      FARF037
 12342*
 12343*    Si empieza por VIA y contiene KM(06)
 12344     IF NVA-DIR-BDLDIR(1) = "VIA" AND                             FARF037
 12345        TIP-NVA-DIR-BDLDIR(06) = "1"                              FARF037
 12346           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12347     END-IF.                                                      FARF037
 12348*
 12349*    Si empieza por VDA y contiene KM(06)
 12350     IF NVA-DIR-BDLDIR(1) = "VDA" AND                             FARF037
 12351        TIP-NVA-DIR-BDLDIR(06) = "1"                              FARF037
 12352           MOVE 0 TO JJ-BDLDIR                                    FARF037
 12353     END-IF.                                                      FARF037
 12354*
 12355*                                                                 FARF032
 12356 6141-NUMEROS-LETRAS-BDLDIR.                                      FARF032
 12357     MOVE 0 TO HAY-NUMEROS-BDLDIR.                                FARF032
 12358     MOVE 0 TO HAY-LETRAS-BDLDIR.                                 FARF032
 12359     MOVE 1 TO M-BDLDIR.                                          FARF032
 12360     PERFORM UNTIL M-BDLDIR > 60                                  FARF032
 12361        IF DIRECCION-ESTANDARIZADA-BDLDIR(M-BDLDIR:1) NUMERIC     FARF032
 12362           ADD 1 TO HAY-NUMEROS-BDLDIR                            FARF032
 12363        ELSE                                                      FARF032
 12364           IF DIRECCION-ESTANDARIZADA-BDLDIR(M-BDLDIR:1) <> SPACESFARF032
 12365              ADD 1 TO HAY-LETRAS-BDLDIR                          FARF032
 12366           END-IF                                                 FARF032
 12367        END-IF                                                    FARF032
 12368*                                                                 FARF032
 12369        ADD 1 TO M-BDLDIR                                         FARF032
 12370     END-PERFORM.                                                 FARF032
 12371*                                                                 FARF032
 12372 6141-VER-PART-IGUALES-BDLDIR.                                    FARF032
 12373     MOVE 0 TO HAY-MASDE3-REPETIDAS-BDLDIR.                       FARF032
 12374     MOVE 1 TO N-BDLDIR.                                          FARF032
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 214
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12375     PERFORM UNTIL NVA-DIR-BDLDIR(N-BDLDIR) = SPACES              FARF032
 12376                                OR N-BDLDIR > 60                  FARF032
 12377        MOVE 0 TO CONT-REPETIDAS-BDLDIR                           FARF032
 12378        MOVE 1 TO M-BDLDIR                                        FARF032
 12379        PERFORM UNTIL NVA-DIR-BDLDIR(M-BDLDIR) = SPACES OR        FARF032
 12380                                      M-BDLDIR > 60               FARF032
 12381           IF NVA-DIR-BDLDIR(N-BDLDIR) =                          FARF032
 12382              NVA-DIR-BDLDIR(M-BDLDIR)                            FARF032
 12383              ADD 1 TO CONT-REPETIDAS-BDLDIR                      FARF032
 12384           END-IF                                                 FARF032
 12385*                                                                 FARF032
 12386           ADD 1 TO M-BDLDIR                                      FARF032
 12387        END-PERFORM                                               FARF032
 12388*                                                                 FARF032
 12389        IF CONT-REPETIDAS-BDLDIR > 3                              FARF032
 12390           MOVE 1 TO HAY-MASDE3-REPETIDAS-BDLDIR                  FARF032
 12391        END-IF                                                    FARF032
 12392*                                                                 FARF032
 12393        ADD 1 TO N-BDLDIR                                         FARF032
 12394     END-PERFORM.                                                 FARF032
 12395*                                                                 FARF032
 12396 6141-VER-PRIMERA-PART-BDLDIR.                                    FARF032
 12397     MOVE 0 TO HAY-PRIMERA-MALA-BDLDIR.                           FARF032
 12398     IF NVA-DIR-BDLDIR(1) = "APTO" OR "OF"                        FARF040
 12399        MOVE 1 TO HAY-PRIMERA-MALA-BDLDIR                         FARF032
 12400     END-IF.                                                      FARF032
 12401*                                                                 FARF032
 12402 6141-VER-NUM-AFTER-VIA-BDLDIR.                                   FARF032
 12403     MOVE 0 TO HAY-NUMEROS4-VIAS-BDLDIR  .                        FARF032
 12404     MOVE 1 TO N-BDLDIR.                                          FARF032
 12405     PERFORM UNTIL V-VIAS-PRIN-BDLDIR(N-BDLDIR) = SPACES          FARF032
 12406        MOVE 1 TO M-BDLDIR                                        FARF032
 12407        MOVE 0 TO CONT-REPETIDAS-BDLDIR                           FARF032
 12408        PERFORM UNTIL NVA-DIR-BDLDIR(M-BDLDIR) = SPACES           FARF032
 12409                                   OR M-BDLDIR > 60               FARF032
 12410           IF V-VIAS-PRIN-BDLDIR(N-BDLDIR) =                      FARF032
 12411              NVA-DIR-BDLDIR(M-BDLDIR)                            FARF032
 12412              IF NVA-DIR-BDLDIR(M-BDLDIR + 1)(1:4) NUMERIC        FARF032
 12413                 ADD 1 TO CONT-REPETIDAS-BDLDIR                   FARF032
 12414              END-IF                                              FARF032
 12415           END-IF                                                 FARF032
 12416*                                                                 FARF032
 12417           ADD 1 TO M-BDLDIR                                      FARF032
 12418        END-PERFORM                                               FARF032
 12419*                                                                 FARF032
 12420        IF CONT-REPETIDAS-BDLDIR > 0                              FARF032
 12421           MOVE 1 TO HAY-NUMEROS4-VIAS-BDLDIR                     FARF032
 12422        END-IF                                                    FARF032
 12423*                                                                 FARF032
 12424        ADD 1 TO N-BDLDIR                                         FARF032
 12425     END-PERFORM.                                                 FARF032
 12426*                                                                 FARF032
 12427*****                                                             RMB0010
 12428*RCNCER     IF CALIFICA-DIR-BDLDIR > 0                            HGO0021
 12429*RCNCER        MOVE 0 TO M-BDLDIR                                 HGO0021
 12430*RCNCER        INSPECT TIP-NUEVA-DIRECCION-BDLDIR  TALLYING M-BDLDHGO0021
 12431*RCNCER                FOR ALL "S"                                HGO0021
 12432*RCNCER        IF M-BDLDIR = 0 AND CALIFICA-DIR-BDLDIR < 25   *> MHGO0021
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 215
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12433*RCNCER           MOVE 0 TO CALIFICA-DIR-BDLDIR                   HGO0021
 12434*RCNCER        END-IF                                             HGO0021
 12435*RCNCER     END-IF.                                               HGO0021
 12436*
 12437******************************************************************
 12438*6150-LIMPIA-DIR-ESTANDARIZADA                                         *
 12439*    APLICA LAS REGLAS DE LIMPIEZA DEFINIDAS POR MERCADEO A LA
 12440*    DIRECCION EXTANDARIZADA. TOMA COMO ENTRADA Y SALIDA LA
 12441*    VARIABLE
 12442*    DIRECCION-ESTANDARIZADA-BDLDIR
 12443*    USA EL VECTOR DE PARTICULAS Y EL CONTADOR DE PARTICULAS
 12444*     NUEVA-DIRECCION-BDLDIR, CON-PART-ESTANDARIZADA-BDLDIR
 12445******************************************************************
 12446 6150-LIMPIA-DIR-ESTANDARIZADA.                                   FARF037
 12447*    Identificar y corregir aquellas direcciones donde se         FARF037
 12448*    presentan dos partculas seguidas repetidas.                 FARF037
 12449*                                                                 FARF037
 12450     IF CON-PART-ESTANDARIZADA-BDLDIR >= 3                        FARF037
 12451        PERFORM 6151-QUITA-DOS-REPETIDAS                          FARF037
 12452     END-IF.                                                      FARF037
 12453*
 12454*    identificar y corregir aquellas direcciones donde se
 12455*    encuentre duplicada la misma informacin dentro del mismo
 12456*    campo
 12457*                                                                 FARF037
 12458     PERFORM 6152-QUITA-DUPLICADA.                                FARF037
 12459*                                                                 FARF037
 12460*    Identificar y corregir aquellas direcciones donde se presentaFARF037
 12461*    al interior adicionalmente un telfono.                      FARF037
 12462     PERFORM 6153-QUITA-PART-TEL.                                 FARF037
 12463*                                                                 FARF037
 12464*    se limpiaran los ceros de mas en las particulas              FARF037
 12465     PERFORM 6154-QUITA-CEROS-PAR.                                FARF037
 12466*                                                                 FARF037
 12467******************************************************************
 12468*6151-QUITA-DOS-REPETIDAS.
 12469*    TOMA DE ENTRADA Y DE SALIDA LA VARIABLE
 12470*    DIRECCION-ESTANDARIZADA-BDLDIR, QUITA DOS PARTICULAS SEGUIDAS
 12471*    REPETIDAS EJEMPLO SI LA DIRECCION ES :
 12472*    KR 11 B BIS 118 32 CA 1 SANTA BARBARA SANTA BARBARA OCC
 12473*    QUEDA :
 12474*    KR 11 B BIS 118 32 CA 1 SANTA BARBARA OCC
 12475******************************************************************
 12476     6151-QUITA-DOS-REPETIDAS.                                    FARF037
 12477*    salvamos el contador de particulas y asignamos los topes del FARF037
 12478*    ciclo                                                        FARF037
 12479     MOVE CON-PART-ESTANDARIZADA-BDLDIR TO II-BDLDIR.             FARF037
 12480     COMPUTE N-BDLDIR = CON-PART-ESTANDARIZADA-BDLDIR - 2.        FARF037
 12481     MOVE 1 TO M-BDLDIR.                                          FARF037
 12482     PERFORM UNTIL M-BDLDIR > N-BDLDIR                            FARF037
 12483*       armamos las particulas a comparar                         FARF037
 12484        STRING NVA-DIR-BDLDIR(M-BDLDIR) DELIMITED BY SPACES       FARF037
 12485               " " DELIMITED BY SIZE                              FARF037
 12486               NVA-DIR-BDLDIR(M-BDLDIR + 1) DELIMITED BY SIZE     FARF037
 12487           INTO TIP-NUEVA-DIRECCION-BDLDIR                        FARF037
 12488*                                                                 FARF037
 12489        STRING NVA-DIR-BDLDIR(M-BDLDIR + 2) DELIMITED BY SPACES   FARF037
 12490               " " DELIMITED BY SIZE                              FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 216
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12491               NVA-DIR-BDLDIR(M-BDLDIR + 3) DELIMITED BY SIZE     FARF037
 12492          INTO PART-ESTANDARIZADA-BDLDIR                          FARF037
 12493*                                                                 FARF037
 12494        IF TIP-NUEVA-DIRECCION-BDLDIR =                           FARF037
 12495           PART-ESTANDARIZADA-BDLDIR                              FARF037
 12496*          borramos la particula corriendo el vector              FARF037
 12497           COMPUTE JJ-STA-BDLDIR = M-BDLDIR + 2                   FARF037
 12498           PERFORM UNTIL JJ-STA-BDLDIR > N-BDLDIR                 FARF037
 12499              MOVE NVA-DIR-BDLDIR(JJ-STA-BDLDIR + 2) TO           FARF037
 12500                   NVA-DIR-BDLDIR(JJ-STA-BDLDIR)                  FARF037
 12501              MOVE NVA-DIR-BDLDIR(JJ-STA-BDLDIR + 3) TO           FARF037
 12502                   NVA-DIR-BDLDIR(JJ-STA-BDLDIR + 1)              FARF037
 12503              ADD 2 TO JJ-STA-BDLDIR                              FARF037
 12504           END-PERFORM                                            FARF037
 12505*          actualizamos los contadores                            FARF037
 12506           COMPUTE CON-PART-ESTANDARIZADA-BDLDIR =                FARF037
 12507                   CON-PART-ESTANDARIZADA-BDLDIR - 2              FARF037
 12508           COMPUTE N-BDLDIR =                                     FARF037
 12509                  CON-PART-ESTANDARIZADA-BDLDIR - 2               FARF037
 12510        ELSE                                                      FARF037
 12511          ADD 1 TO M-BDLDIR                                       FARF037
 12512        END-IF                                                    FARF037
 12513     END-PERFORM.                                                 FARF037
 12514*    si cambio el contador actualizamos la direccion              FARF037
 12515     IF II-BDLDIR <> CON-PART-ESTANDARIZADA-BDLDIR                FARF037
 12516        MOVE SPACE TO TIP-NUEVA-DIRECCION-BDLDIR                  FARF037
 12517        MOVE 1 TO JJ-BDLDIR *> Recorre la direccion final         FARF037
 12518        MOVE 1 TO M-BDLDIR  *> Recorre vector de particulas       FARF037
 12519        PERFORM UNTIL M-BDLDIR > CON-PART-ESTANDARIZADA-BDLDIR    FARF037
 12520           MOVE 1 TO N-BDLDIR   *> Recorre elemento particulas    FARF037
 12521           PERFORM UNTIL N-BDLDIR > 60 OR JJ-BDLDIR > 60          FARF041
 12522              IF NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1) <> SPACES   FARF037
 12523                 MOVE NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1) TO     FARF037
 12524                      TIP-NVA-DIR-BDLDIR(JJ-BDLDIR)               FARF037
 12525                 ADD 1 TO N-BDLDIR                                FARF037
 12526                 ADD 1 TO JJ-BDLDIR                               FARF037
 12527              ELSE                                                FARF037
 12528                 MOVE 61 TO N-BDLDIR                              FARF037
 12529                 ADD 1 TO JJ-BDLDIR                               FARF037
 12530              END-IF                                              FARF037
 12531           END-PERFORM                                            FARF037
 12532*                                                                 FARF037
 12533           ADD 1 TO M-BDLDIR                                      FARF037
 12534        END-PERFORM                                               FARF037
 12535*                                                                 FARF037
 12536        MOVE TIP-NUEVA-DIRECCION-BDLDIR TO                        FARF037
 12537             DIRECCION-ESTANDARIZADA-BDLDIR                       FARF037
 12538     END-IF.                                                      FARF037
 12539*
 12540******************************************************************
 12541*6152-QUITA-DUPLICADA.
 12542*    TOMA DE ENTRADA Y DE SALIDA LA VARIABLE
 12543*    DIRECCION-ESTANDARIZADA-BDLDIR, VERIFICA SI LA INFORMACION
 12544*    ESTA REPETIDA DOS VECES Y DEJA SOLO UNO.EJEMPLO
 12545*    KR 25 29 B 49 KR 25 29 B 49
 12546*    QUEDA :
 12547*    KR 25 29 B 49
 12548******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 217
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12549 6152-QUITA-DUPLICADA.                                            FARF037
 12550*    se verifica si el numero de particulas es par                FARF037
 12551     DIVIDE CON-PART-ESTANDARIZADA-BDLDIR BY 2                    FARF037
 12552            GIVING II-STA-BDLDIR REMAINDER JJ-STA-BDLDIR          FARF037
 12553     IF JJ-STA-BDLDIR = 0                                         FARF037
 12554*       verificamos si las dos particulas son iguales             FARF037
 12555        ADD 1 TO II-STA-BDLDIR  *> encontramos mitad del vector   FARF037
 12556        IF NVA-DIR-BDLDIR(1) = NVA-DIR-BDLDIR(II-STA-BDLDIR)      FARF037
 12557*          unimos las particulas y comparamos                     FARF037
 12558           MOVE SPACES TO TIP-NUEVA-DIRECCION-BDLDIR              FARF037
 12559           MOVE SPACES TO PART-A-ESTANDARIZAR-BDLDIR              FARF037
 12560           MOVE 1 TO M-BDLDIR  *> Recorre vector de particulas    FARF037
 12561           MOVE 1 TO JJ-BDLDIR *> Recorre la direccion final      FARF037
 12562           PERFORM UNTIL M-BDLDIR >= II-STA-BDLDIR                FARF037
 12563              MOVE 1 TO N-BDLDIR   *> Recorre elemento particulas FARF037
 12564              PERFORM UNTIL N-BDLDIR > 60                         FARF037
 12565                 IF NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1) <>       FARF037
 12566                    SPACES                                        FARF037
 12567                    MOVE NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1) TO  FARF037
 12568                         TIP-NVA-DIR-BDLDIR(JJ-BDLDIR)            FARF037
 12569                    ADD 1 TO N-BDLDIR                             FARF037
 12570                    ADD 1 TO JJ-BDLDIR                            FARF037
 12571                 ELSE                                             FARF037
 12572                    MOVE 61 TO N-BDLDIR                           FARF037
 12573                    ADD 1 TO JJ-BDLDIR                            FARF037
 12574                 END-IF                                           FARF037
 12575              END-PERFORM                                         FARF037
 12576*                                                                 FARF037
 12577              ADD 1 TO M-BDLDIR                                   FARF037
 12578           END-PERFORM                                            FARF037
 12579*                                                                 FARF037
 12580           MOVE II-STA-BDLDIR TO  M-BDLDIR                        FARF037
 12581           MOVE 1 TO JJ-BDLDIR                                    FARF037
 12582           PERFORM UNTIL M-BDLDIR > CON-PART-ESTANDARIZADA-BDLDIR FARF037
 12583              MOVE 1 TO N-BDLDIR                                  FARF037
 12584              PERFORM UNTIL N-BDLDIR > 60                         FARF037
 12585                 IF NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1) <>       FARF037
 12586                    SPACES                                        FARF037
 12587                    MOVE NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1) TO  FARF037
 12588                         PART-A-ESTAN-BDLDIR(JJ-BDLDIR)           FARF037
 12589                    ADD 1 TO N-BDLDIR                             FARF037
 12590                    ADD 1 TO JJ-BDLDIR                            FARF037
 12591                 ELSE                                             FARF037
 12592                    MOVE 61 TO N-BDLDIR                           FARF037
 12593                    ADD 1 TO JJ-BDLDIR                            FARF037
 12594                 END-IF                                           FARF037
 12595              END-PERFORM                                         FARF037
 12596*                                                                 FARF037
 12597              ADD 1 TO M-BDLDIR                                   FARF037
 12598           END-PERFORM                                            FARF037
 12599*                                                                 FARF037
 12600           IF TIP-NUEVA-DIRECCION-BDLDIR =                        FARF037
 12601              PART-A-ESTANDARIZAR-BDLDIR                          FARF037
 12602              MOVE TIP-NUEVA-DIRECCION-BDLDIR TO                  FARF037
 12603                   DIRECCION-ESTANDARIZADA-BDLDIR                 FARF037
 12604              COMPUTE CON-PART-ESTANDARIZADA-BDLDIR =             FARF037
 12605                      CON-PART-ESTANDARIZADA-BDLDIR / 2           FARF037
 12606           END-IF                                                 FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 218
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12607        END-IF                                                    FARF037
 12608     END-IF.                                                      FARF037
 12609*
 12610******************************************************************
 12611*6153-QUITA-PART-TEL.
 12612*    TOMA DE ENTRADA Y DE SALIDA LA VARIABLE
 12613*    DIRECCION-ESTANDARIZADA-BDLDIR, VERIFICA SI LA INFORMACION
 12614*    TIENE LA PARTICULA TEL Y QUITA DE HAY HASTA EL FINAL EJEMPLO
 12615*    KR 99 68 A 10 TEL 4360614 ALAMOS SUR
 12616*    QUEDA :
 12617*    KR 99 68 A 10
 12618******************************************************************
 12619 6153-QUITA-PART-TEL.                                             FARF037
 12620*    buscamos is tiene la particula TEL                           FARF037
 12621     MOVE 1 TO M-BDLDIR  *> Recorre vector de particulas          FARF037
 12622     MOVE 0 TO II-STA-BDLDIR *> Indica poscicion si existe el datoFARF037
 12623     PERFORM UNTIL M-BDLDIR > CON-PART-ESTANDARIZADA-BDLDIR       FARF037
 12624        IF NVA-DIR-BDLDIR(M-BDLDIR) = "TEL"                       FARF037
 12625           ADD M-BDLDIR TO II-STA-BDLDIR                          FARF037
 12626           MOVE 61 TO M-BDLDIR                                    FARF037
 12627        END-IF                                                    FARF037
 12628*                                                                 FARF037
 12629        ADD 1 TO M-BDLDIR                                         FARF037
 12630     END-PERFORM                                                  FARF037
 12631*                                                                 FARF037
 12632     IF II-STA-BDLDIR > 0                                         FARF037
 12633*       unimos la particula y remplazamos                         FARF037
 12634        MOVE SPACES TO TIP-NUEVA-DIRECCION-BDLDIR                 FARF037
 12635        MOVE 1 TO M-BDLDIR                                        FARF037
 12636        MOVE 1 TO JJ-BDLDIR *> Recorre la direccion final         FARF037
 12637        PERFORM UNTIL M-BDLDIR >= II-STA-BDLDIR                   FARF037
 12638           MOVE 1 TO N-BDLDIR   *> Recorre elemento particulas    FARF037
 12639           PERFORM UNTIL N-BDLDIR > 60                            FARF037
 12640              IF NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1) <>          FARF037
 12641                 SPACES                                           FARF037
 12642                 MOVE NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1) TO     FARF037
 12643                      TIP-NVA-DIR-BDLDIR(JJ-BDLDIR)               FARF037
 12644                 ADD 1 TO N-BDLDIR                                FARF037
 12645                 ADD 1 TO JJ-BDLDIR                               FARF037
 12646              ELSE                                                FARF037
 12647                 MOVE 61 TO N-BDLDIR                              FARF037
 12648                 ADD 1 TO JJ-BDLDIR                               FARF037
 12649              END-IF                                              FARF037
 12650           END-PERFORM                                            FARF037
 12651*                                                                 FARF037
 12652           ADD 1 TO M-BDLDIR                                      FARF037
 12653        END-PERFORM                                               FARF037
 12654*                                                                 FARF037
 12655        MOVE TIP-NUEVA-DIRECCION-BDLDIR TO                        FARF037
 12656             DIRECCION-ESTANDARIZADA-BDLDIR                       FARF037
 12657        COMPUTE CON-PART-ESTANDARIZADA-BDLDIR =                   FARF037
 12658                II-STA-BDLDIR - 1                                 FARF037
 12659     END-IF.                                                      FARF037
 12660*
 12661*
 12662******************************************************************
 12663*6154-QUITA-CEROS-PAR.
 12664*    Si la partcula comienza con cero y contiene solo ceros  se
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 219
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12665*    debe borrar EJ CASA 0000 (queda =>) CASA quita tambien ceros
 12666*    al inicio  y mas de dos ceros conseutivos al final ejemplo
 12667*    000CASA 2000 (queda =>) CASA 20
 12668
 12669*    N-BDLDIR recorre el vector de direccion estandar
 12670*
 12671******************************************************************
 12672 6154-QUITA-CEROS-PAR.                                            FARF037
 12673*    Quitamos primero los ceros finales que sean mas de 2, usamos FARF037
 12674*    M-BDLDIR indica si el caracter anterior es un blanco 0-no    FARF037
 12675*    1-si,  usamos. N-BDLDIR recorre el vector de direccion       FARF037
 12676*    estandar, usamos JJ-BDLDIR para recorrer el vector           FARF037
 12677*    resultante, usamos TIP-NUEVA-DIRECCION-BDLDIR para dejara la FARF037
 12678*    direccion corregida, usamos II-BDLDIR para contar los ceros  FARF037
 12679*    consecutivos.                                                FARF037
 12680*                                                                 FARF037
 12681     MOVE 1 TO M-BDLDIR.                                          FARF037
 12682     MOVE 60 TO N-BDLDIR.                                         FARF037
 12683     MOVE 60 TO JJ-BDLDIR                                         FARF037
 12684     MOVE 0 TO II-BDLDIR.                                         FARF037
 12685     MOVE SPACES TO TIP-NUEVA-DIRECCION-BDLDIR.                   FARF037
 12686                                                                  FARF037
 12687     PERFORM UNTIL N-BDLDIR < 1                                   FARF037
 12688*       Si es cero y van menos de dos los movemos                 FARF037
 12689        IF DIRECCION-ESTANDARIZADA-BDLDIR(N-BDLDIR:1) = "0"       FARF037
 12690           IF II-BDLDIR < 2                                       FARF037
 12691              MOVE DIRECCION-ESTANDARIZADA-BDLDIR(N-BDLDIR:1) TO  FARF037
 12692                   TIP-NVA-DIR-BDLDIR(JJ-BDLDIR)                  FARF037
 12693              SUBTRACT 1 FROM JJ-BDLDIR                           FARF037
 12694           END-IF                                                 FARF037
 12695*                                                                 FARF037
 12696*          si no es un cero intermedio lo contamos                FARF037
 12697           IF M-BDLDIR = 1                                        FARF037
 12698              ADD 1 TO II-BDLDIR                                  FARF037
 12699           END-IF                                                 FARF037
 12700        ELSE                                                      FARF037
 12701           MOVE DIRECCION-ESTANDARIZADA-BDLDIR(N-BDLDIR:1) TO     FARF037
 12702                 TIP-NVA-DIR-BDLDIR(JJ-BDLDIR)                    FARF037
 12703           SUBTRACT 1 FROM JJ-BDLDIR                              FARF037
 12704           MOVE 0 TO II-BDLDIR                                    FARF037
 12705*          si es blanco reiniciamos las banderas                  FARF037
 12706           IF DIRECCION-ESTANDARIZADA-BDLDIR(N-BDLDIR:1) = " "    FARF037
 12707              MOVE 1 TO M-BDLDIR                                  FARF037
 12708           ELSE                                                   FARF037
 12709              MOVE 0 TO  M-BDLDIR                                 FARF037
 12710           END-IF                                                 FARF037
 12711        END-IF                                                    FARF037
 12712*                                                                 FARF037
 12713        SUBTRACT 1 FROM N-BDLDIR                                  FARF037
 12714     END-PERFORM.                                                 FARF037
 12715*                                                                 FARF037
 12716*    Quitamos los espacios y ceros iniciales usamos               FARF037
 12717*    DIRECCION-60-BDLDIR para dejar la direccion corregida        FARF037
 12718*                                                                 FARF037
 12719     MOVE 1 TO M-BDLDIR.                                          FARF037
 12720     MOVE 1 TO N-BDLDIR.                                          FARF037
 12721     MOVE 1 TO JJ-BDLDIR.                                         FARF037
 12722     MOVE SPACES TO DIRECCION-60-BDLDIR.                          FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 220
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12723     PERFORM UNTIL N-BDLDIR > 60                                  FARF037
 12724*       Si no es un cero inicial lo movemos                       FARF037
 12725        IF TIP-NVA-DIR-BDLDIR(N-BDLDIR) = "0"                     FARF037
 12726           IF M-BDLDIR = 0                                        FARF037
 12727              MOVE TIP-NVA-DIR-BDLDIR(N-BDLDIR) TO                FARF037
 12728                   DIRECCION-60-BDLDIR(JJ-BDLDIR:1)               FARF037
 12729              ADD 1 TO JJ-BDLDIR                                  FARF037
 12730           END-IF                                                 FARF037
 12731        ELSE                                                      FARF037
 12732*                                                                 FARF037
 12733*          Si no es blanco repetido se mueve                      FARF037
 12734           IF TIP-NVA-DIR-BDLDIR(N-BDLDIR) = " "                  FARF037
 12735              IF M-BDLDIR = 0                                     FARF037
 12736                 MOVE TIP-NVA-DIR-BDLDIR(N-BDLDIR) TO             FARF037
 12737                      DIRECCION-60-BDLDIR(JJ-BDLDIR:1)            FARF037
 12738                 ADD 1 TO JJ-BDLDIR                               FARF037
 12739                 MOVE 1 TO M-BDLDIR                               FARF037
 12740              END-IF                                              FARF037
 12741           ELSE                                                   FARF037
 12742              MOVE TIP-NVA-DIR-BDLDIR(N-BDLDIR) TO                FARF037
 12743                   DIRECCION-60-BDLDIR(JJ-BDLDIR:1)               FARF037
 12744              ADD 1 TO JJ-BDLDIR                                  FARF037
 12745              MOVE 0 TO M-BDLDIR                                  FARF037
 12746           END-IF                                                 FARF037
 12747        END-IF                                                    FARF037
 12748*                                                                 FARF037
 12749        ADD 1 TO N-BDLDIR                                         FARF037
 12750     END-PERFORM.                                                 FARF037
 12751*                                                                 FARF037
 12752*    Si el resultado final no es igual al inicial se calculan las FARF037
 12753*    particulas nuevamente. usamos II-BDLDIR para Recorrer la     FARF037
 12754*    direccion inicial, usamos M-BDLDIR para Recorrer el vector deFARF037
 12755*    particulas, usamos N-BDLDIR para Recorrer el elemento vector FARF037
 12756*    particulas                                                   FARF037
 12757*                                                                 FARF037
 12758     IF DIRECCION-ESTANDARIZADA-BDLDIR NOT = DIRECCION-60-BDLDIR  FARF037
 12759        MOVE DIRECCION-60-BDLDIR TO DIRECCION-ESTANDARIZADA-BDLDIRFARF037
 12760        MOVE 1 TO II-BDLDIR                                       FARF037
 12761        MOVE 1 TO M-BDLDIR                                        FARF037
 12762        MOVE 1 TO N-BDLDIR                                        FARF037
 12763        MOVE 0 TO CON-PART-ESTANDARIZADA-BDLDIR                   FARF037
 12764        INITIALIZE NUEVA-DIRECCION-BDLDIR                         FARF037
 12765        PERFORM UNTIL II-BDLDIR > 60                              FARF037
 12766*          si no es blanco movemos al vector de particulas        FARF037
 12767           IF DIRECCION-ESTANDARIZADA-BDLDIR(II-BDLDIR:1) <>      FARF037
 12768               SPACES                                             FARF037
 12769              MOVE DIRECCION-ESTANDARIZADA-BDLDIR(II-BDLDIR:1) TO FARF037
 12770                   NVA-DIR-BDLDIR(M-BDLDIR)(N-BDLDIR:1)           FARF037
 12771              ADD 1 TO N-BDLDIR                                   FARF037
 12772           ELSE                                                   FARF037
 12773*             verificamos si la particula debe cambiar            FARF037
 12774              IF NVA-DIR-BDLDIR(M-BDLDIR) <> SPACES               FARF037
 12775                 ADD 1 TO M-BDLDIR                                FARF037
 12776                 MOVE 1 TO N-BDLDIR                               FARF037
 12777                 ADD 1 TO CON-PART-ESTANDARIZADA-BDLDIR           FARF037
 12778              END-IF                                              FARF037
 12779           END-IF                                                 FARF037
 12780*                                                                 FARF037
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 221
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12781           ADD 1 TO II-BDLDIR                                     FARF037
 12782        END-PERFORM                                               FARF037
 12783*                                                                 FARF037
 12784*       si la ultima particula no es vacia la cuento              FARF037
 12785        IF NVA-DIR-BDLDIR(M-BDLDIR) <> SPACES                     FARF037
 12786           ADD 1 TO CON-PART-ESTANDARIZADA-BDLDIR                 FARF037
 12787        END-IF                                                    FARF037
 12788*                                                                 FARF037
 12789*       movemos la primera y segunda particula                    FARF037
 12790        MOVE NVA-DIR-BDLDIR(1) TO PRIPART-ESTANDARIZADA-BDLDIR    FARF037
 12791        MOVE NVA-DIR-BDLDIR(2) TO SEGPART-ESTANDARIZADA-BDLDIR    FARF037
 12792     END-IF.                                                      FARF037
 12793*
 12794 2000-U-VALIDAR-ACCDIR.                                           RMB0003
 12795******************************************************************
 12796* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS
 12797* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.
 12798* ENTRADAS
 12799*         ABIERTO EL ICBSUS
 12800*         ABIERTO EL BDLCI
 12801*         ABIERTO EL ICMCRE
 12802*         ABIERTO EL ICMCHK
 12803*         LLAVE-DIRECC     LLAVE NORMAL DEL ARCHIVO DE DIRECCIONES
 12804*         PRIVILEGIO-INPUT VALOR DE PRIVILEGIO-BDLCI DEL CONSULTANTE
 12805*         NIT-CONSULTANTE-INPUT
 12806* SALIDAS
 12807*         VALIDACION-DIR-OUT 0: NO TOMAR EL REGISTRO,1 SI TOMARLO
 12808*******************************************************************
 12809     MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR.                         RMB0010
 12810     MOVE COD-SUS-DIRECC TO COD-SUSCRIP-ABD02.                    RMB0003
 12811     READ SUSCRIPTOR IGNORE LOCK                                  RMB0003
 12812        INVALID KEY                                               RMB0003
 12813           MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR                    RMB0010
 12814        NOT INVALID KEY                                           RMB0003
 12815           MOVE NIT-SUSCRIP-S-ABD02 TO NIT-ID-BDLCLI              RMB0007
 12816           READ BDLCLI IGNORE LOCK                                RMB0007
 12817                INVALID KEY MOVE 0 TO INDICADOR-BDLCLI            RMB0007
 12818                            MOVE " " TO VALIDAR-DB-BDLCLI         RMB0007
 12819                            MOVE " " TO IND-BLOQUEO-INF-BDLCLI    RMB0029
 12820           END-READ                                               RMB0007
 12821           IF PRIVILEGIO-INPUT-BDLDIR = 2                         RMB0010
 12822              MOVE 1 TO INDICADOR-BDLCLI                          RMB0007
 12823           END-IF                                                 RMB0007
 12824           IF INDICADOR-BDLCLI = 1                                RMB0007
 12825              AND IND-BLOQUEO-INF-BDLCLI <> "B"                   RMB0029
 12826              IF VALIDAR-DB-BDLCLI = "N"                          RMB0007
 12827                 PERFORM 2590-EXAMINAR-ESTABAN-VACIOS             FARF035
 12828                 MOVE 1 TO VALIDACION-DIR-OUT-BDLDIR              RMB0010
 12829              ELSE                                                RMB0007
 12830                 MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR              RMB0010
 12831                 PERFORM 2100-U-VALIDAR-MAESTROS                  RMB0007
 12832              END-IF                                              RMB0007
 12833           END-IF                                                 RMB0007
 12834     END-READ.                                                    RMB0003
 12835*
 12836     IF VALIDACION-DIR-OUT-BDLDIR = 1                             FARF035
 12837        PERFORM 2100-VALIDAR-CAMPOS-BDLDIR                        FARF035
 12838     END-IF.                                                      FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 222
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12839*
 12840 2100-VALIDAR-CAMPOS-BDLDIR.                                      FARF035
 12841     IF DIRRES-ABD02 = "N"                                        FARF035
 12842        MOVE SPACES TO DIRRES-DIRECC                              FARF035
 12843     END-IF.                                                      FARF035
 12844*                                                                 FARF035
 12845     IF TELRES-ABD02 = "N"                                        FARF035
 12846        MOVE ZEROS  TO TELRES-DIRECC                              FARF035
 12847     END-IF.                                                      FARF035
 12848*                                                                 FARF035
 12849     IF DIRLAB-ABD02 = "N"                                        FARF035
 12850        MOVE SPACES TO DIRLAB-DIRECC                              FARF035
 12851     END-IF.                                                      FARF035
 12852*                                                                 FARF035
 12853     IF TELLAB-ABD02 = "N"                                        FARF035
 12854        MOVE ZEROS  TO TELLAB-DIRECC                              FARF035
 12855     END-IF.                                                      FARF035
 12856*                                                                 FARF035
 12857     IF DIRCOR-ABD02 = "N"                                        FARF035
 12858        MOVE SPACES TO DIRLAB-DIRECC                              FARF035
 12859     END-IF.                                                      FARF035
 12860*                                                                 FARF035
 12861     IF TELCEL-ABD02 = "N"                                        FARF035
 12862        MOVE ZEROS  TO TELCEL-DIRECC                              FARF035
 12863     END-IF.                                                      FARF035
 12864*                                                                 FARF035
 12865     IF E-MAIL-ABD02 = "N"                                        FARF035
 12866        MOVE SPACES TO E-MAIL-DIRECC                              FARF035
 12867     END-IF.                                                      FARF035
 12868*
 12869 2100-U-VALIDAR-MAESTROS.                                         RMB0003
 12870******************************************************************
 12871*4110-VALIDAR-MAESTROS.
 12872*    SE VALIDA CONTRA LOS MAESTROS DE CARTERA Y CUENTAS CORRIENTE*
 12873*    SI LA CUENTA EXISTE EN ELLOS                                *
 12874******************************************************************
 12875*    MOVE LLAVE-DIRECC TO LLAVE-MAES-CREDIT LLAVE-MAES-CHECK.     FAC0009
 12876     MOVE TIPO-ID-DIRECC TO TIPO-ID-ABD07 TIPO-ID-ABD06           FAC0009
 12877     MOVE NUM-ID-DIRECC  TO NUM-ID-ABD07  NUM-ID-ABD06            FAC0009
 12878     MOVE COD-SUS-DIRECC TO COD-SUS-ABD07 COD-SUS-ABD06           FAC0009
 12879     MOVE COD-CTA-DIRECC TO COD-CTA-ABD07 COD-CTA-ABD06           FAC0009
 12880     MOVE NUM-CTA-DIRECC TO NUM-CTA-ABD07 NUM-CTA-ABD06           FAC0009
 12881     IF ESTADO-ABD02 = 1                                          RMB0003
 12882        IF COD-CTA-DIRECC = 1                                     RMB0003
 12883           READ MAESTRO-CHECK WITH IGNORE LOCK   INVALID KEY      DLM0013
 12884                MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR               RMB0010
 12885                NOT INVALID KEY                                   RMB0003
 12886                    $IF HACERMATCH = "SI"                         RMB0013
 12887                    PERFORM 8000-U-VER-CTAABD06-BDAMATCH          RMB0013
 12888                    $END                                          RMB0013
 12889*                   Se hace el llamado a la rutina antes de
 12890*                   independientemente del valor de
 12891*                   VALIDACION-DIR-OUT ya que algunos programas no
 12892*                   usan el switche
 12893                    PERFORM 2590-VER-ESTADO-CTA                   ABB0034
 12894                    IF IND-BLOQUEO-ABD06 = 0                      RMB0003
 12895                       MOVE 1 TO VALIDACION-DIR-OUT-BDLDIR        RMB0010
 12896                    END-IF                                        RMB0003
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 223
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12897           END-READ                                               RMB0003
 12898        ELSE                                                      RMB0003
 12899           READ MAESTRO-CREDIT  WITH IGNORE LOCK  INVALID KEY     DLM0013
 12900                MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR               RMB0010
 12901                NOT INVALID KEY                                   RMB0003
 12902                    $IF HACERMATCH = "SI"                         RMB0013
 12903                    PERFORM 8000-U-VER-CTAABD07-BDAMATCH          RMB0013
 12904                    $END                                          RMB0013
 12905                    PERFORM 2590-VER-ESTADO-CTA                   ABB0034
 12906                    IF IND-BLOQUEO-ABD07 = 0 AND                  RMB0003
 12907                       GARANTE-ABD07 = 0                          FARF040
 12908                       MOVE 1 TO VALIDACION-DIR-OUT-BDLDIR        RMB0010
 12909                    END-IF                                        RMB0003
 12910           END-READ                                               RMB0003
 12911        END-IF                                                    RMB0003
 12912     END-IF.                                                      RMB0003
 12913*
 12914******************************************************************
 12915* 2590-VER-ESTADO-CTA                                            *
 12916*    SI LA CUENTA PADRE ESTA CERRADA SE CAMBIAN LAS FECHAS A LA  *
 12917*    FECHA DE CIERRE SI ESTA ES MENOR A LA REPORTADA EN LA       *
 12918*    DIRECCION.                                                  *
 12919******************************************************************
 12920*
 12921 2590-VER-ESTADO-CTA.                                             ABB0034
 12922     MOVE 0 TO CTA-ACTIVA.                                        ABB0034
 12923     IF COD-CTA-DIRECC = 1                                        ABB0034
 12924        IF NOV-REPORT-ABD06 = 01 OR 06 OR 07                      ABB0034
 12925           MOVE 1 TO CTA-ACTIVA                                   ABB0034
 12926        ELSE                                                      ABB0034
 12927           MOVE FEC-NOVEDAD-ABD06 TO FEC-MMAA-BDLDI2              ABB0034
 12928        END-IF                                                    ABB0034
 12929     ELSE                                                         ABB0034
 12930        IF NOV-REPORT-ABD07 = 01 OR 45 OR 47 OR                   ABB0034
 12931           (NOV-REPORT-ABD07 >= 13 AND NOV-REPORT-ABD07 <= 41)    ABB0034
 12932           MOVE 1 TO CTA-ACTIVA                                   ABB0034
 12933        ELSE                                                      ABB0034
 12934           MOVE FEC-NOVEDAD-ABD07 TO FEC-MMAA-BDLDI2              ABB0034
 12935        END-IF                                                    ABB0034
 12936     END-IF.                                                      ABB0034
 12937*
 12938     IF CTA-ACTIVA = 0                                            ABB0034
 12939*       SE CONVIERTE AL MILENIO PARA LA COMPARACION
 12940        MOVE FEC-MMAA-BDLDI2(1:2) TO FEC-AAAAMM-BDLDI2(5:2)       ABB0034
 12941        MOVE FEC-MMAA-BDLDI2(3:2) TO FEC-AAAAMM-BDLDI2(3:2)       ABB0034
 12942        IF FEC-MMAA-BDLDI2(3:2) < "50"                            ABB0034
 12943           MOVE "20"   TO FEC-AAAAMM-BDLDI2(1:2)                  ABB0034
 12944        ELSE                                                      ABB0034
 12945           MOVE "19"   TO FEC-AAAAMM-BDLDI2(1:2)                  ABB0034
 12946        END-IF                                                    ABB0034
 12947*
 12948        IF FEC-AAAAMM-BDLDI2 < FECRES-DIRECC                      ABB0034
 12949           MOVE FEC-AAAAMM-BDLDI2 TO FECRES-DIRECC                ABB0034
 12950        END-IF                                                    ABB0034
 12951*
 12952        IF FEC-AAAAMM-BDLDI2 < FECLAB-DIRECC                      ABB0034
 12953           MOVE FEC-AAAAMM-BDLDI2 TO FECLAB-DIRECC                ABB0034
 12954        END-IF                                                    ABB0034
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 224
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 12955*
 12956        IF FEC-AAAAMM-BDLDI2 < FECCOR-DIRECC                      ABB0034
 12957           MOVE FEC-AAAAMM-BDLDI2 TO FECCOR-DIRECC                ABB0034
 12958        END-IF                                                    ABB0034
 12959*
 12960        IF FEC-AAAAMM-BDLDI2 < FECCEL-DIRECC                      ABB0034
 12961           MOVE FEC-AAAAMM-BDLDI2 TO FECCEL-DIRECC                ABB0034
 12962        END-IF                                                    ABB0034
 12963*
 12964        IF FEC-AAAAMM-BDLDI2 < FECTRES-DIRECC                     ABB0034
 12965           MOVE FEC-AAAAMM-BDLDI2 TO FECTRES-DIRECC               ABB0034
 12966        END-IF                                                    ABB0034
 12967*
 12968        IF FEC-AAAAMM-BDLDI2 < FECTLAB-DIRECC                     ABB0034
 12969           MOVE FEC-AAAAMM-BDLDI2 TO FECTLAB-DIRECC               ABB0034
 12970        END-IF                                                    ABB0034
 12971*
 12972        IF FEC-AAAAMM-BDLDI2 < FECMAIL-DIRECC                     ABB0034
 12973           MOVE FEC-AAAAMM-BDLDI2 TO FECMAIL-DIRECC               ABB0034
 12974        END-IF                                                    ABB0034
 12975     ELSE                                                         FARF035
 12976        PERFORM 2590-EXAMINAR-ESTABAN-VACIOS                      FARF035
 12977     END-IF.                                                      ABB0034
 12978*
 12979 2590-EXAMINAR-ESTABAN-VACIOS.                                    FARF035
 12980     IF FLAG-DIRRES-DIRECC =  "V"                                 FARF035
 12981        AND FECDRES-DIRECC > 0                                    FARF035
 12982        MOVE FECAPE-DIRECC TO FECDRES-DIRECC                      FARF035
 12983     END-IF.                                                      FARF035
 12984*                                                                 FARF035
 12985     IF FLAG-TELRES-DIRECC =  "V"                                 FARF035
 12986        AND FECTRES-DIRECC > 0                                    FARF035
 12987        MOVE FECAPE-DIRECC TO FECTRES-DIRECC                      FARF035
 12988     END-IF.                                                      FARF035
 12989*                                                                 FARF035
 12990     IF FLAG-DIRLAB-DIRECC =  "V"                                 FARF035
 12991        AND FECDLAB-DIRECC > 0                                    FARF035
 12992        MOVE FECAPE-DIRECC TO FECDLAB-DIRECC                      FARF035
 12993     END-IF.                                                      FARF035
 12994*                                                                 FARF035
 12995     IF FLAG-TELLAB-DIRECC =  "V"                                 FARF035
 12996        AND FECTLAB-DIRECC > 0                                    FARF035
 12997        MOVE FECAPE-DIRECC TO FECTLAB-DIRECC                      FARF035
 12998     END-IF.                                                      FARF035
 12999*                                                                 FARF035
 13000     IF FLAG-DIRCOR-DIRECC =  "V"                                 FARF035
 13001        AND FECDCOR-DIRECC > 0                                    FARF035
 13002        MOVE FECAPE-DIRECC TO FECDCOR-DIRECC                      FARF035
 13003     END-IF.                                                      FARF035
 13004*                                                                 FARF035
 13005     IF FLAG-CELULAR-DIRECC =  "V"                                FARF035
 13006        AND FECCEL-DIRECC > 0                                     FARF035
 13007        MOVE FECAPE-DIRECC TO FECCEL-DIRECC                       FARF035
 13008     END-IF.                                                      FARF035
 13009*                                                                 FARF035
 13010     IF FLAG-EMAIL-DIRECC =  "V"                                  FARF035
 13011        AND FECMAIL-DIRECC > 0                                    FARF035
 13012        MOVE FECAPE-DIRECC TO FECMAIL-DIRECC                      FARF035
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 225
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 13013     END-IF.                                                      FARF035
 13014*
 13015 2590-NVA-DIRECC-BOGOTA.                                          GJC0011
 13016******************************************************************
 13017*2590-NVA-DIRECC-BOGOTA
 13018*    SI LA DIRECCION ES DE BOGOTA, BUSCA SI ESTA TIENE NUEVA NO- *
 13019*    MENCLATURA                                                  *
 13020******************************************************************
 13021        IF CIUDAD-BTA-BDLDIR(1:5)  = "BOGOT"                      GJC0011
 13022           MOVE DIRECCION-BTA-BDLDIR TO T-CARMEJ-BDLDIR           GJC0011
 13023           PERFORM 1200-CALCULAR-LLAVE                            GJC0011
 13024*          MOVE V-HASDIRFIN-BDLDIR (I-BDLDIR) TO                  RMB0012
 13025*               LLAVE-BDLNEWDIRBOG                                RMB0012
 13026           PERFORM 8400-EXAMINE-BDLNEWDIRBOG                      GJC0011
 13027        ELSE                                                      GJC0011
 13028           MOVE 0 TO HAY-BDLNEWDIRBOG-BDLDIR                      GJC0011
 13029        END-IF.                                                   GJC0011
 13030
 13031 1200-CALCULAR-LLAVE.                                             GJC0011
 13032*********************************************************************
 13033* 1200-CALCULAR-LLAVE.
 13034* SE PROCEDE A CLACULAR LA LLAVE DEL ARCHIVO DE NUEVA NOMENCLATURA
 13035* DE BOGOTA, LA CUAL SE COMPONE:
 13036*      1: SIGLA DE LA "AVENIDA" (2 CARACTERES)
 13037*      2: NUMEROS ORDENADOS     (5 CARACTERES 7 NUMEROS)
 13038*      3: NUMEROS ORIGINALES    (5 CARACTERES 3 NUMEROS) ADICIONANDO
 13039*         LOS VALORES ASCII POR POSICION A ESTOS
 13040*********************************************************************
 13041     MOVE 1 TO I-MEJ-BDLDIR.                                      GJC0011
 13042     MOVE 1 TO K-MEJ-BDLDIR.                                      GJC0011
 13043     MOVE 0 TO J-MEJ-BDLDIR.                                      GJC0011
 13044     MOVE " " TO CAR-ANT-BDLDIR.                                  GJC0011
 13045     INITIALIZE T-NUMMEJ-BDLDIR.                                  GJC0011
 13046     PERFORM UNTIL I-MEJ-BDLDIR > 60 OR J-MEJ-BDLDIR >= 10        CAV0014
 13047       IF V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) NUMERIC                   GJC0011
 13048          MOVE V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) TO CAR-ACT-BDLDIR    GJC0011
 13049          IF CAR-ANT-BDLDIR NUMERIC                               GJC0011
 13050             COMPUTE V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR) =              GJC0011
 13051                     V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR) * 10 +         GJC0011
 13052                                       CAR-ACT-BDLDIR             GJC0011
 13053          ELSE                                                    GJC0011
 13054             ADD 1 TO J-MEJ-BDLDIR                                GJC0011
 13055             MOVE V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) TO                GJC0011
 13056                  V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR)                   GJC0011
 13057          END-IF                                                  GJC0011
 13058          MOVE "N"             TO V-LETRAS-BDLDIR(K-MEJ-BDLDIR)   GJC0011
 13059          ADD 1 TO K-MEJ-BDLDIR                                   GJC0011
 13060          MOVE "U"             TO V-LETRAS-BDLDIR(K-MEJ-BDLDIR)   GJC0011
 13061          ADD 1 TO K-MEJ-BDLDIR                                   GJC0011
 13062          MOVE " "             TO V-LETRAS-BDLDIR(K-MEJ-BDLDIR)   GJC0011
 13063          ADD 1 TO K-MEJ-BDLDIR                                   GJC0011
 13064       ELSE                                                       GJC0011
 13065          MOVE V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) TO                   GJC0011
 13066               V-LETRAS-BDLDIR(K-MEJ-BDLDIR)                      GJC0011
 13067          ADD 1 TO K-MEJ-BDLDIR                                   GJC0011
 13068       END-IF                                                     GJC0011
 13069       MOVE V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) TO CAR-ANT-BDLDIR       GJC0011
 13070       ADD 1 TO I-MEJ-BDLDIR                                      GJC0011
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 226
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 13071     END-PERFORM.                                                 GJC0011
 13072     MOVE V-NUMMEJ-BDLDIR(01) TO NN8-BDLDIR                       GJC0011
 13073     MOVE V-NUMMEJ-BDLDIR(02) TO NN9-BDLDIR                       GJC0011
 13074     MOVE V-NUMMEJ-BDLDIR(03) TO NN10-BDLDIR                      GJC0011
 13075     SORT V-NUMMEJ-BDLDIR DESCENDING.                             GJC0011
 13076     MOVE NN8-BDLDIR  TO  V-NUMMEJ-BDLDIR(08).                    GJC0011
 13077     MOVE NN9-BDLDIR  TO  V-NUMMEJ-BDLDIR(09).                    GJC0011
 13078     MOVE NN10-BDLDIR TO  V-NUMMEJ-BDLDIR(10).                    GJC0011
 13079     INITIALIZE T-L-BDLDIR.                                       GJC0011
 13080     UNSTRING T-LETRAS-BDLDIR DELIMITED BY ALL " " INTO           GJC0011
 13081       L-BDLDIR(1)  L-BDLDIR(2)  L-BDLDIR(3)  L-BDLDIR(4)         GJC0011
 13082       L-BDLDIR(5)  L-BDLDIR(6)  L-BDLDIR(7)  L-BDLDIR(8)         GJC0011
 13083       L-BDLDIR(9)  L-BDLDIR(10) L-BDLDIR(11) L-BDLDIR(12)        GJC0011
 13084       L-BDLDIR(13) L-BDLDIR(14) L-BDLDIR(15) L-BDLDIR(16)        GJC0011
 13085       L-BDLDIR(17) L-BDLDIR(18) L-BDLDIR(19) L-BDLDIR(20)        GJC0011
 13086       L-BDLDIR(21) L-BDLDIR(22) L-BDLDIR(23) L-BDLDIR(24)        GJC0011
 13087       L-BDLDIR(25) L-BDLDIR(26) L-BDLDIR(27) L-BDLDIR(28)        GJC0011
 13088       L-BDLDIR(29) L-BDLDIR(30)                                  GJC0011
 13089     MOVE 2 TO I-MEJ-BDLDIR                                       GJC0011
 13090     MOVE 8 TO J-MEJ-BDLDIR                                       GJC0011
 13091     PERFORM UNTIL I-MEJ-BDLDIR > 30                              GJC0011
 13092       IF J-MEJ-BDLDIR > 10                                       GJC0011
 13093          MOVE 8 TO J-MEJ-BDLDIR                                  GJC0011
 13094       END-IF                                                     GJC0011
 13095       IF L-BDLDIR(I-MEJ-BDLDIR) <> SPACES                        GJC0011
 13096          IF L-BDLDIR(I-MEJ-BDLDIR)(2:1) = " "                    GJC0011
 13097             MOVE L-BDLDIR(I-MEJ-BDLDIR)(1:1) TO LETRA-BDLDIR     GJC0011
 13098             MOVE FUNCTION ORD(LETRA-BDLDIR) TO ORDEN-ASCII-BDLDIRGJC0011
 13099             COMPUTE ORDEN-ASCII-BDLDIR = ORDEN-ASCII-BDLDIR  *   GJC0011
 13100                     I-MEJ-BDLDIR                                 GJC0011
 13101             ADD ORDEN-ASCII-BDLDIR TO                            GJC0011
 13102                 V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR)                    GJC0011
 13103             ADD 1 TO J-MEJ-BDLDIR                                GJC0011
 13104          ELSE                                                    GJC0011
 13105             IF L-BDLDIR(I-MEJ-BDLDIR) = "BIS" OR "MJ"            GJC0011
 13106                MOVE "W" TO LETRA-BDLDIR                          GJC0011
 13107                MOVE FUNCTION ORD(LETRA-BDLDIR) TO                GJC0011
 13108                     ORDEN-ASCII-BDLDIR                           GJC0011
 13109                ADD ORDEN-ASCII-BDLDIR TO                         GJC0011
 13110                    V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR)                 GJC0011
 13111                ADD 1 TO J-MEJ-BDLDIR                             GJC0011
 13112             END-IF                                               GJC0011
 13113          END-IF                                                  GJC0011
 13114       END-IF                                                     GJC0011
 13115       ADD 1 TO I-MEJ-BDLDIR                                      GJC0011
 13116    END-PERFORM.                                                  GJC0011
 13117 8400-EXAMINE-BDLNEWDIRBOG.                                       GJC0011
 13118**************************************************************
 13119*8400-EXAMINE-BDLNEWDIRBOG.
 13120* CON ESTA RUTINA SE DETERMINA SI UNA DIRECCION DE BOGOTA TIENE
 13121* NUEVA NOMENCLATURA O NO.
 13122*************************************************************
 13123     IF OPEN-BDLNEWDIRBOG-BDLDIR = 0                              GJC0011
 13124        MOVE 1 TO OPEN-BDLNEWDIRBOG-BDLDIR                        GJC0011
 13125        OPEN INPUT BDLNEWDIRBOG                                   GJC0011
 13126     END-IF.                                                      GJC0011
 13127     MOVE T-NUMMEJ-BDLDIR TO NUMEROS-BDLNEWDIRBOG                 GJC0011
 13128     IF L-BDLDIR(1) NOT = SPACES                                  GJC0011
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 227
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 13129        MOVE L-BDLDIR(1) TO AVENIDA-BDLNEWDIRBOG                  GJC0011
 13130     ELSE                                                         GJC0011
 13131        MOVE L-BDLDIR(2) TO AVENIDA-BDLNEWDIRBOG                  GJC0011
 13132     END-IF.                                                      GJC0011
 13133     READ BDLNEWDIRBOG                                            GJC0011
 13134       INVALID KEY                                                GJC0011
 13135           MOVE 0 TO HAY-BDLNEWDIRBOG-BDLDIR                      GJC0011
 13136       NOT INVALID KEY                                            GJC0011
 13137           MOVE 1 TO HAY-BDLNEWDIRBOG-BDLDIR                      GJC0011
 13138     END-READ.                                                    GJC0011
 13139                                                                  ABB0034
 13140 8500-NUEVOS-CAMPOS-DIRECCION.                                    ABB0034
 13141******************************************************************ABB0036
 13142*    CONVIERTE CODIGOS DE NUEVOS CAMPOS DE DIRECCION             *ABB0036
 13143*    EN DESCRIPCIONES                                            *ABB0036
 13144*       V-TIPODIFIN-BDLDIR() -> V-TDI-BDLDIR()                   *ABB0036
 13145*       V-ZONAFIN-BDLDIR  () -> V-ZON-BDLDIR()                   *ABB0036
 13146******************************************************************ABB0036
 13147     ACCEPT FECHA-VEC-BDLDIR FROM DATE YYYYMMDD                   ABB0036
 13148     INITIALIZE TABLA-VEC-BDLDIR                                  ABB0036
 13149     MOVE 24 TO K-TRA-BDLDIR                                      ABB0036
 13150     PERFORM 24 TIMES                                             ABB0036
 13151       SUBTRACT 1 FROM MES-VEC-BDLDIR                             ABB0036
 13152       IF MES-VEC-BDLDIR < 1                                      ABB0036
 13153          MOVE 12 TO MES-VEC-BDLDIR                               ABB0036
 13154          SUBTRACT 1 FROM ANO-VEC-BDLDIR                          ABB0036
 13155       END-IF                                                     ABB0036
 13156       MOVE ANOMES-VEC-BDLDIR TO T-MES-BDLDIR(K-TRA-BDLDIR)       ABB0036
 13157       SUBTRACT 1 FROM K-TRA-BDLDIR                               ABB0036
 13158     END-PERFORM                                                  ABB0036
 13159                                                                  ABB0036
 13160     MOVE 1 TO I-TRA-BDLDIR                                       ABB0036
 13161     PERFORM UNTIL V-FECFIN-BDLDIR(I-TRA-BDLDIR) = 0              ABB0036
 13162             OR    I-TRA-BDLDIR > 100                             ABB0036
 13163       IF V-ZONAFIN-BDLDIR(I-TRA-BDLDIR) = "U"                    ABB0036
 13164          MOVE "URB" TO V-ZON-BDLDIR(I-TRA-BDLDIR)                ABB0036
 13165       ELSE                                                       ABB0036
 13166          IF V-ZONAFIN-BDLDIR(I-TRA-BDLDIR) = "R"                 ABB0036
 13167             MOVE "RUR" TO V-ZON-BDLDIR(I-TRA-BDLDIR)             ABB0036
 13168          ELSE                                                    ABB0036
 13169             MOVE "   " TO V-ZON-BDLDIR(I-TRA-BDLDIR)             FARF039
 13170          END-IF                                                  ABB0036
 13171       END-IF                                                     ABB0036
 13172       MOVE V-TIPODIFIN-BDLDIR(I-TRA-BDLDIR) TO J-TRA-BDLDIR      ABB0036
 13173                                                                  ABB0036
 13174       MOVE 1 TO K-TRA-BDLDIR                                     ABB0036
 13175       PERFORM UNTIL K-TRA-BDLDIR > 24                            ABB0036
 13176         IF V-FECCREFIN-BDLDIR(I-TRA-BDLDIR) =                    ABB0036
 13177            T-MES-BDLDIR(K-TRA-BDLDIR)                            ABB0036
 13178            EVALUATE J-TRA-BDLDIR                                 ABB0036
 13179              WHEN 1 MOVE "N" TO T-VRE-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13180              WHEN 2 MOVE "N" TO T-VLA-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13181              WHEN 3 MOVE "N" TO T-VRE-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13182                     MOVE "N" TO T-VLA-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13183              WHEN 4 MOVE "N" TO T-VCR-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13184              WHEN 5 MOVE "N" TO T-VRE-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13185                     MOVE "N" TO T-VCR-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13186              WHEN 6 MOVE "N" TO T-VLA-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 228
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 13187                     MOVE "N" TO T-VCR-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13188              WHEN 7 MOVE "N" TO T-VRE-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13189                     MOVE "N" TO T-VLA-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13190                     MOVE "N" TO T-VCR-BDLDIR(K-TRA-BDLDIR:1)     ABB0036
 13191            END-EVALUATE                                          ABB0036
 13192            MOVE 24 TO K-TRA-BDLDIR                               ABB0036
 13193         END-IF                                                   ABB0036
 13194         ADD 1 TO K-TRA-BDLDIR                                    ABB0036
 13195       END-PERFORM                                                ABB0036
 13196                                                                  ABB0036
 13197       IF TIPO-ID-DIRECC = 1 OR 4                                 ABB0036
 13198          EVALUATE J-TRA-BDLDIR                                   ABB0036
 13199           WHEN 1 MOVE "RES"         TO V-TDI-BDLDIR(I-TRA-BDLDIR)ABB0036
 13200                  MOVE 1             TO W-RES-BDLDIR              ABB0036
 13201           WHEN 2 MOVE "LAB"         TO V-TDI-BDLDIR(I-TRA-BDLDIR)ABB0036
 13202                  MOVE 1             TO W-LAB-BDLDIR              ABB0036
 13203           WHEN 3 MOVE "RES-LAB"     TO V-TDI-BDLDIR(I-TRA-BDLDIR)ABB0036
 13204                  MOVE 1             TO W-RES-BDLDIR              ABB0036
 13205                  MOVE 1             TO W-LAB-BDLDIR              ABB0036
 13206           WHEN 4 MOVE "CRR"         TO V-TDI-BDLDIR(I-TRA-BDLDIR)ABB0036
 13207                  MOVE 1             TO W-CRR-BDLDIR              ABB0036
 13208           WHEN 5 MOVE "RES-CRR"     TO V-TDI-BDLDIR(I-TRA-BDLDIR)ABB0036
 13209                  MOVE 1             TO W-RES-BDLDIR              ABB0036
 13210                  MOVE 1             TO W-CRR-BDLDIR              ABB0036
 13211           WHEN 6 MOVE "LAB-CRR"     TO V-TDI-BDLDIR(I-TRA-BDLDIR)ABB0036
 13212                  MOVE 1             TO W-LAB-BDLDIR              ABB0036
 13213                  MOVE 1             TO W-CRR-BDLDIR              ABB0036
 13214           WHEN 7 MOVE "RES-LAB-CRR" TO V-TDI-BDLDIR(I-TRA-BDLDIR)ABB0036
 13215                  MOVE 1             TO W-RES-BDLDIR              ABB0036
 13216                  MOVE 1             TO W-LAB-BDLDIR              ABB0036
 13217                  MOVE 1             TO W-CRR-BDLDIR              ABB0036
 13218           WHEN ANY MOVE "    "      TO V-TDI-BDLDIR(I-TRA-BDLDIR)ABB0036
 13219          END-EVALUATE                                            ABB0036
 13220       ELSE                                                       ABB0036
 13221          EVALUATE J-TRA-BDLDIR                                   ABB0036
 13222           WHEN 1   MOVE "CCL"     TO V-TDI-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13223                    MOVE 1         TO W-RES-BDLDIR                ABB0036
 13224           WHEN 2   MOVE "CCL"     TO V-TDI-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13225                    MOVE 1         TO W-RES-BDLDIR                ABB0036
 13226           WHEN 3   MOVE "CCL"     TO V-TDI-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13227                    MOVE 1         TO W-RES-BDLDIR                ABB0036
 13228           WHEN 4   MOVE "CRR"     TO V-TDI-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13229                    MOVE 1         TO W-CRR-BDLDIR                ABB0036
 13230           WHEN 5   MOVE "CCL-CRR" TO V-TDI-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13231                    MOVE 1         TO W-RES-BDLDIR                ABB0036
 13232                    MOVE 1         TO W-CRR-BDLDIR                ABB0036
 13233           WHEN 6   MOVE "CCL-CRR" TO V-TDI-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13234                    MOVE 1         TO W-RES-BDLDIR                ABB0036
 13235                    MOVE 1         TO W-CRR-BDLDIR                ABB0036
 13236           WHEN 7   MOVE "CCL-CRR" TO V-TDI-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13237                    MOVE 1         TO W-RES-BDLDIR                ABB0036
 13238                    MOVE 1         TO W-CRR-BDLDIR                ABB0036
 13239           WHEN ANY MOVE "    "    TO V-TDI-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13240          END-EVALUATE                                            ABB0036
 13241       END-IF                                                     ABB0036
 13242       ADD 1 TO I-TRA-BDLDIR                                      ABB0036
 13243     END-PERFORM                                                  ABB0036
 13244                                                                  ABB0036
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 229
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLDI2.P
 13245     IF W-RES-BDLDIR = 1                                          ABB0036
 13246        INSPECT T-VRE-BDLDIR REPLACING ALL " " BY "I"             ABB0036
 13247     END-IF                                                       ABB0036
 13248     IF W-LAB-BDLDIR = 1                                          ABB0036
 13249        INSPECT T-VLA-BDLDIR REPLACING ALL " " BY "I"             ABB0036
 13250     END-IF                                                       ABB0036
 13251     IF W-CRR-BDLDIR = 1                                          ABB0036
 13252        INSPECT T-VCR-BDLDIR REPLACING ALL " " BY "I"             ABB0036
 13253     END-IF.                                                      ABB0036
 13254                                                                  ABB0036
 13255 8550-NUEVOS-CAMPOS-TELEFONO.                                     ABB0036
 13256******************************************************************ABB0036
 13257*    CONVIERTE CODIGOS DE NUEVOS CAMPOS DE TELEFONOS             *ABB0036
 13258*    EN DESCRIPCIONES                                            *ABB0036
 13259*       V-TIPOTEFIN-BDLDIR() -> V-TTE-BDLDIR()                   *ABB0036
 13260******************************************************************ABB0036
 13261     MOVE 1 TO I-TRA-BDLDIR                                       ABB0036
 13262     PERFORM UNTIL V-FECTELFIN-BDLDIR(I-TRA-BDLDIR) = 0           ABB0036
 13263             OR    I-TRA-BDLDIR > 100                             ABB0036
 13264       MOVE V-TIPOTEFIN-BDLDIR(I-TRA-BDLDIR) TO J-TRA-BDLDIR      ABB0036
 13265       IF TIPO-ID-DIRECC = 1 OR 4                                 ABB0036
 13266          EVALUATE J-TRA-BDLDIR                                   ABB0036
 13267           WHEN 1   MOVE "RES"     TO V-TTE-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13268           WHEN 2   MOVE "LAB"     TO V-TTE-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13269           WHEN 3   MOVE "RES-LAB" TO V-TTE-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13270           WHEN ANY MOVE "    "    TO V-TTE-BDLDIR(I-TRA-BDLDIR)  ABB0036
 13271          END-EVALUATE                                            ABB0036
 13272       ELSE                                                       ABB0036
 13273          EVALUATE J-TRA-BDLDIR                                   ABB0036
 13274           WHEN 1   MOVE "CCL"   TO V-TTE-BDLDIR(I-TRA-BDLDIR)    ABB0036
 13275           WHEN 2   MOVE "CCL"   TO V-TTE-BDLDIR(I-TRA-BDLDIR)    ABB0036
 13276           WHEN 3   MOVE "CCL"   TO V-TTE-BDLDIR(I-TRA-BDLDIR)    ABB0036
 13277           WHEN ANY MOVE "    "  TO V-TTE-BDLDIR(I-TRA-BDLDIR)    ABB0036
 13278          END-EVALUATE                                            ABB0036
 13279       END-IF                                                     ABB0036
 13280       ADD 1 TO I-TRA-BDLDIR                                      ABB0036
 13281     END-PERFORM.                                                 ABB0036
 13282                                                                  ABB0036
 13283*ADICIONALES DE DIRECCIONES +
*13284 COPY BDLSTDMAI.PROC.
 13285*BDLSTDMAI.PROC.0001
 13286**********************************************************************
 13287*RUTINAS   PARA ACEPCIONES DE EMAILS
 13288**********************************************************************
 13289 1000-CLEANCING-BDLSTDMAI.
 13290**********************************************************************
 13291*1000-CLEANCING-BDLSTDMAI.
 13292*    SE TRABAJA CONVIRTIENDO LOS E-MAILS EN MINUSCULAS
 13293*    Y NO SE CUENTA COMO CAMBIO O APLICACION DE REGLA
 13294*    REGLAS Y ACEPCIONES SE TRABAJAN EN MINUSCULAS
 13295*    DATOS DE ENTRADA.
 13296*        WS-MAIL-BDLSTMAI : E-MAIL A SER LIMPIADO
 13297*    DATOS DE SALIDA DE LA LIMPIEZA.
 13298*        WS-REGL-MAIL-BDLSTDMAI : Email aplicando solo reglas
 13299*        WS-ACEP-MAIL-BDLSTDMAI : Email aplicando reglas + acepciones
 13300*        ESTA ULTIMA VARIABLE ES LA QUE CONTIENE EL E-MAIL
 13301*        TOTALMENTE LIMPIO
 13302*    PARA CONTROLES EXTERNOS HAY LAS VARIABLES:
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 230
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLSTDMA
 13303*        WS-REGL-BDLSTDMAI  0,1=Aplic alguna regla
 13304*        WS-ACEP-BDLSTDMAI  0,1=Aplic alguna acepcin
 13305*    EJEMPLO DE USO:
 13306*        MOVE E-MAIL TO WS-MAIL-BDLSTMA
 13307*        PERFORM 1000-CLEANCING-BDLSTDMAI.
 13308*        DISPLAY "E-MAIL LIMPIO=",WS-ACEP-MAIL-BDLSTDMAI
 13309**********************************************************************
 13310     MOVE 0 TO WS-ACEP-BDLSTDMAI.
 13311     MOVE 0 TO WS-REGL-BDLSTDMAI.
 13312     MOVE FUNCTION LOWER-CASE(WS-MAIL-BDLSTDMAI) TO
 13313          WS-MAIL-BDLSTDMAI.
 13314     MOVE WS-MAIL-BDLSTDMAI TO WS-ORIG-MAIL-BDLSTDMAI.
 13315     PERFORM 1000-INSPECT-BDLSTDMAI.
 13316     IF WS-ORIG-MAIL-BDLSTDMAI <> WS-REGL-MAIL-BDLSTDMAI
 13317        MOVE 1 TO WS-REGL-BDLSTDMAI
 13318     END-IF.
 13319*
 13320     MOVE WS-REGL-MAIL-BDLSTDMAI TO WS-MAIL-BDLSTDMAI.
 13321     PERFORM 1000-BUS-ACEPCION-BDLSTDMAI.
 13322     IF WS-REGL-MAIL-BDLSTDMAI <> WS-ACEP-MAIL-BDLSTDMAI
 13323        MOVE 1 TO WS-ACEP-BDLSTDMAI
 13324     END-IF.
 13325*
 13326 1000-INSPECT-BDLSTDMAI.
 13327**********************************************************************
 13328*1000-INSPECT-BDLSTDMAI.
 13329*    SE APLICAN REGLAS DE REEMPLAZOS DE PARTE DEL E-MAIL Y SE
 13330*    ELIMINAN BLANCOS INTERMEDIOS
 13331**********************************************************************
 13332     INSPECT WS-MAIL-BDLSTDMAI
 13333                 REPLACING ALL ".copm    " BY ".com     "   *>REG001
 13334     INSPECT WS-MAIL-BDLSTDMAI
 13335                 REPLACING ALL ".coes    " BY ".co      "   *>REG002
 13336     INSPECT WS-MAIL-BDLSTDMAI
 13337                 REPLACING ALL ".edu.com " BY ".edu.co  "   *>REG003
 13338     INSPECT WS-MAIL-BDLSTDMAI
 13339                 REPLACING ALL ".go      " BY ".gov.co  "   *>REG004
 13340     INSPECT WS-MAIL-BDLSTDMAI
 13341                 REPLACING ALL ".con     " BY ".com     "   *>REG005
 13342     INSPECT WS-MAIL-BDLSTDMAI
 13343                 REPLACING ALL ".@"         BY "@ "         *>REG006
 13344     INSPECT WS-MAIL-BDLSTDMAI
 13345                 REPLACING ALL ","         BY "."           *>REG007
 13346     INSPECT WS-MAIL-BDLSTDMAI
 13347                 REPLACING ALL "@@"         BY "@ "         *>REG008
 13348     INSPECT WS-MAIL-BDLSTDMAI
 13349                 REPLACING ALL ".go.com  " BY ".gov.co  "   *>REG009
 13350     INSPECT WS-MAIL-BDLSTDMAI
 13351                 REPLACING ALL ".gov.com " BY ".gov.co  "   *>REG010
 13352     INSPECT WS-MAIL-BDLSTDMAI
 13353                 REPLACING ALL ".net.coo " BY ".net.co  "   *>REG011
 13354     INSPECT WS-MAIL-BDLSTDMAI
 13355                 REPLACING ALL "@."         BY "@ "         *>REG012
 13356     INSPECT WS-MAIL-BDLSTDMAI
 13357                 REPLACING ALL "WWW."       BY "    "       *>REG013
 13358     INSPECT WS-MAIL-BDLSTDMAI
 13359                 REPLACING ALL "?"          BY " "          *>REG014
 13360     INSPECT WS-MAIL-BDLSTDMAI
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 231
* ROC)ccol/desarrollo/fuentes/BDIIALEDB2.CBL (/d/iccol/desarrollo/copys/BDLSTDMA
 13361                 REPLACING ALL ":@"         BY "@ "         *>REG015
 13362     INSPECT WS-MAIL-BDLSTDMAI
 13363                 REPLACING ALL ".edu.com "  BY ".edu.co  "  *>REG016
 13364     INSPECT WS-MAIL-BDLSTDMAI
 13365                 REPLACING ALL ""          BY "n"          *>REG017
 13366     INSPECT WS-MAIL-BDLSTDMAI
 13367                 REPLACING ALL ".."         BY ". "         *>REG018
 13368     INSPECT WS-MAIL-BDLSTDMAI
 13369                 REPLACING ALL ".        " BY "         "   *>REG019
 13370     *>ELIMINAR BLANCOS INTERMEDIOS                         *>REG050
 13371     MOVE SPACES TO WS-REGL-MAIL-BDLSTDMAI.
 13372     MOVE 1 TO WS-I-BDLSTDMAI.
 13373     MOVE 1 TO WS-J-BDLSTDMAI.
 13374     PERFORM UNTIL WS-I-BDLSTDMAI > 60
 13375        IF WS-MAIL-BDLSTDMAI(WS-I-BDLSTDMAI:1) <> SPACES
 13376           MOVE WS-MAIL-BDLSTDMAI(WS-I-BDLSTDMAI:1) TO
 13377                WS-REGL-MAIL-BDLSTDMAI(WS-J-BDLSTDMAI:1)
 13378           ADD 1 TO WS-J-BDLSTDMAI
 13379        END-IF
 13380*
 13381        ADD 1 TO WS-I-BDLSTDMAI
 13382     END-PERFORM.
 13383*
 13384 1000-BUS-ACEPCION-BDLSTDMAI.
 13385**********************************************************************
 13386*1000-BUS-ACEPCION-BDLSTDMAI.
 13387*    SE BUSCA EL DOMINIO EN EL E-MAIL, SI LO HAY SE BUSCA SI EXISTE
 13388*    UNA ACEPCION EN EL ARCHIVO DE ACEPCIONES DE E_MAILS. SI LO
 13389*    ENCUENTRA LO REEMPLAZA POR ESTE.
 13390**********************************************************************
 13391     IF WS-OPEN-BDLSTDMAI = 0
 13392        OPEN INPUT BDLSTDMAI
 13393        MOVE 1 TO  WS-OPEN-BDLSTDMAI
 13394     END-IF.
 13395*
 13396     MOVE WS-MAIL-BDLSTDMAI TO WS-ACEP-MAIL-BDLSTDMAI.
 13397     MOVE 0 TO WS-I-BDLSTDMAI.
 13398     INSPECT  WS-MAIL-BDLSTDMAI TALLYING WS-I-BDLSTDMAI
 13399                           FOR ALL "@"
 13400     INITIALIZE WS-P1-BDLSTDMAI WS-P2-BDLSTDMAI WS-P3-BDLSTDMAI.
 13401     UNSTRING WS-MAIL-BDLSTDMAI DELIMITED BY ALL "@" OR " "
 13402       INTO WS-P1-BDLSTDMAI WS-P2-BDLSTDMAI WS-P3-BDLSTDMAI
 13403     IF WS-P3-BDLSTDMAI = SPACES AND WS-I-BDLSTDMAI = 1
 13404        IF WS-P2-BDLSTDMAI <> SPACES
 13405           MOVE WS-P2-BDLSTDMAI TO LLAVE-BDLSTDMAI
 13406           MOVE 0 TO WS-NOHAY-BDLSTDMAI
 13407           READ BDLSTDMAI
 13408              INVALID KEY
 13409                 MOVE 1 TO WS-NOHAY-BDLSTDMAI
 13410           END-READ
 13411*
 13412           IF WS-NOHAY-BDLSTDMAI = 0 AND ACTIVA-BDLSTDMAI = "A"
 13413              MOVE SPACES TO WS-ACEP-MAIL-BDLSTDMAI
 13414              STRING WS-P1-BDLSTDMAI DELIMITED BY "       "
 13415                     "@"
 13416                     DOMINIO-BDLSTDMAI DELIMITED BY " "
 13417              INTO WS-ACEP-MAIL-BDLSTDMAI
 13418           END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-14 10:27 Page 232
* C)C)ccol/desarrollo/fuentes/BDIIALEDB2.CBL                       opys/BDLSTDMA
 13419        END-IF
 13420     END-IF.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-015065005AF
* Total Messages:     0
* Data:     1731584     Code:      130683
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 

icdgd@codes /d/iccol/desarrollo
$ icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ ##########################################################################################
icdgd@codes /d/iccol/desarrollo
$ ^[  $ ###########################################################################>$ cat ./objetos/BDIIALEDB2.lst                                                $ view ./objetos/BDIIALEDB2.lst$ find . -name "BDIIALE*" -print$ 
./objetos/BDIIALEDB2.int
./objetos/BDIIALEDB2.gnt
./objetos/BDIIALEDB2.idy
./objetos/BDIIALEDB2.s
./objetos/BDIIALEDB2.lst
./fuentes/BDIIALE.CBL
find: cannot read dir ./fuentes/especiales/darlas: Permission denied
./fuentes/BDIIALENEW.aif
./fuentes/BDIIALEDB2.CBL
./fuentes/BDIIALEDB2.aif
./fuentes/BDIIALEDB2.20140502.core
./copys/BDIIALE-ANT.PROC
./copys/BDIIALE.FD
./copys/BDIIALE.FS
./copys/BDIIALENW.PROC
./copys/BDIIALET7.PROC-DARIO
./copys/BDIIALE.PROC
./copys/ley/BDIIALE.FD
./copys/ley/BDIIALE.FS
./copys/ley/BDIIALE-LEY.PROC
./copys/ley/BDIIALE.PROC
./copys/ley/BDIIALET7.PROC-DARIO
./copys/ley/BDIIALE.WS
./copys/BDIIALEDB2.DOC
./copys/BDIIALEJURAD.WS
./copys/BDIIALENEW.PROC
./copys/BDIIALENEW.PROC.F-OLD!
./copys/BDIIALE.WS-V05
./copys/BDIIALE.WS
./copys/BDIIALE.PROC-V06
./copys/BDIIALE.PROC.20130913
./copys/BDIIALE-BDINDE.WS
./copys/BDIIALE-BDINDE-RGH.PROC
./copys/BDIIALEV07.PROC
./copys/BDIIALE-BDINDE.PROC-OLD-2013-10-31
./copys/BDIIALEV08.PROC.F-OLD!
./copys/BDIIALEV08.PROC
./copys/BDIIALEPR.PROC
./copys/BDIIALE-BDINDE.PROC-OK2
./copys/BDIIALE-BDINDE.PROC-OK1
./copys/BDIIALE-BDINDE.PROC
./copys/BDIIALEJURAD.PROC
./copys/AMNISTIA/BDIIALE.PROC
./copys/documentacion/BDIIALE.PROC
./copys/documentacion/BDIIALE.WS
./copys/documentacion/BDIIALE.FD
./copys/documentacion/BDIIALE.FS
./copys/documentacion/BDIIALE-BDINDE.WS
./copys/documentacion/BDIIALE-BDINDE.PROC
./copys/BDIIALEDB2.WS
./copys/BDIIALEDB2.PROC.ORI
./copys/BDIIALEDB2.PROC
./copys/BDIIALENEW.WS
./copys/BDIIALE-PLANO.FS
./copys/BDIIALE-PLANO.FD
find: cannot read dir ./stt: Permission denied
find: cannot read dir ./sf/.sunw: Permission denied
./database/desnovedat/BDIIALE
./database/desnovedat/BDIIALE.idx
./database/prunovedat/BDIIALE
./database/prunovedat/BDIIALE-ALEGRU
./database/prunovedat/BDIIALE-ALERTAS
./database/prunovedat/BDIIALE-GRUPOS
./database/prunovedat/BDIIALE-LOG-20140430
./database/prunovedat/BDIIALE-LOG-20140506
./database/prunovedat/BDIIALE-NEW
./database/prunovedat/BDIIALE-NEW.idx
./database/prunovedat/BDIIALE.err
./database/prunovedat/BDIIALE-ORI
./database/prunovedat/BDIIALE-ORI.idx
./database/prunovedat/BDIIALE.idx
./database/prunovedat/BDIIALE-LOG-20140509
./database/BDIIALE
./database/BDIIALE.idx
./database/documentacion/BDIIALE
./database/documentacion/BDIIALE.idx
./database/BDIIALE-ALERTAS
./database/BDIIALE-GRUPOS
./database/BDIIALE-ALEGRU
./database/BDIIALE_20140414
./database/BDIIALE_20140502
./database/BDIIALE-LOG-20140506
./database/BDIIALE-LOG-20140430
./database/BDIIALEDB2.20140508.core
./database/BDIIALE-NEW
./database/BDIIALE-NEW.idx
./database/BDIIALE-LOG-20140508
./BDIIALEDB2.aif
find: cannot read dir ./.ssh: Permission denied
icdgd@codes /d/iccol/desarrollo
$ c view ./database/BDIIALE-ALERTAS
"./database/BDIIALE-ALERTAS" [Read only] 22 lines, 3190 characters E001;00;P;N;990003;0001;EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO;;OK
E002;00;P;N;990003;0002;EL DOCUMENTO DE IDENTIDAD FUE ROBADO;;OK
E003;00;P;N;990003;0003;ACTUALMENTE RESIDE FUERA DEL PAIS;;OK
E004;00;P;N;990003;0004;HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION ;DE IDENTIDAD;OK
I004;00;C;N;990001;0005;LA CEDULA TIENE HISTORIA DE CREDITO COMO NIT;;OK
I004;01;C;N;990001;0005;EL NIT TIENE HISTORIA DE CREDITO COMO CEDULA;;OK
I004;02;C;N;000001;0005;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIM
IENTO DE COMERCIO;OK
I006;00;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE CEDULAS;;OK
I006;01;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE NITS;;OK
I006;02;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE EXTRANJEROS;;OK
I007;00;C;N;990001;0007;CONSULTADO POR   [&&&&&&&&&&&&&&&&&&&&&&&&&&&&&]  ;CON APELLIDO DI
FERENTE:    [&&&&&&&&&&&&&&&];OK
I008;00;C;N;000001;0008;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIM
IENTO DE COMERCIO;OK
I008;01;C;N;000001;0008;EL CLIENTE NO TIENE ACTIVIDAD REGISTRADA COMO     ;TITULAR CON EST
ABLECIMIENTO DE COMERCIO;OK
I009;00;C;N;990001;0009;SI SE ESTA SOLICITANDO UN MICROCREDITO, SUS DEUDAS;REGISTRADAS LLE
GAN AL TOPE MXIMO,DECRETO 919/2008;OK
I010;00;C;N;990001;0010;EL REGISTRO CONSULTADO HA PRESENTADO 3 NUEVAS     ;DIRECCIONES O M
AS EN EL ULTIMO AO;OK
I011;00;C;N;990001;0011;EL REGISTRO CONSULTADO HA PRESENTADO MORAS DE 60  ;DIAS O MAS EN L
OS ULTIMOS 6 MESES;OK
I012;00;C;N;990001;0012;MAS DE 3 CONSULTAS DE DIFERENTES ENTIDADES EN LOS ;ULTIMOS 60 DIAS
;OK
J001;00;P;N;000001;0013;TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS; LA ABIERTA MAS
 RECIENTE SE INSTAURO EL [&&&&&&&&];OK
L999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DE SERVICIOS;;OK
B999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO BURO;;OK
J999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DEMANDAS JUDICIALES;;OK
V999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO VERTICALES;;OK
~
~
~
~
~"./database/BDIIALE-ALERTAS" [Read only] 22 lines, 3190 charactersE001;00;P;N;990003;0001;EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO;;OK
E002;00;P;N;990003;0002;EL DOCUMENTO DE IDENTIDAD FUE ROBADO;;OK
E003;00;P;N;990003;0003;ACTUALMENTE RESIDE FUERA DEL PAIS;;OK
E004;00;P;N;990003;0004;HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION ;DE IDENTIDAD;OK
I004;00;C;N;990001;0005;LA CEDULA TIENE HISTORIA DE CREDITO COMO NIT;;OK
I004;01;C;N;990001;0005;EL NIT TIENE HISTORIA DE CREDITO COMO CEDULA;;OK
I004;02;C;N;000001;0005;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO;OK
I006;00;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE CEDULAS;;OK
I006;01;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE NITS;;OK
I006;02;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE EXTRANJEROS;;OK
I007;00;C;N;990001;0007;CONSULTADO POR   [&&&&&&&&&&&&&&&&&&&&&&&&&&&&&]  ;CON APELLIDO DIFERENTE:    [&&&&&&&&&&&&&&&];OK
I008;00;C;N;000001;0008;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO;OK
I008;01;C;N;000001;0008;EL CLIENTE NO TIENE ACTIVIDAD REGISTRADA COMO     ;TITULAR CON ESTABLECIMIENTO DE COMERCIO;OK
I009;00;C;N;990001;0009;SI SE ESTA SOLICITANDO UN MICROCREDITO, SUS DEUDAS;REGISTRADAS LLEGAN AL TOPE MXIMO,DECRETO 919/2008;OK
I010;00;C;N;990001;0010;EL REGISTRO CONSULTADO HA PRESENTADO 3 NUEVAS     ;DIRECCIONES O MAS EN EL ULTIMO AO;OK
I011;00;C;N;990001;0011;EL REGISTRO CONSULTADO HA PRESENTADO MORAS DE 60  ;DIAS O MAS EN LOS ULTIMOS 6 MESES;OK
I012;00;C;N;990001;0012;MAS DE 3 CONSULTAS DE DIFERENTES ENTIDADES EN LOS ;ULTIMOS 60 DIAS;OK
J001;00;P;N;000001;0013;TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS; LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&];OK
L999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DE SERVICIOS;;OK
B999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO BURO;;OK
J999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DEMANDAS JUDICIALES;;OK
V999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO VERTICALES;;OK
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~E001;00;P;N;990003;0001;EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO;;OK
E002;00;P;N;990003;0002;EL DOCUMENTO DE IDENTIDAD FUE ROBADO;;OK
E003;00;P;N;990003;0003;ACTUALMENTE RESIDE FUERA DEL PAIS;;OK
E004;00;P;N;990003;0004;HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION ;DE IDENTIDAD;OK
I004;00;C;N;990001;0005;LA CEDULA TIENE HISTORIA DE CREDITO COMO NIT;;OK
I004;01;C;N;990001;0005;EL NIT TIENE HISTORIA DE CREDITO COMO CEDULA;;OK
I004;02;C;N;000001;0005;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIM
IENTO DE COMERCIO;OK
I006;00;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE CEDULAS;;OK
I006;01;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE NITS;;OK
I006;02;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE EXTRANJEROS;;OK
I007;00;C;N;990001;0007;CONSULTADO POR   [&&&&&&&&&&&&&&&&&&&&&&&&&&&&&]  ;CON APELLIDO DI
FERENTE:    [&&&&&&&&&&&&&&&];OK
I008;00;C;N;000001;0008;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIM
IENTO DE COMERCIO;OK
I008;01;C;N;000001;0008;EL CLIENTE NO TIENE ACTIVIDAD REGISTRADA COMO     ;TITULAR CON EST
ABLECIMIENTO DE COMERCIO;OK
I009;00;C;N;990001;0009;SI SE ESTA SOLICITANDO UN MICROCREDITO, SUS DEUDAS;REGISTRADAS LLE
GAN AL TOPE MXIMO,DECRETO 919/2008;OK
I010;00;C;N;990001;0010;EL REGISTRO CONSULTADO HA PRESENTADO 3 NUEVAS     ;DIRECCIONES O M
AS EN EL ULTIMO AO;OK
I011;00;C;N;990001;0011;EL REGISTRO CONSULTADO HA PRESENTADO MORAS DE 60  ;DIAS O MAS EN L
OS ULTIMOS 6 MESES;OK
I012;00;C;N;990001;0012;MAS DE 3 CONSULTAS DE DIFERENTES ENTIDADES EN LOS ;ULTIMOS 60 DIAS
;OK
J001;00;P;N;000001;0013;TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS; LA ABIERTA MAS
 RECIENTE SE INSTAURO EL [&&&&&&&&];OK
L999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DE SERVICIOS;;OK
B999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO BURO;;OK
J999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DEMANDAS JUDICIALES;;OK
V999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO VERTICALES;;OK
~
~
~
~
~E001;00;P;N;990003;0001;EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO;;OK
E002;00;P;N;990003;0002;EL DOCUMENTO DE IDENTIDAD FUE ROBADO;;OK
E003;00;P;N;990003;0003;ACTUALMENTE RESIDE FUERA DEL PAIS;;OK
E004;00;P;N;990003;0004;HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION ;DE IDENTIDAD;OK
I004;00;C;N;990001;0005;LA CEDULA TIENE HISTORIA DE CREDITO COMO NIT;;OK
I004;01;C;N;990001;0005;EL NIT TIENE HISTORIA DE CREDITO COMO CEDULA;;OK
I004;02;C;N;000001;0005;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO;OK
I006;00;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE CEDULAS;;OK
I006;01;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE NITS;;OK
I006;02;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE EXTRANJEROS;;OK
I007;00;C;N;990001;0007;CONSULTADO POR   [&&&&&&&&&&&&&&&&&&&&&&&&&&&&&]  ;CON APELLIDO DIFERENTE:    [&&&&&&&&&&&&&&&];OK
I008;00;C;N;000001;0008;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO;OK
I008;01;C;N;000001;0008;EL CLIENTE NO TIENE ACTIVIDAD REGISTRADA COMO     ;TITULAR CON ESTABLECIMIENTO DE COMERCIO;OK
I009;00;C;N;990001;0009;SI SE ESTA SOLICITANDO UN MICROCREDITO, SUS DEUDAS;REGISTRADAS LLEGAN AL TOPE MXIMO,DECRETO 919/2008;OK
I010;00;C;N;990001;0010;EL REGISTRO CONSULTADO HA PRESENTADO 3 NUEVAS     ;DIRECCIONES O MAS EN EL ULTIMO AO;OK
I011;00;C;N;990001;0011;EL REGISTRO CONSULTADO HA PRESENTADO MORAS DE 60  ;DIAS O MAS EN LOS ULTIMOS 6 MESES;OK
I012;00;C;N;990001;0012;MAS DE 3 CONSULTAS DE DIFERENTES ENTIDADES EN LOS ;ULTIMOS 60 DIAS;OK
J001;00;P;N;000001;0013;TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS; LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&];OK
L999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DE SERVICIOS;;OK
B999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO BURO;;OK
J999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DEMANDAS JUDICIALES;;OK
V999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO VERTICALES;;OK
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~E001;00;P;N;990003;0001;EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO;;OK
E002;00;P;N;990003;0002;EL DOCUMENTO DE IDENTIDAD FUE ROBADO;;OK
E003;00;P;N;990003;0003;ACTUALMENTE RESIDE FUERA DEL PAIS;;OK
E004;00;P;N;990003;0004;HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION ;DE IDENTIDAD;OK
I004;00;C;N;990001;0005;LA CEDULA TIENE HISTORIA DE CREDITO COMO NIT;;OK
I004;01;C;N;990001;0005;EL NIT TIENE HISTORIA DE CREDITO COMO CEDULA;;OK
I004;02;C;N;000001;0005;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO;OK
I006;00;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE CEDULAS;;OK
I006;01;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE NITS;;OK
I006;02;C;N;990001;0006;SIN INFORMACION EN ARCHIVO DE EXTRANJEROS;;OK
I007;00;C;N;990001;0007;CONSULTADO POR   [&&&&&&&&&&&&&&&&&&&&&&&&&&&&&]  ;CON APELLIDO DIFERENTE:    [&&&&&&&&&&&&&&&];OK
I008;00;C;N;000001;0008;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO;OK
I008;01;C;N;000001;0008;EL CLIENTE NO TIENE ACTIVIDAD REGISTRADA COMO     ;TITULAR CON ESTABLECIMIENTO DE COMERCIO;OK
I009;00;C;N;990001;0009;SI SE ESTA SOLICITANDO UN MICROCREDITO, SUS DEUDAS;REGISTRADAS LLEGAN AL TOPE MXIMO,DECRETO 919/2008;OK
I010;00;C;N;990001;0010;EL REGISTRO CONSULTADO HA PRESENTADO 3 NUEVAS     ;DIRECCIONES O MAS EN EL ULTIMO AO;OK
I011;00;C;N;990001;0011;EL REGISTRO CONSULTADO HA PRESENTADO MORAS DE 60  ;DIAS O MAS EN LOS ULTIMOS 6 MESES;OK
I012;00;C;N;990001;0012;MAS DE 3 CONSULTAS DE DIFERENTES ENTIDADES EN LOS ;ULTIMOS 60 DIAS;OK
J001;00;P;N;000001;0013;TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS; LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&];OK
L999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DE SERVICIOS;;OK
B999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO BURO;;OK
J999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO DEMANDAS JUDICIALES;;OK
V999;00;C;S;990001;9999;SIN ALERTAS EN EL GRUPO VERTICALES;;OK
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"./database/BDIIALE-ALERTAS" [Read only] line 1 of 22 --4%-- :qicdgd@codes /d/iccol/desarrollo
$ view ./copys/BDIIALE.FS
"./copys/BDIIALE.FS" [Read only] 16 lines, 805 characters REMARK* BDIIALE-FS.v01.0001
REMARK* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTOTRES$SET CONSTANT SW-STATUS-BDIIALE"NO"SELECT BDIIALE
ASSIGN TO DISK MAES-BDIIALE-TITLEORGANIZATION IS INDEXEDACCESS MODE IS DYNAMICRECORD KEY IS LLAVE-BDIIALE
$IF SW-STATUS-BDIIALE = "NO"
$DISPLAY ".............COMPILANDO BDIIALE SIN STATUS.........."
$ELSE
$DISPLAY ".............COMPILANDO BDIIALE CON STATUS.........."FILE STATUS IS EST-BDIIALE
$END
LOCK MODE IS MANUAL WITH LOCK ON RECORD.
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"./copys/BDIIALE.FS" [Read only] 16 lines, 805 charactersR:qicdgd@codes /d/iccol/desarrollo
$ ^[  $ view ./copys/BDIIALE.FS$ view ./copys/BDIIALE.FD
"./copys/BDIIALE.FD" [Read only] 30 lines, 1801 characters REMARK* BDIIALE-FD.v01.0003.
REMARK* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTORES
REMARK*----------------------------------------------------------------*
EMARK******************************************************************
REMARK* RMB0003   * CIU001: SE INCLUYE EL CODIGO DE LA ALERTA DENTRO DE
REMARK* R.MARTINEZ* LA LLAVE, SE CAMBIA LA LONGITUD DE LLAVE-SECUNDARIA
REMARK* OCTUB/2006* Y SE MANEJAN ALERTAS DE TEXTO FIJO
REMARK******************************************************************FD BDIIALE.
01 REG-BDIIALE.02 LLAVE-BDIIALE.
03 TIP-IDE-BDIIALEPIC 9(01).03 NUM-IDE-BDIIALEPIC 9(11).03 FUENTE-BDIIALEPIC 9(06).
CIU00103 COD-ALERTA-BDIIALE     PIC 9(03).RMB0003
CIU00103 LLASEC-BDIIALEPIC X(08).RMB000302 ENCABEZADO-BDIIALE.
CIU00103 FEC-NOV-BDIIALEPIC 9(08).RMB0003
CIU00103 FEC-VEN-BDIIALEPIC 9(08).RMB0003
CIU00103 FEC-REP-BDIIALEPIC 9(08).RMB000303 BLOQUEO-BDIIALEPIC 9(01).
CIU00103 FILLER-BDIIALEPIC X(10).RMB0003
CIU00103 INF-DATAHOST-BDIIALE   PIC X(18).RMB0003
CIU00103 LINEAS-BDIIALE.RMB0003
CIU00104 LINEA1-BDIIALEPIC X(50).RMB0003
CIU00104 LINEA2-BDIIALEPIC X(50).RMB0003
CIU00103 FILLER REDEFINES LINEAS-BDIIALE.RMB0003
CIU00104 DATOS-BDIIALEPIC X(100).RMB0003

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"./copys/BDIIALE.FD" [Read only] 30 lines, 1801 charactersREMARK* BDIIALE-FD.v01.0003.
REMARK* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTORES
REMARK*----------------------------------------------------------------*
EMARK******************************************************************
REMARK* RMB0003   * CIU001: SE INCLUYE EL CODIGO DE LA ALERTA DENTRO DE
REMARK* R.MARTINEZ* LA LLAVE, SE CAMBIA LA LONGITUD DE LLAVE-SECUNDARIA
REMARK* OCTUB/2006* Y SE MANEJAN ALERTAS DE TEXTO FIJO
REMARK******************************************************************FD BDIIALE.
01 REG-BDIIALE.02 LLAVE-BDIIALE.
03 TIP-IDE-BDIIALEPIC 9(01).03 NUM-IDE-BDIIALEPIC 9(11).03 FUENTE-BDIIALEPIC 9(06).
CIU00103 COD-ALERTA-BDIIALE     PIC 9(03).RMB0003
CIU00103 LLASEC-BDIIALEPIC X(08).RMB000302 ENCABEZADO-BDIIALE.
CIU00103 FEC-NOV-BDIIALEPIC 9(08).RMB0003
CIU00103 FEC-VEN-BDIIALEPIC 9(08).RMB0003
CIU00103 FEC-REP-BDIIALEPIC 9(08).RMB000303 BLOQUEO-BDIIALEPIC 9(01).
CIU00103 FILLER-BDIIALEPIC X(10).RMB0003
CIU00103 INF-DATAHOST-BDIIALE   PIC X(18).RMB0003
CIU00103 LINEAS-BDIIALE.RMB0003
CIU00104 LINEA1-BDIIALEPIC X(50).RMB0003
CIU00104 LINEA2-BDIIALEPIC X(50).RMB0003
CIU00103 FILLER REDEFINES LINEAS-BDIIALE.RMB0003
CIU00104 DATOS-BDIIALEPIC X(100).RMB0003

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:qicdgd@codes /d/iccol/desarrollo
$ view ./copys/BDIIALE.PROC
"./copys/BDIIALE.PROC" [Read only] 606 lines, 44614 characters REMARK* BDIIALE.PROC.v.0008
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE PERMITEN EXTRACTAR
REMARK* LAS ALERTAS DEL SISTEMA
REMARK*     "I" : ALERTAS INTERNAS, SE CALCULAN CON BASE A LA INF DE BD
REMARK*01=No se usa
REMARK*02=Alertas sobre el ICMCRE
REMARK*03=Alertas sobre el ICMCHK
REMARK*04=Alertas sobre doble identidad
REMARK*04=Alertas sobre vigencia de registraduria en 12
REMARK*     "F" : ALERTAS EXTERNAS FIJAS - LAS DETERMINA DATACREDITO SOLO
REMARK*REQUIEREN DEL REGISTRO 001 PARA SU DEFINICION. SE RECONOCEN
REMARK*POR TENER LA LETRA "S" EN EL CAMPO TEXTO-FIJO-BDIIALE
REMARK*01=el documento de identidad fue extraviado
REMARK*02=el documento de identidad fue robado
REMARK*03=actualmente reside fuera de colombia
REMARK*04=Ya ha sido victima de suplantaciones
REMARK*     "E" : ALERTAS EXTERNAS VARIABLES : UNA ENTIDAD PUEDE COLOCAR
REMARK*DIRECTAMENTE UNA ALERTA. EL SIGNIFICADO DE CADA UNA LAS
REMARK*DEBE COLOCAR DATACREDITO. CONTIENE REGISTRO HEADER (1)
REMARK*DATAHOST (2-10) Y TEXTO (11-XX)
REMARK*01=POR ASIGNAR
REMARK*02=POR ASIGNAR
REMARK*03=POR ASIGNAR
REMARK*04=POR ASIGNAR
REMARK*
REMARK******************************************************************
REMARK* RMB0002   * TIPALE: SE AMPLIA EL CONCEPTO DE ALERTAS, DE MODO QUE
REMARK* R.MARTINEZ* NO TENGAN QUE ESTAR EN EL ARCHIVO DE ALERTAS SINO QUE
REMARK* ABRIL/2006* SE PUEDAN GENERAR A PARTIR DE OTROS ARCHIVOS DE LA BD
REAMRK** SE DEFINEN LAS QUE APLICAN A UN PAS EN EL ICBSYS.INI
REMARK******************************************************************
REMARK* RMB0003   * CIU001: SE HABILTAN EL MANEJO DE DATAHOST Y SE AFINA
REMARK* R.MARTINEZ*EL CONCEPTO DEFINIENDO TIPO DE ALERTAS Y SU
REMARK* OCTUB/2006*RESPECTIVAS SECUENCIAS
REMARK**SE CONTROLA LA PRESENTACION DE ALERTAS SOLO
REAMRK**SI ESTAN HABILITADAS SEGUN TIPO DE CONSULTAS
REMARK******************************************************************
REMARK* RMB0004   * CIU002: AJUSTES NECESARIOS PARA CATALOGAR EN PRODUC-
REMARK* R.MARTINEZ*CION EL CONCEPTO DE ALERTAS POR TENER INFOR-
REMARK* MARZO/2007*MACION COMO CEDULA Y TAMBIN COMO NIT
REMARK******************************************************************
REMARK* RMB0005   * T7T501: MANEJO DE IDENTIFICACIONES QUE PASAN DE T7 A
REMARK* R.MARTINEZ*T5 CUANDO QUEDA UNA HUELLA DE CONSULTA. SE
REMARK* AGOS./2007*CREAN 2 ALERTAS: 6 -INDICA QUE NO HAY INFORMA
REMARK**CION EN BD DE VALIDACION Y 7-SI EL APELLIDO
REMARK**CON EL QUE SE VUELVE A CONSULTAR ES DIFERENTE
REMARK******************************************************************
REMARK* ABB0006   * ICGCPL: SE ADICIONA MANEJO DEL NUEVO PRODUCTO HC+  *"./copys/BDIIALE.PROC" [Read only] 606 lines, 44614 charactersREMARK******************************************************************
REMARK* ABB0006   * ICGCPL: SE ADICIONA MANEJO DEL NUEVO PRODUCTO HC+  *
REMARK* A.BERNAL  **
REMARK* SEPT./2009**
REMARK******************************************************************
* RMB0007     * INDE01 : SE MODIFICA LA ALARMA DE TENER INFO COMO*
* R.MARTINEZ  *TIPO 1 Y 2 A LA FIGURA DE INDEPENDIENTE *
* MAY/2013    *DONDE SE EXIGE ADICIONALMENTE QUE*
**COINCIDAN LOS NOMBRES PARA SACAR LA ALAR*
******************************************************************
* EHA0008     * INDE02 : SE INCLUYE ALERTA DE NO TEC CUANDO SE   *
* OCT/2013    * CQ.6807  CONSULTA UNA CEDULA POR PJ Y NO ES IND. *
******************************************************************
7000-RECORRER-BDIIALE.
REMARK******************************************************************
REMARK*7000-RECORRER-BDIIALE.
REMARK* PARA UNA IDENTIFICACION EN PARTICULAR SE REVISAN UNO A UNO LOS
REMARK* DIFERENTES TIPOS DE ALERTA QUE PUEDE TENER Y DE TENERLOS LOS EN-
REMARK* VIA A LA SECCION DE ALERTAS DEL INFORME. SOLO SE PRESENTAN LAS
REMARK* ALERTAS HABILITADAS PARA EL PAIS
REMARK******************************************************************MOVE 1 TO ENVIE.MOVE 0 TO CONT-LINEAS-BDIIALE.
CIU001     IF (ALEWEB-SYS = "SI" AND MOD-TAB = 0) ORRMB0003
CIU001(ALEDTH-SYS = "SI" AND MOD-TAB = 1 AND S-XML = 0) ORRMB0003
CIU001(ALEXML-SYS = "SI" AND MOD-TAB = 1 AND S-XML = 1)RMB0003
CIU001MOVE 1 TO IRMB0003
CIU001     ELSERMB0003
CIU001MOVE 40 TO IRMB0003
CIU001     END-IFRMB0003
CIU001     IF I = 1 AND MOD-TAB = 1 *> PARA DATHOST,XML,SERCEL ...RMB0003
CIU002AND  S-XML = 0RMB0004
CIU001MOVE SPACES TO INQ-COMANDO4RMB0003
CIU001UNSTRING MSG-ORIGINAL DELIMITED BY  ALL "[ALERTAS="RMB0003
CIU001INTO  INQ-FILLER INQ-COMANDO4RMB0003
CIU001IF INQ-COMANDO4(02:1) = "]"RMB0003
CIU001IF INQ-COMANDO4(1:1) NOT = "1"RMB0003
CIU001MOVE 40 TO IRMB0003
CIU001END-IFRMB0003
CIU001ELSERMB0003
CIU001MOVE 40 TO IRMB0003
CIU001END-IFRMB0003
CIU001     END-IF.RMB0003
CIU001     MOVE 1 TO ENVIE.RMB0003
CIU001     MOVE 0 TO CONT-LINEAS-BDIIALE.RMB0003
CIU001     PERFORM UNTIL I >= 40 OR V-ALERTA(I)=0RMB0003
CIU001EVALUATE V-ALERTA(I)RMB0003
TIPALEWHEN 1RMB0002
TIPALEPERFORM 7010-ALERTAS-BDIIALERMB0002TIPALEWHEN 1RMB0002
TIPALEPERFORM 7010-ALERTAS-BDIIALERMB0002
TIPALEWHEN 2RMB0002
TIPALEPERFORM 7020-ALERTAS-ICMCRERMB0002
TIPALEWHEN 3RMB0002
TIPALEPERFORM 7030-ALERTAS-ICMCHKRMB0002
TIPALEWHEN 4RMB0002
TIPALEPERFORM 7040-ALERTAS-DOBLE-IDENTIDADRMB0002
TIPALEWHEN 5RMB0002
TIPALEPERFORM 7050-ALERTAS-VIGENCIA-CEDRMB0002
T7T501WHEN 6RMB0005
T7T501IF FUE-UN-TIPO7 = 1RMB0005
T7T501PERFORM 7060-ALERTAS-NO-BDAIDERMB0005
T7T501END-IFRMB0005
T7T501WHEN 7RMB0005
T7T501IF FUE-UN-TIPO7 = 1RMB0005
T7T501PERFORM 7070-ALERTAS-APELLIDORMB0005
T7T501END-IFRMB0005
T7T501END-EVALUATERMB0005
TIPALEADD 1 TO IRMB0002
TIPALE     END-PERFORM.RMB0002
TIPALE     IF CONT-LINEAS-BDIIALE > 0RMB0002
TIPALEMOVE 1 TO RECRMB0002
TIPALEMOVE SPACESTO MOVIMIENTO-SRMB0002
TIPALEPERFORM 6700-CONT-CTARMB0002
T7T501MOVE 0 TO RECRMB0005
TIPALE     END-IF.RMB0002
TIPALE     IF ENVIE = 0RMB0002
TIPALEPERFORM 10900-ENVIA-CRCRRMB0002
TIPALE     END-IF.RMB0002

TIPALE 7010-ALERTAS-BDIIALE.RMB0002
REMARK*********************************************************************
REMARK*7010-ALERTAS-BDIIALE.
REMARK* SE RECORRE LAS POSIBLES ALERTAS PARA LA IDENTIFICACION BUSCADA,
REMARK* EXTRACTANDO LA INFORMACION DE "ENCABEZADO" , "CUERPO" y UN POSI
REMARK* DATAHOST QUE ESTA POR DEFINIR.
REMARK*********************************************************************IF ABIERTO-BDIIALE = 0OPEN INPUT  BDIIALEMOVE 1 TO ABIERTO-BDIIALEEND-IF.
MOVE TIP-IDE-AUX-BDIIALE TO TIP-IDE-BDIIALE.MOVE NUM-IDE-AUX-BDIIALE TO NUM-IDE-BDIIALE.MOVE ZEROS  TO FUENTE-BDIIALEMOVE SPACES TO LLASEC-BDIIALE.MOVE 0 TO FIN-BDIIALE.
TIPALE     MOVE 0 TO PROCESAR-BDIIALE.RMB0002START BDIIALE KEY > LLAVE-BDIIALEREMARK******************************************************************
REMARK* ABB0006   * ICGCPL: SE ADICIONA MANEJO DEL NUEVO PRODUCTO HC+  *
REMARK* A.BERNAL  **
REMARK* SEPT./2009**
REMARK******************************************************************
* RMB0007     * INDE01 : SE MODIFICA LA ALARMA DE TENER INFO COMO*
* R.MARTINEZ  *TIPO 1 Y 2 A LA FIGURA DE INDEPENDIENTE *
* MAY/2013    *DONDE SE EXIGE ADICIONALMENTE QUE*
**COINCIDAN LOS NOMBRES PARA SACAR LA ALAR*
******************************************************************
* EHA0008     * INDE02 : SE INCLUYE ALERTA DE NO TEC CUANDO SE   *
* OCT/2013    * CQ.6807  CONSULTA UNA CEDULA POR PJ Y NO ES IND. *
******************************************************************
7000-RECORRER-BDIIALE.
REMARK******************************************************************
REMARK*7000-RECORRER-BDIIALE.
REMARK* PARA UNA IDENTIFICACION EN PARTICULAR SE REVISAN UNO A UNO LOS
REMARK* DIFERENTES TIPOS DE ALERTA QUE PUEDE TENER Y DE TENERLOS LOS EN-
REMARK* VIA A LA SECCION DE ALERTAS DEL INFORME. SOLO SE PRESENTAN LAS
REMARK* ALERTAS HABILITADAS PARA EL PAIS
REMARK******************************************************************MOVE 1 TO ENVIE.MOVE 0 TO CONT-LINEAS-BDIIALE.
CIU001     IF (ALEWEB-SYS = "SI" AND MOD-TAB = 0) ORRMB0003
CIU001(ALEDTH-SYS = "SI" AND MOD-TAB = 1 AND S-XML = 0) ORRMB0003
CIU001(ALEXML-SYS = "SI" AND MOD-TAB = 1 AND S-XML = 1)RMB0003
CIU001MOVE 1 TO IRMB0003
CIU001     ELSERMB0003
CIU001MOVE 40 TO IRMB0003
CIU001     END-IFRMB0003
CIU001     IF I = 1 AND MOD-TAB = 1 *> PARA DATHOST,XML,SERCEL ...RMB0003
CIU002AND  S-XML = 0RMB0004
CIU001MOVE SPACES TO INQ-COMANDO4RMB0003
CIU001UNSTRING MSG-ORIGINAL DELIMITED BY  ALL "[ALERTAS="RMB0003
CIU001INTO  INQ-FILLER INQ-COMANDO4RMB0003
CIU001IF INQ-COMANDO4(02:1) = "]"RMB0003
CIU001IF INQ-COMANDO4(1:1) NOT = "1"RMB0003
CIU001MOVE 40 TO IRMB0003
CIU001END-IFRMB0003
CIU001ELSERMB0003
CIU001MOVE 40 TO IRMB0003
CIU001END-IFRMB0003
CIU001     END-IF.RMB0003
CIU001     MOVE 1 TO ENVIE.RMB0003
CIU001     MOVE 0 TO CONT-LINEAS-BDIIALE.RMB0003
CIU001     PERFORM UNTIL I >= 40 OR V-ALERTA(I)=0RMB0003
CIU001EVALUATE V-ALERTA(I)RMB0003
TIPALEWHEN 1RMB0002
TIPALEPERFORM 7010-ALERTAS-BDIIALERMB0002TIPALEWHEN 1RMB0002
TIPALEPERFORM 7010-ALERTAS-BDIIALERMB0002
TIPALEWHEN 2RMB0002
TIPALEPERFORM 7020-ALERTAS-ICMCRERMB0002
TIPALEWHEN 3RMB0002
TIPALEPERFORM 7030-ALERTAS-ICMCHKRMB0002
TIPALEWHEN 4RMB0002
TIPALEPERFORM 7040-ALERTAS-DOBLE-IDENTIDADRMB0002
TIPALEWHEN 5RMB0002
TIPALEPERFORM 7050-ALERTAS-VIGENCIA-CEDRMB0002
T7T501WHEN 6RMB0005
T7T501IF FUE-UN-TIPO7 = 1RMB0005
T7T501PERFORM 7060-ALERTAS-NO-BDAIDERMB0005
T7T501END-IFRMB0005
T7T501WHEN 7RMB0005
T7T501IF FUE-UN-TIPO7 = 1RMB0005
T7T501PERFORM 7070-ALERTAS-APELLIDORMB0005
T7T501END-IFRMB0005
T7T501END-EVALUATERMB0005
TIPALEADD 1 TO IRMB0002
TIPALE     END-PERFORM.RMB0002
TIPALE     IF CONT-LINEAS-BDIIALE > 0RMB0002
TIPALEMOVE 1 TO RECRMB0002
TIPALEMOVE SPACESTO MOVIMIENTO-SRMB0002
TIPALEPERFORM 6700-CONT-CTARMB0002
T7T501MOVE 0 TO RECRMB0005
TIPALE     END-IF.RMB0002
TIPALE     IF ENVIE = 0RMB0002
TIPALEPERFORM 10900-ENVIA-CRCRRMB0002
TIPALE     END-IF.RMB0002

TIPALE 7010-ALERTAS-BDIIALE.RMB0002
REMARK*********************************************************************
REMARK*7010-ALERTAS-BDIIALE.
REMARK* SE RECORRE LAS POSIBLES ALERTAS PARA LA IDENTIFICACION BUSCADA,
REMARK* EXTRACTANDO LA INFORMACION DE "ENCABEZADO" , "CUERPO" y UN POSI
REMARK* DATAHOST QUE ESTA POR DEFINIR.
REMARK*********************************************************************IF ABIERTO-BDIIALE = 0OPEN INPUT  BDIIALEMOVE 1 TO ABIERTO-BDIIALEEND-IF.
MOVE TIP-IDE-AUX-BDIIALE TO TIP-IDE-BDIIALE.MOVE NUM-IDE-AUX-BDIIALE TO NUM-IDE-BDIIALE.MOVE ZEROS  TO FUENTE-BDIIALEMOVE SPACES TO LLASEC-BDIIALE.MOVE 0 TO FIN-BDIIALE.
TIPALE     MOVE 0 TO PROCESAR-BDIIALE.RMB0002START BDIIALE KEY > LLAVE-BDIIALETIPALE     MOVE 0 TO PROCESAR-BDIIALE.RMB0002START BDIIALE KEY > LLAVE-BDIIALEINVALID KEY
MOVE 1 TO FIN-BDIIALENOT INVALID KEY
READ BDIIALE   NEXT RECORD
AT END
MOVE 1 TO FIN-BDIIALEEND-READEND-START.
PERFORM UNTIL FIN-BDIIALE = 1 OR NUM-IDE-BDIIALE NOT =
NUM-IDE-AUX-BDIIALE OR
TIP-IDE-BDIIALE NOT =
TIP-IDE-AUX-BDIIALE
CIU001MOVE 1 TO PROCESAR-BDIIALERMB0003
CIU001PERFORM 7100-PROCESE-HEADER-BDIIALERMB0003
CIU001IF PROCESAR-BDIIALE = 1RMB0003
CIU001MOVE "E"TO TIPALE-AUX-BDIIALERMB0003
CIU001MOVE COD-ALERTA-BDIIALE TO CODALE-AUX-BDIIALERMB0003
CIU001IF MOD-TAB = 0RMB0003
CIU001PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0003
CIU001ELSERMB0003
CIU001PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0003
CIU001END-IFRMB0003
CIU001END-IFRMB0003READ BDIIALE   NEXT RECORDAT END
MOVE 1 TO FIN-BDIIALEEND-READ
END-PERFORM.
TIPALE 7020-ALERTAS-ICMCRE.RMB0002
REMARK***********************************************************************
REMARK*7020-ALERTAS-ICMCRE.
REMARK* SE BUSCAN LAS ALERTAS QUE SE GENERAN SOBRE EL ARCHIVO DE CARTERA
REMARK* AL NO MOSTRAR UNA CUENTA MOROSA POR FALTA DE AUTORIZACIN
REMARK***********************************************************************
TIPALE     INITIALIZE LLAVE-MAES-CREDIT.RMB0002
TIPALE     MOVE TIP-ID     TO TIPO-ID-ABD07RMB0002
TIPALE     MOVE NUM-ID     TO NUM-ID-ABD07.RMB0002
TIPALE     MOVE 0 TO FIN-CREDIT.RMB0002
TIPALE     START MAESTRO-CREDIT KEY > LLAVE-MAES-CREDITRMB0002
TIPALEINVALID KEY MOVE 1 TO FIN-CREDITRMB0002
TIPALENOT INVALID KEYRMB0002
TIPALEREAD MAESTRO-CREDIT NEXT RECORD AT ENDRMB0002
TIPALEMOVE 1 TO FIN-CREDITRMB0002
TIPALEEND-READRMB0002
TIPALE     END-START.RMB0002
TIPALE     PERFORM UNTIL TIP-ID NOT = TIPO-ID-ABD07RMB0002
TIPALEOR NUM-ID NOT = NUM-ID-ABD07 OR FIN-CREDIT  = 1RMB0002TIPALE     PERFORM UNTIL TIP-ID NOT = TIPO-ID-ABD07RMB0002
TIPALEOR NUM-ID NOT = NUM-ID-ABD07 OR FIN-CREDIT  = 1RMB0002
TIPALEIF IND-BLOQUEO-ABD07 = PAR-CODBLOALER ANDRMB0002
TIPALE(NOV-REPORT-ABD07 > 16 AND < 42    ORRMB0002
TIPALE(NOV-REPORT-ABD07 = 45 OR 47))RMB0002
TIPALEMOVE COD-SUS-ABD07 TO FUENTE-BDIIALERMB0002
TIPALEMOVE 0TO BLOQUEO-BDIIALERMB0002
TIPALEMOVE 1TO PROCESAR-BDIIALERMB0002
CIU001MOVE FUNCTION CURRENT-DATE(1:8) TO FEC-VEN-BDIIALE     RMB0003
TIPALEMOVE FEC-NOVEDAD-ABD07 TO FECHA-AUX-SCORMB0002
TIPALEMOVE FECHA-AUX-SCO(1:2) TO MES-NOVRMB0002
TIPALEMOVE FECHA-AUX-SCO(3:2) TO ANO-NOVRMB0002
TIPALEIF ANO-NOV < 50RMB0002
TIPALEMOVE 20TO SIG-NOVRMB0002
TIPALEELSERMB0002
TIPALEMOVE 19TO SIG-NOVRMB0002
TIPALEEND-IFRMB0002
CIU001MOVE 00000001 TO FEC-NOV-BDIIALERMB0003
CIU001FEC-REP-BDIIALERMB0003
CIU001MOVE FECHA-NOVEDAD07(1:6) TO FEC-NOV-BDIIALE(1:6)RMB0003
CIU001MOVE FECHA-NOVEDAD07(1:6) TO FEC-REP-BDIIALE(1:6)RMB0003
CIU001MOVE SPACESTO INF-DATAHOST-BDIIALERMB0003
TIPALEPERFORM 7100-PROCESE-HEADER-BDIIALERMB0002
TIPALEIF PROCESAR-BDIIALE = 1RMB0002
CIU001MOVE PAR-MSGBLOALER TO TEXTO1-AUX-BDIIALERMB0003
CIU001MOVE SPACESTO TEXTO2-AUX-BDIIALERMB0003
CIU001IF MOD-TAB = 0RMB0003
CIU001PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0003
CIU001ELSERMB0003
CIU001MOVE "I" TO TIPALE-AUX-BDIIALERMB0003
CIU001MOVE  2  TO CODALE-AUX-BDIIALERMB0003
CIU001PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0003
CIU001END-IFRMB0003
TIPALEEND-IFRMB0002
TIPALEEND-IFRMB0002
TIPALEREAD MAESTRO-CREDIT  NEXT RECORD AT ENDRMB0002
TIPALEMOVE 1 TO FIN-CREDITRMB0002
TIPALEEND-READRMB0002
TIPALE     END-PERFORM.RMB0002

TIPALE 7030-ALERTAS-ICMCHK.RMB0002
REMARK******************************************************************
REMARK*7030-ALERTAS-ICMCHK.
REMARK* SE BUSCAN LAS ALERTAS QUE SE GENERAN SOBRE EL ARCHIVO DE CUENTAS
REMARK* CORRIENTES CUANDO NO SE MUESTRAN CUENTAS POR FALTA DE AUTORIZACION
REMARK******************************************************************
TIPALE     INITIALIZE LLAVE-MAES-CHECKRMB0002
TIPALE     MOVE TIP-ID     TO TIPO-ID-ABD06RMB0002
TIPALE     MOVE NUM-ID     TO NUM-ID-ABD06.RMB0002TIPALE     MOVE TIP-ID     TO TIPO-ID-ABD06RMB0002
TIPALE     MOVE NUM-ID     TO NUM-ID-ABD06.RMB0002
TIPALE     MOVE 0 TO FIN-CHECKRMB0002
TIPALE     START MAESTRO-CHECK  KEY > LLAVE-MAES-CHECKRMB0002
TIPALEINVALID KEY MOVE 1 TO FIN-CHECKRMB0002
TIPALENOT INVALID KEYRMB0002
TIPALEREAD MAESTRO-CHECK  NEXT RECORD AT ENDRMB0002
TIPALEMOVE 1 TO FIN-CHECKRMB0002
TIPALEEND-READRMB0002
TIPALE     END-START.RMB0002
TIPALE     PERFORM UNTIL TIP-ID NOT = TIPO-ID-ABD06RMB0002
TIPALEOR NUM-ID NOT = NUM-ID-ABD06 OR FIN-CHECK   = 1RMB0002
TIPALEIF IND-BLOQUEO-ABD06 = PAR-CODBLOALERRMB0002
TIPALEMOVE COD-SUS-ABD06 TO FUENTE-BDIIALERMB0002
TIPALEMOVE 0TO BLOQUEO-BDIIALERMB0002
TIPALEMOVE 1TO PROCESAR-BDIIALERMB0002
CIU001MOVE FUNCTION CURRENT-DATE(1:8) TO FEC-VEN-BDIIALE     RMB0003
TIPALEMOVE FEC-NOVEDAD-ABD06 TO FECHA-AUX-SCORMB0002
TIPALEMOVE FECHA-AUX-SCO(1:2) TO MES-NOVRMB0002
TIPALEMOVE FECHA-AUX-SCO(3:2) TO ANO-NOVRMB0002
TIPALEIF ANO-NOV < 50RMB0002
TIPALEMOVE 20TO SIG-NOVRMB0002
TIPALEELSERMB0002
TIPALEMOVE 19TO SIG-NOVRMB0002
TIPALEEND-IFRMB0002
CIU001MOVE 00000001 TO FEC-NOV-BDIIALERMB0003
CIU001FEC-REP-BDIIALERMB0003
CIU001MOVE FECHA-NOVEDAD07(1:6) TO FEC-NOV-BDIIALE(1:6)RMB0003
CIU001MOVE FECHA-NOVEDAD07(1:6) TO FEC-REP-BDIIALE(1:6)RMB0003
CIU001MOVE SPACESTO INF-DATAHOST-BDIIALERMB0003
TIPALEPERFORM 7100-PROCESE-HEADER-BDIIALERMB0002
TIPALEIF PROCESAR-BDIIALE = 1RMB0002
CIU001MOVE PAR-MSGBLOALER TO TEXTO1-AUX-BDIIALERMB0003
CIU001MOVE SPACESTO TEXTO2-AUX-BDIIALERMB0003
CIU001IF MOD-TAB = 0RMB0003
CIU001PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0003
CIU001ELSERMB0003
CIU001MOVE "I" TO TIPALE-AUX-BDIIALERMB0003
CIU001MOVE  3  TO CODALE-AUX-BDIIALERMB0003
CIU001PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0003
CIU001END-IFRMB0003
TIPALEEND-IFRMB0002
TIPALEEND-IFRMB0002
TIPALEREAD MAESTRO-CHECK   NEXT RECORD AT ENDRMB0002
TIPALEMOVE 1 TO FIN-CHECKRMB0002
TIPALEEND-READRMB0002
TIPALE     END-PERFORM.RMB0002

TIPALE 7040-ALERTAS-DOBLE-IDENTIDAD.RMB0002
TIPALE 7040-ALERTAS-DOBLE-IDENTIDAD.RMB0002
REMARK******************************************************************
REMARK*7040-ALERTAS-DOBLE-IDENTIDAD.
REMARK* SE BUSCA SI SE DEBE GENERAR LA ALERTA INFORMANDO QUE TIENE INFOR-
REMARK* MACION CONO CEDULA Y COMO NIT
REMARK******************************************************************
TIPALE     MOVE TIP-ID TO JRMB0002
TIPALE     IF TIP-ID = 1RMB0002
INDE02IF MIRO-SIES-INDEPENDIENTE-BDIIALE = 1EHA0008
INDE01MOVERMB0004
INDE01"EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR"  RMB0007
INDE01TO TEXTO1-AUX-BDIIALERMB0004
INDE01MOVERMB0007
INDE01" CON ESTABLECIMIENTO DE COMERCIO" TO     RMB0007
INDE01TEXTO2-AUX-BDIIALERMB0007
INDE01ELSERMB0007
INDE01MOVERMB0004
INDE01"LA CEDULA TIENE HISTORIA DE CREDITO COMO NIT" TO     RMB0007
INDE01TEXTO1-AUX-BDIIALERMB0004
INDE01MOVE SPACESTO TEXTO2-AUX-BDIIALERMB0007
INDE01END-IFRMB0007
TIPALEMOVE 2 TO TIP-IDRMB0002
TIPALE     ELSERMB0002
TIPALEIF TIP-ID = 2RMB0002
INDE01IF MIRO-SIES-INDEPENDIENTE-BDIIALE = 1RMB0007
INDE01MOVERMB0002
INDE01"EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR"  RMB0007
INDE01TO TEXTO1-AUX-BDIIALERMB0004
INDE01MOVERMB0007
INDE01" CON ESTABLECIMIENTO DE COMERCIO" TO     RMB0007
INDE01TEXTO2-AUX-BDIIALERMB0007
INDE01ELSERMB0007
INDE02IF NUM-ID < 99999999 AND HAY-PERMISO-BDINDE = "S"    EHA0008
INDE02AND PRODUCTOS-DATAC = 60EHA0008
INDE02MOVEEHA0008
INDE02"EL CLIENTE NO TIENE ACTIVIDAD REGISTRADA COMO    "  EHA0008
INDE02TO TEXTO1-AUX-BDIIALEEHA0008
INDE02MOVEEHA0008
INDE02"TITULAR CON ESTABLECIMIENTO DE COMERCIO     " TO    EHA0008
INDE02TEXTO2-AUX-BDIIALEEHA0008
INDE02MOVE 0 TO MENS-ERREHA0008
INDE02ELSEEHA0008
INDE01MOVERMB0002
INDE01"EL NIT TIENE HISTORIA DE CREDITO COMO CEDULA" TO   RMB0007
INDE01TEXTO1-AUX-BDIIALERMB0004
INDE01MOVE SPACESTO TEXTO2-AUX-BDIIALERMB0007
INDE02END-IFEHA0008
INDE01END-IFRMB0007INDE02END-IFEHA0008
INDE01END-IFRMB0007
TIPALEMOVE 1 TO TIP-IDRMB0002
CIU002ELSERMB0004
CIU002MOVE 1 TO MENS-ERRRMB0004
TIPALEEND-IFRMB0002
TIPALE     END-IFRMB0002
INDE01     IF MENS-ERR = 0
INDE01IF MIRO-SIES-INDEPENDIENTE-BDIIALE = 0 *> NO BUSCO ANTES  RMB0007
INDE01PERFORM 2420-VERSITIENECTASRMB0007
INDE01ELSERMB0007
INDE01IF ES-INDEPENDIENTE-BDIIALE = 0 *> BUSCO Y NO ESRMB0007
INDE01MOVE 1 TO MENS-ERRRMB0007
INDE01END-IFRMB0007
INDE01END-IF
CIU002     END-IFRMB0004
CIU001     IF MENS-ERR = 0RMB0003
CIU001MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-NOV-AUX-BDIIALE  RMB0003
CIU002*MOVE "B.D DATACREDITO" TO NOMFUE-LIN1-BDIIALERMB0004
CIU002MOVE "DATACREDITO    " TO NOMFUE1-AUX-BDIIALERMB0004
CIU002*MOVE SPACESTO NOMFUE-LIN2-BDIIALERMB0004
CIU002MOVE SPACESTO NOMFUE2-AUX-BDIIALERMB0004
CIU002MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-NOV-AUX-BDIIALE  RMB0004
CIU001MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-VEN-AUX-BDIIALE  RMB0003
CIU001MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-REP-AUX-BDIIALE  RMB0003
CIU001MOVE 990001TO FUENTE-AUX-BDIIALERMB0003
XXXXXXIF MIRO-SIES-INDEPENDIENTE-BDIIALE = 1RMB0007
XXXXXXMOVE 000001TO FUENTE-AUX-BDIIALE *> CAMARA  RMB0007
XXXXXXEND-IFRMB0007
CIU001MOVE SPACESTO INF-DATAHOST-AUX-BDIIALERMB0003
CIU001IF MOD-TAB = 0RMB0003
CIU001PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0003
CIU001ELSERMB0003
CIU001MOVE "I" TO TIPALE-AUX-BDIIALERMB0003
CIU001MOVE  4  TO CODALE-AUX-BDIIALERMB0003
INDE02IF NUM-ID < 99999999 AND HAY-PERMISO-BDINDE = "S"EHA0008
INDE02AND PRODUCTOS-DATAC = 60 ANDEHA0008
INDE02MIRO-SIES-INDEPENDIENTE-BDIIALE = 0EHA0008
INDE02MOVE  8  TO CODALE-AUX-BDIIALEEHA0008
INDE02MOVE 000001 TO FUENTE-AUX-BDIIALE *> CAMARAEHA0008
INDE02END-IFEHA0008
INDE02*IF PAR-NHDC-BDIIALE <> 0 ANDEHA0008
INDE02*(ES-INDEPENDIENTE-BDIIALE = 1 OREHA0008
INDE02*PAR-TEC-BDIIALE = 1)EHA0008
INDE02*MOVE 8 TO CODALE-AUX-BDIIALEEHA0008
INDE02*END-IFEHA0008
CIU001PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0003
CIU001END-IFRMB0003
TIPALE     END-IF.RMB0002CIU001END-IFRMB0003
TIPALE     END-IF.RMB0002
TIPALE     MOVE 0 TO MENS-ERR.RMB0002
TIPALE     MOVE J TO TIP-ID.RMB00027050-ALERTAS-VIGENCIA-CED.
REMARK******************************************************************
REMARK*7050-ALERTAS-VIGENCIA-CED.
REMARK* SE GENERA ALERTA SI EL ESTADO DE VIGENCIA DE LA CEDULA COLOMBIANA
REAMRK* ES 12, LO QUE CORRESPONDE A LA PERDIDA DE DERECHOS POLITICOS
REMARK******************************************************************
TIPALE     IF TIP-ID = 1RMB0002
TIPALEIF ESTADO-VIG-BDIIREGI = 12RMB0002
CIU001MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-NOV-AUX-BDIIALE RMB0003
CIU001MOVE "B.D DATACREDITO" TO NOMFUE1-AUX-BDIIALERMB0003
CIU001MOVE SPACESTO NOMFUE2-AUX-BDIIALERMB0003
CIU001MOVE "REVISE VIGENCIA EN REGISTRADURIA NACIONAL" TORMB0003
CIU001TEXTO1-AUX-BDIIALERMB0003
CIU001MOVE SPACESTO TEXTO2-AUX-BDIIALERMB0003
CIU001MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-VEN-AUX-BDIIALE RMB0003
CUI001MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-REP-AUX-BDIIALE RMB0003
CIU001MOVE 990001TO FUENTE-AUX-BDIIALERMB0003
CIU001MOVE SPACESTO INF-DATAHOST-AUX-BDIIALE    RMB0003
CIU001IF MOD-TAB = 0RMB0003
CIU001PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0003
CIU001ELSERMB0003
CIU001MOVE "I" TO TIPALE-AUX-BDIIALERMB0003
CIU001MOVE  5  TO CODALE-AUX-BDIIALERMB0003
CIU001PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0003
CIU001END-IFRMB0003
TIPALEEND-IFRMB0002
TIPALE     END-IF.RMB0002
T7T501 7060-ALERTAS-NO-BDAIDE.RMB0005
REMARK******************************************************************
REMARK*7060-ALERTAS-NOREGISTRADURIA.
REMARK* SE GENERA ALERTA SI ES UN TIPO 7 CON CONSULTAS
REMARK******************************************************************
T7T501     EVALUATE TIP-IDRMB0005
T7T501WHEN 1RMB0005
T7T501MOVE "SIN INFORMACION EN ARCHIVO DE CEDULAS    " TORMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501WHEN 2RMB0005
T7T501MOVE "SIN INFORMACION EN ARCHIVO DE NITS" TORMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501WHEN 3RMB0005
T7T501MOVE "SIN INFORMACION EN ARCHIVO DE NITS" TORMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501WHEN 4RMB0005
T7T501MOVE "SIN INFORMACION EN ARCHIVO DE EXTRANJEROS" TORMB0005T7T501WHEN 4RMB0005
T7T501MOVE "SIN INFORMACION EN ARCHIVO DE EXTRANJEROS" TORMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501     END-EVALUATERMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-NOV-AUX-BDIIALE     RMB0005
T7T501     MOVE "B.D DATACREDITO" TO NOMFUE1-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO NOMFUE2-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO TEXTO2-AUX-BDIIALERMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-VEN-AUX-BDIIALE     RMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-REP-AUX-BDIIALE     RMB0005
T7T501     MOVE 990001TO FUENTE-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO INF-DATAHOST-AUX-BDIIALERMB0005
T7T501     IF MOD-TAB = 0RMB0005
T7T501PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0005
T7T501     ELSERMB0005
T7T501MOVE "I" TO TIPALE-AUX-BDIIALERMB0005
T7T501MOVE  6  TO CODALE-AUX-BDIIALERMB0005
T7T501PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0005
T7T501     END-IF.RMB0005
T7T501 7070-ALERTAS-APELLIDO.RMB0005
REMARK******************************************************************
REMARK*7070-ALERTAS-APELLIDO.
REMARK* SE GENERA ALERTA SI PARA TIPO 7 CON CONSULTAS EL APELLIDO ES
REAMRK* DIFERENTE
REMARK******************************************************************
T7T501     MOVE 1 TO J.RMB0005
T7T501     PERFORM UNTIL J > TOT-CON OR J > 100RMB0005
T7T501MOVE V-CONSULTAS(J) TO REG-INDEXRMB0005
T7T501IF NOMBRE-COMPLETO <> APELLIDO-IND ANDRMB0005
T7T501NOMBRE-COMPLETO <> SPACES AND APELLIDO-IND <> SPACES   RMB0005
T7T501MOVE FEC-CONSUL-IND TO FECHA-RMBRMB0005
T7T501MOVE DIA-RMB TO DIA-AUXRMB0005
T7T501MOVE MES-RMB TO MES-AUXRMB0005
T7T501MOVE ANO-RMB TO ANO-AUXRMB0005
T7T501IF ANO-RMB < 95RMB0005
T7T501ADD  2000 TO ANO-AUXRMB0005
T7T501ELSERMB0005
T7T501ADD  1900 TO ANO-AUXRMB0005
T7T501END-IFRMB0005
T7T501MOVE FECHA-AUX  TO FECHA-NOV-AUX-BDIIALERMB0005
T7T501MOVE "B.D DATACREDITO" TO NOMFUE1-AUX-BDIIALERMB0005
T7T501MOVE SPACESTO NOMFUE2-AUX-BDIIALERMB0005
T7T501MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-VEN-AUX-BDIIALE RMB0005
T7T501MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-REP-AUX-BDIIALE RMB0005
T7T501MOVE 990001TO FUENTE-AUX-BDIIALERMB0005
T7T501MOVE SPACESTO INF-DATAHOST-AUX-BDIIALE    RMB0005
T7T501MOVE COD-SUSCRIP-IND TO COD-SUSCRIP-ABD02RMB0005
T7T501READ SUSCRIPTOR IGNORE LOCK NOT INVALID KEYRMB0005
T7T501MOVE "CONSULTADO POR" TO   RMB0005T7T501READ SUSCRIPTOR IGNORE LOCK NOT INVALID KEYRMB0005
T7T501MOVE "CONSULTADO POR" TO   RMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501STRING NOM-COR1-ABD02 DELIMITED BY SIZERMB0005
T7T501" "DELIMITED BY SIZERMB0005
T7T501NOM-COR2-ABD02 DELIMITED BY SIZERMB0005
T7T501INTO TEXTO1-AUX-BDIIALE(18:32)RMB0005
T7T501MOVE "CON APELLIDO DIFERENTE:  " TORMB0005
T7T501TEXTO2-AUX-BDIIALE   RMB0005
T7T501MOVE APELLIDO-IND TO TEXTO2-AUX-BDIIALE(28:15)RMB0005
T7T501IF MOD-TAB = 0RMB0005
T7T501PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0005
T7T501ELSERMB0005
T7T501MOVE "I" TO TIPALE-AUX-BDIIALERMB0005
T7T501MOVE  7  TO CODALE-AUX-BDIIALERMB0005
T7T501PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0005
T7T501END-IFRMB0005
T7T501END-READRMB0005
T7T501END-IFRMB0005
T7T501ADD 1 TO JRMB0005
T7T501     END-PERFORM.RMB00057100-PROCESE-HEADER-BDIIALE.
REMARK******************************************************************
REMARK*7100-PROCESE-ENCABEZADO-BDIIALE.
REMARK* SE EXTRACTA LA INFORMACION DEL ENCABEZADO PARA SER COLOCADO
REMARK* EN LA SECCION DE ALERTAS.
REMARK******************************************************************MOVE FUENTE-BDIIALE TO COD-SUSCRIP-ABD02.READ SUSCRIPTOR IGNORE LOCKINVALID KEY
MOVE 0 TO PROCESAR-BDIIALENOT INVALID KEY
IF ESTADO-ABD02 = 1
PERFORM 7110-VENCIMIENTOS-BDIIALEELSE
MOVE 0 TO PROCESAR-BDIIALEEND-IFEND-READ.
7110-VENCIMIENTOS-BDIIALE.
REMARK******************************************************************
REMARK*7110-VENCIMIENTOS-BDIIALE.
REMARK* SE VERIFICA SI YA ES UNA LA ALERTA QUE HA CADUCADO PARA NO SACARLA
REMARK* MAS. O SI ESTA BLOQUEADA NO MOSTRARLA
REMARK******************************************************************
CIU001     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-AUX-BDIIALERMB0003IF FEC-VEN-BDIIALE <  FECHA-AUX-BDIIALE OR
CIU001BLOQUEO-BDIIALE > 0RMB0003
TIPALEMOVE 0 TO PROCESAR-BDIIALERMB0002T7T501WHEN 4RMB0005
T7T501MOVE "SIN INFORMACION EN ARCHIVO DE EXTRANJEROS" TORMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501     END-EVALUATERMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-NOV-AUX-BDIIALE     RMB0005
T7T501     MOVE "B.D DATACREDITO" TO NOMFUE1-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO NOMFUE2-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO TEXTO2-AUX-BDIIALERMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-VEN-AUX-BDIIALE     RMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-REP-AUX-BDIIALE     RMB0005
T7T501     MOVE 990001TO FUENTE-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO INF-DATAHOST-AUX-BDIIALERMB0005
T7T501     IF MOD-TAB = 0RMB0005
T7T501PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0005
T7T501     ELSERMB0005
T7T501MOVE "I" TO TIPALE-AUX-BDIIALERMB0005
T7T501MOVE  6  TO CODALE-AUX-BDIIALERMB0005
T7T501PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0005
T7T501     END-IF.RMB0005
T7T501 7070-ALERTAS-APELLIDO.RMB0005
REMARK******************************************************************
REMARK*7070-ALERTAS-APELLIDO.
REMARK* SE GENERA ALERTA SI PARA TIPO 7 CON CONSULTAS EL APELLIDO ES
REAMRK* DIFERENTE
REMARK******************************************************************
T7T501     MOVE 1 TO J.RMB0005
T7T501     PERFORM UNTIL J > TOT-CON OR J > 100RMB0005
T7T501MOVE V-CONSULTAS(J) TO REG-INDEXRMB0005
T7T501IF NOMBRE-COMPLETO <> APELLIDO-IND ANDRMB0005
T7T501NOMBRE-COMPLETO <> SPACES AND APELLIDO-IND <> SPACES   RMB0005
T7T501MOVE FEC-CONSUL-IND TO FECHA-RMBRMB0005
T7T501MOVE DIA-RMB TO DIA-AUXRMB0005
T7T501MOVE MES-RMB TO MES-AUXRMB0005
T7T501MOVE ANO-RMB TO ANO-AUXRMB0005
T7T501IF ANO-RMB < 95RMB0005
T7T501ADD  2000 TO ANO-AUXRMB0005
T7T501ELSERMB0005
T7T501ADD  1900 TO ANO-AUXRMB0005
T7T501END-IFRMB0005
T7T501MOVE FECHA-AUX  TO FECHA-NOV-AUX-BDIIALERMB0005
T7T501MOVE "B.D DATACREDITO" TO NOMFUE1-AUX-BDIIALERMB0005
T7T501MOVE SPACESTO NOMFUE2-AUX-BDIIALERMB0005
T7T501MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-VEN-AUX-BDIIALE RMB0005
T7T501MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-REP-AUX-BDIIALE RMB0005
T7T501MOVE 990001TO FUENTE-AUX-BDIIALERMB0005
T7T501MOVE SPACESTO INF-DATAHOST-AUX-BDIIALE    RMB0005
T7T501MOVE COD-SUSCRIP-IND TO COD-SUSCRIP-ABD02RMB0005
T7T501READ SUSCRIPTOR IGNORE LOCK NOT INVALID KEYRMB0005
T7T501MOVE "CONSULTADO POR" TO   RMB0005T7T501READ SUSCRIPTOR IGNORE LOCK NOT INVALID KEYRMB0005
T7T501MOVE "CONSULTADO POR" TO   RMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501STRING NOM-COR1-ABD02 DELIMITED BY SIZERMB0005
T7T501" "DELIMITED BY SIZERMB0005
T7T501NOM-COR2-ABD02 DELIMITED BY SIZERMB0005
T7T501INTO TEXTO1-AUX-BDIIALE(18:32)RMB0005
T7T501MOVE "CON APELLIDO DIFERENTE:  " TORMB0005
T7T501TEXTO2-AUX-BDIIALE   RMB0005
T7T501MOVE APELLIDO-IND TO TEXTO2-AUX-BDIIALE(28:15)RMB0005
T7T501IF MOD-TAB = 0RMB0005
T7T501PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0005
T7T501ELSERMB0005
T7T501MOVE "I" TO TIPALE-AUX-BDIIALERMB0005
T7T501MOVE  7  TO CODALE-AUX-BDIIALERMB0005
T7T501PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0005
T7T501END-IFRMB0005
T7T501END-READRMB0005
T7T501END-IFRMB0005
T7T501ADD 1 TO JRMB0005
T7T501     END-PERFORM.RMB00057100-PROCESE-HEADER-BDIIALE.
REMARK******************************************************************
REMARK*7100-PROCESE-ENCABEZADO-BDIIALE.
REMARK* SE EXTRACTA LA INFORMACION DEL ENCABEZADO PARA SER COLOCADO
REMARK* EN LA SECCION DE ALERTAS.
REMARK******************************************************************MOVE FUENTE-BDIIALE TO COD-SUSCRIP-ABD02.READ SUSCRIPTOR IGNORE LOCKINVALID KEY
MOVE 0 TO PROCESAR-BDIIALENOT INVALID KEY
IF ESTADO-ABD02 = 1
PERFORM 7110-VENCIMIENTOS-BDIIALEELSE
MOVE 0 TO PROCESAR-BDIIALEEND-IFEND-READ.
7110-VENCIMIENTOS-BDIIALE.
REMARK******************************************************************
REMARK*7110-VENCIMIENTOS-BDIIALE.
REMARK* SE VERIFICA SI YA ES UNA LA ALERTA QUE HA CADUCADO PARA NO SACARLA
REMARK* MAS. O SI ESTA BLOQUEADA NO MOSTRARLA
REMARK******************************************************************
CIU001     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-AUX-BDIIALERMB0003IF FEC-VEN-BDIIALE <  FECHA-AUX-BDIIALE OR
CIU001BLOQUEO-BDIIALE > 0RMB0003
TIPALEMOVE 0 TO PROCESAR-BDIIALERMB0002T7T501WHEN 4RMB0005
T7T501MOVE "SIN INFORMACION EN ARCHIVO DE EXTRANJEROS" TORMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501     END-EVALUATERMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-NOV-AUX-BDIIALE     RMB0005
T7T501     MOVE "B.D DATACREDITO" TO NOMFUE1-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO NOMFUE2-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO TEXTO2-AUX-BDIIALERMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-VEN-AUX-BDIIALE     RMB0005
T7T501     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-REP-AUX-BDIIALE     RMB0005
T7T501     MOVE 990001TO FUENTE-AUX-BDIIALERMB0005
T7T501     MOVE SPACESTO INF-DATAHOST-AUX-BDIIALERMB0005
T7T501     IF MOD-TAB = 0RMB0005
T7T501PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0005
T7T501     ELSERMB0005
T7T501MOVE "I" TO TIPALE-AUX-BDIIALERMB0005
T7T501MOVE  6  TO CODALE-AUX-BDIIALERMB0005
T7T501PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0005
T7T501     END-IF.RMB0005
T7T501 7070-ALERTAS-APELLIDO.RMB0005
REMARK******************************************************************
REMARK*7070-ALERTAS-APELLIDO.
REMARK* SE GENERA ALERTA SI PARA TIPO 7 CON CONSULTAS EL APELLIDO ES
REAMRK* DIFERENTE
REMARK******************************************************************
T7T501     MOVE 1 TO J.RMB0005
T7T501     PERFORM UNTIL J > TOT-CON OR J > 100RMB0005
T7T501MOVE V-CONSULTAS(J) TO REG-INDEXRMB0005
T7T501IF NOMBRE-COMPLETO <> APELLIDO-IND ANDRMB0005
T7T501NOMBRE-COMPLETO <> SPACES AND APELLIDO-IND <> SPACES   RMB0005
T7T501MOVE FEC-CONSUL-IND TO FECHA-RMBRMB0005
T7T501MOVE DIA-RMB TO DIA-AUXRMB0005
T7T501MOVE MES-RMB TO MES-AUXRMB0005
T7T501MOVE ANO-RMB TO ANO-AUXRMB0005
T7T501IF ANO-RMB < 95RMB0005
T7T501ADD  2000 TO ANO-AUXRMB0005
T7T501ELSERMB0005
T7T501ADD  1900 TO ANO-AUXRMB0005
T7T501END-IFRMB0005
T7T501MOVE FECHA-AUX  TO FECHA-NOV-AUX-BDIIALERMB0005
T7T501MOVE "B.D DATACREDITO" TO NOMFUE1-AUX-BDIIALERMB0005
T7T501MOVE SPACESTO NOMFUE2-AUX-BDIIALERMB0005
T7T501MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-VEN-AUX-BDIIALE RMB0005
T7T501MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-REP-AUX-BDIIALE RMB0005
T7T501MOVE 990001TO FUENTE-AUX-BDIIALERMB0005
T7T501MOVE SPACESTO INF-DATAHOST-AUX-BDIIALE    RMB0005
T7T501MOVE COD-SUSCRIP-IND TO COD-SUSCRIP-ABD02RMB0005
T7T501READ SUSCRIPTOR IGNORE LOCK NOT INVALID KEYRMB0005
T7T501MOVE "CONSULTADO POR" TO   RMB0005T7T501READ SUSCRIPTOR IGNORE LOCK NOT INVALID KEYRMB0005
T7T501MOVE "CONSULTADO POR" TO   RMB0005
T7T501TEXTO1-AUX-BDIIALERMB0005
T7T501STRING NOM-COR1-ABD02 DELIMITED BY SIZERMB0005
T7T501" "DELIMITED BY SIZERMB0005
T7T501NOM-COR2-ABD02 DELIMITED BY SIZERMB0005
T7T501INTO TEXTO1-AUX-BDIIALE(18:32)RMB0005
T7T501MOVE "CON APELLIDO DIFERENTE:  " TORMB0005
T7T501TEXTO2-AUX-BDIIALE   RMB0005
T7T501MOVE APELLIDO-IND TO TEXTO2-AUX-BDIIALE(28:15)RMB0005
T7T501IF MOD-TAB = 0RMB0005
T7T501PERFORM 7500-PROCESE-TEXTO-BDIIALERMB0005
T7T501ELSERMB0005
T7T501MOVE "I" TO TIPALE-AUX-BDIIALERMB0005
T7T501MOVE  7  TO CODALE-AUX-BDIIALERMB0005
T7T501PERFORM 7300-PROCESE-DATAHOST-BDIIALERMB0005
T7T501END-IFRMB0005
T7T501END-READRMB0005
T7T501END-IFRMB0005
T7T501ADD 1 TO JRMB0005
T7T501     END-PERFORM.RMB00057100-PROCESE-HEADER-BDIIALE.
REMARK******************************************************************
REMARK*7100-PROCESE-ENCABEZADO-BDIIALE.
REMARK* SE EXTRACTA LA INFORMACION DEL ENCABEZADO PARA SER COLOCADO
REMARK* EN LA SECCION DE ALERTAS.
REMARK******************************************************************MOVE FUENTE-BDIIALE TO COD-SUSCRIP-ABD02.READ SUSCRIPTOR IGNORE LOCKINVALID KEY
MOVE 0 TO PROCESAR-BDIIALENOT INVALID KEY
IF ESTADO-ABD02 = 1
PERFORM 7110-VENCIMIENTOS-BDIIALEELSE
MOVE 0 TO PROCESAR-BDIIALEEND-IFEND-READ.
7110-VENCIMIENTOS-BDIIALE.
REMARK******************************************************************
REMARK*7110-VENCIMIENTOS-BDIIALE.
REMARK* SE VERIFICA SI YA ES UNA LA ALERTA QUE HA CADUCADO PARA NO SACARLA
REMARK* MAS. O SI ESTA BLOQUEADA NO MOSTRARLA
REMARK******************************************************************
CIU001     MOVE FUNCTION CURRENT-DATE(1:8) TO FECHA-AUX-BDIIALERMB0003IF FEC-VEN-BDIIALE <  FECHA-AUX-BDIIALE OR
CIU001BLOQUEO-BDIIALE > 0RMB0003
TIPALEMOVE 0 TO PROCESAR-BDIIALERMB0002CIU001BLOQUEO-BDIIALE > 0RMB0003
TIPALEMOVE 0 TO PROCESAR-BDIIALERMB0002ELSE
CIU001MOVE FEC-NOV-BDIIALE TO FECHA-NOV-AUX-BDIIALERMB0003
CIU001MOVE FEC-VEN-BDIIALE TO FECHA-VEN-AUX-BDIIALERMB0003
CIU001MOVE FEC-REP-BDIIALE TO FECHA-REP-AUX-BDIIALERMB0003
CIU001MOVE FUENTE-BDIIALE  TO FUENTE-AUX-BDIIALERMB0003
CIU001MOVE NOM-COR1-ABD02  TO NOMFUE1-AUX-BDIIALERMB0003
CIU001MOVE NOM-COR2-ABD02  TO NOMFUE2-AUX-BDIIALERMB0003
CIU001MOVE LINEA1-BDIIALE  TO TEXTO1-AUX-BDIIALERMB0003
CIU001MOVE LINEA2-BDIIALE  TO TEXTO2-AUX-BDIIALERMB0003
CIU001MOVE INF-DATAHOST-BDIIALE TO INF-DATAHOST-AUX-BDIIALE     RMB0003END-IF.
7300-PROCESE-DATAHOST-BDIIALE.
REMARK******************************************************************
REMARK*7300-PROCESE-DATAHOST-BDIIALE.
REMARK*    EN ESTA RUTINA SE DEBE IR IMPLEMENTADO LOS DIFERENTES CASOS
REMARK*    QUE SE PUEDAN UTILIZAR EN EL FORMATO DATAHOST
REMARK******************************************************************
CIU001     IF S-XML = 0RMB0003
CIU001MOVE TIPALE-AUX-BDIIALE   TO DTH12-TIP-ALERTARMB0003
CIU001MOVE CODALE-AUX-BDIIALE   TO DTH12-COD-ALERTARMB0003
CIU001MOVE NOMFUE1-AUX-BDIIALE  TO DTH12-FUENTE1RMB0003
CIU001MOVE NOMFUE2-AUX-BDIIALE  TO DTH12-FUENTE2RMB0003
CIU001MOVE FECHA-NOV-AUX-BDIIALE   TO DTH12-FECHARMB0003
CIU001MOVE TEXTO1-AUX-BDIIALE    TO DTH12-LINEA1RMB0003
CIU001MOVE TEXTO2-AUX-BDIIALE    TO DTH12-LINEA2RMB0003
CIU001MOVE INF-DATAHOST-AUX-BDIIALE     TO DTH12-DATAHOSTRMB0003
CIU001MOVE DTHOST-12(1:80)TO MOVIMIENTO-SRMB0003
CIU001MOVE 1 TO RECRMB0003
CIU001PERFORM 6700-CONT-CTARMB0003
CIU001MOVE DTHOST-12(81:80)TO MOVIMIENTO-SRMB0003
CIU001     ELSERMB0003
ICGCPLIF INF-NHDCABB0006
ICGCPLPERFORM 7310-XML-18-NHDCABB0006
ICGCPLELSEABB0006
CIU001MOVE LLAVE-BDIIALETO XDTH12-LLAVERMB0003
CIU001MOVE FUENTE-AUX-BDIIALE   TO XDTH12-COD-FUENTERMB0003
CIU001MOVE NOMFUE1-AUX-BDIIALE  TO XDTH12-FUENTE1RMB0003
CIU001MOVE NOMFUE2-AUX-BDIIALE  TO XDTH12-FUENTE2RMB0003
CIU001MOVE 057TO XDTH12-PAISRMB0003
CIU001MOVE TIPALE-AUX-BDIIALE   TO XDTH12-TIP-ALERTARMB0003
CIU001MOVE CODALE-AUX-BDIIALE   TO XDTH12-COD-ALERTARMB0003
CIU001MOVE FECHA-NOV-AUX-BDIIALE   TO XDTH12-FECHARMB0003
CIU001MOVE FECHA-VEN-AUX-BDIIALE   TO XDTH12-FECHA-VENCRMB0003
CIU001MOVE FECHA-REP-AUX-BDIIALE   TO XDTH12-FECHA-MODIFRMB0003
CIU001MOVE TEXTO1-AUX-BDIIALETO XDTH12-LINEA1RMB0003
CIU001MOVE TEXTO2-AUX-BDIIALETO XDTH12-LINEA2RMB0003
CIU001MOVE INF-DATAHOST-AUX-BDIIALE     TO XDTH12-DATAHOSTRMB0003CIU001MOVE TEXTO2-AUX-BDIIALETO XDTH12-LINEA2RMB0003
CIU001MOVE INF-DATAHOST-AUX-BDIIALE     TO XDTH12-DATAHOSTRMB0003
CIU001MOVE 1 TO RECRMB0003
CIU001MOVE XDTHOST-12(1:80)  TO MOVIMIENTO-SRMB0003
CIU001PERFORM 6700-CONT-CTARMB0003
CIU001MOVE XDTHOST-12(81:80)  TO MOVIMIENTO-SRMB0003
CIU001MOVE 1 TO RECRMB0003
CIU001PERFORM 6700-CONT-CTARMB0003
CIU001MOVE XDTHOST-12(161:80)  TO MOVIMIENTO-SRMB0003
ICGCPLEND-IFABB0006
CIU001     END-IF.RMB0003
CIU001     MOVE 1 TO REC.RMB0003
CIU001     PERFORM 6700-CONT-CTARMB0003
CIU001     MOVE 0 TO REC.RMB0003
7500-PROCESE-TEXTO-BDIIALE.
REMARK******************************************************************
REMARK*7500-PROCESE-TEXTO-BDIIALE.
REMARK*  SE EXTRAE LA INFORMACION DEL "CUERPO" DE LA ALERTA PARA SER
REMARK*  INTEGRADA EN ESTA SECCION. LA INFORMACION ESTA COLOCADA EN UN
REMARK*  FORMATO LIBRE
REMARK******************************************************************ADD 1 TO CONT-LINEAS-BDIIALEIF CONT-LINEAS-BDIIALE = 1MOVE 4TO IND-CTAMOVE TITULOS-BDIIALE    TO PANTALLAPERFORM 10900-ENVIA-CRCREND-IF.
CIU001     MOVE NOMFUE1-AUX-BDIIALE TO NOMFUE-LIN1-BDIIALERMB0003
CIU001     MOVE NOMFUE2-AUX-BDIIALE TO NOMFUE-LIN2-BDIIALERMB0003
CIU001     MOVE FECHA-NOV-AUX-BDIIALE TO FEC-NOV-LIN1-BDIIALERMB0003
CIU001     MOVE TEXTO1-AUX-BDIIALE TO TEXTO-LIN1-BDIIALERMB0003
CIU001     MOVE TEXTO2-AUX-BDIIALE TO TEXTO-LIN2-BDIIALERMB0003
CIU001     MOVE LINEA1-BDIIALE-TIT TO MOVIMIENTO-SRMB0003MOVE 1 TO REC.PERFORM 6700-CONT-CTA
CIU001     IF NOMFUE-LIN2-BDIIALE <> SPACES ORRMB0003
CIU001TEXTO-LIN2-BDIIALE <> SPACESRMB0003
CIU001MOVE 1 TO RECRMB0003
CIU001MOVE LINEA2-BDIIALE-TIT TO MOVIMIENTO-SRMB0003
CIU001PERFORM 6700-CONT-CTARMB0003
CIU001     END-IF.RMB0003MOVE 0 TO REC.
~
~
~
~
~
~
~:qicdgd@codes /d/iccol/desarrollo
$ ^[  $ view ./copys/BDIIALE.PROC$ view ./copys/BDIIALE.FD  $ view ./copys/BDIIALE.FS$ view ./database/BDIIALE-ALERTAS$ find . -name "BDIIALE*" -print $ 
./objetos/BDIIALEDB2.int
./objetos/BDIIALEDB2.gnt
./objetos/BDIIALEDB2.idy
./objetos/BDIIALEDB2.s
./objetos/BDIIALEDB2.lst
./fuentes/BDIIALE.CBL
find: cannot read dir ./fuentes/especiales/darlas: Permission denied
./fuentes/BDIIALENEW.aif
./fuentes/BDIIALEDB2.CBL
./fuentes/BDIIALEDB2.aif
./fuentes/BDIIALEDB2.20140502.core
./copys/BDIIALE-ANT.PROC
./copys/BDIIALE.FD
./copys/BDIIALE.FS
./copys/BDIIALENW.PROC
./copys/BDIIALET7.PROC-DARIO
./copys/BDIIALE.PROC
./copys/ley/BDIIALE.FD
./copys/ley/BDIIALE.FS
./copys/ley/BDIIALE-LEY.PROC
./copys/ley/BDIIALE.PROC
./copys/ley/BDIIALET7.PROC-DARIO
./copys/ley/BDIIALE.WS
./copys/BDIIALEDB2.DOC
./copys/BDIIALEJURAD.WS
./copys/BDIIALENEW.PROC
./copys/BDIIALENEW.PROC.F-OLD!
./copys/BDIIALE.WS-V05
./copys/BDIIALE.WS
./copys/BDIIALE.PROC-V06
./copys/BDIIALE.PROC.20130913
./copys/BDIIALE-BDINDE.WS
./copys/BDIIALE-BDINDE-RGH.PROC
./copys/BDIIALEV07.PROC
./copys/BDIIALE-BDINDE.PROC-OLD-2013-10-31
./copys/BDIIALEV08.PROC.F-OLD!
./copys/BDIIALEV08.PROC
./copys/BDIIALEPR.PROC
./copys/BDIIALE-BDINDE.PROC-OK2
./copys/BDIIALE-BDINDE.PROC-OK1
./copys/BDIIALE-BDINDE.PROC
./copys/BDIIALEJURAD.PROC
./copys/AMNISTIA/BDIIALE.PROC
./copys/documentacion/BDIIALE.PROC
./copys/documentacion/BDIIALE.WS
./copys/documentacion/BDIIALE.FD
./copys/documentacion/BDIIALE.FS
./copys/documentacion/BDIIALE-BDINDE.WS
./copys/documentacion/BDIIALE-BDINDE.PROC
./copys/BDIIALEDB2.WS
./copys/BDIIALEDB2.PROC.ORI
./copys/BDIIALEDB2.PROC
./copys/BDIIALENEW.WS
./copys/BDIIALE-PLANO.FS
./copys/BDIIALE-PLANO.FD
find: cannot read dir ./stt: Permission denied
find: cannot read dir ./sf/.sunw: Permission denied
./database/desnovedat/BDIIALE
./database/desnovedat/BDIIALE.idx
./database/prunovedat/BDIIALE
./database/prunovedat/BDIIALE-ALEGRU
./database/prunovedat/BDIIALE-ALERTAS
./database/prunovedat/BDIIALE-GRUPOS
./database/prunovedat/BDIIALE-LOG-20140430
./database/prunovedat/BDIIALE-LOG-20140506
./database/prunovedat/BDIIALE-NEW
./database/prunovedat/BDIIALE-NEW.idx
./database/prunovedat/BDIIALE.err
./database/prunovedat/BDIIALE-ORI
./database/prunovedat/BDIIALE-ORI.idx
./database/prunovedat/BDIIALE.idx
./database/prunovedat/BDIIALE-LOG-20140509
./database/BDIIALE
./database/BDIIALE.idx
./database/documentacion/BDIIALE
./database/documentacion/BDIIALE.idx
./database/BDIIALE-ALERTAS
./database/BDIIALE-GRUPOS
./database/BDIIALE-ALEGRU
./database/BDIIALE_20140414
./database/BDIIALE_20140502
./database/BDIIALE-LOG-20140506
./database/BDIIALE-LOG-20140430
./database/BDIIALEDB2.20140508.core
./database/BDIIALE-NEW
./database/BDIIALE-NEW.idx
./database/BDIIALE-LOG-20140508
./BDIIALEDB2.aif
find: cannot read dir ./.ssh: Permission denied
icdgd@codes /d/iccol/desarrollo
$ cat ./database/BDIIALE-ALERTAS
E001;00;P;N;990003;0001                ;EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO          ;                                                  ;OK
E002;00;P;N;990003;0002                ;EL DOCUMENTO DE IDENTIDAD FUE ROBADO              ;                                                  ;OK
E003;00;P;N;990003;0003                ;ACTUALMENTE RESIDE FUERA DEL PAIS                 ;                                                  ;OK
E004;00;P;N;990003;0004                ;HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION ;DE IDENTIDAD                                      ;OK
I004;00;C;N;990001;0005                ;LA CEDULA TIENE HISTORIA DE CREDITO COMO NIT      ;                                                  ;OK
I004;01;C;N;990001;0005                ;EL NIT TIENE HISTORIA DE CREDITO COMO CEDULA      ;                                                  ;OK
I004;02;C;N;000001;0005                ;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO                  ;OK
I006;00;C;N;990001;0006                ;SIN INFORMACION EN ARCHIVO DE CEDULAS             ;                                                  ;OK
I006;01;C;N;990001;0006                ;SIN INFORMACION EN ARCHIVO DE NITS                ;                                                  ;OK
I006;02;C;N;990001;0006                ;SIN INFORMACION EN ARCHIVO DE EXTRANJEROS         ;                                                  ;OK
I007;00;C;N;990001;0007                ;CONSULTADO POR   [&&&&&&&&&&&&&&&&&&&&&&&&&&&&&]  ;CON APELLIDO DIFERENTE:    [&&&&&&&&&&&&&&&]      ;OK
I008;00;C;N;000001;0008                ;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO                  ;OK
I008;01;C;N;000001;0008                ;EL CLIENTE NO TIENE ACTIVIDAD REGISTRADA COMO     ;TITULAR CON ESTABLECIMIENTO DE COMERCIO           ;OK
I009;00;C;N;990001;0009                ;SI SE ESTA SOLICITANDO UN MICROCREDITO, SUS DEUDAS;REGISTRADAS LLEGAN AL TOPE MXIMO,DECRETO 919/2008;OK
I010;00;C;N;990001;0010                ;EL REGISTRO CONSULTADO HA PRESENTADO 3 NUEVAS     ;DIRECCIONES O MAS EN EL ULTIMO AO                ;OK
I011;00;C;N;990001;0011                ;EL REGISTRO CONSULTADO HA PRESENTADO MORAS DE 60  ;DIAS O MAS EN LOS ULTIMOS 6 MESES                 ;OK
I012;00;C;N;990001;0012                ;MAS DE 3 CONSULTAS DE DIFERENTES ENTIDADES EN LOS ;ULTIMOS 60 DIAS                                   ;OK
J001;00;P;N;000001;0013                ;TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS; LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&];OK
L999;00;C;S;990001;9999                ;SIN ALERTAS EN EL GRUPO DE SERVICIOS              ;                                                  ;OK
B999;00;C;S;990001;9999                ;SIN ALERTAS EN EL GRUPO BURO                      ;                                                  ;OK
J999;00;C;S;990001;9999                ;SIN ALERTAS EN EL GRUPO DEMANDAS JUDICIALES       ;                                                  ;OK
V999;00;C;S;990001;9999                ;SIN ALERTAS EN EL GRUPO VERTICALES                ;                                                  ;OK
icdgd@codes /d/iccol/desarrollo
$ 
icdgd@codes /d/iccol/desarrollo
$ ^[  $ cat ./database/BDIIALE-ALERTAS$ find . -name "BDIIALE*" -print$ 
./objetos/BDIIALEDB2.int
./objetos/BDIIALEDB2.gnt
./objetos/BDIIALEDB2.idy
./objetos/BDIIALEDB2.s
./objetos/BDIIALEDB2.lst
./fuentes/BDIIALE.CBL
find: cannot read dir ./fuentes/especiales/darlas: Permission denied
./fuentes/BDIIALENEW.aif
./fuentes/BDIIALEDB2.CBL
./fuentes/BDIIALEDB2.aif
./fuentes/BDIIALEDB2.20140502.core
./copys/BDIIALE-ANT.PROC
./copys/BDIIALE.FD
./copys/BDIIALE.FS
./copys/BDIIALENW.PROC
./copys/BDIIALET7.PROC-DARIO
./copys/BDIIALE.PROC
./copys/ley/BDIIALE.FD
./copys/ley/BDIIALE.FS
./copys/ley/BDIIALE-LEY.PROC
./copys/ley/BDIIALE.PROC
./copys/ley/BDIIALET7.PROC-DARIO
./copys/ley/BDIIALE.WS
./copys/BDIIALEDB2.DOC
./copys/BDIIALEJURAD.WS
./copys/BDIIALENEW.PROC
./copys/BDIIALENEW.PROC.F-OLD!
./copys/BDIIALE.WS-V05
./copys/BDIIALE.WS
./copys/BDIIALE.PROC-V06
./copys/BDIIALE.PROC.20130913
./copys/BDIIALE-BDINDE.WS
./copys/BDIIALE-BDINDE-RGH.PROC
./copys/BDIIALEV07.PROC
./copys/BDIIALE-BDINDE.PROC-OLD-2013-10-31
./copys/BDIIALEV08.PROC.F-OLD!
./copys/BDIIALEV08.PROC
./copys/BDIIALEPR.PROC
./copys/BDIIALE-BDINDE.PROC-OK2
./copys/BDIIALE-BDINDE.PROC-OK1
./copys/BDIIALE-BDINDE.PROC
./copys/BDIIALEJURAD.PROC
./copys/AMNISTIA/BDIIALE.PROC
./copys/documentacion/BDIIALE.PROC
./copys/documentacion/BDIIALE.WS
./copys/documentacion/BDIIALE.FD
./copys/documentacion/BDIIALE.FS
./copys/documentacion/BDIIALE-BDINDE.WS
./copys/documentacion/BDIIALE-BDINDE.PROC
./copys/BDIIALEDB2.WS
./copys/BDIIALEDB2.PROC.ORI
./copys/BDIIALEDB2.PROC
./copys/BDIIALENEW.WS
./copys/BDIIALE-PLANO.FS
./copys/BDIIALE-PLANO.FD
find: cannot read dir ./stt: Permission denied
find: cannot read dir ./sf/.sunw: Permission denied
./database/desnovedat/BDIIALE
./database/desnovedat/BDIIALE.idx
./database/prunovedat/BDIIALE
./database/prunovedat/BDIIALE-ALEGRU
./database/prunovedat/BDIIALE-ALERTAS
./database/prunovedat/BDIIALE-GRUPOS
./database/prunovedat/BDIIALE-LOG-20140430
./database/prunovedat/BDIIALE-LOG-20140506
./database/prunovedat/BDIIALE-NEW
./database/prunovedat/BDIIALE-NEW.idx
./database/prunovedat/BDIIALE.err
./database/prunovedat/BDIIALE-ORI
./database/prunovedat/BDIIALE-ORI.idx
./database/prunovedat/BDIIALE.idx
./database/prunovedat/BDIIALE-LOG-20140509
./database/BDIIALE
./database/BDIIALE.idx
./database/documentacion/BDIIALE
./database/documentacion/BDIIALE.idx
./database/BDIIALE-ALERTAS
./database/BDIIALE-GRUPOS
./database/BDIIALE-ALEGRU
./database/BDIIALE_20140414
./database/BDIIALE_20140502
./database/BDIIALE-LOG-20140506
./database/BDIIALE-LOG-20140430
./database/BDIIALEDB2.20140508.core
./database/BDIIALE-NEW
./database/BDIIALE-NEW.idx
./database/BDIIALE-LOG-20140508
./BDIIALEDB2.aif
find: cannot read dir ./.ssh: Permission denied
icdgd@codes /d/iccol/desarrollo
$ cat ./database/prunovedat/BDIIALE-ALERTAS
E001;00;P;N;990003;0001                ;EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO          ;                                                  ;OK
E002;00;P;N;990003;0002                ;EL DOCUMENTO DE IDENTIDAD FUE ROBADO              ;                                                  ;OK
E003;00;P;N;990003;0003                ;ACTUALMENTE RESIDE FUERA DEL PAIS                 ;                                                  ;OK
E004;00;P;N;990003;0004                ;HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION ;DE IDENTIDAD                                      ;OK
I004;00;C;N;990001;0005                ;LA CEDULA TIENE HISTORIA DE CREDITO COMO NIT      ;                                                  ;OK
I004;01;C;N;990001;0005                ;EL NIT TIENE HISTORIA DE CREDITO COMO CEDULA      ;                                                  ;OK
I004;02;C;N;000001;0005                ;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO                  ;OK
I006;00;C;N;990001;0006                ;SIN INFORMACION EN ARCHIVO DE CEDULAS             ;                                                  ;OK
I006;01;C;N;990001;0006                ;SIN INFORMACION EN ARCHIVO DE NITS                ;                                                  ;OK
I006;02;C;N;990001;0006                ;SIN INFORMACION EN ARCHIVO DE EXTRANJEROS         ;                                                  ;OK
I007;00;C;N;990001;0007                ;CONSULTADO POR   [&&&&&&&&&&&&&&&&&&&&&&&&&&&&&]  ;CON APELLIDO DIFERENTE:    [&&&&&&&&&&&&&&&]      ;OK
I008;00;C;N;000001;0008                ;EL CLIENTE TIENE ACTIVIDAD REGISTRADA COMO TITULAR; CON ESTABLECIMIENTO DE COMERCIO                  ;OK
I008;01;C;N;000001;0008                ;EL CLIENTE NO TIENE ACTIVIDAD REGISTRADA COMO     ;TITULAR CON ESTABLECIMIENTO DE COMERCIO           ;OK
I009;00;C;N;990001;0009                ;SI SE ESTA SOLICITANDO UN MICROCREDITO, SUS DEUDAS;REGISTRADAS LLEGAN AL TOPE MXIMO,DECRETO 919/2008;OK
I010;00;C;N;990001;0010                ;EL REGISTRO CONSULTADO HA PRESENTADO 3 NUEVAS     ;DIRECCIONES O MAS EN EL ULTIMO AO                ;OK
I011;00;C;N;990001;0011                ;EL REGISTRO CONSULTADO HA PRESENTADO MORAS DE 60  ;DIAS O MAS EN LOS ULTIMOS 6 MESES                 ;OK
I012;00;C;N;990001;0012                ;MAS DE 3 CONSULTAS DE DIFERENTES ENTIDADES EN LOS ;ULTIMOS 60 DIAS                                   ;OK
J001;00;P;N;000001;0013                ;TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS; LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&];OK
L999;00;C;S;990001;9999                ;SIN ALERTAS EN EL GRUPO DE SERVICIOS              ;                                                  ;OK
B999;00;C;S;990001;9999                ;SIN ALERTAS EN EL GRUPO BURO                      ;                                                  ;OK
J999;00;C;S;990001;9999                ;SIN ALERTAS EN EL GRUPO DEMANDAS JUDICIALES       ;                                                  ;OK
V999;00;C;S;990001;9999                ;SIN ALERTAS EN EL GRUPO VERTICALES                ;                                                  ;OK
icdgd@codes /d/iccol/desarrollo
$ view ./copys/BDIIALE.WS
"./copys/BDIIALE.WS" [Read only] 81 lines, 5734 characters * BDIIALE-WS.v01.0007
REMARK* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA
REMARK**************************************************************************
REMARK* RMB0002   * TIPALE: CREACION DE DIFERENTES TIPOS DE ALERTA, QUE SE
REMARK* R.MARTINEZ* PUEDEN GENERAR SOBRE DIFERENTES TIPOS DE INFORMACION
REMARK* ABRIL/2006* (ARCHIVOS)
REMARK*************************************************************************
REMARK* RMB0003   * CIU001: AJUSTES PARA MANEJO DE ALERTAS DE CIUDADANOS DE
REMARK* R.MARTINEZ* COLOMBIA.
REMARK* NOV./2006 *
REMARK*************************************************************************
REMARK* VHF0004     * REFCOM - SE AJUSTA EL TAMAO DE LAS LINEAS DE    *
REMARK* VICTOR HUGO *DETALLE DE ALERTA YA QUE SU TAMAO*
REMARK* FORERO*ESTABA DE 81 Y NO DE 80 QUE ES ESTANDAR *
REMARK* OCT.29/2008 **
REMARK******************************************************************
REMARK* GJC0005     * LEY001 - SE CAMBIA EL GUIN INICIAL DE LA PRESENTACION
REMARK* G.JIMENEZ   *DE LA ALEERTA POR UN ESPACIO EN BLANCO. ESTO
REMARK* MARZO 2/2009*PARA EVITAR QUE SE INTERPRETE COMO ALGO
REMARK**NEGATIVO
remark******************************************************************
REMARK* RMB0006     * INDE01 - SE AGREGA VARIABLE QUE INDICA QUE YA SE SABE
REMARK* R.MARTINEZ  *QUE LA OTRA IDENTIFICACION TIENE CUENTAS
REMARK* JUNIO 4/2013*PORQUE SE DETERMINO ANTES QUE ERA INDEPENDIENTE
REMARK******************************************************************
01 VARIABLES-BDIIALE.
INDE01    02 ES-INDEPENDIENTE-BDIIALEPIC 9(01) VALUE 0.RMB0006
INDE01    02 MIRO-SIES-INDEPENDIENTE-BDIIALE    PIC 9(01) VALUE 0.RMB0006
CIU001    02 MAES-BDIIALE-TITLE    PIC X(20)RMB0003
CIU001VALUE "$DATABASE/BDIIALE".RMB000302 EST-BDIIALEPIC X(02) VALUE "00".02 FIN-BDIIALEPIC 9(01) VALUE 0.
TIPALE    02 PROCESAR-BDIIALEPIC 9(01) VALUE 0.RMB000202 CONT-LINEAS-BDIIALE   PIC 9(03) VALUE 0.02 ABIERTO-BDIIALEPIC 9(01) VALUE 0.02 TIP-IDE-AUX-BDIIALE   PIC 9(01) VALUE 0.02 NUM-IDE-AUX-BDIIALE   PIC 9(11) VALUE 0.
REFCOM    02 MARCAR-ICBTCO-BDIIALE PIC 9(01) VALUE 0.VHF0004
CIU001    02 FECHA-AUX-BDIIALE     PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-NOV-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-VEN-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-REP-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FUENTE-AUX-BDIIALE    PIC 9(06) VALUE 0.RMB0003
CIU001    02 NOMFUE1-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 NOMFUE2-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 CODALE-AUX-BDIIALE    PIC 9(03) VALUE 0.RMB0003
CIU001    02 TIPALE-AUX-BDIIALE    PIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003"./copys/BDIIALE.WS" [Read only] 81 lines, 5734 charactersCIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 INF-DATAHOST-AUX-BDIIALEPIC X(18) VALUE SPACES.RMB0003
TIPALE    02 PAR-CODBLOALERPIC 9(1)  VALUE 1.RMB0002
TIPALE    02 PAR-MSGBLOALERPIC X(60) VALUERMB0002
TIPALE" ALERTA DADA POR LA ENTIDAD".RMB0002
TIPALE 01 M-ALERTA.RMB0002
TIPALE    03 V-ALERTA   OCCURS 40 TIMES PIC 9(02).RMB0002
01 TITULOS-BDIIALE.02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "==== [ ALERTAS ] ===".02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "FUENTEFEC".02 FILLER    PIC X(20) VALUE "HADESCRIP".02 FILLER    PIC X(20) VALUE "CION".02 FILLER    PIC X(20) VALUE "".02 FILLERPIC X(80) VALUE ALL "=".
CIU001 01 LINEA1-BDIIALE-TIT.RMB0003
LEY001    02 RAYA-BDIIALEPIC X(01) VALUE " ".GJC0005
CIU001    02 NOMFUE-LIN1-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FEC-NOV-LIN1-BDIIALE  PIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN1-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004
CIU001 01 LINEA2-BDIIALE-TIT.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 NOMFUE-LIN2-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN2-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~* BDIIALE-WS.v01.0007
REMARK* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA
REMARK**************************************************************************
REMARK* RMB0002   * TIPALE: CREACION DE DIFERENTES TIPOS DE ALERTA, QUE SE
REMARK* R.MARTINEZ* PUEDEN GENERAR SOBRE DIFERENTES TIPOS DE INFORMACION
REMARK* ABRIL/2006* (ARCHIVOS)
REMARK*************************************************************************
REMARK* RMB0003   * CIU001: AJUSTES PARA MANEJO DE ALERTAS DE CIUDADANOS DE
REMARK* R.MARTINEZ* COLOMBIA.
REMARK* NOV./2006 *
REMARK*************************************************************************
REMARK* VHF0004     * REFCOM - SE AJUSTA EL TAMAO DE LAS LINEAS DE    *
REMARK* VICTOR HUGO *DETALLE DE ALERTA YA QUE SU TAMAO*
REMARK* FORERO*ESTABA DE 81 Y NO DE 80 QUE ES ESTANDAR *
REMARK* OCT.29/2008 **
REMARK******************************************************************
REMARK* GJC0005     * LEY001 - SE CAMBIA EL GUIN INICIAL DE LA PRESENTACION
REMARK* G.JIMENEZ   *DE LA ALEERTA POR UN ESPACIO EN BLANCO. ESTO
REMARK* MARZO 2/2009*PARA EVITAR QUE SE INTERPRETE COMO ALGO
REMARK**NEGATIVO
remark******************************************************************
REMARK* RMB0006     * INDE01 - SE AGREGA VARIABLE QUE INDICA QUE YA SE SABE
REMARK* R.MARTINEZ  *QUE LA OTRA IDENTIFICACION TIENE CUENTAS
REMARK* JUNIO 4/2013*PORQUE SE DETERMINO ANTES QUE ERA INDEPENDIENTE
REMARK******************************************************************
01 VARIABLES-BDIIALE.
INDE01    02 ES-INDEPENDIENTE-BDIIALEPIC 9(01) VALUE 0.RMB0006
INDE01    02 MIRO-SIES-INDEPENDIENTE-BDIIALE    PIC 9(01) VALUE 0.RMB0006
CIU001    02 MAES-BDIIALE-TITLE    PIC X(20)RMB0003
CIU001VALUE "$DATABASE/BDIIALE".RMB000302 EST-BDIIALEPIC X(02) VALUE "00".02 FIN-BDIIALEPIC 9(01) VALUE 0.
TIPALE    02 PROCESAR-BDIIALEPIC 9(01) VALUE 0.RMB000202 CONT-LINEAS-BDIIALE   PIC 9(03) VALUE 0.02 ABIERTO-BDIIALEPIC 9(01) VALUE 0.02 TIP-IDE-AUX-BDIIALE   PIC 9(01) VALUE 0.02 NUM-IDE-AUX-BDIIALE   PIC 9(11) VALUE 0.
REFCOM    02 MARCAR-ICBTCO-BDIIALE PIC 9(01) VALUE 0.VHF0004
CIU001    02 FECHA-AUX-BDIIALE     PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-NOV-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-VEN-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-REP-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FUENTE-AUX-BDIIALE    PIC 9(06) VALUE 0.RMB0003
CIU001    02 NOMFUE1-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 NOMFUE2-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 CODALE-AUX-BDIIALE    PIC 9(03) VALUE 0.RMB0003
CIU001    02 TIPALE-AUX-BDIIALE    PIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 INF-DATAHOST-AUX-BDIIALEPIC X(18) VALUE SPACES.RMB0003
TIPALE    02 PAR-CODBLOALERPIC 9(1)  VALUE 1.RMB0002
TIPALE    02 PAR-MSGBLOALERPIC X(60) VALUERMB0002
TIPALE" ALERTA DADA POR LA ENTIDAD".RMB0002
TIPALE 01 M-ALERTA.RMB0002
TIPALE    03 V-ALERTA   OCCURS 40 TIMES PIC 9(02).RMB0002
01 TITULOS-BDIIALE.02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "==== [ ALERTAS ] ===".02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "FUENTEFEC".02 FILLER    PIC X(20) VALUE "HADESCRIP".02 FILLER    PIC X(20) VALUE "CION".02 FILLER    PIC X(20) VALUE "".02 FILLERPIC X(80) VALUE ALL "=".
CIU001 01 LINEA1-BDIIALE-TIT.RMB0003
LEY001    02 RAYA-BDIIALEPIC X(01) VALUE " ".GJC0005
CIU001    02 NOMFUE-LIN1-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FEC-NOV-LIN1-BDIIALE  PIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN1-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004
CIU001 01 LINEA2-BDIIALE-TIT.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 NOMFUE-LIN2-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN2-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~* BDIIALE-WS.v01.0007
REMARK* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA
REMARK**************************************************************************
REMARK* RMB0002   * TIPALE: CREACION DE DIFERENTES TIPOS DE ALERTA, QUE SE
REMARK* R.MARTINEZ* PUEDEN GENERAR SOBRE DIFERENTES TIPOS DE INFORMACION
REMARK* ABRIL/2006* (ARCHIVOS)
REMARK*************************************************************************
REMARK* RMB0003   * CIU001: AJUSTES PARA MANEJO DE ALERTAS DE CIUDADANOS DE
REMARK* R.MARTINEZ* COLOMBIA.
REMARK* NOV./2006 *
REMARK*************************************************************************
REMARK* VHF0004     * REFCOM - SE AJUSTA EL TAMAO DE LAS LINEAS DE    *
REMARK* VICTOR HUGO *DETALLE DE ALERTA YA QUE SU TAMAO*
REMARK* FORERO*ESTABA DE 81 Y NO DE 80 QUE ES ESTANDAR *
REMARK* OCT.29/2008 **
REMARK******************************************************************
REMARK* GJC0005     * LEY001 - SE CAMBIA EL GUIN INICIAL DE LA PRESENTACION
REMARK* G.JIMENEZ   *DE LA ALEERTA POR UN ESPACIO EN BLANCO. ESTO
REMARK* MARZO 2/2009*PARA EVITAR QUE SE INTERPRETE COMO ALGO
REMARK**NEGATIVO
remark******************************************************************
REMARK* RMB0006     * INDE01 - SE AGREGA VARIABLE QUE INDICA QUE YA SE SABE
REMARK* R.MARTINEZ  *QUE LA OTRA IDENTIFICACION TIENE CUENTAS
REMARK* JUNIO 4/2013*PORQUE SE DETERMINO ANTES QUE ERA INDEPENDIENTE
REMARK******************************************************************
01 VARIABLES-BDIIALE.
INDE01    02 ES-INDEPENDIENTE-BDIIALEPIC 9(01) VALUE 0.RMB0006
INDE01    02 MIRO-SIES-INDEPENDIENTE-BDIIALE    PIC 9(01) VALUE 0.RMB0006
CIU001    02 MAES-BDIIALE-TITLE    PIC X(20)RMB0003
CIU001VALUE "$DATABASE/BDIIALE".RMB000302 EST-BDIIALEPIC X(02) VALUE "00".02 FIN-BDIIALEPIC 9(01) VALUE 0.
TIPALE    02 PROCESAR-BDIIALEPIC 9(01) VALUE 0.RMB000202 CONT-LINEAS-BDIIALE   PIC 9(03) VALUE 0.02 ABIERTO-BDIIALEPIC 9(01) VALUE 0.02 TIP-IDE-AUX-BDIIALE   PIC 9(01) VALUE 0.02 NUM-IDE-AUX-BDIIALE   PIC 9(11) VALUE 0.
REFCOM    02 MARCAR-ICBTCO-BDIIALE PIC 9(01) VALUE 0.VHF0004
CIU001    02 FECHA-AUX-BDIIALE     PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-NOV-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-VEN-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-REP-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FUENTE-AUX-BDIIALE    PIC 9(06) VALUE 0.RMB0003
CIU001    02 NOMFUE1-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 NOMFUE2-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 CODALE-AUX-BDIIALE    PIC 9(03) VALUE 0.RMB0003
CIU001    02 TIPALE-AUX-BDIIALE    PIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 INF-DATAHOST-AUX-BDIIALEPIC X(18) VALUE SPACES.RMB0003
TIPALE    02 PAR-CODBLOALERPIC 9(1)  VALUE 1.RMB0002
TIPALE    02 PAR-MSGBLOALERPIC X(60) VALUERMB0002
TIPALE" ALERTA DADA POR LA ENTIDAD".RMB0002
TIPALE 01 M-ALERTA.RMB0002
TIPALE    03 V-ALERTA   OCCURS 40 TIMES PIC 9(02).RMB0002
01 TITULOS-BDIIALE.02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "==== [ ALERTAS ] ===".02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "FUENTEFEC".02 FILLER    PIC X(20) VALUE "HADESCRIP".02 FILLER    PIC X(20) VALUE "CION".02 FILLER    PIC X(20) VALUE "".02 FILLERPIC X(80) VALUE ALL "=".
CIU001 01 LINEA1-BDIIALE-TIT.RMB0003
LEY001    02 RAYA-BDIIALEPIC X(01) VALUE " ".GJC0005
CIU001    02 NOMFUE-LIN1-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FEC-NOV-LIN1-BDIIALE  PIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN1-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004
CIU001 01 LINEA2-BDIIALE-TIT.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 NOMFUE-LIN2-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN2-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~* BDIIALE-WS.v01.0007
REMARK* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA
REMARK**************************************************************************
REMARK* RMB0002   * TIPALE: CREACION DE DIFERENTES TIPOS DE ALERTA, QUE SE
REMARK* R.MARTINEZ* PUEDEN GENERAR SOBRE DIFERENTES TIPOS DE INFORMACION
REMARK* ABRIL/2006* (ARCHIVOS)
REMARK*************************************************************************
REMARK* RMB0003   * CIU001: AJUSTES PARA MANEJO DE ALERTAS DE CIUDADANOS DE
REMARK* R.MARTINEZ* COLOMBIA.
REMARK* NOV./2006 *
REMARK*************************************************************************
REMARK* VHF0004     * REFCOM - SE AJUSTA EL TAMAO DE LAS LINEAS DE    *
REMARK* VICTOR HUGO *DETALLE DE ALERTA YA QUE SU TAMAO*
REMARK* FORERO*ESTABA DE 81 Y NO DE 80 QUE ES ESTANDAR *
REMARK* OCT.29/2008 **
REMARK******************************************************************
REMARK* GJC0005     * LEY001 - SE CAMBIA EL GUIN INICIAL DE LA PRESENTACION
REMARK* G.JIMENEZ   *DE LA ALEERTA POR UN ESPACIO EN BLANCO. ESTO
REMARK* MARZO 2/2009*PARA EVITAR QUE SE INTERPRETE COMO ALGO
REMARK**NEGATIVO
remark******************************************************************
REMARK* RMB0006     * INDE01 - SE AGREGA VARIABLE QUE INDICA QUE YA SE SABE
REMARK* R.MARTINEZ  *QUE LA OTRA IDENTIFICACION TIENE CUENTAS
REMARK* JUNIO 4/2013*PORQUE SE DETERMINO ANTES QUE ERA INDEPENDIENTE
REMARK******************************************************************
01 VARIABLES-BDIIALE.
INDE01    02 ES-INDEPENDIENTE-BDIIALEPIC 9(01) VALUE 0.RMB0006
INDE01    02 MIRO-SIES-INDEPENDIENTE-BDIIALE    PIC 9(01) VALUE 0.RMB0006
CIU001    02 MAES-BDIIALE-TITLE    PIC X(20)RMB0003
CIU001VALUE "$DATABASE/BDIIALE".RMB000302 EST-BDIIALEPIC X(02) VALUE "00".02 FIN-BDIIALEPIC 9(01) VALUE 0.
TIPALE    02 PROCESAR-BDIIALEPIC 9(01) VALUE 0.RMB000202 CONT-LINEAS-BDIIALE   PIC 9(03) VALUE 0.02 ABIERTO-BDIIALEPIC 9(01) VALUE 0.02 TIP-IDE-AUX-BDIIALE   PIC 9(01) VALUE 0.02 NUM-IDE-AUX-BDIIALE   PIC 9(11) VALUE 0.
REFCOM    02 MARCAR-ICBTCO-BDIIALE PIC 9(01) VALUE 0.VHF0004
CIU001    02 FECHA-AUX-BDIIALE     PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-NOV-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-VEN-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-REP-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FUENTE-AUX-BDIIALE    PIC 9(06) VALUE 0.RMB0003
CIU001    02 NOMFUE1-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 NOMFUE2-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 CODALE-AUX-BDIIALE    PIC 9(03) VALUE 0.RMB0003
CIU001    02 TIPALE-AUX-BDIIALE    PIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 INF-DATAHOST-AUX-BDIIALEPIC X(18) VALUE SPACES.RMB0003
TIPALE    02 PAR-CODBLOALERPIC 9(1)  VALUE 1.RMB0002
TIPALE    02 PAR-MSGBLOALERPIC X(60) VALUERMB0002
TIPALE" ALERTA DADA POR LA ENTIDAD".RMB0002
TIPALE 01 M-ALERTA.RMB0002
TIPALE    03 V-ALERTA   OCCURS 40 TIMES PIC 9(02).RMB0002
01 TITULOS-BDIIALE.02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "==== [ ALERTAS ] ===".02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "FUENTEFEC".02 FILLER    PIC X(20) VALUE "HADESCRIP".02 FILLER    PIC X(20) VALUE "CION".02 FILLER    PIC X(20) VALUE "".02 FILLERPIC X(80) VALUE ALL "=".
CIU001 01 LINEA1-BDIIALE-TIT.RMB0003
LEY001    02 RAYA-BDIIALEPIC X(01) VALUE " ".GJC0005
CIU001    02 NOMFUE-LIN1-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FEC-NOV-LIN1-BDIIALE  PIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN1-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004
CIU001 01 LINEA2-BDIIALE-TIT.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 NOMFUE-LIN2-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN2-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~* BDIIALE-WS.v01.0007
REMARK* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA
REMARK**************************************************************************
REMARK* RMB0002   * TIPALE: CREACION DE DIFERENTES TIPOS DE ALERTA, QUE SE
REMARK* R.MARTINEZ* PUEDEN GENERAR SOBRE DIFERENTES TIPOS DE INFORMACION
REMARK* ABRIL/2006* (ARCHIVOS)
REMARK*************************************************************************
REMARK* RMB0003   * CIU001: AJUSTES PARA MANEJO DE ALERTAS DE CIUDADANOS DE
REMARK* R.MARTINEZ* COLOMBIA.
REMARK* NOV./2006 *
REMARK*************************************************************************
REMARK* VHF0004     * REFCOM - SE AJUSTA EL TAMAO DE LAS LINEAS DE    *
REMARK* VICTOR HUGO *DETALLE DE ALERTA YA QUE SU TAMAO*
REMARK* FORERO*ESTABA DE 81 Y NO DE 80 QUE ES ESTANDAR *
REMARK* OCT.29/2008 **
REMARK******************************************************************
REMARK* GJC0005     * LEY001 - SE CAMBIA EL GUIN INICIAL DE LA PRESENTACION
REMARK* G.JIMENEZ   *DE LA ALEERTA POR UN ESPACIO EN BLANCO. ESTO
REMARK* MARZO 2/2009*PARA EVITAR QUE SE INTERPRETE COMO ALGO
REMARK**NEGATIVO
remark******************************************************************
REMARK* RMB0006     * INDE01 - SE AGREGA VARIABLE QUE INDICA QUE YA SE SABE
REMARK* R.MARTINEZ  *QUE LA OTRA IDENTIFICACION TIENE CUENTAS
REMARK* JUNIO 4/2013*PORQUE SE DETERMINO ANTES QUE ERA INDEPENDIENTE
REMARK******************************************************************
01 VARIABLES-BDIIALE.
INDE01    02 ES-INDEPENDIENTE-BDIIALEPIC 9(01) VALUE 0.RMB0006
INDE01    02 MIRO-SIES-INDEPENDIENTE-BDIIALE    PIC 9(01) VALUE 0.RMB0006
CIU001    02 MAES-BDIIALE-TITLE    PIC X(20)RMB0003
CIU001VALUE "$DATABASE/BDIIALE".RMB000302 EST-BDIIALEPIC X(02) VALUE "00".02 FIN-BDIIALEPIC 9(01) VALUE 0.
TIPALE    02 PROCESAR-BDIIALEPIC 9(01) VALUE 0.RMB000202 CONT-LINEAS-BDIIALE   PIC 9(03) VALUE 0.02 ABIERTO-BDIIALEPIC 9(01) VALUE 0.02 TIP-IDE-AUX-BDIIALE   PIC 9(01) VALUE 0.02 NUM-IDE-AUX-BDIIALE   PIC 9(11) VALUE 0.
REFCOM    02 MARCAR-ICBTCO-BDIIALE PIC 9(01) VALUE 0.VHF0004
CIU001    02 FECHA-AUX-BDIIALE     PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-NOV-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-VEN-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-REP-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FUENTE-AUX-BDIIALE    PIC 9(06) VALUE 0.RMB0003
CIU001    02 NOMFUE1-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 NOMFUE2-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 CODALE-AUX-BDIIALE    PIC 9(03) VALUE 0.RMB0003
CIU001    02 TIPALE-AUX-BDIIALE    PIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
01 VARIABLES-BDIIALE.
INDE01    02 ES-INDEPENDIENTE-BDIIALEPIC 9(01) VALUE 0.RMB0006
INDE01    02 MIRO-SIES-INDEPENDIENTE-BDIIALE    PIC 9(01) VALUE 0.RMB0006
CIU001    02 MAES-BDIIALE-TITLE    PIC X(20)RMB0003
CIU001VALUE "$DATABASE/BDIIALE".RMB000302 EST-BDIIALEPIC X(02) VALUE "00".02 FIN-BDIIALEPIC 9(01) VALUE 0.
TIPALE    02 PROCESAR-BDIIALEPIC 9(01) VALUE 0.RMB000202 CONT-LINEAS-BDIIALE   PIC 9(03) VALUE 0.02 ABIERTO-BDIIALEPIC 9(01) VALUE 0.02 TIP-IDE-AUX-BDIIALE   PIC 9(01) VALUE 0.02 NUM-IDE-AUX-BDIIALE   PIC 9(11) VALUE 0.
REFCOM    02 MARCAR-ICBTCO-BDIIALE PIC 9(01) VALUE 0.VHF0004
CIU001    02 FECHA-AUX-BDIIALE     PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-NOV-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-VEN-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-REP-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FUENTE-AUX-BDIIALE    PIC 9(06) VALUE 0.RMB0003
CIU001    02 NOMFUE1-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 NOMFUE2-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 CODALE-AUX-BDIIALE    PIC 9(03) VALUE 0.RMB0003
CIU001    02 TIPALE-AUX-BDIIALE    PIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 INF-DATAHOST-AUX-BDIIALEPIC X(18) VALUE SPACES.RMB0003
TIPALE    02 PAR-CODBLOALERPIC 9(1)  VALUE 1.RMB0002
TIPALE    02 PAR-MSGBLOALERPIC X(60) VALUERMB0002
TIPALE" ALERTA DADA POR LA ENTIDAD".RMB0002
TIPALE 01 M-ALERTA.RMB0002
TIPALE    03 V-ALERTA   OCCURS 40 TIMES PIC 9(02).RMB0002
01 TITULOS-BDIIALE.02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "==== [ ALERTAS ] ===".02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "FUENTEFEC".02 FILLER    PIC X(20) VALUE "HADESCRIP".02 FILLER    PIC X(20) VALUE "CION".02 FILLER    PIC X(20) VALUE "".02 FILLERPIC X(80) VALUE ALL "=".
CIU001 01 LINEA1-BDIIALE-TIT.RMB0003
LEY001    02 RAYA-BDIIALEPIC X(01) VALUE " ".GJC0005
CIU001    02 NOMFUE-LIN1-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FEC-NOV-LIN1-BDIIALE  PIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN1-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004
CIU001 01 LINEA2-BDIIALE-TIT.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003:showmodeshowmode: Not an editor command:set showmode:set rulerruler: No such option - 'set all' gives all option values:set allnoautoindentnomodelinesshowmodeautoprintnonumbernoslowopennoautowritenonovicetabstop=8nobeautifynooptimizetaglength=0directory=/var/tmpparagraphs=IPLPPPQPP LIpplpipnppplpipbptags=tags /usr/lib/tagsnoedcompatibleprompttagstacknoerrorbellsreadonlyterm=vt220noexrcredrawnoterseflashremaptimeouthardtabs=8report=5ttytype=vt220noignorecasescroll=24warnnolispsections=NHSHH HUuhsh+cwindow=49nolistshell=/bin/kshwrapscanmagicshiftwidth=8wrapmargin=0mesgnoshowmatchnowriteany[Hit return to continue] 01 VARIABLES-BDIIALE.
INDE01    02 ES-INDEPENDIENTE-BDIIALEPIC 9(01) VALUE 0.RMB0006
INDE01    02 MIRO-SIES-INDEPENDIENTE-BDIIALE    PIC 9(01) VALUE 0.RMB0006
CIU001    02 MAES-BDIIALE-TITLE    PIC X(20)RMB0003
CIU001VALUE "$DATABASE/BDIIALE".RMB000302 EST-BDIIALEPIC X(02) VALUE "00".02 FIN-BDIIALEPIC 9(01) VALUE 0.
TIPALE    02 PROCESAR-BDIIALEPIC 9(01) VALUE 0.RMB000202 CONT-LINEAS-BDIIALE   PIC 9(03) VALUE 0.02 ABIERTO-BDIIALEPIC 9(01) VALUE 0.02 TIP-IDE-AUX-BDIIALE   PIC 9(01) VALUE 0.02 NUM-IDE-AUX-BDIIALE   PIC 9(11) VALUE 0.
REFCOM    02 MARCAR-ICBTCO-BDIIALE PIC 9(01) VALUE 0.VHF0004
CIU001    02 FECHA-AUX-BDIIALE     PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-NOV-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-VEN-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FECHA-REP-AUX-BDIIALE PIC 9(08) VALUE 0.RMB0003
CIU001    02 FUENTE-AUX-BDIIALE    PIC 9(06) VALUE 0.RMB0003
CIU001    02 NOMFUE1-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 NOMFUE2-AUX-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 CODALE-AUX-BDIIALE    PIC 9(03) VALUE 0.RMB0003
CIU001    02 TIPALE-AUX-BDIIALE    PIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
CIU001    02 INF-DATAHOST-AUX-BDIIALEPIC X(18) VALUE SPACES.RMB0003
TIPALE    02 PAR-CODBLOALERPIC 9(1)  VALUE 1.RMB0002
TIPALE    02 PAR-MSGBLOALERPIC X(60) VALUERMB0002
TIPALE" ALERTA DADA POR LA ENTIDAD".RMB0002
TIPALE 01 M-ALERTA.RMB0002
TIPALE    03 V-ALERTA   OCCURS 40 TIMES PIC 9(02).RMB0002
01 TITULOS-BDIIALE.02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "==== [ ALERTAS ] ===".02 FILLERPIC X(30) VALUE ALL "=".02 FILLER    PIC X(20) VALUE "FUENTEFEC".02 FILLER    PIC X(20) VALUE "HADESCRIP".02 FILLER    PIC X(20) VALUE "CION".02 FILLER    PIC X(20) VALUE "".02 FILLERPIC X(80) VALUE ALL "=".
CIU001 01 LINEA1-BDIIALE-TIT.RMB0003
LEY001    02 RAYA-BDIIALEPIC X(01) VALUE " ".GJC0005
CIU001    02 NOMFUE-LIN1-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FEC-NOV-LIN1-BDIIALE  PIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN1-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004
CIU001 01 LINEA2-BDIIALE-TIT.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003CIU001 01 LINEA1-BDIIALE-TIT.RMB0003
LEY001    02 RAYA-BDIIALEPIC X(01) VALUE " ".GJC0005
CIU001    02 NOMFUE-LIN1-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FEC-NOV-LIN1-BDIIALE  PIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN1-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004
CIU001 01 LINEA2-BDIIALE-TIT.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 NOMFUE-LIN2-BDIIALE   PIC X(14) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(11) VALUE SPACES.RMB0003
CIU001    02 FILLERPIC X(01) VALUE SPACES.RMB0003
CIU001    02 TEXTO-LIN2-BDIIALE    PIC X(50) VALUE SPACES.RMB0003
REFCOM    02 FILLERPIC X(02) VALUE SPACES.VHF0004

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:qicdgd@codes /d/iccol/desarrollo
$ ^[  $ view ./copys/BDIIALE.WS$ cat ./database/prunovedat/BDIIALE-ALERTAS$ find . -name "BDIIALE*" -print           $ 
./objetos/BDIIALEDB2.int
./objetos/BDIIALEDB2.gnt
./objetos/BDIIALEDB2.idy
./objetos/BDIIALEDB2.s
./objetos/BDIIALEDB2.lst
./fuentes/BDIIALE.CBL
find: cannot read dir ./fuentes/especiales/darlas: Permission denied
./fuentes/BDIIALENEW.aif
./fuentes/BDIIALEDB2.CBL
./fuentes/BDIIALEDB2.aif
./fuentes/BDIIALEDB2.20140502.core
./copys/BDIIALE-ANT.PROC
./copys/BDIIALE.FD
./copys/BDIIALE.FS
./copys/BDIIALENW.PROC
./copys/BDIIALET7.PROC-DARIO
./copys/BDIIALE.PROC
./copys/ley/BDIIALE.FD
./copys/ley/BDIIALE.FS
./copys/ley/BDIIALE-LEY.PROC
./copys/ley/BDIIALE.PROC
./copys/ley/BDIIALET7.PROC-DARIO
./copys/ley/BDIIALE.WS
./copys/BDIIALEDB2.DOC
./copys/BDIIALEJURAD.WS
./copys/BDIIALENEW.PROC
./copys/BDIIALENEW.PROC.F-OLD!
./copys/BDIIALE.WS-V05
./copys/BDIIALE.WS
./copys/BDIIALE.PROC-V06
./copys/BDIIALE.PROC.20130913
./copys/BDIIALE-BDINDE.WS
./copys/BDIIALE-BDINDE-RGH.PROC
./copys/BDIIALEV07.PROC
./copys/BDIIALE-BDINDE.PROC-OLD-2013-10-31
./copys/BDIIALEV08.PROC.F-OLD!
./copys/BDIIALEV08.PROC
./copys/BDIIALEPR.PROC
./copys/BDIIALE-BDINDE.PROC-OK2
./copys/BDIIALE-BDINDE.PROC-OK1
./copys/BDIIALE-BDINDE.PROC
./copys/BDIIALEJURAD.PROC
./copys/AMNISTIA/BDIIALE.PROC
./copys/documentacion/BDIIALE.PROC
./copys/documentacion/BDIIALE.WS
./copys/documentacion/BDIIALE.FD
./copys/documentacion/BDIIALE.FS
./copys/documentacion/BDIIALE-BDINDE.WS
./copys/documentacion/BDIIALE-BDINDE.PROC
./copys/BDIIALEDB2.WS
./copys/BDIIALEDB2.PROC.ORI
./copys/BDIIALEDB2.PROC
./copys/BDIIALENEW.WS
./copys/BDIIALE-PLANO.FS
./copys/BDIIALE-PLANO.FD
find: cannot read dir ./stt: Permission denied
find: cannot read dir ./sf/.sunw: Permission denied
./database/desnovedat/BDIIALE
./database/desnovedat/BDIIALE.idx
./database/prunovedat/BDIIALE
./database/prunovedat/BDIIALE-ALEGRU
./database/prunovedat/BDIIALE-ALERTAS
./database/prunovedat/BDIIALE-GRUPOS
./database/prunovedat/BDIIALE-LOG-20140430
./database/prunovedat/BDIIALE-LOG-20140506
./database/prunovedat/BDIIALE-NEW
./database/prunovedat/BDIIALE-NEW.idx
./database/prunovedat/BDIIALE.err
./database/prunovedat/BDIIALE-ORI
./database/prunovedat/BDIIALE-ORI.idx
./database/prunovedat/BDIIALE.idx
./database/prunovedat/BDIIALE-LOG-20140509
./database/BDIIALE
./database/BDIIALE.idx
./database/documentacion/BDIIALE
./database/documentacion/BDIIALE.idx
./database/BDIIALE-ALERTAS
./database/BDIIALE-GRUPOS
./database/BDIIALE-ALEGRU
./database/BDIIALE_20140414
./database/BDIIALE_20140502
./database/BDIIALE-LOG-20140506
./database/BDIIALE-LOG-20140430
./database/BDIIALEDB2.20140508.core
./database/BDIIALE-NEW
./database/BDIIALE-NEW.idx
./database/BDIIALE-LOG-20140508
./BDIIALEDB2.aif
find: cannot read dir ./.ssh: Permission denied
icdgd@codes /d/iccol/desarrollo
$ view ./database/prunovedat/BDIIALE-GRUPOS
"./database/prunovedat/BDIIALE-GRUPOS" [Read only] 4 lines, 140 characters G000;GRUPO SERVICIOS;OBL;B8;
G001;GRUPO BURO;COB;B9;
G002;GRUPO JUDICIALES     ;COB;C9;
G005;GRUPO VERTICALES     ;COB;D9;
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"./database/prunovedat/BDIIALE-GRUPOS" [Read only] 4 lines, 140 characters:qicdgd@codes /d/iccol/desarrollo
$ ^[  $ view ./database/prunovedat/BDIIALE-GRUPOS$ find . -name "BDIIALE*" -print           $ 
./objetos/BDIIALEDB2.int
./objetos/BDIIALEDB2.gnt
./objetos/BDIIALEDB2.idy
./objetos/BDIIALEDB2.s
./objetos/BDIIALEDB2.lst
./fuentes/BDIIALE.CBL
find: cannot read dir ./fuentes/especiales/darlas: Permission denied
./fuentes/BDIIALENEW.aif
./fuentes/BDIIALEDB2.CBL
./fuentes/BDIIALEDB2.aif
./fuentes/BDIIALEDB2.20140502.core
./copys/BDIIALE-ANT.PROC
./copys/BDIIALE.FD
./copys/BDIIALE.FS
./copys/BDIIALENW.PROC
./copys/BDIIALET7.PROC-DARIO
./copys/BDIIALE.PROC
./copys/ley/BDIIALE.FD
./copys/ley/BDIIALE.FS
./copys/ley/BDIIALE-LEY.PROC
./copys/ley/BDIIALE.PROC
./copys/ley/BDIIALET7.PROC-DARIO
./copys/ley/BDIIALE.WS
./copys/BDIIALEDB2.DOC
./copys/BDIIALEJURAD.WS
./copys/BDIIALENEW.PROC
./copys/BDIIALENEW.PROC.F-OLD!
./copys/BDIIALE.WS-V05
./copys/BDIIALE.WS
./copys/BDIIALE.PROC-V06
./copys/BDIIALE.PROC.20130913
./copys/BDIIALE-BDINDE.WS
./copys/BDIIALE-BDINDE-RGH.PROC
./copys/BDIIALEV07.PROC
./copys/BDIIALE-BDINDE.PROC-OLD-2013-10-31
./copys/BDIIALEV08.PROC.F-OLD!
./copys/BDIIALEV08.PROC
./copys/BDIIALEPR.PROC
./copys/BDIIALE-BDINDE.PROC-OK2
./copys/BDIIALE-BDINDE.PROC-OK1
./copys/BDIIALE-BDINDE.PROC
./copys/BDIIALEJURAD.PROC
./copys/AMNISTIA/BDIIALE.PROC
./copys/documentacion/BDIIALE.PROC
./copys/documentacion/BDIIALE.WS
./copys/documentacion/BDIIALE.FD
./copys/documentacion/BDIIALE.FS
./copys/documentacion/BDIIALE-BDINDE.WS
./copys/documentacion/BDIIALE-BDINDE.PROC
./copys/BDIIALEDB2.WS
./copys/BDIIALEDB2.PROC.ORI
./copys/BDIIALEDB2.PROC
./copys/BDIIALENEW.WS
./copys/BDIIALE-PLANO.FS
./copys/BDIIALE-PLANO.FD
find: cannot read dir ./stt: Permission denied
find: cannot read dir ./sf/.sunw: Permission denied
./database/desnovedat/BDIIALE
./database/desnovedat/BDIIALE.idx
./database/prunovedat/BDIIALE
./database/prunovedat/BDIIALE-ALEGRU
./database/prunovedat/BDIIALE-ALERTAS
./database/prunovedat/BDIIALE-GRUPOS
./database/prunovedat/BDIIALE-LOG-20140430
./database/prunovedat/BDIIALE-LOG-20140506
./database/prunovedat/BDIIALE-NEW
./database/prunovedat/BDIIALE-NEW.idx
./database/prunovedat/BDIIALE.err
./database/prunovedat/BDIIALE-ORI
./database/prunovedat/BDIIALE-ORI.idx
./database/prunovedat/BDIIALE.idx
./database/prunovedat/BDIIALE-LOG-20140509
./database/BDIIALE
./database/BDIIALE.idx
./database/documentacion/BDIIALE
./database/documentacion/BDIIALE.idx
./database/BDIIALE-ALERTAS
./database/BDIIALE-GRUPOS
./database/BDIIALE-ALEGRU
./database/BDIIALE_20140414
./database/BDIIALE_20140502
./database/BDIIALE-LOG-20140506
./database/BDIIALE-LOG-20140430
./database/BDIIALEDB2.20140508.core
./database/BDIIALE-NEW
./database/BDIIALE-NEW.idx
./database/BDIIALE-LOG-20140508
./BDIIALEDB2.aif
find: cannot read dir ./.ssh: Permission denied
icdgd@codes /d/iccol/desarrollo
$ view ./database/prunovedat/BDIIALE-ALEGRU
"./database/prunovedat/BDIIALE-ALEGRU" [Read only] 17 lines, 187 characters E001;G000;
E002;G000;
E003;G000;
E004;G000;
I004;G001;
I006;G001;
I007;G001;
I008;G001;
I009;G005;
I010;G005;
I011;G005;
I012;G005;
J001;G002;
L999;G000;
B999;G001;
J999;G002;
V999;G005;
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"./database/prunovedat/BDIIALE-ALEGRU" [Read only] 17 lines, 187 characters:qicdgd@codes /d/iccol/desarrollo
$ ^[  $ view ./database/prunovedat/BDIIALE-ALEGRU$ find . -name "BDIIALE*" -print           $ 
./objetos/BDIIALEDB2.int
./objetos/BDIIALEDB2.gnt
./objetos/BDIIALEDB2.idy
./objetos/BDIIALEDB2.s
./objetos/BDIIALEDB2.lst
./fuentes/BDIIALE.CBL
find: cannot read dir ./fuentes/especiales/darlas: Permission denied
./fuentes/BDIIALENEW.aif
./fuentes/BDIIALEDB2.CBL
./fuentes/BDIIALEDB2.aif
./fuentes/BDIIALEDB2.20140502.core
./copys/BDIIALE-ANT.PROC
./copys/BDIIALE.FD
./copys/BDIIALE.FS
./copys/BDIIALENW.PROC
./copys/BDIIALET7.PROC-DARIO
./copys/BDIIALE.PROC
./copys/ley/BDIIALE.FD
./copys/ley/BDIIALE.FS
./copys/ley/BDIIALE-LEY.PROC
./copys/ley/BDIIALE.PROC
./copys/ley/BDIIALET7.PROC-DARIO
./copys/ley/BDIIALE.WS
./copys/BDIIALEDB2.DOC
./copys/BDIIALEJURAD.WS
./copys/BDIIALENEW.PROC
./copys/BDIIALENEW.PROC.F-OLD!
./copys/BDIIALE.WS-V05
./copys/BDIIALE.WS
./copys/BDIIALE.PROC-V06
./copys/BDIIALE.PROC.20130913
./copys/BDIIALE-BDINDE.WS
./copys/BDIIALE-BDINDE-RGH.PROC
./copys/BDIIALEV07.PROC
./copys/BDIIALE-BDINDE.PROC-OLD-2013-10-31
./copys/BDIIALEV08.PROC.F-OLD!
./copys/BDIIALEV08.PROC
./copys/BDIIALEPR.PROC
./copys/BDIIALE-BDINDE.PROC-OK2
./copys/BDIIALE-BDINDE.PROC-OK1
./copys/BDIIALE-BDINDE.PROC
./copys/BDIIALEJURAD.PROC
./copys/AMNISTIA/BDIIALE.PROC
./copys/documentacion/BDIIALE.PROC
./copys/documentacion/BDIIALE.WS
./copys/documentacion/BDIIALE.FD
./copys/documentacion/BDIIALE.FS
./copys/documentacion/BDIIALE-BDINDE.WS
./copys/documentacion/BDIIALE-BDINDE.PROC
./copys/BDIIALEDB2.WS
./copys/BDIIALEDB2.PROC.ORI
./copys/BDIIALEDB2.PROC
./copys/BDIIALENEW.WS
./copys/BDIIALE-PLANO.FS
./copys/BDIIALE-PLANO.FD
find: cannot read dir ./stt: Permission denied
find: cannot read dir ./sf/.sunw: Permission denied
./database/desnovedat/BDIIALE
./database/desnovedat/BDIIALE.idx
./database/prunovedat/BDIIALE
./database/prunovedat/BDIIALE-ALEGRU
./database/prunovedat/BDIIALE-ALERTAS
./database/prunovedat/BDIIALE-GRUPOS
./database/prunovedat/BDIIALE-LOG-20140430
./database/prunovedat/BDIIALE-LOG-20140506
./database/prunovedat/BDIIALE-NEW
./database/prunovedat/BDIIALE-NEW.idx
./database/prunovedat/BDIIALE.err
./database/prunovedat/BDIIALE-ORI
./database/prunovedat/BDIIALE-ORI.idx
./database/prunovedat/BDIIALE.idx
./database/prunovedat/BDIIALE-LOG-20140509
./database/BDIIALE
./database/BDIIALE.idx
./database/documentacion/BDIIALE
./database/documentacion/BDIIALE.idx
./database/BDIIALE-ALERTAS
./database/BDIIALE-GRUPOS
./database/BDIIALE-ALEGRU
./database/BDIIALE_20140414
./database/BDIIALE_20140502
./database/BDIIALE-LOG-20140506
./database/BDIIALE-LOG-20140430
./database/BDIIALEDB2.20140508.core
./database/BDIIALE-NEW
./database/BDIIALE-NEW.idx
./database/BDIIALE-LOG-20140508
./BDIIALEDB2.aif
find: cannot read dir ./.ssh: Permission denied
icdgd@codes /d/iccol/desarrollo
$ view ./database/prunovedat/BDIIALE-ORI
"./database/prunovedat/BDIIALE-ORI" [Read only] 64886 lines, 11874321 characters (1 null) 1000135072769900030032006121420061214200612141ACTUALMENTE RESIDE FUERA DE COLOMBIA

1000135072769900030012006121420061214200612141EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO

1000327790699900030022006113020070228200611300EL DOCUMENTO DE IDENTIDAD FUE ROBADO

1000135072769900030042006113020061130200611301HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION DE IDENTIDAD

1000794065909900030022013053120130829201305310EL DOCUMENTO DE IDENTIDAD FUE ROBADO

1000799771639900030012006113020070228200611300EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO

1000194973039900030042006113020070228200611300HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION DE IDENTIDAD

1000520340449900030042006113020070228200611300HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION DE IDENTIDAD

1000080104829900030042006113020070228200611300HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION DE IDENTIDAD

1000882338599900030012006113020070228200611300EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO

1000326666369900030022006120120070301200612010EL DOCUMENTO DE IDENTIDAD FUE ROBADO

1000796706539900030032006120120070301200612010ACTUALMENTE RESIDE FUERA DE COLOMBIA

1000795972619900030032006120120070301200612010ACTUALMENTE RESIDE FUERA DE COLOMBIA

1000985175069900030012006120120070301200612010EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO

1000713707309900030032006120120070301200612010ACTUALMENTE RESIDE FUERA DE COLOMBIA

1000521027859900030042006120120070301200612010HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION DE IDENTIDAD

1000082818959900030032006120120070301200612010ACTUALMENTE RESIDE FUERA DE COLOMBIA

1000912836219900030042006120120070301200612010HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION DE IDENTIDAD

1000528682129900030022009012120090421200901210EL DOCUMENTO DE IDENTIDAD FUE ROBADO

1000527286269900030042006120120070301200612010HA SIDO OBJETO DE VARIOS INTENTOS DE SUPLANTACION DE IDENTIDAD

1000800600459900030022006120120070301200612010EL DOCUMENTO DE IDENTIDAD FUE ROBADO

1000793829939900030012006120120070301200612010EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO

1000155044519900030012006120120070301200612010EL DOCUMENTO DE IDENTIDAD FUE EXTRAVIADO

1000799882309900030022006120120070301200612010EL DOCUMENTO DE IDENTIDAD FUE ROBADO

@"./database/prunovedat/BDIIALE-ORI" [Read only] 64886 lines, 11874321 characters (1 null):qicdgd@codes /d/iccol/desarrollo
$ ^[  $ view ./database/prunovedat/BDIIALE-ORI$ find . -name "BDIIALE*" -print        $ 
./objetos/BDIIALEDB2.int
./objetos/BDIIALEDB2.gnt
./objetos/BDIIALEDB2.idy
./objetos/BDIIALEDB2.s
./objetos/BDIIALEDB2.lst
./fuentes/BDIIALE.CBL
find: cannot read dir ./fuentes/especiales/darlas: Permission denied
./fuentes/BDIIALENEW.aif
./fuentes/BDIIALEDB2.CBL
./fuentes/BDIIALEDB2.aif
./fuentes/BDIIALEDB2.20140502.core
./copys/BDIIALE-ANT.PROC
./copys/BDIIALE.FD
./copys/BDIIALE.FS
./copys/BDIIALENW.PROC
./copys/BDIIALET7.PROC-DARIO
./copys/BDIIALE.PROC
./copys/ley/BDIIALE.FD
./copys/ley/BDIIALE.FS
./copys/ley/BDIIALE-LEY.PROC
./copys/ley/BDIIALE.PROC
./copys/ley/BDIIALET7.PROC-DARIO
./copys/ley/BDIIALE.WS
./copys/BDIIALEDB2.DOC
./copys/BDIIALEJURAD.WS
./copys/BDIIALENEW.PROC
./copys/BDIIALENEW.PROC.F-OLD!
./copys/BDIIALE.WS-V05
./copys/BDIIALE.WS
./copys/BDIIALE.PROC-V06
./copys/BDIIALE.PROC.20130913
./copys/BDIIALE-BDINDE.WS
./copys/BDIIALE-BDINDE-RGH.PROC
./copys/BDIIALEV07.PROC
./copys/BDIIALE-BDINDE.PROC-OLD-2013-10-31
./copys/BDIIALEV08.PROC.F-OLD!
./copys/BDIIALEV08.PROC
./copys/BDIIALEPR.PROC
./copys/BDIIALE-BDINDE.PROC-OK2
./copys/BDIIALE-BDINDE.PROC-OK1
./copys/BDIIALE-BDINDE.PROC
./copys/BDIIALEJURAD.PROC
./copys/AMNISTIA/BDIIALE.PROC
./copys/documentacion/BDIIALE.PROC
./copys/documentacion/BDIIALE.WS
./copys/documentacion/BDIIALE.FD
./copys/documentacion/BDIIALE.FS
./copys/documentacion/BDIIALE-BDINDE.WS
./copys/documentacion/BDIIALE-BDINDE.PROC
./copys/BDIIALEDB2.WS
./copys/BDIIALEDB2.PROC.ORI
./copys/BDIIALEDB2.PROC
./copys/BDIIALENEW.WS
./copys/BDIIALE-PLANO.FS
./copys/BDIIALE-PLANO.FD
find: cannot read dir ./stt: Permission denied
find: cannot read dir ./sf/.sunw: Permission denied
./database/desnovedat/BDIIALE
./database/desnovedat/BDIIALE.idx
./database/prunovedat/BDIIALE
./database/prunovedat/BDIIALE-ALEGRU
./database/prunovedat/BDIIALE-ALERTAS
./database/prunovedat/BDIIALE-GRUPOS
./database/prunovedat/BDIIALE-LOG-20140430
./database/prunovedat/BDIIALE-LOG-20140506
./database/prunovedat/BDIIALE-NEW
./database/prunovedat/BDIIALE-NEW.idx
./database/prunovedat/BDIIALE.err
./database/prunovedat/BDIIALE-ORI
./database/prunovedat/BDIIALE-ORI.idx
./database/prunovedat/BDIIALE.idx
./database/prunovedat/BDIIALE-LOG-20140509
./database/BDIIALE
./database/BDIIALE.idx
./database/documentacion/BDIIALE
./database/documentacion/BDIIALE.idx
./database/BDIIALE-ALERTAS
./database/BDIIALE-GRUPOS
./database/BDIIALE-ALEGRU
./database/BDIIALE_20140414
./database/BDIIALE_20140502
./database/BDIIALE-LOG-20140506
./database/BDIIALE-LOG-20140430
./database/BDIIALEDB2.20140508.core
./database/BDIIALE-NEW
./database/BDIIALE-NEW.idx
./database/BDIIALE-LOG-20140508
./BDIIALEDB2.aif
find: cannot read dir ./.ssh: Permission denied
icdgd@codes /d/iccol/desarrollo
$ view ./database/prunovedat/BDIIALE-LOG-20140506
"./database/prunovedat/BDIIALE-LOG-20140506" [Read only] 6 lines, 390 characters 1000791433812014050613451401G000L999!G001B999!G002J999!G005V999!
1000000002562014050613462301G000L999!G001B999!G002J999!G005V999!
1000000000012014050613463201G000L999!G001I006!G002J999!G005V999!
1000010373152014050613471901G000L999!G001B999!G002J999!G005V999!
1000791433812014050614351501G000L999!G001B999!G002J999!G005V999!
1000000000652014050614353001G000L999!G001B999!G002J999!G005V999!
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"./database/prunovedat/BDIIALE-LOG-20140506" [Read only] 6 lines, 390 characters:qicdgd@codes /d/iccol/desarrollo
$ ^[  $ view ./database/prunovedat/BDIIALE-LOG-20140506$ find . -name "BDIIALE*" -print                 $ 
./objetos/BDIIALEDB2.int
./objetos/BDIIALEDB2.gnt
./objetos/BDIIALEDB2.idy
./objetos/BDIIALEDB2.s
./objetos/BDIIALEDB2.lst
./fuentes/BDIIALE.CBL
find: cannot read dir ./fuentes/especiales/darlas: Permission denied
./fuentes/BDIIALENEW.aif
./fuentes/BDIIALEDB2.CBL
./fuentes/BDIIALEDB2.aif
./fuentes/BDIIALEDB2.20140502.core
./copys/BDIIALE-ANT.PROC
./copys/BDIIALE.FD
./copys/BDIIALE.FS
./copys/BDIIALENW.PROC
./copys/BDIIALET7.PROC-DARIO
./copys/BDIIALE.PROC
./copys/ley/BDIIALE.FD
./copys/ley/BDIIALE.FS
./copys/ley/BDIIALE-LEY.PROC
./copys/ley/BDIIALE.PROC
./copys/ley/BDIIALET7.PROC-DARIO
./copys/ley/BDIIALE.WS
./copys/BDIIALEDB2.DOC
./copys/BDIIALEJURAD.WS
./copys/BDIIALENEW.PROC
./copys/BDIIALENEW.PROC.F-OLD!
./copys/BDIIALE.WS-V05
./copys/BDIIALE.WS
./copys/BDIIALE.PROC-V06
./copys/BDIIALE.PROC.20130913
./copys/BDIIALE-BDINDE.WS
./copys/BDIIALE-BDINDE-RGH.PROC
./copys/BDIIALEV07.PROC
./copys/BDIIALE-BDINDE.PROC-OLD-2013-10-31
./copys/BDIIALEV08.PROC.F-OLD!
./copys/BDIIALEV08.PROC
./copys/BDIIALEPR.PROC
./copys/BDIIALE-BDINDE.PROC-OK2
./copys/BDIIALE-BDINDE.PROC-OK1
./copys/BDIIALE-BDINDE.PROC
./copys/BDIIALEJURAD.PROC
./copys/AMNISTIA/BDIIALE.PROC
./copys/documentacion/BDIIALE.PROC
./copys/documentacion/BDIIALE.WS
./copys/documentacion/BDIIALE.FD
./copys/documentacion/BDIIALE.FS
./copys/documentacion/BDIIALE-BDINDE.WS
./copys/documentacion/BDIIALE-BDINDE.PROC
./copys/BDIIALEDB2.WS
./copys/BDIIALEDB2.PROC.ORI
./copys/BDIIALEDB2.PROC
./copys/BDIIALENEW.WS
./copys/BDIIALE-PLANO.FS
./copys/BDIIALE-PLANO.FD
find: cannot read dir ./stt: Permission denied
find: cannot read dir ./sf/.sunw: Permission denied
./database/desnovedat/BDIIALE
./database/desnovedat/BDIIALE.idx
./database/prunovedat/BDIIALE
./database/prunovedat/BDIIALE-ALEGRU
./database/prunovedat/BDIIALE-ALERTAS
./database/prunovedat/BDIIALE-GRUPOS
./database/prunovedat/BDIIALE-LOG-20140430
./database/prunovedat/BDIIALE-LOG-20140506
./database/prunovedat/BDIIALE-NEW
./database/prunovedat/BDIIALE-NEW.idx
./database/prunovedat/BDIIALE.err
./database/prunovedat/BDIIALE-ORI
./database/prunovedat/BDIIALE-ORI.idx
./database/prunovedat/BDIIALE.idx
./database/prunovedat/BDIIALE-LOG-20140509
./database/BDIIALE
./database/BDIIALE.idx
./database/documentacion/BDIIALE
./database/documentacion/BDIIALE.idx
./database/BDIIALE-ALERTAS
./database/BDIIALE-GRUPOS
./database/BDIIALE-ALEGRU
./database/BDIIALE_20140414
./database/BDIIALE_20140502
./database/BDIIALE-LOG-20140506
./database/BDIIALE-LOG-20140430
./database/BDIIALEDB2.20140508.core
./database/BDIIALE-NEW
./database/BDIIALE-NEW.idx
./database/BDIIALE-LOG-20140508
./BDIIALEDB2.aif
find: cannot read dir ./.ssh: Permission denied
icdgd@codes /d/iccol/desarrollo
$ view ./copys/BDIIALEJURAD.PROC
"./copys/BDIIALEJURAD.PROC" [Read only] 761 lines, 51873 characters REMARK* BDIIALE.PROC.v.0008
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE PERMITEN EXTRACTAR
REMARK* LAS ALERTAS DEL SISTEMA
REMARK*     "I" : ALERTAS INTERNAS, SE CALCULAN CON BASE A LA INF DE BD
REMARK*01=No se usa
REMARK*02=Alertas sobre el ICMCRE
REMARK*03=Alertas sobre el ICMCHK
REMARK*04=Alertas sobre doble identidad
REMARK*04=Alertas sobre vigencia de registraduria en 12
REMARK*     "F" : ALERTAS EXTERNAS FIJAS - LAS DETERMINA DATACREDITO SOLO
REMARK*REQUIEREN DEL REGISTRO 001 PARA SU DEFINICION. SE RECONOCEN
REMARK*POR TENER LA LETRA "S" EN EL CAMPO TEXTO-FIJO-BDIIALE
REMARK*01=el documento de identidad fue extraviado
REMARK*02=el documento de identidad fue robado
REMARK*03=actualmente reside fuera de colombia
REMARK*04=Ya ha sido victima de suplantaciones
REMARK*     "E" : ALERTAS EXTERNAS VARIABLES : UNA ENTIDAD PUEDE COLOCAR
REMARK*DIRECTAMENTE UNA ALERTA. EL SIGNIFICADO DE CADA UNA LAS
REMARK*DEBE COLOCAR DATACREDITO. CONTIENE REGISTRO HEADER (1)
REMARK*DATAHOST (2-10) Y TEXTO (11-XX)
REMARK*01=POR ASIGNAR
REMARK*02=POR ASIGNAR
REMARK*03=POR ASIGNAR
REMARK*04=POR ASIGNAR
REMARK*
REMARK******************************************************************
REMARK* RMB0002   * TIPALE: SE AMPLIA EL CONCEPTO DE ALERTAS, DE MODO QUE
REMARK* R.MARTINEZ* NO TENGAN QUE ESTAR EN EL ARCHIVO DE ALERTAS SINO QUE
REMARK* ABRIL/2006* SE PUEDAN GENERAR A PARTIR DE OTROS ARCHIVOS DE LA BD
REAMRK** SE DEFINEN LAS QUE APLICAN A UN PAS EN EL ICBSYS.INI
REMARK******************************************************************
REMARK* RMB0003   * CIU001: SE HABILTAN EL MANEJO DE DATAHOST Y SE AFINA
REMARK* R.MARTINEZ*EL CONCEPTO DEFINIENDO TIPO DE ALERTAS Y SU
REMARK* OCTUB/2006*RESPECTIVAS SECUENCIAS
REMARK**SE CONTROLA LA PRESENTACION DE ALERTAS SOLO
REAMRK**SI ESTAN HABILITADAS SEGUN TIPO DE CONSULTAS
REMARK******************************************************************
REMARK* RMB0004   * CIU002: AJUSTES NECESARIOS PARA CATALOGAR EN PRODUC-
REMARK* R.MARTINEZ*CION EL CONCEPTO DE ALERTAS POR TENER INFOR-
REMARK* MARZO/2007*MACION COMO CEDULA Y TAMBIN COMO NIT
REMARK******************************************************************
REMARK* RMB0005   * T7T501: MANEJO DE IDENTIFICACIONES QUE PASAN DE T7 A
REMARK* R.MARTINEZ*T5 CUANDO QUEDA UNA HUELLA DE CONSULTA. SE
REMARK* AGOS./2007*CREAN 2 ALERTAS: 6 -INDICA QUE NO HAY INFORMA
REMARK**CION EN BD DE VALIDACION Y 7-SI EL APELLIDO
REMARK**CON EL QUE SE VUELVE A CONSULTAR ES DIFERENTE
REMARK******************************************************************
REMARK* ABB0006   * ICGCPL: SE ADICIONA MANEJO DEL NUEVO PRODUCTO HC+  *"./copys/BDIIALEJURAD.PROC" [Read only] 761 lines, 51873 characters/e^?Pattern not found:set ic:set nows/embargoAddress search hit BOTTOM without matching pattern/demandaAddress search hit BOTTOM without matching pattern/judiAddress search hit BOTTOM without matching pattern/judAddress search hit BOTTOM without matching pattern/crean




/bdiiale-alertasAddress search hit BOTTOM without matching pattern




/selectAddress search hit BOTTOM without matching patternREMARK******************************************************************
REMARK* ABB0006   * ICGCPL: SE ADICIONA MANEJO DEL NUEVO PRODUCTO HC+  *
REMARK* A.BERNAL  **
REMARK* SEPT./2009**
REMARK******************************************************************
* RMB0007     * INDE01 : SE MODIFICA LA ALARMA DE TENER INFO COMO*
* R.MARTINEZ  *TIPO 1 Y 2 A LA FIGURA DE INDEPENDIENTE *
* MAY/2013    *DONDE SE EXIGE ADICIONALMENTE QUE*
**COINCIDAN LOS NOMBRES PARA SACAR LA ALAR*
******************************************************************
* EHA0008     * INDE02 : SE INCLUYE ALERTA DE NO TEC CUANDO SE   *
* OCT/2013    * CQ.6807  CONSULTA UNA CEDULA POR PJ Y NO ES IND. *
******************************************************************
7000-RECORRER-BDIIALE.
REMARK******************************************************************
REMARK*7000-RECORRER-BDIIALE.
REMARK* PARA UNA IDENTIFICACION EN PARTICULAR SE REVISAN UNO A UNO LOS
REMARK* DIFERENTES TIPOS DE ALERTA QUE PUEDE TENER Y DE TENERLOS LOS EN-
REMARK* VIA A LA SECCION DE ALERTAS DEL INFORME. SOLO SE PRESENTAN LAS
REMARK* ALERTAS HABILITADAS PARA EL PAIS
REMARK******************************************************************MOVE 1 TO ENVIE.MOVE 0 TO CONT-LINEAS-BDIIALE.
CIU001     IF (ALEWEB-SYS = "SI" AND MOD-TAB = 0) ORRMB0003
CIU001(ALEDTH-SYS = "SI" AND MOD-TAB = 1 AND S-XML = 0) ORRMB0003
CIU001(ALEXML-SYS = "SI" AND MOD-TAB = 1 AND S-XML = 1)RMB0003
CIU001MOVE 1 TO IRMB0003
CIU001     ELSERMB0003
CIU001MOVE 40 TO IRMB0003
CIU001     END-IFRMB0003
CIU001     IF I = 1 AND MOD-TAB = 1 *> PARA DATHOST,XML,SERCEL ...RMB0003
CIU002AND  S-XML = 0RMB0004
CIU001MOVE SPACES TO INQ-COMANDO4RMB0003
CIU001UNSTRING MSG-ORIGINAL DELIMITED BY  ALL "[ALERTAS="RMB0003
CIU001INTO  INQ-FILLER INQ-COMANDO4RMB0003
CIU001IF INQ-COMANDO4(02:1) = "]"RMB0003
CIU001IF INQ-COMANDO4(1:1) NOT = "1"RMB0003
CIU001MOVE 40 TO IRMB0003
CIU001END-IFRMB0003
CIU001ELSERMB0003
CIU001MOVE 40 TO IRMB0003
CIU001END-IFRMB0003
CIU001     END-IF.RMB0003
CIU001     MOVE 1 TO ENVIE.RMB0003
CIU001     MOVE 0 TO CONT-LINEAS-BDIIALE.RMB0003
CIU001     PERFORM UNTIL I >= 40 OR V-ALERTA(I)=0RMB0003
CIU001EVALUATE V-ALERTA(I)RMB0003
TIPALEWHEN 1RMB0002
TIPALEPERFORM 7010-ALERTAS-BDIIALERMB0002TIPALEWHEN 1RMB0002
TIPALEPERFORM 7010-ALERTAS-BDIIALERMB0002
TIPALEWHEN 2RMB0002
TIPALEPERFORM 7020-ALERTAS-ICMCRERMB0002
TIPALEWHEN 3RMB0002
TIPALEPERFORM 7030-ALERTAS-ICMCHKRMB0002
TIPALEWHEN 4RMB0002
TIPALEPERFORM 7040-ALERTAS-DOBLE-IDENTIDADRMB0002
TIPALEWHEN 5RMB0002
TIPALEPERFORM 7050-ALERTAS-VIGENCIA-CEDRMB0002
T7T501WHEN 6RMB0005
T7T501IF FUE-UN-TIPO7 = 1RMB0005
T7T501PERFORM 7060-ALERTAS-NO-BDAIDERMB0005
T7T501END-IFRMB0005
T7T501WHEN 7RMB0005
T7T501IF FUE-UN-TIPO7 = 1RMB0005
T7T501PERFORM 7070-ALERTAS-APELLIDORMB0005
T7T501END-IFRMB0005
T7T501END-EVALUATERMB0005
TIPALEADD 1 TO IRMB0002
TIPALE     END-PERFORM.RMB0002
TIPALE     IF CONT-LINEAS-BDIIALE > 0RMB0002
TIPALEMOVE 1 TO RECRMB0002
TIPALEMOVE SPACESTO MOVIMIENTO-SRMB0002
TIPALEPERFORM 6700-CONT-CTARMB0002
T7T501MOVE 0 TO RECRMB0005
TIPALE     END-IF.RMB0002
TIPALE     IF ENVIE = 0RMB0002
TIPALEPERFORM 10900-ENVIA-CRCRRMB0002
TIPALE     END-IF.RMB0002

TIPALE 7010-ALERTAS-BDIIALE.RMB0002
REMARK*********************************************************************
REMARK*7010-ALERTAS-BDIIALE.
REMARK* SE RECORRE LAS POSIBLES ALERTAS PARA LA IDENTIFICACION BUSCADA,
REMARK* EXTRACTANDO LA INFORMACION DE "ENCABEZADO" , "CUERPO" y UN POSI
REMARK* DATAHOST QUE ESTA POR DEFINIR.
REMARK*********************************************************************IF ABIERTO-BDIIALE = 0OPEN INPUT  BDIIALEMOVE 1 TO ABIERTO-BDIIALE
YYYYYYPERFORM 8000-CARGAR-ALERTASDEF-BDIIALEEND-IF.
MOVE TIP-IDE-AUX-BDIIALE TO TIP-IDE-BDIIALE.MOVE NUM-IDE-AUX-BDIIALE TO NUM-IDE-BDIIALE.MOVE ZEROS  TO FUENTE-BDIIALEMOVE SPACES TO LLASEC-BDIIALE.MOVE 0 TO FIN-BDIIALE.
TIPALE     MOVE 0 TO PROCESAR-BDIIALE.RMB0002






TIPALE 7010-ALERTAS-BDIIALE.RMB0002
REMARK*********************************************************************
REMARK*7010-ALERTAS-BDIIALE.
REMARK* SE RECORRE LAS POSIBLES ALERTAS PARA LA IDENTIFICACION BUSCADA,
REMARK* EXTRACTANDO LA INFORMACION DE "ENCABEZADO" , "CUERPO" y UN POSI
REMARK* DATAHOST QUE ESTA POR DEFINIR.
REMARK*********************************************************************IF ABIERTO-BDIIALE = 0OPEN INPUT  BDIIALEMOVE 1 TO ABIERTO-BDIIALE
YYYYYYPERFORM 8000-CARGAR-ALERTASDEF-BDIIALEEND-IF.
MOVE TIP-IDE-AUX-BDIIALE TO TIP-IDE-BDIIALE.MOVE NUM-IDE-AUX-BDIIALE TO NUM-IDE-BDIIALE.MOVE ZEROS  TO FUENTE-BDIIALEMOVE SPACES TO LLASEC-BDIIALE.MOVE 0 TO FIN-BDIIALE.
TIPALE     MOVE 0 TO PROCESAR-BDIIALE.RMB0002START BDIIALE KEY > LLAVE-BDIIALEINVALID KEY
MOVE 1 TO FIN-BDIIALENOT INVALID KEY
READ BDIIALE   NEXT RECORD
AT END
MOVE 1 TO FIN-BDIIALEEND-READEND-START.
YYYYYY     MOVE 0 TO I-BDIIALE.
YYYYYY     MOVE SPACES TO M-ALEENV-BDIIALE.PERFORM UNTIL FIN-BDIIALE = 1 OR NUM-IDE-BDIIALE NOT =
NUM-IDE-AUX-BDIIALE OR
TIP-IDE-BDIIALE NOT =
TIP-IDE-AUX-BDIIALE
CIU001MOVE 1 TO PROCESAR-BDIIALERMB0003
CIU001PERFORM 7100-PROCESE-HEADER-BDIIALERMB0003
CIU001IF PROCESAR-BDIIALE = 1RMB0003
YYYYYYIF LLASEC-BDIIALE = SPACES
YYYYYYMOVE "E"TO TIPALE-AUX-BDIIALERMB0003
YYYYYYELSE
YYYYYYMOVE LLASEC-BDIIALE(1:1) TO TIPALE-AUX-BDIIALE
YYYYYYEND-IF
CIU001MOVE COD-ALERTA-BDIIALE TO CODALE-AUX-BDIIALERMB0003
YYYYYYADD 1 TO I-BDIIALE
YYYYYYMOVE TIPALE-AUX-BDIIALE TO
YYYYYYV-CODENV-BDIIALE(I-BDIIALE)(1:1)
YYYYYYMOVE CODALE-AUX-BDIIALE(1:3) TO
YYYYYYV-CODENV-BDIIALE(I-BDIIALE)(2:3)
YYYYYYMOVE FUENTE-BDIIALE TO
YYYYYYV-SUSENV-BDIIALE(I-BDIIALE)