=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.05.28 12:28:08 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Wed May 28 08:27:03 2014 from 172.16.10.67
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>archivo="qqq"
/d/iccol/desarrollo>echo $archivo
qqq
/d/iccol/desarrollo>archivo_icgs65=$archivo.icgs65^[  /d/iccol/desarrollo>archivo _icgs65=$archivo.icgs65 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 =$archivo.icgs6 
/d/iccol/desarrollo>echo $ar
qqq.icgs6
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>echo $arar=$archivo.icgs6ar=$archivo".icgs6".icgs6"ar2=$archivo".icgs6"
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>ar2=$archivo".icgs6"echo $ar            ar=$archivo.icgs6echo $ar         echo $ar2
qqq.icgs6
/d/iccol/desarrollo>expr   cho $(pwd)
/d/iccol/desarrollo
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>echo $(pwd)echo $()   e)x)p)r)) ) ) ) ")3)3)3)3)") )+) )0)
ksh: 3333:  not found

/d/iccol/desarrollo>^[  /d/iccol/desarrollo>echo $("3333" + 0)echo $("          "3333" + 0)$(e"3333" + 0)x"3333" + 0)p"3333" + 0)r"3333" + 0) "3333" + 0)
3333
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>echo $(expr "3333" + 0)/d/iccol/desarrollo>echo $(expr "z
expr: non-numeric argument

/d/iccol/desarrollo>
/d/iccol/desarrollo>echo $w

/d/iccol/desarrollo>w="12345"
/d/iccol/desarrollo>[[ $w == +([0-9]) ]] && "ok"
ksh: ok:  not found
/d/iccol/desarrollo>^[[A  /d/iccol/desarrollo>[[ $w == +([0-9]) ]] && "ok"/d/iccol/desarrollo>[[ $w !
/d/iccol/desarrollo>
/d/iccol/desarrollo>w="a99"
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>w="a99"[[ $w != +([0-9]) ]] && "ok"/d/iccol/desarrollo>[[ $w == +([0-9]) ]] && "ok"/d/iccol/desarrollo>
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ $w == +([0-9]) ]] && "ok"/d/iccol/desarrollo>w="a99"                     /d/iccol/desarrollo>[[ $w != +([0-9]) ]] && "ok"/d/iccol/desarrollo>
ksh: ok:  not found
/d/iccol/desarrollo>tpuc   t bel
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>tput bel
/d/iccol/desarrollo>[[ +(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]] && "ok"^[  /d/iccol/desarrollo>)([012][09]|3[01]) ]] && "ok"                            </d/iccol/desarrollo>[[ +(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]] && >/d/iccol/desarrollo>[[[+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]] && "/d/iccol/desarrollo>[[ +(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]] && /d/iccol/desarrollo>[[ "+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]] &&/d/iccol/desarrollo>[[ "2+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]] &/d/iccol/desarrollo>[[ "20+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]] /d/iccol/desarrollo>[[ "201+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]]/d/iccol/desarrollo>[[ "2014+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) ]/d/iccol/desarrollo>[[ "20140+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]) /d/iccol/desarrollo>[[ "201405+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01])/d/iccol/desarrollo>[[ "2014052+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01]/d/iccol/desarrollo>[[ "20140529+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[01/d/iccol/desarrollo>[[ "20140529"+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[0/d/iccol/desarrollo>[[ "20140529" +(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3[/d/iccol/desarrollo>[[ "20140529" =+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|3/d/iccol/desarrollo>[[ "20140529" ==+(20[012][0-9])(0[1-0]|1[1-2])([012][09]|/d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([012][09]/d/iccol/desarrollo>[[ "20140529" == 
ksh: syntax error: `(' unexpected
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([012][09]>/d/iccol/desarrollo>)([012][09]|3[01]) ]] && "ok"                            </d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([012][09]>/d/iccol/desarrollo>
ksh: syntax error: `(' unexpected
/d/iccol/desarrollo>^[[A  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([012][09]>/d/iccol/desarrollo>
ksh: syntax error: `(' unexpected
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([012][09]>/d/iccol/desarrollo>
ksh: syntax error: `(' unexpected
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([012][09]>/d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])0[1-0]|1[1-2])([012][09]|[1-0]|1[1-2])([012][09]|31-0]|1[1-2])([012][09]|3[-0]|1[1-2])([012][09]|3[00]|1[1-2])([012][09]|3[01]|1[1-2])([012][09]|3[01]|1[1-2])([012][09]|3[01])1[1-2])([012][09]|3[01]) [1-2])([012][09]|3[01]) ]1-2])([012][09]|3[01]) ]]-2])([012][09]|3[01]) ]] 2])([012][09]|3[01]) ]] &])([012][09]|3[01]) ]] &&)([012][09]|3[01]) ]] && ([012][09]|3[01]) ]] && "[012][09]|3[01]) ]] && "o012][09]|3[01]) ]] && "ok12][09]|3[01]) ]] && "ok" 2][09]|3[01]) ]] && "ok" ][09]|3[01]) ]] && "ok" [09]|3[01]) ]] && "ok" 09]|3[01]) ]] && "ok" 9]|3[01]) ]] && "ok" ]|3[01]) ]] && "ok" |3[01]) ]] && "ok" 3[01]) ]] && "ok" [01]) ]] && "ok" 01]) ]] && "ok" 1]) ]] && "ok" ]) ]] && "ok" ) ]] && "ok" 0) ]] && "ok"5) ]] && "ok"2) ]] && "ok"9) ]] && "ok"
ksh: syntax error: `)' unexpected
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])0529) ]] && "ok"/d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9])05290529) ]] && "ok" 
ksh: ok:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9]0529) ]] && "ok"/d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9]529) ]] && "ok" [529) ]] && "ok"o529) ]] && "ok"529) ]] && "ok" 529) ]] && "ok" s529) ]] && "ok"529) ]] && "ok" ]29) ]] && "ok" (29) ]] && "ok"029) ]] && "ok"529) ]] && "ok"|29) ]] && "ok"029) ]] && "ok"629) ]] && "ok")29) ]] && "ok"
ksh: ok:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9](05|06)29) ]] && "ok"/d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9](|06)29) ]] && "ok"  [|06)29) ]] && "ok"0|06)29) ]] && "ok"05|06)29) ]] && "ok"0|06)29) ]] && "ok" [|06)29) ]] && "ok"0|06)29) ]] && "ok"-|06)29) ]] && "ok"9|06)29) ]] && "ok"]|06)29) ]] && "ok"
ksh: ok:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9](0[0-9]|06)29) ]] && "ok"/d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9](0[0-9]|)29) ]] && "ok"  1)29) ]] && "ok"[)29) ]] && "ok"1)29) ]] && "ok"2)29) ]] && "ok>])29) ]] && "o
ksh: ok:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140529" == +(20[012][0-9](0[0-9]|1[12])29) ]] && "o>/d/iccol/desarrollo>[[ "2014012
ksh: ok:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])29) ]] && "o>/d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])) ]] && "ok" () ]] && "ok>[) ]] && "o0) ]] && "1) ]] && 2) ]] &&]) ]] &[) ]] 0) ]]-) ]9) ])|/d/iccol/desarrollo>9](0[0-9]|1[12])([012][0-9]|3) ]] && "ok"                <[) ]] && "ok"0) ]] && "ok"1) ]] && "ok"]) ]] && "ok"
> c ^C
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]/d/iccol/desarrollo>9](0[0-9]|1[12])([012][0-9]|3[01]) ]] && "ok"            <3[01])) ]] && "ok"
ksh: ok:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]/d/iccol/desarrollo>9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"           <3/d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[012][0-9]|3[01])) ]] && "ok"                            </d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "z
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "z0141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>                                                          /d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "1999
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "19991229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>                                                          /d/iccol/desarrollo>[[ "z0141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|/d/iccol/desarrollo>[[ "2014125
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20541229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "2011413
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20141329" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "2014101
ksh: ok:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140129" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "2014014
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140149" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "20140100
ksh: ok:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>[[ "20140100" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|>/d/iccol/desarrollo>[[ "20140132
/d/iccol/desarrollo>fg
ksh: fg: no such job
/d/iccol/desarrollo>jon bs
/d/iccol/desarrollo>ma
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>majobsfg  [[ "20140132" == +(20[012][0-9](0[0-9]|1[12])([012>/d/iccol/desarrollo/macros>[[ "20140100" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "20140149" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "20140129" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "20141329" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "20541229" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "19991229" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "z0141229" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012/d/iccol/desarrollo/macros>[[ "20141229" == +(20[012][0-9](0[0-9]|1[12])29) ]/d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9](0[0-9]|1[12])29) ]/d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9](0[0-9]|06)29) ]] &/d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9](05|06)29) ]] && "o/d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9]0529) ]] && "ok"    /d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9])0529) ]] && "ok"/d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([0>/d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([0/d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([0/d/iccol/desarrollo/macros>[[ "20140529" == +(20[012][0-9])(0[1-0]|1[1-2])([0/d/iccol/desarrollo/macros>tput bel                                           /d/iccol/desarrollo/macros>tput bel[[ $w != +([0-9]) ]] && "ok"/d/iccol/desarrollo/macros>[[ $w == +([0-9]) ]] && "ok"/d/iccol/desarrollo/macros>w="a99"                     /d/iccol/desarrollo/macros>[[ $w != +([0-9]) ]] && "ok"/d/iccol/desarrollo/macros>[[ $w == +([0-9]) ]] && "ok"/d/iccol/desarrollo/macros>w="12345"                   /d/iccol/desarrollo/macros>echo $w  echo $(expr "z333" + 0)echo $(expr "3333" + 0)echo $(expr "z333" + 0)echo $w                w="12345"[[ $w == +([0-9]) ]] && "ok"/d/iccol/desarrollo/macros>w="12345"                   /d/iccol/desarrollo/macros>echo $w  echo $(expr "z333" + 0)echo $(expr "3333" + 0)echo $("3333" + 0)     echo $(pwd)       echo $ar2  ar2=$archivo".icgs6"echo $ar            ar=$archivo.icgs6echo $archivo    archivo="qqq". viset      echo $SHELL # muestra $SHELL/d/iccol/desarrollo/macros>echo $SHELL # muestra       /d/iccol/desarrollo/macros>echo $fechah6        fechah6=`echo $fechah  | cut -c1-6`/d/iccol/desarrollo/macros>fechah=`date '+%Y%m%d'`            /d/iccol/desarrollo/macros>echo =`date '+%Y%m%d'` echo ${w}.qqq         unset w      echo ${w}.qqqecho $w.qqq  w="www"    vi sh-PE-Ripleysh-PE-Ripley   ma          . visettput belcat sh-PE-Ripleyfg              cat sh-PE-Ripleytput bel        . viset ma     sh-PE-Ripleyvsh-PE-Ripleyish-PE-Ripley sh-PE-Ripley
"sh-PE-Ripley" 274 lines, 9009 characters # /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    NITSuscriptor=900047981
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor""sh-PE-Ripley" 274 lines, 9009 characters:set allautoindentnomodelinesshowmodeautoprintnonumbernoslowopennoautowritenonovicetabstop=4nobeautifynooptimizetaglength=0directory=/var/tmpparagraphs=IPLPPPQPP LIpplpipnppplpipbptags=tags /usr/lib/tagsnoedcompatibleprompttagstacknoerrorbellsnoreadonlyterm=vt220noexrcredrawnoterseflashremaptimeouthardtabs=8report=5ttytype=vt220ignorecasescroll=24warnnolispsections=NHSHH HUuhsh+cwindow=49nolistshell=/bin/kshnowrapscanmagicshiftwidth=4wrapmargin=0mesgshowmatchnowriteany[Hit return to continue] # /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    NITSuscriptor=900047981
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor":set noai
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
274 lines deletedNo lines in bufferAPPEND MODE# /d/iccol/desarrollo/macros/sh-PE-Ripley

#sh-PE-Ripley.V.1.0001


#*******************************************************************************



#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:       Globant - JL
#*******************************************************************************
# Definición de constantes
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#       si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
        NOM_ARCHIVO=" "
        TIPO_ARCHIVO="1"
#       si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
        TIPO_EXTRACT="N"
#           si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACT
            ID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#       Si TIPO_PROC="H": la fecha de proceso
        FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
        echo " "
#             ......................................................................
        echo "                          FECHA DE PROCESO"
        echo $raya

        echo "      Ingrese fecha de proceso,"

APPEND MODE        echo "      enter para cancelar"

APPEND MODE        echo " "

APPEND MODE        echo "            FECHA de PROCESO AAAAMMDD:\c"

APPEND MODE        read FECHA_PROCnew

APPEND MODE        if [ -z $FECHA_PROCnew ]

APPEND MODE        then

APPEND MODE            loopEnd="1"

APPEND MODE            exit

APPEND MODE        fi

APPEND MODE        # debe ser solo números

APPEND MODE        if [[ "$FECHA_PROCnew" != +([0-9]) ]] 

APPEND MODE        then

APPEND MODE            echo "la fecha solamente puede contener dígitos"

APPEND MODE            tput bel

APPEND MODE            tput cuu 7

APPEND MODE        fi

APPEND MODE        # rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31

APPEND MODE        # [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"

APPEND MODE        if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]

APPEND MODE        then

APPEND MODE            echo "la fecha es inválida"

APPEND MODE            tput bel

APPEND MODE            tput cuu 7

APPEND MODE        fi

APPEND MODE        # control de longitud

APPEND MODE        if [ ${#FECHA_PROCnew} -gt 6 ]

APPEND MODE        then

APPEND MODE            echo "longitud incorrecta del dato"

APPEND MODE            tput bel

APPEND MODE            tput cuu 7

APPEND MODE        fi

APPEND MODE        # debe ser menor que la fecha actual

APPEND MODE        if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]

APPEND MODE        then

APPEND MODE            echo "la fecha de proceso histórico debe ser anterior a la actual"

APPEND MODE            tput bel

APPEND MODE            tput cuu 7

APPEND MODE        fi

APPEND MODE        # todo bien

APPEND MODE        FECHA_PROC=$FECHA_PROCnew

APPEND MODE        loopEnd="1"

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEreadTIPO_PROC() {

APPEND MODE#*******************************************************************************

APPEND MODE# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor

APPEND MODE#*******************************************************************************

APPEND MODE    loopEnd="0"

APPEND MODE    while [ $loopEnd == "0" ]

APPEND MODE    do

APPEND MODE        echo " "

APPEND MODE#             ......................................................................

APPEND MODE        echo "                          TIPO DE PROCESO"

APPEND MODE        echo $raya

APPEND MODE        echo "      A) Proceso actual"

APPEND MODE        echo "      H) Proceso histórico"

APPEND MODE        echo "      enter para cancelar"

APPEND MODE        echo " "

APPEND MODE        echo "            TIPO de PROCESO:\c"

APPEND MODE        read TIPO_PROCnew

APPEND MODE        if [ -z $TIPO_PROCnew ]

APPEND MODE        then

APPEND MODE            loopEnd="1"

APPEND MODE            exit

APPEND MODE        fi

APPEND MODE        if [ $TIPO_PROCnew == "a" ]

APPEND MODE        then

APPEND MODE            TIPO_PROCnew="A"

APPEND MODE        fi

APPEND MODE        if [ $TIPO_PROCnew == "h" ]

APPEND MODE        then

APPEND MODE            TIPO_PROCnew="H"

APPEND MODE        fi

APPEND MODE        if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]

APPEND MODE        then

APPEND MODE            TIPO_PROC=$TIPO_PROCnew

APPEND MODE            loopEnd="1"

APPEND MODE        else

APPEND MODE            printf "\7"

APPEND MODE            tput cuu 8

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEreadTIPO_EXTRACT() {

APPEND MODE#*******************************************************************************

APPEND MODE# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor

APPEND MODE#*******************************************************************************

APPEND MODE    loopEnd="0"

APPEND MODE    while [ $loopEnd == "0" ]

APPEND MODE    do

APPEND MODE        echo " "

APPEND MODE#             ......................................................................

APPEND MODE        echo "                         TIPO DE EXTRACCIÓN"

APPEND MODE        echo $raya

APPEND MODE        echo "      N) Por NIT"

APPEND MODE        echo "      C) Por codigo de suscriptor"

APPEND MODE        echo "      enter para cancelar"

APPEND MODE        echo " "

APPEND MODE        echo "            TIPO de EXTRACCCIÓN:\c"

APPEND MODE        read TIPO_EXTRACTnew

APPEND MODE        if [ -z $TIPO_EXTRACTnew ]

APPEND MODE        then

APPEND MODE            loopEnd="1"

APPEND MODE            exit

APPEND MODE        fi

APPEND MODE        if [ $TIPO_EXTRACTnew == "c" ]

APPEND MODE        then

APPEND MODE            TIPO_EXTRACTnew="C"

APPEND MODE        fi

APPEND MODE        if [ $TIPO_EXTRACTnew == "n" ]

APPEND MODE        then

APPEND MODE            TIPO_EXTRACTnew="N"

APPEND MODE        fi

APPEND MODE        if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]

APPEND MODE        then

APPEND MODE            TIPO_EXTRACT=$TIPO_EXTRACTnew

APPEND MODE            loopEnd="1"

APPEND MODE        else

APPEND MODE            printf "\7"

APPEND MODE            tput cuu 8

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEreadTIPO_ARCHIVO() {

APPEND MODE#*******************************************************************************

APPEND MODE# Lee el tipo de archivo "0"=1-11  "1"=1-11-45

APPEND MODE#*******************************************************************************

APPEND MODE    loopEnd="0"

APPEND MODE    while [ $loopEnd == "0" ]

APPEND MODE    do

APPEND MODE        echo " "

APPEND MODE#             ......................................................................

APPEND MODE        echo "                    ESTRUCTURA DEL ARCHIVO BASE"

APPEND MODE        echo $raya

APPEND MODE        echo "      0) 1-11"

APPEND MODE        echo "      1) 1-11-45"

APPEND MODE        echo "      enter para cancelar"

APPEND MODE        echo " "

APPEND MODE        echo "            ESTRUCTURA:\c"

APPEND MODE        read TIPO_ARCHIVOnew

APPEND MODE        if [ -z $TIPO_ARCHIVOnew ]

APPEND MODE        then

APPEND MODE            loopEnd="1"

APPEND MODE            exit

APPEND MODE        fi

APPEND MODE        if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]

APPEND MODE        then

APPEND MODE            TIPO_ARCHIVO=$TIPO_ARCHIVOnew

APPEND MODE            loopEnd="1"

APPEND MODE        else

APPEND MODE            printf "\7"

APPEND MODE            tput cuu 8

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEreadNOM_ARCHIVO() {

APPEND MODE#*******************************************************************************

APPEND MODE# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES

APPEND MODE#*******************************************************************************

APPEND MODE    loopEnd="0"

APPEND MODE    while [ $loopEnd == "0" ]

APPEND MODE    do

APPEND MODE        echo " "

APPEND MODE#             ......................................................................

APPEND MODE        echo "                       NOMBRE DEL ARCHIVO BASE"

APPEND MODE        echo $raya

APPEND MODE        echo "      Ingrese el nombre del archivo base,"

APPEND MODE        echo "      enter para cancelar"

APPEND MODE        echo " "

APPEND MODE                tput el

APPEND MODE        echo "            ARCHIVO:\c"

APPEND MODE        read NOM_ARCHIVOnew

APPEND MODE                tput el

APPEND MODE        if [ -z $NOM_ARCHIVOnew ]

APPEND MODE        then

APPEND MODE            loopEnd="1"

APPEND MODE            exit

APPEND MODE        fi

APPEND MODE        if [ -d $NOM_ARCHIVOnew ]

APPEND MODE        then

APPEND MODE            echo $NOM_ARCHIVOnew" es un nombre de directorio"

APPEND MODE            printf "\7"

APPEND MODE            tput cuu 8

APPEND MODE        else

APPEND MODE            if [ ! -f $NOM_ARCHIVOnew ]

APPEND MODE            then

APPEND MODE                echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"

APPEND MODE                printf "\7"

APPEND MODE                tput cuu 8

APPEND MODE            else

APPEND MODE                NOM_ARCHIVO=$NOM_ARCHIVOnew

APPEND MODE                loopEnd="1"

APPEND MODE            fi

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEreadBASE() {

APPEND MODE#*******************************************************************************

APPEND MODE# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela

APPEND MODE#*******************************************************************************

APPEND MODE    loopEnd="0"

APPEND MODE    while [ $loopEnd == "0" ]

APPEND MODE    do

APPEND MODE        echo " "

APPEND MODE#             ......................................................................

APPEND MODE        echo "                       ORIGEN DE LA BASE"

APPEND MODE        echo $raya

APPEND MODE        echo "      I) Interna"

APPEND MODE        echo "      C) Provista por el Cliente"

APPEND MODE        echo "      enter para cancelar"

APPEND MODE        echo " "

APPEND MODE        echo "            BASE:\c"

APPEND MODE        read BASEnew

APPEND MODE        if [ -z $BASEnew ]

APPEND MODE        then

APPEND MODE            loopEnd="1"

APPEND MODE            exit

APPEND MODE        fi

APPEND MODE        if [ $BASEnew == "c" ]

APPEND MODE        then

APPEND MODE            BASEnew="C"

APPEND MODE        fi

APPEND MODE        if [ $BASEnew == "i" ]

APPEND MODE        then

APPEND MODE            BASEnew="I"

APPEND MODE        fi

APPEND MODE        if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]

APPEND MODE        then

APPEND MODE            BASE=$BASEnew

APPEND MODE            loopEnd="1"

APPEND MODE        else

APPEND MODE            printf "\7"

APPEND MODE            tput cuu 8

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEreadID_EXTRACT() {

APPEND MODE#*******************************************************************************

APPEND MODE# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor

APPEND MODE#*******************************************************************************

APPEND MODE#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR

APPEND MODE    if [ $ID_EXTRACT == "N" ]

APPEND MODE    then

APPEND MODE        criterioExtraccion = "NIT"

APPEND MODE        inputLen=11

APPEND MODE    else

APPEND MODE        criterioExtraccion = "COD SUSCRIPTOR"

APPEND MODE        inputLen=6

APPEND MODE    fi

APPEND MODE    loopEnd="0"

APPEND MODE    while [ $loopEnd == "0" ]

APPEND MODE    do

APPEND MODE        echo " "

APPEND MODE#             ......................................................................

APPEND MODE        echo "                $criterioExtraccion PARA LA EXTRACCIÓN"

APPEND MODE        echo $raya

APPEND MODE

APPEND MODE        echo "      Ingrese el "$criterioExtraccion" para extracción,"

APPEND MODE        echo "      enter para cancelar"

APPEND MODE        echo " "

APPEND MODE        tput el                     # borra caracteres sobrantes

APPEND MODE        echo "            $criterioExtraccion:\c"

APPEND MODE        read ID_EXTRACTnew

APPEND MODE        tput el                     # borra mensaje de error

APPEND MODE        if [ -z $ID_EXTRACTnew ]

APPEND MODE        then

APPEND MODE            loopEnd="1"

APPEND MODE            exit

APPEND MODE        fi

APPEND MODE        # debe ser solo números

APPEND MODE        if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]] 

APPEND MODE        then

APPEND MODE            echo "el dato ingresado debe ser numérico"

APPEND MODE            printf "\7"

APPEND MODE            tput cuu 8

APPEND MODE        fi

APPEND MODE        # control de longitud (11 o 6)

APPEND MODE        if [ ${#ID_EXTRACTnew} -gt inputLen ]

APPEND MODE        then

APPEND MODE            echo "longitud incorrecta del dato"

APPEND MODE            printf "\7"

APPEND MODE            tput cuu 8

APPEND MODE        fi

APPEND MODE        ID_EXTRACT=$ID_EXTRACTnew

APPEND MODE        loopEnd="1"

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEparamsGet() {

APPEND MODE#*******************************************************************************

APPEND MODE# Lee los parámetros de la corrida anterior

APPEND MODE#*******************************************************************************

APPEND MODE#   asegura que exista el arch de parámetros general

APPEND MODE    [ ! -f $0.parm ] && touch $0.parm

APPEND MODE#   lee los parámetros

APPEND MODE    params=`cat $0.parm`

APPEND MODE    echo '>>>> params: ' "$params"

APPEND MODE#   separa los parámetros según su posición

APPEND MODE    BASE=`echo "$params" | cut -d ";" -f1`

APPEND MODE    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`

APPEND MODE    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`

APPEND MODE    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`

APPEND MODE    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`

APPEND MODE    TIPO_PROC=`echo "$params" | cut -d ";" -f6`

APPEND MODE    FECHA_PROC=`echo "$params" | cut -d ";" -f7`

APPEND MODE}

APPEND MODE

APPEND MODEparamsPut() {

APPEND MODE#*******************************************************************************

APPEND MODE# Guarda los parámetros de la corrida en el archivo .parm

APPEND MODE#*******************************************************************************

APPEND MODE@

APPEND MODE    echo $BASE";"$NOM_ARCHIVO";"$TIPO_ARCHIVO";"$TIPO_EXTRACT";"$ID_EXTRACT";"$TIPO_PROC";"
$F

APPEND MODE    FECHA_PROC >| $0.parm

APPEND MODE}

APPEND MODE

APPEND MODEparamsPrint() {

APPEND MODE#*******************************************************************************

APPEND MODE# Muestra todos los parámetros, para pruebas

APPEND MODE#*******************************************************************************

APPEND MODE    echo "BASE="$BASE"<"

APPEND MODE    echo "NOM_ARCHIVO="$NOM_ARCHIVO"<"

APPEND MODE    echo "TIPO_ARCHIVO="$TIPO_ARCHIVO"<"

APPEND MODE    echo "TIPO_EXTRACT="$TIPO_EXTRACT"<"

APPEND MODE    echo "ID_EXTRACT="$ID_EXTRACT"<"

APPEND MODE    echo "TIPO_PROC="$TIPO_PROC"<"

APPEND MODE    echo "FECHA_PROC="$FECHA_PROC"<"

APPEND MODE}

APPEND MODE

APPEND MODE

APPEND MODE#*******************************************************************************

APPEND MODE#*******************************************************************************

APPEND MODE#                                     MAIN

APPEND MODE#*******************************************************************************

APPEND MODE#*******************************************************************************

APPEND MODE    #Fecha de ejecución

APPEND MODE    fechaHastaYYYYMMDD=`date '+%Y%m%d'`

APPEND MODE    fechaHastaYYYYMM=`echo $fechaHastaYYYYMMDD  | cut -c1-6`

APPEND MODE

APPEND MODE    clear

APPEND MODE    echo $raya

APPEND MODE    echo "$ASCIIBanner"

APPEND MODE#   banner "PE Ripley"

APPEND MODE    echo $raya

APPEND MODE

APPEND MODE    paramsGet

APPEND MODE    readBASE

APPEND MODE    if [ $BASE == "C" ]

APPEND MODE    then

APPEND MODE        readNOM_ARCHIVO

APPEND MODE        readTIPO_ARCHIVO

APPEND MODE    else

APPEND MODE        readTIPO_EXTRACT

APPEND MODE        readID_EXTRACT              # NIT o cod suscriptor

APPEND MODE    fi

APPEND MODE    readTIPO_PROC

APPEND MODE    if [ $TIPO_PROC == "H" ]

APPEND MODE    then

APPEND MODE        readFECHA_PROC

APPEND MODE    fi

APPEND MODE

APPEND MODE    paramsPrint

APPEND MODE    paramsPut

APPEND MODE    # DEBUG: termina acá

APPEND MODE    echo " "

APPEND MODE    echo "HASTA ACÁ LLEGAMOS POR AHORA"

APPEND MODE    echo "(pero estamos avanzando más rápido)"

APPEND MODE    exit

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE#*******************************************************************************

APPEND MODE#*******************************************************************************

APPEND MODE#*******************************************************************************

APPEND MODE# de aquí para abajo, falta integrar (parte inexplorada)

APPEND MODE#*******************************************************************************

APPEND MODE#*******************************************************************************

APPEND MODE#*******************************************************************************

APPEND MODE

:w"sh-PE-Ripley" 434 lines, 14013 characters 
[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>vi sh-PE-Ripleysh-PE-Ripley   
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:klsdjfhdklgh
El archivo klsdjfhdklgh no se encuentra
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:19531221
la fecha es inválida
longitud incorrecta del dato
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=19531221<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************
#*******************************************************************************
#MAIN
#*******************************************************************************
#*******************************************************************************
    #Fecha de ejecución
    fechaHastaYYYYMMDD=`date '+%Y%m%d'`
    fechaHastaYYYYMM=`echo $fechaHastaYYYYMMDD  | cut -c1-6`clear
echo $raya
    echo "$ASCIIBanner"
#   banner "PE Ripley"
    echo $rayaparamsGet
    readBASE
    if [ $BASE == "C" ]
    then
readNOM_ARCHIVO
readTIPO_ARCHIVO
    else
readTIPO_EXTRACT
readID_EXTRACT# NIT o cod suscriptor
    fi
readTIPO_PROC
    if [ $TIPO_PROC == "H" ]
    then
readFECHA_PROC
    fi

paramsPrint
    paramsPut
    # DEBUG: termina acá
    echo " "
    echo "HASTA ACÁ LLEGAMOS POR AHORA"
    echo "(pero estamos avanzando más rápido)"
    exit



#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
# de aquí para abajo, falta integrar (parte inexplorada)
#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# control de longitud
if [ ${#FECHA_PROCnew} -gt 6 ]
then
echo "longitud incorrecta del dato"tput bel
tput cuu 7
fi
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# todo bien
FECHA_PROC=$FECHA_PROCnew
loopEnd="1"
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
7 lines deleted:w"sh-PE-Ripley" 427 lines, 13828 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCCIÓN:n
sh-PE-Ripley[5]: test: argument expected
sh-PE-Ripley[10]: criterioExtraccion:  not found
 
                 PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  para extracción,
      enter para cancelar
 
            :a
el dato ingresado debe ser numérico
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:w
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCCIÓN:
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:w
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCCIÓN:n
sh-PE-Ripley[5]: test: argument expected
sh-PE-Ripley[10]: criterioExtraccion:  not found
 
                 PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  para extracción,
      enter para cancelar
 
            :
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# todo bien
FECHA_PROC=$FECHA_PROCnew
loopEnd="1"
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"echo "C) Por codigo de suscriptor"echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"$CHANGE MODEtput bel:w"sh-PE-Ripley" 427 lines, 13825 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCCIÓN:w
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCCIÓN:n
sh-PE-Ripley[5]: test: argument expected
sh-PE-Ripley[10]: criterioExtraccion:  not found
 
                 PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  para extracción,
      enter para cancelar
 
            :
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripleyfg          
vi sh-PE-Ripley
echo "C) Por codigo de suscriptor"echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
 TIPO_EXTRACTTIPO_EXTRACT


    



OPEN MODE    echo "done with  TIPO_EXTRACTTAPPEND MODE"echo "N) Por NIT"echo $rayaecho "TIPO DE EXTRACCIÓN"#......................................................................echo " "    do    while [ $loopEnd == "0" ]    loopEnd="0"#*******************************************************************************# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor#*******************************************************************************readTIPO_EXTRACT() {}

/readtipo_ex
#*******************************************************************************
#*******************************************************************************
#MAIN
#*******************************************************************************
#*******************************************************************************
    #Fecha de ejecución
    fechaHastaYYYYMMDD=`date '+%Y%m%d'`
    fechaHastaYYYYMM=`echo $fechaHastaYYYYMMDD  | cut -c1-6`clear
echo $raya
    echo "$ASCIIBanner"
#   banner "PE Ripley"
    echo $rayaparamsGet
    readBASE
    if [ $BASE == "C" ]
    then
readNOM_ARCHIVO
readTIPO_ARCHIVO
    else
readTIPO_EXTRACT
readID_EXTRACT# NIT o cod suscriptor
    fi
readTIPO_PROC
    if [ $TIPO_PROC == "H" ]
    then
readFECHA_PROC
    fi

paramsPrint
    paramsPut
    # DEBUG: termina acá
    echo " "
    echo "HASTA ACÁ LLEGAMOS POR AHORA"
    echo "(pero estamos avanzando más rápido)"
    exit



#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
# de aquí para abajo, falta integrar (parte inexplorada)
#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
T:w"sh-PE-Ripley" 428 lines, 13820 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCCIÓN:n
done with TIPO_EXTRACT
sh-PE-Ripley[5]: test: argument expected
sh-PE-Ripley[10]: criterioExtraccion:  not found
 
                 PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  para extracción,
      enter para cancelar
 
            :
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley

#*******************************************************************************
#*******************************************************************************
#MAIN
#*******************************************************************************
#*******************************************************************************
    #Fecha de ejecución
    fechaHastaYYYYMMDD=`date '+%Y%m%d'`
    fechaHastaYYYYMM=`echo $fechaHastaYYYYMMDD  | cut -c1-6`clear
echo $raya
    echo "$ASCIIBanner"
#   banner "PE Ripley"
    echo $rayaparamsGet
    readBASE
    if [ $BASE == "C" ]
    then
readNOM_ARCHIVO
readTIPO_ARCHIVO
    else
readTIPO_EXTRACT
readID_EXTRACT
    fi
readTIPO_PROC
    if [ $TIPO_PROC == "H" ]
    then
readFECHA_PROC
    fi

paramsPrint
    paramsPut
    # DEBUG: termina acá
    echo " "
    echo "HASTA ACÁ LLEGAMOS POR AHORA"
    echo "(pero estamos avanzando más rápido)"
    exit



#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
# de aquí para abajo, falta integrar (parte inexplorada)
#*******************************************************************************
#*******************************************************************************
#*******************************************************************************# NIT o cod suscriptorID_EXTRACT=$ID_EXTRACTnewloopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}

paramsPut() {
#*******************************************************************************
# Guarda los parámetros de la corrida en el archivo .parm
#*******************************************************************************
@
   echo $BASE";"$NOM_ARCHIVO";"$TIPO_ARCHIVO";"$TIPO_EXTRACT";"$ID_EXTRACT";"$TIPO_PROC";"
$F
  FECHA_PROC >| $0.parm
}

paramsPrint() {
#*******************************************************************************
# Muestra todos los parámetros, para pruebas
#*******************************************************************************
    echo "BASE="$BASE"<"
    echo "NOM_ARCHIVO="$NOM_ARCHIVO"<"
    echo "TIPO_ARCHIVO="$TIPO_ARCHIVO"<"
    echo "TIPO_EXTRACT="$TIPO_EXTRACT"<"
    echo "ID_EXTRACT="$ID_EXTRACT"<"
    echo "TIPO_PROC="$TIPO_PROC"<"
    echo "FECHA_PROC="$FECHA_PROC"<"
}


#*******************************************************************************# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"/^readreadFECHA_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# todo bien
FECHA_PROC=$FECHA_PROCnew
loopEnd="1"
    done
}

# $CHANGE MODEFecha de proceso, 
c
ru
oa
tn
pt
io
r 
cdodo t
stipo de extracción
$CHANGE MODE es "H"
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]doecho " "
readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
echo "done with TIPO_EXTRACT"
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
echo "done with TIPO_EXTRACT"
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    dor/ccc$CHANGE MODE:w"sh-PE-Ripley" 428 lines, 13833 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
done with TIPO_EXTRACT
sh-PE-Ripley[5]: test: argument expected
sh-PE-Ripley[10]: criterioExtraccion:  not found
 
                 PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  para extracción,
      enter para cancelar
 
            :
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
echo "done with TIPO_EXTRACT"
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do# todo bienFECHA_PROC=$FECHA_PROCnew
loopEnd="1"
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# todo bien
FECHA_PROC=$FECHA_PROCnew# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"/para la extracci.ntput cuu 8fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $ID_EXTRACT == "N" ]
    then
criterioExtraccion = "NIT"
inputLen=11
    else
criterioExtraccion = "COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"printf "\7"
tput cuu 8
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -gt inputLen ]
then
echo "longitud incorrecta del dato"
    ==:w"sh-PE-Ripley" 428 lines, 13829 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
done with TIPO_EXTRACT
sh-PE-Ripley[5]: test: argument expected
 
                COD SUSCRIPTOR PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el COD SUSCRIPTOR para extracción,
      enter para cancelar
 
            COD SUSCRIPTOR:123456789
longitud incorrecta del dato
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
tput cuu 8fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $ID_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"printf "\7"
tput cuu 8
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -gt inputLen ]
then
echo "longitud incorrecta del dato"/done withAddress search hit BOTTOM without matching pattern?read TIPO_EXTRACTnewif [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
echo "done with TIPO_EXTRACT"
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]then:w"sh-PE-Ripley" 427 lines, 13798 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
sh-PE-Ripley[5]: test: argument expected
 
                COD SUSCRIPTOR PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el COD SUSCRIPTOR para extracción,
      enter para cancelar
 
            COD SUSCRIPTOR:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
read TIPO_EXTRACTnewif [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
echo "TIPO de EXTRACCIÓN:\c"echo " "echo "enter para cancelar"echo "C) Por codigo de suscriptor"echo "N) Por NIT"echo $rayaecho "TIPO DE EXTRACCIÓN"#......................................................................echo " "    do    while [ $loopEnd == "0" ]    loopEnd="0"#*******************************************************************************# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor#*******************************************************************************readTIPO_EXTRACT() {    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
TIPO_ARCHIVO=$TIPO_ARCHIVOnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput el
if [ -z $NOM_ARCHIVOnew ]
then
loopEnd="1"
exitloopEnd="1"
exit
fi
if [ -d $NOM_ARCHIVOnew ]
then
echo $NOM_ARCHIVOnew" es un nombre de directorio"printf "\7"
tput cuu 8
else
if [ ! -f $NOM_ARCHIVOnew ]then
echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"printf "\7"
tput cuu 8else
NOM_ARCHIVO=$NOM_ARCHIVOnewloopEnd="1"fi
fi
    done
}

readBASE() {
#*******************************************************************************
# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ORIGEN DE LA BASE"
echo $raya
echo "I) Interna"
echo "C) Provista por el Cliente"
echo "enter para cancelar"
echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
if [ $BASEnew == "c" ]
then
BASEnew="C"
fi
if [ $BASEnew == "i" ]fi
if [ $BASEnew == "i" ]
then
BASEnew="I"
fi
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
then
BASE=$BASEnew
loopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $ID_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fireadID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $ID_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"printf "\7"
tput cuu 8
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -gt inputLen ]
then
echo "longitud incorrecta del dato"printf "\7"
tput cuu 8
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"




    I$CHANGE MODETIPO"sh-PE-Ripley" [Modified] line 290 of 427 --67%-- :w"sh-PE-Ripley" 427 lines, 13800 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el NIT para extracción,
      enter para cancelar
 
            NIT:w
el dato ingresado debe ser numérico
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el NIT para extracción,
      enter para cancelar
 
            NIT:w
el dato ingresado debe ser numérico
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"printf "\7"
tput cuu 8
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -gt inputLen ]
then
echo "longitud incorrecta del dato"printf "\7"
tput cuu 8
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"$CHANGE MODEtput bel$tput bel




done
    INSERT MODE        /8REPLACE 1 CHAR7/7




/Address search hit BOTTOM without matching pattern




:w"sh-PE-Ripley" 427 lines, 13802 characters 




[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:w
el dato ingresado debe ser numérico
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -gt inputLen ]
then
echo "longitud incorrecta del dato"tput bel
tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    doneREPLACE 1 CHAR#
#
#
#
#
#
#
#
#
#
#
#
#



:w"sh-PE-Ripley" 427 lines, 13802 characters 



[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:w
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:w
la fecha solamente puede contener dígitos
la fecha es inválida
sh-PE-Ripley[37]: w: bad number
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=w<
TIPO_PROC=H<
FECHA_PROC=w<
sh-PE-Ripley[4]: @:  not found
I;;;N;w;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
#if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
#then
#echo "el dato ingresado debe ser numérico"
#tput bel
#tput cuu 7
#fi
## control de longitud (11 o 6)
#if [ ${#ID_EXTRACTnew} -gt inputLen ]
#then
#echo "longitud incorrecta del dato"
#tput bel
#tput cuu 7
#fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done # # # # # 
REPLACE 1 CHAR 
 
 
 
 
 
 
 
 
 
 
 
 



[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>echo $w
a99
/d/iccol/desarrollo/macros>[[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "$ID _EXTRACTnew" !=  +([0-9]) ]]/d/iccol/desarrollo/macros>[[ "$ID _EXTRACTnew" !=  +([0-9]) ]] && "yes!"
ksh: yes!:  not found
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "$ID _EXTRACTnew" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "" !=  +([0-9]) ]] && "yes!"              /d/iccol/desarrollo/macros>[[ "w" !=  +([0-9]) ]] && "yes!"
ksh: yes!:  not found
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "w" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "" !=  +([0-9]) ]] && "yes!" 9" !=  +([0-9]) ]] && "yes!"8" !=  +([0-9]) ]] && "yes!"7" !=  +([0-9]) ]] && "yes!"8" !=  +([0-9]) ]] && "yes!"9" !=  +([0-9]) ]] && "yes!"7" !=  +([0-9]) ]] && "yes!"6" !=  +([0-9]) ]] && "yes!"
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -gt inputLen ]
then
echo "longitud incorrecta del dato"tput bel
tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done

REPLACE 1 CHAR##
#
#
#
#
#



:w"sh-PE-Ripley" 427 lines, 13802 characters 



[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fg[[ "9878976" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "9878976" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>fg                                    /d/iccol/desarrollo/macros>[[ "9878976" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "w" !=  +([0-9]) ]] && "yes!"      /d/iccol/desarrollo/macros>[[ "$ID _EXTRACTnew" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "$ID _EXTRACTnew" !=  +([0-9]) ]]          /d/iccol/desarrollo/macros>echo $w                            /d/iccol/desarrollo/macros>fg     sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:123456
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140101
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=123456<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
I;;;N;123456;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:wretwert
el dato ingresado debe ser numérico
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
tput cuu 7
fi
# control de longitud (11 o 6)
#if [ ${#ID_EXTRACTnew} -gt inputLen ]
#then
#echo "longitud incorrecta del dato"
#tput bel
#tput cuu 7
#fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    donefi
fi
    done
}

readBASE() {
#*******************************************************************************
# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ORIGEN DE LA BASE"
echo $raya
echo "I) Interna"
echo "C) Provista por el Cliente"
echo "enter para cancelar"
echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
if [ $BASEnew == "c" ]
then
BASEnew="C"
fi
if [ $BASEnew == "i" ]
then
BASEnew="I"
fi
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
then
BASE=$BASEnew
loopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptorthen
TIPO_ARCHIVO=$TIPO_ARCHIVOnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput el
if [ -z $NOM_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ -d $NOM_ARCHIVOnew ]
then
echo $NOM_ARCHIVOnew" es un nombre de directorio"printf "\7"
tput cuu 8
else
if [ ! -f $NOM_ARCHIVOnew ]then
echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"printf "\7"
tput cuu 8else
NOM_ARCHIVO=$NOM_ARCHIVOnewloopEnd="1"fi
fiif [ -z $TIPO_EXTRACTnew ]then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
TIPO_ARCHIVO=$TIPO_ARCHIVOnewecho "A) Proceso actual"echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
thenecho " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# todo bien
FECHA_PROC=$FECHA_PROCnew
loopEnd="1"
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
    $CHANGE MODEtput bel"sh-PE-Ripley" [Modified] line 122 of 427 --28%--     while [ $loopEnd == "0" ]do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"echo "0) 1-11"echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
TIPO_ARCHIVO=$TIPO_ARCHIVOnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput el
if [ -z $NOM_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ -d $NOM_ARCHIVOnew ]
then
echo $NOM_ARCHIVOnew" es un nombre de directorio"printf "\7"echo $NOM_ARCHIVOnew" es un nombre de directorio"printf "\7"
tput cuu 8
else
if [ ! -f $NOM_ARCHIVOnew ]then
echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"printf "\7"
tput cuu 8else
NOM_ARCHIVO=$NOM_ARCHIVOnewloopEnd="1"fi
fi
    done
}

readBASE() {
#*******************************************************************************
# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ORIGEN DE LA BASE"
echo $raya
echo "I) Interna"
echo "C) Provista por el Cliente"
echo "enter para cancelar"
echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
if [ $BASEnew == "c" ]
then
BASEnew="C"
fi
if [ $BASEnew == "i" ]
then
BASEnew="I"
fi
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
thenif [ $BASEnew == "C" ] || [ $BASEnew == "I" ]then
BASE=$BASEnew
loopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput belecho "el dato ingresado debe ser numérico"tput bel
tput cuu 7
fi
# control de longitud (11 o 6)
#if [ ${#ID_EXTRACTnew} -gt inputLen ]
#then
#echo "longitud incorrecta del dato"
#tput bel
#tput cuu 7
#fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}

paramsPut() {
#*******************************************************************************
# Guarda los parámetros de la corrida en el archivo .parm
#*******************************************************************************
@
   echo $BASE";"$NOM_ARCHIVO";"$TIPO_ARCHIVO";"$TIPO_EXTRACT";"$ID_EXTRACT";"$TIPO_PROC";"
$F
  FECHA_PROC >| $0.parm
}

paramsPrint() {
#*******************************************************************************
# Muestra todos los parámetros, para pruebas
#*******************************************************************************# Muestra todos los parámetros, para pruebas
#*******************************************************************************
    echo "BASE="$BASE"<"
    echo "NOM_ARCHIVO="$NOM_ARCHIVO"<"
    echo "TIPO_ARCHIVO="$TIPO_ARCHIVO"<"
    echo "TIPO_EXTRACT="$TIPO_EXTRACT"<"
    echo "ID_EXTRACT="$ID_EXTRACT"<"
    echo "TIPO_PROC="$TIPO_PROC"<"
    echo "FECHA_PROC="$FECHA_PROC"<"
}


#*******************************************************************************
#*******************************************************************************
#MAIN
#*******************************************************************************
#*******************************************************************************
    #Fecha de ejecución
    fechaHastaYYYYMMDD=`date '+%Y%m%d'`
    fechaHastaYYYYMM=`echo $fechaHastaYYYYMMDD  | cut -c1-6`clear
echo $raya
    echo "$ASCIIBanner"
#   banner "PE Ripley"
    echo $rayaparamsGet
    readBASE
    if [ $BASE == "C" ]
    then
readNOM_ARCHIVO
readTIPO_ARCHIVO
    else
readTIPO_EXTRACT
readID_EXTRACT# NIT o cod suscriptor
    fi
readTIPO_PROC
    if [ $TIPO_PROC == "H" ]
    then
readFECHA_PROC
    fi

paramsPrint
    paramsPut
    # DEBUG: termina acá
    echo " "
    echo "HASTA ACÁ LLEGAMOS POR AHORA"
    echo "(pero estamos avanzando más rápido)"exit



#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
# de aquí para abajo, falta integrar (parte inexplorada)
#*******************************************************************************
#*******************************************************************************
#*******************************************************************************T:w"sh-PE-Ripley" 427 lines, 13763 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:w
el dato ingresado debe ser numérico
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:w
la fecha solamente puede contener dígitos
la fecha es inválida
sh-PE-Ripley[37]: w: bad number
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=w<
TIPO_PROC=H<
FECHA_PROC=w<
sh-PE-Ripley[4]: @:  not found
I;;;N;w;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************
#*******************************************************************************
#MAIN
#*******************************************************************************
#*******************************************************************************
    #Fecha de ejecución
    fechaHastaYYYYMMDD=`date '+%Y%m%d'`
    fechaHastaYYYYMM=`echo $fechaHastaYYYYMMDD  | cut -c1-6`clear
echo $raya
    echo "$ASCIIBanner"
#   banner "PE Ripley"
    echo $rayaparamsGet
    readBASE
    if [ $BASE == "C" ]
    then
readNOM_ARCHIVO
readTIPO_ARCHIVO
    else
readTIPO_EXTRACT
readID_EXTRACT
    fi
readTIPO_PROC
    if [ $TIPO_PROC == "H" ]
    then
readFECHA_PROC
    fi

paramsPrint
    paramsPut
    # DEBUG: termina acá
    echo " "
    echo "HASTA ACÁ LLEGAMOS POR AHORA"
    echo "(pero estamos avanzando más rápido)"
    exit



#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
# de aquí para abajo, falta integrar (parte inexplorada)
#*******************************************************************************
#*******************************************************************************
#*******************************************************************************# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"/nit para la extraAddress search hit BOTTOM without matching pattern/para la extratput cuu 8fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
tput cuu 7
fi
# control de longitud (11 o 6)
#if [ ${#ID_EXTRACTnew} -gt inputLen ]
#then
#echo "longitud incorrecta del dato"#tput bel
#tput cuu 7
#fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"donereadID_EXTRACT() {[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>echo $w
a99
/d/iccol/desarrollo/macros> [ ${#ID_EXTRACTnew} -gt inputLen ] && "ok"b ^[  /d/iccol/desarrollo/macros> [ ${#ID _EXTRACTnew} -gt inputLen ] && "ok"${#w} -gt inputLen ] && "ok"            /d/iccol/desarrollo/macros> [ ${# w} -gt inputLen ] && "ok" w} -gt inputLen ] && "ok"w} -gt inputLen ] && "ok" w} -gt inputLen ] && "ok" #w} -gt  ] && "ok"        2 ] && "ok"
ksh: ok:  not found
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros> [ ${#w} -gt 2 ] && "ok" [ ${#w} -gt 3
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
tput cuu 7
fi
# control de longitud (11 o 6)
#if [ ${#ID_EXTRACTnew} -gt inputLen ]
#then
#echo "longitud incorrecta del dato"
#tput bel
#tput cuu 7
#fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"REPLACE 1 CHAR  
 
 
 
 
 /inputLen//REPLACE MODEneEEee 
:w"sh-PE-Ripley" 427 lines, 13763 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fg [ ${#w} -gt 3 ] && "ok"
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros> [ ${#w} -gt 3 ] && "ok"fg                       [ ${#w} -gt 3 ] && "ok" [ ${#w} -gt 2 ] && "ok"echo $w                 fg     sh-PE-Ripleyfg          sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:qwerqwer
el dato ingresado debe ser numérico
longitud incorrecta del dato
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:1223
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:11111111111
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:111111
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:12345678901
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:666666
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"/tipo procAddress search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern/tipo_proctput bel
tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}

paramsPut() {
#*******************************************************************************
# Guarda los parámetros de la corrida en el archivo .parm
#*******************************************************************************
@
   echo $BASE";"$NOM_ARCHIVO";"$TIPO_ARCHIVO";"$TIPO_EXTRACT";"$ID_EXTRACT";"$TIPO_PROC";"
$F
  FECHA_PROC >| $0.parm
}

paramsPrint() {
#*******************************************************************************
# Muestra todos los parámetros, para pruebas
#*******************************************************************************
    echo "BASE="$BASE"<"
    echo "NOM_ARCHIVO="$NOM_ARCHIVO"<"
    echo "TIPO_ARCHIVO="$TIPO_ARCHIVO"<"
    echo "TIPO_EXTRACT="$TIPO_EXTRACT"<"
    echo "ID_EXTRACT="$ID_EXTRACT"<"
    echo "TIPO_PROC="$TIPO_PROC"<"
    echo "FECHA_PROC="$FECHA_PROC"<"
}?echo "TIPO DE PROCESO"echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew#......................................................................echo " "    do    while [ $loopEnd == "0" ]    loopEnd="0"#*******************************************************************************# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor#*******************************************************************************readTIPO_PROC() {}"sh-PE-Ripley" line 85 of 427 --19%-- [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:w
la fecha solamente puede contener dígitos
la fecha es inválida
sh-PE-Ripley[37]: w: bad number
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=w<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"/fecha//readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# todo bien
FECHA_PROC=$FECHA_PROCnew
loopEnd="1"
    done
}



OPEN MODEecho "la fecha es numérica"




    



echo "la fecha es numérica"$CHANGE MODEválida"



    



echo "la fecha es válida"



válid$CHANGE MODEanterior a la actual



:w"sh-PE-Ripley" 430 lines, 13857 characters 



[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140101
la fecha es numérica
la fecha es válida
la fecha es anterior a la actual
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
echo "la fecha es numérica"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
echo "la fecha es válida"
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
loopEnd="1"



done}readTIPO_PROC() {INSERT MODE# 
# # # 

# echo "la fecha es anterior a la actual"# echo "la es $CHANGE MODE"$FECHA_PROC




readTIPO_PROC() {
# echo "la fecha es "$FECHA_PROC









:w"sh-PE-Ripley" 431 lines, 13896 characters 




[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140501    0101
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    loopEnd="0"while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# echo "la fecha es numérica"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# echo "la fecha es válida"
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}




:w"sh-PE-Ripley" 431 lines, 13895 characters 




[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140101
la fecha es 20140101
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    loopEnd="0"while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# echo "la fecha es numérica"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# echo "la fecha es válida"
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
 echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}# echo "la fecha es "$FECHA_PROC




[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:1234
longitud incorrecta del dato
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:1234
la fecha es inválida
la fecha es 1234
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=1234<
TIPO_PROC=H<
FECHA_PROC=1234<
sh-PE-Ripley[4]: @:  not found
I;;;N;1234;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros> fg
vi sh-PE-Ripley
    loopEnd="0"while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# echo "la fecha es numérica"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# echo "la fecha es válida"
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}/+$CHANGE MODE{8}

    



$CHANGE MODE8 dígitos:w"sh-PE-Ripley" 431 lines, 13899 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros> fgsh-PE-Ripley
sh-PE-Ripley[38]: syntax error at line 60 : `(' unexpected
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    loopEnd="0"while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != {8}([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# echo "la fecha es 8 dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# echo "la fecha es válida"
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}(:w"sh-PE-Ripley" 431 lines, 13899 characters :{8}[0-9]) ]] ({8}[0-9]) ]]:w"sh-PE-Ripley" 431 lines, 13899 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
sh-PE-Ripley[38]: syntax error at line 60 : `(' unexpected
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    loopEnd="0"while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != ({8}[0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# echo "la fecha es 8 dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# echo "la fecha es válida"
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}{8}({8$CHANGE MODE++([1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripleyfg          sh-PE-Ripley fg         sh-PE-Ripleyfg          sh-PE-Ripleyfg          sh-PE-Ripleyfg          sh-PE-Ripleyfg          sh-PE-Ripleyfg          sh-PE-Ripley [ ${#w} -gt 3 ] && "ok"fg                       [ ${#w} -gt 3 ] && "ok"fg                       [ ${#w} -gt 3 ] && "ok" [ ${#w} -gt 2 ] && "ok"echo $w                 fg     sh-PE-Ripleyfg          sh-PE-Ripleysh-PE-Ripley[[ "9878976" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>fg                                    /d/iccol/desarrollo/macros>[[ "9878976" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "9878976" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "9" !=  +([0-9]) ]] && "yes!"      /d/iccol/desarrollo/macros>[[ "9" !=  ([0-9]) ]] && "yes!" 
ksh: syntax error: `(' unexpected
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "9" !=  ([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "9" !=  {([0-9]) ]] && "yes!"1([0-9]) ]] && "yes!"}([0-9]) ]] && "yes!"
ksh: syntax error: `(' unexpected
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "9" !=  {1}([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "9" !=  {1}[0-9]) ]] && "yes!"                      1{             [[ "9" !=  ([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "9" !=  +([0-9]) ]] && "yes!"
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "9" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "9" =
ksh: yes!:  not found
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>[[ "9" ==  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "9" ==  +([0-9]) ]] && e"yes!"c"yes!"h"yes!"o"yes!" "yes!"
yes!
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    loopEnd="0"while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# echo "la fecha es 8 dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# echo "la fecha es válida"
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}"sh-PE-Ripley" [Modified] line 60 of 431 --13%-- :w"sh-PE-Ripley" 431 lines, 13897 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fg[[ "9" ==  +([0-9]) ]] && echo "yes!"/d/iccol/desarrollo/macros>[[ "9" ==  +([0-9]) ]] && "yes!"     /d/iccol/desarrollo/macros>[[ "9" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "9" !=  {1}([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>[[ "9" !=  ([0-9]) ]] && "yes!"   /d/iccol/desarrollo/macros>[[ "9878976" !=  +([0-9]) ]] && "yes!"/d/iccol/desarrollo/macros>fg                                    /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:qwerqwer
la fecha solamente puede contener dígitos
la fecha es inválida
sh-PE-Ripley[39]: qwerqwer: bad number
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=qwerqwer<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    loopEnd="0"while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
tput cuu 7
fi
# echo "la fecha es 8 dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
tput cuu 7
fi
# echo "la fecha es válida"
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}

    

INSERT MODE##/cuu/#INSERT MODE#//#



INSERT MODEecho 
$CHANGE MODEsolo"sh-PE-Ripley" [Modified] line 66 of 431 --15%-- :w"sh-PE-Ripley" 431 lines, 13908 characters [

if [ $FECHA_PROCnew -ge fechaHastaYYYYMMDD ]$CHANGE MODEecho "va a compararr APPEND MODE"w -ge$CHANGE MODE" con "$D


INSERT MODE$:w"sh-PE-Ripley" 432 lines, 13971 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:1234
longitud incorrecta del dato
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140101
va a comparar 20140101 con 20140528
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=1234<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
I;;;N;1234;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    loopEnd="0"while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
#tput cuu 7
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
#tput cuu 7
fi
# echo "la fecha es válida"
echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
#tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}
INSERT MODE# # /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"








    OPEN MODE    doCuu="0"/cuuecho "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"
tput bel
#tput cuu 7#*******************************************************************************loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
#tput cuu 7
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
#tput cuu 7
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
#tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done$CHANGE MODEif [ doCuu == "1" ]; then; 7APPEND MODE, fi/
if [ doCuu == "1" ]; then; tput cuu 7, fidone/
/
#tput cuu 7doneif [ doCuu == "1" ]; then; tput cuu 7, fi
done/echo "enter para cancelar"echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit cuu if [ doCuu == "1" ]; then; tput cuu 7, fiREPLACE 1 CHAR8exit/fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnew
loopEnd="1"
else
tput bel
tput cuu 8if [ doCuu == "1" ]; then; tput cuu 7, fi
REPLACE 1 CHAR8

tput cuu 8

fi
    done

/    while [ $loopEnd == "0" ]do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
TIPO_ARCHIVO=$TIPO_ARCHIVOnewloopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput el
if [ -z $NOM_ARCHIVOnew ]
then
loopEnd="1"if [ doCuu == "1" ]; then; tput cuu 7, fi
loopEnd="1"REPLACE 1 CHAR8
/exit
fi
if [ -d $NOM_ARCHIVOnew ]
then
echo $NOM_ARCHIVOnew" es un nombre de directorio"
printf "\7"
tput cuu 8
if [ doCuu == "1" ]; then; tput cuu 7, fi
1 line
REPLACE 1 CHAR8

        else

if [ ! -f $NOM_ARCHIVOnew ]
/then
echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"
printf "\7"
tput cuu 8if [ doCuu == "1" ]; then; tput cuu 7, fi    if [ doCuu == "1" ]; then; tput cuu 7, fi
REPLACE 1 CHAR8

tput cuu 8else   
    $CHANGE MODEtput belA
$tput bel
 tput eltput el    


 tput el//

/echo "enter para cancelar"echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
if [ $BASEnew == "c" ]
then
BASEnew="C"
fi
if [ $BASEnew == "i" ]
then
BASEnew="I"
fi
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
then
BASE=$BASEnew
loopEnd="1"
else
printf "\7"
tput cuu 8
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $raya
 $CHANGE MODEtput bel
if [ doCuu == "1" ]; then; tput cuu 7, fiREPLACE 1 CHAR8/    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`if [ doCuu == "1" ]; then; tput cuu 7, fi
NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`/if [ doCuu == "1" ]; then; tput cuu 7, fi
NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`/Address search hit BOTTOM without matching pattern# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya/, fiecho "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"
tput bel
if [ doCuu == "1" ]; then; tput cuu 7, fi
REPLACE 1 CHAR;

/fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"
tput bel
if [ doCuu == "1" ]; then; tput cuu 7, fi;
/fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"
tput bel
if [ doCuu == "1" ]; then; tput cuu 7, fi;
/echo "enter para cancelar"echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
if [ doCuu == "1" ]; then; tput cuu 8, fi
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit;/fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnew
loopEnd="1"
else
tput bel
if [ doCuu == "1" ]; then; tput cuu 8, fi;
/    while [ $loopEnd == "0" ]do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
TIPO_ARCHIVO=$TIPO_ARCHIVOnewloopEnd="1"
else
printf "\7"
if [ doCuu == "1" ]; then; tput cuu 8, fi
fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput el
if [ -z $NOM_ARCHIVOnew ]
then
loopEnd="1";/exit
fi
if [ -d $NOM_ARCHIVOnew ]
then
echo $NOM_ARCHIVOnew" es un nombre de directorio"
tput bel
if [ doCuu == "1" ]; then; tput cuu 8, fi;
/else
if [ ! -f $NOM_ARCHIVOnew ]
then
echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"
tput bel
if [ doCuu == "1" ]; then; tput cuu 8, fi;
/echo "enter para cancelar"echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
if [ $BASEnew == "c" ]
then
BASEnew="C"
fi
if [ $BASEnew == "i" ]
then
BASEnew="I"
fi
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
then
BASE=$BASEnew
loopEnd="1"
else
tput bel
if [ doCuu == "1" ]; then; tput cuu 8, fi
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $raya;/    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
if [ doCuu == "1" ]; then; tput cuu 7, fi
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
if [ doCuu == "1" ]; then; tput cuu 7, fi
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`;/;/Address search hit BOTTOM without matching pattern:w"sh-PE-Ripley" 433 lines, 14282 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripleyfg          sh-PE-Ripley
sh-PE-Ripley[39]: syntax error at line 65 : `;' unexpected
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`#*******************************************************************************loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    doneif [ doCuu; 
[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
sh-PE-Ripley[39]: syntax error at line 65 : `;' unexpected
/d/iccol/desarrollo/macros>df
/                  (/                 ):22110156 blocks  3459168 files
/d                 (/d                ):109617032 blocks 12377491 files
/despeciales       (/despeciales      ):11449636 blocks 17221666 files
/despeciales2      (/despeciales2     ):69394320 blocks 17389362 files
/dev               (/dev              ):22110156 blocks  3459168 files
/dicdb             (/dicdb            ):17022426 blocks 18713906 files
/dicregis          (/dicregis         ):73561000 blocks 24956964 files
/dicsuper          (/dicsuper         ):22556100 blocks  8804336 files
/icven             (/icven            ):34545408 blocks  9925889 files
/proc              (proc              ):       0 blocks    29193 files
/system/contract   (ctfs              ):       0 blocks 2147483349 files
/etc/mnttab        (mnttab            ):       0 blocks        0 files
/system/object     (objfs             ):       0 blocks 2147483427 files
/etc/svc/volatile  (swap              ): 7281232 blocks  4742704 files
/dev/fd            (fd                ):       0 blocks        0 files
/tmp               (swap              ): 7281216 blocks  4742704 files
/var/run           (swap              ): 7281216 blocks  4742704 files
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
if [ doCuu == "1" ]; then tput cuu 7; fi
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done:w"sh-PE-Ripley" 433 lines, 14280 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgdfsh-PE-Ripley
sh-PE-Ripley[39]: syntax error at line 66 : `fi' unexpected
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
if [ doCuu == "1" ] then tput cuu 7; fi
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done; then tput cuu 7; fi then tput cuu 7; fieAPPEND MODEpunAPPEND MODE;:w"sh-PE-Ripley" 433 lines, 14281 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
sh-PE-Ripley[39]: syntax error at line 66 : `fi' unexpected
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
if [ doCuu == "1" ] then; tput cuu 7; fi
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done; tput cuu 7:w"sh-PE-Ripley" 433 lines, 14280 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
sh-PE-Ripley[39]: syntax error at line 67 : `fi' unexpected
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
if [ doCuu == "1" ] then; tput cuu 7 fi
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done"sh-PE-Ripley" line 65 of 433 --15%-- 
then$CHANGE MODE&&:w"sh-PE-Ripley" 433 lines, 14272 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
sh-PE-Ripley[39]: syntax error at line 74 : `;' unexpected
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#*******************************************************************************loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
[ doCuu == "1" ] && tput cuu 7
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
if [ doCuu == "1" ]; then; tput cuu 7; fi
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done/; *then;:%s// &&10 substitutions echo "enter para cancelar"echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
if [ doCuu == "1" ] ; then;; then; tput cuu 7; fi
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
if [ doCuu == "1" ] ; then;; then; tput cuu 7; fi
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya:%s// \&\& 10 substitutions echo "enter para cancelar"echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
if [ doCuu == "1" ] &&  tput cuu 7; fi
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
if [ doCuu == "1" ] &&  tput cuu 7; fi
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}/Address search hit BOTTOM without matching pattern:g/doCuu/s/if //[ doCuu == "1" ] &&  tput cuu 7; fi[ doCuu == "1" ] &&  tput cuu 7; fi:%sf/doCuu/s/; *fi//"/doCuu/s/" [Not edited] [Modified] line 336 of 433 --77%-- :g/docuu/s/; fi//:w"/doCuu/s/" No such file or directory:w"/doCuu/s/" No such file or directory[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
echo "enter para cancelar"echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}:fi[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>sh-PE-Ripley            fg
vi sh-PE-Ripley
echo "enter para cancelar"echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}





APPEND MODE/d/iccol/desarrollo/macros>sh-PE-RipleyREPLACE 1 CHAR/if INSERT MODE/d/iccol/desarrollo/macros/sh-PE-Ripley:file /d/iccol/desarrollo/macros/sh-PE-Ripley"/d/iccol/desarrollo/macros/sh-PE-Ripley" [Not edited] [Modified] line 342 of 433 --78%-- :w"/d/iccol/desarrollo/macros/sh-PE-Ripley" File exists - use "w! /d/iccol/desarrollo/macros/sh-PE-Ripley" to overwrite[Hit return to continue] echo "enter para cancelar"echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}:w!"/d/iccol/desarrollo/macros/sh-PE-Ripley" 433 lines, 14172 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgfgfgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:1234
longitud incorrecta del dato
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:123456789012
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:w
la fecha solamente puede contener dígitos
la fecha es inválida
sh-PE-Ripley[40]: w: bad number
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=1234<
TIPO_PROC=H<
FECHA_PROC=w<
sh-PE-Ripley[4]: @:  not found
I;;;N;1234;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
echo "enter para cancelar"echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:w
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140101
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya/la fecha/echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"
tput bel
[ doCuu == "1" ] && tput cuu 7
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"
tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"
tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
# echo "la fecha es anterior a la actual"# todo bienFECHA_PROC=$FECHA_PROCnew# echo "la fecha es "$FECHA_PROCloopEnd="1"done}readTIPO_PROC() {"    while [ $loopEnd == "0" ]    loopEnd="0"



# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya








    

REPLACE 1 CHAR1 1:w"/d/iccol/desarrollo/macros/sh-PE-Ripley" 433 lines, 14172 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:w
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:w
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="1"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya"/d/iccol/desarrollo/macros/sh-PE-Ripley" line 10 of 433 --2%-- /doCuu}/doCuuAddress search hit BOTTOM without matching pattern/doCuuecho "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"
tput bel
[ doCuu == "1" ] && tput cuu 7
[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>[ doCuu == "1" ] && tput cuu 7^[  /d/iccol/desarrollo/macros>[ doCuu == "1" ] && tput cuu 7     bel
/d/iccol/desarrollo/macros>doCuu="1"
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>doCuu="1"[ doCuu == "1" ] && tput bel/d/iccol/desarrollo/macros>
/d/iccol/desarrollo/macros>exho     cho $doCuu
1
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>echo $doCuu[ doCuu == "1" ] && tput bel/d/iccol/desarrollo/macros>[ $doCuu == "1" ] && tput bel
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
#     # ##     # # #    # ### #######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
[ doCuu == "1" ] && tput cuu 7#     # ##     # # #####  ####### #   #######  #######    ######    ASCIIBanner="    raya="----------------------------------------------------------------------"    codSuscriptor=999999    NITSuscriptor=900047981    doCuu="1"# Definición de constantes#*******************************************************************************#AUTHOR:Globant - JL#LAST-UPDATE:  2014/05/23#DATE-WRITTEN: 2014/05/23#SHELL-ID:     sh-PE-Ripley#*******************************************************************************#sh-PE-Ripley.V.1.0001# /d/iccol/desarrollo/macros/sh-PE-Ripley/doCuu/echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"
tput bel
[ doCuu == "1" ] && tput cuu 7
INSERT MODE$

/
/fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"
tput bel
[ doCuu == "1" ] &&  tput cuu 7$
/
/fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"
tput bel
[ doCuu == "1" ] &&  tput cuu 7$
/
/echo "enter para cancelar"echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit$//fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnew
loopEnd="1"
else
tput bel
[ doCuu == "1" ] &&  tput cuu 8$
/
/    while [ $loopEnd == "0" ]do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
TIPO_ARCHIVO=$TIPO_ARCHIVOnewloopEnd="1"
else
printf "\7"
[ doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput el
if [ -z $NOM_ARCHIVOnew ]
then
loopEnd="1"$//exit
fi
if [ -d $NOM_ARCHIVOnew ]
then
echo $NOM_ARCHIVOnew" es un nombre de directorio"
tput bel
[ doCuu == "1" ] &&  tput cuu 8$
/
/else
if [ ! -f $NOM_ARCHIVOnew ]
then
echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"
tput bel
[ doCuu == "1" ] &&  tput cuu 8$
/
/echo "enter para cancelar"echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
if [ $BASEnew == "c" ]
then
BASEnew="C"
fi
if [ $BASEnew == "i" ]
then
BASEnew="I"
fi
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
then
BASE=$BASEnew
loopEnd="1"
else
tput bel
[ doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $raya$//    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`$//$//Address search hit BOTTOM without matching pattern:w"/d/iccol/desarrollo/macros/sh-PE-Ripley" 433 lines, 14183 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fg[ $doCuu == "1" ] && tput bel/d/iccol/desarrollo/macros>echo $doCuu                  /d/iccol/desarrollo/macros>[ doCuu == "1" ] && tput bel/d/iccol/desarrollo/macros>doCuu="1"                   /d/iccol/desarrollo/macros>[ doCuu == "1" ] && tput bel/d/iccol/desarrollo/macros>fg                          /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:w
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="1"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya/"c"/////echo "la fecha es inválida"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_PROCnew == "a" ]
then
TIPO_PROCnew="A"
fi
if [ $TIPO_PROCnew == "h" ]
then
TIPO_PROCnew="H"
fi
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"]APPEND MODE &&& then
echo $raya& TIPO_PROCnew="A"
echo "N) Por NIT"fi
echo "C) Por codigo de suscriptor"
]APPEND MODE &&  then
echo "enter para cancelar" TIPO_PROCnew="H"
echo " "fi
echo "TIPO de EXTRACCIÓN:\c"    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_EXTRACTnew == "c" ]
then
TIPO_EXTRACTnew="C"
fi
if [ $TIPO_EXTRACTnew == "n" ]
then
TIPO_EXTRACTnew="N"
fi
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
then
while [ $loopEnd == "0" ]]APPEND MODE &&  TIPO_EXTRACTnew="C"
dofi
echo " "
]APPEND MODE &&& then
#......................................................................& TIPO_EXTRACTnew="N"
echo "ESTRUCTURA DEL ARCHIVO BASE"fi
echo $raya# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
TIPO_ARCHIVO=$TIPO_ARCHIVOnewloopEnd="1"
else
printf "\7"
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput elecho " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput el
if [ -z $NOM_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ -d $NOM_ARCHIVOnew ]
then
echo $NOM_ARCHIVOnew" es un nombre de directorio"tput bel
[ $doCuu == "1" ] &&  tput cuu 8
else
if [ ! -f $NOM_ARCHIVOnew ]then
echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"tput bel
[ $doCuu == "1" ] &&  tput cuu 8else
NOM_ARCHIVO=$NOM_ARCHIVOnewloopEnd="1"fi
fi
    done
}

readBASE() {
#*******************************************************************************
# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ORIGEN DE LA BASE"
echo $raya
echo "I) Interna"
echo "C) Provista por el Cliente"
echo "enter para cancelar"#*******************************************************************************loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ORIGEN DE LA BASE"
echo $raya
echo "I) Interna"
echo "C) Provista por el Cliente"
echo "enter para cancelar"
echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
if [ $BASEnew == "c" ]
then
BASEnew="C"
fi
if [ $BASEnew == "i" ]
then
BASEnew="I"
fi
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
then
BASE=$BASEnew
loopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"]APPEND MODE &&  then
inputLen=6 BASEnew="C"
fifi
loopEnd="0"
]APPEND MODE &&  then
while [ $loopEnd == "0" ] then
 BASEnew="I"
dofi
echo " "readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"ID_EXTRACT=$ID_EXTRACTnewloopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}

paramsPut() {
#*******************************************************************************
# Guarda los parámetros de la corrida en el archivo .parm
#*******************************************************************************
@
   echo $BASE";"$NOM_ARCHIVO";"$TIPO_ARCHIVO";"$TIPO_EXTRACT";"$ID_EXTRACT";"$TIPO_PROC";"
$F
  FECHA_PROC >| $0.parm
}

paramsPrint() {
#*******************************************************************************
# Muestra todos los parámetros, para pruebas
#*******************************************************************************
    echo "BASE="$BASE"<"
    echo "NOM_ARCHIVO="$NOM_ARCHIVO"<"
    echo "TIPO_ARCHIVO="$TIPO_ARCHIVO"<"
    echo "TIPO_EXTRACT="$TIPO_EXTRACT"<"
    echo "ID_EXTRACT="$ID_EXTRACT"<"
    echo "TIPO_PROC="$TIPO_PROC"<"
    echo "FECHA_PROC="$FECHA_PROC"<"
}


#*******************************************************************************"/d/iccol/desarrollo/macros/sh-PE-Ripley" [Modified] line 320 of 415 --77%-- :w"/d/iccol/desarrollo/macros/sh-PE-Ripley" 415 lines, 13967 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:w
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:w
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:12345678901
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:12345
la fecha es inválida
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=12345678901<
TIPO_PROC=H<
FECHA_PROC=12345<
sh-PE-Ripley[4]: @:  not found
I;;;N;12345678901;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
ID_EXTRACT=$ID_EXTRACTnewloopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}

paramsPut() {
#*******************************************************************************
# Guarda los parámetros de la corrida en el archivo .parm
#*******************************************************************************
@
   echo $BASE";"$NOM_ARCHIVO";"$TIPO_ARCHIVO";"$TIPO_EXTRACT";"$ID_EXTRACT";"$TIPO_PROC";"
$F
  FECHA_PROC >| $0.parm
}

paramsPrint() {
#*******************************************************************************
# Muestra todos los parámetros, para pruebas
#*******************************************************************************
    echo "BASE="$BASE"<"
    echo "NOM_ARCHIVO="$NOM_ARCHIVO"<"
    echo "TIPO_ARCHIVO="$TIPO_ARCHIVO"<"
    echo "TIPO_EXTRACT="$TIPO_EXTRACT"<"
    echo "ID_EXTRACT="$ID_EXTRACT"<"
    echo "TIPO_PROC="$TIPO_PROC"<"
    echo "FECHA_PROC="$FECHA_PROC"<"
}


#*******************************************************************************# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="1"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $rayaREPLACE 1 CHAR0:w"/d/iccol/desarrollo/macros/sh-PE-Ripley" 415 lines, 13967 characters :w"/d/iccol/desarrollo/macros/sh-PE-Ripley" 415 lines, 13967 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:12345
la fecha es inválida
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=12345<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya/la fecha es invecho $rayaecho "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
[ $doCuu == "1" ] && tput cuu 7
fi
# echo "la fecha es solo dígitos"
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# echo "la fecha es válida"
# echo "va a comparar "$FECHA_PROCnew" con "$fechaHastaYYYYMMDD
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# echo "la fecha es anterior a la actual"
# todo bien
FECHA_PROC=$FECHA_PROCnew
# echo "la fecha es "$FECHA_PROC
loopEnd="1"
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"echo "FECHA DE PROCESO"#......................................................................echo " "    do    while [ $loopEnd == "0" ]    loopEnd="0"readTIPO_PROC() {
#*******************************************************************************# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor

#*******************************************************************************# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $rayathen
echo "la fecha solamente puede contener dígitos"tput bel
[ $doCuu == "1" ] && tput cuu 7
fi
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
then
echo "la fecha es inválida"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# debe ser menor que la fecha actual
if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# todo bien
FECHA_PROC=$FECHA_PROCnew
loopEnd="1"
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"if [[ "$FECHA_PROCnew" != +([0-9]) ]]# debe ser solo númerosfiexitloopEnd="1"thenif [ -z $FECHA_PROCnew ]read FECHA_PROCnewecho "FECHA de PROCESO AAAAMMDD:\c"echo " "echo "enter para cancelar"echo "Ingrese fecha de proceso,"echo $raya


    


f$CHANGE MODEelse
    # rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31

    # [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "
ok"
         if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
    then
    echo "la fecha es inválida"    tput bel
    [ $doCuu == "1" ] &&  tput cuu 7
    fi
    # debe ser menor que la fecha actual
    if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
    then
    echo "la fecha de proceso histórico debe ser anterior a la actual"    tput bel
    [ $doCuu == "1" ] &&  tput cuu 7
    fi
    # todo bien
    FECHA_PROC=$FECHA_PROCnew
    loopEnd="1"
        done19 lines >>ed




    


f$CHANGE MODEelse
    # debe ser menor que la fecha actual    if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]    then
    echo "la fecha de proceso histórico debe ser anterior a la actual"    tput bel
    [ $doCuu == "1" ] &&  tput cuu 7    fi
    # todo bien    FECHA_PROC=$FECHA_PROCnew    loopEnd="1"
    done1


    


f$CHANGE MODEelse
    # todo bien
    FECHA_PROC=$FECHA_PROCnew    loopEnd="1"


donedone   
OPEN MODEfi
fi
fi    fi
    fi
    fi    fi
        fi
        fi    fi
    fi    fi:w"/d/iccol/desarrollo/macros/sh-PE-Ripley" 413 lines, 13692 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:w
la fecha solamente puede contener dígitos
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:123
la fecha es inválida
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20550101
la fecha es inválida
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140101
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
echo $rayaecho "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
[ $doCuu == "1" ] && tput cuu 7
else
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "
ok"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]then
echo "la fecha es inválida"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# debe ser menor que la fecha actualif [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]       
 INSERT MODE, anterior a 2000 o posterior a 2029echo "la fecha es inválida, anterior a 2000 o posterior a 2029"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# debe ser menor que la fecha actualif [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {echo "la fecha es inválida, anterior a 2000 o posterior a 2029"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# debe ser menor que la fecha actualif [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
elseecho "la fecha es inválida, anterior a 2000 o posterior a 2029"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# debe ser menor que la fecha actualif [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {:w"/d/iccol/desarrollo/macros/sh-PE-Ripley" 413 lines, 13728 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>clear
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>clearfg   sh-PE-Ripleysh-PE-Ripleycsh-PE-Ripleyash-PE-Ripleytsh-PE-Ripley sh-PE-Ripley
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:       Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#       si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
        NOM_ARCHIVO=" "
        TIPO_ARCHIVO="1"
#       si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
        TIPO_EXTRACT="N"
#           si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACT
            ID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#       Si TIPO_PROC="H": la fecha de proceso
        FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
        echo " "
#             ......................................................................
        echo "                          FECHA DE PROCESO"
        echo $raya
        echo "      Ingrese fecha de proceso,"
        echo "      enter para cancelar"
        echo " "
        echo "            FECHA de PROCESO AAAAMMDD:\c"
        read FECHA_PROCnew
        if [ -z $FECHA_PROCnew ]
        then
            loopEnd="1"
            exit
        fi
        # debe ser solo números
        if [[ "$FECHA_PROCnew" != +([0-9]) ]] 
        then
            echo "la fecha solamente puede contener dígitos"
            tput bel
            [ $doCuu == "1" ] && tput cuu 7 
        else
                        # rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31
                        # [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "ok"
                        if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]
                        then
                                echo "la fecha es inválida, anterior a 2000 o posterior a 2029"
                                tput bel
                                [ $doCuu == "1" ] &&  tput cuu 7
                        else
                                # debe ser menor que la fecha actual
                                if [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]
                                then
                                        echo "la fecha de proceso histórico debe ser anterior a la actual"
                                        tput bel
                                        [ $doCuu == "1" ] &&  tput cuu 7
                                else
                                        # todo bien
                                        FECHA_PROC=$FECHA_PROCnew
                                        loopEnd="1"
                                fi
                        fi
                fi
        done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
        echo " "
#             ......................................................................
        echo "                          TIPO DE PROCESO"
        echo $raya
        echo "      A) Proceso actual"
        echo "      H) Proceso histórico"
        echo "      enter para cancelar"
        echo " "
        echo "            TIPO de PROCESO:\c"
        read TIPO_PROCnew
        if [ -z $TIPO_PROCnew ]
        then
            loopEnd="1"
            exit
        fi
        [ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
        [ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
        if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
        then
            TIPO_PROC=$TIPO_PROCnew
            loopEnd="1"
        else
            tput bel
            [ $doCuu == "1" ] &&  tput cuu 8
        fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
        echo " "
#             ......................................................................
        echo "                         TIPO DE EXTRACCIÓN"
        echo $raya
        echo "      N) Por NIT"
        echo "      C) Por codigo de suscriptor"
        echo "      enter para cancelar"
        echo " "
        echo "            TIPO de EXTRACCIÓN:\c"
        read TIPO_EXTRACTnew
        if [ -z $TIPO_EXTRACTnew ]
        then
            loopEnd="1"
            exit
        fi
        [ $TIPO_EXTRACTnew == "c" ] && TIPO_EXTRACTnew="C"
        [ $TIPO_EXTRACTnew == "n" ] && TIPO_EXTRACTnew="N"
        if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
        then
            TIPO_EXTRACT=$TIPO_EXTRACTnew
            loopEnd="1"
        else
            tput bel
            [ $doCuu == "1" ] &&  tput cuu 8
        fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
        echo " "
#             ......................................................................
        echo "                    ESTRUCTURA DEL ARCHIVO BASE"
        echo $raya
        echo "      0) 1-11"
        echo "      1) 1-11-45"
        echo "      enter para cancelar"
        echo " "
        echo "            ESTRUCTURA:\c"
        read TIPO_ARCHIVOnew
        if [ -z $TIPO_ARCHIVOnew ]
        then
            loopEnd="1"
            exit
        fi
        if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
        then
            TIPO_ARCHIVO=$TIPO_ARCHIVOnew
            loopEnd="1"
        else
            printf "\7"
            [ $doCuu == "1" ] &&  tput cuu 8
        fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
        echo " "
#             ......................................................................
        echo "                       NOMBRE DEL ARCHIVO BASE"
        echo $raya
        echo "      Ingrese el nombre del archivo base,"
        echo "      enter para cancelar"
        echo " "
                tput el
        echo "            ARCHIVO:\c"
        read NOM_ARCHIVOnew
        tput el
        if [ -z $NOM_ARCHIVOnew ]
        then
            loopEnd="1"
            exit
        fi
        if [ -d $NOM_ARCHIVOnew ]
        then
            echo $NOM_ARCHIVOnew" es un nombre de directorio"
            tput bel
            [ $doCuu == "1" ] &&  tput cuu 8
        else
            if [ ! -f $NOM_ARCHIVOnew ]
            then
                echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"
                tput bel
                                [ $doCuu == "1" ] &&  tput cuu 8
            else
                NOM_ARCHIVO=$NOM_ARCHIVOnew
                loopEnd="1"
            fi
        fi
    done
}

readBASE() {
#*******************************************************************************
# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
        echo " "
#             ......................................................................
        echo "                       ORIGEN DE LA BASE"
        echo $raya
        echo "      I) Interna"
        echo "      C) Provista por el Cliente"
        echo "      enter para cancelar"
        echo " "
        echo "            BASE:\c"
        read BASEnew
        if [ -z $BASEnew ]
        then
            loopEnd="1"
            exit
        fi
        [ $BASEnew == "c" ] && BASEnew="C"
        [ $BASEnew == "i" ] && BASEnew="I"
        if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
        then
            BASE=$BASEnew
            loopEnd="1"
        else
            tput bel
            [ $doCuu == "1" ] &&  tput cuu 8
        fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
        criterioExtraccion="        NIT"
        inputLen=11
    else
        criterioExtraccion="COD SUSCRIPTOR"
        inputLen=6
    fi
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
        echo " "
#             ......................................................................
        echo "                $criterioExtraccion PARA LA EXTRACCIÓN"
        echo $raya

        echo "      Ingrese el "$criterioExtraccion" para extracción,"
        echo "      enter para cancelar"
        echo " "
        tput el                     # borra caracteres sobrantes
        echo "            $criterioExtraccion:\c"
        read ID_EXTRACTnew
        tput el                     # borra mensaje de error
        if [ -z $ID_EXTRACTnew ]
        then
            loopEnd="1"
            exit
        fi
        # debe ser solo números
        if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]] 
        then
            echo "el dato ingresado debe ser numérico"
            tput bel
            [ $doCuu == "1" ] &&  tput cuu 7
        fi
        # control de longitud (11 o 6)
        if [ ${#ID_EXTRACTnew} -ne inputLen ]
        then
            echo "longitud incorrecta del dato"
            tput bel
            [ $doCuu == "1" ] &&  tput cuu 7
        fi
        ID_EXTRACT=$ID_EXTRACTnew
        loopEnd="1"
    done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
    [ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
    params=`cat $0.parm`
    echo '>>>> params: ' "$params"
#   separa los parámetros según su posición
    BASE=`echo "$params" | cut -d ";" -f1`
    NOM_ARCHIVO=`echo "$params" | cut -d ";" -f2`
    TIPO_ARCHIVO=`echo "$params" | cut -d ";" -f3`
    TIPO_EXTRACT=`echo "$params" | cut -d ";" -f4`
    ID_EXTRACT=`echo "$params" | cut -d ";" -f5`
    TIPO_PROC=`echo "$params" | cut -d ";" -f6`
    FECHA_PROC=`echo "$params" | cut -d ";" -f7`
}

paramsPut() {
#*******************************************************************************
# Guarda los parámetros de la corrida en el archivo .parm
#*******************************************************************************
@
    echo $BASE";"$NOM_ARCHIVO";"$TIPO_ARCHIVO";"$TIPO_EXTRACT";"$ID_EXTRACT";"$TIPO_PROC";"$F
    FECHA_PROC >| $0.parm
}

paramsPrint() {
#*******************************************************************************
# Muestra todos los parámetros, para pruebas
#*******************************************************************************
    echo "BASE="$BASE"<"
    echo "NOM_ARCHIVO="$NOM_ARCHIVO"<"
    echo "TIPO_ARCHIVO="$TIPO_ARCHIVO"<"
    echo "TIPO_EXTRACT="$TIPO_EXTRACT"<"
    echo "ID_EXTRACT="$ID_EXTRACT"<"
    echo "TIPO_PROC="$TIPO_PROC"<"
    echo "FECHA_PROC="$FECHA_PROC"<"
}


#*******************************************************************************
#*******************************************************************************
#                                     MAIN
#*******************************************************************************
#*******************************************************************************
    #Fecha de ejecución
    fechaHastaYYYYMMDD=`date '+%Y%m%d'`
    fechaHastaYYYYMM=`echo $fechaHastaYYYYMMDD  | cut -c1-6`

    clear
    echo $raya
    echo "$ASCIIBanner"
#   banner "PE Ripley"
    echo $raya

    paramsGet
    readBASE
    if [ $BASE == "C" ]
    then
        readNOM_ARCHIVO
        readTIPO_ARCHIVO
    else
        readTIPO_EXTRACT
        readID_EXTRACT
    fi
    readTIPO_PROC
    if [ $TIPO_PROC == "H" ]
    then
        readFECHA_PROC
    fi

    paramsPrint
    paramsPut
    # DEBUG: termina acá
    echo " "
    echo "HASTA ACÁ LLEGAMOS POR AHORA"
    echo "(pero estamos avanzando más rápido)"
    exit



#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
# de aquí para abajo, falta integrar (parte inexplorada)
#*******************************************************************************
#*******************************************************************************
#*******************************************************************************

/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
echo "la fecha es inválida, anterior a 2000 o posterior a 2029"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# debe ser menor que la fecha actualif [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then


REPLACE 1 CHAR


1#1#REPLACE 1 CHAR


 
:q!/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgcat sh-PE-Ripley sh-PE-Ripley   v sh-PE-Ripleyi sh-PE-Ripley
"sh-PE-Ripley" 413 lines, 13728 characters # /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="0"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya"sh-PE-Ripley" 413 lines, 13728 charactersREPLACE 1 CHAR1:w"sh-PE-Ripley" 413 lines, 13728 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>vi sh-PE-Ripleysh-PE-Ripley   
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:w
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:/
/ es un nombre de directorio
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:kjdfghlsdkfjgh
El archivo kjdfghlsdkfjgh no se encuentra
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:w
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:0
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:w
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:a
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=0<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=A<
FECHA_PROC=<
sh-PE-Ripley[4]: @:  not found
C;1;0;;;A;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:c
 
                       NOMBRE DEL ARCHIVO BASE
----------------------------------------------------------------------
      Ingrese el nombre del archivo base,
      enter para cancelar
 
            ARCHIVO:1
 
                    ESTRUCTURA DEL ARCHIVO BASE
----------------------------------------------------------------------
      0) 1-11
      1) 1-11-45
      enter para cancelar
 
            ESTRUCTURA:1
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:w
la fecha solamente puede contener dígitos
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:19990101
la fecha es inválida, anterior a 2000 o posterior a 2029
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:201401
la fecha es inválida, anterior a 2000 o posterior a 2029
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:2014010
la fecha es inválida, anterior a 2000 o posterior a 2029
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140101
BASE=C<
NOM_ARCHIVO=1<
TIPO_ARCHIVO=1<
TIPO_EXTRACT=<
ID_EXTRACT=<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
C;1;1;;;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:w
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:w
el dato ingresado debe ser numérico
longitud incorrecta del dato
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="1"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
[ $doCuu == "1" ] && tput cuu 7
else
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "o
k"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]then
echo "la fecha es inválida, anterior a 2000 o posterior a 2029"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# debe ser menor que la fecha actualif [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi/\<7\>REPLACE 1 CHAR8/8/8# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="1"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya/tipo_ext
/echo "H) Proceso histórico"echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_EXTRACTnew == "c" ] && TIPO_EXTRACTnew="C"
[ $TIPO_EXTRACTnew == "n" ] && TIPO_EXTRACTnew="N"
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
thenreadTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_EXTRACTnew == "c" ] && TIPO_EXTRACTnew="C"
[ $TIPO_EXTRACTnew == "n" ] && TIPO_EXTRACTnew="N"
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"RRtput bel
[ $doCuu == "1" ] &&  tput cuu 8else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

ReadTIPO_EXTRACT() {
#*******************************************************************************ID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
[ $doCuu == "1" ] && tput cuu 8
else
# rango de año de 2000 hasta 2029, mes 01 a 12 y día 00 a 31# [[ "20141229" == +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]] && echo "o
k"
if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]then
echo "la fecha es inválida, anterior a 2000 o posterior a 2029"tput bel
[ $doCuu == "1" ] &&  tput cuu 8else
# debe ser menor que la fecha actualif [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 8tput bel
[ $doCuu == "1" ] &&  tput cuu 8else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

ReadTIPO_EXTRACT() {
#*******************************************************************************ReadTIPO_EXTRACT() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE EXTRACCIÓN"
echo $raya
echo "N) Por NIT"
echo "C) Por codigo de suscriptor"
echo "enter para cancelar"
echo " "
echo "TIPO de EXTRACCIÓN:\c"
read TIPO_EXTRACTnew
if [ -z $TIPO_EXTRACTnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_EXTRACTnew == "c" ] && TIPO_EXTRACTnew="C"
[ $TIPO_EXTRACTnew == "n" ] && TIPO_EXTRACTnew="N"
if [ $TIPO_EXTRACTnew == "N" ] || [ $TIPO_EXTRACTnew == "C" ]
then
TIPO_EXTRACT=$TIPO_EXTRACTnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
readTIPO_ARCHIVO() {
#*******************************************************************************
# Lee el tipo de archivo "0"=1-11  "1"=1-11-45
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ESTRUCTURA DEL ARCHIVO BASE"
echo $raya
echo "0) 1-11"
echo "1) 1-11-45"
echo "enter para cancelar"
echo " "
echo "ESTRUCTURA:\c"
read TIPO_ARCHIVOnew
if [ -z $TIPO_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ $TIPO_ARCHIVOnew == "0" ] || [ $TIPO_ARCHIVOnew == "1" ]
then
TIPO_ARCHIVO=$TIPO_ARCHIVOnewloopEnd="1"
else
printf "\7"
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
readNOM_ARCHIVO() {
#*******************************************************************************
# Lee el nombre del archivo de entrada y verifica que exista en $TEMPORALES
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "NOMBRE DEL ARCHIVO BASE"
echo $raya
echo "Ingrese el nombre del archivo base,"
echo "enter para cancelar"
echo " "
tput el
echo "ARCHIVO:\c"
read NOM_ARCHIVOnew
tput el
if [ -z $NOM_ARCHIVOnew ]
then
loopEnd="1"
exit
fi
if [ -d $NOM_ARCHIVOnew ]
then
echo $NOM_ARCHIVOnew" es un nombre de directorio"tput bel
[ $doCuu == "1" ] &&  tput cuu 8
else
if [ ! -f $NOM_ARCHIVOnew ]then
echo "El archivo "$NOM_ARCHIVOnew" no se encuentra"tput bel
[ $doCuu == "1" ] &&  tput cuu 8else
NOM_ARCHIVO=$NOM_ARCHIVOnewloopEnd="1"fi
fi
    done
}

readBASE() {
#*******************************************************************************
# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    doreadBASE() {
#*******************************************************************************
# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "ORIGEN DE LA BASE"
echo $raya
echo "I) Interna"
echo "C) Provista por el Cliente"
echo "enter para cancelar"
echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
[ $BASEnew == "c" ] && BASEnew="C"
[ $BASEnew == "i" ] && BASEnew="I"
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
then
BASE=$BASEnew
loopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    donereadID_EXTRACT() {done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
[ ! -f $0.parm ] && touch $0.parm
#   lee los parámetros
params=`cat $0.parm`
echo '>>>> params: ' "$params"inputLen=6
criterioExtraccion="COD SUSCRIPTOR"

    else


inputLen=11criterioExtraccion="NIT"    then





    


f$CHANGE MODEelse
    # control de longitud (11 o 6)
    if [ ${#ID_EXTRACTnew} -ne inputLen ]
    then
    echo "longitud incorrecta del dato"    tput bel
    [ $doCuu == "1" ] &&  tput cuu 7
    fi
    ID_EXTRACT=$ID_EXTRACTnew
    loopEnd="1"
        done10 lines >>ed# control de longitud (11 o 6)
if [ ${#ID_EXTRACTnew} -ne inputLen ]
then
echo "longitud incorrecta del dato"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
fi
ID_EXTRACT=$ID_EXTRACTnew
loopEnd="1"
    done    # control de longitud (11 o 6)
    if [ ${#ID_EXTRACTnew} -ne inputLen ]
    then
    echo "longitud incorrecta del dato"    tput bel
    [ $doCuu == "1" ] &&  tput cuu 7
    fi
    ID_EXTRACT=$ID_EXTRACTnew
    loopEnd="1"9 lines >>ed


    


f$CHANGE MODEelse
    ID_EXTRACT=$ID_EXTRACTnew    loopEnd="1"

OPEN MODEfi





fififi    fi    if [ $TIPO_EXTRACT == "N" ]#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR#*******************************************************************************# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor#*******************************************************************************readID_EXTRACT() {
:w"sh-PE-Ripley" 415 lines, 13691 characters 
[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
sh-PE-Ripley[389]: readTIPO_EXTRACT:  not found
sh-PE-Ripley[5]: test: argument expected
 
                COD SUSCRIPTOR PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el COD SUSCRIPTOR para extracción,
      enter para cancelar
 
            COD SUSCRIPTOR:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
else
# control de longitud (11 o 6)if [ ${#ID_EXTRACTnew} -ne inputLen ]then
echo "longitud incorrecta del dato"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
ID_EXTRACT=$ID_EXTRACTnewloopEnd="1"# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="1"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya/read:v//dreadFECHA_PROC() {
        read FECHA_PROCnew
readTIPO_PROC() {
        read TIPO_PROCnew
ReadTIPO_EXTRACT() {
        read TIPO_EXTRACTnew
readTIPO_ARCHIVO() {
        read TIPO_ARCHIVOnew
readNOM_ARCHIVO() {
        read NOM_ARCHIVOnew
readBASE() {
        read BASEnew
readID_EXTRACT() {
        read ID_EXTRACTnew
    readBASE
readNOM_ARCHIVO
readTIPO_ARCHIVO
readTIPO_EXTRACT
readID_EXTRACT
    readTIPO_PROC
readFECHA_PROC
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
394 fewer lines#     # ##     # # #####  ####### #   ##     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya
echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
if [ -z $FECHA_PROCnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$FECHA_PROCnew" != +([0-9]) ]]
then
echo "la fecha solamente puede contener dígitos"tput bel
394 more lines######  #######    ######    ASCIIBanner="    raya="----------------------------------------------------------------------"    codSuscriptor=999999    NITSuscriptor=900047981    doCuu="1"# Definición de constantes#*******************************************************************************#AUTHOR:Globant - JL#LAST-UPDATE:  2014/05/23#DATE-WRITTEN: 2014/05/23#SHELL-ID:     sh-PE-Ripley#*******************************************************************************#sh-PE-Ripley.V.1.0001# /d/iccol/desarrollo/macros/sh-PE-Ripley//echo "Ingrese fecha de proceso,"
echo "enter para cancelar"
echo " "
echo "FECHA de PROCESO AAAAMMDD:\c"
read FECHA_PROCnew
/if [[ "$FECHA_PROCnew" != +(20[012][0-9](0[0-9]|1[12])([012][0-9]|3[01])) ]]then
echo "la fecha es inválida, anterior a 2000 o posterior a 2029"tput bel
[ $doCuu == "1" ] &&  tput cuu 8else
# debe ser menor que la fecha actualif [ $FECHA_PROCnew -ge $fechaHastaYYYYMMDD ]then
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 8else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnew//loopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
done
}

ReadTIPO_EXTRACT() {rr
:w"sh-PE-Ripley" 415 lines, 13691 characters r
[1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:w
el dato ingresado debe ser numérico
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:123
longitud incorrecta del dato
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:123
longitud incorrecta del dato
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:
/d/iccol/desarrollo/macros>fg
vi sh-PE-Ripley
echo "la fecha de proceso histórico debe ser anterior a la actual"tput bel
[ $doCuu == "1" ] &&  tput cuu 8else
# todo bien
FECHA_PROC=$FECHA_PROCnewloopEnd="1"
fi
fi
fi
    done
}

readTIPO_PROC() {
#*******************************************************************************
# Tipo de extracción, cuando BASE="I": "N" por NIT  "C" por cod suscriptor
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "TIPO DE PROCESO"
echo $raya
echo "A) Proceso actual"
echo "H) Proceso histórico"
echo "enter para cancelar"
echo " "
echo "TIPO de PROCESO:\c"
read TIPO_PROCnew
if [ -z $TIPO_PROCnew ]
then
loopEnd="1"
exit
fi
[ $TIPO_PROCnew == "a" ] && TIPO_PROCnew="A"
[ $TIPO_PROCnew == "h" ] && TIPO_PROCnew="H"
if [ $TIPO_PROCnew == "H" ] || [ $TIPO_PROCnew == "A" ]
then
TIPO_PROC=$TIPO_PROCnewloopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readTIPO_EXTRACT() {r# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    doCuu="1"
    NITSuscriptor=900047981
    codSuscriptor=999999
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
#     # ##     # # #    # ### #
######  ###########  # #    # ######    #
###   #   # #####  ###
###    #  # ####
########    #     # # ####### ######   #
"

# Valores iniciales de los parámetros
#   "I": la lista de IDs es interna  "C": provista x cliente
    BASE="C"
#si BASE="C": archivo y estructura ("0": 1-11 o "1": 1-11-45)
NOM_ARCHIVO=" "
TIPO_ARCHIVO="1"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACTID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha de proceso
FECHA_PROC=" "

readFECHA_PROC() {
#*******************************************************************************
# Fecha de proceso, cuando tipo de extracción es "H"
#*******************************************************************************
    loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "FECHA DE PROCESO"
echo $raya

    REPLACE 1 CHAR0:w"sh-PE-Ripley" 415 lines, 13691 characters /id_extra/echo "C) Provista por el Cliente"echo "enter para cancelar"
echo " "
echo "BASE:\c"
read BASEnew
if [ -z $BASEnew ]
then
loopEnd="1"
exit
fi
[ $BASEnew == "c" ] && BASEnew="C"
[ $BASEnew == "i" ] && BASEnew="I"
if [ $BASEnew == "C" ] || [ $BASEnew == "I" ]
then
BASE=$BASEnew
loopEnd="1"
else
tput bel
[ $doCuu == "1" ] &&  tput cuu 8
fi
    done
}

readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"readID_EXTRACT() {
#*******************************************************************************
# Lee el criterio para extracción base interna: un NIT o un cod de suscriptor
#*******************************************************************************
#   según TIPO_EXTRAC se lee un NIT o un COD SUSCRIPTOR
    if [ $TIPO_EXTRACT == "N" ]
    then
criterioExtraccion="NIT"
inputLen=11
    else
criterioExtraccion="COD SUSCRIPTOR"
inputLen=6
    fi
loopEnd="0"
    while [ $loopEnd == "0" ]
    do
  echo " "
#......................................................................
echo "$criterioExtraccion PARA LA EXTRACCIÓN"
echo $rayaecho "Ingrese el "$criterioExtraccion" para extracción,"
echo "enter para cancelar"
echo " "
tput el# borra caracteres sobrantes
echo "$criterioExtraccion:\c"
read ID_EXTRACTnew
tput el# borra mensaje de error
if [ -z $ID_EXTRACTnew ]
then
loopEnd="1"
exit
fi
# debe ser solo números
if [[ "$ID_EXTRACTnew" !=  +([0-9]) ]]
then
echo "el dato ingresado debe ser numérico"tput bel
[ $doCuu == "1" ] &&  tput cuu 7
else
# control de longitud (11 o 6)if [ ${#ID_EXTRACTnew} -ne inputLen ]then
echo "longitud incorrecta del dato"tput bel
[ $doCuu == "1" ] &&  tput cuu 7else
ID_EXTRACT=$ID_EXTRACTnewloopEnd="1"/\<7\>REPLACE 1 CHAR8/8



fi
fi
done
}

paramsGet() {
#*******************************************************************************
# Lee los parámetros de la corrida anterior
#*******************************************************************************
#   asegura que exista el arch de parámetros general
[ ! -f $0.parm ] && touch $0.parm:w"sh-PE-Ripley" 415 lines, 13691 characters [1] + Stopped (SIGTSTP)        vi sh-PE-Ripley
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:123
longitud incorrecta del dato
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:123456
longitud incorrecta del dato
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:123456789012
longitud incorrecta del dato
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:12345678901
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:a
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=12345678901<
TIPO_PROC=A<
FECHA_PROC=<
sh-PE-Ripley[4]: @:  not found
I;;;N;12345678901;A;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:n
 
                        NIT PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el  NIT para extracción,
      enter para cancelar
 
                    NIT:12345678901
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:h
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:w
la fecha solamente puede contener dígitos
 
                          FECHA DE PROCESO
----------------------------------------------------------------------
      Ingrese fecha de proceso,
      enter para cancelar
 
            FECHA de PROCESO AAAAMMDD:20140101
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=N<
ID_EXTRACT=12345678901<
TIPO_PROC=H<
FECHA_PROC=20140101<
sh-PE-Ripley[4]: @:  not found
I;;;N;12345678901;H;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>sh-PE-Ripley
----------------------------------------------------------------------

        ######  #######    ######
        #     # #          #     # # #####  #      ###### #   #
        #     # #          #     # # #    # #      #       # #
        ######  #####      ######  # #    # #      #####    #
        #       #          #   #   # #####  #      #        #
        #       #          #    #  # #      #      #        #
        #       #######    #     # # #      ###### ######   #

----------------------------------------------------------------------
>>>> params:  
 
                       ORIGEN DE LA BASE
----------------------------------------------------------------------
      I) Interna
      C) Provista por el Cliente
      enter para cancelar
 
            BASE:i
 
                         TIPO DE EXTRACCIÓN
----------------------------------------------------------------------
      N) Por NIT
      C) Por codigo de suscriptor
      enter para cancelar
 
            TIPO de EXTRACCIÓN:c
 
                COD SUSCRIPTOR PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el COD SUSCRIPTOR para extracción,
      enter para cancelar
 
            COD SUSCRIPTOR:w
el dato ingresado debe ser numérico
 
                COD SUSCRIPTOR PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el COD SUSCRIPTOR para extracción,
      enter para cancelar
 
            COD SUSCRIPTOR:123
longitud incorrecta del dato
 
                COD SUSCRIPTOR PARA LA EXTRACCIÓN
----------------------------------------------------------------------
      Ingrese el COD SUSCRIPTOR para extracción,
      enter para cancelar
 
            COD SUSCRIPTOR:123456
 
                          TIPO DE PROCESO
----------------------------------------------------------------------
      A) Proceso actual
      H) Proceso histórico
      enter para cancelar
 
            TIPO de PROCESO:a
BASE=I<
NOM_ARCHIVO=<
TIPO_ARCHIVO=<
TIPO_EXTRACT=C<
ID_EXTRACT=123456<
TIPO_PROC=A<
FECHA_PROC=<
sh-PE-Ripley[4]: @:  not found
I;;;C;123456;A;
sh-PE-Ripley[6]: FECHA_PROC:  not found
 
HASTA ACÁ LLEGAMOS POR AHORA
(pero estamos avanzando más rápido)
/d/iccol/desarrollo/macros>
/d/iccol/desarrollo/macros>
shell will timeout in 60 seconds due to inactivity
ksh[2]: timed out waiting for input
You have running jobs
