=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.30 16:59:58 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Thu Jun 26 14:02:30 2014 from 172.16.10.99
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>ls -l *JUR*
-rw-rw-r--   1 icrmbd   icdatacr   17397 Dec 20  2013 ACTALEJUR.CBL
-rw-rw-r--   1 icrmbd   icdatacr   22016 Dec 20  2013 ACTALEJUR.int
-rw-rw-r--   1 icjlud   icdatacr   63624 Jun 25 16:38 CARGAJUR.bup.CBL
-rw-rw-r--   1 icdgd    icdatacr   62149 Jun 26 18:55 CARGAJUR.CBL
-rw-rw-r--   1 icvhfd   icdatacr 1383756 Sep  6  2010 ICGCON-JUR.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1577399 Dec 19  2013 ICGCONJURAD.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1781276 Dec 19  2013 ICGCPLJURAD.CBL
-rw-rw-r--   1 icehad   icdatacr 1772414 Jun  3 15:20 ICGCPLV258.CBL-JURAD
-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 13 15:02 JURADCAR.CBL
-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 13 15:09 JURADCAR1.CBL
/d/iccol/desarrollo/fuentes>rm JURADCAR.CBL JURADCAR1.CBL ACTALEJUR.int
/d/iccol/desarrollo/fuentes>^[[A  /d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm JURADCAR.CBL JURADCAR1.CBL ACTALEJUR.int/d/iccol/desarrollo/fuentes>ls -l *JUR*                                /d/iccol/desarrollo/fuentes>
-rw-rw-r--   1 icrmbd   icdatacr   17397 Dec 20  2013 ACTALEJUR.CBL
-rw-rw-r--   1 icjlud   icdatacr   63624 Jun 25 16:38 CARGAJUR.bup.CBL
-rw-rw-r--   1 icdgd    icdatacr   62149 Jun 26 18:55 CARGAJUR.CBL
-rw-rw-r--   1 icvhfd   icdatacr 1383756 Sep  6  2010 ICGCON-JUR.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1577399 Dec 19  2013 ICGCONJURAD.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1781276 Dec 19  2013 ICGCPLJURAD.CBL
-rw-rw-r--   1 icehad   icdatacr 1772414 Jun  3 15:20 ICGCPLV258.CBL-JURAD
/d/iccol/desarrollo/fuentes>sdiff -w 170 CARGAJUR.bup.CBL CARGAJUR.CBL
Copia de CARGAJUR.CBL previa a las modificaciones del 2014-06-25 (eliminar sin mi   <  
      $SET LIST SETTING LISTWIDTH"120"                                                       $SET LIST SETTING LISTWIDTH"120"
       IDENTIFICATION DIVISION.                                                               IDENTIFICATION DIVISION.
       PROGRAM-ID.    CARGAJUR.                                                               PROGRAM-ID.    CARGAJUR.
      ******************************************************************                     ******************************************************************
      * ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS                         * ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS
      * POR JURAD                                                                            * POR JURAD
      * PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA                       * PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA
      * LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN                      * LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN
      * EL ARCHIVO ERRS.                                                                     * EL ARCHIVO ERRS.
                                                                                    >        * Prueba: 0000011000905140101.txt
      ******************************************************************                     ******************************************************************
       AUTHOR.        GLOBANT JL.                                                             AUTHOR.        GLOBANT JL.
       DATE-WRITTEN.                                                                          DATE-WRITTEN.
       DATE-COMPILED.                                                                         DATE-COMPILED.
       CONFIGURATION SECTION.                                                                 CONFIGURATION SECTION.
       SOURCE-COMPUTER. MICROFOCUS. *> WITH DEBUGGING MODE.                         |         SOURCE-COMPUTER. MICROFOCUS. *> with debugging mode.
       OBJECT-COMPUTER. MICROFOCUS.                                                           OBJECT-COMPUTER. MICROFOCUS.
       INPUT-OUTPUT SECTION.                                                                  INPUT-OUTPUT SECTION.
       FILE-CONTROL.                                                                          FILE-CONTROL.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
       SELECT JURAD ASSIGN TO P-FILE-PATH                                                     SELECT JURAD ASSIGN TO P-FILE-PATH
           ORGANIZATION IS LINE SEQUENTIAL                                                        ORGANIZATION IS LINE SEQUENTIAL
           FILE STATUS IS JURAD-FS.                                                               FILE STATUS IS JURAD-FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
       SELECT ERRS ASSIGN TO ERRS-FILE-NAME                                                   SELECT ERRS ASSIGN TO ERRS-FILE-NAME
           ORGANIZATION IS LINE SEQUENTIAL                                                        ORGANIZATION IS LINE SEQUENTIAL
           FILE STATUS IS ERRS-FS.                                                                FILE STATUS IS ERRS-FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
           COPY BDIIREGI.FS.                                                                      COPY BDIIREGI.FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
           COPY BDIIDIAN.FS.                                                                      COPY BDIIDIAN.FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
           COPY BDIIDAS.FS.                                                                       COPY BDIIDAS.FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
           COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD                              COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD
              FILE STATUS IS EST-BDIIALE.==.                                                         FILE STATUS IS EST-BDIIALE.==.

      ******************************************************************                     ******************************************************************
      * Archivos de base alterna                                                             * Archivos de base alterna
      ******************************************************************                     ******************************************************************
           copy BDACSV.FS.                                                                        copy BDACSV.FS.
           copy ICBDIR.FS.                                                                        copy ICBDIR.FS.
           copy BDLCLI.FS.                                                                        copy BDLCLI.FS.
           COPY ICBSUS.FS.                                                                        COPY ICBSUS.FS.
           COPY ICBCHK.FS.                                                                        COPY ICBCHK.FS.
           COPY ICBCRE.FS.                                                                        COPY ICBCRE.FS.
           COPY BDLSTDCIU.FS.                                                                     COPY BDLSTDCIU.FS.
           COPY DIREST.FS.                                                                        COPY DIREST.FS.
           COPY BDLNEWDIRBOG.FS.                                                                  COPY BDLNEWDIRBOG.FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
       DATA DIVISION.                                                                         DATA DIVISION.
       FILE section.                                                                          FILE section.

      ******************************************************************                     ******************************************************************
      * Archivo de entrada con los datos de demandas y embargos de JURAD                     * Archivo de entrada con los datos de demandas y embargos de JURAD
      ******************************************************************                     ******************************************************************
       FD JURAD.                                                                              FD JURAD.
       01  JURAD-reg.                                                                         01  JURAD-reg.
      * Registros de movimientos I, M, E                                                     * Registros de movimientos I, M, E
      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim                                        *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
           03 JURAD-TIPO-NOVEDAD          PIC X.                                                  03 JURAD-TIPO-NOVEDAD          PIC X.
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                        *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 JURAD-ID-TIPO               PIC X.                                                  03 JURAD-ID-TIPO               PIC X.
      *    Numero de identificacion                                                          *    Numero de identificacion
           03 JURAD-ID-NUMEROX            PIC X(11).                                              03 JURAD-ID-NUMEROX            PIC X(11).
           03 JURAD-ID-NUMERO           REDEFINES JURAD-ID-NUMEROX                                03 JURAD-ID-NUMERO             REDEFINES JURAD-ID-NUMEROX
                                          PIC 9(11).                                                                             PIC 9(11).
      *    Nombres y Apellidos                                                               *    Nombres y Apellidos
           03 JURAD-NOMBRE                PIC X(45).                                              03 JURAD-NOMBRE                PIC X(45).
      *    Numero de demandas vigentes                                                       *    Numero de demandas vigentes
      *    03 JURAD-DEMANDAS-VIGENTES     PIC 999.                                  <  
           03 JURAD-DEMANDAS-VIGENTES     PIC 9(07).                                              03 JURAD-DEMANDAS-VIGENTES     PIC 9(07).
      *    Numero de demandas terminadas                                                     *    Numero de demandas terminadas
      *    03 JURAD-DEMANDAS-TERMINADAS   PIC 999.                                  <  
           03 JURAD-DEMANDAS-TERMINADAS   PIC 9(07).                                              03 JURAD-DEMANDAS-TERMINADAS   PIC 9(07).
      *    Fecha ultima demanda vigente YYYYMMDD                                             *    Fecha ultima demanda vigente YYYYMMDD
           03 JURAD-DEMANDAS-FECHA-ULTIMA PIC X(8).                                               03 JURAD-DEMANDAS-FECHA-ULTIMA PIC X(8).
      *    Numero de embargos vigentes                                                       *    Numero de embargos vigentes
      *    03 JURAD-EMBARGOS-VIGENTES     PIC 999.                                  <  
           03 JURAD-EMBARGOS-VIGENTES     PIC 9(07).                                              03 JURAD-EMBARGOS-VIGENTES     PIC 9(07).
      *    Numero de embargos terminados                                                     *    Numero de embargos terminados
      *    03 JURAD-EMBARGOS-TERMINADOS   PIC 999.                                  <  
           03 JURAD-EMBARGOS-TERMINADOS   PIC 9(07).                                              03 JURAD-EMBARGOS-TERMINADOS   PIC 9(07).
      *    Fecha ultimo embargo vigente YYYYMMDD                                             *    Fecha ultimo embargo vigente YYYYMMDD
           03 JURAD-EMBARGOS-FECHA-ULTIMO PIC X(08).                                              03 JURAD-EMBARGOS-FECHA-ULTIMO PIC X(08).

       01  JURADT-REG.                                                                        01  JURADT-REG.
      * Registro de totales de control T                                                     * Registro de totales de control T
      *    Tipo de Novedad = "T"                                                             *    Tipo de Novedad = "T"
           03 JURADT-TIPO-NOVEDAD         PIC X.                                                  03 JURADT-TIPO-NOVEDAD         PIC X.
           03                             PIC X.                                                  03                             PIC X.
      *    Cantidad de registros                                                             *    Cantidad de registros
           03 JURADT-REGISTROS            PIC 9(11).                                              03 JURADT-REGISTROS            PIC 9(11).
      *    03                             PIC X.                                    <  
           03                             PIC X(45).                                              03                             PIC X(45).
      *    Total numero de demandas vigentes                                                 *    Total numero de demandas vigentes
           03 JURADT-DEMANDAS-VIGENTES    PIC 9(7).                                               03 JURADT-DEMANDAS-VIGENTES    PIC 9(7).
      *    03                             PIC X.                                    <  
      *    Total numero de demandas terminadas                                               *    Total numero de demandas terminadas
           03 JURADT-DEMANDAS-TERMINADAS  PIC 9(7).                                               03 JURADT-DEMANDAS-TERMINADAS  PIC 9(7).
      *    03                             PIC X.                                    <  
           03                             PIC X(08).                                              03                             PIC X(08).
      *    Total numero de embargos vigentes                                                 *    Total numero de embargos vigentes
           03 JURADT-EMBARGOS-VIGENTES    PIC 9(7).                                               03 JURADT-EMBARGOS-VIGENTES    PIC 9(7).
      *    03                             PIC X.                                    <  
      *    Total numero de embargos terminados                                               *    Total numero de embargos terminados
           03 JURADT-EMBARGOS-TERMINADOS  PIC 9(7).                                               03 JURADT-EMBARGOS-TERMINADOS  PIC 9(7).
           03                             PIC X(08).                                              03                             PIC X(08).

      ******************************************************************                     ******************************************************************
      * Archivo de salida con los registros defectuosos del arch JURAD                       * Archivo de salida con los registros defectuosos del arch JURAD
      ******************************************************************                     ******************************************************************
       FD ERRS.                                                                               FD ERRS.
       01  ERRS-REG.                                                                          01  ERRS-REG.
      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales                             *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
           03 ERRS-TIPO-NOVEDAD          PIC X.                                                   03 ERRS-TIPO-NOVEDAD          PIC X.
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                        *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 ERRS-ID-TIPO               PIC X.                                                   03 ERRS-ID-TIPO               PIC X.
      *    Numero de identificacion                                                          *    Numero de identificacion
           03 ERRS-ID-NUMERO             PIC X(11).                                               03 ERRS-ID-NUMERO             PIC X(11).
      *    Nombres y Apellidos                                                               *    Nombres y Apellidos
           03 ERRS-NOMBRE                PIC X(45).                                               03 ERRS-NOMBRE                PIC X(45).
      *    Numero de demandas vigentes                                                       *    Numero de demandas vigentes
      *    03 ERRS-DEMANDAS-VIGENTES     PIC 999.                                            *    03 ERRS-DEMANDAS-VIGENTES     PIC 999.
           03 ERRS-DEMANDAS-VIGENTES     PIC 9(07).                                               03 ERRS-DEMANDAS-VIGENTES     PIC 9(07).
      *    Numero de demandas terminadas                                                     *    Numero de demandas terminadas
      *    03 ERRS-DEMANDAS-TERMINADAS   PIC 999.                                            *    03 ERRS-DEMANDAS-TERMINADAS   PIC 999.
           03 ERRS-DEMANDAS-TERMINADAS   PIC 9(07).                                               03 ERRS-DEMANDAS-TERMINADAS   PIC 9(07).
      *    Fecha ultima demanda vigente YYMMDD                                               *    Fecha ultima demanda vigente YYMMDD
           03 ERRS-DEMANDAS-FECHA-ULTIMA PIC X(8).                                                03 ERRS-DEMANDAS-FECHA-ULTIMA PIC X(8).
      *    Numero de embargos vigentes                                                       *    Numero de embargos vigentes
      *    03 ERRS-EMBARGOS-VIGENTES     PIC 999.                                            *    03 ERRS-EMBARGOS-VIGENTES     PIC 999.
           03 ERRS-EMBARGOS-VIGENTES     PIC 9(07).                                               03 ERRS-EMBARGOS-VIGENTES     PIC 9(07).
      *    Numero de embargos terminados                                                     *    Numero de embargos terminados
      *    03 ERRS-EMBARGOS-TERMINADOS   PIC 999.                                            *    03 ERRS-EMBARGOS-TERMINADOS   PIC 999.
           03 ERRS-EMBARGOS-TERMINADOS   PIC 9(07).                                               03 ERRS-EMBARGOS-TERMINADOS   PIC 9(07).
      *    Fecha ultimo embargo vigente YYMMDD                                               *    Fecha ultimo embargo vigente YYMMDD
           03 ERRS-EMBARGOS-FECHA-ULTIMO PIC X(8).                                                03 ERRS-EMBARGOS-FECHA-ULTIMO PIC X(8).
      *    Causa del rechazo                                                                 *    Causa del rechazo
           03 ERRS-CAUSA-RECHAZO         PIC X(61).                                 |             03 ERRS-CAUSA-RECHAZO         PIC X(300).

      ******************************************************************                     ******************************************************************
      * Contiene los ids y nombres de personas                                               * Contiene los ids y nombres de personas
      ******************************************************************                     ******************************************************************
       COPY BDIIREGI.FD.                                                                      COPY BDIIREGI.FD.

      ******************************************************************                     ******************************************************************
      * Maestro de personas juridicas nacionales y extranjeras reportada                     * Maestro de personas juridicas nacionales y extranjeras reportada
      * por la DIAN                                                                          * por la DIAN
      ******************************************************************                     ******************************************************************
       COPY BDIIDIAN.FD.                                                                      COPY BDIIDIAN.FD.

      ******************************************************************                     ******************************************************************
      * Archivo maestro de cedulas de extranjeria suministrado por DAS                       * Archivo maestro de cedulas de extranjeria suministrado por DAS
      ******************************************************************                     ******************************************************************
       COPY BDIIDAS.FD.                                                                       COPY BDIIDAS.FD.

      ******************************************************************                     ******************************************************************
      * Archivos de base alterna                                                             * Archivos de base alterna
      ******************************************************************                     ******************************************************************
           COPY BDACSV.FD.                                                                        COPY BDACSV.FD.
           COPY ICBDIR0001.FD.                                                                    COPY ICBDIR0001.FD.
           COPY BDLCLI.FD.                                                                        COPY BDLCLI.FD.
           COPY ICBSUS.FD.                                                                        COPY ICBSUS.FD.
           COPY ICBCHK.FD.                                                                        COPY ICBCHK.FD.
           COPY ICBCRE.FD.                                                                        COPY ICBCRE.FD.
           COPY BDLSTDCIU.FD.                                                                     COPY BDLSTDCIU.FD.
           COPY DIREST.FD.                                                                        COPY DIREST.FD.
           COPY BDLNEWDIRBOG.FD.                                                                  COPY BDLNEWDIRBOG.FD.

      ******************************************************************                     ******************************************************************
      * Maestro de alertas reportadas por suscriptores                                       * Maestro de alertas reportadas por suscriptores
      ******************************************************************                     ******************************************************************
       COPY BDIIALE.FD.                                                                       COPY BDIIALE.FD.

      ******************************************************************                     ******************************************************************
       WORKING-STORAGE SECTION.                                                               WORKING-STORAGE SECTION.
      ******************************************************************                     ******************************************************************
      * Nombre del programa                                                                  * Nombre del programa
       01  PGM                          PIC X(10) VALUE "CARGAJUR".                           01  PGM                          PIC X(10) VALUE "CARGAJUR".


      ******************************************************************                     ******************************************************************
      * Datos para la búsqueda en base alterna                                               * Datos para la búsqueda en base alterna
       01  W-DERECHOS                   PIC 9 value 0.                              |         01  W-DERECHOS                   PIC 9 VALUE 0.
       01  CODIGO-ERROR                 pic 99 value 00.                            |         01  CODIGO-ERROR                 PIC 99 VALUE 00.

       01  SW-BDIIALE                   pic 9 value 0.                              |         01  SW-BDIIALE                   PIC 9 VALUE 0.
       01  HACER-MATCH                  PIC 9 value 0.                              |         01  HACER-MATCH                  PIC 9 VALUE 0.
       01  CADENA-ENTRA                 PIC X(60).                                            01  CADENA-ENTRA                 PIC X(60).
       01  CADENA-SALE                  PIC X(60).                                            01  CADENA-SALE                  PIC X(60).
       01  IND-ALFABETICO              PIC  X(01).                                            01  IND-ALFABETICO              PIC  X(01).
           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"                           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"
                                            "G" "H" "I" "J" "K" "L" "M"             |                                         "G" "H" "I" "J" "K" "L" "M" "N"
                                            "N" "/" "O" "P" "Q" "R" "S"             |                                         "/" "O" "P" "Q" "R" "S" "T" "U"
                                            "T" "U" "V" "W" "X" "Y" "Z"             |                                         "V" "W" "X" "Y" "Z" "Ñ".
                                            "Ñ".                                    <  

       01  DATOS-E.                                                                           01  DATOS-E.
           03 TIPOID-E                  pic 9.                                      |             03 TIPOID-E                  PIC 9.
           03 NUMID-E                   pic 9(11).                                  |             03 NUMID-E                   PIC 9(11).
           03 NOMBRE-E                  pic x(45).                                  |             03 NOMBRE-E                  PIC x(45).

       01  W-CONTADORES.                                                                      01  W-CONTADORES.
           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-5            PIC 9(6) VALUE ZERO.
           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-6            PIC 9(6) VALUE ZERO.
           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-7            PIC 9(6) VALUE ZERO.
           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZERO.
           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZERO.

       01  SUSCRIPTOR-AUX               PIC 9(06).                                  |         01  SUSCRIPTOR-AUX               PIC 9(6).
       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.                      |         01  REG-MAL-FORMADOS             PIC 9(7) VALUE ZERO.
       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.                      |         01  REG-LEIDOS                   PIC 9(7) VALUE ZERO.
       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.                      |         01  CONT-FALLECIDOS              PIC 9(7) VALUE ZERO.
       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.                      |         01  REG-CORRECTOS                PIC 9(7) VALUE ZERO.
       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.                      |         01  NO-COINCIDE-DIAN             PIC 9(7) VALUE ZERO.
       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.                      |         01  NO-COINCIDE-REGIS            PIC 9(7) VALUE ZERO.
       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.                      |         01  NO-EXISTE-DIAN               PIC 9(7) VALUE ZERO.
       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.                      |         01  NO-EXISTE-REGIS              PIC 9(7) VALUE ZERO.
       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.                      |         01  SI-EXISTE-CSV                PIC 9(7) VALUE ZERO.
       01  NUM-ID-W                     PIC 9(11) VALUE ZEROS.                      |         01  TIPO-ID-INVALIDO             PIC 9(7) VALUE ZERO.
                                                                                    >         01  NUM-ID-W                     PIC 9(11) VALUE ZERO.
       01  FECHA-PROC.                                                                        01  FECHA-PROC.
           03 ANO-HOY.                                                                            03 ANO-HOY.
              05 SIG-PROC           PIC X(2).                                                        05 SIG-PROC               PIC X(2).
              05 ANO-PROC           PIC X(2).                                                        05 ANO-PROC               PIC X(2).
           03 MES-PROC              PIC X(2).                                                     03 MES-PROC                  PIC X(2).
           03 DIA-PROC              PIC X(2).                                                     03 DIA-PROC                  PIC X(2).
       01  FECHA-PROC-R  REDEFINES FECHA-PROC                                                 01  FECHA-PROC-R                 REDEFINES FECHA-PROC
                                    PIC X(8).                                                                                  PIC X(8).

       01 MAS-DATOS.                                                                          01 MAS-DATOS.
           03 I                         PIC 9(02) VALUE ZERO.                                     03 I                         PIC 9(02) VALUE ZERO.
           03 J                         PIC 9(02) VALUE ZERO.                                     03 J                         PIC 9(02) VALUE ZERO.

           COPY  BDLDIR.WS.                                                                       COPY  BDLDIR.WS.

      ******************************************************************                     ******************************************************************
      * Variables para rutina de validacion de identificaciones                              * Variables para rutina de validacion de identificaciones
      ******************************************************************                     ******************************************************************
           COPY BDIIVIDE.WS.                                                                      COPY BDIIVIDE.WS.

      ******************************************************************                     ******************************************************************
      * Variables relacionadas con la la base BDIIALE de alertas online                      * Variables relacionadas con la la base BDIIALE de alertas online
      ******************************************************************                     ******************************************************************
           COPY BDIIALE.WS.                                                                       COPY BDIIALE.WS.

      ******************************************************************                     ******************************************************************
      * Datos para las rutinas de validación de nombres                                      * Datos para las rutinas de validación de nombres
      ******************************************************************                     ******************************************************************
           COPY VALNOM.WS.                                                                        COPY VALNOM.WS.

      *****************************************************************                      *****************************************************************
      * Direcciones de los archivos en el file system                                        * Direcciones de los archivos en el file system
      *****************************************************************                      *****************************************************************
       COPY ICFILE.WS.                                                                        COPY ICFILE.WS.

      *****************************************************************                      *****************************************************************
      * Variables validacion cuentas si validar                                              * Variables validacion cuentas si validar
      *****************************************************************                      *****************************************************************
           COPY BDAMATCH.WS.                                                                      COPY BDAMATCH.WS.

      ******************************************************************                     ******************************************************************
      * Indica que se termino el proceso, por agotamiento del archivo                        * Indica que se termino el proceso, por agotamiento del archivo
      * de entrada (normal) o alguna otra condicion (error)                                  * de entrada (normal) o alguna otra condicion (error)
       01  IND-FIN-PROCESO              PIC XX VALUE "NO".                                    01  IND-FIN-PROCESO              PIC XX VALUE "NO".

      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)                          * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
       01  JURAD-REG-ANTERIOR           PIC X(100) VALUE "(VACIO)".                           01  JURAD-REG-ANTERIOR           PIC X(100) VALUE "(VACIO)".
       01  JURAD-FS                     PIC XX VALUE SPACES.                                  01  JURAD-FS                     PIC XX VALUE SPACES.
       01  ERRS-FS                      PIC XX VALUE SPACES.                                  01  ERRS-FS                      PIC XX VALUE SPACES.

      * Datos de demandas o embargos que van en el registro BDIIALE                          * Datos de demandas o embargos que van en el registro BDIIALE
       01 D-DATAHOST.                                                                         01 D-DATAHOST.
           05 D-VIGENTES                PIC 9(5).                                                 05 D-VIGENTES                PIC 9(5).
           05 D-TERMINADOS              PIC 9(5).                                                 05 D-TERMINADOS              PIC 9(5).
           05 D-FECHA-ULTIMA            PIC X(8).                                                 05 D-FECHA-ULTIMA            PIC X(8).
      ******************************************************************                     ******************************************************************
      * Parametros iniciales, de la linea de comando                                         * Parametros iniciales, de la linea de comando
      * La linea de comando que contiene los parametros                                      * La linea de comando que contiene los parametros
       01 P-COMMAND-LINE                PIC X(80) VALUE SPACES.                               01 P-COMMAND-LINE                PIC X(80) VALUE SPACES.
       01 P-PARAMETROS.                                                                       01 P-PARAMETROS.
      *    Proceso real: contiene "1" para activar, "2" por defecto                          *    Proceso real: contiene "1" para activar, "2" por defecto
           03 P-PROCESO-REAL            PIC X VALUE "2".                                          03 P-PROCESO-REAL            PIC X VALUE "2".
           88 PROCESO-REAL              VALUE "2".                                                88 PROCESO-REAL              VALUE "2".

      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt                             *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
           03 P-FILE-NAME               PIC X(80) VALUE SPACES.                                   03 P-FILE-NAME               PIC X(80) VALUE SPACES.
           03 P-FILE-NAME-R             REDEFINES P-FILE-NAME.                                    03 P-FILE-NAME-R             REDEFINES P-FILE-NAME.
      *        JJJJJJ = Codigo de suscriptor JURAD en Experian                               *        JJJJJJ = Codigo de suscriptor JURAD en Experian
               05 P-COD-SUSCRIPTOR      PIC 9(6).                                                     05 P-COD-SUSCRIPTOR      PIC 9(6).
      *        aaa = Codificacion del producto ("100")                                       *        aaa = Codificacion del producto ("100")
               05 P-PRODUCTO            PIC XXX.                                                      05 P-PRODUCTO            PIC XXX.
      *        DDMMAA = Fecha de proceso                                                     *        DDMMAA = Fecha de proceso
               05 P-FECHA-PROCESO       PIC X(6).                                                     05 P-FECHA-PROCESO       PIC X(6).
      *        bb =  01 a CI                                                                 *        bb =  01 a CI
               05 P-CI-BI               PIC XX.                                                       05 P-CI-BI               PIC XX.
      *        XX = Tipo de proceso                                                          *        XX = Tipo de proceso
      *        01 Envio Original - Carga TOTAL - primera vez                                 *        01 Envio Original - Carga TOTAL - primera vez
      *        02 Archivo Semanal - Carga PARCIAL                                            *        02 Archivo Semanal - Carga PARCIAL
      *        03 Archivo Mensual - Carga PARCIAL                                            *        03 Archivo Mensual - Carga PARCIAL
      *        04 Refresque Total - Carga TOTAL                                              *        04 Refresque Total - Carga TOTAL
               05 P-TIPO-PROCESO        PIC XX.                                                       05 P-TIPO-PROCESO        PIC XX.
      *        extension del archivo ".txt"                                                  *        extension del archivo ".txt"
               05 P-EXTENSION           PIC X(4).                                                     05 P-EXTENSION           PIC X(4).
               05                       PIC X(57).                                                    05                       PIC X(57).
           03 P-FILE-PATH               PIC X(80) VALUE SPACES.                                   03 P-FILE-PATH               PIC X(80) VALUE SPACES.
      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs                               * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs
          03 ERRS-FILE-NAME             PIC X(80) VALUE SPACES.                                  03 ERRS-FILE-NAME             PIC X(80) VALUE SPACES.

      * Fecha de proceso editada YYYYMMDD                                                    * Fecha de proceso editada YYYYMMDD
       01 P-FECHA-PROCESO-YYYYMMDD      PIC X(8).                                             01 P-FECHA-PROCESO-YYYYMMDD      PIC X(8).
      * Fecha de proceso + 50 años                                                           * Fecha de proceso + 50 años
       01 P-FECHA-PROCESO-50.                                                                 01 P-FECHA-PROCESO-50.
           03  P-FECHA-PROCESO-50YYYY   PIC 9999.                                                 03  P-FECHA-PROCESO-50YYYY   PIC 9999.
           03                           PIC X(4).                                                 03                           PIC X(4).
      ******************************************************************                     ******************************************************************
      * Datos para el reporte final                                                          * Datos para el reporte final
       01 W-TIEMPO.                                                                           01 W-TIEMPO.
           03 W-HORA-INICIO             PIC 9(8).                                                 03 W-HORA-INICIO             PIC 9(8).
           03 W-HORA-FIN                PIC 9(8).                                                 03 W-HORA-FIN                PIC 9(8).
       01 N-EDIT                        PIC Z(8)B.                                  |         01 N-EDIT                        PIC Z(7)9B.
       01 N-EDITP100                    REDEFINES N-EDIT                                      01 N-EDITP100                    REDEFINES N-EDIT
                                        PIC Z(5)9.9B.                                                                          PIC Z(5)9.9B.
       01 N-CONTADORES.                                                                       01 N-CONTADORES.
      *    Registros en el archivo de entrada                                                *    Registros en el archivo de entrada
           03 N-REG-LEIDOS              PIC 9(8) VALUE ZERO.                                      03 N-REG-LEIDOS              PIC 9(8) VALUE ZERO.
      *    Registros procesados sin error                                                    *    Registros procesados sin error
           03 N-REG-OK                  PIC 9(8) VALUE ZERO.                        |             03 N-REG-PROCESADOS          PIC 9(8) VALUE ZERO.
      *    Registros con error                                                               *    Registros con error
           03 N-REG-CON-ERROR           PIC 9(8) VALUE ZERO.                                      03 N-REG-CON-ERROR           PIC 9(8) VALUE ZERO.

      *    Cantidades de registros por tipo de novedad                                       *    Cantidades de registros por tipo de novedad
           03 N-REG-TIPO-I-OK           PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-I-OK           PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-M-OK           PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-M-OK           PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-E-OK           PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-E-OK           PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-I-ERR          PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-I-ERR          PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-M-ERR          PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-M-ERR          PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-E-ERR          PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-E-ERR          PIC 9(8) VALUE ZERO.

      *    Alertas borradas previo al refresque total                                        *    Alertas borradas previo al refresque total
           03 N-ALE-LEIDAS              PIC 9(8) VALUE ZERO.                        <  
           03 N-ALE-BORRADAS            PIC 9(8) VALUE ZERO.                                      03 N-ALE-BORRADAS            PIC 9(8) VALUE ZERO.
      *    Alertas insertadas                                                                *    Alertas insertadas
           03 N-ALE-INSERTADAS          PIC 9(8) VALUE ZERO.                                      03 N-ALE-INSERTADAS          PIC 9(8) VALUE ZERO.
      *    Alertas modificadas                                                               *    Alertas modificadas
           03 N-ALE-MODIFICADAS         PIC 9(8) VALUE ZERO.                                      03 N-ALE-MODIFICADAS         PIC 9(8) VALUE ZERO.
      *    Alertas eliminadas                                                                *    Alertas eliminadas
           03 N-ALE-ELIMINADAS          PIC 9(8) VALUE ZERO.                                      03 N-ALE-ELIMINADAS          PIC 9(8) VALUE ZERO.
      *    Insercion de alerta existente                                                     *    Insercion de alerta existente
           03 N-ALE-YA-EXISTE           PIC 9(8) VALUE ZERO.                                      03 N-ALE-YA-EXISTE           PIC 9(8) VALUE ZERO.
      *    Modificacion o eliminacion de alerta inexistente                                  *    Modificacion o eliminacion de alerta inexistente
           03 N-ALE-NO-EXISTE           PIC 9(8) VALUE ZERO.                                      03 N-ALE-NO-EXISTE           PIC 9(8) VALUE ZERO.

      *    Sumas de cantidades de demandas y embargos                                        *    Sumas de cantidades de demandas y embargos
           03 N-DEMANDAS-VIGENTES       PIC 9(7) VALUE ZERO.                                      03 N-DEMANDAS-VIGENTES       PIC 9(7) VALUE ZERO.
           03 N-DEMANDAS-TERMINADAS     PIC 9(7) VALUE ZERO.                                      03 N-DEMANDAS-TERMINADAS     PIC 9(7) VALUE ZERO.
           03 N-EMBARGOS-VIGENTES       PIC 9(7) VALUE ZERO.                                      03 N-EMBARGOS-VIGENTES       PIC 9(7) VALUE ZERO.
           03 N-EMBARGOS-TERMINADOS     PIC 9(7) VALUE ZERO.                                      03 N-EMBARGOS-TERMINADOS     PIC 9(7) VALUE ZERO.

      ******************************************************************                     ******************************************************************
      * Armado de las lineas de alerta                                              <  
       01 LA-LINEAS-ALERTA.                                                         <  
      *    Los modelos a continuacion deberan obtenerse de un                       <  
      *    archivo, como BDIIALE-ALERTAS                                            <  
           03 LAEND                     PIC 999 COMP VALUE 0.                       <  
           03 LA-MODELOS.                                                           <  
      *         12345678901234567890123456789012345678901234567890                  <  
               05 PIC X(50) VALUE                                                   <  
               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".                <  
               05 PIC X(50) VALUE                                                   <  
               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".                 <  
               05 PIC X(50) VALUE                                                   <  
               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".                <  
               05 PIC X(50) VALUE                                                   <  
               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".                <  
               05 PIC X(50) VALUE HIGH-VALUES. *> END MARKER                        <  
           03 LA-MODELOS2               REDEFINES LA-MODELOS.                       <  
               05 LA-MODELO             PIC X(50) OCCURS 5                          <  
                                        INDEXED LAM.                                <  
      *    Funcionamiento de los templates.                                         <  
      *    Hay dos templates por de alerta, uno por linea.                          <  
      *    Cada template consiste en hasta 10 frases fijas con                      <  
      *    ampersands (&) donde se van a reemplazar los valores.                    <  
      *    Por ejemplo:                                                             <  
      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS                               <  
      *    tiene 3 frases fijas y 2 reemplazos.                                     <  
      *    La cantidad de ampersands es irrelevante, pero parece                    <  
      *    conveniente que informe sobre el tamaño del contenido.                   <  
           03 LA-TEMPLATES.                                                         <  
               05 LA-TEMPLATE           OCCURS 4 INDEXED LAX.                       <  
                   07 LA-PARTE          PIC X(50)                                   <  
                                        OCCURS 10 INDEXED LAY.                      <  
      *    Las dos lineas armadas                                                   <  
           03 LA-LINEAS.                                                            <  
               05 LA-LINEA1             PIC X(50).                                  <  
               05 LA-LINEA2             PIC X(50).                                  <  
      *    Los valores a insertar en una linea                                      <  
           03 LA-VALORES.                                                           <  
               05 LA-VALOR              PIC X(50)                                   <  
                                        OCCURS 10 INDEXED LAV.                      <  
      *    Datos para editar valores a insertar                                     <  
           03 LA-NUM                    PIC -(11)0.                                 <  
           03 LA-NUMX                   REDEFINES LA-NUM                            <  
                                        PIC X(12).                                  <  
           03 LA-DESCARTE               PIC X(50).                                  <  
                                                                                    <  
                                                                                    <  
      ******************************************************************            <  
      * Errores de consistencia del input                                                    * Errores de consistencia del input
      * Cada error tiene un codigo de 2 digitos, un espacio, contador               |        * Cada error tiene 70 caracteres:
      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59                |        *     codigo de 2 digitos,
                                                                                    >        *     indicador de impactar BDIIALE aunque haya este error "+"
                                                                                    >        *     un espacio en blanco
                                                                                    >        *     contador de ocurrencias de 7 digitos
                                                                                    >        *     un espacio en blanco, y 
                                                                                    >        *     descripcion de 59 caractares
       01 E-ERRORES.                                                                          01 E-ERRORES.
      *    indica si el registro actual tiene error                                          *    indica si el registro actual tiene error
           03 E-HAY-ERROR               PIC XX VALUE "NO".                                        03 E-HAY-ERROR               PIC XX VALUE "NO".
                                                                                    >        *    indica si el registro actual impacta la base de datos
                                                                                    >             03 E-IMPACTAR-BDIIALE        PIC XX VALUE "SI".
      *    errores del registro actual                                                       *    errores del registro actual
           03 E-ERRORES-REG             PIC X(300) VALUE SPACES.                                  03 E-ERRORES-REG             PIC X(300) VALUE SPACES.
      *    contador de registros con error                                                   *    contador de registros con error
           03 E-CONT-REGS-CON-ERROR     PIC 9(8) VALUE ZERO.                                      03 E-CONT-REGS-CON-ERROR     PIC 9(8) VALUE ZERO.
      *    tabla de errores                                                                  *    tabla de errores
           03 PIC X(11) VALUE "01 0000000 ".                                                      03 PIC X(11) VALUE "01 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Tipo de movimiento invalido, debe ser I M E T".                                       "Tipo de movimiento invalido, debe ser I M E T".
                                                                                    >  
           03 PIC X(11) VALUE "02 0000000 ".                                                      03 PIC X(11) VALUE "02 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Tipo de identificacion invalido, debe ser 1 2 3 4".                                   "Tipo de identificacion invalido, debe ser 1 2 3 4".
                                                                                    >  
           03 PIC X(11) VALUE "03 0000000 ".                                                      03 PIC X(11) VALUE "03 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de identificacion invalido, debe ser numerico".                                "Numero de identificacion invalido, debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "04 0000000 ".                                                      03 PIC X(11) VALUE "04 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Tipo de identificacion debe ser mayor que cero".                                      "Tipo de identificacion debe ser mayor que cero".
                                                                                    >  
           03 PIC X(11) VALUE "05 0000000 ".                                                      03 PIC X(11) VALUE "05 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Falta el nombre o denominacion".                                                      "Falta el nombre o denominacion".
                                                                                    >  
           03 PIC X(11) VALUE "06 0000000 ".                                                      03 PIC X(11) VALUE "06 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de demandas vigentes: debe ser numerico".                                      "Numero de demandas vigentes: debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "07 0000000 ".                                                      03 PIC X(11) VALUE "07 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de demandas terminadas: debe ser numerico".                                    "Numero de demandas terminadas: debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "08 0000000 ".                                                      03 PIC X(11) VALUE "08 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".                            "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
                                                                                    >  
           03 PIC X(11) VALUE "09 0000000 ".                                                      03 PIC X(11) VALUE "09 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".                               "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
                                                                                    >  
           03 PIC X(11) VALUE "10 0000000 ".                                                      03 PIC X(11) VALUE "10 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de embargos vigentes: debe ser numerico".                                      "Numero de embargos vigentes: debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "11 0000000 ".                                                      03 PIC X(11) VALUE "11 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de embargos terminados: debe ser numerico".                                    "Numero de embargos terminados: debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "12 0000000 ".                                                      03 PIC X(11) VALUE "12 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".                            "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
                                                                                    >  
           03 PIC X(11) VALUE "13 0000000 ".                                                      03 PIC X(11) VALUE "13 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".                               "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
           03 PIC X(11) VALUE "14 0000000 ".                                        |  
                                                                                    >             03 PIC X(11) VALUE "14+0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "El numero de id no se encuentra en el archivo maestro".                 |             "El id no se encuentra en el archivo maestro (tipo 7)".
                                                                                    >  
           03 PIC X(11) VALUE "15 0000000 ".                                                      03 PIC X(11) VALUE "15 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "El nombre en el input no coincide con el registrado".                                 "El nombre en el input no coincide con el registrado".
                                                                                    >  
           03 PIC X(11) VALUE "16 0000000 ".                                                      03 PIC X(11) VALUE "16 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de id fuera del rango del tipo de id informado".                               "Numero de id fuera del rango del tipo de id informado".
                                                                                    >  
           03 PIC X(11) VALUE "17 0000000 ".                                                      03 PIC X(11) VALUE "17 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Modificación de alerta que no existe".                                                "Modificación de alerta que no existe".
                                                                                    >  
           03 PIC X(11) VALUE "18 0000000 ".                                                      03 PIC X(11) VALUE "18 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Eliminación de alerta que no existe".                                                 "Eliminación de alerta que no existe".
                                                                                    >  
           03 PIC X(11) VALUE "19 0000000 ".                                                      03 PIC X(11) VALUE "19 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Inserción de alerta que ya existe".                                                   "Inserción de alerta que ya existe".
           03 PIC X(11) VALUE "20 0000000 ".                                        <  
           03 PIC X(59) VALUE                                                       <  
           "Tipo de Identificacion 7".                                              <  
      *----------------- insertar nuevos items aqui -------------------                      *----------------- insertar nuevos items aqui -------------------
           03 PIC X(11) VALUE "00 0000000 ".                                                      03 PIC X(11) VALUE "00 0000000 ".
           03 PIC X(59) VALUE "--- FIN DE LA LISTA (COD 00) ---".                                 03 PIC X(59) VALUE "--- FIN DE LA LISTA (COD 00) ---".
           03                           PIC X(3500). *> LOS 50 ITEMS                              03                           PIC X(3500). *> LOS 50 ITEMS
       01 E-ERRORES-2                   REDEFINES E-ERRORES.                                  01 E-ERRORES-2                   REDEFINES E-ERRORES.
           03                           PIC XX.                                                   03                           PIC XX.
                                                                                    >             03                           PIC XX.
           03                           PIC X(300).                                               03                           PIC X(300).
           03                           PIC 9(8).                                                 03                           PIC 9(8).
           03 E-ERROR                   OCCURS 50 INDEXED EX.                                     03 E-ERROR                   OCCURS 50 INDEXED EX.
               05 E-CODIGO              PIC XX.                                                       05 E-CODIGO              PIC XX.
               05                       PIC X.                                      |                 05 E-IMPACTAR            PIC X.
               05 E-CONTADOR            PIC 9(7).                                                     05 E-CONTADOR            PIC 9(7).
               05                       PIC X.                                                        05                       PIC X.
               05 E-DESCRIPCION         PIC X(59).                                                    05 E-DESCRIPCION         PIC X(59).
       01 E-EDIT                        PIC Z(8)B.                                            01 E-EDIT                        PIC Z(8)B.

      ******************************************************************                     ******************************************************************
      * Control de rangos de valores de las fechas del input                                 * Control de rangos de valores de las fechas del input
       01 VALIDACIONES-FECHAS.                                                                01 VALIDACIONES-FECHAS.
           02 ANO-VAL-X                 pic 9(04).                                  |             02 ANO-VAL-X                 pic 9(4).
              88 ANO-VAL                value 1900 thru 2050.                                        88 ANO-VAL                value 1900 thru 2050.
           02 MES-VAL-X                 pic 9(02).                                  |             02 MES-VAL-X                 pic 9(2).
              88 MES-VAL                value 01   thru 12.                                          88 MES-VAL                value 01 thru 12.
           02 DIA-VAL-X                 pic 9(02).                                  |             02 DIA-VAL-X                 pic 9(2).
              88 DIA-VAL                value 01   thru 31.                                          88 DIA-VAL                value 01 thru 31.


      /*****************************************************************                     /*****************************************************************
      ******************************************************************                     ******************************************************************
       PROCEDURE DIVISION.                                                                    PROCEDURE DIVISION.


       0000-PROGRAMA-PRINCIPAL.                                                               0000-PROGRAMA-PRINCIPAL.
      ******************************************************************                     ******************************************************************
      *    inicializa el ambiente y abre los archivos                                        *    inicializa el ambiente y abre los archivos
           PERFORM 1000-RUTINA-INICIAL                                                            PERFORM 1000-RUTINA-INICIAL
      *    procesa cada uno de los registros del archivo JURAD hasta                         *    procesa cada uno de los registros del archivo JURAD hasta
      *    encontrar el registro "T" de totales                                              *    encontrar el registro "T" de totales
           PERFORM 4000-PROCESAR-REGISTRO UNTIL IND-FIN-PROCESO = "SI"                            PERFORM 4000-PROCESAR-REGISTRO UNTIL IND-FIN-PROCESO = "SI"
      *    cierra archivos y produce el reporte final                                        *    cierra archivos y produce el reporte final
           PERFORM 7000-RUTINA-FINAL                                                              PERFORM 7000-RUTINA-FINAL
           GOBACK.                                                                                GOBACK.

       4000-PROCESAR-REGISTRO.                                                                4000-PROCESAR-REGISTRO.
      ****************************************************************                       ****************************************************************
      * Proceso de un registro del archivo de entrada JURAD                                  * Proceso de un registro del archivo de entrada JURAD
      * Lectura y control del file status del archivo                                        * Lectura y control del file status del archivo
      ****************************************************************                       ****************************************************************
      *    lectura del proximo registro                                                      *    lectura del proximo registro
           READ JURAD                                                                             READ JURAD
           EVALUATE JURAD-FS                                                                      EVALUATE JURAD-FS
           WHEN "00"                                                                              WHEN "00"
      *        CONTROLA EL REG Y LO APLICA SI ES OK                                          *        CONTROLA EL REG Y LO APLICA SI ES OK
                                                                                    >        D        display JURAD-REG
               PERFORM 4000-PROCESAR-REGISTRO-2                                                       PERFORM 4000-PROCESAR-REGISTRO-2
               MOVE JURAD-REG TO JURAD-REG-ANTERIOR                                                   MOVE JURAD-REG TO JURAD-REG-ANTERIOR
               IF JURAD-TIPO-NOVEDAD <> "T"                                                           IF JURAD-TIPO-NOVEDAD <> "T"
                  ADD 1 TO REG-LEIDOS                                                                    ADD 1 TO REG-LEIDOS
               END-IF                                                                                 END-IF
                                                                                    >        D        PERFORM DISPLAY-CONTADORES
           WHEN "10"                                                                              WHEN "10"
      *        FIN DEL ARCHIVO DE INPUT:                                            |        *        Fin del archivo de input:
      *        ESTO ES UN ERROR, NO SE ENCONTRO EL REGISTRO "T" ANTES               |        *        Esto es un error, no se encontro el registro "T" antes
      *        DE QUE SE TERMINARA EL ARCHIVO                                       |        *        de que se terminara el archivo
               DISPLAY "FALTA EL REG DE TOTALES DEL ARCHIVO JURAD "                                   DISPLAY "FALTA EL REG DE TOTALES DEL ARCHIVO JURAD "
               DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME                                             DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME
               DISPLAY "FILE STATUS: " JURAD-FS                                                       DISPLAY "FILE STATUS: " JURAD-FS
               DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS                                         DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS
               DISPLAY JURAD-REG-ANTERIOR                                                             DISPLAY JURAD-REG-ANTERIOR
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           WHEN OTHER                                                                             WHEN OTHER
      *        ERROR DE LECTURA: CANCELACION DEL PROCESO                            |        *        Error de lectura: cancelacion del proceso
               DISPLAY "ERROR EN LECTURA DEL ARCHIVO JURAD "                                          DISPLAY "ERROR EN LECTURA DEL ARCHIVO JURAD "
               DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME                                             DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME
               DISPLAY "FILE STATUS: " JURAD-FS                                                       DISPLAY "FILE STATUS: " JURAD-FS
               DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS                                         DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS
               DISPLAY JURAD-REG-ANTERIOR                                                             DISPLAY JURAD-REG-ANTERIOR
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.


       4000-PROCESAR-REGISTRO-2.                                                              4000-PROCESAR-REGISTRO-2.
      ****************************************************************                       ****************************************************************
      * Controla los datos de un registro de JURAD y si es OK lo usa                         * Controla los datos de un registro de JURAD y si es OK lo usa
      * para actualizar el archivo de alertas en linea                                       * para actualizar el archivo de alertas en linea
      * La informacion esta leida en JURAD-reg                                               * La informacion esta leida en JURAD-reg
                                                                                    >        * Hay dos indicadores: E-HAY-ERROR es si se encontró algún error
                                                                                    >        * en el registro, mientras que E-IMPACTAR-BDIIALE significa si
                                                                                    >        * los alertas se graban, independientemente de los errores 
                                                                                    >        * detectados (algunos errores no impiden la grabación)
      ****************************************************************                       ****************************************************************
           MOVE "NO" TO E-HAY-ERROR                                                               MOVE "NO" TO E-HAY-ERROR
                                                                                    >             MOVE "SI" TO E-IMPACTAR-BDIIALE
                                                                                    >             MOVE 00 TO CODIGO-ERROR

      *    VALIDACION DEL TIPO DE MOVIMIENTO                                        |        *    Validacion del tipo de movimiento
           IF JURAD-TIPO-NOVEDAD NOT = "I" AND "M" AND "E" AND "T"                                IF JURAD-TIPO-NOVEDAD NOT = "I" AND "M" AND "E" AND "T"
               CALL "PONERR" USING "01" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "01" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF

      *    SI ES EL REGISTRO "T" HAY QUE SEÑALAR EL FIN DE PROCESO                  |        *    Si es el registro "T" hay que señalar el fin de proceso
           IF JURAD-TIPO-NOVEDAD = "T"                                                            IF JURAD-TIPO-NOVEDAD = "T"
               MOVE "SI" TO IND-FIN-PROCESO                                                           MOVE "SI" TO IND-FIN-PROCESO
               PERFORM 4800-PROCESO-REG-T                                                             PERFORM 4800-PROCESO-REG-T
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF

           ADD 1 TO N-REG-LEIDOS                                                                  ADD 1 TO N-REG-LEIDOS

      *    VALIDACION FORMAL DE LOS DATOS                                           |        *    Validación formal: que los datos sean numéricos, etc ...
           MOVE 0 TO CODIGO-ERROR                                                   <  
      *                                                                             <  
           PERFORM 4200-VALIDACION-SEMANTICA                                        <  
      *                                                                             <  
           PERFORM 4240-CONTAR-TIPO-CUENTA                                          <  
      *                                                                             <  
           PERFORM 4100-VALIDACION-FORMAL                                                         PERFORM 4100-VALIDACION-FORMAL
      *                                                                             <  
           IF E-HAY-ERROR = "SI"                                                                  IF E-HAY-ERROR = "SI"
                                                                                    >                 ADD 1 TO REG-MAL-FORMADOS
               PERFORM 4900-GRABAR-ERROR                                                              PERFORM 4900-GRABAR-ERROR
           ELSE                                                                     |                 EXIT PARAGRAPH
                                                                                    >             END-IF
                                                                                    >  
                                                                                    >        *    Validación del contenido
                                                                                    >             PERFORM 4200-VALIDACION-SEMANTICA
                                                                                    >             PERFORM 4240-CONTAR-TIPO-CUENTA
                                                                                    >  
                                                                                    >             IF E-IMPACTAR-BDIIALE = "SI"
               PERFORM 4300-MODIFICAR-BDIIALE                                                         PERFORM 4300-MODIFICAR-BDIIALE
               ADD 1 TO N-REG-OK                                                    |                 ADD 1 TO N-REG-PROCESADOS
                                                                                    >             END-IF
                                                                                    >  
                                                                                    >             IF E-HAY-ERROR = "SI"
                                                                                    >                 PERFORM 4900-GRABAR-ERROR
           END-IF.                                                                                END-IF.


       4100-VALIDACION-FORMAL.                                                                4100-VALIDACION-FORMAL.
      ******************************************************************                     ******************************************************************
      * VALIDACION FORMAL DE LOS DATOS DEL INPUT                                             * VALIDACION FORMAL DE LOS DATOS DEL INPUT
      ******************************************************************                     ******************************************************************
      *    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}                               |        *    TIPO DE IDENTIFICACION NUMERICA
           IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"                       |             IF JURAD-ID-TIPO NOT NUMERIC
               CALL "PONERR" USING "02" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "02" JURAD-REG E-ERRORES
            END-IF                                                                                 END-IF
      *    NUMERO DE IDENTIFICACION                                                          *    NUMERO DE IDENTIFICACION
           IF JURAD-ID-NUMEROX IS NOT NUMERIC                                                     IF JURAD-ID-NUMEROX IS NOT NUMERIC
               CALL "PONERR" USING "03" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "03" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
           IF JURAD-ID-NUMERO NOT > 0                                                             IF JURAD-ID-NUMERO NOT > 0
               CALL "PONERR" USING "04" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "04" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES                       *    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES
      *    NO SE CONTROLAN                                                                   *    NO SE CONTROLAN
           IF JURAD-TIPO-NOVEDAD = "E"                                                            IF JURAD-TIPO-NOVEDAD = "E"
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF
      *    NOMBRES Y APELLIDOS                                                               *    NOMBRES Y APELLIDOS
           IF JURAD-NOMBRE = SPACES                                                               IF JURAD-NOMBRE = SPACES
               CALL "PONERR" USING "05" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "05" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    NUMERO DE DEMANDAS VIGENTES                                                       *    NUMERO DE DEMANDAS VIGENTES
           IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC                                              IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC
               CALL "PONERR" USING "06" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "06" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    NUMERO DE DEMANDAS TERMINADAS                                                     *    NUMERO DE DEMANDAS TERMINADAS
           IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC                                            IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC
               CALL "PONERR" USING "07" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "07" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    FECHA ULTIMA DEMANDA VIGENTE YYMMDD                                               *    FECHA ULTIMA DEMANDA VIGENTE YYMMDD
           IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC                                          IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC
               CALL "PONERR" USING "08" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "08" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
           MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS                                MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS
           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL                                           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL
               CALL "PONERR" USING "09" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "09" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    NUMERO DE EMBARGOS VIGENTES                                                       *    NUMERO DE EMBARGOS VIGENTES
           IF JURAD-EMBARGOS-VIGENTES NOT NUMERIC                                                 IF JURAD-EMBARGOS-VIGENTES NOT NUMERIC
               CALL "PONERR" USING "10" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "10" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    NUMERO DE EMBARGOS TERMINADOS                                                     *    NUMERO DE EMBARGOS TERMINADOS
           IF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC                                               IF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC
               CALL "PONERR" USING "11" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "11" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    FECHA ULTIMO EMBARGO VIGENTE YYMMDD                                               *    FECHA ULTIMO EMBARGO VIGENTE YYMMDD
           IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC                                          IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC
               CALL "PONERR" USING "12" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "12" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
           MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS                                MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS
           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL                                           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL
               CALL "PONERR" USING "13" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "13" JURAD-REG E-ERRORES
           END-IF.                                                                                END-IF.


       4200-VALIDACION-SEMANTICA.                                                             4200-VALIDACION-SEMANTICA.
      ****************************************************************                       ****************************************************************
      * VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON                |        * Validacion del tipo y numero de identificacion y de su relacion
      * EL NOMBRE                                                                   |        * con el nombre
      ****************************************************************                       ****************************************************************
         IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"                                     IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"
              MOVE 05 TO CODIGO-ERROR                                                             MOVE 05 TO CODIGO-ERROR
              ADD  1  TO TIPO-ID-INVALIDO                                                         ADD 1 TO TIPO-ID-INVALIDO
                                                                                    >             CALL "PONERR" USING "02" JURAD-REG E-ERRORES
         ELSE                                                                                   ELSE
      *    PARÁMETROS PARA LAS RUTINAS DE VALIDACIÓN EN BDIIVIDE                    |        *    Parámetros para las rutinas de validación en BDIIVIDE
           MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE                                                 MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE
           MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE                                 |             MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE NUM-ID-W
                                   NUM-ID-W                                         <  
           MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE                                                   MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE
      *    SWITCHES DE OPCIONES DE VALIDACIÓN                                       |        *    Switches de opciones de validación
           MOVE 1 TO  SW-VERIFNOM-BDIIVIDE                                          |             MOVE 1 TO SW-VERIFNOM-BDIIVIDE SW-DIGCHEQUEO-BDIIVIDE
                      SW-DIGCHEQUEO-BDIIVIDE                                        <  
           MOVE 2 TO NUM-BLOQUES-BDIIVIDE                                                         MOVE 2 TO NUM-BLOQUES-BDIIVIDE
      *    VALIDA EL NÚMERO DE IDENTIFICACIÓN CONTRA LAS BASES DE                   |        *    Valida el número de identificación contra las bases de
      *    DATOS BDIIDIAN, BDIIDAS, BDIIREGI Y VERIFICA LA COINCIDENCIA             |        *    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
      *    DEL NOMBRE REPORTADO                                                     |        *    del nombre reportado
      *    RETORNA SW-ID-BDIIVIDE=1 SI HAY ERROR                                    |        *    retorna SW-ID-BDIIVIDE=1 si hay error
           PERFORM 80100-VALIDAR-IDENTIFICACION                                                   PERFORM 80100-VALIDAR-IDENTIFICACION
           MOVE  TIP-IDE-BDIIVIDE TO TIPOID-E                                                     MOVE  TIP-IDE-BDIIVIDE TO TIPOID-E
           MOVE  NUM-IDE-BDIIVIDE TO NUMID-E                                                      MOVE  NUM-IDE-BDIIVIDE TO NUMID-E
      *    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE                        <  
           IF SW-ID-BDIIVIDE = 1                                                                  IF SW-ID-BDIIVIDE = 1
      *        ES UN ID QUE NO EXISTE EN BDIIREGI, BDIIDAS o BDIIDIAN               |        *      es un id que no existe en BDIIREGI, BDIIDAS o BDIIDIAN
               CALL "PONERR" USING "14" JURAD-REG E-ERRORES                                         CALL "PONERR" USING "14" JURAD-REG E-ERRORES
      *        VALIDA CONTRA LA BASE ALTERNA                                        |        *      valida contra la base alterna
               PERFORM 4210-VALIDACION-ID-NO-FIGURA                                                 PERFORM 4210-VALIDACION-ID-NO-FIGURA
           ELSE                                                                                   ELSE
             IF SW-ID-BDIIVIDE = 1                                                                  IF SW-ID-BDIIVIDE = 1
                 IF TIPOID-E <> 1                                                                       IF TIPOID-E <> 1
                   MOVE  ZEROS         TO  HACER-MATCH                                                    MOVE ZEROS TO HACER-MATCH
                   MOVE 0 TO IDE-TIPO-BDAMATCH                                                            MOVE 0 TO IDE-TIPO-BDAMATCH
                   PERFORM  513-VALIDA-EN-CSV                                                             PERFORM 513-VALIDA-EN-CSV
                   IF  IDE-TIPO-BDAMATCH  =  0                                                            IF  IDE-TIPO-BDAMATCH  =  0
                     MOVE 03           TO  CODIGO-ERROR                                                     MOVE 03 TO CODIGO-ERROR
                     ADD   1           TO  NO-EXISTE-DIAN                                                   ADD 1 TO NO-EXISTE-DIAN
                   END-IF                                                                                 END-IF
                 ELSE                                                                                   ELSE
                    MOVE  ZEROS TO  HACER-MATCH                                                            MOVE ZEROS TO HACER-MATCH
                    MOVE 0 TO IDE-TIPO-BDAMATCH                                                            MOVE 0 TO IDE-TIPO-BDAMATCH
                    PERFORM 513-VALIDA-EN-CSV                                                              PERFORM 513-VALIDA-EN-CSV
                    IF IDE-TIPO-BDAMATCH = 0                                                               IF IDE-TIPO-BDAMATCH = 0
                       MOVE 04 TO CODIGO-ERROR                                                                MOVE 04 TO CODIGO-ERROR
                       ADD  1  TO NO-EXISTE-REGIS                                                             ADD 1 TO NO-EXISTE-REGIS
                    END-IF                                                                                 END-IF
                 END-IF                                                                                 END-IF
              ELSE                                                                                   ELSE
                 IF SW-NOMBRES-BDIIVIDE = 1                                                             IF SW-NOMBRES-BDIIVIDE = 1
                                                                                    >                      CALL "PONERR" USING "15" JURAD-REG E-ERRORES
                    IF TIPOID-E <> 1                                                                       IF TIPOID-E <> 1
                       MOVE 01 TO CODIGO-ERROR                                                                MOVE 01 TO CODIGO-ERROR
                       ADD 1 TO NO-COINCIDE-DIAN                                                              ADD 1 TO NO-COINCIDE-DIAN
                    ELSE                                                                                   ELSE
                       MOVE   02 TO CODIGO-ERROR                                                              MOVE 02 TO CODIGO-ERROR
                       ADD 1 TO NO-COINCIDE-REGIS                                                             ADD 1 TO NO-COINCIDE-REGIS
                    END-IF                                                                                 END-IF
                 ELSE                                                                                   ELSE
                    INITIALIZE LLAVE-BDIIALE                                                               INITIALIZE LLAVE-BDIIALE
                    MOVE  TIPOID-E TO TIP-IDE-BDIIALE                                                      MOVE TIPOID-E TO TIP-IDE-BDIIALE
                    MOVE  NUMID-E  TO NUM-IDE-BDIIALE                                                      MOVE NUMID-E TO NUM-IDE-BDIIALE
                    MOVE  990003   TO FUENTE-BDIIALE                                                       MOVE 990003 TO FUENTE-BDIIALE
                    START BDIIALE KEY NOT < LLAVE-BDIIALE                           |                      START BDIIALE KEY NOT < LLAVE-BDIIALE INVALID KEY
                          INVALID KEY MOVE 1 TO SW-BDIIALE                          |                          MOVE 1 TO SW-BDIIALE
                      NOT INVALID KEY MOVE 0 TO SW-BDIIALE                          |                      NOT INVALID KEY
                          READ BDIIALE NEXT RECORD                                  |                          MOVE 0 TO SW-BDIIALE
                               AT END MOVE 1 TO SW-BDIIALE                          |                          READ BDIIALE NEXT RECORD AT END
                                                                                    >                              MOVE 1 TO SW-BDIIALE
                          END-READ                                                                             END-READ
                                                                                    >                      END-START
                    MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-R                                             MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-R
                    PERFORM UNTIL SW-BDIIALE = 1 OR                                                        PERFORM UNTIL SW-BDIIALE = 1 OR
                            TIPOID-E <> TIP-IDE-BDIIALE OR                                                 TIPOID-E <> TIP-IDE-BDIIALE OR
                            NUMID-E <> NUM-IDE-BDIIALE                                                     NUMID-E <> NUM-IDE-BDIIALE
                            IF FUENTE-BDIIALE = 990003 AND                                                     IF FUENTE-BDIIALE = 990003 AND
                               FEC-NOV-BDIIALE <= FECHA-PROC-R AND                                                FEC-NOV-BDIIALE <= FECHA-PROC-R AND
                               FEC-VEN-BDIIALE >= FECHA-PROC-R AND                                                FEC-VEN-BDIIALE >= FECHA-PROC-R AND
                               BLOQUEO-BDIIALE = 0                                                                BLOQUEO-BDIIALE = 0
                               MOVE 1 TO SW-BDIIALE                                                               MOVE 1 TO SW-BDIIALE
                            END-IF                                                                             END-IF
                            IF SW-BDIIALE = 0                                                                  IF SW-BDIIALE = 0
                               READ BDIIALE NEXT RECORD                             |                              READ BDIIALE NEXT RECORD AT END
                                    AT END MOVE 1 TO SW-BDIIALE                     |                                  MOVE 1 TO SW-BDIIALE
                               END-READ                                                                            END-READ
                            END-IF                                                                             END-IF
                    END-PERFORM                                                                            END-PERFORM
                    IF TIPOID-E = 1                                                                        IF TIPOID-E = 1
                       IF ESTADO-VIG-BDIIREGI = 12                                                             IF ESTADO-VIG-BDIIREGI = 12
                          MOVE  07   TO  CODIGO-ERROR                                                              MOVE 07 TO CODIGO-ERROR
                        ELSE                                                                                   ELSE
                           IF ESTADO-VIG-BDIIREGI = 21                                                             IF ESTADO-VIG-BDIIREGI = 21
                              MOVE  06  TO CODIGO-ERROR                                                                MOVE 06 TO CODIGO-ERROR
                                                                                    >                                  CALL "PONERR" USING "15" JURAD-REG
                                                                                    >                                  E-ERRORES
                              ADD   1   TO NO-COINCIDE-REGIS                                                           ADD 1 TO NO-COINCIDE-REGIS
                              ADD   1   TO CONT-FALLECIDOS                                                             ADD 1 TO CONT-FALLECIDOS
                           END-IF                                                                                  END-IF
                        END-IF                                                                                 END-IF
                    END-IF                                                                                 END-IF
                 END-IF                                                                                 END-IF
              END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

                                                                                    >  
       4240-CONTAR-TIPO-CUENTA.                                                               4240-CONTAR-TIPO-CUENTA.
      ******************************************************************                     ******************************************************************
      *    Conteo de los registros por "tipo", dependiendo del código                        *    Conteo de los registros por "tipo", dependiendo del código
      *    de error:                                                                         *    de error:
      *    00=OK                                                                             *    00=OK
      *    01=NIT OK, nombre no coincide                                                     *    01=NIT OK, nombre no coincide
      *    02=cédula OK, nombre no coincide                                                  *    02=cédula OK, nombre no coincide
      *    03=NIT no figura                                                                  *    03=NIT no figura
      *    04=cédula no figura pero está en base alterna                                     *    04=cédula no figura pero está en base alterna
      *    05=tipo id no es 1|2|3|4                                                          *    05=tipo id no es 1|2|3|4
      *    cuenta tipo 5: sin error                                                          *    cuenta tipo 5: sin error
      *    cuenta tipo 6: 01 02 06 07                                                        *    cuenta tipo 6: 01 02 06 07
      *    cuenta tipo 7: 03 04 05                                                           *    cuenta tipo 7: 03 04 05
      ******************************************************************                     ******************************************************************
           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07                                                 IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07
               ADD 1 TO W-CONT-TIPO-6                                                                 ADD 1 TO W-CONT-TIPO-6
           ELSE                                                                                   ELSE
               IF CODIGO-ERROR = 03 OR 04 OR 05                                                       IF CODIGO-ERROR = 03 OR 04 OR 05
                   ADD 1 TO W-CONT-TIPO-7                                                                 ADD 1 TO W-CONT-TIPO-7
                   CALL "PONERR" USING "20" JURAD-REG E-ERRORES                     <  
      *            INSERTA CUENTA SIN VALIDAR EN BDIIALE                            <  
                   PERFORM 4300-MODIFICAR-BDIIALE                                   <  
               ELSE                                                                                   ELSE
      *            ES 00: REGISTROS CORRECTOS                                       |        *            es 00: registros correctos
                   ADD 1 TO W-CONT-TIPO-5                                                                 ADD 1 TO W-CONT-TIPO-5
                   ADD  1  TO REG-CORRECTOS                                                               ADD 1 TO REG-CORRECTOS
      *            SI ES UNA EMPRESA                                                |        *            si es un NIT
                   IF TIPOID-E = 2 OR 3                                                                   IF TIPOID-E = 2 OR 3
                       ADD 1 TO W-CONT-TIPO-5-PJ                                                              ADD 1 TO W-CONT-TIPO-5-PJ
                   END-IF                                                                                 END-IF
               END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

                                                                                    >  
       4210-VALIDACION-ID-NO-FIGURA.                                                          4210-VALIDACION-ID-NO-FIGURA.
      ******************************************************************                     ******************************************************************
      * Validación de IDs que no figuran en las bases normales                               * Validación de IDs que no figuran en las bases normales
      ******************************************************************                     ******************************************************************
           MOVE 0 TO HACER-MATCH                                                                  MOVE 0 TO HACER-MATCH
           MOVE 0 TO IDE-TIPO-BDAMATCH                                                            MOVE 0 TO IDE-TIPO-BDAMATCH
      *    VALIDA SI LA IDENTIFICACIÓN ESTÁ EN LA BASE DE DATOS ALTERNA             |        *    Valida si la identificación está en la base de datos alterna
           PERFORM 513-VALIDA-EN-CSV                                                              PERFORM 513-VALIDA-EN-CSV
           IF IDE-TIPO-BDAMATCH = 0                                                               IF IDE-TIPO-BDAMATCH = 0
               IF TIP-IDE-BDIIVIDE = 1                                                                IF TIP-IDE-BDIIVIDE = 1
      *            ES UNA CÉDULA                                                    |        *            Es una cédula
                   MOVE 04 TO CODIGO-ERROR                                                                MOVE 04 TO CODIGO-ERROR
                   ADD  1  TO NO-EXISTE-REGIS                                                             ADD 1 TO NO-EXISTE-REGIS
               ELSE                                                                                   ELSE
      *            NO ES UNA CÉDULA                                                 |        *            No es una cédula
                   MOVE 03 TO CODIGO-ERROR                                                                MOVE 03 TO CODIGO-ERROR
                   ADD   1 TO  NO-EXISTE-DIAN                                                             ADD 1 TO NO-EXISTE-DIAN
               END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

                                                                                    >  
                                                                                    >        DDISPLAY-CONTADORES.
                                                                                    >        ******************************************************************
                                                                                    >        * Código para controlar la evolución de los contadores
                                                                                    >        ******************************************************************
                                                                                    >             DISPLAY "REG-MAL-FORMADOS :" REG-MAL-FORMADOS
                                                                                    >             DISPLAY "REG-LEIDOS       :" REG-LEIDOS
                                                                                    >             DISPLAY "REG-CORRECTOS    :" REG-CORRECTOS
                                                                                    >             DISPLAY "SI-EXISTE-CSV    :" SI-EXISTE-CSV
                                                                                    >             DISPLAY "NO-COINCIDE-REGIS:" NO-COINCIDE-REGIS
                                                                                    >             DISPLAY "CONT-FALLECIDOS  :" CONT-FALLECIDOS
                                                                                    >             DISPLAY "NO-COINCIDE-DIAN :" NO-COINCIDE-DIAN
                                                                                    >             DISPLAY "NO-EXISTE-REGIS  :" NO-EXISTE-REGIS
                                                                                    >             DISPLAY "NO-EXISTE-DIAN   :" NO-EXISTE-DIAN
                                                                                    >             DISPLAY "TIPO-ID-INVALIDO :" TIPO-ID-INVALIDO
                                                                                    >             DISPLAY "Alertas insertadas: " N-ALE-INSERTADAS
                                                                                    >             " modificadas: " N-ALE-MODIFICADAS
                                                                                    >             " eliminadas: " N-ALE-ELIMINADAS.
                                                                                    >  
                                                                                    >  
       4300-MODIFICAR-BDIIALE.                                                                4300-MODIFICAR-BDIIALE.
      ******************************************************************                     ******************************************************************
      * Se impacta el archivo BDIIALE con una o dos inserciones,                             * Se impacta el archivo BDIIALE con una o dos inserciones,
      * modificaciones o eliminaciones segun haya o no demandas y                            * modificaciones o eliminaciones segun haya o no demandas y
      * embargos                                                                             * embargos
      ******************************************************************                     ******************************************************************
           INITIALIZE REG-BDIIALE                                                                 INITIALIZE REG-BDIIALE

      *    SI HAY DEMANDAS                                                          |        *    DEMANDAS
           IF JURAD-DEMANDAS-VIGENTES > ZERO                                        <  
           OR JURAD-DEMANDAS-TERMINADAS > ZERO                                      <  
               MOVE "J001" TO LLASEC-BDIIALE                                                      MOVE "J001" TO LLASEC-BDIIALE
      *        ARMA DATOS DE DEMANDAS                                                        *    ARMA DATOS DE DEMANDAS
               MOVE JURAD-DEMANDAS-VIGENTES TO D-VIGENTES                                         MOVE JURAD-DEMANDAS-VIGENTES TO D-VIGENTES
               MOVE JURAD-DEMANDAS-TERMINADAS TO D-TERMINADOS                                     MOVE JURAD-DEMANDAS-TERMINADAS TO D-TERMINADOS
               STRING "20" JURAD-DEMANDAS-FECHA-ULTIMA                              |             MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO D-FECHA-ULTIMA
               DELIMITED SIZE INTO D-FECHA-ULTIMA                                   <  
               PERFORM 4300-MODIFICAR-BDIIALE-DATOS                                               PERFORM 4300-MODIFICAR-BDIIALE-DATOS
           END-IF.                                                                  <  

      *    SI HAY EMBARGOS                                                          |        *    EMBARGOS
           IF JURAD-EMBARGOS-VIGENTES > ZERO                                                      IF JURAD-EMBARGOS-VIGENTES > ZERO
           OR JURAD-EMBARGOS-TERMINADOS > ZERO                                                    OR JURAD-EMBARGOS-TERMINADOS > ZERO
               MOVE "J002" TO LLASEC-BDIIALE                                                      MOVE "J002" TO LLASEC-BDIIALE
      *        ARMA DATOS DE EMBARGOS                                                        *    ARMA DATOS DE EMBARGOS
               MOVE JURAD-EMBARGOS-VIGENTES TO D-VIGENTES                                         MOVE JURAD-EMBARGOS-VIGENTES TO D-VIGENTES
               MOVE JURAD-EMBARGOS-TERMINADOS TO D-TERMINADOS                                     MOVE JURAD-EMBARGOS-TERMINADOS TO D-TERMINADOS
               STRING "20" JURAD-EMBARGOS-FECHA-ULTIMO                              |             MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO D-FECHA-ULTIMA
               DELIMITED SIZE INTO D-FECHA-ULTIMA                                   |             PERFORM 4300-MODIFICAR-BDIIALE-DATOS.
               PERFORM 4300-MODIFICAR-BDIIALE-DATOS                                 <  
           END-IF.                                                                  <  

                                                                                    >  
       4300-MODIFICAR-BDIIALE-DATOS.                                                          4300-MODIFICAR-BDIIALE-DATOS.
      ******************************************************************                     ******************************************************************
      * PARTE DE LA CARGA DE DATOS EN EL REGISTRO BDIIALE Y GRABACION                        * PARTE DE LA CARGA DE DATOS EN EL REGISTRO BDIIALE Y GRABACION
      * DEL MISMO QUE ES COMUN A DEMANDAS Y EMBARGOS                                         * DEL MISMO QUE ES COMUN A DEMANDAS Y EMBARGOS
      * EL DATO LLASEC-BDIIALE YA TIENE "J001" O "J002"                                      * EL DATO LLASEC-BDIIALE YA TIENE "J001" O "J002"
      ******************************************************************                     ******************************************************************
      *    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK                         *    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK
      *    EL FILE STATUS DE BDIIALE QUEDA CON "00"                                          *    EL FILE STATUS DE BDIIALE QUEDA CON "00"
           PERFORM 4333-LEER-BDIIALE-RANDOM                                                       PERFORM 4333-LEER-BDIIALE-RANDOM

      *    PROCESA SEGUN EL TIPO DE NOVEDAD I M E                                            *    PROCESA SEGUN EL TIPO DE NOVEDAD I M E
           EVALUATE JURAD-TIPO-NOVEDAD                                                            EVALUATE JURAD-TIPO-NOVEDAD
           WHEN "I"                                                                               WHEN "I"
               ADD 1 TO N-REG-TIPO-I-OK                                                               ADD 1 TO N-REG-TIPO-I-OK
               PERFORM 4300-MODIFICAR-BDIIALE-I                                                       PERFORM 4300-MODIFICAR-BDIIALE-I
           WHEN "M"                                                                               WHEN "M"
               ADD 1 TO N-REG-TIPO-M-OK                                                               ADD 1 TO N-REG-TIPO-M-OK
               PERFORM 4300-MODIFICAR-BDIIALE-M                                                       PERFORM 4300-MODIFICAR-BDIIALE-M
           WHEN "E"                                                                               WHEN "E"
               ADD 1 TO N-REG-TIPO-E-OK                                                               ADD 1 TO N-REG-TIPO-E-OK
               PERFORM 4300-MODIFICAR-BDIIALE-E                                                       PERFORM 4300-MODIFICAR-BDIIALE-E
           WHEN OTHER                                                                             WHEN OTHER
      *        ESTO ES "IMPOSIBLE" POR CONTROL DE CONSISTENCIA ANTERIOR                      *        ESTO ES "IMPOSIBLE" POR CONTROL DE CONSISTENCIA ANTERIOR
               DISPLAY "ERROR DE LOGICA: TIPO-NOVEDAD="                                               DISPLAY "ERROR DE LOGICA: TIPO-NOVEDAD="
               JURAD-TIPO-NOVEDAD " REG NUM: " N-REG-LEIDOS                                           JURAD-TIPO-NOVEDAD " REG NUM: " N-REG-LEIDOS
               DISPLAY "REGISTRO DE JURAD: " DISPLAY JURAD-REG                                        DISPLAY "REGISTRO DE JURAD: " DISPLAY JURAD-REG
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.


       4300-MODIFICAR-BDIIALE-I.                                                              4300-MODIFICAR-BDIIALE-I.
      ******************************************************************                     ******************************************************************
      * INSERCION DE UNA ALERTA NUEVA                                                        * INSERCION DE UNA ALERTA NUEVA
      ******************************************************************                     ******************************************************************
      *    SI EL REGISTRO EXISTIA ES UN ERROR                                                *    SI EL REGISTRO EXISTIA ES UN ERROR
           IF EST-BDIIALE = "00"                                                                  IF EST-BDIIALE = "00"
               CALL "PONERR" USING "19" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "19" JURAD-REG E-ERRORES
               DISPLAY "LLAVE: " LLAVE-BDIIALE                                                        DISPLAY "LLAVE: " LLAVE-BDIIALE
               ADD 1 TO N-ALE-YA-EXISTE                                                               ADD 1 TO N-ALE-YA-EXISTE
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF

      *    COMPLETA LOS DATOS DEL REGISTRO                                                   *    COMPLETA LOS DATOS DEL REGISTRO
           INITIALIZE ENCABEZADO-BDIIALE                                                          INITIALIZE ENCABEZADO-BDIIALE
           MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-NOV-BDIIALE                                       MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-NOV-BDIIALE
           FEC-REP-BDIIALE                                                                        FEC-REP-BDIIALE
           MOVE P-FECHA-PROCESO-50 TO FEC-VEN-BDIIALE                                             MOVE P-FECHA-PROCESO-50 TO FEC-VEN-BDIIALE
           MOVE 0 TO BLOQUEO-BDIIALE                                                              MOVE 0 TO BLOQUEO-BDIIALE
           MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE                                                MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE
           MOVE SPACES TO LINEAS-BDIIALE                                                          MOVE SPACES TO LINEAS-BDIIALE
           PERFORM 4333-GRABAR-BDIIALE.                                                           PERFORM 4333-GRABAR-BDIIALE.


       4300-MODIFICAR-BDIIALE-M.                                                              4300-MODIFICAR-BDIIALE-M.
      ******************************************************************                     ******************************************************************
      * MODIFICACION DE UNA ALERTA EXISTENTE                                                 * MODIFICACION DE UNA ALERTA EXISTENTE
      ******************************************************************                     ******************************************************************
      *    SI EL REGISTRO NO EXISTIA ES UN ERROR                                             *    SI EL REGISTRO NO EXISTIA ES UN ERROR
           IF EST-BDIIALE NOT = "00"                                                              IF EST-BDIIALE NOT = "00"
               CALL "PONERR" USING "17" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "17" JURAD-REG E-ERRORES
               "LLAVE: " LLAVE-BDIIALE                                                                "LLAVE: " LLAVE-BDIIALE
               ADD 1 TO N-ALE-NO-EXISTE                                                               ADD 1 TO N-ALE-NO-EXISTE
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF

      *    REEMPLAZA LA FECHA DE REPORTE Y LOS VALORES                                       *    REEMPLAZA LA FECHA DE REPORTE Y LOS VALORES
           MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-REP-BDIIALE                                       MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-REP-BDIIALE
           MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE                                                MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE
           MOVE SPACES TO LINEAS-BDIIALE                                                          MOVE SPACES TO LINEAS-BDIIALE
           PERFORM 4333-REGRABAR-BDIIALE.                                                         PERFORM 4333-REGRABAR-BDIIALE.


       4300-MODIFICAR-BDIIALE-E.                                                              4300-MODIFICAR-BDIIALE-E.
      ******************************************************************                     ******************************************************************
      * ELIMINACION DE UNA ALERTA                                                            * ELIMINACION DE UNA ALERTA
      ******************************************************************                     ******************************************************************
      *    ELIMINA EL REGISTRO                                                               *    ELIMINA EL REGISTRO
           IF EST-BDIIALE = "00"                                                                  IF EST-BDIIALE = "00"
               PERFORM 4333-ELIMINAR-BDIIALE                                                          PERFORM 4333-ELIMINAR-BDIIALE
           ELSE                                                                                   ELSE
               CALL "PONERR" USING "18" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "18" JURAD-REG E-ERRORES
               "LLAVE: " LLAVE-BDIIALE                                                                "LLAVE: " LLAVE-BDIIALE
               ADD 1 TO N-ALE-NO-EXISTE                                                               ADD 1 TO N-ALE-NO-EXISTE
           END-IF.                                                                                END-IF.


       4333-LEER-BDIIALE-RANDOM.                                                              4333-LEER-BDIIALE-RANDOM.
      ******************************************************************                     ******************************************************************
      * ARMA CLAVE EXACTA Y LEE UN REGISTRO DE BDIIALE                                       * ARMA CLAVE EXACTA Y LEE UN REGISTRO DE BDIIALE
      * USA LOS DATOS DEL REG INPUT, EXCEPTO LLASEC QUE ESTA PRECARGADO                      * USA LOS DATOS DEL REG INPUT, EXCEPTO LLASEC QUE ESTA PRECARGADO
      * CUANDO PUDO LEER OK EL FILE STATUS EST-BDIIALE QUEDA CON "00"                        * CUANDO PUDO LEER OK EL FILE STATUS EST-BDIIALE QUEDA CON "00"
      ******************************************************************                     ******************************************************************
           MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIALE                                                  MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIALE
           MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIALE                                                MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIALE
           MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE                                                MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE
           MOVE 000 TO COD-ALERTA-BDIIALE                                                         MOVE 000 TO COD-ALERTA-BDIIALE
      *    LLASEC-BDIIALE FUÉ PREVIAMENTE CARGADO CON J001 O J002                            *    LLASEC-BDIIALE FUÉ PREVIAMENTE CARGADO CON J001 O J002

           READ BDIIALE                                                                           READ BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
               CONTINUE                                                                               CONTINUE
           WHEN "23"                                                                              WHEN "23"
               CONTINUE                                                                               CONTINUE
           WHEN OTHER                                                                             WHEN OTHER
               DISPLAY "ERROR AL LEER BDIIALE FS: " EST-BDIIALE                                       DISPLAY "ERROR AL LEER BDIIALE FS: " EST-BDIIALE
               " KEY: " LLAVE-BDIIALE                                                                 " KEY: " LLAVE-BDIIALE
               DISPLAY "ULTIMO REGISTRO PROCESADO: "                                                  DISPLAY "ULTIMO REGISTRO PROCESADO: "
               DISPLAY JURAD-REG-ANTERIOR                                                             DISPLAY JURAD-REG-ANTERIOR
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.

       4333-GRABAR-BDIIALE.                                                                   4333-GRABAR-BDIIALE.
      ******************************************************************                     ******************************************************************
      * INSERTA UN REGISTRO NUEVO EN BDIIALE                                                 * INSERTA UN REGISTRO NUEVO EN BDIIALE
      ******************************************************************                     ******************************************************************
           IF NOT PROCESO-REAL                                                                    IF NOT PROCESO-REAL
                                                                                    >                 ADD 1 TO N-ALE-INSERTADAS
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF
           WRITE REG-BDIIALE                                                                      WRITE REG-BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
               ADD 1 TO N-ALE-INSERTADAS                                                              ADD 1 TO N-ALE-INSERTADAS
           WHEN OTHER                                                                             WHEN OTHER
               DISPLAY "ERROR AL GRABAR BDIIALE FS: " EST-BDIIALE                                     DISPLAY "ERROR AL GRABAR BDIIALE FS: " EST-BDIIALE
               " KEY: " LLAVE-BDIIALE                                                                 " KEY: " LLAVE-BDIIALE
               DISPLAY "REGISTRO BDIIALE: "                                                           DISPLAY "REGISTRO BDIIALE: "
               DISPLAY REG-BDIIALE                                                                    DISPLAY REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.


       4333-REGRABAR-BDIIALE.                                                                 4333-REGRABAR-BDIIALE.
      ******************************************************************                     ******************************************************************
      * REGRABA UN REGISTRO MODIFICADO EN BDIIALE                                            * REGRABA UN REGISTRO MODIFICADO EN BDIIALE
      ******************************************************************                     ******************************************************************
           IF NOT PROCESO-REAL                                                                    IF NOT PROCESO-REAL
                                                                                    >                 ADD 1 TO N-ALE-MODIFICADAS
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF
           REWRITE REG-BDIIALE                                                                    REWRITE REG-BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
               ADD 1 TO N-ALE-MODIFICADAS                                                             ADD 1 TO N-ALE-MODIFICADAS
           WHEN OTHER                                                                             WHEN OTHER
               DISPLAY "ERROR AL REGRABAR BDIIALE FS: " EST-BDIIALE                                   DISPLAY "ERROR AL REGRABAR BDIIALE FS: " EST-BDIIALE
               " KEY: " LLAVE-BDIIALE                                                                 " KEY: " LLAVE-BDIIALE
               DISPLAY "REGISTRO BDIIALE: "                                                           DISPLAY "REGISTRO BDIIALE: "
               DISPLAY REG-BDIIALE                                                                    DISPLAY REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.

       4333-ELIMINAR-BDIIALE.                                                                 4333-ELIMINAR-BDIIALE.
      ******************************************************************                     ******************************************************************
      * ELIMINA UN REGISTRO DE BDIIALE                                                       * ELIMINA UN REGISTRO DE BDIIALE
      ******************************************************************                     ******************************************************************
           IF NOT PROCESO-REAL                                                                    IF NOT PROCESO-REAL
                                                                                    >                 ADD 1 TO N-ALE-ELIMINADAS
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF
           DELETE BDIIALE                                                                         DELETE BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
               ADD 1 TO N-ALE-ELIMINADAS                                                              ADD 1 TO N-ALE-ELIMINADAS
           WHEN OTHER                                                                             WHEN OTHER
               DISPLAY "ERROR AL DELETEAR BDIIALE FS: " EST-BDIIALE                                   DISPLAY "ERROR AL DELETEAR BDIIALE FS: " EST-BDIIALE
               " KEY: " LLAVE-BDIIALE                                                                 " KEY: " LLAVE-BDIIALE
               DISPLAY "REGISTRO BDIIALE: "                                                           DISPLAY "REGISTRO BDIIALE: "
               DISPLAY REG-BDIIALE                                                                    DISPLAY REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.

       4800-PROCESO-REG-T.                                                                    4800-PROCESO-REG-T.
      ******************************************************************                     ******************************************************************
      * EL REGISTRO LEIDO EN EL ARCHIVO JURAD ES TIPO "T" CON TOTALES                        * EL REGISTRO LEIDO EN EL ARCHIVO JURAD ES TIPO "T" CON TOTALES
      * DE CONTROL, Y DEBERÍA SER EL ULTIMO DEL ARCHIVO                                      * DE CONTROL, Y DEBERÍA SER EL ULTIMO DEL ARCHIVO
      ******************************************************************                     ******************************************************************
      * CONTROL DE LOS TOTALES CALCULADOS CONTRA LOS ESPERADOS                               * CONTROL DE LOS TOTALES CALCULADOS CONTRA LOS ESPERADOS
           MOVE "NO" TO E-HAY-ERROR                                                               MOVE "NO" TO E-HAY-ERROR
      *    CANTIDAD DE REGISTROS I M E                                                       *    CANTIDAD DE REGISTROS I M E
           IF FUNCTION NUMVAL(JURADT-REGISTROS) = N-REG-LEIDOS                                    IF FUNCTION NUMVAL(JURADT-REGISTROS) = N-REG-LEIDOS
               CONTINUE                                                                               CONTINUE
           ELSE                                                                                   ELSE
               DISPLAY " "                                                                            DISPLAY " "
               DISPLAY "NO COINCIDE LA CANTIDAD DE REGISTROS:"                                        DISPLAY "NO COINCIDE LA CANTIDAD DE REGISTROS:"
               JURADT-REGISTROS " CON LOS LEIDOS:" N-REG-LEIDOS                                       JURADT-REGISTROS " CON LOS LEIDOS:" N-REG-LEIDOS
               MOVE "SI" TO E-HAY-ERROR                                                               MOVE "SI" TO E-HAY-ERROR
           END-IF.                                                                                END-IF.

       4900-GRABAR-ERROR.                                                                     4900-GRABAR-ERROR.
      ******************************************************************                     ******************************************************************
      * EL REGISTRO DE JURAD TIENE ERROR: SE GRABA EN EL ARCHIVO ERRS                        * EL REGISTRO DE JURAD TIENE ERROR: SE GRABA EN EL ARCHIVO ERRS
      * CON INDICACION DEL ERROR DETECTADO                                                   * CON INDICACION DEL ERROR DETECTADO
      ******************************************************************                     ******************************************************************
           MOVE JURAD-REG TO ERRS-REG                                                             MOVE JURAD-REG TO ERRS-REG
      *    LISTA DE LOS CODIGOS DE LOS ERRORES DEL REGISTRO                                  *    LISTA DE LOS CODIGOS DE LOS ERRORES DEL REGISTRO
           MOVE E-ERRORES-REG TO ERRS-CAUSA-RECHAZO                                               MOVE E-ERRORES-REG TO ERRS-CAUSA-RECHAZO
           WRITE ERRS-REG                                                                         WRITE ERRS-REG
           EVALUATE ERRS-FS                                                                       EVALUATE ERRS-FS
               WHEN "00"                                                                              WHEN "00"
                   CONTINUE                                                                               CONTINUE
               WHEN OTHER                                                                             WHEN OTHER
                   DISPLAY "ERROR AL GRABAR EL ARCHIVO DE ERRORES "                                       DISPLAY "ERROR AL GRABAR EL ARCHIVO DE ERRORES "
                   DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME                                          DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME
                   DISPLAY "FILE STATUS: " ERRS-FS                                                        DISPLAY "FILE STATUS: " ERRS-FS
                   PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
                   GOBACK                                                                                 GOBACK
           END-EVALUATE.                                                                          END-EVALUATE.


       1000-RUTINA-INICIAL.                                                                   1000-RUTINA-INICIAL.
      ******************************************************************                     ******************************************************************
      * Todas las operaciones que se realizan una sola vez, al comienzo                      * Todas las operaciones que se realizan una sola vez, al comienzo
      * del programa:                                                                        * del programa:
      *   - obtencion de los parametros                                                      *   - obtencion de los parametros
      *   - apertura del archivo de entrada                                                  *   - apertura del archivo de entrada
      *   - apertura de todos los demas archivos                                             *   - apertura de todos los demas archivos
      *   - eliminacion de datos existentes si es refresque completo                         *   - eliminacion de datos existentes si es refresque completo
      *   - carga en memoria de los IDs de inconsistentes                                    *   - carga en memoria de los IDs de inconsistentes
      ******************************************************************                     ******************************************************************
      * REGISTRA HORA DE INICIO                                                     |        * Registra hora de inicio
           ACCEPT W-HORA-INICIO FROM TIME                                                         ACCEPT W-HORA-INICIO FROM TIME

      * OBTIENE INFORMACION SOBRE LA CORRIDA DE LA LINEA DE COMANDO: EL             |        * Obtiene informacion sobre la corrida de la linea de comando: el
      * NOMBRE DEL ARCHIVO DE ENTRADA (QUE CONTIENE EL TIPO DE PROCESO),            |        * nombre del archivo de entrada (que contiene el tipo de proceso),
      * EL INDICADOR DE PROCESO REAL O EN FALSO (DEFAULT)                           |        * el indicador de proceso real o en falso (default)
           ACCEPT P-COMMAND-LINE FROM COMMAND-LINE                                                ACCEPT P-COMMAND-LINE FROM COMMAND-LINE
      *    ANIMATOR DE TERMINAL NO PERMITE PARAMETROS EN COMMANDLINE ...            |        D    MOVE "0000011000905140104.txt 2" to P-COMMAND-LINE
           DISPLAY "PARAMETROS: " P-COMMAND-LINE                                    <  
           UNSTRING P-COMMAND-LINE DELIMITED BY ALL " " INTO                                      UNSTRING P-COMMAND-LINE DELIMITED BY ALL " " INTO
           P-FILE-NAME P-PROCESO-REAL                                                             P-FILE-NAME P-PROCESO-REAL
                                                                                    >             DISPLAY "PARAMETROS: " P-COMMAND-LINE

      * EL PROGRAMA SE ANUNCIA EN LA CONSOLA                                        |        * El programa se anuncia en la consola
           IF PROCESO-REAL                                                                        IF PROCESO-REAL
               DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO REAL"                                   DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO REAL"
           ELSE                                                                                   ELSE
               DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO EN FALSO"                               DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO EN FALSO"
           END-IF                                                                                 END-IF

      * EL INDICADOR DE PROCESO REAL DEBE SER 1 O 2                                 |        * El indicador de proceso real debe ser 1 o 2
           IF P-PROCESO-REAL NOT = "1" AND "2"                                                    IF P-PROCESO-REAL NOT = "1" AND "2"
               DISPLAY "EL INDICADOR DE PROCESO REAL ES INVALIDO"                                     DISPLAY "EL INDICADOR DE PROCESO REAL ES INVALIDO"
               DISPLAY "DEBE SER 1 O 2"                                                               DISPLAY "DEBE SER 1 O 2"
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-IF                                                                                 END-IF

      * CONTROL DEL TIPO DE PROCESO, DEL NOMBRE DEL ARCHIVO                         |        * Control del tipo de proceso, del nombre del archivo
           EVALUATE P-TIPO-PROCESO                                                                EVALUATE P-TIPO-PROCESO
           WHEN "01"                                                                              WHEN "01"
               DISPLAY "01 ENVIO ORIGINAL - CARGA TOTAL 1A VEZ"                                       DISPLAY "01 ENVIO ORIGINAL - CARGA TOTAL 1A VEZ"
           WHEN "02"                                                                              WHEN "02"
               DISPLAY "02 ARCHIVO SEMANAL - CARGA PARCIAL"                                           DISPLAY "02 ARCHIVO SEMANAL - CARGA PARCIAL"
           WHEN "03"                                                                              WHEN "03"
               DISPLAY "03 ARCHIVO MENSUAL - CARGA PARCIAL"                                           DISPLAY "03 ARCHIVO MENSUAL - CARGA PARCIAL"
           WHEN "04"                                                                              WHEN "04"
               DISPLAY "04 REFRESQUE TOTAL - CARGA TOTAL"                                             DISPLAY "04 REFRESQUE TOTAL - CARGA TOTAL"
           WHEN OTHER                                                                             WHEN OTHER
      *        VALOR INVALIDO                                                       |        *        valor invalido
               DISPLAY "EL TIPO DE PROCESO " P-TIPO-PROCESO                                           DISPLAY "EL TIPO DE PROCESO " P-TIPO-PROCESO
               " ES INVALIDO (DEBE SER 01 02 03 O 04)"                                                " ES INVALIDO (DEBE SER 01 02 03 O 04)"
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.

      * EDITA LA FECHA DE PROCESO DDMMAA DEL PARAMETRO EN FORMATO                   |        * Edita la fecha de proceso DDMMAA del parametro en formato
      * YYYYMMDD                                                                             * YYYYMMDD
           STRING "20" P-FECHA-PROCESO(5:6) P-FECHA-PROCESO(3:4)                                  STRING "20" P-FECHA-PROCESO(5:6) P-FECHA-PROCESO(3:4)
           P-FECHA-PROCESO(1:2) DELIMITED SIZE                                                    P-FECHA-PROCESO(1:2) DELIMITED SIZE
           INTO P-FECHA-PROCESO-YYYYMMDD                                                          INTO P-FECHA-PROCESO-YYYYMMDD
           DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD                                  DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD

      * CALCULA UNA FECHA 50 ANIOS POSTERIOR A LA DE PROCESO                        |        * Calcula una fecha 50 anios posterior a la de proceso
           MOVE P-FECHA-PROCESO-YYYYMMDD TO P-FECHA-PROCESO-50                                    MOVE P-FECHA-PROCESO-YYYYMMDD TO P-FECHA-PROCESO-50
           ADD 50 TO P-FECHA-PROCESO-50YYYY                                                       ADD 50 TO P-FECHA-PROCESO-50YYYY

      * APERTURA DEL ARCHIVO DE ENTRADA                                             |        * Apertura del archivo de entrada
           STRING "$TEMPORALES/" P-FILE-NAME INTO P-FILE-PATH                                     STRING "$TEMPORALES/" P-FILE-NAME INTO P-FILE-PATH
           OPEN INPUT JURAD                                                                       OPEN INPUT JURAD
           EVALUATE JURAD-FS                                                                      EVALUATE JURAD-FS
               WHEN "00"                                                                              WHEN "00"
                    CONTINUE                                                                               CONTINUE
               WHEN OTHER                                                                             WHEN OTHER
                   DISPLAY "ERROR EN OPEN DEL ARCHIVO JURAD "                                             DISPLAY "ERROR EN OPEN DEL ARCHIVO JURAD "
                   DISPLAY "PATH DEL ARCHIVO: " P-FILE-PATH                                               DISPLAY "PATH DEL ARCHIVO: " P-FILE-PATH
                   DISPLAY "FILE STATUS: " JURAD-FS                                                       DISPLAY "FILE STATUS: " JURAD-FS
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA                                           PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA
                   GOBACK                                                                                 GOBACK
           END-EVALUATE.                                                                          END-EVALUATE.

      * APERTURA DEL ARCHIVO DE ERRORES                                             |        * Apertura del archivo de errores
           STRING "$TEMPORALES/" P-FILE-NAME(1:19) ".ERRS"                                        STRING "$TEMPORALES/" P-FILE-NAME(1:19) ".ERRS"
           INTO ERRS-FILE-NAME                                                                    INTO ERRS-FILE-NAME
           OPEN OUTPUT ERRS                                                                       OPEN OUTPUT ERRS
           EVALUATE ERRS-FS                                                                       EVALUATE ERRS-FS
               WHEN "00"                                                                              WHEN "00"
                    CONTINUE                                                                               CONTINUE
               WHEN OTHER                                                                             WHEN OTHER
                   DISPLAY "ERROR EN OPEN DEL ARCHIVO DE ERRORES "                                        DISPLAY "ERROR EN OPEN DEL ARCHIVO DE ERRORES "
                   DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME                                          DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME
                   DISPLAY "FILE STATUS: " ERRS-FS                                                        DISPLAY "FILE STATUS: " ERRS-FS
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA                                           PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA
                   GOBACK                                                                                 GOBACK
           END-EVALUATE.                                                                          END-EVALUATE.

      * APERTURA DE LOS ARCHIVOS MAESTROS                                                    * APERTURA DE LOS ARCHIVOS MAESTROS
      * SI ALGÚN OPEN FALLA EL PROGRAMA CANCELA                                              * SI ALGÚN OPEN FALLA EL PROGRAMA CANCELA
           OPEN INPUT BDIIREGI                                                                    OPEN INPUT BDIIREGI
           OPEN INPUT BDIIDIAN                                                                    OPEN INPUT BDIIDIAN
           OPEN INPUT BDIIDAS.                                                                    OPEN INPUT BDIIDAS.

      * APERTURA DEL ARCHIVO DE ALERTAS EN LINEA                                             * APERTURA DEL ARCHIVO DE ALERTAS EN LINEA
           IF PROCESO-REAL                                                                        IF PROCESO-REAL
               OPEN I-O BDIIALE                                                                       OPEN I-O BDIIALE
           ELSE                                                                                   ELSE
               OPEN INPUT BDIIALE                                                                     OPEN INPUT BDIIALE
           END-IF.                                                                                END-IF.

      * SI ES UN REFRESQUE TOTAL (CODIGO 04) SE ELIMINAN LOS REGISTROS                       * SI ES UN REFRESQUE TOTAL (CODIGO 04) SE ELIMINAN LOS REGISTROS
      * DE JURAD EXISTENTES                                                                  * DE JURAD EXISTENTES
           IF P-TIPO-PROCESO = "04" AND PROCESO-REAL                                              IF P-TIPO-PROCESO = "04" AND PROCESO-REAL
               PERFORM 1001-ELIMINAR-TODO                                                             PERFORM 1001-ELIMINAR-TODO
           END-IF.                                                                                END-IF.


       1001-ELIMINAR-TODO.                                                                    1001-ELIMINAR-TODO.
      ******************************************************************                     ******************************************************************
      * ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE                         * ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE
      * ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL                                        * ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL
      ******************************************************************                     ******************************************************************
           DISPLAY "ELIMINANDO TODA LA INFORMACION CON FUENTE JURAD"                              DISPLAY "ELIMINANDO TODA LA INFORMACION CON FUENTE JURAD"
      *    POSICIONA EN EL PRIMER REG DE JURAD                                               *    POSICIONA EN EL PRIMER REG DE JURAD
           MOVE ZERO TO TIP-IDE-BDIIALE                                                           MOVE ZERO TO TIP-IDE-BDIIALE
           MOVE ZERO TO NUM-IDE-BDIIALE                                                           MOVE ZERO TO NUM-IDE-BDIIALE
           MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE                                                MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE
           MOVE ZEROS TO COD-ALERTA-BDIIALE                                                       MOVE ZEROS TO COD-ALERTA-BDIIALE
           MOVE LOW-VALUES TO LLASEC-BDIIALE                                                      MOVE LOW-VALUES TO LLASEC-BDIIALE
           START BDIIALE KEY > LLAVE-BDIIALE                                                      START BDIIALE KEY > LLAVE-BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
      *        POSICIONADO                                                                   *        POSICIONADO
               CONTINUE                                                                               CONTINUE
           WHEN OTHER                                                                             WHEN OTHER
      *        NO HAY REGISTROS                                                              *        NO HAY REGISTROS
               DISPLAY "NO HAY REGISTROS A ELIMINAR FS:" EST-BDIIALE                                  DISPLAY "NO HAY REGISTROS A ELIMINAR FS:" EST-BDIIALE
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-EVALUATE.                                                                          END-EVALUATE.

      *    LEE SECUENCIALMENTE Y ELIMINA LOS REGISTROS DE JURAD                              *    LEE SECUENCIALMENTE Y ELIMINA LOS REGISTROS DE JURAD
      *    HASTA EL FIN DEL ARCHIVO                                                          *    HASTA EL FIN DEL ARCHIVO
           PERFORM UNTIL EST-BDIIALE NOT = "00"                                                   PERFORM UNTIL EST-BDIIALE NOT = "00"
               READ BDIIALE NEXT RECORD                                                               READ BDIIALE NEXT RECORD
               EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
               WHEN "00"                                                                              WHEN "00"
                   IF FUENTE-BDIIALE = P-COD-SUSCRIPTOR                                                   IF FUENTE-BDIIALE = P-COD-SUSCRIPTOR
      *                ES UN ALERTA DE JURAD                                                 *                ES UN ALERTA DE JURAD
                       DELETE BDIIALE                                                                         DELETE BDIIALE
                       IF EST-BDIIALE = "00"                                                                  IF EST-BDIIALE = "00"
                           ADD 1 TO N-ALE-BORRADAS                                                                ADD 1 TO N-ALE-BORRADAS
                       ELSE                                                                                   ELSE
      *                    ERROR EN LA ELIMINACION                                           *                    ERROR EN LA ELIMINACION
                           DISPLAY "ERROR AL ELIMINAR UN REGISTRO DE "                                            DISPLAY "ERROR AL ELIMINAR UN REGISTRO DE "
                           "BDIIALE VACIANDO LOS DATOS"                                                           "BDIIALE VACIANDO LOS DATOS"
                           DISPLAY "CLAVE: " LLAVE-BDIIALE                                                        DISPLAY "CLAVE: " LLAVE-BDIIALE
                           DISPLAY "REG BORRADOS: " N-ALE-BORRADAS                                                DISPLAY "REG BORRADOS: " N-ALE-BORRADAS
                           PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
                       END-IF                                                                                 END-IF
                   END-IF                                                                                 END-IF
               WHEN "10"                                                                              WHEN "10"
      *            FIN DE ARCHIVO: SALE NORMALMENTE                                          *            FIN DE ARCHIVO: SALE NORMALMENTE
                   DISPLAY "FIN DE LOS REGISTROS A ELIMINAR - LEÍDOS:"              |                     DISPLAY "TERMINO LA ELIMINACION TOTAL DE JURAD"
                   N-ALE-LEIDAS                                                     |                     DISPLAY "REG BORRADOS: " N-ALE-BORRADAS
               WHEN OTHER                                                                             WHEN OTHER
      *            LECTURA ANORMAL: CANCELACION DEL PROGRAMA                                 *            LECTURA ANORMAL: CANCELACION DEL PROGRAMA
                   DISPLAY "ERROR EN LECTURA DEL ARCHIVO DE ALERTAS "                                     DISPLAY "ERROR EN LECTURA DEL ARCHIVO DE ALERTAS "
                   "ONLINE"                                                                               "ONLINE"
                   DISPLAY "FILE STATUS: " EST-BDIIALE                                                    DISPLAY "FILE STATUS: " EST-BDIIALE
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA                                           PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA
               END-EVALUATE                                                                           END-EVALUATE
           END-PERFORM.                                                                           END-PERFORM.
           DISPLAY "TERMINO LA ELIMINACION TOTAL DE JURAD"                          <  
           DISPLAY "REG BORRADOS: " N-ALE-BORRADAS.                                 <  


       7000-RUTINA-FINAL.                                                                     7000-RUTINA-FINAL.
      ******************************************************************                     ******************************************************************
      * Registra hora de finalizacion                                                        * Registra hora de finalizacion
           ACCEPT W-HORA-FIN FROM TIME                                                            ACCEPT W-HORA-FIN FROM TIME

      * Leer JURAD a ver si hay registros despues del "T"                                    * Leer JURAD a ver si hay registros despues del "T"

      * Close todos los archivos                                                             * Close todos los archivos
           CLOSE JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.                                    CLOSE JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.
           DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD                                  DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD
      * Emision de contadores de registros                                          <  
           display " "                                                                            display " "
           display "Totales de registros:"                                          <  
           display " "                                                              <  
      * Totales tipo PESVNO                                                                  * Totales tipo PESVNO
           DISPLAY "**************************************"                                       DISPLAY "**************************************"
           DISPLAY "        VALIDACION REGISTROS          "                                       DISPLAY "        VALIDACION REGISTROS          "
           DISPLAY "  BDIIREGIS BDIIDIAN BDIIDAS BDACSV   "                                       DISPLAY "  BDIIREGIS BDIIDIAN BDIIDAS BDACSV   "
           DISPLAY "**************************************                          |             DISPLAY "**************************************"
           DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5                          <  
           DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6                          <  
           DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7                          <  
           DISPLAY " "                                                                            DISPLAY " "
                                                                                    >             DISPLAY "REGISTROS MAL FORMADOS          :" REG-MAL-FORMADOS
           DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS                                 DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS
           DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS                              DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS
           DISPLAY "REGISTROS CUENTAS SIN VALIDAR   :" SI-EXISTE-CSV                              DISPLAY "REGISTROS CUENTAS SIN VALIDAR   :" SI-EXISTE-CSV
           DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS                          DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
           DISPLAY "REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOS                            DISPLAY "REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOS
           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN                           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN
           DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS                            DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS
           DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN                             DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN
           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO                           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO
           DISPLAY " "                                                                            DISPLAY " "
           DISPLAY "**************************************"                                       DISPLAY "**************************************"
           DISPLAY "        PORCENTAJE REGISTROS          "                                       DISPLAY "        PORCENTAJE REGISTROS          "
           DISPLAY "            PROCESADOS  OK            "                                       DISPLAY "            PROCESADOS  OK            "
           DISPLAY "**************************************                          |             DISPLAY "**************************************"
      *    PORCENTAJE REGISTROS PROCESADOS OK                                                *    PORCENTAJE REGISTROS PROCESADOS OK

           COMPUTE N-EDITP100 ROUNDED = 100.0 * N-REG-OK / N-REG-LEIDOS             |             COMPUTE N-EDITP100 ROUNDED = 100.0 * N-REG-PROCESADOS
                                                                                    >             / N-REG-LEIDOS
           DISPLAY N-EDITP100 "% DE REGISTROS CORRECTOS"                                          DISPLAY N-EDITP100 "% DE REGISTROS CORRECTOS"
           MOVE N-REG-OK TO N-EDIT                                                  |             MOVE N-REG-PROCESADOS TO N-EDIT
           DISPLAY N-EDIT "REGISTROS PROCESADOS SIN ERROR"                                        DISPLAY N-EDIT "REGISTROS PROCESADOS SIN ERROR"
           IF P-TIPO-PROCESO = "04"                                                               IF P-TIPO-PROCESO = "04"
               MOVE N-ALE-BORRADAS TO N-EDIT                                                          MOVE N-ALE-BORRADAS TO N-EDIT
               DISPLAY N-EDIT                                                                         DISPLAY N-EDIT
               "ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL"                                           "ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL"
           END-IF                                                                                 END-IF
           MOVE N-ALE-INSERTADAS TO N-EDIT                                                        MOVE N-ALE-INSERTADAS TO N-EDIT
           DISPLAY N-EDIT "ALERTAS INSERTADAS"                                                    DISPLAY N-EDIT "ALERTAS INSERTADAS"
           MOVE N-ALE-MODIFICADAS TO N-EDIT                                                       MOVE N-ALE-MODIFICADAS TO N-EDIT
           DISPLAY N-EDIT "ALERTAS MODIFICADAS"                                                   DISPLAY N-EDIT "ALERTAS MODIFICADAS"
           MOVE N-ALE-ELIMINADAS TO N-EDIT                                                        MOVE N-ALE-ELIMINADAS TO N-EDIT
           DISPLAY N-EDIT "ALERTAS ELIMINADAS"                                                    DISPLAY N-EDIT "ALERTAS ELIMINADAS"
           MOVE N-ALE-YA-EXISTE TO N-EDIT                                                         MOVE N-ALE-YA-EXISTE TO N-EDIT
           DISPLAY N-EDIT "INSERCION DE ALERTA EXISTENTE"                                         DISPLAY N-EDIT "INSERCION DE ALERTA EXISTENTE"
           MOVE N-ALE-NO-EXISTE TO N-EDIT                                                         MOVE N-ALE-NO-EXISTE TO N-EDIT
           DISPLAY N-EDIT "MODIF O ELIM DE ALERTA INEXISTENTE".                                   DISPLAY N-EDIT "MODIF O ELIM DE ALERTA INEXISTENTE".

                                                                                    >             DISPLAY " "
           DISPLAY "**************************************"                                       DISPLAY "**************************************"
           DISPLAY "            REPORTE ERRORES           "                                       DISPLAY "            REPORTE ERRORES           "
           DISPLAY "**************************************#                         |             DISPLAY "**************************************"
      * EMISION DEL REPORTE DE ERRORES                                                       * EMISION DEL REPORTE DE ERRORES
           DISPLAY " "                                                                            DISPLAY " "
           DISPLAY "TOTALES POR TIPO DE ERROR DETECTADO:"                                         DISPLAY "TOTALES POR TIPO DE ERROR DETECTADO:"
           PERFORM VARYING EX FROM 1 BY 1 UNTIL EX > 50                                           PERFORM VARYING EX FROM 1 BY 1 UNTIL EX > 50
           OR E-CODIGO(EX) = "00"                                                                 OR E-CODIGO(EX) = "00"
               IF E-CONTADOR(EX) NOT = 0                                                              IF E-CONTADOR(EX) NOT = 0
                   MOVE E-CONTADOR(EX) TO E-EDIT                                                          MOVE E-CONTADOR(EX) TO E-EDIT
                   DISPLAY E-EDIT E-CODIGO(EX) "-" E-DESCRIPCION(EX)                                      DISPLAY E-EDIT E-CODIGO(EX) "-" E-DESCRIPCION(EX)
               END-IF                                                                                 END-IF
           END-PERFORM.                                                                           END-PERFORM.


       9000-CANCELAR-PROGRAMA.                                                                9000-CANCELAR-PROGRAMA.
      ******************************************************************                     ******************************************************************
      * Procedimiento standard de cancelacion de programa batch                              * Procedimiento standard de cancelacion de programa batch
      ******************************************************************                     ******************************************************************
           DISPLAY " "                                                                            DISPLAY " "
           DISPLAY PGM " - PROCESO CANCELADO"                                                     DISPLAY PGM " - PROCESO CANCELADO"
           GOBACK RETURNING 99.                                                                   GOBACK RETURNING 99.


       513-VALIDA-EN-CSV.                                                                     513-VALIDA-EN-CSV.
      **************************************************************                         **************************************************************
      * Valida si la identificación está en la base de datos alterna                         * Valida si la identificación está en la base de datos alterna
      **************************************************************                         **************************************************************
      *    HACE VALIDACION DE TIPO DE IDENTIFICACION                                         *    HACE VALIDACION DE TIPO DE IDENTIFICACION
           MOVE TIPOID-E TO TIP-IDE-BDIIVIDE                                                      MOVE TIPOID-E TO TIP-IDE-BDIIVIDE
           MOVE NUMID-E TO NUM-IDE-BDIIVIDE                                                       MOVE NUMID-E TO NUM-IDE-BDIIVIDE
      *    RETORNA SW-TID-BDIIVIDE=0 SI EL NUM ID NO ESTÁ DENTRO                             *    RETORNA SW-TID-BDIIVIDE=0 SI EL NUM ID NO ESTÁ DENTRO
      *    DEL RANGO QUE CORRESPONDE AL TIPO DE ID                                           *    DEL RANGO QUE CORRESPONDE AL TIPO DE ID
           PERFORM 80400-VALIDAR-TIPO-ID                                                          PERFORM 80400-VALIDAR-TIPO-ID
           IF SW-TID-BDIIVIDE = 0                                                                 IF SW-TID-BDIIVIDE = 0
      *        EL TIPO DE ID ES OK                                                           *        EL TIPO DE ID ES OK
               IF HACER-MATCH = ZEROS                                                                 IF HACER-MATCH = ZEROS
                   MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH                                                MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH
                   MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH                                                MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
      *            SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA                              *            SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA
      *            IDENTIFICACION BUSCADA. EN CASO DE HALLAR                                 *            IDENTIFICACION BUSCADA. EN CASO DE HALLAR
      *            REGISTROS SE PROCEDE A REALIZAR EL MATCH                                  *            REGISTROS SE PROCEDE A REALIZAR EL MATCH
                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH                                                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH
                   IF IDE-TIPO-BDAMATCH = 1                                                               IF IDE-TIPO-BDAMATCH = 1
                       IF TIPOID-E = 1 OR 4                                                                   IF TIPOID-E = 1 OR 4
                           INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL                                              INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL
                           "," BY " ", ";" BY " "                                                                 "," BY " ", ";" BY " "
                       END-IF                                                                                 END-IF
                       MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM                                                   MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM
                       MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM                                        MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM
                       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM                                                  MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM
                       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                                      MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
                       PERFORM 10000-MATCH-NOMBRES-VALNOM                                                     PERFORM 10000-MATCH-NOMBRES-VALNOM
                       IF MATCH-OK-OUT-VALNOM = 1                                                             IF MATCH-OK-OUT-VALNOM = 1
                           MOVE 1 TO IDE-TIPO-BDAMATCH                                                            MOVE 1 TO IDE-TIPO-BDAMATCH
                       END-IF                                                                                 END-IF
                   END-IF                                                                                 END-IF

                   IF IDE-TIPO-BDAMATCH = 1                                                               IF IDE-TIPO-BDAMATCH = 1
                       ADD 1 TO SI-EXISTE-CSV                                                                 ADD 1 TO SI-EXISTE-CSV
                   END-IF                                                                                 END-IF
               END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

       9800-FILTRAR-ALFABETICO.                                                               9800-FILTRAR-ALFABETICO.
      ******************************************************************                     ******************************************************************
      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA                         * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
      ******************************************************************                     ******************************************************************
           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA                                MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA
           INITIALIZE CADENA-SALE                                                                 INITIALIZE CADENA-SALE
           MOVE 1 TO J                                                                            MOVE 1 TO J
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60                                             PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60
              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO                                              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO
              IF SI-ALFABETICO                                                                       IF SI-ALFABETICO
                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)                                           MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)
                 ADD 1 TO J                                                                             ADD 1 TO J
              END-IF                                                                                 END-IF
           END-PERFORM.                                                                           END-PERFORM.
      ******************************************************************                     ******************************************************************

           COPY BDIIVIDE.PROC.                                                                    COPY BDIIVIDE.PROC.
           copy BDLDIR.PROC.                                                                      copy BDLDIR.PROC.
           COPY BDAMATCH.PROC.                                                                    COPY BDAMATCH.PROC.
           COPY VALNOM.PROC.                                                                      COPY VALNOM.PROC.
      /                                                                                      /
       IDENTIFICATION DIVISION.                                                               IDENTIFICATION DIVISION.
       PROGRAM-ID. PONERR.                                                                    PROGRAM-ID. PONERR.
      ******************************************************************                     ******************************************************************
      * Rutina de conveniencia para procesar un error detectado en un                        * Rutina de conveniencia para procesar un error detectado en un
      * registro de input                                                                    * registro de input
      * Contabiliza el error en la tabla de errores, activa el indicador                     * Contabiliza el error en la tabla de errores, activa el indicador
      * de registro con error, muestra el mensaje en la pantalla, cuenta                     * de registro con error, muestra el mensaje en la pantalla, cuenta
      * el registro erroneo                                                                  * el registro erroneo
      ******************************************************************                     ******************************************************************
       ENVIRONMENT DIVISION.                                                                  ENVIRONMENT DIVISION.
       DATA DIVISION.                                                                         DATA DIVISION.
       WORKING-STORAGE SECTION.                                                               WORKING-STORAGE SECTION.
      ******************************************************************                     ******************************************************************
      * REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)                                           * REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)
       01  REG-INPUT-ANTERIOR           PIC X(86) VALUE LOW-VALUES.                           01  REG-INPUT-ANTERIOR           PIC X(86) VALUE LOW-VALUES.
      * POSICION DEL PROXIMO ERROR EN LA LISTA DE ERRORES DEL REG                            * POSICION DEL PROXIMO ERROR EN LA LISTA DE ERRORES DEL REG
       01  ERRINDEX                     PIC 999 COMP.                                         01  ERRINDEX                     PIC 999 COMP.
      ******************************************************************                     ******************************************************************

       LINKAGE SECTION.                                                                       LINKAGE SECTION.
      ******************************************************************                     ******************************************************************
      * CODIGO DEL ERROR DETECTADO                                                           * CODIGO DEL ERROR DETECTADO
       01  COD-ERROR                    PIC XX.                                               01  COD-ERROR                    PIC XX.
      ******************************************************************                     ******************************************************************
      * REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)                                           * REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)
       01  REG-INPUT                    PIC X(86).                                  |         01  REG-INPUT                    PIC X(102).
      ******************************************************************                     ******************************************************************
      * TABLA DE ERRORES DE CONSISTENCIA DEL INPUT                                           * TABLA DE ERRORES DE CONSISTENCIA DEL INPUT
       01 E-ERRORES.                                                                          01 E-ERRORES.
      *    INDICA SI EL REGISTRO ACTUAL TIENE ERROR                                          *    INDICA SI EL REGISTRO ACTUAL TIENE ERROR
           03 E-HAY-ERROR               PIC XX.                                                   03 E-HAY-ERROR               PIC XX.
                                                                                    >        *    INDICA SI EL REGISTRO ACTUAL IMPACTA LA BASE DE DATOS
                                                                                    >             03 E-IMPACTAR-BDIIALE        PIC XX.
      *    ERRORES DEL REGISTRO ACTUAL                                                       *    ERRORES DEL REGISTRO ACTUAL
           03 E-ERRORES-REG             PIC X(300).                                               03 E-ERRORES-REG             PIC X(300).
      *    CONTADOR DE REGISTROS CON ERROR                                                   *    CONTADOR DE REGISTROS CON ERROR
           03 E-CONT-REGS-CON-ERROR     PIC 9(8).                                                 03 E-CONT-REGS-CON-ERROR     PIC 9(8).
      *    TABLA DE ERRORES                                                                  *    TABLA DE ERRORES
           03 E-ERROR                   OCCURS 50 INDEXED EX.                                     03 E-ERROR                   OCCURS 50 INDEXED EX.
               05 E-CODIGO              PIC XX.                                                       05 E-CODIGO              PIC XX.
               05                       PIC X.                                      |                 05 E-IMPACTAR            PIC X.
               05 E-CONTADOR            PIC 9(7).                                                     05 E-CONTADOR            PIC 9(7).
               05                       PIC X.                                                        05                       PIC X.
               05 E-DESCRIPCION         PIC X(59).                                                    05 E-DESCRIPCION         PIC X(59).

      ******************************************************************                     ******************************************************************

       PROCEDURE DIVISION USING COD-ERROR REG-INPUT E-ERRORES.                                PROCEDURE DIVISION USING COD-ERROR REG-INPUT E-ERRORES.
       00.                                                                                    00.
      *    MARCA AL REG ACTUAL COMO ERRONEO                                         <  
           MOVE "SI" TO E-HAY-ERROR                                                 <  
                                                                                    <  
      *    CUENTA Y MUESTRA EL REGISTRO DE INPUT CON ERROR                                   *    CUENTA Y MUESTRA EL REGISTRO DE INPUT CON ERROR
           IF REG-INPUT NOT = REG-INPUT-ANTERIOR                                    |             IF E-HAY-ERROR NOT = "SI"
               ADD 1 TO E-CONT-REGS-CON-ERROR                                                         ADD 1 TO E-CONT-REGS-CON-ERROR
               DISPLAY " "                                                                            DISPLAY " "
               DISPLAY REG-INPUT                                                                      DISPLAY REG-INPUT
               MOVE REG-INPUT TO REG-INPUT-ANTERIOR                                                   MOVE REG-INPUT TO REG-INPUT-ANTERIOR
               MOVE SPACES TO E-ERRORES-REG                                                           MOVE SPACES TO E-ERRORES-REG
               MOVE 2 TO ERRINDEX                                                                     MOVE 2 TO ERRINDEX
           END-IF                                                                                 END-IF

                                                                                    >        *    MARCA AL REG ACTUAL COMO ERRONEO
                                                                                    >             MOVE "SI" TO E-HAY-ERROR
                                                                                    >  
      *    CONTABILIZA EL ERROR EN LA TABLA DE ERRORES                                       *    CONTABILIZA EL ERROR EN LA TABLA DE ERRORES
           SET EX TO 1                                                                            SET EX TO 1
           SEARCH E-ERROR VARYING EX                                                              SEARCH E-ERROR VARYING EX
           AT END                                                                                 AT END
               DISPLAY "--- FALLA EN LA TABLA DE ERRORES ---" COD-ERROR                               DISPLAY "--- FALLA EN LA TABLA DE ERRORES ---" COD-ERROR
           WHEN E-CODIGO(EX) = "00"                                                               WHEN E-CODIGO(EX) = "00"
               ADD 1 TO E-CONTADOR(EX)                                                                ADD 1 TO E-CONTADOR(EX)
               DISPLAY "--- ERROR TIPO EXOTICO: " COD-ERROR                                           DISPLAY "--- ERROR TIPO EXOTICO: " COD-ERROR
               ADD 1 TO E-CONTADOR(EX)                                                                ADD 1 TO E-CONTADOR(EX)
           WHEN E-CODIGO(EX) = COD-ERROR                                                          WHEN E-CODIGO(EX) = COD-ERROR
               ADD 1 TO E-CONTADOR(EX)                                                                ADD 1 TO E-CONTADOR(EX)
               DISPLAY "ERROR " COD-ERROR " " E-DESCRIPCION(EX)                                       DISPLAY "ERROR " COD-ERROR " " E-DESCRIPCION(EX)
                                                                                    >        *        si el error está marcado para impactar BDIIALE o no
                                                                                    >                 IF E-IMPACTAR(EX) NOT = "+"
                                                                                    >                     MOVE "NO" TO E-IMPACTAR-BDIIALE
                                                                                    >                 END-IF
           END-SEARCH                                                                             END-SEARCH

      *    AGREGA A LA LISTA DE ERRORES DEL REGISTRO                                         *    AGREGA A LA LISTA DE ERRORES DEL REGISTRO
           IF ERRINDEX < (300 - 59 - 3)                                                           IF ERRINDEX < (300 - 59 - 3)
               MOVE COD-ERROR TO E-ERRORES-REG(ERRINDEX:2)                                            MOVE COD-ERROR TO E-ERRORES-REG(ERRINDEX:2)
               ADD 3 TO ERRINDEX                                                                      ADD 3 TO ERRINDEX
               MOVE E-DESCRIPCION(EX) TO E-ERRORES-REG(ERRINDEX:59)                                   MOVE E-DESCRIPCION(EX) TO E-ERRORES-REG(ERRINDEX:59)
               ADD 59 TO ERRINDEX                                                                     ADD 59 TO ERRINDEX
           END-IF                                                                                 END-IF

           EXIT PROGRAM.                                                                          EXIT PROGRAM.


       END PROGRAM PONERR.                                                                    END PROGRAM PONERR.

       END PROGRAM CARGAJUR.                                                                  END PROGRAM CARGAJUR.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
                                                                                    <  

/d/iccol/desarrollo/fuentes>man sdiff
Reformatting page.  Please Wait... done

User Commands                                            sdiff(1)

NAME
     sdiff - print differences between two files side-by-side

SYNOPSIS
     sdiff [-l] [-s] [-o output] [-w n] filename1 filename2

DESCRIPTION
     sdiff uses the output of  the  diff  command  to  produce  a
     side-by-side  listing of two files indicating lines that are
     different. Lines of the two files are printed with  a  blank
     gutter  between  them if the lines are identical, a < in the
     gutter if the line appears only in filename1,  a  >  in  the
     gutter  if  the  line appears only in filename2, and a | for
     lines that are different. (See the EXAMPLES section below.)

OPTIONS
     -l              Print only the left side of any  lines  that
                     are identical.to

     -s              Do not print identical lines.

     -o output       Use the argument output as  the  name  of  a
                     third  file  that  is  created  as  a  user-
                     controlled merge of filename1 and filename2.
                     Identical  lines  of filename1 and filename2
                     are copied to output. Sets  of  differences,
                     as  produced  by  diff, are printed; where a
                     set of differences  share  a  common  gutter
                     character.   After   printing  each  set  of
                     differences, sdiff prompts the user with a %
                     and  waits  for  one  of the following user-
                     typed commands:

                     l        Append the left column to the  out-
                              put file.

                     r        Append the right column to the out-
                              put file.

                     s        Turn on silent mode; do  not  print
                              identical lines.

SunOS 5.10          Last change: 20 Dec 1996                    1

User Commands                                            sdiff(1)

                     v        Turn off silent mode.

                     e l      Call  the  editor  with  the   left
                              column.

                     e r      Call  the  editor  with  the  right
--More--(48%)                              column.

                     e b      Call the editor with the concatena-
                              tion of left and right.

                     e        Call the editor with a zero  length
                              file.

                     q        Exit from the program.

                     On exit from the editor, the resulting  file
                     is  concatenated  to  the  end of the output
                     file.

     -w n            Use the argument n as the width of the  out-
                     put  line.  The  default  line length is 130
                     characters.

USAGE
     See largefile(5) for the  description  of  the  behavior  of
     sdiff  when  encountering  files  greater than or equal to 2
     Gbyte ( 2**31 bytes).

EXAMPLES
     Example 1: An example of the sdiff command.

     A sample output of sdiff follows.

     x   |   y
     a       a
     b   <
     c   <

SunOS 5.10          Last change: 20 Dec 1996                    2

User Commands                                            sdiff(1)

     d       d
         >   c

ENVIRONMENT VARIABLES
     If any  of  the  LC_*  variables  (  LC_CTYPE,  LC_MESSAGES,
     LC_TIME, LC_COLLATE, LC_NUMERIC,
      and LC_MONETARY ) (see  environ(5))  are  not  set  in  the
     environment,  the  operational  behavior  of  sdiff for each
     corresponding locale category is determined by the value  of
     the  LANG  environment variable.  If LC_ALL is set, its con-
     tents are used to override both the LANG and the other  LC_*
     variables.   If  none  of  the above variables is set in the
     environment, the "C" locale determines how sdiff behaves.

     LC_CTYPE        Determines  how  sdiff  handles  characters.
                     When LC_CTYPE is set to a valid value, sdiff
                     can display and handle  text  and  filenames
                     containing valid characters for that locale.
--More--(88%)
ATTRIBUTES
     See attributes(5) for descriptions of the  following  attri-
     butes:

     ____________________________________________________________
    |       ATTRIBUTE TYPE        |       ATTRIBUTE VALUE       |
    | Availability                | SUNWesu                     |
    | CSI                         | Enabled                     |
    |_____________________________|_____________________________|

SEE ALSO
     diff(1), ed(1), attributes(5), environ(5), largefile(5)

SunOS 5.10          Last change: 20 Dec 1996                    3

/d/iccol/desarrollo/fuentes> ^[  /d/iccol/desarrollo/fuentes> man sdiffsdiff -w 170 CARGAJUR.bup.CBL CARGAJUR.CBL/d/iccol/desarrollo/fuentes>sdiff -w 170 CARGAJUR.bup.CBL CARGAJUR.CBL >CARGA/d/iccol/desarrollo/fuentes>.CBL CARGAJUR.CBL >CARGAJ                        <UR.diff     R                                CARGA                        <JUR.diff
/d/iccol/desarrollo/fuentes>vi car   CARGAJUR.diff
"CARGAJUR.diff" 1565 lines, 188045 characters Copia de CARGAJUR.CBL previa a las modificaciones del 2014-06-25 (eliminar sin mi   <$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS
* POR JURAD* POR JURAD
* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA
* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN
* EL ARCHIVO ERRS.* EL ARCHIVO ERRS.
>* Prueba: 0000011000905140101.txt
************************************************************************************************************************************
AUTHOR.GLOBANT JL.AUTHOR.GLOBANT JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION SECTION.CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS. *> WITH DEBUGGING MODE.|SOURCE-COMPUTER. MICROFOCUS. *> with debugging mode.
OBJECT-COMPUTER. MICROFOCUS.OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.INPUT-OUTPUT SECTION.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
SELECT JURAD ASSIGN TO P-FILE-PATHSELECT JURAD ASSIGN TO P-FILE-PATHORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALFILE STATUS IS JURAD-FS.FILE STATUS IS JURAD-FS.************************************************************************************************************************************
************************************************************************************************************************************
SELECT ERRS ASSIGN TO ERRS-FILE-NAMESELECT ERRS ASSIGN TO ERRS-FILE-NAMEORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALFILE STATUS IS ERRS-FS.FILE STATUS IS ERRS-FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIREGI.FS.COPY BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDIAN.FS.COPY BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDAS.FS.COPY BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORDCOPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORDFILE STATUS IS EST-BDIIALE.==.FILE STATUS IS EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS."CARGAJUR.diff" 1565 lines, 188045 characters:q/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi CARGAJUR.diff CARGAJUR.diff  c CARGAJUR.diffa CARGAJUR.difft CARGAJUR.diff
Copia de CARGAJUR.CBL previa a las modificaciones del 2014-06-25 (eliminar sin mi   <  
      $SET LIST SETTING LISTWIDTH"120"                                                       $SET LIST SETTING LISTWIDTH"120"
       IDENTIFICATION DIVISION.                                                               IDENTIFICATION DIVISION.
       PROGRAM-ID.    CARGAJUR.                                                               PROGRAM-ID.    CARGAJUR.
      ******************************************************************                     ******************************************************************
      * ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS                         * ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS
      * POR JURAD                                                                            * POR JURAD
      * PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA                       * PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA
      * LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN                      * LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN
      * EL ARCHIVO ERRS.                                                                     * EL ARCHIVO ERRS.
                                                                                    >        * Prueba: 0000011000905140101.txt
      ******************************************************************                     ******************************************************************
       AUTHOR.        GLOBANT JL.                                                             AUTHOR.        GLOBANT JL.
       DATE-WRITTEN.                                                                          DATE-WRITTEN.
       DATE-COMPILED.                                                                         DATE-COMPILED.
       CONFIGURATION SECTION.                                                                 CONFIGURATION SECTION.
       SOURCE-COMPUTER. MICROFOCUS. *> WITH DEBUGGING MODE.                         |         SOURCE-COMPUTER. MICROFOCUS. *> with debugging mode.
       OBJECT-COMPUTER. MICROFOCUS.                                                           OBJECT-COMPUTER. MICROFOCUS.
       INPUT-OUTPUT SECTION.                                                                  INPUT-OUTPUT SECTION.
       FILE-CONTROL.                                                                          FILE-CONTROL.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
       SELECT JURAD ASSIGN TO P-FILE-PATH                                                     SELECT JURAD ASSIGN TO P-FILE-PATH
           ORGANIZATION IS LINE SEQUENTIAL                                                        ORGANIZATION IS LINE SEQUENTIAL
           FILE STATUS IS JURAD-FS.                                                               FILE STATUS IS JURAD-FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
       SELECT ERRS ASSIGN TO ERRS-FILE-NAME                                                   SELECT ERRS ASSIGN TO ERRS-FILE-NAME
           ORGANIZATION IS LINE SEQUENTIAL                                                        ORGANIZATION IS LINE SEQUENTIAL
           FILE STATUS IS ERRS-FS.                                                                FILE STATUS IS ERRS-FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
           COPY BDIIREGI.FS.                                                                      COPY BDIIREGI.FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
           COPY BDIIDIAN.FS.                                                                      COPY BDIIDIAN.FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
           COPY BDIIDAS.FS.                                                                       COPY BDIIDAS.FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
           COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD                              COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD
              FILE STATUS IS EST-BDIIALE.==.                                                         FILE STATUS IS EST-BDIIALE.==.

      ******************************************************************                     ******************************************************************
      * Archivos de base alterna                                                             * Archivos de base alterna
      ******************************************************************                     ******************************************************************
           copy BDACSV.FS.                                                                        copy BDACSV.FS.
           copy ICBDIR.FS.                                                                        copy ICBDIR.FS.
           copy BDLCLI.FS.                                                                        copy BDLCLI.FS.
           COPY ICBSUS.FS.                                                                        COPY ICBSUS.FS.
           COPY ICBCHK.FS.                                                                        COPY ICBCHK.FS.
           COPY ICBCRE.FS.                                                                        COPY ICBCRE.FS.
           COPY BDLSTDCIU.FS.                                                                     COPY BDLSTDCIU.FS.
           COPY DIREST.FS.                                                                        COPY DIREST.FS.
           COPY BDLNEWDIRBOG.FS.                                                                  COPY BDLNEWDIRBOG.FS.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
       DATA DIVISION.                                                                         DATA DIVISION.
       FILE section.                                                                          FILE section.

      ******************************************************************                     ******************************************************************
      * Archivo de entrada con los datos de demandas y embargos de JURAD                     * Archivo de entrada con los datos de demandas y embargos de JURAD
      ******************************************************************                     ******************************************************************
       FD JURAD.                                                                              FD JURAD.
       01  JURAD-reg.                                                                         01  JURAD-reg.
      * Registros de movimientos I, M, E                                                     * Registros de movimientos I, M, E
      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim                                        *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
           03 JURAD-TIPO-NOVEDAD          PIC X.                                                  03 JURAD-TIPO-NOVEDAD          PIC X.
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                        *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 JURAD-ID-TIPO               PIC X.                                                  03 JURAD-ID-TIPO               PIC X.
      *    Numero de identificacion                                                          *    Numero de identificacion
           03 JURAD-ID-NUMEROX            PIC X(11).                                              03 JURAD-ID-NUMEROX            PIC X(11).
           03 JURAD-ID-NUMERO           REDEFINES JURAD-ID-NUMEROX                                03 JURAD-ID-NUMERO             REDEFINES JURAD-ID-NUMEROX
                                          PIC 9(11).                                                                             PIC 9(11).
      *    Nombres y Apellidos                                                               *    Nombres y Apellidos
           03 JURAD-NOMBRE                PIC X(45).                                              03 JURAD-NOMBRE                PIC X(45).
      *    Numero de demandas vigentes                                                       *    Numero de demandas vigentes
      *    03 JURAD-DEMANDAS-VIGENTES     PIC 999.                                  <  
           03 JURAD-DEMANDAS-VIGENTES     PIC 9(07).                                              03 JURAD-DEMANDAS-VIGENTES     PIC 9(07).
      *    Numero de demandas terminadas                                                     *    Numero de demandas terminadas
      *    03 JURAD-DEMANDAS-TERMINADAS   PIC 999.                                  <  
           03 JURAD-DEMANDAS-TERMINADAS   PIC 9(07).                                              03 JURAD-DEMANDAS-TERMINADAS   PIC 9(07).
      *    Fecha ultima demanda vigente YYYYMMDD                                             *    Fecha ultima demanda vigente YYYYMMDD
           03 JURAD-DEMANDAS-FECHA-ULTIMA PIC X(8).                                               03 JURAD-DEMANDAS-FECHA-ULTIMA PIC X(8).
      *    Numero de embargos vigentes                                                       *    Numero de embargos vigentes
      *    03 JURAD-EMBARGOS-VIGENTES     PIC 999.                                  <  
           03 JURAD-EMBARGOS-VIGENTES     PIC 9(07).                                              03 JURAD-EMBARGOS-VIGENTES     PIC 9(07).
      *    Numero de embargos terminados                                                     *    Numero de embargos terminados
      *    03 JURAD-EMBARGOS-TERMINADOS   PIC 999.                                  <  
           03 JURAD-EMBARGOS-TERMINADOS   PIC 9(07).                                              03 JURAD-EMBARGOS-TERMINADOS   PIC 9(07).
      *    Fecha ultimo embargo vigente YYYYMMDD                                             *    Fecha ultimo embargo vigente YYYYMMDD
           03 JURAD-EMBARGOS-FECHA-ULTIMO PIC X(08).                                              03 JURAD-EMBARGOS-FECHA-ULTIMO PIC X(08).

       01  JURADT-REG.                                                                        01  JURADT-REG.
      * Registro de totales de control T                                                     * Registro de totales de control T
      *    Tipo de Novedad = "T"                                                             *    Tipo de Novedad = "T"
           03 JURADT-TIPO-NOVEDAD         PIC X.                                                  03 JURADT-TIPO-NOVEDAD         PIC X.
           03                             PIC X.                                                  03                             PIC X.
      *    Cantidad de registros                                                             *    Cantidad de registros
           03 JURADT-REGISTROS            PIC 9(11).                                              03 JURADT-REGISTROS            PIC 9(11).
      *    03                             PIC X.                                    <  
           03                             PIC X(45).                                              03                             PIC X(45).
      *    Total numero de demandas vigentes                                                 *    Total numero de demandas vigentes
           03 JURADT-DEMANDAS-VIGENTES    PIC 9(7).                                               03 JURADT-DEMANDAS-VIGENTES    PIC 9(7).
      *    03                             PIC X.                                    <  
      *    Total numero de demandas terminadas                                               *    Total numero de demandas terminadas
           03 JURADT-DEMANDAS-TERMINADAS  PIC 9(7).                                               03 JURADT-DEMANDAS-TERMINADAS  PIC 9(7).
      *    03                             PIC X.                                    <  
           03                             PIC X(08).                                              03                             PIC X(08).
      *    Total numero de embargos vigentes                                                 *    Total numero de embargos vigentes
           03 JURADT-EMBARGOS-VIGENTES    PIC 9(7).                                               03 JURADT-EMBARGOS-VIGENTES    PIC 9(7).
      *    03                             PIC X.                                    <  
      *    Total numero de embargos terminados                                               *    Total numero de embargos terminados
           03 JURADT-EMBARGOS-TERMINADOS  PIC 9(7).                                               03 JURADT-EMBARGOS-TERMINADOS  PIC 9(7).
           03                             PIC X(08).                                              03                             PIC X(08).

      ******************************************************************                     ******************************************************************
      * Archivo de salida con los registros defectuosos del arch JURAD                       * Archivo de salida con los registros defectuosos del arch JURAD
      ******************************************************************                     ******************************************************************
       FD ERRS.                                                                               FD ERRS.
       01  ERRS-REG.                                                                          01  ERRS-REG.
      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales                             *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
           03 ERRS-TIPO-NOVEDAD          PIC X.                                                   03 ERRS-TIPO-NOVEDAD          PIC X.
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                        *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 ERRS-ID-TIPO               PIC X.                                                   03 ERRS-ID-TIPO               PIC X.
      *    Numero de identificacion                                                          *    Numero de identificacion
           03 ERRS-ID-NUMERO             PIC X(11).                                               03 ERRS-ID-NUMERO             PIC X(11).
      *    Nombres y Apellidos                                                               *    Nombres y Apellidos
           03 ERRS-NOMBRE                PIC X(45).                                               03 ERRS-NOMBRE                PIC X(45).
      *    Numero de demandas vigentes                                                       *    Numero de demandas vigentes
      *    03 ERRS-DEMANDAS-VIGENTES     PIC 999.                                            *    03 ERRS-DEMANDAS-VIGENTES     PIC 999.
           03 ERRS-DEMANDAS-VIGENTES     PIC 9(07).                                               03 ERRS-DEMANDAS-VIGENTES     PIC 9(07).
      *    Numero de demandas terminadas                                                     *    Numero de demandas terminadas
      *    03 ERRS-DEMANDAS-TERMINADAS   PIC 999.                                            *    03 ERRS-DEMANDAS-TERMINADAS   PIC 999.
           03 ERRS-DEMANDAS-TERMINADAS   PIC 9(07).                                               03 ERRS-DEMANDAS-TERMINADAS   PIC 9(07).
      *    Fecha ultima demanda vigente YYMMDD                                               *    Fecha ultima demanda vigente YYMMDD
           03 ERRS-DEMANDAS-FECHA-ULTIMA PIC X(8).                                                03 ERRS-DEMANDAS-FECHA-ULTIMA PIC X(8).
      *    Numero de embargos vigentes                                                       *    Numero de embargos vigentes
      *    03 ERRS-EMBARGOS-VIGENTES     PIC 999.                                            *    03 ERRS-EMBARGOS-VIGENTES     PIC 999.
           03 ERRS-EMBARGOS-VIGENTES     PIC 9(07).                                               03 ERRS-EMBARGOS-VIGENTES     PIC 9(07).
      *    Numero de embargos terminados                                                     *    Numero de embargos terminados
      *    03 ERRS-EMBARGOS-TERMINADOS   PIC 999.                                            *    03 ERRS-EMBARGOS-TERMINADOS   PIC 999.
           03 ERRS-EMBARGOS-TERMINADOS   PIC 9(07).                                               03 ERRS-EMBARGOS-TERMINADOS   PIC 9(07).
      *    Fecha ultimo embargo vigente YYMMDD                                               *    Fecha ultimo embargo vigente YYMMDD
           03 ERRS-EMBARGOS-FECHA-ULTIMO PIC X(8).                                                03 ERRS-EMBARGOS-FECHA-ULTIMO PIC X(8).
      *    Causa del rechazo                                                                 *    Causa del rechazo
           03 ERRS-CAUSA-RECHAZO         PIC X(61).                                 |             03 ERRS-CAUSA-RECHAZO         PIC X(300).

      ******************************************************************                     ******************************************************************
      * Contiene los ids y nombres de personas                                               * Contiene los ids y nombres de personas
      ******************************************************************                     ******************************************************************
       COPY BDIIREGI.FD.                                                                      COPY BDIIREGI.FD.

      ******************************************************************                     ******************************************************************
      * Maestro de personas juridicas nacionales y extranjeras reportada                     * Maestro de personas juridicas nacionales y extranjeras reportada
      * por la DIAN                                                                          * por la DIAN
      ******************************************************************                     ******************************************************************
       COPY BDIIDIAN.FD.                                                                      COPY BDIIDIAN.FD.

      ******************************************************************                     ******************************************************************
      * Archivo maestro de cedulas de extranjeria suministrado por DAS                       * Archivo maestro de cedulas de extranjeria suministrado por DAS
      ******************************************************************                     ******************************************************************
       COPY BDIIDAS.FD.                                                                       COPY BDIIDAS.FD.

      ******************************************************************                     ******************************************************************
      * Archivos de base alterna                                                             * Archivos de base alterna
      ******************************************************************                     ******************************************************************
           COPY BDACSV.FD.                                                                        COPY BDACSV.FD.
           COPY ICBDIR0001.FD.                                                                    COPY ICBDIR0001.FD.
           COPY BDLCLI.FD.                                                                        COPY BDLCLI.FD.
           COPY ICBSUS.FD.                                                                        COPY ICBSUS.FD.
           COPY ICBCHK.FD.                                                                        COPY ICBCHK.FD.
           COPY ICBCRE.FD.                                                                        COPY ICBCRE.FD.
           COPY BDLSTDCIU.FD.                                                                     COPY BDLSTDCIU.FD.
           COPY DIREST.FD.                                                                        COPY DIREST.FD.
           COPY BDLNEWDIRBOG.FD.                                                                  COPY BDLNEWDIRBOG.FD.

      ******************************************************************                     ******************************************************************
      * Maestro de alertas reportadas por suscriptores                                       * Maestro de alertas reportadas por suscriptores
      ******************************************************************                     ******************************************************************
       COPY BDIIALE.FD.                                                                       COPY BDIIALE.FD.

      ******************************************************************                     ******************************************************************
       WORKING-STORAGE SECTION.                                                               WORKING-STORAGE SECTION.
      ******************************************************************                     ******************************************************************
      * Nombre del programa                                                                  * Nombre del programa
       01  PGM                          PIC X(10) VALUE "CARGAJUR".                           01  PGM                          PIC X(10) VALUE "CARGAJUR".


      ******************************************************************                     ******************************************************************
      * Datos para la búsqueda en base alterna                                               * Datos para la búsqueda en base alterna
       01  W-DERECHOS                   PIC 9 value 0.                              |         01  W-DERECHOS                   PIC 9 VALUE 0.
       01  CODIGO-ERROR                 pic 99 value 00.                            |         01  CODIGO-ERROR                 PIC 99 VALUE 00.

       01  SW-BDIIALE                   pic 9 value 0.                              |         01  SW-BDIIALE                   PIC 9 VALUE 0.
       01  HACER-MATCH                  PIC 9 value 0.                              |         01  HACER-MATCH                  PIC 9 VALUE 0.
       01  CADENA-ENTRA                 PIC X(60).                                            01  CADENA-ENTRA                 PIC X(60).
       01  CADENA-SALE                  PIC X(60).                                            01  CADENA-SALE                  PIC X(60).
       01  IND-ALFABETICO              PIC  X(01).                                            01  IND-ALFABETICO              PIC  X(01).
           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"                           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"
                                            "G" "H" "I" "J" "K" "L" "M"             |                                         "G" "H" "I" "J" "K" "L" "M" "N"
                                            "N" "/" "O" "P" "Q" "R" "S"             |                                         "/" "O" "P" "Q" "R" "S" "T" "U"
                                            "T" "U" "V" "W" "X" "Y" "Z"             |                                         "V" "W" "X" "Y" "Z" "Ñ".
                                            "Ñ".                                    <  

       01  DATOS-E.                                                                           01  DATOS-E.
           03 TIPOID-E                  pic 9.                                      |             03 TIPOID-E                  PIC 9.
           03 NUMID-E                   pic 9(11).                                  |             03 NUMID-E                   PIC 9(11).
           03 NOMBRE-E                  pic x(45).                                  |             03 NOMBRE-E                  PIC x(45).

       01  W-CONTADORES.                                                                      01  W-CONTADORES.
           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-5            PIC 9(6) VALUE ZERO.
           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-6            PIC 9(6) VALUE ZERO.
           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-7            PIC 9(6) VALUE ZERO.
           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZERO.
           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.                       |             03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZERO.

       01  SUSCRIPTOR-AUX               PIC 9(06).                                  |         01  SUSCRIPTOR-AUX               PIC 9(6).
       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.                      |         01  REG-MAL-FORMADOS             PIC 9(7) VALUE ZERO.
       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.                      |         01  REG-LEIDOS                   PIC 9(7) VALUE ZERO.
       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.                      |         01  CONT-FALLECIDOS              PIC 9(7) VALUE ZERO.
       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.                      |         01  REG-CORRECTOS                PIC 9(7) VALUE ZERO.
       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.                      |         01  NO-COINCIDE-DIAN             PIC 9(7) VALUE ZERO.
       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.                      |         01  NO-COINCIDE-REGIS            PIC 9(7) VALUE ZERO.
       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.                      |         01  NO-EXISTE-DIAN               PIC 9(7) VALUE ZERO.
       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.                      |         01  NO-EXISTE-REGIS              PIC 9(7) VALUE ZERO.
       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.                      |         01  SI-EXISTE-CSV                PIC 9(7) VALUE ZERO.
       01  NUM-ID-W                     PIC 9(11) VALUE ZEROS.                      |         01  TIPO-ID-INVALIDO             PIC 9(7) VALUE ZERO.
                                                                                    >         01  NUM-ID-W                     PIC 9(11) VALUE ZERO.
       01  FECHA-PROC.                                                                        01  FECHA-PROC.
           03 ANO-HOY.                                                                            03 ANO-HOY.
              05 SIG-PROC           PIC X(2).                                                        05 SIG-PROC               PIC X(2).
              05 ANO-PROC           PIC X(2).                                                        05 ANO-PROC               PIC X(2).
           03 MES-PROC              PIC X(2).                                                     03 MES-PROC                  PIC X(2).
           03 DIA-PROC              PIC X(2).                                                     03 DIA-PROC                  PIC X(2).
       01  FECHA-PROC-R  REDEFINES FECHA-PROC                                                 01  FECHA-PROC-R                 REDEFINES FECHA-PROC
                                    PIC X(8).                                                                                  PIC X(8).

       01 MAS-DATOS.                                                                          01 MAS-DATOS.
           03 I                         PIC 9(02) VALUE ZERO.                                     03 I                         PIC 9(02) VALUE ZERO.
           03 J                         PIC 9(02) VALUE ZERO.                                     03 J                         PIC 9(02) VALUE ZERO.

           COPY  BDLDIR.WS.                                                                       COPY  BDLDIR.WS.

      ******************************************************************                     ******************************************************************
      * Variables para rutina de validacion de identificaciones                              * Variables para rutina de validacion de identificaciones
      ******************************************************************                     ******************************************************************
           COPY BDIIVIDE.WS.                                                                      COPY BDIIVIDE.WS.

      ******************************************************************                     ******************************************************************
      * Variables relacionadas con la la base BDIIALE de alertas online                      * Variables relacionadas con la la base BDIIALE de alertas online
      ******************************************************************                     ******************************************************************
           COPY BDIIALE.WS.                                                                       COPY BDIIALE.WS.

      ******************************************************************                     ******************************************************************
      * Datos para las rutinas de validación de nombres                                      * Datos para las rutinas de validación de nombres
      ******************************************************************                     ******************************************************************
           COPY VALNOM.WS.                                                                        COPY VALNOM.WS.

      *****************************************************************                      *****************************************************************
      * Direcciones de los archivos en el file system                                        * Direcciones de los archivos en el file system
      *****************************************************************                      *****************************************************************
       COPY ICFILE.WS.                                                                        COPY ICFILE.WS.

      *****************************************************************                      *****************************************************************
      * Variables validacion cuentas si validar                                              * Variables validacion cuentas si validar
      *****************************************************************                      *****************************************************************
           COPY BDAMATCH.WS.                                                                      COPY BDAMATCH.WS.

      ******************************************************************                     ******************************************************************
      * Indica que se termino el proceso, por agotamiento del archivo                        * Indica que se termino el proceso, por agotamiento del archivo
      * de entrada (normal) o alguna otra condicion (error)                                  * de entrada (normal) o alguna otra condicion (error)
       01  IND-FIN-PROCESO              PIC XX VALUE "NO".                                    01  IND-FIN-PROCESO              PIC XX VALUE "NO".

      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)                          * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
       01  JURAD-REG-ANTERIOR           PIC X(100) VALUE "(VACIO)".                           01  JURAD-REG-ANTERIOR           PIC X(100) VALUE "(VACIO)".
       01  JURAD-FS                     PIC XX VALUE SPACES.                                  01  JURAD-FS                     PIC XX VALUE SPACES.
       01  ERRS-FS                      PIC XX VALUE SPACES.                                  01  ERRS-FS                      PIC XX VALUE SPACES.

      * Datos de demandas o embargos que van en el registro BDIIALE                          * Datos de demandas o embargos que van en el registro BDIIALE
       01 D-DATAHOST.                                                                         01 D-DATAHOST.
           05 D-VIGENTES                PIC 9(5).                                                 05 D-VIGENTES                PIC 9(5).
           05 D-TERMINADOS              PIC 9(5).                                                 05 D-TERMINADOS              PIC 9(5).
           05 D-FECHA-ULTIMA            PIC X(8).                                                 05 D-FECHA-ULTIMA            PIC X(8).
      ******************************************************************                     ******************************************************************
      * Parametros iniciales, de la linea de comando                                         * Parametros iniciales, de la linea de comando
      * La linea de comando que contiene los parametros                                      * La linea de comando que contiene los parametros
       01 P-COMMAND-LINE                PIC X(80) VALUE SPACES.                               01 P-COMMAND-LINE                PIC X(80) VALUE SPACES.
       01 P-PARAMETROS.                                                                       01 P-PARAMETROS.
      *    Proceso real: contiene "1" para activar, "2" por defecto                          *    Proceso real: contiene "1" para activar, "2" por defecto
           03 P-PROCESO-REAL            PIC X VALUE "2".                                          03 P-PROCESO-REAL            PIC X VALUE "2".
           88 PROCESO-REAL              VALUE "2".                                                88 PROCESO-REAL              VALUE "2".

      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt                             *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
           03 P-FILE-NAME               PIC X(80) VALUE SPACES.                                   03 P-FILE-NAME               PIC X(80) VALUE SPACES.
           03 P-FILE-NAME-R             REDEFINES P-FILE-NAME.                                    03 P-FILE-NAME-R             REDEFINES P-FILE-NAME.
      *        JJJJJJ = Codigo de suscriptor JURAD en Experian                               *        JJJJJJ = Codigo de suscriptor JURAD en Experian
               05 P-COD-SUSCRIPTOR      PIC 9(6).                                                     05 P-COD-SUSCRIPTOR      PIC 9(6).
      *        aaa = Codificacion del producto ("100")                                       *        aaa = Codificacion del producto ("100")
               05 P-PRODUCTO            PIC XXX.                                                      05 P-PRODUCTO            PIC XXX.
      *        DDMMAA = Fecha de proceso                                                     *        DDMMAA = Fecha de proceso
               05 P-FECHA-PROCESO       PIC X(6).                                                     05 P-FECHA-PROCESO       PIC X(6).
      *        bb =  01 a CI                                                                 *        bb =  01 a CI
               05 P-CI-BI               PIC XX.                                                       05 P-CI-BI               PIC XX.
      *        XX = Tipo de proceso                                                          *        XX = Tipo de proceso
      *        01 Envio Original - Carga TOTAL - primera vez                                 *        01 Envio Original - Carga TOTAL - primera vez
      *        02 Archivo Semanal - Carga PARCIAL                                            *        02 Archivo Semanal - Carga PARCIAL
      *        03 Archivo Mensual - Carga PARCIAL                                            *        03 Archivo Mensual - Carga PARCIAL
      *        04 Refresque Total - Carga TOTAL                                              *        04 Refresque Total - Carga TOTAL
               05 P-TIPO-PROCESO        PIC XX.                                                       05 P-TIPO-PROCESO        PIC XX.
      *        extension del archivo ".txt"                                                  *        extension del archivo ".txt"
               05 P-EXTENSION           PIC X(4).                                                     05 P-EXTENSION           PIC X(4).
               05                       PIC X(57).                                                    05                       PIC X(57).
           03 P-FILE-PATH               PIC X(80) VALUE SPACES.                                   03 P-FILE-PATH               PIC X(80) VALUE SPACES.
      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs                               * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs
          03 ERRS-FILE-NAME             PIC X(80) VALUE SPACES.                                  03 ERRS-FILE-NAME             PIC X(80) VALUE SPACES.

      * Fecha de proceso editada YYYYMMDD                                                    * Fecha de proceso editada YYYYMMDD
       01 P-FECHA-PROCESO-YYYYMMDD      PIC X(8).                                             01 P-FECHA-PROCESO-YYYYMMDD      PIC X(8).
      * Fecha de proceso + 50 años                                                           * Fecha de proceso + 50 años
       01 P-FECHA-PROCESO-50.                                                                 01 P-FECHA-PROCESO-50.
           03  P-FECHA-PROCESO-50YYYY   PIC 9999.                                                 03  P-FECHA-PROCESO-50YYYY   PIC 9999.
           03                           PIC X(4).                                                 03                           PIC X(4).
      ******************************************************************                     ******************************************************************
      * Datos para el reporte final                                                          * Datos para el reporte final
       01 W-TIEMPO.                                                                           01 W-TIEMPO.
           03 W-HORA-INICIO             PIC 9(8).                                                 03 W-HORA-INICIO             PIC 9(8).
           03 W-HORA-FIN                PIC 9(8).                                                 03 W-HORA-FIN                PIC 9(8).
       01 N-EDIT                        PIC Z(8)B.                                  |         01 N-EDIT                        PIC Z(7)9B.
       01 N-EDITP100                    REDEFINES N-EDIT                                      01 N-EDITP100                    REDEFINES N-EDIT
                                        PIC Z(5)9.9B.                                                                          PIC Z(5)9.9B.
       01 N-CONTADORES.                                                                       01 N-CONTADORES.
      *    Registros en el archivo de entrada                                                *    Registros en el archivo de entrada
           03 N-REG-LEIDOS              PIC 9(8) VALUE ZERO.                                      03 N-REG-LEIDOS              PIC 9(8) VALUE ZERO.
      *    Registros procesados sin error                                                    *    Registros procesados sin error
           03 N-REG-OK                  PIC 9(8) VALUE ZERO.                        |             03 N-REG-PROCESADOS          PIC 9(8) VALUE ZERO.
      *    Registros con error                                                               *    Registros con error
           03 N-REG-CON-ERROR           PIC 9(8) VALUE ZERO.                                      03 N-REG-CON-ERROR           PIC 9(8) VALUE ZERO.

      *    Cantidades de registros por tipo de novedad                                       *    Cantidades de registros por tipo de novedad
           03 N-REG-TIPO-I-OK           PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-I-OK           PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-M-OK           PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-M-OK           PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-E-OK           PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-E-OK           PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-I-ERR          PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-I-ERR          PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-M-ERR          PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-M-ERR          PIC 9(8) VALUE ZERO.
           03 N-REG-TIPO-E-ERR          PIC 9(8) VALUE ZERO.                                      03 N-REG-TIPO-E-ERR          PIC 9(8) VALUE ZERO.

      *    Alertas borradas previo al refresque total                                        *    Alertas borradas previo al refresque total
           03 N-ALE-LEIDAS              PIC 9(8) VALUE ZERO.                        <  
           03 N-ALE-BORRADAS            PIC 9(8) VALUE ZERO.                                      03 N-ALE-BORRADAS            PIC 9(8) VALUE ZERO.
      *    Alertas insertadas                                                                *    Alertas insertadas
           03 N-ALE-INSERTADAS          PIC 9(8) VALUE ZERO.                                      03 N-ALE-INSERTADAS          PIC 9(8) VALUE ZERO.
      *    Alertas modificadas                                                               *    Alertas modificadas
           03 N-ALE-MODIFICADAS         PIC 9(8) VALUE ZERO.                                      03 N-ALE-MODIFICADAS         PIC 9(8) VALUE ZERO.
      *    Alertas eliminadas                                                                *    Alertas eliminadas
           03 N-ALE-ELIMINADAS          PIC 9(8) VALUE ZERO.                                      03 N-ALE-ELIMINADAS          PIC 9(8) VALUE ZERO.
      *    Insercion de alerta existente                                                     *    Insercion de alerta existente
           03 N-ALE-YA-EXISTE           PIC 9(8) VALUE ZERO.                                      03 N-ALE-YA-EXISTE           PIC 9(8) VALUE ZERO.
      *    Modificacion o eliminacion de alerta inexistente                                  *    Modificacion o eliminacion de alerta inexistente
           03 N-ALE-NO-EXISTE           PIC 9(8) VALUE ZERO.                                      03 N-ALE-NO-EXISTE           PIC 9(8) VALUE ZERO.

      *    Sumas de cantidades de demandas y embargos                                        *    Sumas de cantidades de demandas y embargos
           03 N-DEMANDAS-VIGENTES       PIC 9(7) VALUE ZERO.                                      03 N-DEMANDAS-VIGENTES       PIC 9(7) VALUE ZERO.
           03 N-DEMANDAS-TERMINADAS     PIC 9(7) VALUE ZERO.                                      03 N-DEMANDAS-TERMINADAS     PIC 9(7) VALUE ZERO.
           03 N-EMBARGOS-VIGENTES       PIC 9(7) VALUE ZERO.                                      03 N-EMBARGOS-VIGENTES       PIC 9(7) VALUE ZERO.
           03 N-EMBARGOS-TERMINADOS     PIC 9(7) VALUE ZERO.                                      03 N-EMBARGOS-TERMINADOS     PIC 9(7) VALUE ZERO.

      ******************************************************************                     ******************************************************************
      * Armado de las lineas de alerta                                              <  
       01 LA-LINEAS-ALERTA.                                                         <  
      *    Los modelos a continuacion deberan obtenerse de un                       <  
      *    archivo, como BDIIALE-ALERTAS                                            <  
           03 LAEND                     PIC 999 COMP VALUE 0.                       <  
           03 LA-MODELOS.                                                           <  
      *         12345678901234567890123456789012345678901234567890                  <  
               05 PIC X(50) VALUE                                                   <  
               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".                <  
               05 PIC X(50) VALUE                                                   <  
               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".                 <  
               05 PIC X(50) VALUE                                                   <  
               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".                <  
               05 PIC X(50) VALUE                                                   <  
               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".                <  
               05 PIC X(50) VALUE HIGH-VALUES. *> END MARKER                        <  
           03 LA-MODELOS2               REDEFINES LA-MODELOS.                       <  
               05 LA-MODELO             PIC X(50) OCCURS 5                          <  
                                        INDEXED LAM.                                <  
      *    Funcionamiento de los templates.                                         <  
      *    Hay dos templates por de alerta, uno por linea.                          <  
      *    Cada template consiste en hasta 10 frases fijas con                      <  
      *    ampersands (&) donde se van a reemplazar los valores.                    <  
      *    Por ejemplo:                                                             <  
      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS                               <  
      *    tiene 3 frases fijas y 2 reemplazos.                                     <  
      *    La cantidad de ampersands es irrelevante, pero parece                    <  
      *    conveniente que informe sobre el tamaño del contenido.                   <  
           03 LA-TEMPLATES.                                                         <  
               05 LA-TEMPLATE           OCCURS 4 INDEXED LAX.                       <  
                   07 LA-PARTE          PIC X(50)                                   <  
                                        OCCURS 10 INDEXED LAY.                      <  
      *    Las dos lineas armadas                                                   <  
           03 LA-LINEAS.                                                            <  
               05 LA-LINEA1             PIC X(50).                                  <  
               05 LA-LINEA2             PIC X(50).                                  <  
      *    Los valores a insertar en una linea                                      <  
           03 LA-VALORES.                                                           <  
               05 LA-VALOR              PIC X(50)                                   <  
                                        OCCURS 10 INDEXED LAV.                      <  
      *    Datos para editar valores a insertar                                     <  
           03 LA-NUM                    PIC -(11)0.                                 <  
           03 LA-NUMX                   REDEFINES LA-NUM                            <  
                                        PIC X(12).                                  <  
           03 LA-DESCARTE               PIC X(50).                                  <  
                                                                                    <  
                                                                                    <  
      ******************************************************************            <  
      * Errores de consistencia del input                                                    * Errores de consistencia del input
      * Cada error tiene un codigo de 2 digitos, un espacio, contador               |        * Cada error tiene 70 caracteres:
      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59                |        *     codigo de 2 digitos,
                                                                                    >        *     indicador de impactar BDIIALE aunque haya este error "+"
                                                                                    >        *     un espacio en blanco
                                                                                    >        *     contador de ocurrencias de 7 digitos
                                                                                    >        *     un espacio en blanco, y 
                                                                                    >        *     descripcion de 59 caractares
       01 E-ERRORES.                                                                          01 E-ERRORES.
      *    indica si el registro actual tiene error                                          *    indica si el registro actual tiene error
           03 E-HAY-ERROR               PIC XX VALUE "NO".                                        03 E-HAY-ERROR               PIC XX VALUE "NO".
                                                                                    >        *    indica si el registro actual impacta la base de datos
                                                                                    >             03 E-IMPACTAR-BDIIALE        PIC XX VALUE "SI".
      *    errores del registro actual                                                       *    errores del registro actual
           03 E-ERRORES-REG             PIC X(300) VALUE SPACES.                                  03 E-ERRORES-REG             PIC X(300) VALUE SPACES.
      *    contador de registros con error                                                   *    contador de registros con error
           03 E-CONT-REGS-CON-ERROR     PIC 9(8) VALUE ZERO.                                      03 E-CONT-REGS-CON-ERROR     PIC 9(8) VALUE ZERO.
      *    tabla de errores                                                                  *    tabla de errores
           03 PIC X(11) VALUE "01 0000000 ".                                                      03 PIC X(11) VALUE "01 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Tipo de movimiento invalido, debe ser I M E T".                                       "Tipo de movimiento invalido, debe ser I M E T".
                                                                                    >  
           03 PIC X(11) VALUE "02 0000000 ".                                                      03 PIC X(11) VALUE "02 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Tipo de identificacion invalido, debe ser 1 2 3 4".                                   "Tipo de identificacion invalido, debe ser 1 2 3 4".
                                                                                    >  
           03 PIC X(11) VALUE "03 0000000 ".                                                      03 PIC X(11) VALUE "03 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de identificacion invalido, debe ser numerico".                                "Numero de identificacion invalido, debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "04 0000000 ".                                                      03 PIC X(11) VALUE "04 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Tipo de identificacion debe ser mayor que cero".                                      "Tipo de identificacion debe ser mayor que cero".
                                                                                    >  
           03 PIC X(11) VALUE "05 0000000 ".                                                      03 PIC X(11) VALUE "05 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Falta el nombre o denominacion".                                                      "Falta el nombre o denominacion".
                                                                                    >  
           03 PIC X(11) VALUE "06 0000000 ".                                                      03 PIC X(11) VALUE "06 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de demandas vigentes: debe ser numerico".                                      "Numero de demandas vigentes: debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "07 0000000 ".                                                      03 PIC X(11) VALUE "07 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de demandas terminadas: debe ser numerico".                                    "Numero de demandas terminadas: debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "08 0000000 ".                                                      03 PIC X(11) VALUE "08 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".                            "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
                                                                                    >  
           03 PIC X(11) VALUE "09 0000000 ".                                                      03 PIC X(11) VALUE "09 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".                               "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
                                                                                    >  
           03 PIC X(11) VALUE "10 0000000 ".                                                      03 PIC X(11) VALUE "10 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de embargos vigentes: debe ser numerico".                                      "Numero de embargos vigentes: debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "11 0000000 ".                                                      03 PIC X(11) VALUE "11 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de embargos terminados: debe ser numerico".                                    "Numero de embargos terminados: debe ser numerico".
                                                                                    >  
           03 PIC X(11) VALUE "12 0000000 ".                                                      03 PIC X(11) VALUE "12 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".                            "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
                                                                                    >  
           03 PIC X(11) VALUE "13 0000000 ".                                                      03 PIC X(11) VALUE "13 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".                               "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
           03 PIC X(11) VALUE "14 0000000 ".                                        |  
                                                                                    >             03 PIC X(11) VALUE "14+0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "El numero de id no se encuentra en el archivo maestro".                 |             "El id no se encuentra en el archivo maestro (tipo 7)".
                                                                                    >  
           03 PIC X(11) VALUE "15 0000000 ".                                                      03 PIC X(11) VALUE "15 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "El nombre en el input no coincide con el registrado".                                 "El nombre en el input no coincide con el registrado".
                                                                                    >  
           03 PIC X(11) VALUE "16 0000000 ".                                                      03 PIC X(11) VALUE "16 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Numero de id fuera del rango del tipo de id informado".                               "Numero de id fuera del rango del tipo de id informado".
                                                                                    >  
           03 PIC X(11) VALUE "17 0000000 ".                                                      03 PIC X(11) VALUE "17 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Modificación de alerta que no existe".                                                "Modificación de alerta que no existe".
                                                                                    >  
           03 PIC X(11) VALUE "18 0000000 ".                                                      03 PIC X(11) VALUE "18 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Eliminación de alerta que no existe".                                                 "Eliminación de alerta que no existe".
                                                                                    >  
           03 PIC X(11) VALUE "19 0000000 ".                                                      03 PIC X(11) VALUE "19 0000000 ".
           03 PIC X(59) VALUE                                                                     03 PIC X(59) VALUE
           "Inserción de alerta que ya existe".                                                   "Inserción de alerta que ya existe".
           03 PIC X(11) VALUE "20 0000000 ".                                        <  
           03 PIC X(59) VALUE                                                       <  
           "Tipo de Identificacion 7".                                              <  
      *----------------- insertar nuevos items aqui -------------------                      *----------------- insertar nuevos items aqui -------------------
           03 PIC X(11) VALUE "00 0000000 ".                                                      03 PIC X(11) VALUE "00 0000000 ".
           03 PIC X(59) VALUE "--- FIN DE LA LISTA (COD 00) ---".                                 03 PIC X(59) VALUE "--- FIN DE LA LISTA (COD 00) ---".
           03                           PIC X(3500). *> LOS 50 ITEMS                              03                           PIC X(3500). *> LOS 50 ITEMS
       01 E-ERRORES-2                   REDEFINES E-ERRORES.                                  01 E-ERRORES-2                   REDEFINES E-ERRORES.
           03                           PIC XX.                                                   03                           PIC XX.
                                                                                    >             03                           PIC XX.
           03                           PIC X(300).                                               03                           PIC X(300).
           03                           PIC 9(8).                                                 03                           PIC 9(8).
           03 E-ERROR                   OCCURS 50 INDEXED EX.                                     03 E-ERROR                   OCCURS 50 INDEXED EX.
               05 E-CODIGO              PIC XX.                                                       05 E-CODIGO              PIC XX.
               05                       PIC X.                                      |                 05 E-IMPACTAR            PIC X.
               05 E-CONTADOR            PIC 9(7).                                                     05 E-CONTADOR            PIC 9(7).
               05                       PIC X.                                                        05                       PIC X.
               05 E-DESCRIPCION         PIC X(59).                                                    05 E-DESCRIPCION         PIC X(59).
       01 E-EDIT                        PIC Z(8)B.                                            01 E-EDIT                        PIC Z(8)B.

      ******************************************************************                     ******************************************************************
      * Control de rangos de valores de las fechas del input                                 * Control de rangos de valores de las fechas del input
       01 VALIDACIONES-FECHAS.                                                                01 VALIDACIONES-FECHAS.
           02 ANO-VAL-X                 pic 9(04).                                  |             02 ANO-VAL-X                 pic 9(4).
              88 ANO-VAL                value 1900 thru 2050.                                        88 ANO-VAL                value 1900 thru 2050.
           02 MES-VAL-X                 pic 9(02).                                  |             02 MES-VAL-X                 pic 9(2).
              88 MES-VAL                value 01   thru 12.                                          88 MES-VAL                value 01 thru 12.
           02 DIA-VAL-X                 pic 9(02).                                  |             02 DIA-VAL-X                 pic 9(2).
              88 DIA-VAL                value 01   thru 31.                                          88 DIA-VAL                value 01 thru 31.


      /*****************************************************************                     /*****************************************************************
      ******************************************************************                     ******************************************************************
       PROCEDURE DIVISION.                                                                    PROCEDURE DIVISION.


       0000-PROGRAMA-PRINCIPAL.                                                               0000-PROGRAMA-PRINCIPAL.
      ******************************************************************                     ******************************************************************
      *    inicializa el ambiente y abre los archivos                                        *    inicializa el ambiente y abre los archivos
           PERFORM 1000-RUTINA-INICIAL                                                            PERFORM 1000-RUTINA-INICIAL
      *    procesa cada uno de los registros del archivo JURAD hasta                         *    procesa cada uno de los registros del archivo JURAD hasta
      *    encontrar el registro "T" de totales                                              *    encontrar el registro "T" de totales
           PERFORM 4000-PROCESAR-REGISTRO UNTIL IND-FIN-PROCESO = "SI"                            PERFORM 4000-PROCESAR-REGISTRO UNTIL IND-FIN-PROCESO = "SI"
      *    cierra archivos y produce el reporte final                                        *    cierra archivos y produce el reporte final
           PERFORM 7000-RUTINA-FINAL                                                              PERFORM 7000-RUTINA-FINAL
           GOBACK.                                                                                GOBACK.

       4000-PROCESAR-REGISTRO.                                                                4000-PROCESAR-REGISTRO.
      ****************************************************************                       ****************************************************************
      * Proceso de un registro del archivo de entrada JURAD                                  * Proceso de un registro del archivo de entrada JURAD
      * Lectura y control del file status del archivo                                        * Lectura y control del file status del archivo
      ****************************************************************                       ****************************************************************
      *    lectura del proximo registro                                                      *    lectura del proximo registro
           READ JURAD                                                                             READ JURAD
           EVALUATE JURAD-FS                                                                      EVALUATE JURAD-FS
           WHEN "00"                                                                              WHEN "00"
      *        CONTROLA EL REG Y LO APLICA SI ES OK                                          *        CONTROLA EL REG Y LO APLICA SI ES OK
                                                                                    >        D        display JURAD-REG
               PERFORM 4000-PROCESAR-REGISTRO-2                                                       PERFORM 4000-PROCESAR-REGISTRO-2
               MOVE JURAD-REG TO JURAD-REG-ANTERIOR                                                   MOVE JURAD-REG TO JURAD-REG-ANTERIOR
               IF JURAD-TIPO-NOVEDAD <> "T"                                                           IF JURAD-TIPO-NOVEDAD <> "T"
                  ADD 1 TO REG-LEIDOS                                                                    ADD 1 TO REG-LEIDOS
               END-IF                                                                                 END-IF
                                                                                    >        D        PERFORM DISPLAY-CONTADORES
           WHEN "10"                                                                              WHEN "10"
      *        FIN DEL ARCHIVO DE INPUT:                                            |        *        Fin del archivo de input:
      *        ESTO ES UN ERROR, NO SE ENCONTRO EL REGISTRO "T" ANTES               |        *        Esto es un error, no se encontro el registro "T" antes
      *        DE QUE SE TERMINARA EL ARCHIVO                                       |        *        de que se terminara el archivo
               DISPLAY "FALTA EL REG DE TOTALES DEL ARCHIVO JURAD "                                   DISPLAY "FALTA EL REG DE TOTALES DEL ARCHIVO JURAD "
               DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME                                             DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME
               DISPLAY "FILE STATUS: " JURAD-FS                                                       DISPLAY "FILE STATUS: " JURAD-FS
               DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS                                         DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS
               DISPLAY JURAD-REG-ANTERIOR                                                             DISPLAY JURAD-REG-ANTERIOR
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           WHEN OTHER                                                                             WHEN OTHER
      *        ERROR DE LECTURA: CANCELACION DEL PROCESO                            |        *        Error de lectura: cancelacion del proceso
               DISPLAY "ERROR EN LECTURA DEL ARCHIVO JURAD "                                          DISPLAY "ERROR EN LECTURA DEL ARCHIVO JURAD "
               DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME                                             DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME
               DISPLAY "FILE STATUS: " JURAD-FS                                                       DISPLAY "FILE STATUS: " JURAD-FS
               DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS                                         DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS
               DISPLAY JURAD-REG-ANTERIOR                                                             DISPLAY JURAD-REG-ANTERIOR
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.


       4000-PROCESAR-REGISTRO-2.                                                              4000-PROCESAR-REGISTRO-2.
      ****************************************************************                       ****************************************************************
      * Controla los datos de un registro de JURAD y si es OK lo usa                         * Controla los datos de un registro de JURAD y si es OK lo usa
      * para actualizar el archivo de alertas en linea                                       * para actualizar el archivo de alertas en linea
      * La informacion esta leida en JURAD-reg                                               * La informacion esta leida en JURAD-reg
                                                                                    >        * Hay dos indicadores: E-HAY-ERROR es si se encontró algún error
                                                                                    >        * en el registro, mientras que E-IMPACTAR-BDIIALE significa si
                                                                                    >        * los alertas se graban, independientemente de los errores 
                                                                                    >        * detectados (algunos errores no impiden la grabación)
      ****************************************************************                       ****************************************************************
           MOVE "NO" TO E-HAY-ERROR                                                               MOVE "NO" TO E-HAY-ERROR
                                                                                    >             MOVE "SI" TO E-IMPACTAR-BDIIALE
                                                                                    >             MOVE 00 TO CODIGO-ERROR

      *    VALIDACION DEL TIPO DE MOVIMIENTO                                        |        *    Validacion del tipo de movimiento
           IF JURAD-TIPO-NOVEDAD NOT = "I" AND "M" AND "E" AND "T"                                IF JURAD-TIPO-NOVEDAD NOT = "I" AND "M" AND "E" AND "T"
               CALL "PONERR" USING "01" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "01" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF

      *    SI ES EL REGISTRO "T" HAY QUE SEÑALAR EL FIN DE PROCESO                  |        *    Si es el registro "T" hay que señalar el fin de proceso
           IF JURAD-TIPO-NOVEDAD = "T"                                                            IF JURAD-TIPO-NOVEDAD = "T"
               MOVE "SI" TO IND-FIN-PROCESO                                                           MOVE "SI" TO IND-FIN-PROCESO
               PERFORM 4800-PROCESO-REG-T                                                             PERFORM 4800-PROCESO-REG-T
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF

           ADD 1 TO N-REG-LEIDOS                                                                  ADD 1 TO N-REG-LEIDOS

      *    VALIDACION FORMAL DE LOS DATOS                                           |        *    Validación formal: que los datos sean numéricos, etc ...
           MOVE 0 TO CODIGO-ERROR                                                   <  
      *                                                                             <  
           PERFORM 4200-VALIDACION-SEMANTICA                                        <  
      *                                                                             <  
           PERFORM 4240-CONTAR-TIPO-CUENTA                                          <  
      *                                                                             <  
           PERFORM 4100-VALIDACION-FORMAL                                                         PERFORM 4100-VALIDACION-FORMAL
      *                                                                             <  
           IF E-HAY-ERROR = "SI"                                                                  IF E-HAY-ERROR = "SI"
                                                                                    >                 ADD 1 TO REG-MAL-FORMADOS
               PERFORM 4900-GRABAR-ERROR                                                              PERFORM 4900-GRABAR-ERROR
           ELSE                                                                     |                 EXIT PARAGRAPH
                                                                                    >             END-IF
                                                                                    >  
                                                                                    >        *    Validación del contenido
                                                                                    >             PERFORM 4200-VALIDACION-SEMANTICA
                                                                                    >             PERFORM 4240-CONTAR-TIPO-CUENTA
                                                                                    >  
                                                                                    >             IF E-IMPACTAR-BDIIALE = "SI"
               PERFORM 4300-MODIFICAR-BDIIALE                                                         PERFORM 4300-MODIFICAR-BDIIALE
               ADD 1 TO N-REG-OK                                                    |                 ADD 1 TO N-REG-PROCESADOS
                                                                                    >             END-IF
                                                                                    >  
                                                                                    >             IF E-HAY-ERROR = "SI"
                                                                                    >                 PERFORM 4900-GRABAR-ERROR
           END-IF.                                                                                END-IF.


       4100-VALIDACION-FORMAL.                                                                4100-VALIDACION-FORMAL.
      ******************************************************************                     ******************************************************************
      * VALIDACION FORMAL DE LOS DATOS DEL INPUT                                             * VALIDACION FORMAL DE LOS DATOS DEL INPUT
      ******************************************************************                     ******************************************************************
      *    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}                               |        *    TIPO DE IDENTIFICACION NUMERICA
           IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"                       |             IF JURAD-ID-TIPO NOT NUMERIC
               CALL "PONERR" USING "02" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "02" JURAD-REG E-ERRORES
            END-IF                                                                                 END-IF
      *    NUMERO DE IDENTIFICACION                                                          *    NUMERO DE IDENTIFICACION
           IF JURAD-ID-NUMEROX IS NOT NUMERIC                                                     IF JURAD-ID-NUMEROX IS NOT NUMERIC
               CALL "PONERR" USING "03" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "03" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
           IF JURAD-ID-NUMERO NOT > 0                                                             IF JURAD-ID-NUMERO NOT > 0
               CALL "PONERR" USING "04" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "04" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES                       *    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES
      *    NO SE CONTROLAN                                                                   *    NO SE CONTROLAN
           IF JURAD-TIPO-NOVEDAD = "E"                                                            IF JURAD-TIPO-NOVEDAD = "E"
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF
      *    NOMBRES Y APELLIDOS                                                               *    NOMBRES Y APELLIDOS
           IF JURAD-NOMBRE = SPACES                                                               IF JURAD-NOMBRE = SPACES
               CALL "PONERR" USING "05" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "05" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    NUMERO DE DEMANDAS VIGENTES                                                       *    NUMERO DE DEMANDAS VIGENTES
           IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC                                              IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC
               CALL "PONERR" USING "06" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "06" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    NUMERO DE DEMANDAS TERMINADAS                                                     *    NUMERO DE DEMANDAS TERMINADAS
           IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC                                            IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC
               CALL "PONERR" USING "07" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "07" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    FECHA ULTIMA DEMANDA VIGENTE YYMMDD                                               *    FECHA ULTIMA DEMANDA VIGENTE YYMMDD
           IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC                                          IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC
               CALL "PONERR" USING "08" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "08" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
           MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS                                MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS
           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL                                           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL
               CALL "PONERR" USING "09" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "09" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    NUMERO DE EMBARGOS VIGENTES                                                       *    NUMERO DE EMBARGOS VIGENTES
           IF JURAD-EMBARGOS-VIGENTES NOT NUMERIC                                                 IF JURAD-EMBARGOS-VIGENTES NOT NUMERIC
               CALL "PONERR" USING "10" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "10" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    NUMERO DE EMBARGOS TERMINADOS                                                     *    NUMERO DE EMBARGOS TERMINADOS
           IF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC                                               IF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC
               CALL "PONERR" USING "11" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "11" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
      *    FECHA ULTIMO EMBARGO VIGENTE YYMMDD                                               *    FECHA ULTIMO EMBARGO VIGENTE YYMMDD
           IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC                                          IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC
               CALL "PONERR" USING "12" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "12" JURAD-REG E-ERRORES
           END-IF                                                                                 END-IF
           MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS                                MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS
           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL                                           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL
               CALL "PONERR" USING "13" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "13" JURAD-REG E-ERRORES
           END-IF.                                                                                END-IF.


       4200-VALIDACION-SEMANTICA.                                                             4200-VALIDACION-SEMANTICA.
      ****************************************************************                       ****************************************************************
      * VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON                |        * Validacion del tipo y numero de identificacion y de su relacion
      * EL NOMBRE                                                                   |        * con el nombre
      ****************************************************************                       ****************************************************************
         IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"                                     IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"
              MOVE 05 TO CODIGO-ERROR                                                             MOVE 05 TO CODIGO-ERROR
              ADD  1  TO TIPO-ID-INVALIDO                                                         ADD 1 TO TIPO-ID-INVALIDO
                                                                                    >             CALL "PONERR" USING "02" JURAD-REG E-ERRORES
         ELSE                                                                                   ELSE
      *    PARÁMETROS PARA LAS RUTINAS DE VALIDACIÓN EN BDIIVIDE                    |        *    Parámetros para las rutinas de validación en BDIIVIDE
           MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE                                                 MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE
           MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE                                 |             MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE NUM-ID-W
                                   NUM-ID-W                                         <  
           MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE                                                   MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE
      *    SWITCHES DE OPCIONES DE VALIDACIÓN                                       |        *    Switches de opciones de validación
           MOVE 1 TO  SW-VERIFNOM-BDIIVIDE                                          |             MOVE 1 TO SW-VERIFNOM-BDIIVIDE SW-DIGCHEQUEO-BDIIVIDE
                      SW-DIGCHEQUEO-BDIIVIDE                                        <  
           MOVE 2 TO NUM-BLOQUES-BDIIVIDE                                                         MOVE 2 TO NUM-BLOQUES-BDIIVIDE
      *    VALIDA EL NÚMERO DE IDENTIFICACIÓN CONTRA LAS BASES DE                   |        *    Valida el número de identificación contra las bases de
      *    DATOS BDIIDIAN, BDIIDAS, BDIIREGI Y VERIFICA LA COINCIDENCIA             |        *    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
      *    DEL NOMBRE REPORTADO                                                     |        *    del nombre reportado
      *    RETORNA SW-ID-BDIIVIDE=1 SI HAY ERROR                                    |        *    retorna SW-ID-BDIIVIDE=1 si hay error
           PERFORM 80100-VALIDAR-IDENTIFICACION                                                   PERFORM 80100-VALIDAR-IDENTIFICACION
           MOVE  TIP-IDE-BDIIVIDE TO TIPOID-E                                                     MOVE  TIP-IDE-BDIIVIDE TO TIPOID-E
           MOVE  NUM-IDE-BDIIVIDE TO NUMID-E                                                      MOVE  NUM-IDE-BDIIVIDE TO NUMID-E
      *    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE                        <  
           IF SW-ID-BDIIVIDE = 1                                                                  IF SW-ID-BDIIVIDE = 1
      *        ES UN ID QUE NO EXISTE EN BDIIREGI, BDIIDAS o BDIIDIAN               |        *      es un id que no existe en BDIIREGI, BDIIDAS o BDIIDIAN
               CALL "PONERR" USING "14" JURAD-REG E-ERRORES                                         CALL "PONERR" USING "14" JURAD-REG E-ERRORES
      *        VALIDA CONTRA LA BASE ALTERNA                                        |        *      valida contra la base alterna
               PERFORM 4210-VALIDACION-ID-NO-FIGURA                                                 PERFORM 4210-VALIDACION-ID-NO-FIGURA
           ELSE                                                                                   ELSE
             IF SW-ID-BDIIVIDE = 1                                                                  IF SW-ID-BDIIVIDE = 1
                 IF TIPOID-E <> 1                                                                       IF TIPOID-E <> 1
                   MOVE  ZEROS         TO  HACER-MATCH                                                    MOVE ZEROS TO HACER-MATCH
                   MOVE 0 TO IDE-TIPO-BDAMATCH                                                            MOVE 0 TO IDE-TIPO-BDAMATCH
                   PERFORM  513-VALIDA-EN-CSV                                                             PERFORM 513-VALIDA-EN-CSV
                   IF  IDE-TIPO-BDAMATCH  =  0                                                            IF  IDE-TIPO-BDAMATCH  =  0
                     MOVE 03           TO  CODIGO-ERROR                                                     MOVE 03 TO CODIGO-ERROR
                     ADD   1           TO  NO-EXISTE-DIAN                                                   ADD 1 TO NO-EXISTE-DIAN
                   END-IF                                                                                 END-IF
                 ELSE                                                                                   ELSE
                    MOVE  ZEROS TO  HACER-MATCH                                                            MOVE ZEROS TO HACER-MATCH
                    MOVE 0 TO IDE-TIPO-BDAMATCH                                                            MOVE 0 TO IDE-TIPO-BDAMATCH
                    PERFORM 513-VALIDA-EN-CSV                                                              PERFORM 513-VALIDA-EN-CSV
                    IF IDE-TIPO-BDAMATCH = 0                                                               IF IDE-TIPO-BDAMATCH = 0
                       MOVE 04 TO CODIGO-ERROR                                                                MOVE 04 TO CODIGO-ERROR
                       ADD  1  TO NO-EXISTE-REGIS                                                             ADD 1 TO NO-EXISTE-REGIS
                    END-IF                                                                                 END-IF
                 END-IF                                                                                 END-IF
              ELSE                                                                                   ELSE
                 IF SW-NOMBRES-BDIIVIDE = 1                                                             IF SW-NOMBRES-BDIIVIDE = 1
                                                                                    >                      CALL "PONERR" USING "15" JURAD-REG E-ERRORES
                    IF TIPOID-E <> 1                                                                       IF TIPOID-E <> 1
                       MOVE 01 TO CODIGO-ERROR                                                                MOVE 01 TO CODIGO-ERROR
                       ADD 1 TO NO-COINCIDE-DIAN                                                              ADD 1 TO NO-COINCIDE-DIAN
                    ELSE                                                                                   ELSE
                       MOVE   02 TO CODIGO-ERROR                                                              MOVE 02 TO CODIGO-ERROR
                       ADD 1 TO NO-COINCIDE-REGIS                                                             ADD 1 TO NO-COINCIDE-REGIS
                    END-IF                                                                                 END-IF
                 ELSE                                                                                   ELSE
                    INITIALIZE LLAVE-BDIIALE                                                               INITIALIZE LLAVE-BDIIALE
                    MOVE  TIPOID-E TO TIP-IDE-BDIIALE                                                      MOVE TIPOID-E TO TIP-IDE-BDIIALE
                    MOVE  NUMID-E  TO NUM-IDE-BDIIALE                                                      MOVE NUMID-E TO NUM-IDE-BDIIALE
                    MOVE  990003   TO FUENTE-BDIIALE                                                       MOVE 990003 TO FUENTE-BDIIALE
                    START BDIIALE KEY NOT < LLAVE-BDIIALE                           |                      START BDIIALE KEY NOT < LLAVE-BDIIALE INVALID KEY
                          INVALID KEY MOVE 1 TO SW-BDIIALE                          |                          MOVE 1 TO SW-BDIIALE
                      NOT INVALID KEY MOVE 0 TO SW-BDIIALE                          |                      NOT INVALID KEY
                          READ BDIIALE NEXT RECORD                                  |                          MOVE 0 TO SW-BDIIALE
                               AT END MOVE 1 TO SW-BDIIALE                          |                          READ BDIIALE NEXT RECORD AT END
                                                                                    >                              MOVE 1 TO SW-BDIIALE
                          END-READ                                                                             END-READ
                                                                                    >                      END-START
                    MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-R                                             MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-R
                    PERFORM UNTIL SW-BDIIALE = 1 OR                                                        PERFORM UNTIL SW-BDIIALE = 1 OR
                            TIPOID-E <> TIP-IDE-BDIIALE OR                                                 TIPOID-E <> TIP-IDE-BDIIALE OR
                            NUMID-E <> NUM-IDE-BDIIALE                                                     NUMID-E <> NUM-IDE-BDIIALE
                            IF FUENTE-BDIIALE = 990003 AND                                                     IF FUENTE-BDIIALE = 990003 AND
                               FEC-NOV-BDIIALE <= FECHA-PROC-R AND                                                FEC-NOV-BDIIALE <= FECHA-PROC-R AND
                               FEC-VEN-BDIIALE >= FECHA-PROC-R AND                                                FEC-VEN-BDIIALE >= FECHA-PROC-R AND
                               BLOQUEO-BDIIALE = 0                                                                BLOQUEO-BDIIALE = 0
                               MOVE 1 TO SW-BDIIALE                                                               MOVE 1 TO SW-BDIIALE
                            END-IF                                                                             END-IF
                            IF SW-BDIIALE = 0                                                                  IF SW-BDIIALE = 0
                               READ BDIIALE NEXT RECORD                             |                              READ BDIIALE NEXT RECORD AT END
                                    AT END MOVE 1 TO SW-BDIIALE                     |                                  MOVE 1 TO SW-BDIIALE
                               END-READ                                                                            END-READ
                            END-IF                                                                             END-IF
                    END-PERFORM                                                                            END-PERFORM
                    IF TIPOID-E = 1                                                                        IF TIPOID-E = 1
                       IF ESTADO-VIG-BDIIREGI = 12                                                             IF ESTADO-VIG-BDIIREGI = 12
                          MOVE  07   TO  CODIGO-ERROR                                                              MOVE 07 TO CODIGO-ERROR
                        ELSE                                                                                   ELSE
                           IF ESTADO-VIG-BDIIREGI = 21                                                             IF ESTADO-VIG-BDIIREGI = 21
                              MOVE  06  TO CODIGO-ERROR                                                                MOVE 06 TO CODIGO-ERROR
                                                                                    >                                  CALL "PONERR" USING "15" JURAD-REG
                                                                                    >                                  E-ERRORES
                              ADD   1   TO NO-COINCIDE-REGIS                                                           ADD 1 TO NO-COINCIDE-REGIS
                              ADD   1   TO CONT-FALLECIDOS                                                             ADD 1 TO CONT-FALLECIDOS
                           END-IF                                                                                  END-IF
                        END-IF                                                                                 END-IF
                    END-IF                                                                                 END-IF
                 END-IF                                                                                 END-IF
              END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

                                                                                    >  
       4240-CONTAR-TIPO-CUENTA.                                                               4240-CONTAR-TIPO-CUENTA.
      ******************************************************************                     ******************************************************************
      *    Conteo de los registros por "tipo", dependiendo del código                        *    Conteo de los registros por "tipo", dependiendo del código
      *    de error:                                                                         *    de error:
      *    00=OK                                                                             *    00=OK
      *    01=NIT OK, nombre no coincide                                                     *    01=NIT OK, nombre no coincide
      *    02=cédula OK, nombre no coincide                                                  *    02=cédula OK, nombre no coincide
      *    03=NIT no figura                                                                  *    03=NIT no figura
      *    04=cédula no figura pero está en base alterna                                     *    04=cédula no figura pero está en base alterna
      *    05=tipo id no es 1|2|3|4                                                          *    05=tipo id no es 1|2|3|4
      *    cuenta tipo 5: sin error                                                          *    cuenta tipo 5: sin error
      *    cuenta tipo 6: 01 02 06 07                                                        *    cuenta tipo 6: 01 02 06 07
      *    cuenta tipo 7: 03 04 05                                                           *    cuenta tipo 7: 03 04 05
      ******************************************************************                     ******************************************************************
           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07                                                 IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07
               ADD 1 TO W-CONT-TIPO-6                                                                 ADD 1 TO W-CONT-TIPO-6
           ELSE                                                                                   ELSE
               IF CODIGO-ERROR = 03 OR 04 OR 05                                                       IF CODIGO-ERROR = 03 OR 04 OR 05
                   ADD 1 TO W-CONT-TIPO-7                                                                 ADD 1 TO W-CONT-TIPO-7
                   CALL "PONERR" USING "20" JURAD-REG E-ERRORES                     <  
      *            INSERTA CUENTA SIN VALIDAR EN BDIIALE                            <  
                   PERFORM 4300-MODIFICAR-BDIIALE                                   <  
               ELSE                                                                                   ELSE
      *            ES 00: REGISTROS CORRECTOS                                       |        *            es 00: registros correctos
                   ADD 1 TO W-CONT-TIPO-5                                                                 ADD 1 TO W-CONT-TIPO-5
                   ADD  1  TO REG-CORRECTOS                                                               ADD 1 TO REG-CORRECTOS
      *            SI ES UNA EMPRESA                                                |        *            si es un NIT
                   IF TIPOID-E = 2 OR 3                                                                   IF TIPOID-E = 2 OR 3
                       ADD 1 TO W-CONT-TIPO-5-PJ                                                              ADD 1 TO W-CONT-TIPO-5-PJ
                   END-IF                                                                                 END-IF
               END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

                                                                                    >  
       4210-VALIDACION-ID-NO-FIGURA.                                                          4210-VALIDACION-ID-NO-FIGURA.
      ******************************************************************                     ******************************************************************
      * Validación de IDs que no figuran en las bases normales                               * Validación de IDs que no figuran en las bases normales
      ******************************************************************                     ******************************************************************
           MOVE 0 TO HACER-MATCH                                                                  MOVE 0 TO HACER-MATCH
           MOVE 0 TO IDE-TIPO-BDAMATCH                                                            MOVE 0 TO IDE-TIPO-BDAMATCH
      *    VALIDA SI LA IDENTIFICACIÓN ESTÁ EN LA BASE DE DATOS ALTERNA             |        *    Valida si la identificación está en la base de datos alterna
           PERFORM 513-VALIDA-EN-CSV                                                              PERFORM 513-VALIDA-EN-CSV
           IF IDE-TIPO-BDAMATCH = 0                                                               IF IDE-TIPO-BDAMATCH = 0
               IF TIP-IDE-BDIIVIDE = 1                                                                IF TIP-IDE-BDIIVIDE = 1
      *            ES UNA CÉDULA                                                    |        *            Es una cédula
                   MOVE 04 TO CODIGO-ERROR                                                                MOVE 04 TO CODIGO-ERROR
                   ADD  1  TO NO-EXISTE-REGIS                                                             ADD 1 TO NO-EXISTE-REGIS
               ELSE                                                                                   ELSE
      *            NO ES UNA CÉDULA                                                 |        *            No es una cédula
                   MOVE 03 TO CODIGO-ERROR                                                                MOVE 03 TO CODIGO-ERROR
                   ADD   1 TO  NO-EXISTE-DIAN                                                             ADD 1 TO NO-EXISTE-DIAN
               END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

                                                                                    >  
                                                                                    >        DDISPLAY-CONTADORES.
                                                                                    >        ******************************************************************
                                                                                    >        * Código para controlar la evolución de los contadores
                                                                                    >        ******************************************************************
                                                                                    >             DISPLAY "REG-MAL-FORMADOS :" REG-MAL-FORMADOS
                                                                                    >             DISPLAY "REG-LEIDOS       :" REG-LEIDOS
                                                                                    >             DISPLAY "REG-CORRECTOS    :" REG-CORRECTOS
                                                                                    >             DISPLAY "SI-EXISTE-CSV    :" SI-EXISTE-CSV
                                                                                    >             DISPLAY "NO-COINCIDE-REGIS:" NO-COINCIDE-REGIS
                                                                                    >             DISPLAY "CONT-FALLECIDOS  :" CONT-FALLECIDOS
                                                                                    >             DISPLAY "NO-COINCIDE-DIAN :" NO-COINCIDE-DIAN
                                                                                    >             DISPLAY "NO-EXISTE-REGIS  :" NO-EXISTE-REGIS
                                                                                    >             DISPLAY "NO-EXISTE-DIAN   :" NO-EXISTE-DIAN
                                                                                    >             DISPLAY "TIPO-ID-INVALIDO :" TIPO-ID-INVALIDO
                                                                                    >             DISPLAY "Alertas insertadas: " N-ALE-INSERTADAS
                                                                                    >             " modificadas: " N-ALE-MODIFICADAS
                                                                                    >             " eliminadas: " N-ALE-ELIMINADAS.
                                                                                    >  
                                                                                    >  
       4300-MODIFICAR-BDIIALE.                                                                4300-MODIFICAR-BDIIALE.
      ******************************************************************                     ******************************************************************
      * Se impacta el archivo BDIIALE con una o dos inserciones,                             * Se impacta el archivo BDIIALE con una o dos inserciones,
      * modificaciones o eliminaciones segun haya o no demandas y                            * modificaciones o eliminaciones segun haya o no demandas y
      * embargos                                                                             * embargos
      ******************************************************************                     ******************************************************************
           INITIALIZE REG-BDIIALE                                                                 INITIALIZE REG-BDIIALE

      *    SI HAY DEMANDAS                                                          |        *    DEMANDAS
           IF JURAD-DEMANDAS-VIGENTES > ZERO                                        <  
           OR JURAD-DEMANDAS-TERMINADAS > ZERO                                      <  
               MOVE "J001" TO LLASEC-BDIIALE                                                      MOVE "J001" TO LLASEC-BDIIALE
      *        ARMA DATOS DE DEMANDAS                                                        *    ARMA DATOS DE DEMANDAS
               MOVE JURAD-DEMANDAS-VIGENTES TO D-VIGENTES                                         MOVE JURAD-DEMANDAS-VIGENTES TO D-VIGENTES
               MOVE JURAD-DEMANDAS-TERMINADAS TO D-TERMINADOS                                     MOVE JURAD-DEMANDAS-TERMINADAS TO D-TERMINADOS
               STRING "20" JURAD-DEMANDAS-FECHA-ULTIMA                              |             MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO D-FECHA-ULTIMA
               DELIMITED SIZE INTO D-FECHA-ULTIMA                                   <  
               PERFORM 4300-MODIFICAR-BDIIALE-DATOS                                               PERFORM 4300-MODIFICAR-BDIIALE-DATOS
           END-IF.                                                                  <  

      *    SI HAY EMBARGOS                                                          |        *    EMBARGOS
           IF JURAD-EMBARGOS-VIGENTES > ZERO                                                      IF JURAD-EMBARGOS-VIGENTES > ZERO
           OR JURAD-EMBARGOS-TERMINADOS > ZERO                                                    OR JURAD-EMBARGOS-TERMINADOS > ZERO
               MOVE "J002" TO LLASEC-BDIIALE                                                      MOVE "J002" TO LLASEC-BDIIALE
      *        ARMA DATOS DE EMBARGOS                                                        *    ARMA DATOS DE EMBARGOS
               MOVE JURAD-EMBARGOS-VIGENTES TO D-VIGENTES                                         MOVE JURAD-EMBARGOS-VIGENTES TO D-VIGENTES
               MOVE JURAD-EMBARGOS-TERMINADOS TO D-TERMINADOS                                     MOVE JURAD-EMBARGOS-TERMINADOS TO D-TERMINADOS
               STRING "20" JURAD-EMBARGOS-FECHA-ULTIMO                              |             MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO D-FECHA-ULTIMA
               DELIMITED SIZE INTO D-FECHA-ULTIMA                                   |             PERFORM 4300-MODIFICAR-BDIIALE-DATOS.
               PERFORM 4300-MODIFICAR-BDIIALE-DATOS                                 <  
           END-IF.                                                                  <  

                                                                                    >  
       4300-MODIFICAR-BDIIALE-DATOS.                                                          4300-MODIFICAR-BDIIALE-DATOS.
      ******************************************************************                     ******************************************************************
      * PARTE DE LA CARGA DE DATOS EN EL REGISTRO BDIIALE Y GRABACION                        * PARTE DE LA CARGA DE DATOS EN EL REGISTRO BDIIALE Y GRABACION
      * DEL MISMO QUE ES COMUN A DEMANDAS Y EMBARGOS                                         * DEL MISMO QUE ES COMUN A DEMANDAS Y EMBARGOS
      * EL DATO LLASEC-BDIIALE YA TIENE "J001" O "J002"                                      * EL DATO LLASEC-BDIIALE YA TIENE "J001" O "J002"
      ******************************************************************                     ******************************************************************
      *    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK                         *    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK
      *    EL FILE STATUS DE BDIIALE QUEDA CON "00"                                          *    EL FILE STATUS DE BDIIALE QUEDA CON "00"
           PERFORM 4333-LEER-BDIIALE-RANDOM                                                       PERFORM 4333-LEER-BDIIALE-RANDOM

      *    PROCESA SEGUN EL TIPO DE NOVEDAD I M E                                            *    PROCESA SEGUN EL TIPO DE NOVEDAD I M E
           EVALUATE JURAD-TIPO-NOVEDAD                                                            EVALUATE JURAD-TIPO-NOVEDAD
           WHEN "I"                                                                               WHEN "I"
               ADD 1 TO N-REG-TIPO-I-OK                                                               ADD 1 TO N-REG-TIPO-I-OK
               PERFORM 4300-MODIFICAR-BDIIALE-I                                                       PERFORM 4300-MODIFICAR-BDIIALE-I
           WHEN "M"                                                                               WHEN "M"
               ADD 1 TO N-REG-TIPO-M-OK                                                               ADD 1 TO N-REG-TIPO-M-OK
               PERFORM 4300-MODIFICAR-BDIIALE-M                                                       PERFORM 4300-MODIFICAR-BDIIALE-M
           WHEN "E"                                                                               WHEN "E"
               ADD 1 TO N-REG-TIPO-E-OK                                                               ADD 1 TO N-REG-TIPO-E-OK
               PERFORM 4300-MODIFICAR-BDIIALE-E                                                       PERFORM 4300-MODIFICAR-BDIIALE-E
           WHEN OTHER                                                                             WHEN OTHER
      *        ESTO ES "IMPOSIBLE" POR CONTROL DE CONSISTENCIA ANTERIOR                      *        ESTO ES "IMPOSIBLE" POR CONTROL DE CONSISTENCIA ANTERIOR
               DISPLAY "ERROR DE LOGICA: TIPO-NOVEDAD="                                               DISPLAY "ERROR DE LOGICA: TIPO-NOVEDAD="
               JURAD-TIPO-NOVEDAD " REG NUM: " N-REG-LEIDOS                                           JURAD-TIPO-NOVEDAD " REG NUM: " N-REG-LEIDOS
               DISPLAY "REGISTRO DE JURAD: " DISPLAY JURAD-REG                                        DISPLAY "REGISTRO DE JURAD: " DISPLAY JURAD-REG
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.


       4300-MODIFICAR-BDIIALE-I.                                                              4300-MODIFICAR-BDIIALE-I.
      ******************************************************************                     ******************************************************************
      * INSERCION DE UNA ALERTA NUEVA                                                        * INSERCION DE UNA ALERTA NUEVA
      ******************************************************************                     ******************************************************************
      *    SI EL REGISTRO EXISTIA ES UN ERROR                                                *    SI EL REGISTRO EXISTIA ES UN ERROR
           IF EST-BDIIALE = "00"                                                                  IF EST-BDIIALE = "00"
               CALL "PONERR" USING "19" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "19" JURAD-REG E-ERRORES
               DISPLAY "LLAVE: " LLAVE-BDIIALE                                                        DISPLAY "LLAVE: " LLAVE-BDIIALE
               ADD 1 TO N-ALE-YA-EXISTE                                                               ADD 1 TO N-ALE-YA-EXISTE
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF

      *    COMPLETA LOS DATOS DEL REGISTRO                                                   *    COMPLETA LOS DATOS DEL REGISTRO
           INITIALIZE ENCABEZADO-BDIIALE                                                          INITIALIZE ENCABEZADO-BDIIALE
           MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-NOV-BDIIALE                                       MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-NOV-BDIIALE
           FEC-REP-BDIIALE                                                                        FEC-REP-BDIIALE
           MOVE P-FECHA-PROCESO-50 TO FEC-VEN-BDIIALE                                             MOVE P-FECHA-PROCESO-50 TO FEC-VEN-BDIIALE
           MOVE 0 TO BLOQUEO-BDIIALE                                                              MOVE 0 TO BLOQUEO-BDIIALE
           MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE                                                MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE
           MOVE SPACES TO LINEAS-BDIIALE                                                          MOVE SPACES TO LINEAS-BDIIALE
           PERFORM 4333-GRABAR-BDIIALE.                                                           PERFORM 4333-GRABAR-BDIIALE.


       4300-MODIFICAR-BDIIALE-M.                                                              4300-MODIFICAR-BDIIALE-M.
      ******************************************************************                     ******************************************************************
      * MODIFICACION DE UNA ALERTA EXISTENTE                                                 * MODIFICACION DE UNA ALERTA EXISTENTE
      ******************************************************************                     ******************************************************************
      *    SI EL REGISTRO NO EXISTIA ES UN ERROR                                             *    SI EL REGISTRO NO EXISTIA ES UN ERROR
           IF EST-BDIIALE NOT = "00"                                                              IF EST-BDIIALE NOT = "00"
               CALL "PONERR" USING "17" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "17" JURAD-REG E-ERRORES
               "LLAVE: " LLAVE-BDIIALE                                                                "LLAVE: " LLAVE-BDIIALE
               ADD 1 TO N-ALE-NO-EXISTE                                                               ADD 1 TO N-ALE-NO-EXISTE
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF

      *    REEMPLAZA LA FECHA DE REPORTE Y LOS VALORES                                       *    REEMPLAZA LA FECHA DE REPORTE Y LOS VALORES
           MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-REP-BDIIALE                                       MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-REP-BDIIALE
           MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE                                                MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE
           MOVE SPACES TO LINEAS-BDIIALE                                                          MOVE SPACES TO LINEAS-BDIIALE
           PERFORM 4333-REGRABAR-BDIIALE.                                                         PERFORM 4333-REGRABAR-BDIIALE.


       4300-MODIFICAR-BDIIALE-E.                                                              4300-MODIFICAR-BDIIALE-E.
      ******************************************************************                     ******************************************************************
      * ELIMINACION DE UNA ALERTA                                                            * ELIMINACION DE UNA ALERTA
      ******************************************************************                     ******************************************************************
      *    ELIMINA EL REGISTRO                                                               *    ELIMINA EL REGISTRO
           IF EST-BDIIALE = "00"                                                                  IF EST-BDIIALE = "00"
               PERFORM 4333-ELIMINAR-BDIIALE                                                          PERFORM 4333-ELIMINAR-BDIIALE
           ELSE                                                                                   ELSE
               CALL "PONERR" USING "18" JURAD-REG E-ERRORES                                           CALL "PONERR" USING "18" JURAD-REG E-ERRORES
               "LLAVE: " LLAVE-BDIIALE                                                                "LLAVE: " LLAVE-BDIIALE
               ADD 1 TO N-ALE-NO-EXISTE                                                               ADD 1 TO N-ALE-NO-EXISTE
           END-IF.                                                                                END-IF.


       4333-LEER-BDIIALE-RANDOM.                                                              4333-LEER-BDIIALE-RANDOM.
      ******************************************************************                     ******************************************************************
      * ARMA CLAVE EXACTA Y LEE UN REGISTRO DE BDIIALE                                       * ARMA CLAVE EXACTA Y LEE UN REGISTRO DE BDIIALE
      * USA LOS DATOS DEL REG INPUT, EXCEPTO LLASEC QUE ESTA PRECARGADO                      * USA LOS DATOS DEL REG INPUT, EXCEPTO LLASEC QUE ESTA PRECARGADO
      * CUANDO PUDO LEER OK EL FILE STATUS EST-BDIIALE QUEDA CON "00"                        * CUANDO PUDO LEER OK EL FILE STATUS EST-BDIIALE QUEDA CON "00"
      ******************************************************************                     ******************************************************************
           MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIALE                                                  MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIALE
           MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIALE                                                MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIALE
           MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE                                                MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE
           MOVE 000 TO COD-ALERTA-BDIIALE                                                         MOVE 000 TO COD-ALERTA-BDIIALE
      *    LLASEC-BDIIALE FUÉ PREVIAMENTE CARGADO CON J001 O J002                            *    LLASEC-BDIIALE FUÉ PREVIAMENTE CARGADO CON J001 O J002

           READ BDIIALE                                                                           READ BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
               CONTINUE                                                                               CONTINUE
           WHEN "23"                                                                              WHEN "23"
               CONTINUE                                                                               CONTINUE
           WHEN OTHER                                                                             WHEN OTHER
               DISPLAY "ERROR AL LEER BDIIALE FS: " EST-BDIIALE                                       DISPLAY "ERROR AL LEER BDIIALE FS: " EST-BDIIALE
               " KEY: " LLAVE-BDIIALE                                                                 " KEY: " LLAVE-BDIIALE
               DISPLAY "ULTIMO REGISTRO PROCESADO: "                                                  DISPLAY "ULTIMO REGISTRO PROCESADO: "
               DISPLAY JURAD-REG-ANTERIOR                                                             DISPLAY JURAD-REG-ANTERIOR
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.

       4333-GRABAR-BDIIALE.                                                                   4333-GRABAR-BDIIALE.
      ******************************************************************                     ******************************************************************
      * INSERTA UN REGISTRO NUEVO EN BDIIALE                                                 * INSERTA UN REGISTRO NUEVO EN BDIIALE
      ******************************************************************                     ******************************************************************
           IF NOT PROCESO-REAL                                                                    IF NOT PROCESO-REAL
                                                                                    >                 ADD 1 TO N-ALE-INSERTADAS
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF
           WRITE REG-BDIIALE                                                                      WRITE REG-BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
               ADD 1 TO N-ALE-INSERTADAS                                                              ADD 1 TO N-ALE-INSERTADAS
           WHEN OTHER                                                                             WHEN OTHER
               DISPLAY "ERROR AL GRABAR BDIIALE FS: " EST-BDIIALE                                     DISPLAY "ERROR AL GRABAR BDIIALE FS: " EST-BDIIALE
               " KEY: " LLAVE-BDIIALE                                                                 " KEY: " LLAVE-BDIIALE
               DISPLAY "REGISTRO BDIIALE: "                                                           DISPLAY "REGISTRO BDIIALE: "
               DISPLAY REG-BDIIALE                                                                    DISPLAY REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.


       4333-REGRABAR-BDIIALE.                                                                 4333-REGRABAR-BDIIALE.
      ******************************************************************                     ******************************************************************
      * REGRABA UN REGISTRO MODIFICADO EN BDIIALE                                            * REGRABA UN REGISTRO MODIFICADO EN BDIIALE
      ******************************************************************                     ******************************************************************
           IF NOT PROCESO-REAL                                                                    IF NOT PROCESO-REAL
                                                                                    >                 ADD 1 TO N-ALE-MODIFICADAS
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF
           REWRITE REG-BDIIALE                                                                    REWRITE REG-BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
               ADD 1 TO N-ALE-MODIFICADAS                                                             ADD 1 TO N-ALE-MODIFICADAS
           WHEN OTHER                                                                             WHEN OTHER
               DISPLAY "ERROR AL REGRABAR BDIIALE FS: " EST-BDIIALE                                   DISPLAY "ERROR AL REGRABAR BDIIALE FS: " EST-BDIIALE
               " KEY: " LLAVE-BDIIALE                                                                 " KEY: " LLAVE-BDIIALE
               DISPLAY "REGISTRO BDIIALE: "                                                           DISPLAY "REGISTRO BDIIALE: "
               DISPLAY REG-BDIIALE                                                                    DISPLAY REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.

       4333-ELIMINAR-BDIIALE.                                                                 4333-ELIMINAR-BDIIALE.
      ******************************************************************                     ******************************************************************
      * ELIMINA UN REGISTRO DE BDIIALE                                                       * ELIMINA UN REGISTRO DE BDIIALE
      ******************************************************************                     ******************************************************************
           IF NOT PROCESO-REAL                                                                    IF NOT PROCESO-REAL
                                                                                    >                 ADD 1 TO N-ALE-ELIMINADAS
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-IF                                                                                 END-IF
           DELETE BDIIALE                                                                         DELETE BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
               ADD 1 TO N-ALE-ELIMINADAS                                                              ADD 1 TO N-ALE-ELIMINADAS
           WHEN OTHER                                                                             WHEN OTHER
               DISPLAY "ERROR AL DELETEAR BDIIALE FS: " EST-BDIIALE                                   DISPLAY "ERROR AL DELETEAR BDIIALE FS: " EST-BDIIALE
               " KEY: " LLAVE-BDIIALE                                                                 " KEY: " LLAVE-BDIIALE
               DISPLAY "REGISTRO BDIIALE: "                                                           DISPLAY "REGISTRO BDIIALE: "
               DISPLAY REG-BDIIALE                                                                    DISPLAY REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.

       4800-PROCESO-REG-T.                                                                    4800-PROCESO-REG-T.
      ******************************************************************                     ******************************************************************
      * EL REGISTRO LEIDO EN EL ARCHIVO JURAD ES TIPO "T" CON TOTALES                        * EL REGISTRO LEIDO EN EL ARCHIVO JURAD ES TIPO "T" CON TOTALES
      * DE CONTROL, Y DEBERÍA SER EL ULTIMO DEL ARCHIVO                                      * DE CONTROL, Y DEBERÍA SER EL ULTIMO DEL ARCHIVO
      ******************************************************************                     ******************************************************************
      * CONTROL DE LOS TOTALES CALCULADOS CONTRA LOS ESPERADOS                               * CONTROL DE LOS TOTALES CALCULADOS CONTRA LOS ESPERADOS
           MOVE "NO" TO E-HAY-ERROR                                                               MOVE "NO" TO E-HAY-ERROR
      *    CANTIDAD DE REGISTROS I M E                                                       *    CANTIDAD DE REGISTROS I M E
           IF FUNCTION NUMVAL(JURADT-REGISTROS) = N-REG-LEIDOS                                    IF FUNCTION NUMVAL(JURADT-REGISTROS) = N-REG-LEIDOS
               CONTINUE                                                                               CONTINUE
           ELSE                                                                                   ELSE
               DISPLAY " "                                                                            DISPLAY " "
               DISPLAY "NO COINCIDE LA CANTIDAD DE REGISTROS:"                                        DISPLAY "NO COINCIDE LA CANTIDAD DE REGISTROS:"
               JURADT-REGISTROS " CON LOS LEIDOS:" N-REG-LEIDOS                                       JURADT-REGISTROS " CON LOS LEIDOS:" N-REG-LEIDOS
               MOVE "SI" TO E-HAY-ERROR                                                               MOVE "SI" TO E-HAY-ERROR
           END-IF.                                                                                END-IF.

       4900-GRABAR-ERROR.                                                                     4900-GRABAR-ERROR.
      ******************************************************************                     ******************************************************************
      * EL REGISTRO DE JURAD TIENE ERROR: SE GRABA EN EL ARCHIVO ERRS                        * EL REGISTRO DE JURAD TIENE ERROR: SE GRABA EN EL ARCHIVO ERRS
      * CON INDICACION DEL ERROR DETECTADO                                                   * CON INDICACION DEL ERROR DETECTADO
      ******************************************************************                     ******************************************************************
           MOVE JURAD-REG TO ERRS-REG                                                             MOVE JURAD-REG TO ERRS-REG
      *    LISTA DE LOS CODIGOS DE LOS ERRORES DEL REGISTRO                                  *    LISTA DE LOS CODIGOS DE LOS ERRORES DEL REGISTRO
           MOVE E-ERRORES-REG TO ERRS-CAUSA-RECHAZO                                               MOVE E-ERRORES-REG TO ERRS-CAUSA-RECHAZO
           WRITE ERRS-REG                                                                         WRITE ERRS-REG
           EVALUATE ERRS-FS                                                                       EVALUATE ERRS-FS
               WHEN "00"                                                                              WHEN "00"
                   CONTINUE                                                                               CONTINUE
               WHEN OTHER                                                                             WHEN OTHER
                   DISPLAY "ERROR AL GRABAR EL ARCHIVO DE ERRORES "                                       DISPLAY "ERROR AL GRABAR EL ARCHIVO DE ERRORES "
                   DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME                                          DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME
                   DISPLAY "FILE STATUS: " ERRS-FS                                                        DISPLAY "FILE STATUS: " ERRS-FS
                   PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
                   GOBACK                                                                                 GOBACK
           END-EVALUATE.                                                                          END-EVALUATE.


       1000-RUTINA-INICIAL.                                                                   1000-RUTINA-INICIAL.
      ******************************************************************                     ******************************************************************
      * Todas las operaciones que se realizan una sola vez, al comienzo                      * Todas las operaciones que se realizan una sola vez, al comienzo
      * del programa:                                                                        * del programa:
      *   - obtencion de los parametros                                                      *   - obtencion de los parametros
      *   - apertura del archivo de entrada                                                  *   - apertura del archivo de entrada
      *   - apertura de todos los demas archivos                                             *   - apertura de todos los demas archivos
      *   - eliminacion de datos existentes si es refresque completo                         *   - eliminacion de datos existentes si es refresque completo
      *   - carga en memoria de los IDs de inconsistentes                                    *   - carga en memoria de los IDs de inconsistentes
      ******************************************************************                     ******************************************************************
      * REGISTRA HORA DE INICIO                                                     |        * Registra hora de inicio
           ACCEPT W-HORA-INICIO FROM TIME                                                         ACCEPT W-HORA-INICIO FROM TIME

      * OBTIENE INFORMACION SOBRE LA CORRIDA DE LA LINEA DE COMANDO: EL             |        * Obtiene informacion sobre la corrida de la linea de comando: el
      * NOMBRE DEL ARCHIVO DE ENTRADA (QUE CONTIENE EL TIPO DE PROCESO),            |        * nombre del archivo de entrada (que contiene el tipo de proceso),
      * EL INDICADOR DE PROCESO REAL O EN FALSO (DEFAULT)                           |        * el indicador de proceso real o en falso (default)
           ACCEPT P-COMMAND-LINE FROM COMMAND-LINE                                                ACCEPT P-COMMAND-LINE FROM COMMAND-LINE
      *    ANIMATOR DE TERMINAL NO PERMITE PARAMETROS EN COMMANDLINE ...            |        D    MOVE "0000011000905140104.txt 2" to P-COMMAND-LINE
           DISPLAY "PARAMETROS: " P-COMMAND-LINE                                    <  
           UNSTRING P-COMMAND-LINE DELIMITED BY ALL " " INTO                                      UNSTRING P-COMMAND-LINE DELIMITED BY ALL " " INTO
           P-FILE-NAME P-PROCESO-REAL                                                             P-FILE-NAME P-PROCESO-REAL
                                                                                    >             DISPLAY "PARAMETROS: " P-COMMAND-LINE

      * EL PROGRAMA SE ANUNCIA EN LA CONSOLA                                        |        * El programa se anuncia en la consola
           IF PROCESO-REAL                                                                        IF PROCESO-REAL
               DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO REAL"                                   DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO REAL"
           ELSE                                                                                   ELSE
               DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO EN FALSO"                               DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO EN FALSO"
           END-IF                                                                                 END-IF

      * EL INDICADOR DE PROCESO REAL DEBE SER 1 O 2                                 |        * El indicador de proceso real debe ser 1 o 2
           IF P-PROCESO-REAL NOT = "1" AND "2"                                                    IF P-PROCESO-REAL NOT = "1" AND "2"
               DISPLAY "EL INDICADOR DE PROCESO REAL ES INVALIDO"                                     DISPLAY "EL INDICADOR DE PROCESO REAL ES INVALIDO"
               DISPLAY "DEBE SER 1 O 2"                                                               DISPLAY "DEBE SER 1 O 2"
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-IF                                                                                 END-IF

      * CONTROL DEL TIPO DE PROCESO, DEL NOMBRE DEL ARCHIVO                         |        * Control del tipo de proceso, del nombre del archivo
           EVALUATE P-TIPO-PROCESO                                                                EVALUATE P-TIPO-PROCESO
           WHEN "01"                                                                              WHEN "01"
               DISPLAY "01 ENVIO ORIGINAL - CARGA TOTAL 1A VEZ"                                       DISPLAY "01 ENVIO ORIGINAL - CARGA TOTAL 1A VEZ"
           WHEN "02"                                                                              WHEN "02"
               DISPLAY "02 ARCHIVO SEMANAL - CARGA PARCIAL"                                           DISPLAY "02 ARCHIVO SEMANAL - CARGA PARCIAL"
           WHEN "03"                                                                              WHEN "03"
               DISPLAY "03 ARCHIVO MENSUAL - CARGA PARCIAL"                                           DISPLAY "03 ARCHIVO MENSUAL - CARGA PARCIAL"
           WHEN "04"                                                                              WHEN "04"
               DISPLAY "04 REFRESQUE TOTAL - CARGA TOTAL"                                             DISPLAY "04 REFRESQUE TOTAL - CARGA TOTAL"
           WHEN OTHER                                                                             WHEN OTHER
      *        VALOR INVALIDO                                                       |        *        valor invalido
               DISPLAY "EL TIPO DE PROCESO " P-TIPO-PROCESO                                           DISPLAY "EL TIPO DE PROCESO " P-TIPO-PROCESO
               " ES INVALIDO (DEBE SER 01 02 03 O 04)"                                                " ES INVALIDO (DEBE SER 01 02 03 O 04)"
               PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                                          END-EVALUATE.

      * EDITA LA FECHA DE PROCESO DDMMAA DEL PARAMETRO EN FORMATO                   |        * Edita la fecha de proceso DDMMAA del parametro en formato
      * YYYYMMDD                                                                             * YYYYMMDD
           STRING "20" P-FECHA-PROCESO(5:6) P-FECHA-PROCESO(3:4)                                  STRING "20" P-FECHA-PROCESO(5:6) P-FECHA-PROCESO(3:4)
           P-FECHA-PROCESO(1:2) DELIMITED SIZE                                                    P-FECHA-PROCESO(1:2) DELIMITED SIZE
           INTO P-FECHA-PROCESO-YYYYMMDD                                                          INTO P-FECHA-PROCESO-YYYYMMDD
           DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD                                  DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD

      * CALCULA UNA FECHA 50 ANIOS POSTERIOR A LA DE PROCESO                        |        * Calcula una fecha 50 anios posterior a la de proceso
           MOVE P-FECHA-PROCESO-YYYYMMDD TO P-FECHA-PROCESO-50                                    MOVE P-FECHA-PROCESO-YYYYMMDD TO P-FECHA-PROCESO-50
           ADD 50 TO P-FECHA-PROCESO-50YYYY                                                       ADD 50 TO P-FECHA-PROCESO-50YYYY

      * APERTURA DEL ARCHIVO DE ENTRADA                                             |        * Apertura del archivo de entrada
           STRING "$TEMPORALES/" P-FILE-NAME INTO P-FILE-PATH                                     STRING "$TEMPORALES/" P-FILE-NAME INTO P-FILE-PATH
           OPEN INPUT JURAD                                                                       OPEN INPUT JURAD
           EVALUATE JURAD-FS                                                                      EVALUATE JURAD-FS
               WHEN "00"                                                                              WHEN "00"
                    CONTINUE                                                                               CONTINUE
               WHEN OTHER                                                                             WHEN OTHER
                   DISPLAY "ERROR EN OPEN DEL ARCHIVO JURAD "                                             DISPLAY "ERROR EN OPEN DEL ARCHIVO JURAD "
                   DISPLAY "PATH DEL ARCHIVO: " P-FILE-PATH                                               DISPLAY "PATH DEL ARCHIVO: " P-FILE-PATH
                   DISPLAY "FILE STATUS: " JURAD-FS                                                       DISPLAY "FILE STATUS: " JURAD-FS
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA                                           PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA
                   GOBACK                                                                                 GOBACK
           END-EVALUATE.                                                                          END-EVALUATE.

      * APERTURA DEL ARCHIVO DE ERRORES                                             |        * Apertura del archivo de errores
           STRING "$TEMPORALES/" P-FILE-NAME(1:19) ".ERRS"                                        STRING "$TEMPORALES/" P-FILE-NAME(1:19) ".ERRS"
           INTO ERRS-FILE-NAME                                                                    INTO ERRS-FILE-NAME
           OPEN OUTPUT ERRS                                                                       OPEN OUTPUT ERRS
           EVALUATE ERRS-FS                                                                       EVALUATE ERRS-FS
               WHEN "00"                                                                              WHEN "00"
                    CONTINUE                                                                               CONTINUE
               WHEN OTHER                                                                             WHEN OTHER
                   DISPLAY "ERROR EN OPEN DEL ARCHIVO DE ERRORES "                                        DISPLAY "ERROR EN OPEN DEL ARCHIVO DE ERRORES "
                   DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME                                          DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME
                   DISPLAY "FILE STATUS: " ERRS-FS                                                        DISPLAY "FILE STATUS: " ERRS-FS
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA                                           PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA
                   GOBACK                                                                                 GOBACK
           END-EVALUATE.                                                                          END-EVALUATE.

      * APERTURA DE LOS ARCHIVOS MAESTROS                                                    * APERTURA DE LOS ARCHIVOS MAESTROS
      * SI ALGÚN OPEN FALLA EL PROGRAMA CANCELA                                              * SI ALGÚN OPEN FALLA EL PROGRAMA CANCELA
           OPEN INPUT BDIIREGI                                                                    OPEN INPUT BDIIREGI
           OPEN INPUT BDIIDIAN                                                                    OPEN INPUT BDIIDIAN
           OPEN INPUT BDIIDAS.                                                                    OPEN INPUT BDIIDAS.

      * APERTURA DEL ARCHIVO DE ALERTAS EN LINEA                                             * APERTURA DEL ARCHIVO DE ALERTAS EN LINEA
           IF PROCESO-REAL                                                                        IF PROCESO-REAL
               OPEN I-O BDIIALE                                                                       OPEN I-O BDIIALE
           ELSE                                                                                   ELSE
               OPEN INPUT BDIIALE                                                                     OPEN INPUT BDIIALE
           END-IF.                                                                                END-IF.

      * SI ES UN REFRESQUE TOTAL (CODIGO 04) SE ELIMINAN LOS REGISTROS                       * SI ES UN REFRESQUE TOTAL (CODIGO 04) SE ELIMINAN LOS REGISTROS
      * DE JURAD EXISTENTES                                                                  * DE JURAD EXISTENTES
           IF P-TIPO-PROCESO = "04" AND PROCESO-REAL                                              IF P-TIPO-PROCESO = "04" AND PROCESO-REAL
               PERFORM 1001-ELIMINAR-TODO                                                             PERFORM 1001-ELIMINAR-TODO
           END-IF.                                                                                END-IF.


       1001-ELIMINAR-TODO.                                                                    1001-ELIMINAR-TODO.
      ******************************************************************                     ******************************************************************
      * ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE                         * ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE
      * ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL                                        * ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL
      ******************************************************************                     ******************************************************************
           DISPLAY "ELIMINANDO TODA LA INFORMACION CON FUENTE JURAD"                              DISPLAY "ELIMINANDO TODA LA INFORMACION CON FUENTE JURAD"
      *    POSICIONA EN EL PRIMER REG DE JURAD                                               *    POSICIONA EN EL PRIMER REG DE JURAD
           MOVE ZERO TO TIP-IDE-BDIIALE                                                           MOVE ZERO TO TIP-IDE-BDIIALE
           MOVE ZERO TO NUM-IDE-BDIIALE                                                           MOVE ZERO TO NUM-IDE-BDIIALE
           MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE                                                MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE
           MOVE ZEROS TO COD-ALERTA-BDIIALE                                                       MOVE ZEROS TO COD-ALERTA-BDIIALE
           MOVE LOW-VALUES TO LLASEC-BDIIALE                                                      MOVE LOW-VALUES TO LLASEC-BDIIALE
           START BDIIALE KEY > LLAVE-BDIIALE                                                      START BDIIALE KEY > LLAVE-BDIIALE
           EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
           WHEN "00"                                                                              WHEN "00"
      *        POSICIONADO                                                                   *        POSICIONADO
               CONTINUE                                                                               CONTINUE
           WHEN OTHER                                                                             WHEN OTHER
      *        NO HAY REGISTROS                                                              *        NO HAY REGISTROS
               DISPLAY "NO HAY REGISTROS A ELIMINAR FS:" EST-BDIIALE                                  DISPLAY "NO HAY REGISTROS A ELIMINAR FS:" EST-BDIIALE
               EXIT PARAGRAPH                                                                         EXIT PARAGRAPH
           END-EVALUATE.                                                                          END-EVALUATE.

      *    LEE SECUENCIALMENTE Y ELIMINA LOS REGISTROS DE JURAD                              *    LEE SECUENCIALMENTE Y ELIMINA LOS REGISTROS DE JURAD
      *    HASTA EL FIN DEL ARCHIVO                                                          *    HASTA EL FIN DEL ARCHIVO
           PERFORM UNTIL EST-BDIIALE NOT = "00"                                                   PERFORM UNTIL EST-BDIIALE NOT = "00"
               READ BDIIALE NEXT RECORD                                                               READ BDIIALE NEXT RECORD
               EVALUATE EST-BDIIALE                                                                   EVALUATE EST-BDIIALE
               WHEN "00"                                                                              WHEN "00"
                   IF FUENTE-BDIIALE = P-COD-SUSCRIPTOR                                                   IF FUENTE-BDIIALE = P-COD-SUSCRIPTOR
      *                ES UN ALERTA DE JURAD                                                 *                ES UN ALERTA DE JURAD
                       DELETE BDIIALE                                                                         DELETE BDIIALE
                       IF EST-BDIIALE = "00"                                                                  IF EST-BDIIALE = "00"
                           ADD 1 TO N-ALE-BORRADAS                                                                ADD 1 TO N-ALE-BORRADAS
                       ELSE                                                                                   ELSE
      *                    ERROR EN LA ELIMINACION                                           *                    ERROR EN LA ELIMINACION
                           DISPLAY "ERROR AL ELIMINAR UN REGISTRO DE "                                            DISPLAY "ERROR AL ELIMINAR UN REGISTRO DE "
                           "BDIIALE VACIANDO LOS DATOS"                                                           "BDIIALE VACIANDO LOS DATOS"
                           DISPLAY "CLAVE: " LLAVE-BDIIALE                                                        DISPLAY "CLAVE: " LLAVE-BDIIALE
                           DISPLAY "REG BORRADOS: " N-ALE-BORRADAS                                                DISPLAY "REG BORRADOS: " N-ALE-BORRADAS
                           PERFORM 9000-CANCELAR-PROGRAMA                                                         PERFORM 9000-CANCELAR-PROGRAMA
                       END-IF                                                                                 END-IF
                   END-IF                                                                                 END-IF
               WHEN "10"                                                                              WHEN "10"
      *            FIN DE ARCHIVO: SALE NORMALMENTE                                          *            FIN DE ARCHIVO: SALE NORMALMENTE
                   DISPLAY "FIN DE LOS REGISTROS A ELIMINAR - LEÍDOS:"              |                     DISPLAY "TERMINO LA ELIMINACION TOTAL DE JURAD"
                   N-ALE-LEIDAS                                                     |                     DISPLAY "REG BORRADOS: " N-ALE-BORRADAS
               WHEN OTHER                                                                             WHEN OTHER
      *            LECTURA ANORMAL: CANCELACION DEL PROGRAMA                                 *            LECTURA ANORMAL: CANCELACION DEL PROGRAMA
                   DISPLAY "ERROR EN LECTURA DEL ARCHIVO DE ALERTAS "                                     DISPLAY "ERROR EN LECTURA DEL ARCHIVO DE ALERTAS "
                   "ONLINE"                                                                               "ONLINE"
                   DISPLAY "FILE STATUS: " EST-BDIIALE                                                    DISPLAY "FILE STATUS: " EST-BDIIALE
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA                                           PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA
               END-EVALUATE                                                                           END-EVALUATE
           END-PERFORM.                                                                           END-PERFORM.
           DISPLAY "TERMINO LA ELIMINACION TOTAL DE JURAD"                          <  
           DISPLAY "REG BORRADOS: " N-ALE-BORRADAS.                                 <  


       7000-RUTINA-FINAL.                                                                     7000-RUTINA-FINAL.
      ******************************************************************                     ******************************************************************
      * Registra hora de finalizacion                                                        * Registra hora de finalizacion
           ACCEPT W-HORA-FIN FROM TIME                                                            ACCEPT W-HORA-FIN FROM TIME

      * Leer JURAD a ver si hay registros despues del "T"                                    * Leer JURAD a ver si hay registros despues del "T"

      * Close todos los archivos                                                             * Close todos los archivos
           CLOSE JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.                                    CLOSE JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.
           DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD                                  DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD
      * Emision de contadores de registros                                          <  
           display " "                                                                            display " "
           display "Totales de registros:"                                          <  
           display " "                                                              <  
      * Totales tipo PESVNO                                                                  * Totales tipo PESVNO
           DISPLAY "**************************************"                                       DISPLAY "**************************************"
           DISPLAY "        VALIDACION REGISTROS          "                                       DISPLAY "        VALIDACION REGISTROS          "
           DISPLAY "  BDIIREGIS BDIIDIAN BDIIDAS BDACSV   "                                       DISPLAY "  BDIIREGIS BDIIDIAN BDIIDAS BDACSV   "
           DISPLAY "**************************************                          |             DISPLAY "**************************************"
           DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5                          <  
           DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6                          <  
           DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7                          <  
           DISPLAY " "                                                                            DISPLAY " "
                                                                                    >             DISPLAY "REGISTROS MAL FORMADOS          :" REG-MAL-FORMADOS
           DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS                                 DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS
           DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS                              DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS
           DISPLAY "REGISTROS CUENTAS SIN VALIDAR   :" SI-EXISTE-CSV                              DISPLAY "REGISTROS CUENTAS SIN VALIDAR   :" SI-EXISTE-CSV
           DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS                          DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
           DISPLAY "REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOS                            DISPLAY "REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOS
           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN                           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN
           DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS                            DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS
           DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN                             DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN
           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO                           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO
           DISPLAY " "                                                                            DISPLAY " "
           DISPLAY "**************************************"                                       DISPLAY "**************************************"
           DISPLAY "        PORCENTAJE REGISTROS          "                                       DISPLAY "        PORCENTAJE REGISTROS          "
           DISPLAY "            PROCESADOS  OK            "                                       DISPLAY "            PROCESADOS  OK            "
           DISPLAY "**************************************                          |             DISPLAY "**************************************"
      *    PORCENTAJE REGISTROS PROCESADOS OK                                                *    PORCENTAJE REGISTROS PROCESADOS OK

           COMPUTE N-EDITP100 ROUNDED = 100.0 * N-REG-OK / N-REG-LEIDOS             |             COMPUTE N-EDITP100 ROUNDED = 100.0 * N-REG-PROCESADOS
                                                                                    >             / N-REG-LEIDOS
           DISPLAY N-EDITP100 "% DE REGISTROS CORRECTOS"                                          DISPLAY N-EDITP100 "% DE REGISTROS CORRECTOS"
           MOVE N-REG-OK TO N-EDIT                                                  |             MOVE N-REG-PROCESADOS TO N-EDIT
           DISPLAY N-EDIT "REGISTROS PROCESADOS SIN ERROR"                                        DISPLAY N-EDIT "REGISTROS PROCESADOS SIN ERROR"
           IF P-TIPO-PROCESO = "04"                                                               IF P-TIPO-PROCESO = "04"
               MOVE N-ALE-BORRADAS TO N-EDIT                                                          MOVE N-ALE-BORRADAS TO N-EDIT
               DISPLAY N-EDIT                                                                         DISPLAY N-EDIT
               "ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL"                                           "ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL"
           END-IF                                                                                 END-IF
           MOVE N-ALE-INSERTADAS TO N-EDIT                                                        MOVE N-ALE-INSERTADAS TO N-EDIT
           DISPLAY N-EDIT "ALERTAS INSERTADAS"                                                    DISPLAY N-EDIT "ALERTAS INSERTADAS"
           MOVE N-ALE-MODIFICADAS TO N-EDIT                                                       MOVE N-ALE-MODIFICADAS TO N-EDIT
           DISPLAY N-EDIT "ALERTAS MODIFICADAS"                                                   DISPLAY N-EDIT "ALERTAS MODIFICADAS"
           MOVE N-ALE-ELIMINADAS TO N-EDIT                                                        MOVE N-ALE-ELIMINADAS TO N-EDIT
           DISPLAY N-EDIT "ALERTAS ELIMINADAS"                                                    DISPLAY N-EDIT "ALERTAS ELIMINADAS"
           MOVE N-ALE-YA-EXISTE TO N-EDIT                                                         MOVE N-ALE-YA-EXISTE TO N-EDIT
           DISPLAY N-EDIT "INSERCION DE ALERTA EXISTENTE"                                         DISPLAY N-EDIT "INSERCION DE ALERTA EXISTENTE"
           MOVE N-ALE-NO-EXISTE TO N-EDIT                                                         MOVE N-ALE-NO-EXISTE TO N-EDIT
           DISPLAY N-EDIT "MODIF O ELIM DE ALERTA INEXISTENTE".                                   DISPLAY N-EDIT "MODIF O ELIM DE ALERTA INEXISTENTE".

                                                                                    >             DISPLAY " "
           DISPLAY "**************************************"                                       DISPLAY "**************************************"
           DISPLAY "            REPORTE ERRORES           "                                       DISPLAY "            REPORTE ERRORES           "
           DISPLAY "**************************************#                         |             DISPLAY "**************************************"
      * EMISION DEL REPORTE DE ERRORES                                                       * EMISION DEL REPORTE DE ERRORES
           DISPLAY " "                                                                            DISPLAY " "
           DISPLAY "TOTALES POR TIPO DE ERROR DETECTADO:"                                         DISPLAY "TOTALES POR TIPO DE ERROR DETECTADO:"
           PERFORM VARYING EX FROM 1 BY 1 UNTIL EX > 50                                           PERFORM VARYING EX FROM 1 BY 1 UNTIL EX > 50
           OR E-CODIGO(EX) = "00"                                                                 OR E-CODIGO(EX) = "00"
               IF E-CONTADOR(EX) NOT = 0                                                              IF E-CONTADOR(EX) NOT = 0
                   MOVE E-CONTADOR(EX) TO E-EDIT                                                          MOVE E-CONTADOR(EX) TO E-EDIT
                   DISPLAY E-EDIT E-CODIGO(EX) "-" E-DESCRIPCION(EX)                                      DISPLAY E-EDIT E-CODIGO(EX) "-" E-DESCRIPCION(EX)
               END-IF                                                                                 END-IF
           END-PERFORM.                                                                           END-PERFORM.


       9000-CANCELAR-PROGRAMA.                                                                9000-CANCELAR-PROGRAMA.
      ******************************************************************                     ******************************************************************
      * Procedimiento standard de cancelacion de programa batch                              * Procedimiento standard de cancelacion de programa batch
      ******************************************************************                     ******************************************************************
           DISPLAY " "                                                                            DISPLAY " "
           DISPLAY PGM " - PROCESO CANCELADO"                                                     DISPLAY PGM " - PROCESO CANCELADO"
           GOBACK RETURNING 99.                                                                   GOBACK RETURNING 99.


       513-VALIDA-EN-CSV.                                                                     513-VALIDA-EN-CSV.
      **************************************************************                         **************************************************************
      * Valida si la identificación está en la base de datos alterna                         * Valida si la identificación está en la base de datos alterna
      **************************************************************                         **************************************************************
      *    HACE VALIDACION DE TIPO DE IDENTIFICACION                                         *    HACE VALIDACION DE TIPO DE IDENTIFICACION
           MOVE TIPOID-E TO TIP-IDE-BDIIVIDE                                                      MOVE TIPOID-E TO TIP-IDE-BDIIVIDE
           MOVE NUMID-E TO NUM-IDE-BDIIVIDE                                                       MOVE NUMID-E TO NUM-IDE-BDIIVIDE
      *    RETORNA SW-TID-BDIIVIDE=0 SI EL NUM ID NO ESTÁ DENTRO                             *    RETORNA SW-TID-BDIIVIDE=0 SI EL NUM ID NO ESTÁ DENTRO
      *    DEL RANGO QUE CORRESPONDE AL TIPO DE ID                                           *    DEL RANGO QUE CORRESPONDE AL TIPO DE ID
           PERFORM 80400-VALIDAR-TIPO-ID                                                          PERFORM 80400-VALIDAR-TIPO-ID
           IF SW-TID-BDIIVIDE = 0                                                                 IF SW-TID-BDIIVIDE = 0
      *        EL TIPO DE ID ES OK                                                           *        EL TIPO DE ID ES OK
               IF HACER-MATCH = ZEROS                                                                 IF HACER-MATCH = ZEROS
                   MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH                                                MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH
                   MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH                                                MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
      *            SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA                              *            SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA
      *            IDENTIFICACION BUSCADA. EN CASO DE HALLAR                                 *            IDENTIFICACION BUSCADA. EN CASO DE HALLAR
      *            REGISTROS SE PROCEDE A REALIZAR EL MATCH                                  *            REGISTROS SE PROCEDE A REALIZAR EL MATCH
                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH                                                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH
                   IF IDE-TIPO-BDAMATCH = 1                                                               IF IDE-TIPO-BDAMATCH = 1
                       IF TIPOID-E = 1 OR 4                                                                   IF TIPOID-E = 1 OR 4
                           INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL                                              INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL
                           "," BY " ", ";" BY " "                                                                 "," BY " ", ";" BY " "
                       END-IF                                                                                 END-IF
                       MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM                                                   MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM
                       MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM                                        MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM
                       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM                                                  MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM
                       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                                      MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
                       PERFORM 10000-MATCH-NOMBRES-VALNOM                                                     PERFORM 10000-MATCH-NOMBRES-VALNOM
                       IF MATCH-OK-OUT-VALNOM = 1                                                             IF MATCH-OK-OUT-VALNOM = 1
                           MOVE 1 TO IDE-TIPO-BDAMATCH                                                            MOVE 1 TO IDE-TIPO-BDAMATCH
                       END-IF                                                                                 END-IF
                   END-IF                                                                                 END-IF

                   IF IDE-TIPO-BDAMATCH = 1                                                               IF IDE-TIPO-BDAMATCH = 1
                       ADD 1 TO SI-EXISTE-CSV                                                                 ADD 1 TO SI-EXISTE-CSV
                   END-IF                                                                                 END-IF
               END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

       9800-FILTRAR-ALFABETICO.                                                               9800-FILTRAR-ALFABETICO.
      ******************************************************************                     ******************************************************************
      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA                         * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
      ******************************************************************                     ******************************************************************
           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA                                MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA
           INITIALIZE CADENA-SALE                                                                 INITIALIZE CADENA-SALE
           MOVE 1 TO J                                                                            MOVE 1 TO J
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60                                             PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60
              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO                                              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO
              IF SI-ALFABETICO                                                                       IF SI-ALFABETICO
                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)                                           MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)
                 ADD 1 TO J                                                                             ADD 1 TO J
              END-IF                                                                                 END-IF
           END-PERFORM.                                                                           END-PERFORM.
      ******************************************************************                     ******************************************************************

           COPY BDIIVIDE.PROC.                                                                    COPY BDIIVIDE.PROC.
           copy BDLDIR.PROC.                                                                      copy BDLDIR.PROC.
           COPY BDAMATCH.PROC.                                                                    COPY BDAMATCH.PROC.
           COPY VALNOM.PROC.                                                                      COPY VALNOM.PROC.
      /                                                                                      /
       IDENTIFICATION DIVISION.                                                               IDENTIFICATION DIVISION.
       PROGRAM-ID. PONERR.                                                                    PROGRAM-ID. PONERR.
      ******************************************************************                     ******************************************************************
      * Rutina de conveniencia para procesar un error detectado en un                        * Rutina de conveniencia para procesar un error detectado en un
      * registro de input                                                                    * registro de input
      * Contabiliza el error en la tabla de errores, activa el indicador                     * Contabiliza el error en la tabla de errores, activa el indicador
      * de registro con error, muestra el mensaje en la pantalla, cuenta                     * de registro con error, muestra el mensaje en la pantalla, cuenta
      * el registro erroneo                                                                  * el registro erroneo
      ******************************************************************                     ******************************************************************
       ENVIRONMENT DIVISION.                                                                  ENVIRONMENT DIVISION.
       DATA DIVISION.                                                                         DATA DIVISION.
       WORKING-STORAGE SECTION.                                                               WORKING-STORAGE SECTION.
      ******************************************************************                     ******************************************************************
      * REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)                                           * REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)
       01  REG-INPUT-ANTERIOR           PIC X(86) VALUE LOW-VALUES.                           01  REG-INPUT-ANTERIOR           PIC X(86) VALUE LOW-VALUES.
      * POSICION DEL PROXIMO ERROR EN LA LISTA DE ERRORES DEL REG                            * POSICION DEL PROXIMO ERROR EN LA LISTA DE ERRORES DEL REG
       01  ERRINDEX                     PIC 999 COMP.                                         01  ERRINDEX                     PIC 999 COMP.
      ******************************************************************                     ******************************************************************

       LINKAGE SECTION.                                                                       LINKAGE SECTION.
      ******************************************************************                     ******************************************************************
      * CODIGO DEL ERROR DETECTADO                                                           * CODIGO DEL ERROR DETECTADO
       01  COD-ERROR                    PIC XX.                                               01  COD-ERROR                    PIC XX.
      ******************************************************************                     ******************************************************************
      * REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)                                           * REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)
       01  REG-INPUT                    PIC X(86).                                  |         01  REG-INPUT                    PIC X(102).
      ******************************************************************                     ******************************************************************
      * TABLA DE ERRORES DE CONSISTENCIA DEL INPUT                                           * TABLA DE ERRORES DE CONSISTENCIA DEL INPUT
       01 E-ERRORES.                                                                          01 E-ERRORES.
      *    INDICA SI EL REGISTRO ACTUAL TIENE ERROR                                          *    INDICA SI EL REGISTRO ACTUAL TIENE ERROR
           03 E-HAY-ERROR               PIC XX.                                                   03 E-HAY-ERROR               PIC XX.
                                                                                    >        *    INDICA SI EL REGISTRO ACTUAL IMPACTA LA BASE DE DATOS
                                                                                    >             03 E-IMPACTAR-BDIIALE        PIC XX.
      *    ERRORES DEL REGISTRO ACTUAL                                                       *    ERRORES DEL REGISTRO ACTUAL
           03 E-ERRORES-REG             PIC X(300).                                               03 E-ERRORES-REG             PIC X(300).
      *    CONTADOR DE REGISTROS CON ERROR                                                   *    CONTADOR DE REGISTROS CON ERROR
           03 E-CONT-REGS-CON-ERROR     PIC 9(8).                                                 03 E-CONT-REGS-CON-ERROR     PIC 9(8).
      *    TABLA DE ERRORES                                                                  *    TABLA DE ERRORES
           03 E-ERROR                   OCCURS 50 INDEXED EX.                                     03 E-ERROR                   OCCURS 50 INDEXED EX.
               05 E-CODIGO              PIC XX.                                                       05 E-CODIGO              PIC XX.
               05                       PIC X.                                      |                 05 E-IMPACTAR            PIC X.
               05 E-CONTADOR            PIC 9(7).                                                     05 E-CONTADOR            PIC 9(7).
               05                       PIC X.                                                        05                       PIC X.
               05 E-DESCRIPCION         PIC X(59).                                                    05 E-DESCRIPCION         PIC X(59).

      ******************************************************************                     ******************************************************************

       PROCEDURE DIVISION USING COD-ERROR REG-INPUT E-ERRORES.                                PROCEDURE DIVISION USING COD-ERROR REG-INPUT E-ERRORES.
       00.                                                                                    00.
      *    MARCA AL REG ACTUAL COMO ERRONEO                                         <  
           MOVE "SI" TO E-HAY-ERROR                                                 <  
                                                                                    <  
      *    CUENTA Y MUESTRA EL REGISTRO DE INPUT CON ERROR                                   *    CUENTA Y MUESTRA EL REGISTRO DE INPUT CON ERROR
           IF REG-INPUT NOT = REG-INPUT-ANTERIOR                                    |             IF E-HAY-ERROR NOT = "SI"
               ADD 1 TO E-CONT-REGS-CON-ERROR                                                         ADD 1 TO E-CONT-REGS-CON-ERROR
               DISPLAY " "                                                                            DISPLAY " "
               DISPLAY REG-INPUT                                                                      DISPLAY REG-INPUT
               MOVE REG-INPUT TO REG-INPUT-ANTERIOR                                                   MOVE REG-INPUT TO REG-INPUT-ANTERIOR
               MOVE SPACES TO E-ERRORES-REG                                                           MOVE SPACES TO E-ERRORES-REG
               MOVE 2 TO ERRINDEX                                                                     MOVE 2 TO ERRINDEX
           END-IF                                                                                 END-IF

                                                                                    >        *    MARCA AL REG ACTUAL COMO ERRONEO
                                                                                    >             MOVE "SI" TO E-HAY-ERROR
                                                                                    >  
      *    CONTABILIZA EL ERROR EN LA TABLA DE ERRORES                                       *    CONTABILIZA EL ERROR EN LA TABLA DE ERRORES
           SET EX TO 1                                                                            SET EX TO 1
           SEARCH E-ERROR VARYING EX                                                              SEARCH E-ERROR VARYING EX
           AT END                                                                                 AT END
               DISPLAY "--- FALLA EN LA TABLA DE ERRORES ---" COD-ERROR                               DISPLAY "--- FALLA EN LA TABLA DE ERRORES ---" COD-ERROR
           WHEN E-CODIGO(EX) = "00"                                                               WHEN E-CODIGO(EX) = "00"
               ADD 1 TO E-CONTADOR(EX)                                                                ADD 1 TO E-CONTADOR(EX)
               DISPLAY "--- ERROR TIPO EXOTICO: " COD-ERROR                                           DISPLAY "--- ERROR TIPO EXOTICO: " COD-ERROR
               ADD 1 TO E-CONTADOR(EX)                                                                ADD 1 TO E-CONTADOR(EX)
           WHEN E-CODIGO(EX) = COD-ERROR                                                          WHEN E-CODIGO(EX) = COD-ERROR
               ADD 1 TO E-CONTADOR(EX)                                                                ADD 1 TO E-CONTADOR(EX)
               DISPLAY "ERROR " COD-ERROR " " E-DESCRIPCION(EX)                                       DISPLAY "ERROR " COD-ERROR " " E-DESCRIPCION(EX)
                                                                                    >        *        si el error está marcado para impactar BDIIALE o no
                                                                                    >                 IF E-IMPACTAR(EX) NOT = "+"
                                                                                    >                     MOVE "NO" TO E-IMPACTAR-BDIIALE
                                                                                    >                 END-IF
           END-SEARCH                                                                             END-SEARCH

      *    AGREGA A LA LISTA DE ERRORES DEL REGISTRO                                         *    AGREGA A LA LISTA DE ERRORES DEL REGISTRO
           IF ERRINDEX < (300 - 59 - 3)                                                           IF ERRINDEX < (300 - 59 - 3)
               MOVE COD-ERROR TO E-ERRORES-REG(ERRINDEX:2)                                            MOVE COD-ERROR TO E-ERRORES-REG(ERRINDEX:2)
               ADD 3 TO ERRINDEX                                                                      ADD 3 TO ERRINDEX
               MOVE E-DESCRIPCION(EX) TO E-ERRORES-REG(ERRINDEX:59)                                   MOVE E-DESCRIPCION(EX) TO E-ERRORES-REG(ERRINDEX:59)
               ADD 59 TO ERRINDEX                                                                     ADD 59 TO ERRINDEX
           END-IF                                                                                 END-IF

           EXIT PROGRAM.                                                                          EXIT PROGRAM.


       END PROGRAM PONERR.                                                                    END PROGRAM PONERR.

       END PROGRAM CARGAJUR.                                                                  END PROGRAM CARGAJUR.

      ******************************************************************                     ******************************************************************
      ******************************************************************                     ******************************************************************
                                                                                    <  

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cat CARGAJUR.diff CARGAJUR.diff   r CARGAJUR.diffm CARGAJUR.diff
/d/iccol/desarrollo/fuentes>^[[A  /d/iccol/desarrollo/fuentes>rm CARGAJUR.diffcat CARGAJUR.diffvi CARGAJUR.diff sdiff -w 170 CARGAJUR.bup.CBL CARGAJUR.CBL > CARG>/d/iccol/desarrollo/fuentes>man sdiff                                         /d/iccol/desarrollo/fuentes>sdiff -w 170 CARGAJUR.bup.CBL CARGAJUR.CBL/d/iccol/desarrollo/fuentes>ls -l *JUR*                               /d/iccol/desarrollo/fuentes>
-rw-rw-r--   1 icrmbd   icdatacr   17397 Dec 20  2013 ACTALEJUR.CBL
-rw-rw-r--   1 icjlud   icdatacr   63624 Jun 25 16:38 CARGAJUR.bup.CBL
-rw-rw-r--   1 icdgd    icdatacr   62149 Jun 26 18:55 CARGAJUR.CBL
-rw-rw-r--   1 icvhfd   icdatacr 1383756 Sep  6  2010 ICGCON-JUR.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1577399 Dec 19  2013 ICGCONJURAD.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1781276 Dec 19  2013 ICGCPLJURAD.CBL
-rw-rw-r--   1 icehad   icdatacr 1772414 Jun  3 15:20 ICGCPLV258.CBL-JURAD
/d/iccol/desarrollo/fuentes>rm ^D  /d/iccol/desarrollo/fuentes>rm 
usage: rm [-fiRr] file ...
/d/iccol/desarrollo/fuentes>^D
