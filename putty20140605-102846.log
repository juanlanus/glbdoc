=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.05 10:28:46 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjluc d
Using keyboard-interactive authentication.
Password: 
Last login: Wed Jun  4 16:34:26 2014 from 172.16.10.88
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>
/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fu. visetview ICBSUSvire ICBSUScd $DATABASEcd          fgsh JL-padinputfg            sh JL-padinput              /vi CA*sh JL-padinput
"/tmp/sh25760.2" 1 line, 15 characters sh JL-padinput
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"/tmp/sh25760.2" 1 line, 15 charactersINSERT MODE:q
sh JL-padinput
sh JL-padinput
~:qNo write since last change (:quit! overrides):q!/d/iccol/desarrollo/fuentes>vi CARGAJUR.cbl               ls -l CARGAJUR*
-rw-rw-r--   1 icjlud   icdatacr   56035 May 22 10:01 CARGAJUR.cbl
-rw-rw-r--   1 icdgd    icdatacr   56024 May 22 14:41 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>co
/d/iccol/desarrollo/copys>grel -l "co  CODIGO-ERROR.¨07" *^[[D  /d/iccol/desarrollo/copys>grel -l "CODIGO-ERROR.¨07" * 
ksh: grel:  not found
/d/iccol/desarrollo/copys>^[  /d/iccol/desarrollo/copys>grel -l "CODIGO-ERROR.¨07"grepp -l "CODIGO-ERROR.*¨07"*07" 07" *
grep: can't open CARACTCAL-V02.PROC-BCK10
grep: can't open CARACTCAL-V02.PROC-BCK11
grep: can't open CARACTCAL-V02.PROC-BCK5
grep: can't open CARACTCAL-V02.PROC-BCK6
grep: can't open CARACTCAL-V02.PROC-BCK7
grep: can't open CARACTCAL-V02.PROC-BCK9
grep: can't open CARACTPER-009.PROC-2012-01-06
grep: can't open core
grep: can't open FRAINQ.DAT
/d/iccol/desarrollo/copys>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fugrep -l "CODIGO-ERROR.*07" *
grep: can't open CARACTNEW-EHA-V03.CBL-BCK1
grep: can't open ICGAA2.CBL
grep: can't open ICGAAM.CBL
grep: can't open ICGD11V02.diff
grep: can't open ICGD12V02.diff
grep: can't open ICGD13V01-02-20070206.diff
grep: can't open ICGD13V01-02.diff
grep: can't open ICGD15V05.diff
grep: can't open ICGD16V02.diff
grep: can't open ICGD17V02.diff
grep: can't open ICGD21V23.CBL-BCK1
grep: can't open ICGD22V23.CBL-BCK1
grep: can't open ICGD27V03.CBL-BCK1
grep: can't open ICGD27V03.CBL-BCK2
grep: can't open ICGD34V14.CBL-BCK1
grep: can't open ICGD44V06.CBL-BCK1
grep: can't open ICGD48V05.CBL-BCK1
grep: can't open ICGD48V06.CBL-BCK1
grep: can't open ICGD48V06.CBL-BCK2
grep: can't open ICGD60V01.CBL-BCK1
grep: can't open ICGD61.CBL-BCK1
grep: can't open ICGD61D-V01.CBL-BCK2
grep: can't open ICGD61D-V01.CBL-OK1
grep: can't open ICGD61D-V01.CBL-OK2
grep: can't open ICGD62D-V01.CBL-BCK1
grep: can't open ICGD62D.CBL-BCK
grep: can't open ICGD65D.CBL-BCK1
grep: can't open ICGD65D.CBL-BCK2
grep: can't open ICGD65D.CBL-BCK3
grep: can't open ICGD65D.CBL-BCK4
grep: can't open ICGD65D.CBL-BCK5
grep: can't open ICGD65DV1.CBL-BCK1
grep: can't open ICGD65DV1.CBLICGD65DV1.CBL-BCK2
grep: can't open ICGD67D-V01.CBL-BCK1
grep: can't open ICGD67D-V01.CBL-BCK10
grep: can't open ICGD67D-V01.CBL-BCK11
grep: can't open ICGD67D-V01.CBL-BCK12
grep: can't open ICGD67D-V01.CBL-BCK13
grep: can't open ICGD67D-V01.CBL-BCK14
grep: can't open ICGD67D-V01.CBL-BCK15
grep: can't open ICGD67D-V01.CBL-BCK2
grep: can't open ICGD67D-V01.CBL-BCK3
grep: can't open ICGD67D-V01.CBL-BCK4
grep: can't open ICGD67D-V01.CBL-BCK5
grep: can't open ICGD67D-V01.CBL-BCK6
grep: can't open ICGD67D-V01.CBL-BCK7
grep: can't open ICGD67D-V01.CBL-BCK8
grep: can't open ICGD67D-V01.CBL-BCK9
grep: can't open ICGD67D.CBL-BCK1
grep: can't open ICGD70D-V01.CBL-BCK1
grep: can't open ICGD70D-V01.CBL-BCK10
grep: can't open ICGD70D-V01.CBL-BCK2
grep: can't open ICGD70D-V01.CBL-BCK3
grep: can't open ICGD70D-V01.CBL-BCK4
grep: can't open ICGD70D-V01.CBL-BCK5
grep: can't open ICGD70D-V01.CBL-BCK6
grep: can't open ICGD70D-V01.CBL-BCK7
grep: can't open ICGD70D-V01.CBL-BCK8
grep: can't open ICGD70D-V01.CBL-BCK9
grep: can't open ICGS10V09-10-20070214.diff
grep: can't open ICGS10V09-10-20070215.diff
grep: can't open ICGS14V03-04.diff-XDHOST
grep: can't open ICGS46V03.CBL-BCK1
grep: can't open ICGS46V03.CBL-BCK2
grep: can't open ICGS46V03.CBL-BCK3
grep: can't open ICGS46V03.CBL-BCK4
grep: can't open ICGS60D-V01.CBL-BCK1
grep: can't open ICGS60D-V01.CBL-BCK2
grep: can't open ICGS60D-V01.CBL-BCK3
grep: can't open ICGS60D-V01.CBL-BCK4
grep: can't open ICGS60D-V01.CBL-BCK5
grep: can't open ICGS60D-V01.CBL-BCK6
grep: can't open ICGS60D-V01.CBL-BCK7
grep: can't open LISTASU.CBL
grep: can't open LISTASUS.CBL
grep: can't open nohup.out
P_PESVNO.CBL
P_PESVNOCSVBCS.CBL
P_PESVNOCSVFNG.CBL
P_PESVNOCSVPLUS.CBL
PES.CBL
PESVNO-AVV.CBL
PESVNO-CV.CBL
PESVNO-DIGITO.CBL
PESVNO-V02.CBL
PESVNO-V03.CBL
pesvno.cbl
PESVNO.CBL
PESVNO.CBL-20101014
PESVNO.CBL-lag
PESVNO0504.CBL
PESVNO64.CBL
PESVNOCSV_cg.CBL
PESVNOCSV-V05.CBL
PESVNOCSV.CBL
PESVNOCSV.CBL-lag
PESVNOCSV.CBL-ORI
PESVNOCSVBCS_CAL.CBL
PESVNOCSVBCS_p.CBL
PESVNOCSVBCS.CBL
PESVNOCSVBCSv06.CBL
PESVNOCSVc.CBL
PESVNOCSVFNG.CBL
PESVNOCSVFNG.CBL-lag
PESVNOCSVPLUS.CBL
PESVNOCSVPLUS.CBL-lag
PESVNOCSVPLUSc.CBL
PESVNOCSVPLUSv06.CBL
PESVNOCSVSEGE-V02.CBL
PESVNOCSVSEGE-V03.CBL
PESVNOCSVSEGE-V04.CBL
PESVNOCSVSEGE.CBL
PESVNOCSVSEGE.CBL-bckup
PESVNOCSVSEGE.CBL-V01
PESVNOCSVSEGElag.CBL
PESVNOCSVTMX.CBL
PESVNOCSVv06.CBL
PESVNOGJ.CBL
PESVNONW1.CBL
PESVNOPEO.CBL
PESVNOpv.CBL
pesvnormb.cbl
PESVNORMB.CBL
PESVNORMB.CBL-bckup
PESVNORMBNW-EHA.CBL
PESVNORMBNW.CBL
PESVNORMBNW.CBL-20100813
PESVNORMBNW.CBL-bckup
PESVNORMBNW.CBL-bckupM
PESVNORMBNW.CBL-bk-20100812
PESVNOSEGE2.CBL
pesvnotest.cbl
PESVNOTEST.CBL
PESVNOv09.CBL
PESVNOv10.CBL
grep: can't open PRUCOMP-3.CBL
grep: can't open UTLCITREP.CBL-OK1
grep: can't open UTLCITREP.CBL-OK2
grep: can't open UTLESTLEY.CBL-BCK1
grep: can't open UTLESTLEY.CBL-BCK2
xxxxxxxxxxx.cbl
/d/iccol/desarrollo/fuentes>^C
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>grep -l "CODIGO-ERROR.*07" *grep -l "CODIGO-ERROR.*07" * 2> /dev/null > qqq
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 60 lines, 1047 characters P_PESVNO.CBL
P_PESVNOCSVBCS.CBL
P_PESVNOCSVFNG.CBL
P_PESVNOCSVPLUS.CBL
PES.CBL
PESVNO-AVV.CBL
PESVNO-CV.CBL
PESVNO-DIGITO.CBL
PESVNO-V02.CBL
PESVNO-V03.CBL
pesvno.cbl
PESVNO.CBL
PESVNO.CBL-20101014
PESVNO.CBL-lag
PESVNO0504.CBL
PESVNO64.CBL
PESVNOCSV_cg.CBL
PESVNOCSV-V05.CBL
PESVNOCSV.CBL
PESVNOCSV.CBL-lag
PESVNOCSV.CBL-ORI
PESVNOCSVBCS_CAL.CBL
PESVNOCSVBCS_p.CBL
PESVNOCSVBCS.CBL
PESVNOCSVBCSv06.CBL
PESVNOCSVc.CBL
PESVNOCSVFNG.CBL
PESVNOCSVFNG.CBL-lag
PESVNOCSVPLUS.CBL
PESVNOCSVPLUS.CBL-lag
PESVNOCSVPLUSc.CBL
PESVNOCSVPLUSv06.CBL
PESVNOCSVSEGE-V02.CBL
PESVNOCSVSEGE-V03.CBL
PESVNOCSVSEGE-V04.CBL
PESVNOCSVSEGE.CBL
PESVNOCSVSEGE.CBL-bckup
PESVNOCSVSEGE.CBL-V01
PESVNOCSVSEGElag.CBL
PESVNOCSVTMX.CBL
PESVNOCSVv06.CBL
PESVNOGJ.CBL
PESVNONW1.CBL
PESVNOPEO.CBL
PESVNOpv.CBL
pesvnormb.cbl
PESVNORMB.CBL
PESVNORMB.CBL-bckup
PESVNORMBNW-EHA.CBL"qqq" 60 lines, 1047 characters:wq/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi qqqgrep -l "CODIGO-ERROR.*07" * 2> /dev/null > qqq/d/iccol/desarrollo/fuentes>grep -l "CODIGO-ERROR.*=07" * 2> /dev/null > qqq.07" * 2> /dev/null > qqq*07" * 2> /dev/null > qq>
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 60 lines, 1047 characters P_PESVNO.CBL
P_PESVNOCSVBCS.CBL
P_PESVNOCSVFNG.CBL
P_PESVNOCSVPLUS.CBL
PES.CBL
PESVNO-AVV.CBL
PESVNO-CV.CBL
PESVNO-DIGITO.CBL
PESVNO-V02.CBL
PESVNO-V03.CBL
pesvno.cbl
PESVNO.CBL
PESVNO.CBL-20101014
PESVNO.CBL-lag
PESVNO0504.CBL
PESVNO64.CBL
PESVNOCSV_cg.CBL
PESVNOCSV-V05.CBL
PESVNOCSV.CBL
PESVNOCSV.CBL-lag
PESVNOCSV.CBL-ORI
PESVNOCSVBCS_CAL.CBL
PESVNOCSVBCS_p.CBL
PESVNOCSVBCS.CBL
PESVNOCSVBCSv06.CBL
PESVNOCSVc.CBL
PESVNOCSVFNG.CBL
PESVNOCSVFNG.CBL-lag
PESVNOCSVPLUS.CBL
PESVNOCSVPLUS.CBL-lag
PESVNOCSVPLUSc.CBL
PESVNOCSVPLUSv06.CBL
PESVNOCSVSEGE-V02.CBL
PESVNOCSVSEGE-V03.CBL
PESVNOCSVSEGE-V04.CBL
PESVNOCSVSEGE.CBL
PESVNOCSVSEGE.CBL-bckup
PESVNOCSVSEGE.CBL-V01
PESVNOCSVSEGElag.CBL
PESVNOCSVTMX.CBL
PESVNOCSVv06.CBL
PESVNOGJ.CBL
PESVNONW1.CBL
PESVNOPEO.CBL
PESVNOpv.CBL
pesvnormb.cbl
PESVNORMB.CBL
PESVNORMB.CBL-bckup
PESVNORMBNW-EHA.CBL"qqq" 60 lines, 1047 characters:r P_PESVNO.CBL"P_PESVNO.CBL" 919 lines, 42879 characters 
      * PESVNOCSV.V.01.0006.
       IDENTIFICATION DIVISION.
       PROGRAM-ID. PESVNO.
       AUTHOR. DATACREDITO.
       DATE-WRITTEN. MAYO/2001.
       DATE-COMPILED.
      ******************************************************************
      * PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
      * EXTRANJERIA.
      *
      * Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
      *
      * Cliente : Datacredito
      *
      * Version : 09/06/2008 09:08:25 a.m.
      ******************************************************************
      *  Validacion especial tomando el archivo de
      *  Cuentas Sin Validar para poder reportalos en el informe final
      *
      ******************************************************************
REMARK* LAG0002      * PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ      * PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*
REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**
REMARK******************************************************************
REMARK* LAG0004      * REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **
REMARK******************************************************************
      ******************************************************************
      * GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
      * FEB.09-2010|    FORMATO TIPO 8.*
      * GER.DESARR.|   *
      ******************************************************************
      * EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
      * MAY.05-2010|    ESCRITURA DE REGISTROS*
      * GER.DESARR.|*
      ******************************************************************
      *
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. MICROFOCUS.
       OBJECT-COMPUTER. MICROFOCUS.
       INPUT-OUTPUT SECTION.
           COPY BDIIDIAN.FS./codigo-error.*=.*7PAM460*MOVE   "O"TO ORIGEN-VAL
PAM460*END-IF
WRITE REG-VALIDAS
ADD 1 TO REG-CORRECTOS
END-IF
END-IF
ELSE
IF TIPOID-E = 4
MOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE ZEROSTO VIG-VALEND-IF
MOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE NUMID-ETO CED-VAL CED-INC
PAM460*IF ORIGEN-VAL = SPACES
PAM460*MOVE    "O"TO ORIGEN-VAL
PAM460*END-IF
WRITE REG-VALIDAS
ADD 1 TO REG-CORRECTOSEND-IF
END-IF
END-IF
END-IF
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD  1 TO W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1  TO W-CONT-TIPO-7ELSE
ADD 1  TO W-CONT-TIPO-5END-IF
END-IF
READ ENTRADA
AT END
MOVE 1 TO FIN-ENTRADANOT AT END
INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READ.505-RANGO-EDADES.
*--------------------------------------------------*
*505-RANGO-EDADES.
*  RANGO MUJERES: 20'000.001 A 70'000.000
*  RANGO HOMBRES:1 A 20'000.000
*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)
*--------------------------------------------------*MOVE FEC-EXP-VALTO  W-FEC-EXPE/WHEN ANY
MOVE " N/A " TO EDAD-RANGOEND-EVALUATE.
****************************************************************
*510-ESCRIBIR-INCONS.
* BUSCA ERROR
* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS
****************************************************************
510-ESCRIBIR-INCONS.IF CODIGO-ERROR = 02 AND SW-ERROR = 1MOVE TIPOID-E TO TIP-INC.IF SW-ERROR = 1
PERFORM 512-CREE-REGISTROWRITE REG-INCONS.**************************************************************
*512-CREE-REGISTRO.
* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC
**************************************************************
512-CREE-REGISTRO.MOVE TIPOID-E TO TIP-INCMOVE NUMID-E  TO CED-INCFAC0019MOVE NOMBRE-E TO NOM1-INCIF CODIGO-ERROR = 02 OR 01 OR 06 OR 07MOVE NOM-VAL-BDIIVIDE TO NOM2-INCELSE
MOVE SPACESTO NOM2-INC
MUN-EXP-INC
DEP-EXP-INC
VIG-INCMOVE ZEROSTO FEC-EXP-INCMOVE FILLER-2-E  TO FILLER-2-INCEND-IF.**************************************************************
*513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA
**************************************************************
513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROS
OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI/7.*codigo-errorAddress search hit BOTTOM without matching pattern?NOT INVALID KEY MOVE 0 TO SW-BDIIALEREAD BDIIALE NEXT RECORD
AT END MOVE 1 TO SW-BDIIALEEND-READ
END-START
PERFORM UNTIL SW-BDIIALE = 1 OR
TIPOID-E <> TIP-IDE-BDIIALE ORNUMID-E <> NUM-IDE-BDIIALE
IF FUENTE-BDIIALE = 990003 AND
FEC-NOV-BDIIALE <= FECHA-PROC-R ANDFEC-VEN-BDIIALE >= FECHA-PROC-R ANDBLOQUEO-BDIIALE = 0
MOVE 1 TO SW-BDIIALE
END-IF
IF SW-BDIIALE = 0
READ BDIIALE NEXT RECORD
AT END MOVE 1 TO SW-BDIIALE
END-READ
END-IF
END-PERFORM
IF TIPOID-E = 1
IF ESTADO-VIG-BDIIREGI = 12 ANDW-DERECHOS = 1
MOVE  07   TO  CODIGO-ERROR CODERR-INCMOVE   1   TO  SW-ERROR
MOVE "00"  TO  VIG-INC
PERFORM 510-ESCRIBIR-INCONSELSE
IF ESTADO-VIG-BDIIREGI = 21
MOVE  06  TO CODIGO-ERROR CODERR-INCMOVE   1  TO SW-ERROR
MOVE "21" TO VIG-INC
PERFORM 510-ESCRIBIR-INCONS
ADD   1   TO NO-COINCIDE-REGISELSE
PERFORM 810-BUSCAR-MUNICIPIO
MOVE TIPOID-E TO TIP-VAL TIP-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51
ADD 1900 TO ANO-2000-R
ELSE
ADD 2000 TO ANO-2000-R
END-IF
MOVE FECHA-2000 TO FEC-EXP-VAL
FEC-EXP-INC
IF ESTADO-VIG-BDIIREGI = 12 OR = 27
MOVE "00" TO VIG-VAL VIG-INC
ELSE:qNo write since last change (:quit! overrides):q!/d/iccol/desarrollo/fuentes>rm qqq
/d/iccol/desarrollo/fuentes>
shell will timeout in 60 seconds due to inactivity

/d/iccol/desarrollo/fuentes>sdiff -w 170 PEVSNOCSV.CBL o PEVSNOCSVPLUS.CBL
Usage: sdiff [-l] [-s] [-o output] [-w #] file1 file2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>sdiff -w 170 PEVSNOCSV.CBL o PEVSNOCSVPLUS.CBL/d/iccol/desarrollo/fuentes>sdiff -w 170 PEVSNOCSV.CBL  PEVSNOCSVPLUS.CBL  PEVSNOCSVPLUS.CBL > q/d/iccol/desarrollo/fuentes>L  PEVSNOCSVPLUS.CBL > qq                        <q
sdiff: Cannot open: PEVSNOCSV.CBL
/d/iccol/desarrollo/fuentes>ls -l Cannot open: PEVSNOCSV.CBL    *
Cannot: No such file or directory
open:: No such file or directory
PEVSNOCSV*: No such file or directory
/d/iccol/desarrollo/fuentes>ls^[  /d/iccol/desarrollo/fuentes>lss -l Cannot open: PEVSNOCSV*/d/iccol/desarrollo/fuentes>sdiff -w 170 PEVSNOCSV.CBL  PEVSNOCSVPLUS.CBL > q>/d/iccol/desarrollo/fuentes>sdiff -w 170 PEVSNOCSV.CBL o PEVSNOCSVPLUS.CBL    /d/iccol/desarrollo/fuentes>sdiff -w 170 PEVSNOCSV.CBL  PEVSNOCSVPLUS.CBL > q>/d/iccol/desarrollo/fuentes>ls -l Cannot open: PEVSNOCSV*                     /d/iccol/desarrollo/fuentes>ls -l open: PEVSNOCSV*       : PEVSNOCSV*    PEVSNOCSV*  
PEVSNOCSV*: No such file or directory
/d/iccol/desarrollo/fuentes>ls -l PESVNOCSV.CBL
-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
/d/iccol/desarrollo/fuentes>sdiff -w 170 PESVNOCSV.CBL
Usage: sdiff [-l] [-s] [-o output] [-w #] file1 file2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>sdiff -w 170 PESVNOCSV.CBLsdiff -w 170 PESVNOCSV.CBL PESVNOCSVPLUS.CBL
      * PESVNOCSV.V.01.0012                                                         |        * PESVNOCSVPLUS.V.01.0013
       IDENTIFICATION DIVISION.                                                               IDENTIFICATION DIVISION.
       PROGRAM-ID. PESVNO.                                                                    PROGRAM-ID. PESVNO.
       AUTHOR. DATACREDITO.                                                                   AUTHOR. DATACREDITO.
       DATE-WRITTEN. MAYO/2001.                                                               DATE-WRITTEN. MAYO/2001.
       DATE-COMPILED.                                                                         DATE-COMPILED.
      ******************************************************************                     ******************************************************************
      * PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE         *                     * PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE         *
      * EXTRANJERIA.                                                                         * EXTRANJERIA.
      *                                                                                      *
      * Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV                                  * Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
      *                                                                                      *
      * Cliente : Datacredito                                                                * Cliente : Datacredito
      *                                                                                      *
      * Version : 09/06/2008 09:08:25 a.m.                                                   * Version : 09/06/2008 09:08:25 a.m.
      ******************************************************************                     ******************************************************************
      *  Validacion especial tomando el archivo de                                           *  Validacion especial tomando el archivo de
      *  Cuentas Sin Validar para poder reportalos en el informe final                       *  Cuentas Sin Validar para poder reportalos en el informe final
      *                                                                                      *
      ******************************************************************                     ******************************************************************
REMARK* LAG0002      * PAM372 - SEPARADORES ";" EN INCONSISTENCIAS                     REMARK* LAG0002      * PAM372 - SEPARADORES ";" EN INCONSISTENCIAS       
REMARK* L.GOMEZ      * PARA IGUALARLO AL PESVNO                                        REMARK* L.GOMEZ      * PARA IGUALARLO AL PESVNO                       
REMARK* SEPT. 30/2009*                                                                 REMARK* SEPT. 30/2009* 
REMARK*******************************************************************              REMARK*******************************************************************
REMARK* GJC0003      * CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*               REMARK* GJC0003      * CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.              *               REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.              *
REMARK* GRACIELA JIM.*                                                 *               REMARK* GRACIELA JIM.*                                                 *
REMARK******************************************************************               REMARK******************************************************************
REMARK* LAG0004      * REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*               REMARK* LAG0004      * REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.        *               REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.        *
REMARK* G.DESARROLLO *                                                 *               REMARK* G.DESARROLLO *                                                 *
REMARK******************************************************************               REMARK******************************************************************
      ******************************************************************                     ******************************************************************
      * GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *                     * GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
      * FEB.09-2010|    FORMATO TIPO 8.                                *                     * FEB.09-2010|    FORMATO TIPO 8.                                *
      * GER.DESARR.|                                                   *                     * GER.DESARR.|                                                   *
      ******************************************************************                     ******************************************************************
      * EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *                     * EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
      * MAY.05-2010|    ESCRITURA DE REGISTROS                         *                     * MAY.05-2010|    ESCRITURA DE REGISTROS                         *
      * GER.DESARR.|                                                   *                     * GER.DESARR.|                                                   *
      ******************************************************************                     ******************************************************************
      * LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *                     * LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
      * OCT.07-2010|    EN TIPOS ID DIFERENTE A 1                      *                     * OCT.07-2010|    EN TIPOS ID DIFERENTE A 1                      *
      * GER.DESARR.|                                                   *                     * GER.DESARR.|                                                   *
      ******************************************************************                     ******************************************************************
      * LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *                     * LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
      * OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA                    *                     * OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA                    *
      * GER.DESARR.|                                                   *                     * GER.DESARR.|                                                   *
      ******************************************************************                     ******************************************************************
      * RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *                     * RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
      * AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS         *                     * AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS         *
      * GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *                     * GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *
      *            | R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *                     *            | R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
      ******************************************************************                     ******************************************************************
      * PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.             *                     * PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.             *
      * SEP-01-2012|                                                   *                     * SEP-01-2012|                                                   *
      * GER.DESARR.|                                                   *                     * GER.DESARR.|                                                   *
      ******************************************************************                     ******************************************************************
      * PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES        *                     * PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES        *
      * ABR-02-2013| REPETIDAS VALIDAS.                                *                     * ABR-02-2013| REPETIDAS VALIDAS.                                *
      * GER.DESARR.|                                                   *                     * GER.DESARR.|                                                   *
      ******************************************************************                     ******************************************************************
      * PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES       *                     * PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES       *
      * JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *                     * JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
      * PEDRO V.   |                                                   *                     * PEDRO V.   |                                                   *
      ******************************************************************                     ******************************************************************
                                                                                    >        * STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
                                                                                    >        * JUL-31-2013|                                                   *
                                                                                    >        * LUIS GOMEZ |                                                   *
                                                                                    >        ******************************************************************
      *                                                                                      *
       ENVIRONMENT DIVISION.                                                                  ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.                                                                 CONFIGURATION SECTION.
       SOURCE-COMPUTER. MICROFOCUS.                                                           SOURCE-COMPUTER. MICROFOCUS.
       OBJECT-COMPUTER. MICROFOCUS.                                                           OBJECT-COMPUTER. MICROFOCUS.
       INPUT-OUTPUT SECTION.                                                                  INPUT-OUTPUT SECTION.
           COPY BDIIDIAN.FS.                                                                      COPY BDIIDIAN.FS.
           COPY BDIIREGI.FS.                                                                      COPY BDIIREGI.FS.
           COPY BDIIDAS.FS.                                                                       COPY BDIIDAS.FS.
           COPY ICBTCO.FS.                                                                        COPY ICBTCO.FS.
           COPY ICBCLA0001.FS.                                                                    COPY ICBCLA0001.FS.
           COPY ICBCIU.FS.                                                                        COPY ICBCIU.FS.
CTAST8*    COPY  ICBCHK.FS.                                             GDT0005        CTAST8*    COPY  ICBCHK.FS.                                             GDT0005
CTAST8     COPY  ICBCHK0001.FS.                                         GDT0005        CTAST8     COPY  ICBCHK0001.FS.                                         GDT0005
           COPY ICBCRE.FS.                                                                        COPY ICBCRE.FS.
           COPY ICBSUS.FS.                                                                        COPY ICBSUS.FS.
           COPY BDLCLI.FS.                                                                        COPY BDLCLI.FS.
           COPY ICBDIR.FS.                                                                        COPY ICBDIR.FS.
           COPY ICMUNI.FS.                                                                        COPY ICMUNI.FS.
           COPY BDIIALE.FS.                                                                       COPY BDIIALE.FS.
           COPY BDLSTDCIU.FS.                                                                     COPY BDLSTDCIU.FS.
           COPY BDLNEWDIRBOG.FS.                                                                  COPY BDLNEWDIRBOG.FS.
           COPY DIREST.FS.                                                                        COPY DIREST.FS.
           COPY NOAMNISTIA21.FS.                                                                  COPY NOAMNISTIA21.FS.
           COPY BDACSV.FS.                                                                        COPY BDACSV.FS.

           SELECT ENTRADA  ASSIGN TO DISK W-ENTRADA                                               SELECT ENTRADA  ASSIGN TO DISK W-ENTRADA
                  ORGANIZATION IS LINE SEQUENTIAL                                                        ORGANIZATION IS LINE SEQUENTIAL
                  ACCESS MODE  IS SEQUENTIAL.                                                            ACCESS MODE  IS SEQUENTIAL.

           SELECT VALIDAS  ASSIGN TO DISK W-VALIDAS                                               SELECT VALIDAS  ASSIGN TO DISK W-VALIDAS
                  ORGANIZATION IS LINE SEQUENTIAL                                                        ORGANIZATION IS LINE SEQUENTIAL
                  ACCESS MODE  IS SEQUENTIAL.                                                            ACCESS MODE  IS SEQUENTIAL.

PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REP             CQ11407        PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REP             CQ11407
PJV011            ORGANIZATION IS LINE SEQUENTIAL                       CQ11407        PJV011            ORGANIZATION IS LINE SEQUENTIAL                       CQ11407
PJV011            ACCESS MODE  IS SEQUENTIAL.                           CQ11407        PJV011            ACCESS MODE  IS SEQUENTIAL.                           CQ11407

           SELECT INCONS   ASSIGN TO DISK W-INVALIDAS                                             SELECT INCONS   ASSIGN TO DISK W-INVALIDAS
                  ORGANIZATION IS LINE SEQUENTIAL                                                        ORGANIZATION IS LINE SEQUENTIAL
                  ACCESS MODE  IS SEQUENTIAL.                                                            ACCESS MODE  IS SEQUENTIAL.

       DATA DIVISION.                                                                         DATA DIVISION.
       FILE SECTION.                                                                          FILE SECTION.
       COPY ICBCHK.FD.                                                                        COPY ICBCHK.FD.
       COPY ICBSUS.FD.                                                                        COPY ICBSUS.FD.
       COPY BDACSV.FD.                                                                        COPY BDACSV.FD.
       COPY ICBDIR0001.FD.                                                                    COPY ICBDIR0001.FD.
       COPY BDLSTDCIU.FD.                                                                     COPY BDLSTDCIU.FD.
       COPY DIREST.FD.                                                                        COPY DIREST.FD.
       COPY BDLNEWDIRBOG.FD.                                                                  COPY BDLNEWDIRBOG.FD.
       COPY NOAMNISTIA21.FD.                                                                  COPY NOAMNISTIA21.FD.
       COPY BDIIDIAN.FD.                                                                      COPY BDIIDIAN.FD.
       COPY BDIIREGI.FD.                                                                      COPY BDIIREGI.FD.
       COPY BDIIDAS.FD.                                                                       COPY BDIIDAS.FD.
       COPY ICBTCO001.FD.                                                                     COPY ICBTCO001.FD.
       COPY ICBCLA.FD.                                                                        COPY ICBCLA.FD.
       COPY ICBCIU.FD.                                                                        COPY ICBCIU.FD.
       COPY ICBCRE.FD.                                                                        COPY ICBCRE.FD.
       COPY BDLCLI.FD.                                                                        COPY BDLCLI.FD.
       COPY ICMUNI.FD.                                                                        COPY ICMUNI.FD.
       COPY BDIIALE.FD.                                                                       COPY BDIIALE.FD.

       FD  ENTRADA.                                                                           FD  ENTRADA.
       01  REG-ENTRADA.                                                                       01  REG-ENTRADA.
           03 TIPOID-E                      PIC   9(01).                                          03 TIPOID-E                      PIC   9(01).
           03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).                                          03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).
           03 NUMID-E                       PIC   9(11).                                          03 NUMID-E                       PIC   9(11).
           03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).                                          03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).
           03 NOMBRE-E                      PIC   X(45).                                          03 NOMBRE-E                      PIC   X(45).
           03 FILLER-2-E                    PIC   X(60).                            |  PJV012*    03 FILLER-2-E                    PIC   X(360).               CQ12657
                                                                                    >  STT013     03 FILLER-2-E                    PIC   X(660).               CQ12837

       FD  VALIDAS.                                                                           FD  VALIDAS.
       01  REG-VALIDAS.                                                                       01  REG-VALIDAS.
           03 TIP-VAL                   PIC 9.                                                    03 TIP-VAL                   PIC 9.
           03 CED-VAL                   PIC 9(11).                                                03 CED-VAL                   PIC 9(11).
           03 NOM-VAL                   PIC X(45).                                                03 NOM-VAL                   PIC X(45).
           03 FEC-EXP-VAL               PIC 9(08).                                                03 FEC-EXP-VAL               PIC 9(08).
           03 MUN-EXP-VAL               PIC X(15).                                                03 MUN-EXP-VAL               PIC X(15).
           03 DEP-EXP-VAL               PIC X(15).                                                03 DEP-EXP-VAL               PIC X(15).
           03 VIG-VAL                   PIC X(02).                                                03 VIG-VAL                   PIC X(02).
           03 GENERO-VAL                PIC X(01).                                                03 GENERO-VAL                PIC X(01).
           03 EDAD-VAL                  PIC X(03).                                                03 EDAD-VAL                  PIC X(03).
           03 EDAD-RANGO                PIC X(05).                                                03 EDAD-RANGO                PIC X(05).
PAM460     03 ORIGEN-VAL                PIC X.                                      |  PJV012     03 ORIGEN-VAL                PIC X.                          CQ12657
PJV012     03 FILLER-2-VAL              PIC X(50).                      CQ12657     |  PJV012*    03 FILLER-2-VAL              PIC X(350).                     CQ12657
                                                                                    >  STT013     03 FILLER-2-VAL              PIC X(650).                     CQ12837

PJV011 FD  VALIDAS-REP.                                                 CQ11407        PJV011 FD  VALIDAS-REP.                                                 CQ11407
PJV011 01  REG-VALIDAS-REP.                                             CQ11407        PJV011 01  REG-VALIDAS-REP.                                             CQ11407
PJV011     03 TIP-VALREP                PIC 9.                          CQ11407        PJV011     03 TIP-VALREP                PIC 9.                          CQ11407
PJV011     03 CED-VALREP                PIC 9(11).                      CQ11407        PJV011     03 CED-VALREP                PIC 9(11).                      CQ11407
PJV011     03 NOM-VALREP                PIC X(45).                      CQ11407        PJV011     03 NOM-VALREP                PIC X(45).                      CQ11407
PJV011     03 FEC-EXP-VALREP            PIC 9(08).                      CQ11407        PJV011     03 FEC-EXP-VALREP            PIC 9(08).                      CQ11407
PJV011     03 MUN-EXP-VALREP            PIC X(15).                      CQ11407        PJV011     03 MUN-EXP-VALREP            PIC X(15).                      CQ11407
PJV011     03 DEP-EXP-VALREP            PIC X(15).                      CQ11407        PJV011     03 DEP-EXP-VALREP            PIC X(15).                      CQ11407
PJV011     03 VIG-VALREP                PIC X(02).                      CQ11407        PJV011     03 VIG-VALREP                PIC X(02).                      CQ11407
PJV011     03 GENERO-VALREP             PIC X(01).                      CQ11407        PJV011     03 GENERO-VALREP             PIC X(01).                      CQ11407
PJV011     03 EDAD-VALREP               PIC X(03).                      CQ11407        PJV011     03 EDAD-VALREP               PIC X(03).                      CQ11407
PJV011     03 EDAD-RANGO-VALREP         PIC X(05).                      CQ11407        PJV011     03 EDAD-RANGO-VALREP         PIC X(05).                      CQ11407
PJV011     03 FILLER-2-VALREP           PIC X(51).                      CQ11407     |  PJV012*    03 FILLER-2-VALREP           PIC X(651).                     CQ12837
                                                                                    >  STT013     03 FILLER-2-VALREP           PIC X(651).                     CQ12657

       FD  INCONS.                                                                            FD  INCONS.
       01  REG-INCONS.                                                                        01  REG-INCONS.
           03 TIP-INC                   PIC 9.                                                    03 TIP-INC                   PIC 9.
PAM372     03 FILLER1                   PIC X VALUE ";".                               PAM372     03 FILLER1                   PIC X VALUE ";".
           03 CED-INC                   PIC 9(11).                                                03 CED-INC                   PIC 9(11).
PAM372     03 FILLER2                   PIC X VALUE ";".                               PAM372     03 FILLER2                   PIC X VALUE ";".
           03 NOM1-INC                  PIC X(45).                                                03 NOM1-INC                  PIC X(45).
PAM372     03 FILLER3                   PIC X VALUE ";".                               PAM372     03 FILLER3                   PIC X VALUE ";".
           03 NOM2-INC                  PIC X(45).                                                03 NOM2-INC                  PIC X(45).
PAM372     03 FILLER4                   PIC X VALUE ";".                               PAM372     03 FILLER4                   PIC X VALUE ";".
           03 FEC-EXP-INC               PIC 9(08).                                                03 FEC-EXP-INC               PIC 9(08).
PAM372     03 FILLER5                   PIC X VALUE ";".                               PAM372     03 FILLER5                   PIC X VALUE ";".
           03 MUN-EXP-INC               PIC X(15).                                                03 MUN-EXP-INC               PIC X(15).
PAM372     03 FILLER6                   PIC X VALUE ";".                               PAM372     03 FILLER6                   PIC X VALUE ";".
           03 DEP-EXP-INC               PIC X(15).                                                03 DEP-EXP-INC               PIC X(15).
PAM372     03 FILLER7                   PIC X VALUE ";".                               PAM372     03 FILLER7                   PIC X VALUE ";".
           03 VIG-INC                   PIC X(02).                                                03 VIG-INC                   PIC X(02).
PAM372     03 FILLER8                   PIC X VALUE ";".                               PAM372     03 FILLER8                   PIC X VALUE ";".
           03 CODERR-INC                PIC 9(02).                                                03 CODERR-INC                PIC 9(02).
PAM372     03 FILLER9                   PIC X VALUE ";".                               PAM372     03 FILLER9                   PIC X VALUE ";".
           03 FILLER-2-INC              PIC X(60).                                                03 FILLER-2-INC              PIC X(60).

      ****************************************************                                   ****************************************************
       WORKING-STORAGE SECTION.                                                               WORKING-STORAGE SECTION.
      ***************************************************                                    ***************************************************
CQ6271 COPY LOGPESVNO.WS.                                               PJV0010        CQ6271 COPY LOGPESVNO.WS.                                               PJV0010
       01 W-COMANDO-LINEAS.                                                                   01 W-COMANDO-LINEAS.
          03 FILLER                     PIC X(06) VALUE "wc -l ".                                03 FILLER                     PIC X(06) VALUE "wc -l ".
          03 ENTRADA-LINEAS.                                                                     03 ENTRADA-LINEAS.
             05 FILLER                  PIC X(12) VALUE "$TEMPORALES/".                             05 FILLER                  PIC X(12) VALUE "$TEMPORALES/".
             05 W-LINEAS-NOM-ENT        PIC X(30) VALUE SPACES.                                     05 W-LINEAS-NOM-ENT        PIC X(30) VALUE SPACES.
             05 FILLER                  PIC X(30)                                                   05 FILLER                  PIC X(30)
             VALUE " | awk '{ print ($1) }'".                                                       VALUE " | awk '{ print ($1) }'".
          03 FILLER                     PIC X(01) VALUE LOW-VALUE.                               03 FILLER                     PIC X(01) VALUE LOW-VALUE.
       01 W-COMANDO-SORT.                                                                     01 W-COMANDO-SORT.
          03 FILLER                     PIC X(13) VALUE "sort -u ".                              03 FILLER                     PIC X(13) VALUE "sort -u ".
          03 ENTRADA-SORT.                                                                       03 ENTRADA-SORT.
             05 FILLER                  PIC X(12) VALUE "$TEMPORALES/".                             05 FILLER                  PIC X(12) VALUE "$TEMPORALES/".
             05 W-SORT-NOM-ENT          PIC X(30) VALUE SPACES.                                     05 W-SORT-NOM-ENT          PIC X(30) VALUE SPACES.
          03 FILLER                     PIC X(13) VALUE " -o ".                                  03 FILLER                     PIC X(13) VALUE " -o ".
          03 SALIDA-SORT.                                                                        03 SALIDA-SORT.
             05 FILLER                  PIC X(12) VALUE "$TEMPORALES/".                             05 FILLER                  PIC X(12) VALUE "$TEMPORALES/".
             05 W-SORT-NOM-SAL          PIC X(30) VALUE SPACES.                                     05 W-SORT-NOM-SAL          PIC X(30) VALUE SPACES.
          03 FILLER                     PIC X(01) VALUE LOW-VALUE.                               03 FILLER                     PIC X(01) VALUE LOW-VALUE.
      *--------------------------------------------------------------*                       *--------------------------------------------------------------*
       01  W-ENTRADA.                                                                         01  W-ENTRADA.
           03 W-ENT-DIRECTORIO      PIC X(12) VALUE "$TEMPORALES/".                               03 W-ENT-DIRECTORIO      PIC X(12) VALUE "$TEMPORALES/".
           03 W-ENT-NOMBRE          PIC X(30) VALUE SPACES.                                       03 W-ENT-NOMBRE          PIC X(30) VALUE SPACES.
       01  W-VALIDAS.                                                                         01  W-VALIDAS.
           03 W-VAL-DIRECTORIO      PIC X(12) VALUE "$TEMPORALES/".                               03 W-VAL-DIRECTORIO      PIC X(12) VALUE "$TEMPORALES/".
           03 W-VAL-NOMBRE          PIC X(30) VALUE SPACES.                                       03 W-VAL-NOMBRE          PIC X(30) VALUE SPACES.
       01  W-INVALIDAS.                                                                       01  W-INVALIDAS.
           03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".                               03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".
           03 W-INVAL-NOMBRE        PIC X(30) VALUE SPACES.                                       03 W-INVAL-NOMBRE        PIC X(30) VALUE SPACES.
PJV011 01  W-VALIDAS-REP.                                               CQ11407        PJV011 01  W-VALIDAS-REP.                                               CQ11407
PJV011     03 W-VAL-DIRECTORIO      PIC X(12) VALUE "$TEMPORALES/".     CQ11407        PJV011     03 W-VAL-DIRECTORIO      PIC X(12) VALUE "$TEMPORALES/".     CQ11407
PJV011     03 W-VAL-NOMBRE-REP      PIC X(30) VALUE SPACES.             CQ11407        PJV011     03 W-VAL-NOMBRE-REP      PIC X(30) VALUE SPACES.             CQ11407

PJV011 01  W-KEYVAL-GRA.                                                CQ11407        PJV011 01  W-KEYVAL-GRA.                                                CQ11407
PJV011     03 TIP-KEYVAL            PIC 9(01) VALUE ZEROS.              CQ11407        PJV011     03 TIP-KEYVAL            PIC 9(01) VALUE ZEROS.              CQ11407
PJV011     03 NUM-KEYVAL            PIC 9(11) VALUE ZEROS.              CQ11407        PJV011     03 NUM-KEYVAL            PIC 9(11) VALUE ZEROS.              CQ11407
PJV011     03 SN-VALREP             PIC X(01) VALUE SPACES.             CQ11407        PJV011     03 SN-VALREP             PIC X(01) VALUE SPACES.             CQ11407

       01  W-PARAMETROS             PIC X(94) VALUE SPACES.                                   01  W-PARAMETROS             PIC X(94) VALUE SPACES.
       01  W-TARIFA                 PIC 9(04) VALUE ZEROS.                                    01  W-TARIFA                 PIC 9(04) VALUE ZEROS.
       01  W-BLOQUES                PIC 9(01) VALUE ZEROS.                                    01  W-BLOQUES                PIC 9(01) VALUE ZEROS.
       01  SW-BDIIALE               PIC 9(01) VALUE ZEROS.                                    01  SW-BDIIALE               PIC 9(01) VALUE ZEROS.
       01  W-DERECHOS               PIC 9     VALUE ZEROS.                                    01  W-DERECHOS               PIC 9     VALUE ZEROS.
       01  OPEN-DIR                 PIC 9     VALUE ZEROS.                                    01  OPEN-DIR                 PIC 9     VALUE ZEROS.
       01  FIN-ENTRADA              PIC 9     VALUE 0.                                        01  FIN-ENTRADA              PIC 9     VALUE 0.
       01  FINS                     PIC 9     VALUE 0.                                        01  FINS                     PIC 9     VALUE 0.
       01  LLAVE7                   PIC 9(8)  VALUE ZEROS.                                    01  LLAVE7                   PIC 9(8)  VALUE ZEROS.
       01  LLAVE7-R  REDEFINES LLAVE7.                                                        01  LLAVE7-R  REDEFINES LLAVE7.
           03 LLAVE7-1D             PIC 9.                                                        03 LLAVE7-1D             PIC 9.
           03 LLAVE7-FILLER         PIC 9(7).                                                     03 LLAVE7-FILLER         PIC 9(7).
       01  TOPE-INI-LLAVE7          PIC 9(8)  VALUE 20000000.                                 01  TOPE-INI-LLAVE7          PIC 9(8)  VALUE 20000000.
       01  FECHA-PROC.                                                                        01  FECHA-PROC.
           03 ANO-HOY.                                                                            03 ANO-HOY.
              05 SIG-PROC           PIC X(2).                                                        05 SIG-PROC           PIC X(2).
              05 ANO-PROC           PIC X(2).                                                        05 ANO-PROC           PIC X(2).
           03 MES-PROC              PIC X(2).                                                     03 MES-PROC              PIC X(2).
           03 DIA-PROC              PIC X(2).                                                     03 DIA-PROC              PIC X(2).
       01  FECHA-PROC-R  REDEFINES FECHA-PROC                                                 01  FECHA-PROC-R  REDEFINES FECHA-PROC
                                    PIC X(8).                                                                              PIC X(8).
       01  FECHA-AUX.                                                                         01  FECHA-AUX.
           03 DIA-AUX                   PIC 9(2).                                                 03 DIA-AUX                   PIC 9(2).
           03 MES-AUX                   PIC 9(2).                                                 03 MES-AUX                   PIC 9(2).
           03 ANO-AUX                   PIC 9(2).                                                 03 ANO-AUX                   PIC 9(2).
       01  FECHA-AUX-R  REDEFINES FECHA-AUX                                                   01  FECHA-AUX-R  REDEFINES FECHA-AUX
                                        PIC 9(6).                                                                              PIC 9(6).
       01  TIEMPO-SIS.                                                                        01  TIEMPO-SIS.
           03 HORA-SIS                  PIC 9(02).                                                03 HORA-SIS                  PIC 9(02).
           03 MIN-SIS                   PIC 9(02).                                                03 MIN-SIS                   PIC 9(02).
           03 FILLER                    PIC 9(04).                                                03 FILLER                    PIC 9(04).
       01  TIEMPO-SIS-R  REDEFINES TIEMPO-SIS                                                 01  TIEMPO-SIS-R  REDEFINES TIEMPO-SIS
                                        PIC 9(08).                                                                             PIC 9(08).
       01  TIEMPO-W                     PIC 9(8).                                             01  TIEMPO-W                     PIC 9(8).
       01  W-CONTADORES.                                                                      01  W-CONTADORES.
           03  W-CONT-TIPO-5            PIC 9(06) VALUE ZEROS.                                    03  W-CONT-TIPO-5            PIC 9(06) VALUE ZEROS.
           03  W-CONT-TIPO-6            PIC 9(06) VALUE ZEROS.                                    03  W-CONT-TIPO-6            PIC 9(06) VALUE ZEROS.
           03  W-CONT-TIPO-7            PIC 9(06) VALUE ZEROS.                                    03  W-CONT-TIPO-7            PIC 9(06) VALUE ZEROS.
CQ6271     03  W-CONT-TIPO-5-PJ         PIC 9(06) VALUE ZEROS.          PJV0010        CQ6271     03  W-CONT-TIPO-5-PJ         PIC 9(06) VALUE ZEROS.          PJV0010
PJV011     03  W-CONT-TIPO-5-REP        PIC 9(06) VALUE ZEROS.          CQ11407        PJV011     03  W-CONT-TIPO-5-REP        PIC 9(06) VALUE ZEROS.          CQ11407
      *                                                                                      *
       01  SUSCRIPTOR-AUX               PIC 9(06).                                            01  SUSCRIPTOR-AUX               PIC 9(06).
       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.                                01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.
R7094B 01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.          RMB0009        R7094B 01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.          RMB0009
       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.                                01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.
PJV011 01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.          CQ11407        PJV011 01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.          CQ11407
       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.                                01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.
       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.                                01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.
       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.                                01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.
       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.                                01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.
       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.                                01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.
       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.                                01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.
       01  NIT-BUENO                    PIC 9.                                                01  NIT-BUENO                    PIC 9.
       01  NUM-ID-W                     PIC 9(11).                                            01  NUM-ID-W                     PIC 9(11).
      *------------------------------------------------------------------*                   *------------------------------------------------------------------*
       COPY  ICFILE.WS.                                                                       COPY  ICFILE.WS.
       COPY  BDIIALE.WS.                                                                      COPY  BDIIALE.WS.
       COPY  DEPTOS.WS.                                                                       COPY  DEPTOS.WS.
       COPY  BDIIVIDE.WS.                                                                     COPY  BDIIVIDE.WS.
       COPY  BDLDIR.WS.                                                                       COPY  BDLDIR.WS.
       COPY  LEEMAESTROS.WS.                                                                  COPY  LEEMAESTROS.WS.
      *------------------------------------------------------------------*                   *------------------------------------------------------------------*
       01  CODIGO-ERROR                 PIC 9(02) VALUE ZERO.                                 01  CODIGO-ERROR                 PIC 9(02) VALUE ZERO.
       01  PRIMER-APELLIDO              PIC X(16) VALUE SPACES.                               01  PRIMER-APELLIDO              PIC X(16) VALUE SPACES.
       01  SEGUNDO-APELLIDO             PIC X(16) VALUE SPACES.                               01  SEGUNDO-APELLIDO             PIC X(16) VALUE SPACES.
       01  PRIMER-NOMBRE                PIC X(16) VALUE SPACES.                               01  PRIMER-NOMBRE                PIC X(16) VALUE SPACES.
       01  SEGUNDO-NOMBRE               PIC X(16) VALUE SPACES.                               01  SEGUNDO-NOMBRE               PIC X(16) VALUE SPACES.
       01  NOMBRE-DANE.                                                                       01  NOMBRE-DANE.
           03 PR-APELLIDO-ABD05         PIC X(15).                                                03 PR-APELLIDO-ABD05         PIC X(15).
           03 NOMBRES-ABD05             PIC X(30).                                                03 NOMBRES-ABD05             PIC X(30).
       01  NOMBRE-DANE-AUX              PIC X(45).                                            01  NOMBRE-DANE-AUX              PIC X(45).
       01  NOM-VAL-AUX.                                                                       01  NOM-VAL-AUX.
           03 PR-APELLIDO-AUX           PIC X(15).                                                03 PR-APELLIDO-AUX           PIC X(15).
           03 SG-APELLIDO-AUX           PIC X(15).                                                03 SG-APELLIDO-AUX           PIC X(15).
           03 NOMBRE-AUX                PIC X(15).                                                03 NOMBRE-AUX                PIC X(15).
       01  CONTADORES.                                                                        01  CONTADORES.
           03 JL                        PIC 9(02) VALUE ZERO.                                     03 JL                        PIC 9(02) VALUE ZERO.
           03 I                         PIC 9(02) VALUE ZERO.                                     03 I                         PIC 9(02) VALUE ZERO.
           03 SW-ERROR                  PIC 9     VALUE ZERO.                                     03 SW-ERROR                  PIC 9     VALUE ZERO.
           03 J                         PIC 9(02) VALUE ZERO.                                     03 J                         PIC 9(02) VALUE ZERO.
           03 BLOC-IGUAL                PIC 9(02) VALUE ZERO.                                     03 BLOC-IGUAL                PIC 9(02) VALUE ZERO.
           03 BLOQUES                   PIC 9(02) VALUE ZERO.                                     03 BLOQUES                   PIC 9(02) VALUE ZERO.
           03 ENCONTRADO                PIC 9     VALUE ZERO.                                     03 ENCONTRADO                PIC 9     VALUE ZERO.
           03 SUP                       PIC 9(02) VALUE ZERO.                                     03 SUP                       PIC 9(02) VALUE ZERO.
           03 INF                       PIC 9(02) VALUE ZERO.                                     03 INF                       PIC 9(02) VALUE ZERO.
           03 JJ                        PIC 9(02) VALUE ZERO.                                     03 JJ                        PIC 9(02) VALUE ZERO.
      *------------------------------------------------------------------*                   *------------------------------------------------------------------*
       01  W-VARIABLES.                                                                       01  W-VARIABLES.
           03 W-ANO-ACTUAL                PIC 9(04) VALUE ZEROS.                                  03 W-ANO-ACTUAL                PIC 9(04) VALUE ZEROS.
           03 W-EDAD-CEDULA               PIC 9(03) VALUE ZEROS.                                  03 W-EDAD-CEDULA               PIC 9(03) VALUE ZEROS.
           03 W-FEC-EXPE                  PIC 9(08) VALUE ZEROS.                                  03 W-FEC-EXPE                  PIC 9(08) VALUE ZEROS.
           03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.                                                  03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.
              05 W-ANO-EXPE               PIC 9(04).                                                 05 W-ANO-EXPE               PIC 9(04).
              05 W-MES-EXPE               PIC 9(02).                                                 05 W-MES-EXPE               PIC 9(02).
              05 W-DIA-EXPE               PIC 9(02).                                                 05 W-DIA-EXPE               PIC 9(02).
           03 WS-EDAD                     PIC 9(03).                                              03 WS-EDAD                     PIC 9(03).
      *------------------------------------------------------------------*                   *------------------------------------------------------------------*
       01  VEC-MAESTRO.                                                                       01  VEC-MAESTRO.
           03 LETRA-MAESTRO             PIC X  OCCURS 65 TIMES.                                   03 LETRA-MAESTRO             PIC X  OCCURS 65 TIMES.
       01  VEC-DANE.                                                                          01  VEC-DANE.
           03 LETRA-DANE                PIC X  OCCURS 65 TIMES.                                   03 LETRA-DANE                PIC X  OCCURS 65 TIMES.
       01  VEC-BLOQUES.                                                                       01  VEC-BLOQUES.
           03 LIM-INF                   PIC 9(02)  OCCURS 44 TIMES.                               03 LIM-INF                   PIC 9(02)  OCCURS 44 TIMES.
           03 LIM-SUP                   PIC 9(02)  OCCURS 44 TIMES.                               03 LIM-SUP                   PIC 9(02)  OCCURS 44 TIMES.
       01  CONTADORES-COMP-NOMBRE.                                                            01  CONTADORES-COMP-NOMBRE.
           03 K                         PIC 9(04) VALUE ZERO.                                     03 K                         PIC 9(04) VALUE ZERO.
           03 NOMBRE-BIEN               PIC 9     VALUE ZERO.                                     03 NOMBRE-BIEN               PIC 9     VALUE ZERO.
       01  VEC-MAESTRO-UNO.                                                                   01  VEC-MAESTRO-UNO.
           03 LETRA-MAESTRO-UNO         PIC X  OCCURS 45 TIMES.                                   03 LETRA-MAESTRO-UNO         PIC X  OCCURS 45 TIMES.
       01  VEC-DANE-UNO.                                                                      01  VEC-DANE-UNO.
           03 LETRA-DANE-UNO            PIC X  OCCURS 45 TIMES.                                   03 LETRA-DANE-UNO            PIC X  OCCURS 45 TIMES.
       01  VEC-BLOQUES-UNO.                                                                   01  VEC-BLOQUES-UNO.
           03 LIM-INF-UNO               PIC 99  OCCURS 44 TIMES.                                  03 LIM-INF-UNO               PIC 99  OCCURS 44 TIMES.
           03 LIM-SUP-UNO               PIC 99  OCCURS 44 TIMES.                                  03 LIM-SUP-UNO               PIC 99  OCCURS 44 TIMES.
       01  TITULO-1.                                                                          01  TITULO-1.
           03 FILLER                   PIC X(55) VALUE SPACES.                                    03 FILLER                   PIC X(55) VALUE SPACES.
           03 FILLER                   PIC X(21) VALUE                                            03 FILLER                   PIC X(21) VALUE
             "D A T A C R E D I T O".                                                               "D A T A C R E D I T O".
           03 FILLER                   PIC X(33) VALUE SPACES.                                    03 FILLER                   PIC X(33) VALUE SPACES.
           03 DIA-T1                   PIC X(02).                                                 03 DIA-T1                   PIC X(02).
           03 FILLER                   PIC X     VALUE "/".                                       03 FILLER                   PIC X     VALUE "/".
           03 MES-T1                   PIC X(02).                                                 03 MES-T1                   PIC X(02).
           03 FILLER                   PIC X     VALUE "/".                                       03 FILLER                   PIC X     VALUE "/".
           03 SIG-T1                   PIC X(02).                                                 03 SIG-T1                   PIC X(02).
           03 ANO-T1                   PIC X(02).                                                 03 ANO-T1                   PIC X(02).
           03 FILLER                   PIC X(13) VALUE SPACES.                                    03 FILLER                   PIC X(13) VALUE SPACES.
       01  TITULO-2.                                                                          01  TITULO-2.
           03 FILLER                   PIC X(10) VALUE " PESVNOCSV".                              03 FILLER                   PIC X(10) VALUE " PESVNOCSV".
           03 FILLER                   PIC X(41) VALUE SPACES.                                    03 FILLER                   PIC X(41) VALUE SPACES.
           03 FILLER                   PIC X(37) VALUE                                            03 FILLER                   PIC X(37) VALUE
             "ESTADISTICAS DE VALIDACION DE CEDULAS".                                               "ESTADISTICAS DE VALIDACION DE CEDULAS".
           03 FILLER                   PIC X(24) VALUE SPACES.                                    03 FILLER                   PIC X(24) VALUE SPACES.
           03 HORA-T2                  PIC 9(02).                                                 03 HORA-T2                  PIC 9(02).
           03 FILLER                   PIC X     VALUE ":".                                       03 FILLER                   PIC X     VALUE ":".
           03 MIN-T2                   PIC 9(02).                                                 03 MIN-T2                   PIC 9(02).
           03 FILLER                   PIC X(06) VALUE SPACES.                                    03 FILLER                   PIC X(06) VALUE SPACES.
           03 FILLER                   PIC X(06) VALUE "SUSC: ".                                  03 FILLER                   PIC X(06) VALUE "SUSC: ".
           03 SUSCRIPTOR-T2            PIC 9(06).                                                 03 SUSCRIPTOR-T2            PIC 9(06).
       01  RAYAS                       PIC X(132) VALUE ALL "-".                              01  RAYAS                       PIC X(132) VALUE ALL "-".
       01  LINEA-1.                                                                           01  LINEA-1.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
           03 FILLER                   PIC X(32) VALUE                                            03 FILLER                   PIC X(32) VALUE
             "REGISTROS LEIDOS:               ".                                                    "REGISTROS LEIDOS:               ".
           03 REG-LEIDOS-L1            PIC ZZ,ZZZ,ZZ9.                                            03 REG-LEIDOS-L1            PIC ZZ,ZZZ,ZZ9.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
       01  LINEA-2.                                                                           01  LINEA-2.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
           03 FILLER                   PIC X(33) VALUE                                            03 FILLER                   PIC X(33) VALUE
             "REGISTROS CORRECTOS:             ".                                                   "REGISTROS CORRECTOS:             ".
           03 REG-CORRECTOS-L2         PIC Z,ZZZ,ZZ9.                                             03 REG-CORRECTOS-L2         PIC Z,ZZZ,ZZ9.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
       01  LINEA-3.                                                                           01  LINEA-3.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
           03 FILLER                   PIC X(33) VALUE                                            03 FILLER                   PIC X(33) VALUE
             "NO COINCIDEN CON DIAN O DAS:     ".                                                   "NO COINCIDEN CON DIAN O DAS:     ".
           03 NO-COINCIDE-DIAN-L3      PIC Z,ZZZ,ZZ9.                                             03 NO-COINCIDE-DIAN-L3      PIC Z,ZZZ,ZZ9.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
       01  LINEA-4.                                                                           01  LINEA-4.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
           03 FILLER                   PIC X(33) VALUE                                            03 FILLER                   PIC X(33) VALUE
             "NO COINCIDEN CON REGISTARDURIA:  ".                                                   "NO COINCIDEN CON REGISTARDURIA:  ".
           03 NO-COINCIDE-REGIS-L4     PIC Z,ZZZ,ZZ9.                                             03 NO-COINCIDE-REGIS-L4     PIC Z,ZZZ,ZZ9.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
       01  LINEA-5.                                                                           01  LINEA-5.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
           03 FILLER                   PIC X(33) VALUE                                            03 FILLER                   PIC X(33) VALUE
             "NO EXISTEN EN DIAN O DAS:        ".                                                   "NO EXISTEN EN DIAN O DAS:        ".
           03 NO-EXISTE-DIAN-L5        PIC Z,ZZZ,ZZ9.                                             03 NO-EXISTE-DIAN-L5        PIC Z,ZZZ,ZZ9.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
       01  LINEA-6.                                                                           01  LINEA-6.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
           03 FILLER                   PIC X(33) VALUE                                            03 FILLER                   PIC X(33) VALUE
             "NO EXISTEN EN REGISTRADURIA:     ".                                                   "NO EXISTEN EN REGISTRADURIA:     ".
           03 NO-EXISTE-REGIS-L6       PIC Z,ZZZ,ZZ9.                                             03 NO-EXISTE-REGIS-L6       PIC Z,ZZZ,ZZ9.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
       01  LINEA-7.                                                                           01  LINEA-7.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
           03 FILLER                   PIC X(33) VALUE                                            03 FILLER                   PIC X(33) VALUE
             "TIPO IDENTIFICACION INVALIDO:    ".                                                   "TIPO IDENTIFICACION INVALIDO:    ".
           03 TIPO-ID-INVALIDO-L7      PIC Z,ZZZ,ZZ9.                                             03 TIPO-ID-INVALIDO-L7      PIC Z,ZZZ,ZZ9.
           03 FILLER                   PIC X(45) VALUE SPACES.                                    03 FILLER                   PIC X(45) VALUE SPACES.
       01  FECHA-2000                  PIC 9(8).                                              01  FECHA-2000                  PIC 9(8).
       01  FECHA-2000-R  REDEFINES FECHA-2000.                                                01  FECHA-2000-R  REDEFINES FECHA-2000.
           03 ANO-2000-R               PIC 9(4).                                                  03 ANO-2000-R               PIC 9(4).
           03 MES-2000-R               PIC 9(2).                                                  03 MES-2000-R               PIC 9(2).
           03 DIA-2000-R               PIC 9(2).                                                  03 DIA-2000-R               PIC 9(2).
      *------------------------------------------------------------------*                   *------------------------------------------------------------------*
       01  HACER-MATCH                 PIC  9(01).                                            01  HACER-MATCH                 PIC  9(01).
       01  CADENA-ENTRA                PIC  X(60).                                            01  CADENA-ENTRA                PIC  X(60).
       01  CADENA-SALE                 PIC  X(60).                                            01  CADENA-SALE                 PIC  X(60).
       01  IND-ALFABETICO              PIC  X(01).                                            01  IND-ALFABETICO              PIC  X(01).
           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"                           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"
                                            "G" "H" "I" "J" "K" "L" "M"                                                            "G" "H" "I" "J" "K" "L" "M"
                                            "N" "/" "O" "P" "Q" "R" "S"                                                            "N" "/" "O" "P" "Q" "R" "S"
                                            "T" "U" "V" "W" "X" "Y" "Z"                                                            "T" "U" "V" "W" "X" "Y" "Z"
                                            "Ñ".                                                                                   "Ñ".
CQ6271 LINKAGE SECTION.                                                 PJV0010        CQ6271 LINKAGE SECTION.                                                 PJV0010
CQ6271 COPY LOGPESVNO.LKG.                                              PJV0010        CQ6271 COPY LOGPESVNO.LKG.                                              PJV0010
      *                                                                                      *                                     
      *=================================================================                     *=================================================================
      $SET CONSTANT HACERMATCH"SI"                                                           $SET CONSTANT HACERMATCH"SI"
      $SET CONSTANT AMNISTIA21"SI"                                                           $SET CONSTANT AMNISTIA21"SI"
      *=================================================================                     *=================================================================

       PROCEDURE DIVISION.                                                                    PROCEDURE DIVISION.
      ******************************************************************                     ******************************************************************
      *100-PROGRAMA-PRINCIPAL.                                                               *100-PROGRAMA-PRINCIPAL.
      *RUTINA PRINCIPAL                                                                      *RUTINA PRINCIPAL
      *VALIDA EL CODIGO DEL SUSCRIPTOR DEL ARCHIVO DE ENTRADA                                *VALIDA EL CODIGO DEL SUSCRIPTOR DEL ARCHIVO DE ENTRADA
      *VALIDA LA CLAVE CON QUE SE GRABARAN REGISTROS EN EL ICBTCO                            *VALIDA LA CLAVE CON QUE SE GRABARAN REGISTROS EN EL ICBTCO
      ******************************************************************                     ******************************************************************
       100-PROGRAMA-PRINCIPAL.                                                                100-PROGRAMA-PRINCIPAL.
           PERFORM 150-ABRIR-ARCHIVOS                                                             PERFORM 150-ABRIR-ARCHIVOS
           READ ENTRADA                                                                           READ ENTRADA
                AT END                                                                                 AT END
                      MOVE 1 TO FIN-ENTRADA                                                                  MOVE 1 TO FIN-ENTRADA
                NOT AT END                                                                             NOT AT END
                      INSPECT NUMID-X-E REPLACING ALL " " BY "0"                                             INSPECT NUMID-X-E REPLACING ALL " " BY "0"
                      INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"                                            INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"
           END-READ                                                                               END-READ
R7094A     IF NOMBRE-E = "VALIDAR=NO" AND FIN-ENTRADA = 0               RMB0009        R7094A     IF NOMBRE-E = "VALIDAR=NO" AND FIN-ENTRADA = 0               RMB0009
R7094A        MOVE 0 TO W-BLOQUES                                       RMB0009        R7094A        MOVE 0 TO W-BLOQUES                                       RMB0009
R7094A        DISPLAY "Registro  control==> 000001 (VALIDAR=NO)"        RMB0009        R7094A        DISPLAY "Registro  control==> 000001 (VALIDAR=NO)"        RMB0009
R7094A        MOVE 0 TO W-BLOQUES                                       RMB0009        R7094A        MOVE 0 TO W-BLOQUES                                       RMB0009
R7094A        READ ENTRADA                                              RMB0009        R7094A        READ ENTRADA                                              RMB0009
R7094A          AT END                                                  RMB0009        R7094A          AT END                                                  RMB0009
R7094A                MOVE 1 TO FIN-ENTRADA                             RMB0009        R7094A                MOVE 1 TO FIN-ENTRADA                             RMB0009
R7094A          NOT AT END                                              RMB0009        R7094A          NOT AT END                                              RMB0009
R7094A                INSPECT NUMID-X-E REPLACING ALL " " BY "0"        RMB0009        R7094A                INSPECT NUMID-X-E REPLACING ALL " " BY "0"        RMB0009
R7094A                INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"       RMB0009        R7094A                INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"       RMB0009
R7094A        END-READ                                                  RMB0009        R7094A        END-READ                                                  RMB0009
R7094A     ELSE                                                         RMB0009        R7094A     ELSE                                                         RMB0009
R7094A        DISPLAY "Registro  control==> 000000 (VALIDAR=NO)"        RMB0009        R7094A        DISPLAY "Registro  control==> 000000 (VALIDAR=NO)"        RMB0009
R7094A     END-IF.                                                      RMB0009        R7094A     END-IF.                                                      RMB0009
           CLOSE CLAVE ABD14.                                                                     CLOSE CLAVE ABD14.

           MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-R                                             MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-R
           MOVE DIA-PROC TO DIA-AUX                                                               MOVE DIA-PROC TO DIA-AUX
           MOVE MES-PROC TO MES-AUX                                                               MOVE MES-PROC TO MES-AUX
           MOVE ANO-PROC TO ANO-AUX                                                               MOVE ANO-PROC TO ANO-AUX
           MOVE ANO-HOY  TO W-ANO-ACTUAL                                                          MOVE ANO-HOY  TO W-ANO-ACTUAL

           PERFORM 400-VALIDAR UNTIL FIN-ENTRADA = 1.                                             PERFORM 400-VALIDAR UNTIL FIN-ENTRADA = 1.

           IF W-CONT-TIPO-5 >  ZEROS  OR                                                          IF W-CONT-TIPO-5 >  ZEROS  OR
              W-CONT-TIPO-6 >  ZEROS  OR                                                             W-CONT-TIPO-6 >  ZEROS  OR
              W-CONT-TIPO-7 >  ZEROS                                                                 W-CONT-TIPO-7 >  ZEROS
            DISPLAY "Registros Tipo 5           ==> " W-CONT-TIPO-5                                DISPLAY "Registros Tipo 5           ==> " W-CONT-TIPO-5
            DISPLAY "Registros Tipo 6           ==> " W-CONT-TIPO-6                                DISPLAY "Registros Tipo 6           ==> " W-CONT-TIPO-6
            DISPLAY "Registros Tipo 7           ==> " W-CONT-TIPO-7                                DISPLAY "Registros Tipo 7           ==> " W-CONT-TIPO-7
PJV011      DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407        PJV011      DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407
PJV012      DISPLAY "*-----------------------------------*"             CQ12657        PJV012      DISPLAY "*-----------------------------------*"             CQ12657
PJV012      DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSV      CQ12657        PJV012      DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSV      CQ12657
PJV012      DISPLAY "*------------------------------------*"            CQ12657        PJV012      DISPLAY "*------------------------------------*"            CQ12657
           END-IF                                                                                 END-IF
           PERFORM 900-CERRAR-ARCHIVOS                                                            PERFORM 900-CERRAR-ARCHIVOS
CQ6271     MOVE "V"               TO TIPPRO-LOGPESVNO-WK                PJV0010        CQ6271     MOVE "V"               TO TIPPRO-LOGPESVNO-WK                PJV0010
CQ6271     MOVE "PESVNO"          TO PROGRAM-LOGPESVNO-WK               PJV0010        CQ6271     MOVE "PESVNO"          TO PROGRAM-LOGPESVNO-WK               PJV0010
CQ6271     PERFORM 1000-UPDATE-LOGPESVNO                                PJV0010        CQ6271     PERFORM 1000-UPDATE-LOGPESVNO                                PJV0010
           STOP RUN.                                                                              STOP RUN.


      ******************************************************************                     ******************************************************************
      *150-ABRIR-ARCHIVOS.                                                                   *150-ABRIR-ARCHIVOS.
      *SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU                     *SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU
      *EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU                     *EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU
      *ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN                                             *ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN
      *PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE                       *PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE
      *LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO                                *LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO
      ******************************************************************                     ******************************************************************
       150-ABRIR-ARCHIVOS.                                                                    150-ABRIR-ARCHIVOS.
           OPEN INPUT BDIIREGI.                                                                   OPEN INPUT BDIIREGI.
      *    DISPLAY "*-------------------------------------------------*"                     *    DISPLAY "*-------------------------------------------------*"
      *    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"                     *    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"
      *    DISPLAY "*-------------------------------------------------*"                     *    DISPLAY "*-------------------------------------------------*"
           DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"                           DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"
MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011        MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011
           ACCEPT W-PARAMETROS   FROM COMMAND-LINE                                                ACCEPT W-PARAMETROS   FROM COMMAND-LINE
           UNSTRING W-PARAMETROS DELIMITED BY SPACES INTO                                         UNSTRING W-PARAMETROS DELIMITED BY SPACES INTO
                                                     W-ENT-NOMBRE,                                                                          W-ENT-NOMBRE,
                                                     W-VAL-NOMBRE,                                                                          W-VAL-NOMBRE,
                                                     W-INVAL-NOMBRE,                                                                        W-INVAL-NOMBRE,
                                                     W-TARIFA,                                                                              W-TARIFA,
                                                     W-BLOQUES,                                                                             W-BLOQUES,
                                                     W-DERECHOS                                                                             W-DERECHOS
           END-UNSTRING                                                                           END-UNSTRING
           IF W-TARIFA       = ZEROS  OR                                                          IF W-TARIFA       = ZEROS  OR
              W-ENT-NOMBRE   = SPACES OR                                                             W-ENT-NOMBRE   = SPACES OR
              W-VAL-NOMBRE   = SPACES OR                                                             W-VAL-NOMBRE   = SPACES OR
              W-INVAL-NOMBRE = SPACES OR                                                             W-INVAL-NOMBRE = SPACES OR
R7094A*       (W-BLOQUES < 0 OR > 4)                                    RMB0009        R7094A*       (W-BLOQUES < 0 OR > 4)                                    RMB0009
R7094A         W-BLOQUES > 4                                            RMB0009        R7094A         W-BLOQUES > 4                                            RMB0009
                 DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "                                    DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "
                 STOP RUN                                                                               STOP RUN
           END-IF                                                                                 END-IF
R7094A     IF W-BLOQUES = 0                                             RMB0009        R7094A     IF W-BLOQUES = 0                                             RMB0009
R7094A        DISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES       .....!!" RMB0009        R7094A        DISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES       .....!!" RMB0009
R7094A     END-IF                                                       RMB0009        R7094A     END-IF                                                       RMB0009

PJV011     INITIALIZE W-VAL-NOMBRE-REP                                  CQ11407        PJV011     INITIALIZE W-VAL-NOMBRE-REP                                  CQ11407
PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."                         CQ11407        PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."                         CQ11407
PJV011            ".vre"       DELIMITED BY SIZE                        CQ11407        PJV011            ".vre"       DELIMITED BY SIZE                        CQ11407
PJV011        INTO W-VAL-NOMBRE-REP                                     CQ11407        PJV011        INTO W-VAL-NOMBRE-REP                                     CQ11407
PJV011     END-STRING                                                   CQ11407        PJV011     END-STRING                                                   CQ11407

           MOVE W-ENT-NOMBRE            TO W-SORT-NOM-ENT                                         MOVE W-ENT-NOMBRE            TO W-SORT-NOM-ENT

           MOVE W-ENT-NOMBRE            TO W-SORT-NOM-ENT                                         MOVE W-ENT-NOMBRE            TO W-SORT-NOM-ENT
                                           W-SORT-NOM-SAL                                                                         W-SORT-NOM-SAL
                                           W-LINEAS-NOM-ENT                                                                       W-LINEAS-NOM-ENT
      *    DISPLAY "============================================"                            *    DISPLAY "============================================"
           DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"                                           DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"
           CALL "SYSTEM" USING W-COMANDO-LINEAS                                                   CALL "SYSTEM" USING W-COMANDO-LINEAS
      *    DISPLAY " "                                                                       *    DISPLAY " "
           DISPLAY "ARCHIVO: " W-LINEAS-NOM-ENT                                                   DISPLAY "ARCHIVO: " W-LINEAS-NOM-ENT
      *    DISPLAY " "                                                                       *    DISPLAY " "
           CALL "SYSTEM" USING W-COMANDO-SORT                                                     CALL "SYSTEM" USING W-COMANDO-SORT
           IF RETURN-CODE <> 0                                                                    IF RETURN-CODE <> 0
              DISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBRE                                         DISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBRE
              STOP RUN                                                                               STOP RUN
           END-IF                                                                                 END-IF
           OPEN INPUT  ENTRADA                                                                    OPEN INPUT  ENTRADA
                       BDIIDIAN                                                                               BDIIDIAN
                       BDIIDAS                                                                                BDIIDAS
                       BDIIALE                                                                                BDIIALE
                       MUNICIPIOS                                                                             MUNICIPIOS
                       CLAVE                                                                                  CLAVE
                       ABD14                                                                                  ABD14
XXXXXX*    OPEN I-O    SECUENCIAL                                                      XXXXXX*    OPEN I-O    SECUENCIAL
XXXXXX     OPEN INPUT  SECUENCIAL                                                      XXXXXX     OPEN INPUT  SECUENCIAL
           OPEN OUTPUT VALIDAS                                                                    OPEN OUTPUT VALIDAS
                       INCONS                                                                                 INCONS
PJV011                 VALIDAS-REP                                      CQ11407        PJV011                 VALIDAS-REP                                      CQ11407
           MOVE 29999999 TO LLAVE-SEC                                                             MOVE 29999999 TO LLAVE-SEC
           START SECUENCIAL KEY < LLAVE-SEC INVALID KEY                                           START SECUENCIAL KEY < LLAVE-SEC INVALID KEY
                 DISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SEC                                        DISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SEC
                 MOVE 1 TO FINS                                                                         MOVE 1 TO FINS
           END-START                                                                              END-START
           IF FINS = 1                                                                            IF FINS = 1
              MOVE TOPE-INI-LLAVE7 TO LLAVE7                                                         MOVE TOPE-INI-LLAVE7 TO LLAVE7
           ELSE                                                                                   ELSE
              READ SECUENCIAL PREVIOUS AT END                                                        READ SECUENCIAL PREVIOUS AT END
                   DISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "                                   DISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "
                           LLAVE-SEC                                                                              LLAVE-SEC
                   MOVE 1 TO FINS                                                                         MOVE 1 TO FINS
              END-READ                                                                               END-READ
              IF FINS = 1                                                                            IF FINS = 1
                 MOVE TOPE-INI-LLAVE7 TO LLAVE7                                                         MOVE TOPE-INI-LLAVE7 TO LLAVE7
              ELSE                                                                                   ELSE
                 MOVE LLAVE-SEC TO LLAVE7                                                               MOVE LLAVE-SEC TO LLAVE7
                 IF LLAVE7-1D NOT = 2                                                                   IF LLAVE7-1D NOT = 2
                    MOVE 2     TO LLAVE7-1D                                                                MOVE 2     TO LLAVE7-1D
                    MOVE ZEROS TO LLAVE7-FILLER                                                            MOVE ZEROS TO LLAVE7-FILLER
                 END-IF                                                                                 END-IF
              END-IF                                                                                 END-IF
           END-IF.                                                                                END-IF.

      *******************************************************************                    *******************************************************************
      *400-VALIDAR                                                                           *400-VALIDAR
      * DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-                    * DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-
      * TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,                       * TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,
      * NIT O DAS)                                                                           * NIT O DAS)
      * ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION                     * ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION
      * LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA                                            * LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA
      *******************************************************************                    *******************************************************************
       400-VALIDAR.                                                                           400-VALIDAR.
           ADD  1 TO REG-LEIDOS.                                                                  ADD  1 TO REG-LEIDOS.
           MOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INC                                             MOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INC
           INITIALIZE REG-INCONS REG-VALIDAS                                                      INITIALIZE REG-INCONS REG-VALIDAS
           MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5                                    MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5
                       FILLER6 FILLER7 FILLER8 FILLER9                                                        FILLER6 FILLER7 FILLER8 FILLER9
           MOVE FILLER-2-E TO FILLER-2-VAL                                                        MOVE FILLER-2-E TO FILLER-2-VAL
           MOVE FILLER-2-E TO FILLER-2-INC                                                        MOVE FILLER-2-E TO FILLER-2-INC
           IF TIPOID-E < 1 OR > 4                                                                 IF TIPOID-E < 1 OR > 4
              MOVE 05 TO CODIGO-ERROR CODERR-INC                                                     MOVE 05 TO CODIGO-ERROR CODERR-INC
              MOVE 1  TO SW-ERROR                                                                    MOVE 1  TO SW-ERROR
              PERFORM 512-CREE-REGISTRO                                                              PERFORM 512-CREE-REGISTRO
              WRITE REG-INCONS                                                                       WRITE REG-INCONS
              ADD  1  TO TIPO-ID-INVALIDO                                                            ADD  1  TO TIPO-ID-INVALIDO
           ELSE                                                                                   ELSE
              MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE                                                   MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
              MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE                                                   MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
                                  NUM-ID-W                                                                               NUM-ID-W
              MOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDE                                                    MOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDE
R7094A*       MOVE    1       TO  SW-VERIFNOM-BDIIVIDE                  RMB0009     |  PJV012        MOVE    1       TO  SW-VERIFNOM-BDIIVIDE                  CQ12657
R7094A*                           SW-DIGCHEQUEO-BDIIVIDE                RMB0009     |  PJV012                            SW-DIGCHEQUEO-BDIIVIDE                CQ12657
R7094A        IF W-BLOQUES > 0                                          RMB0009     <  
R7094A           MOVE    1       TO  SW-VERIFNOM-BDIIVIDE               RMB0009     <  
R7094A        END-IF                                                    RMB0009     <  
R7094D        IF TIPOID-E = 2 OR 3                                      RMB0009     <  
R7094D           MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE                       RMB0009     <  
R7094D        END-IF                                                    RMB0009     <  
              MOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDE                                               MOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDE
              PERFORM 80100-VALIDAR-IDENTIFICACION                                                   PERFORM 80100-VALIDAR-IDENTIFICACION
              MOVE  TIP-IDE-BDIIVIDE TO TIPOID-E                                                     MOVE  TIP-IDE-BDIIVIDE TO TIPOID-E
              MOVE  NUM-IDE-BDIIVIDE TO NUMID-E                                                      MOVE  NUM-IDE-BDIIVIDE TO NUMID-E
              INITIALIZE REG-VALIDAS REG-INCONS                                                      INITIALIZE REG-VALIDAS REG-INCONS
REQ596        MOVE FILLER-2-E TO FILLER-2-VAL                           LAG0007     <  
REQ596        MOVE FILLER-2-E TO FILLER-2-INC                           LAG0007     <  
              MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5                                    MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5
                       FILLER6 FILLER7 FILLER8 FILLER9                                                        FILLER6 FILLER7 FILLER8 FILLER9
                                                                                    >  REQ596        MOVE FILLER-2-E TO FILLER-2-VAL                           LAG0007
                                                                                    >  REQ596        MOVE FILLER-2-E TO FILLER-2-INC                           LAG0007
              IF SW-ID-BDIIVIDE = 1                                                                  IF SW-ID-BDIIVIDE = 1
                 IF TIPOID-E <> 1                                                                       IF TIPOID-E <> 1
CSVCEX             MOVE  ZEROS         TO  HACER-MATCH                  GJC0003        CSVCEX             MOVE  ZEROS         TO  HACER-MATCH                  GJC0003
MODCED             MOVE 0 TO IDE-TIPO-BDAMATCH                          EHA0006        MODCED             MOVE 0 TO IDE-TIPO-BDAMATCH                          EHA0006
CSVCEX             PERFORM  513-VALIDA-EN-CSV                           GJC0003        CSVCEX             PERFORM  513-VALIDA-EN-CSV                           GJC0003
CSVCEX             IF  IDE-TIPO-BDAMATCH  =  0                          GJC0003        CSVCEX             IF  IDE-TIPO-BDAMATCH  =  0                          GJC0003
CSVCEX               MOVE 03           TO  CODIGO-ERROR CODERR-INC      GJC0003        CSVCEX               MOVE 03           TO  CODIGO-ERROR CODERR-INC      GJC0003
CSVCEX               MOVE  1           TO SW-ERROR                      GJC0003        CSVCEX               MOVE  1           TO SW-ERROR                      GJC0003
CSVCEX               PERFORM 512-CREE-REGISTRO                          GJC0003        CSVCEX               PERFORM 512-CREE-REGISTRO                          GJC0003
CSVCEX               WRITE REG-INCONS                                   GJC0003        CSVCEX               WRITE REG-INCONS                                   GJC0003
CSVCEX               ADD   1           TO  NO-EXISTE-DIAN               GJC0003        CSVCEX               ADD   1           TO  NO-EXISTE-DIAN               GJC0003
CSVCEX             END-IF                                               GJC0003        CSVCEX             END-IF                                               GJC0003
                 ELSE                                                                                   ELSE
                    MOVE  ZEROS TO  HACER-MATCH                                                            MOVE  ZEROS TO  HACER-MATCH
MODCED              MOVE 0 TO IDE-TIPO-BDAMATCH                         EHA0006        MODCED              MOVE 0 TO IDE-TIPO-BDAMATCH                         EHA0006
                    PERFORM 513-VALIDA-EN-CSV                                                              PERFORM 513-VALIDA-EN-CSV
                    IF IDE-TIPO-BDAMATCH = 0                                                               IF IDE-TIPO-BDAMATCH = 0
                       MOVE 04 TO CODIGO-ERROR CODERR-INC                                                     MOVE 04 TO CODIGO-ERROR CODERR-INC
                       MOVE TIPOID-E TO TIP-INC                                                               MOVE TIPOID-E TO TIP-INC
                       ADD  1  TO NO-EXISTE-REGIS                                                             ADD  1  TO NO-EXISTE-REGIS
                       MOVE 1  TO SW-ERROR                                                                    MOVE 1  TO SW-ERROR
                       PERFORM 510-ESCRIBIR-INCONS                                                            PERFORM 510-ESCRIBIR-INCONS
                    END-IF                                                                                 END-IF
                 END-IF                                                                                 END-IF
              ELSE                                                                                   ELSE
                 IF SW-NOMBRES-BDIIVIDE = 1                                                             IF SW-NOMBRES-BDIIVIDE = 1
                    IF TIPOID-E <> 1                                                                       IF TIPOID-E <> 1
                       MOVE 01 TO CODIGO-ERROR CODERR-INC                                                     MOVE 01 TO CODIGO-ERROR CODERR-INC
                       MOVE  1 TO SW-ERROR                                                                    MOVE  1 TO SW-ERROR
                       PERFORM 512-CREE-REGISTRO                                                              PERFORM 512-CREE-REGISTRO
                       WRITE REG-INCONS                                                                       WRITE REG-INCONS
                       ADD 1 TO NO-COINCIDE-DIAN                                                              ADD 1 TO NO-COINCIDE-DIAN
                       IF TIPOID-E = 4                                                                        IF TIPOID-E = 4
                          MOVE NACIO-BDIIDAS TO MUN-EXP-INC                                                      MOVE NACIO-BDIIDAS TO MUN-EXP-INC
                       END-IF                                                                                 END-IF
                    ELSE                                                                                   ELSE
                       PERFORM 810-BUSCAR-MUNICIPIO                                                           PERFORM 810-BUSCAR-MUNICIPIO
                       MOVE TIPOID-E TO TIP-VAL TIP-INC                                                       MOVE TIPOID-E TO TIP-VAL TIP-INC
                       MOVE NUMID-E  TO CED-VAL CED-INC                                                       MOVE NUMID-E  TO CED-VAL CED-INC
                       MOVE FECHA-EXP-BDIIREGI TO FECHA-2000                                                  MOVE FECHA-EXP-BDIIREGI TO FECHA-2000
                       IF ANO-2000-R > 51                                                                     IF ANO-2000-R > 51
                          ADD 1900 TO ANO-2000-R                                                                 ADD 1900 TO ANO-2000-R
                       ELSE                                                                                   ELSE
                          ADD 2000 TO ANO-2000-R                                                                 ADD 2000 TO ANO-2000-R
                       END-IF                                                                                 END-IF
                       MOVE IND-SEXO-BDIIREGI TO GENERO-VAL                                                   MOVE IND-SEXO-BDIIREGI TO GENERO-VAL
                       PERFORM 505-RANGO-EDADES                                                               PERFORM 505-RANGO-EDADES
                       MOVE FECHA-2000 TO FEC-EXP-VAL                                                         MOVE FECHA-2000 TO FEC-EXP-VAL
                                          FEC-EXP-INC                                                                            FEC-EXP-INC
                       IF ESTADO-VIG-BDIIREGI = 12 OR = 27                                                    IF ESTADO-VIG-BDIIREGI = 12 OR = 27
                          MOVE "00"        TO VIG-VAL VIG-INC                                                    MOVE "00"        TO VIG-VAL VIG-INC
                       ELSE                                                                                   ELSE
                          MOVE ESTADO-VIG-BDIIREGI TO VIG-VAL                                                    MOVE ESTADO-VIG-BDIIREGI TO VIG-VAL
                                                      VIG-INC                                                                                VIG-INC
                       END-IF                                                                                 END-IF
                       MOVE   02 TO CODIGO-ERROR CODERR-INC                                                   MOVE   02 TO CODIGO-ERROR CODERR-INC
                       MOVE 1 TO SW-ERROR                                                                     MOVE 1 TO SW-ERROR
                       PERFORM 510-ESCRIBIR-INCONS                                                            PERFORM 510-ESCRIBIR-INCONS
                       ADD 1 TO NO-COINCIDE-REGIS                                                             ADD 1 TO NO-COINCIDE-REGIS
                    END-IF                                                                                 END-IF
                 ELSE                                                                                   ELSE
R7094C*             IF W-BLOQUES > 1 OR TIPOID-E <> 1                   RMB0009        R7094C*             IF W-BLOQUES > 1 OR TIPOID-E <> 1                   RMB0009
R7094C*                MOVE NOM-VAL-BDIIVIDE         TO NOM-VAL         RMB0009        R7094C*                MOVE NOM-VAL-BDIIVIDE         TO NOM-VAL         RMB0009
R7094C*             ELSE                                                RMB0009        R7094C*             ELSE                                                RMB0009
R7094C*                MOVE PRIMER-APELLIDO-BDIIVIDE TO NOM-VAL         RMB0009        R7094C*                MOVE PRIMER-APELLIDO-BDIIVIDE TO NOM-VAL         RMB0009
R7094C*             END-IF                                              RMB0009        R7094C*             END-IF                                              RMB0009
R7094C              MOVE NOM-VAL-BDIIVIDE         TO NOM-VAL            RMB0009        R7094C              MOVE NOM-VAL-BDIIVIDE         TO NOM-VAL            RMB0009
                    INITIALIZE LLAVE-BDIIALE                                                               INITIALIZE LLAVE-BDIIALE
                    MOVE  TIPOID-E TO TIP-IDE-BDIIALE                                                      MOVE  TIPOID-E TO TIP-IDE-BDIIALE
                    MOVE  NUMID-E  TO NUM-IDE-BDIIALE                                                      MOVE  NUMID-E  TO NUM-IDE-BDIIALE
                    MOVE  990003   TO FUENTE-BDIIALE                                                       MOVE  990003   TO FUENTE-BDIIALE
                    START BDIIALE KEY NOT < LLAVE-BDIIALE                                                  START BDIIALE KEY NOT < LLAVE-BDIIALE
                          INVALID KEY MOVE 1 TO SW-BDIIALE                                                       INVALID KEY MOVE 1 TO SW-BDIIALE
                      NOT INVALID KEY MOVE 0 TO SW-BDIIALE                                                   NOT INVALID KEY MOVE 0 TO SW-BDIIALE
                          READ BDIIALE NEXT RECORD                                                               READ BDIIALE NEXT RECORD
                               AT END MOVE 1 TO SW-BDIIALE                                                            AT END MOVE 1 TO SW-BDIIALE
                          END-READ                                                                               END-READ
                    END-START                                                                              END-START
                    PERFORM UNTIL SW-BDIIALE = 1 OR                                                        PERFORM UNTIL SW-BDIIALE = 1 OR
                            TIPOID-E <> TIP-IDE-BDIIALE OR                                                         TIPOID-E <> TIP-IDE-BDIIALE OR
                            NUMID-E <> NUM-IDE-BDIIALE                                                             NUMID-E <> NUM-IDE-BDIIALE
                            IF FUENTE-BDIIALE = 990003 AND                                                         IF FUENTE-BDIIALE = 990003 AND
                               FEC-NOV-BDIIALE <= FECHA-PROC-R AND                                                    FEC-NOV-BDIIALE <= FECHA-PROC-R AND
                               FEC-VEN-BDIIALE >= FECHA-PROC-R AND                                                    FEC-VEN-BDIIALE >= FECHA-PROC-R AND
                               BLOQUEO-BDIIALE = 0                                                                    BLOQUEO-BDIIALE = 0
                               MOVE 1 TO SW-BDIIALE                                                                   MOVE 1 TO SW-BDIIALE
                            END-IF                                                                                 END-IF
                            IF SW-BDIIALE = 0                                                                      IF SW-BDIIALE = 0
                               READ BDIIALE NEXT RECORD                                                               READ BDIIALE NEXT RECORD
                                    AT END MOVE 1 TO SW-BDIIALE                                                            AT END MOVE 1 TO SW-BDIIALE
                               END-READ                                                                               END-READ
                            END-IF                                                                                 END-IF
                    END-PERFORM                                                                            END-PERFORM
                    IF TIPOID-E = 1                                                                        IF TIPOID-E = 1
                       IF ESTADO-VIG-BDIIREGI = 12 AND                                                        IF ESTADO-VIG-BDIIREGI = 12 AND
                          W-DERECHOS = 1                                                                         W-DERECHOS = 1
                          MOVE  07   TO  CODIGO-ERROR CODERR-INC                                                 MOVE  07   TO  CODIGO-ERROR CODERR-INC
                          MOVE   1   TO  SW-ERROR                                                                MOVE   1   TO  SW-ERROR
                          MOVE "00"  TO  VIG-INC                                                                 MOVE "00"  TO  VIG-INC
                          PERFORM 510-ESCRIBIR-INCONS                                                            PERFORM 510-ESCRIBIR-INCONS
                        ELSE                                                                                   ELSE
                           IF ESTADO-VIG-BDIIREGI = 21                                                            IF ESTADO-VIG-BDIIREGI = 21
                              MOVE  06  TO CODIGO-ERROR CODERR-INC                                                   MOVE  06  TO CODIGO-ERROR CODERR-INC
                              MOVE   1  TO SW-ERROR                                                                  MOVE   1  TO SW-ERROR
                              MOVE "21" TO VIG-INC                                                                   MOVE "21" TO VIG-INC
                              PERFORM 510-ESCRIBIR-INCONS                                                            PERFORM 510-ESCRIBIR-INCONS
                              ADD   1   TO NO-COINCIDE-REGIS                                                         ADD   1   TO NO-COINCIDE-REGIS
R7094B                        ADD   1   TO CONT-FALLECIDOS              RMB0009        R7094B                        ADD   1   TO CONT-FALLECIDOS              RMB0009
                           ELSE                                                                                   ELSE
                              PERFORM 810-BUSCAR-MUNICIPIO                                                           PERFORM 810-BUSCAR-MUNICIPIO
                              MOVE TIPOID-E TO TIP-VAL TIP-INC                                                       MOVE TIPOID-E TO TIP-VAL TIP-INC
                              MOVE NUMID-E  TO CED-VAL CED-INC                                                       MOVE NUMID-E  TO CED-VAL CED-INC
                              MOVE FECHA-EXP-BDIIREGI TO FECHA-2000                                                  MOVE FECHA-EXP-BDIIREGI TO FECHA-2000
                              IF ANO-2000-R > 51                                                                     IF ANO-2000-R > 51
                                 ADD 1900 TO ANO-2000-R                                                                 ADD 1900 TO ANO-2000-R
                              ELSE                                                                                   ELSE
                                 ADD 2000 TO ANO-2000-R                                                                 ADD 2000 TO ANO-2000-R
                              END-IF                                                                                 END-IF
                              MOVE FECHA-2000 TO FEC-EXP-VAL                                                         MOVE FECHA-2000 TO FEC-EXP-VAL
                                                 FEC-EXP-INC                                                                            FEC-EXP-INC
                              IF ESTADO-VIG-BDIIREGI = 12 OR = 27                                                    IF ESTADO-VIG-BDIIREGI = 12 OR = 27
                                 MOVE "00" TO VIG-VAL VIG-INC                                                           MOVE "00" TO VIG-VAL VIG-INC
                              ELSE                                                                                   ELSE
                                 MOVE ESTADO-VIG-BDIIREGI TO VIG-VAL                                                    MOVE ESTADO-VIG-BDIIREGI TO VIG-VAL
                                                             VIG-INC                                                                                VIG-INC
                              END-IF                                                                                 END-IF
                              MOVE IND-SEXO-BDIIREGI TO GENERO-VAL                                                   MOVE IND-SEXO-BDIIREGI TO GENERO-VAL
                              PERFORM 505-RANGO-EDADES                                                               PERFORM 505-RANGO-EDADES
PJV012                        IF ORIGEN-VAL = SPACES                    CQ12657        PJV012                        IF ORIGEN-VAL = SPACES                    CQ12657
PJV012                           MOVE   "O"      TO ORIGEN-VAL          CQ12657        PJV012                           MOVE   "O"      TO ORIGEN-VAL          CQ12657
PJV012                        END-IF                                    CQ12657        PJV012                        END-IF                                    CQ12657
PJV011                        PERFORM 301-GRABA-LOS-VALIDOS             CQ11407        PJV011                        PERFORM 301-GRABA-LOS-VALIDOS             CQ11407
                           END-IF                                                                                 END-IF
                        END-IF                                                                                 END-IF
                    ELSE                                                                                   ELSE
                       IF TIPOID-E = 4                                                                        IF TIPOID-E = 4
                          MOVE NACIO-BDIIDAS   TO MUN-EXP-VAL                                                    MOVE NACIO-BDIIDAS   TO MUN-EXP-VAL
                          MOVE ZEROS           TO VIG-VAL                                                        MOVE ZEROS           TO VIG-VAL
                       END-IF                                                                                 END-IF
                       MOVE NOM-VAL-BDIIVIDE TO NOM-VAL                                                       MOVE NOM-VAL-BDIIVIDE TO NOM-VAL
                       MOVE TIPOID-E         TO TIP-VAL TIP-INC                                               MOVE TIPOID-E         TO TIP-VAL TIP-INC
                       MOVE NUMID-E          TO CED-VAL CED-INC                                               MOVE NUMID-E          TO CED-VAL CED-INC
PJV012                 IF ORIGEN-VAL = SPACES                           CQ12657        PJV012                 IF ORIGEN-VAL = SPACES                           CQ12657
PJV012                    MOVE    "O"        TO ORIGEN-VAL              CQ12657        PJV012                    MOVE    "O"        TO ORIGEN-VAL              CQ12657
PJV012                 END-IF                                           CQ12657        PJV012                 END-IF                                           CQ12657
PJV011                 PERFORM 301-GRABA-LOS-VALIDOS                    CQ11407        PJV011                 PERFORM 301-GRABA-LOS-VALIDOS                    CQ11407
                    END-IF                                                                                 END-IF
                 END-IF                                                                                 END-IF
              END-IF                                                                                 END-IF
           END-IF                                                                                 END-IF
           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07                                                 IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07
              ADD  1 TO W-CONT-TIPO-6                                                                ADD  1 TO W-CONT-TIPO-6
           ELSE                                                                                   ELSE
              IF CODIGO-ERROR = 03 OR 04 OR 05                                                       IF CODIGO-ERROR = 03 OR 04 OR 05
                 ADD 1  TO W-CONT-TIPO-7                                                                ADD 1  TO W-CONT-TIPO-7
              ELSE                                                                                   ELSE
PJV011           IF SN-VALREP = "S"                                     CQ11407        PJV011           IF SN-VALREP = "S"                                     CQ11407
PJV011              ADD 1  TO W-CONT-TIPO-5-REP                         CQ11407        PJV011              ADD 1  TO W-CONT-TIPO-5-REP                         CQ11407
PJV011           ELSE                                                   CQ11407        PJV011           ELSE                                                   CQ11407
                    ADD 1  TO W-CONT-TIPO-5                                                                ADD 1  TO W-CONT-TIPO-5
PJV011           END-IF                                                 CQ11407        PJV011           END-IF                                                 CQ11407
CQ6271           IF TIPOID-E = 2 OR 3                                   PJV0010        CQ6271           IF TIPOID-E = 2 OR 3                                   PJV0010
CQ6271              ADD 1 TO W-CONT-TIPO-5-PJ                           PJV0010        CQ6271              ADD 1 TO W-CONT-TIPO-5-PJ                           PJV0010
CQ6271           END-IF                                                 PJV0010        CQ6271           END-IF                                                 PJV0010
              END-IF                                                                                 END-IF
           END-IF                                                                                 END-IF
           READ ENTRADA                                                                           READ ENTRADA
                AT END                                                                                 AT END
                      MOVE 1 TO FIN-ENTRADA                                                                  MOVE 1 TO FIN-ENTRADA
                NOT AT END                                                                             NOT AT END
                      INSPECT  NUMID-X-E REPLACING ALL " " BY "0"                                            INSPECT  NUMID-X-E REPLACING ALL " " BY "0"
                      INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"                                            INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"
           END-READ.                                                                              END-READ.

PJV011 300-GRABA-VALREP.                                                CQ11407        PJV011 300-GRABA-VALREP.                                                CQ11407
PJV011     INITIALIZE REG-VALIDAS-REP                                   CQ11407        PJV011     INITIALIZE REG-VALIDAS-REP                                   CQ11407
PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDAS                       CQ11407        PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDAS                       CQ11407
PJV011     MOVE TIP-VAL TO TIP-KEYVAL                                   CQ11407        PJV011     MOVE TIP-VAL TO TIP-KEYVAL                                   CQ11407
PJV011     MOVE CED-VAL TO NUM-KEYVAL                                   CQ11407        PJV011     MOVE CED-VAL TO NUM-KEYVAL                                   CQ11407
PJV011     ADD 1 TO REG-CORRECTOS-R  .                                  CQ11407        PJV011     ADD 1 TO REG-CORRECTOS-R  .                                  CQ11407

PJV011 301-GRABA-LOS-VALIDOS.                                           CQ11407        PJV011 301-GRABA-LOS-VALIDOS.                                           CQ11407
PJV011     MOVE "N" TO SN-VALREP                                        CQ11407        PJV011     MOVE "N" TO SN-VALREP                                        CQ11407
PJV011     IF TIP-KEYVAL = TIPOID-E AND                                 CQ11407        PJV011     IF TIP-KEYVAL = TIPOID-E AND                                 CQ11407
PJV011        NUM-KEYVAL = NUMID-E                                      CQ11407        PJV011        NUM-KEYVAL = NUMID-E                                      CQ11407
PJV011        MOVE "S" TO SN-VALREP                                     CQ11407        PJV011        MOVE "S" TO SN-VALREP                                     CQ11407
PJV011        PERFORM 300-GRABA-VALREP                                  CQ11407        PJV011        PERFORM 300-GRABA-VALREP                                  CQ11407
PJV011     ELSE                                                         CQ11407        PJV011     ELSE                                                         CQ11407
PJV011        WRITE REG-VALIDAS                                         CQ11407        PJV011        WRITE REG-VALIDAS                                         CQ11407
PJV011        MOVE TIP-VAL TO TIP-KEYVAL                                CQ11407        PJV011        MOVE TIP-VAL TO TIP-KEYVAL                                CQ11407
PJV011        MOVE CED-VAL TO NUM-KEYVAL                                CQ11407        PJV011        MOVE CED-VAL TO NUM-KEYVAL                                CQ11407
PJV011        ADD 1 TO REG-CORRECTOS                                    CQ11407        PJV011        ADD 1 TO REG-CORRECTOS                                    CQ11407
PJV011     END-IF.                                                      CQ11407        PJV011     END-IF.                                                      CQ11407


       505-RANGO-EDADES.                                                                      505-RANGO-EDADES.
      *--------------------------------------------------*                                   *--------------------------------------------------*
      *505-RANGO-EDADES.                                                                     *505-RANGO-EDADES.
      *  RANGO MUJERES: 20'000.001 A 70'000.000                                              *  RANGO MUJERES: 20'000.001 A 70'000.000
      *  RANGO HOMBRES:          1 A 20'000.000                                              *  RANGO HOMBRES:          1 A 20'000.000
      *        MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)                                  *        MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)
      *--------------------------------------------------*                                   *--------------------------------------------------*
           MOVE FEC-EXP-VAL        TO  W-FEC-EXPE                                                 MOVE FEC-EXP-VAL        TO  W-FEC-EXPE
           MOVE ZEROS              TO  W-EDAD-CEDULA                                              MOVE ZEROS              TO  W-EDAD-CEDULA
           IF W-ANO-EXPE >= 1975                                                                  IF W-ANO-EXPE >= 1975
              COMPUTE W-EDAD-CEDULA =                                                                COMPUTE W-EDAD-CEDULA =
               ((W-ANO-ACTUAL - W-ANO-EXPE) + 18)                                                     ((W-ANO-ACTUAL - W-ANO-EXPE) + 18)
           ELSE                                                                                   ELSE
              COMPUTE W-EDAD-CEDULA =                                                                COMPUTE W-EDAD-CEDULA =
               ((W-ANO-ACTUAL - W-ANO-EXPE) + 21)                                                     ((W-ANO-ACTUAL - W-ANO-EXPE) + 21)
           END-IF                                                                                 END-IF
           MOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDAD                                            MOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDAD
           MOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.                                         MOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.
                 EVALUATE WS-EDAD                                                                       EVALUATE WS-EDAD
                    WHEN 18 THRU 21                                                                        WHEN 18 THRU 21
                       MOVE "18-21" TO EDAD-RANGO                                                             MOVE "18-21" TO EDAD-RANGO
                    WHEN 22 THRU 28                                                                        WHEN 22 THRU 28
                       MOVE "22-28" TO EDAD-RANGO                                                             MOVE "22-28" TO EDAD-RANGO
                    WHEN 29 THRU 35                                                                        WHEN 29 THRU 35
                       MOVE "29-35" TO EDAD-RANGO                                                             MOVE "29-35" TO EDAD-RANGO
                    WHEN 36 THRU 45                                                                        WHEN 36 THRU 45
                       MOVE "36-45" TO EDAD-RANGO                                                             MOVE "36-45" TO EDAD-RANGO
                    WHEN 46 THRU 55                                                                        WHEN 46 THRU 55
                       MOVE "46-55" TO EDAD-RANGO                                                             MOVE "46-55" TO EDAD-RANGO
                    WHEN 56 THRU 65                                                                        WHEN 56 THRU 65
                       MOVE "56-65" TO EDAD-RANGO                                                             MOVE "56-65" TO EDAD-RANGO
                    WHEN 66 THRU 999                                                                       WHEN 66 THRU 999
                       MOVE "66+  " TO EDAD-RANGO                                                             MOVE "66+  " TO EDAD-RANGO
                    WHEN ANY                                                                               WHEN ANY
                       MOVE " N/A " TO EDAD-RANGO                                                             MOVE " N/A " TO EDAD-RANGO
                 END-EVALUATE.                                                                          END-EVALUATE.
      ****************************************************************                       ****************************************************************
      *510-ESCRIBIR-INCONS.                                                                  *510-ESCRIBIR-INCONS.
      * BUSCA ERROR                                                                          * BUSCA ERROR
      * CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS                                      * CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS
      ****************************************************************                       ****************************************************************
       510-ESCRIBIR-INCONS.                                                                   510-ESCRIBIR-INCONS.
           IF CODIGO-ERROR = 02 AND SW-ERROR = 1                                                  IF CODIGO-ERROR = 02 AND SW-ERROR = 1
              MOVE TIPOID-E TO TIP-INC.                                                              MOVE TIPOID-E TO TIP-INC.
           IF SW-ERROR = 1                                                                        IF SW-ERROR = 1
               PERFORM 512-CREE-REGISTRO                                                              PERFORM 512-CREE-REGISTRO
               WRITE REG-INCONS.                                                                      WRITE REG-INCONS.

      **************************************************************                         **************************************************************
      *512-CREE-REGISTRO.                                                                    *512-CREE-REGISTRO.
      * ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC                                * ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC
      **************************************************************                         **************************************************************
       512-CREE-REGISTRO.                                                                     512-CREE-REGISTRO.
           MOVE TIPOID-E TO TIP-INC                                                               MOVE TIPOID-E TO TIP-INC
           MOVE NUMID-E  TO CED-INC                                     FAC0019                   MOVE NUMID-E  TO CED-INC                                     FAC0019
           MOVE NOMBRE-E TO NOM1-INC                                                              MOVE NOMBRE-E TO NOM1-INC
           IF CODIGO-ERROR = 02 OR 01 OR 06 OR 07                                                 IF CODIGO-ERROR = 02 OR 01 OR 06 OR 07
              MOVE NOM-VAL-BDIIVIDE TO NOM2-INC                                                      MOVE NOM-VAL-BDIIVIDE TO NOM2-INC
           ELSE                                                                                   ELSE
              MOVE SPACES      TO NOM2-INC                                                           MOVE SPACES      TO NOM2-INC
                                  MUN-EXP-INC                                                                            MUN-EXP-INC
                                  DEP-EXP-INC                                                                            DEP-EXP-INC
                                  VIG-INC                                                                                VIG-INC
              MOVE ZEROS       TO FEC-EXP-INC                                                        MOVE ZEROS       TO FEC-EXP-INC
              MOVE FILLER-2-E  TO FILLER-2-INC                                                       MOVE FILLER-2-E  TO FILLER-2-INC
           END-IF.                                                                                END-IF.

      **************************************************************                         **************************************************************
      *513-VALIDA-EN-CSV.                                                                    *513-VALIDA-EN-CSV.
      *    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS                              *    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
      *    ALTERNA                                                                           *    ALTERNA
      **************************************************************                         **************************************************************
       513-VALIDA-EN-CSV.                                                                     513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacion                                   REQ550*    hace validacion de tipo de identificacion 
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE                                        REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE                                        REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-ID                                               REQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0                                                      REQ550     IF SW-TID-BDIIVIDE = 0
           IF HACER-MATCH = ZEROS                                                                 IF HACER-MATCH = ZEROS                               
              IF OPEN-DIR = ZEROS                                                                    IF OPEN-DIR = ZEROS
                 OPEN INPUT MAESTRO-DIRECC                                                              OPEN INPUT MAESTRO-DIRECC
                 OPEN INPUT BDLCLI                                                                      OPEN INPUT BDLCLI
                 OPEN INPUT SUSCRIPTOR                                                                  OPEN INPUT SUSCRIPTOR
                 OPEN INPUT MAESTRO-CREDIT                                                              OPEN INPUT MAESTRO-CREDIT
                 OPEN INPUT MAESTRO-CHECK                                                               OPEN INPUT MAESTRO-CHECK
                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN                                                  PERFORM 06000-U-CARGAR-TABLA-DIRESTAN
                 MOVE 1 TO OPEN-DIR                                                                     MOVE 1 TO OPEN-DIR
               END-IF                                                                                 END-IF
               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH                                                MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH
               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH                                                MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
               PERFORM 1000-U-RECORRER-CSV-BDAMATCH                                                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH
               MOVE 1 TO HACERMATCH-LEEMSTRS                                                          MOVE 1 TO HACERMATCH-LEEMSTRS
REQ609         IF IDE-TIPO-BDAMATCH = 1                                 LAG0008        REQ609         IF IDE-TIPO-BDAMATCH = 1                                 LAG0008
REQ609            IF TIPOID-E = 1 OR 4                                  LAG0008        REQ609            IF TIPOID-E = 1 OR 4                                  LAG0008
REQ609               INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL          LAG0008        REQ609               INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL          LAG0008
REQ609                  "," BY " ", ";" BY " "                          LAG0008        REQ609                  "," BY " ", ";" BY " "                          LAG0008
REQ609            END-IF                                                LAG0008        REQ609            END-IF                                                LAG0008
REQ609            MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM       LAG0008        REQ609            MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM       LAG0008
REQ609            MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM       LAG0008        REQ609            MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM       LAG0008
REQ609            MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM      LAG0008        REQ609            MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM      LAG0008
REQ609            MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008        REQ609            MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609            PERFORM 10000-MATCH-NOMBRES-VALNOM                    LAG0008        REQ609            PERFORM 10000-MATCH-NOMBRES-VALNOM                    LAG0008
REQ609            IF MATCH-OK-OUT-VALNOM = 1                            LAG0008        REQ609            IF MATCH-OK-OUT-VALNOM = 1                            LAG0008
REQ609               MOVE 1 TO IDE-TIPO-BDAMATCH                        LAG0008        REQ609               MOVE 1 TO IDE-TIPO-BDAMATCH                        LAG0008
REQ609            ELSE                                                  LAG0008        REQ609            ELSE                                                  LAG0008
R7094A              IF W-BLOQUES > 0                                    RMB0009        R7094A              IF W-BLOQUES > 0                                    RMB0009
R7094A                 MOVE 0 TO IDE-TIPO-BDAMATCH                      RMB0009        R7094A                 MOVE 0 TO IDE-TIPO-BDAMATCH                      RMB0009
R7094A              END-IF                                              RMB0009        R7094A              END-IF                                              RMB0009
REQ609            END-IF                                                LAG0008        REQ609            END-IF                                                LAG0008
REQ609         END-IF                                                   LAG0008        REQ609         END-IF                                                   LAG0008

               IF IDE-TIPO-BDAMATCH = 1                                                               IF IDE-TIPO-BDAMATCH = 1
                  MOVE TIPOID-E TO TIP-VAL                                                               MOVE TIPOID-E TO TIP-VAL
                  MOVE NUMID-E  TO CED-VAL                                                               MOVE NUMID-E  TO CED-VAL
                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA                                               MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA
                  PERFORM 9800-FILTRAR-ALFABETICO                                                        PERFORM 9800-FILTRAR-ALFABETICO
                  MOVE CADENA-SALE TO  NOM-VAL                                                           MOVE CADENA-SALE TO  NOM-VAL
                  MOVE ZEROS    TO FEC-EXP-VAL                                                           MOVE ZEROS    TO FEC-EXP-VAL
                  MOVE SPACES   TO MUN-EXP-VAL                                                           MOVE SPACES   TO MUN-EXP-VAL
                  MOVE SPACES   TO DEP-EXP-VAL                                                           MOVE SPACES   TO DEP-EXP-VAL
                  MOVE SPACES   TO VIG-VAL                                                               MOVE SPACES   TO VIG-VAL
                  MOVE SPACES   TO GENERO-VAL                                                            MOVE SPACES   TO GENERO-VAL
                  MOVE SPACES   TO EDAD-VAL                                                              MOVE SPACES   TO EDAD-VAL
                  MOVE SPACES   TO EDAD-RANGO                                                            MOVE SPACES   TO EDAD-RANGO
PJV012            MOVE "A"      TO ORIGEN-VAL                           CQ12657        PJV012            MOVE "A"      TO ORIGEN-VAL                           CQ12657
PJV011            PERFORM  301-GRABA-LOS-VALIDOS                        CQ11407        PJV011            PERFORM  301-GRABA-LOS-VALIDOS                        CQ11407
PJV011            ADD 1 TO SI-EXISTE-CSV                                CQ11407        PJV011            ADD 1 TO SI-EXISTE-CSV                                CQ11407
                END-IF                                                                                 END-IF
             END-IF.                                                                                END-IF.

       9800-FILTRAR-ALFABETICO.                                                               9800-FILTRAR-ALFABETICO.
      ******************************************************************                     ******************************************************************
      *9800-FILTRAR-ALFABETICO.                                        *                     *9800-FILTRAR-ALFABETICO.                                        *
      *    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*                     *    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*       
      ******************************************************************                     ******************************************************************       
           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA                                MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA             
           INITIALIZE CADENA-SALE                                                                 INITIALIZE CADENA-SALE                                              
           MOVE 1 TO J                                                                            MOVE 1 TO J                                                         
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60                                             PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60                          
              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO                                              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO                        
              IF SI-ALFABETICO                                                                       IF SI-ALFABETICO                                                 
                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)                                           MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)                  
                 ADD 1 TO J                                                                             ADD 1 TO J                                                    
              END-IF                                                                                 END-IF                                                           
           END-PERFORM.                                                                           END-PERFORM.
      *******************************************************************                    *******************************************************************

      *800-GRABAR-SECUENCIAL.                                                                *800-GRABAR-SECUENCIAL.
      * SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL                       * SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL
      * NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-                      * NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-
      * TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN                       * TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN
      * REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION                                 * REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION
      *******************************************************************                    *******************************************************************
       800-GRABAR-SECUENCIAL.                                                                 800-GRABAR-SECUENCIAL.
           INITIALIZE REG-SEC                                                                     INITIALIZE REG-SEC
           MOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SEC                                              MOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SEC
           MOVE FECHA-AUX-R       TO FEC-CONSUL-SEC                                               MOVE FECHA-AUX-R       TO FEC-CONSUL-SEC
           MOVE ZEROS             TO TIP-ID-SEC                                                   MOVE ZEROS             TO TIP-ID-SEC
           MOVE W-TARIFA          TO NUM-TERM-SEC                                                 MOVE W-TARIFA          TO NUM-TERM-SEC
           MOVE 2                 TO COBRA-SEC                                                    MOVE 2                 TO COBRA-SEC
           MOVE 1                 TO PRIV-SEC                                                     MOVE 1                 TO PRIV-SEC
           MOVE " "               TO SBPRIV-SEC                                                   MOVE " "               TO SBPRIV-SEC
           MOVE 2                 TO PRODU-SEC                                                    MOVE 2                 TO PRODU-SEC
           MOVE COD-CLAVE-ABD09   TO COD-CLAVE-SEC                                                MOVE COD-CLAVE-ABD09   TO COD-CLAVE-SEC
           MOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SEC                                                MOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SEC
           MOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SEC                                              MOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SEC
           MOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SEC                                           MOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SEC
           MOVE ZONA-FAC-ABD09    TO ZONA-FAC-SEC                                                 MOVE ZONA-FAC-ABD09    TO ZONA-FAC-SEC
           MOVE ZEROS             TO TABLA-SCOR-SEC                                               MOVE ZEROS             TO TABLA-SCOR-SEC
           ACCEPT TIEMPO-W        FROM TIME                                                       ACCEPT TIEMPO-W        FROM TIME
           MOVE TIEMPO-W(1:6)     TO HORA-SEC                                                     MOVE TIEMPO-W(1:6)     TO HORA-SEC
           IF W-CONT-TIPO-5       >  ZEROS                                                        IF W-CONT-TIPO-5       >  ZEROS
              ADD 1 TO LLAVE7                                                                        ADD 1 TO LLAVE7
              MOVE LLAVE7 TO LLAVE-SEC                                                               MOVE LLAVE7 TO LLAVE-SEC
              MOVE W-CONT-TIPO-5  TO NUM-ID-SEC                                                      MOVE W-CONT-TIPO-5  TO NUM-ID-SEC 
              MOVE 5  TO TIP-CON-SEC                                                                 MOVE 5  TO TIP-CON-SEC 
XXXXXX*       WRITE REG-SEC INVALID KEY                                                XXXXXX*       WRITE REG-SEC INVALID KEY
XXXXXX*             DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC                   XXXXXX*             DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*       END-WRITE                                                                XXXXXX*       END-WRITE
           END-IF                                                                                 END-IF   
           IF W-CONT-TIPO-6       >  ZEROS                                                        IF W-CONT-TIPO-6       >  ZEROS
              ADD 1 TO LLAVE7                                                                        ADD 1 TO LLAVE7
              MOVE LLAVE7 TO LLAVE-SEC                                                               MOVE LLAVE7 TO LLAVE-SEC
              MOVE W-CONT-TIPO-6  TO NUM-ID-SEC                                                      MOVE W-CONT-TIPO-6  TO NUM-ID-SEC 
              MOVE 6  TO TIP-CON-SEC                                                                 MOVE 6  TO TIP-CON-SEC 
XXXXXX*       WRITE REG-SEC INVALID KEY                                                XXXXXX*       WRITE REG-SEC INVALID KEY
XXXXXX*             DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC                   XXXXXX*             DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*       END-WRITE                                                                XXXXXX*       END-WRITE
           END-IF                                                                                 END-IF   
           IF W-CONT-TIPO-7       >  ZEROS                                                        IF W-CONT-TIPO-7       >  ZEROS
              ADD 1 TO LLAVE7                                                                        ADD 1 TO LLAVE7
              MOVE LLAVE7 TO LLAVE-SEC                                                               MOVE LLAVE7 TO LLAVE-SEC
              MOVE W-CONT-TIPO-7  TO NUM-ID-SEC                                                      MOVE W-CONT-TIPO-7  TO NUM-ID-SEC 
              MOVE 7  TO TIP-CON-SEC                                                                 MOVE 7  TO TIP-CON-SEC 
XXXXXX*       WRITE REG-SEC INVALID KEY                                                XXXXXX*       WRITE REG-SEC INVALID KEY
XXXXXX*             DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC                   XXXXXX*             DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*       END-WRITE                                                                XXXXXX*       END-WRITE
           END-IF.                                                                                END-IF.                       
      *****************************************************************                      *****************************************************************
      *810-BUSCAR-MUNICIPIO.                                                                 *810-BUSCAR-MUNICIPIO.
      * OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-                      * OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-
      * NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS                                   * NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS
      *****************************************************************                      *****************************************************************
       810-BUSCAR-MUNICIPIO.                                                                  810-BUSCAR-MUNICIPIO.
           MOVE DEP-EXP-BDIIREGI TO CODIGO-DEP                                                    MOVE DEP-EXP-BDIIREGI TO CODIGO-DEP
           MOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNI                                                 MOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNI
           READ MUNICIPIOS INVALID KEY                                                            READ MUNICIPIOS INVALID KEY
               MOVE SPACES TO NOMBRE-MUNI                                                             MOVE SPACES TO NOMBRE-MUNI
               MOVE 71     TO CODIGO-DEP                                                              MOVE 71     TO CODIGO-DEP
           END-READ                                                                               END-READ
           MOVE NOMBRE-MUNI           TO MUN-EXP-VAL MUN-EXP-INC                                  MOVE NOMBRE-MUNI           TO MUN-EXP-VAL MUN-EXP-INC
           MOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.                                 MOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.
      *                                                                                      *

      ******************************************************************                     ******************************************************************
      *900-CERRAR-ARCHIVOS.                                                                  *900-CERRAR-ARCHIVOS.
      * CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN                      * CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN
      * ESTAN ABIERTOS                                                                       * ESTAN ABIERTOS
      *****************************************************************                      *****************************************************************
       900-CERRAR-ARCHIVOS.                                                                   900-CERRAR-ARCHIVOS.
           DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS                                 DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS
           DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS                              DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS
PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407        PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407
           DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS                          DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
R7094B     DISPLAY "  REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOSRMB0009        R7094B     DISPLAY "  REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOSRMB0009
           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN                           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN
           DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS                            DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS
           DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN                             DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN
           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO                           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO
           CLOSE ENTRADA                                                                          CLOSE ENTRADA
                 BDIIDIAN                                                                               BDIIDIAN
                 BDIIDAS                                                                                BDIIDAS
                 BDIIREGI                                                                               BDIIREGI
                 MUNICIPIOS                                                                             MUNICIPIOS
                 SECUENCIAL                                                                             SECUENCIAL
                 VALIDAS                                                                                VALIDAS
PJV011           VALIDAS-REP                                            CQ11407        PJV011           VALIDAS-REP                                            CQ11407
                 INCONS.                                                                                INCONS.
      *****************************************************************                      *****************************************************************
           COPY BDIIVIDE.PROC.                                                                    COPY BDIIVIDE.PROC.
           COPY LEEMAESTROS.PROC.                                                                 COPY LEEMAESTROS.PROC.
           COPY BDLDIR.PROC.                                                                      COPY BDLDIR.PROC.
CQ6271     COPY LOGPESVNO.PROC.                                         PJV0010        CQ6271     COPY LOGPESVNO.PROC.                                         PJV0010
/d/iccol/desarrollo/fuentes>^X^C
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>sdiff -w 170 PESVNOCSV.CBL PESVNOCSVPLUS.CBL/d/iccol/desarrollo/fuentes>sdiff -w 170 PESVNOCSV.CBL PESVNOCSVPLUS.CBL>  > qq/d/iccol/desarrollo/fuentes>L PESVNOCSVPLUS.CBL > qqq                        <
ksh: qqq: file already exists
/d/iccol/desarrollo/fuentes>rm qqq
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm qqqsdiff -w 170 PESVNOCSV.CBL PESVNOCSVPLUS.CBL > qq>/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 1078 lines, 145764 characters * PESVNOCSV.V.01.0012|*
 PESVNOCSVPLUS.V.01.0013
IDENTIFICATION DIVISION.
IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.
PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.
AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.
DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.
DATE-COMPILED.
*******************************************************************
*****************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE**
 PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.*
 EXTRANJERIA.
**
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV*
 Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
**
* Cliente : Datacredito*
 Cliente : Datacredito
**
* Version : 09/06/2008 09:08:25 a.m.*
 Version : 09/06/2008 09:08:25 a.m.
*******************************************************************
*****************************************************************
*  Validacion especial tomando el archivo de*
  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final*
  Cuentas Sin Validar para poder reportalos en el informe final
**
*******************************************************************
*****************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIASREMARK*
 LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNOREMARK*
 L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*REMARK*
 SEPT. 30/2009*
REMARK*******************************************************************REMARK*
******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK*
 GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*REMARK*
 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
@"qqq" 1078 lines, 145764 characters* PESVNOCSV.V.01.0012|* PESVNOCSVPLUS.V.01.0013IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.DATE-COMPILED.
************************************************************************************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE** PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.* EXTRANJERIA.
**
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
**
* Cliente : Datacredito* Cliente : Datacredito
**
* Version : 09/06/2008 09:08:25 a.m.* Version : 09/06/2008 09:08:25 a.m.
************************************************************************************************************************************
*  Validacion especial tomando el archivo de*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final*  Cuentas Sin Validar para poder reportalos en el informe final
**
************************************************************************************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIASREMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNOREMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*REMARK* SEPT. 30/2009*
REMARK*******************************************************************REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**REMARK* GRACIELA JIM.**
REMARK******************************************************************REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **REMARK* G.DESARROLLO **
REMARK******************************************************************REMARK******************************************************************
************************************************************************************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A ** GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.** FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   ** EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS** MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     ** LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1** OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     ** LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA** OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   ** RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
* AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS** AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS*
* GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO ** GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *
*| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     **| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
************************************************************************************************************************************
* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.*
* SEP-01-2012|** SEP-01-2012|** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** SEP-01-2012|** SEP-01-2012|*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES*
* ABR-02-2013| REPETIDAS VALIDAS.** ABR-02-2013| REPETIDAS VALIDAS.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES** PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES*
* JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   ** JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
* PEDRO V.   |** PEDRO V.   |*
************************************************************************************************************************************
>* STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
>* JUL-31-2013|*
>* LUIS GOMEZ |*
>******************************************************************
**
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
CONFIGURATION SECTION.CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.INPUT-OUTPUT SECTION.COPY BDIIDIAN.FS.COPY BDIIDIAN.FS.COPY BDIIREGI.FS.COPY BDIIREGI.FS.COPY BDIIDAS.FS.COPY BDIIDAS.FS.COPY ICBTCO.FS.COPY ICBTCO.FS.COPY ICBCLA0001.FS.COPY ICBCLA0001.FS.COPY ICBCIU.FS.COPY ICBCIU.FS.
CTAST8*    COPY  ICBCHK.FS.GDT0005CTAST8*    COPY  ICBCHK.FS.GDT0005
CTAST8     COPY  ICBCHK0001.FS.GDT0005CTAST8     COPY  ICBCHK0001.FS.GDT0005COPY ICBCRE.FS.COPY ICBCRE.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY BDLCLI.FS.COPY BDLCLI.FS.COPY ICBDIR.FS.COPY ICBDIR.FS.COPY ICMUNI.FS.COPY ICMUNI.FS.COPY BDIIALE.FS.COPY BDIIALE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.COPY DIREST.FS.COPY DIREST.FS.COPY NOAMNISTIA21.FS.COPY NOAMNISTIA21.FS.COPY BDACSV.FS.COPY BDACSV.FS.SELECT ENTRADA  ASSIGN TO DISK W-ENTRADASELECT ENTRADA  ASSIGN TO DISK W-ENTRADAORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.SELECT VALIDAS  ASSIGN TO DISK W-VALIDASSELECT VALIDAS  ASSIGN TO DISK W-VALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.

PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407
PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407
PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407SELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIAL"qqq" line 55 of 1078 --5%-- SELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.DATA DIVISION.DATA DIVISION.
FILE SECTION.FILE SECTION.
COPY ICBCHK.FD.COPY ICBCHK.FD.
COPY ICBSUS.FD.COPY ICBSUS.FD.
COPY BDACSV.FD.COPY BDACSV.FD.
COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.
COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.
COPY DIREST.FD.COPY DIREST.FD.
COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.
COPY NOAMNISTIA21.FD.COPY NOAMNISTIA21.FD.
COPY BDIIDIAN.FD.COPY BDIIDIAN.FD.
COPY BDIIREGI.FD.COPY BDIIREGI.FD.
COPY BDIIDAS.FD.COPY BDIIDAS.FD.
COPY ICBTCO001.FD.COPY ICBTCO001.FD.
COPY ICBCLA.FD.COPY ICBCLA.FD.
COPY ICBCIU.FD.COPY ICBCIU.FD.
COPY ICBCRE.FD.COPY ICBCRE.FD.
COPY BDLCLI.FD.COPY BDLCLI.FD.
COPY ICMUNI.FD.COPY ICMUNI.FD.
COPY BDIIALE.FD.COPY BDIIALE.FD.FD  ENTRADA.FD  ENTRADA.
01  REG-ENTRADA.01  REG-ENTRADA.03 TIPOID-EPIC   9(01).03 TIPOID-EPIC   9(01).03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).03 NUMID-EPIC   9(11).03 NUMID-EPIC   9(11).03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).03 NOMBRE-EPIC   X(45).03 NOMBRE-EPIC   X(45).03 FILLER-2-EPIC   X(60).|  PJV012*    03 FILLER-2-EPIC   X(360).CQ12657
>  STT013     03 FILLER-2-EPIC   X(660).CQ12837FD  VALIDAS.FD  VALIDAS.
01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).
PAM460     03 ORIGEN-VALPIC X.|  PJV012     03 ORIGEN-VALPIC X.CQ12657
PJV012     03 FILLER-2-VALPIC X(50).CQ12657     |  PJV012*    03 FILLER-2-VALPIC X(350).CQ12657
>  STT013     03 FILLER-2-VALPIC X(650).CQ12837

PJV011 FD  VALIDAS-REP.CQ11407PJV011 FD  VALIDAS-REP.CQ11407
PJV011 01  REG-VALIDAS-REP.CQ11407PJV011 01  REG-VALIDAS-REP.CQ11407
PJV011     03 TIP-VALREPPIC 9.CQ11407PJV011     03 TIP-VALREPPIC 9.CQ11407
PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407
PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407
PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407
PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407
PJV011     03 VIG-VALREPPIC X(02).CQ11407PJV011     03 VIG-VALREPPIC X(02).CQ11407
PJV011     03 GENERO-VALREPPIC X(01).CQ11407PJV011     03 GENERO-VALREPPIC X(01).CQ11407
PJV011     03 EDAD-VALREPPIC X(03).CQ11407PJV011     03 EDAD-VALREPPIC X(03).CQ11407
PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407
PJV011     03 FILLER-2-VALREPPIC X(51).CQ11407     |  PJV012*    03 FILLER-2-VALREPPIC X(651).CQ12837
>  STT013     03 FILLER-2-VALREPPIC X(651).CQ12657FD  INCONS.FD  INCONS.
01  REG-INCONS.01  REG-INCONS.03 TIP-INCPIC 9.03 TIP-INCPIC 9.
PAM372     03 FILLER1PIC X VALUE ";".PAM372     03 FILLER1PIC X VALUE ";".03 CED-INCPIC 9(11).03 CED-INCPIC 9(11).
PAM372     03 FILLER2PIC X VALUE ";".PAM372     03 FILLER2PIC X VALUE ";".03 NOM1-INCPIC X(45).03 NOM1-INCPIC X(45).
PAM372     03 FILLER3PIC X VALUE ";".PAM372     03 FILLER3PIC X VALUE ";".03 NOM2-INCPIC X(45).03 NOM2-INCPIC X(45).
PAM372     03 FILLER4PIC X VALUE ";".PAM372     03 FILLER4PIC X VALUE ";".03 FEC-EXP-INCPIC 9(08).03 FEC-EXP-INCPIC 9(08).
PAM372     03 FILLER5PIC X VALUE ";".PAM372     03 FILLER5PIC X VALUE ";".03 MUN-EXP-INCPIC X(15).03 MUN-EXP-INCPIC X(15).
PAM372     03 FILLER6PIC X VALUE ";".PAM372     03 FILLER6PIC X VALUE ";".03 DEP-EXP-INCPIC X(15).03 DEP-EXP-INCPIC X(15).
PAM372     03 FILLER7PIC X VALUE ";".PAM372     03 FILLER7PIC X VALUE ";".03 VIG-INCPIC X(02).03 VIG-INCPIC X(02).
PAM372     03 FILLER8PIC X VALUE ";".PAM372     03 FILLER8PIC X VALUE ";".03 CODERR-INCPIC 9(02).03 CODERR-INCPIC 9(02).
PAM372     03 FILLER9PIC X VALUE ";".PAM372     03 FILLER9PIC X VALUE ";".03 FILLER-2-INCPIC X(60).03 FILLER-2-INCPIC X(60).********************************************************************************************************
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
******************************************************************************************************
CQ6271 COPY LOGPESVNO.WS.PJV0010CQ6271 COPY LOGPESVNO.WS.PJV0010
01 W-COMANDO-LINEAS.01 W-COMANDO-LINEAS.03 FILLERPIC X(06) VALUE "wc -l ".03 FILLERPIC X(06) VALUE "wc -l ".03 ENTRADA-LINEAS.03 ENTRADA-LINEAS.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 FILLERPIC X(30)05 FILLERPIC X(30)VALUE " | awk '{ print ($1) }'".VALUE " | awk '{ print ($1) }'".03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
01 W-COMANDO-SORT.01 W-COMANDO-SORT.03 FILLERPIC X(13) VALUE "sort -u ".03 FILLERPIC X(13) VALUE "sort -u ".03 ENTRADA-SORT.03 ENTRADA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.03 FILLERPIC X(13) VALUE " -o ".03 FILLERPIC X(13) VALUE " -o ".03 SALIDA-SORT.03 SALIDA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
*--------------------------------------------------------------**--------------------------------------------------------------*
01  W-ENTRADA.01  W-ENTRADA.03 W-ENT-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-ENT-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-ENT-NOMBREPIC X(30) VALUE SPACES.03 W-ENT-NOMBREPIC X(30) VALUE SPACES.
01  W-VALIDAS.01  W-VALIDAS.03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-VAL-NOMBREPIC X(30) VALUE SPACES.03 W-VAL-NOMBREPIC X(30) VALUE SPACES.
01  W-INVALIDAS.01  W-INVALIDAS.03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".03 W-INVAL-NOMBREPIC X(30) VALUE SPACES.03 W-INVAL-NOMBREPIC X(30) VALUE SPACES.
PJV011 01  W-VALIDAS-REP.CQ11407PJV011 01  W-VALIDAS-REP.CQ11407
PJV011     03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".     CQ11407PJV011     03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".     CQ11407
PJV011     03 W-VAL-NOMBRE-REPPIC X(30) VALUE SPACES.CQ11407PJV011     03 W-VAL-NOMBRE-REPPIC X(30) VALUE SPACES.CQ11407

PJV011 01  W-KEYVAL-GRA.CQ11407PJV011 01  W-KEYVAL-GRA.CQ11407
PJV011     03 TIP-KEYVALPIC 9(01) VALUE ZEROS.CQ11407PJV011     03 TIP-KEYVALPIC 9(01) VALUE ZEROS.CQ11407
PJV011     03 NUM-KEYVALPIC 9(11) VALUE ZEROS.CQ11407PJV011     03 NUM-KEYVALPIC 9(11) VALUE ZEROS.CQ11407
PJV011     03 SN-VALREPPIC X(01) VALUE SPACES.CQ11407PJV011     03 SN-VALREPPIC X(01) VALUE SPACES.CQ1140701  W-PARAMETROSPIC X(94) VALUE SPACES.01  W-PARAMETROSPIC X(94) VALUE SPACES.
01  W-TARIFAPIC 9(04) VALUE ZEROS.01  W-TARIFAPIC 9(04) VALUE ZEROS.
01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  W-BLOQUESPIC 9(01) VALUE ZEROS.
01  SW-BDIIALEPIC 9(01) VALUE ZEROS.01  SW-BDIIALEPIC 9(01) VALUE ZEROS.
01  W-DERECHOSPIC 9     VALUE ZEROS.01  W-DERECHOSPIC 9     VALUE ZEROS.
01  OPEN-DIRPIC 9     VALUE ZEROS.01  OPEN-DIRPIC 9     VALUE ZEROS.
01  FIN-ENTRADAPIC 9     VALUE 0.01  FIN-ENTRADAPIC 9     VALUE 0.
01  FINSPIC 9     VALUE 0.01  FINSPIC 9     VALUE 0.
01  LLAVE7PIC 9(8)  VALUE ZEROS.01  LLAVE7PIC 9(8)  VALUE ZEROS.
01  LLAVE7-R  REDEFINES LLAVE7.01  LLAVE7-R  REDEFINES LLAVE7.03 LLAVE7-1DPIC 9.03 LLAVE7-1DPIC 9.03 LLAVE7-FILLERPIC 9(7).03 LLAVE7-FILLERPIC 9(7).
01  TOPE-INI-LLAVE7PIC 9(8)  VALUE 20000000.01  TOPE-INI-LLAVE7PIC 9(8)  VALUE 20000000.
01  FECHA-PROC.01  FECHA-PROC.03 ANO-HOY.03 ANO-HOY.05 SIG-PROCPIC X(2).05 SIG-PROCPIC X(2).05 ANO-PROCPIC X(2).05 ANO-PROCPIC X(2).03 MES-PROCPIC X(2).03 MES-PROCPIC X(2).03 DIA-PROCPIC X(2).03 DIA-PROCPIC X(2).
01  FECHA-PROC-R  REDEFINES FECHA-PROC01  FECHA-PROC-R  REDEFINES FECHA-PROCPIC X(8).PIC X(8).
01  FECHA-AUX.01  FECHA-AUX.03 DIA-AUXPIC 9(2).03 DIA-AUXPIC 9(2).03 MES-AUXPIC 9(2).03 MES-AUXPIC 9(2).03 ANO-AUXPIC 9(2).03 ANO-AUXPIC 9(2).
01  FECHA-AUX-R  REDEFINES FECHA-AUX01  FECHA-AUX-R  REDEFINES FECHA-AUXPIC 9(6).PIC 9(6).
01  TIEMPO-SIS.01  TIEMPO-SIS.03 HORA-SISPIC 9(02).03 HORA-SISPIC 9(02).03 MIN-SISPIC 9(02).03 MIN-SISPIC 9(02).03 FILLERPIC 9(04).03 FILLERPIC 9(04).
01  TIEMPO-SIS-R  REDEFINES TIEMPO-SIS01  TIEMPO-SIS-R  REDEFINES TIEMPO-SISPIC 9(08).PIC 9(08).
01  TIEMPO-WPIC 9(8).01  TIEMPO-WPIC 9(8).
01  W-CONTADORES.01  W-CONTADORES.PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407
PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407
PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407
PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407
PJV011     03 VIG-VALREPPIC X(02).CQ11407PJV011     03 VIG-VALREPPIC X(02).CQ11407
PJV011     03 GENERO-VALREPPIC X(01).CQ11407PJV011     03 GENERO-VALREPPIC X(01).CQ11407
PJV011     03 EDAD-VALREPPIC X(03).CQ11407PJV011     03 EDAD-VALREPPIC X(03).CQ11407
PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407
PJV011     03 FILLER-2-VALREPPIC X(51).CQ11407     |  PJV012*    03 FILLER-2-VALREPPIC X(651).CQ12837
>  STT013     03 FILLER-2-VALREPPIC X(651).CQ12657FD  INCONS.FD  INCONS.
01  REG-INCONS.01  REG-INCONS.03 TIP-INCPIC 9.03 TIP-INCPIC 9.
PAM372     03 FILLER1PIC X VALUE ";".PAM372     03 FILLER1PIC X VALUE ";".03 CED-INCPIC 9(11).03 CED-INCPIC 9(11).
PAM372     03 FILLER2PIC X VALUE ";".PAM372     03 FILLER2PIC X VALUE ";".03 NOM1-INCPIC X(45).03 NOM1-INCPIC X(45).
PAM372     03 FILLER3PIC X VALUE ";".PAM372     03 FILLER3PIC X VALUE ";".03 NOM2-INCPIC X(45).03 NOM2-INCPIC X(45).
PAM372     03 FILLER4PIC X VALUE ";".PAM372     03 FILLER4PIC X VALUE ";".03 FEC-EXP-INCPIC 9(08).03 FEC-EXP-INCPIC 9(08).
PAM372     03 FILLER5PIC X VALUE ";".PAM372     03 FILLER5PIC X VALUE ";".03 MUN-EXP-INCPIC X(15).03 MUN-EXP-INCPIC X(15).
PAM372     03 FILLER6PIC X VALUE ";".PAM372     03 FILLER6PIC X VALUE ";".03 DEP-EXP-INCPIC X(15).03 DEP-EXP-INCPIC X(15).
PAM372     03 FILLER7PIC X VALUE ";".PAM372     03 FILLER7PIC X VALUE ";".03 VIG-INCPIC X(02).03 VIG-INCPIC X(02).
PAM372     03 FILLER8PIC X VALUE ";".PAM372     03 FILLER8PIC X VALUE ";".03 CODERR-INCPIC 9(02).03 CODERR-INCPIC 9(02).
PAM372     03 FILLER9PIC X VALUE ";".PAM372     03 FILLER9PIC X VALUE ";".03 FILLER-2-INCPIC X(60).03 FILLER-2-INCPIC X(60).********************************************************************************************************
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
******************************************************************************************************
CQ6271 COPY LOGPESVNO.WS.PJV0010CQ6271 COPY LOGPESVNO.WS.PJV0010
01 W-COMANDO-LINEAS.01 W-COMANDO-LINEAS.03 FILLERPIC X(06) VALUE "wc -l ".03 FILLERPIC X(06) VALUE "wc -l ".03 ENTRADA-LINEAS.03 ENTRADA-LINEAS.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 FILLERPIC X(30)05 FILLERPIC X(30)VALUE " | awk '{ print ($1) }'".VALUE " | awk '{ print ($1) }'".03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
01 W-COMANDO-SORT.01 W-COMANDO-SORT.03 FILLERPIC X(13) VALUE "sort -u ".03 FILLERPIC X(13) VALUE "sort -u ".03 ENTRADA-SORT.03 ENTRADA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.03 FILLERPIC X(13) VALUE " -o ".03 FILLERPIC X(13) VALUE " -o ".03 SALIDA-SORT.03 SALIDA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
*--------------------------------------------------------------**--------------------------------------------------------------*
01  W-ENTRADA.01  W-ENTRADA.03 W-ENT-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-ENT-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-ENT-NOMBREPIC X(30) VALUE SPACES.03 W-ENT-NOMBREPIC X(30) VALUE SPACES.
01  W-VALIDAS.01  W-VALIDAS.03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-VAL-NOMBREPIC X(30) VALUE SPACES.03 W-VAL-NOMBREPIC X(30) VALUE SPACES.
01  W-INVALIDAS.01  W-INVALIDAS.03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".03 W-INVAL-NOMBREPIC X(30) VALUE SPACES.03 W-INVAL-NOMBREPIC X(30) VALUE SPACES.
PJV011 01  W-VALIDAS-REP.CQ11407PJV011 01  W-VALIDAS-REP.CQ11407
PJV011     03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".     CQ11407PJV011     03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".     CQ11407
PJV011     03 W-VAL-NOMBRE-REPPIC X(30) VALUE SPACES.CQ11407PJV011     03 W-VAL-NOMBRE-REPPIC X(30) VALUE SPACES.CQ11407

PJV011 01  W-KEYVAL-GRA.CQ11407PJV011 01  W-KEYVAL-GRA.CQ11407
PJV011     03 TIP-KEYVALPIC 9(01) VALUE ZEROS.CQ11407PJV011     03 TIP-KEYVALPIC 9(01) VALUE ZEROS.CQ11407
PJV011     03 NUM-KEYVALPIC 9(11) VALUE ZEROS.CQ11407PJV011     03 NUM-KEYVALPIC 9(11) VALUE ZEROS.CQ11407
PJV011     03 SN-VALREPPIC X(01) VALUE SPACES.CQ11407PJV011     03 SN-VALREPPIC X(01) VALUE SPACES.CQ1140701  W-PARAMETROSPIC X(94) VALUE SPACES.01  W-PARAMETROSPIC X(94) VALUE SPACES.
01  W-TARIFAPIC 9(04) VALUE ZEROS.01  W-TARIFAPIC 9(04) VALUE ZEROS.
01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  W-BLOQUESPIC 9(01) VALUE ZEROS.
01  SW-BDIIALEPIC 9(01) VALUE ZEROS.01  SW-BDIIALEPIC 9(01) VALUE ZEROS.
01  W-DERECHOSPIC 9     VALUE ZEROS.01  W-DERECHOSPIC 9     VALUE ZEROS.
01  OPEN-DIRPIC 9     VALUE ZEROS.01  OPEN-DIRPIC 9     VALUE ZEROS.
01  FIN-ENTRADAPIC 9     VALUE 0.01  FIN-ENTRADAPIC 9     VALUE 0.
01  FINSPIC 9     VALUE 0.01  FINSPIC 9     VALUE 0.
01  LLAVE7PIC 9(8)  VALUE ZEROS.01  LLAVE7PIC 9(8)  VALUE ZEROS.
01  LLAVE7-R  REDEFINES LLAVE7.01  LLAVE7-R  REDEFINES LLAVE7.03 LLAVE7-1DPIC 9.03 LLAVE7-1DPIC 9.03 LLAVE7-FILLERPIC 9(7).03 LLAVE7-FILLERPIC 9(7).
01  TOPE-INI-LLAVE7PIC 9(8)  VALUE 20000000.01  TOPE-INI-LLAVE7PIC 9(8)  VALUE 20000000.
01  FECHA-PROC.01  FECHA-PROC.03 ANO-HOY.03 ANO-HOY.05 SIG-PROCPIC X(2).05 SIG-PROCPIC X(2).05 ANO-PROCPIC X(2).05 ANO-PROCPIC X(2).03 MES-PROCPIC X(2).03 MES-PROCPIC X(2).03 DIA-PROCPIC X(2).03 DIA-PROCPIC X(2).
01  FECHA-PROC-R  REDEFINES FECHA-PROC01  FECHA-PROC-R  REDEFINES FECHA-PROCPIC X(8).PIC X(8).
01  FECHA-AUX.01  FECHA-AUX.03 DIA-AUXPIC 9(2).03 DIA-AUXPIC 9(2).03 MES-AUXPIC 9(2).03 MES-AUXPIC 9(2).03 ANO-AUXPIC 9(2).03 ANO-AUXPIC 9(2).
01  FECHA-AUX-R  REDEFINES FECHA-AUX01  FECHA-AUX-R  REDEFINES FECHA-AUXPIC 9(6).PIC 9(6).
01  TIEMPO-SIS.01  TIEMPO-SIS.03 HORA-SISPIC 9(02).03 HORA-SISPIC 9(02).03 MIN-SISPIC 9(02).03 MIN-SISPIC 9(02).03 FILLERPIC 9(04).03 FILLERPIC 9(04).
01  TIEMPO-SIS-R  REDEFINES TIEMPO-SIS01  TIEMPO-SIS-R  REDEFINES TIEMPO-SISPIC 9(08).PIC 9(08).
01  TIEMPO-WPIC 9(8).01  TIEMPO-WPIC 9(8).
01  W-CONTADORES.01  W-CONTADORES.01  TIEMPO-WPIC 9(8).01  TIEMPO-WPIC 9(8).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(06) VALUE ZEROS.
CQ6271     03  W-CONT-TIPO-5-PJPIC 9(06) VALUE ZEROS.PJV0010CQ6271     03  W-CONT-TIPO-5-PJPIC 9(06) VALUE ZEROS.PJV0010
PJV011     03  W-CONT-TIPO-5-REPPIC 9(06) VALUE ZEROS.CQ11407PJV011     03  W-CONT-TIPO-5-REPPIC 9(06) VALUE ZEROS.CQ11407
**
01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
R7094B 01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.RMB0009R7094B 01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.RMB0009
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
PJV011 01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.CQ11407PJV011 01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.CQ11407
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.
01  NIT-BUENOPIC 9.01  NIT-BUENOPIC 9.
01  NUM-ID-WPIC 9(11).01  NUM-ID-WPIC 9(11).
*------------------------------------------------------------------**------------------------------------------------------------------*
COPY  ICFILE.WS.COPY  ICFILE.WS.
COPY  BDIIALE.WS.COPY  BDIIALE.WS.
COPY  DEPTOS.WS.COPY  DEPTOS.WS.
COPY  BDIIVIDE.WS.COPY  BDIIVIDE.WS.
COPY  BDLDIR.WS.COPY  BDLDIR.WS.
COPY  LEEMAESTROS.WS.COPY  LEEMAESTROS.WS.
*------------------------------------------------------------------**------------------------------------------------------------------*
01  CODIGO-ERRORPIC 9(02) VALUE ZERO.01  CODIGO-ERRORPIC 9(02) VALUE ZERO.
01  PRIMER-APELLIDOPIC X(16) VALUE SPACES.01  PRIMER-APELLIDOPIC X(16) VALUE SPACES.
01  SEGUNDO-APELLIDOPIC X(16) VALUE SPACES.01  SEGUNDO-APELLIDOPIC X(16) VALUE SPACES.
01  PRIMER-NOMBREPIC X(16) VALUE SPACES.01  PRIMER-NOMBREPIC X(16) VALUE SPACES.
01  SEGUNDO-NOMBREPIC X(16) VALUE SPACES.01  SEGUNDO-NOMBREPIC X(16) VALUE SPACES.
01  NOMBRE-DANE.01  NOMBRE-DANE.03 PR-APELLIDO-ABD05PIC X(15).03 PR-APELLIDO-ABD05PIC X(15).03 NOMBRES-ABD05PIC X(30).03 NOMBRES-ABD05PIC X(30).
01  NOMBRE-DANE-AUXPIC X(45).01  NOMBRE-DANE-AUXPIC X(45).
01  NOM-VAL-AUX.01  NOM-VAL-AUX.03 PR-APELLIDO-AUXPIC X(15).03 PR-APELLIDO-AUXPIC X(15).03 SG-APELLIDO-AUXPIC X(15).03 SG-APELLIDO-AUXPIC X(15).03 NOMBRE-AUXPIC X(15).03 NOMBRE-AUXPIC X(15).
01  CONTADORES.01  CONTADORES.03 JLPIC 9(02) VALUE ZERO.03 JLPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 SW-ERRORPIC 9     VALUE ZERO.03 SW-ERRORPIC 9     VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 BLOC-IGUALPIC 9(02) VALUE ZERO.03 BLOC-IGUALPIC 9(02) VALUE ZERO.03 BLOQUESPIC 9(02) VALUE ZERO.03 BLOQUESPIC 9(02) VALUE ZERO.03 ENCONTRADOPIC 9     VALUE ZERO.03 ENCONTRADOPIC 9     VALUE ZERO.03 SUPPIC 9(02) VALUE ZERO.03 SUPPIC 9(02) VALUE ZERO.03 INFPIC 9(02) VALUE ZERO.03 INFPIC 9(02) VALUE ZERO.03 JJPIC 9(02) VALUE ZERO.03 JJPIC 9(02) VALUE ZERO.
*------------------------------------------------------------------**------------------------------------------------------------------*
01  W-VARIABLES.01  W-VARIABLES.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.01  W-VARIABLES.01  W-VARIABLES.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-EDAD-CEDULAPIC 9(03) VALUE ZEROS.03 W-EDAD-CEDULAPIC 9(03) VALUE ZEROS.03 W-FEC-EXPEPIC 9(08) VALUE ZEROS.03 W-FEC-EXPEPIC 9(08) VALUE ZEROS.03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.05 W-ANO-EXPEPIC 9(04).05 W-ANO-EXPEPIC 9(04).05 W-MES-EXPEPIC 9(02).05 W-MES-EXPEPIC 9(02).05 W-DIA-EXPEPIC 9(02).05 W-DIA-EXPEPIC 9(02).03 WS-EDADPIC 9(03).03 WS-EDADPIC 9(03).
*------------------------------------------------------------------**------------------------------------------------------------------*
01  VEC-MAESTRO.01  VEC-MAESTRO.03 LETRA-MAESTROPIC X  OCCURS 65 TIMES.03 LETRA-MAESTROPIC X  OCCURS 65 TIMES.
01  VEC-DANE.01  VEC-DANE.03 LETRA-DANEPIC X  OCCURS 65 TIMES.03 LETRA-DANEPIC X  OCCURS 65 TIMES.
01  VEC-BLOQUES.01  VEC-BLOQUES.03 LIM-INFPIC 9(02)  OCCURS 44 TIMES.03 LIM-INFPIC 9(02)  OCCURS 44 TIMES.03 LIM-SUPPIC 9(02)  OCCURS 44 TIMES.03 LIM-SUPPIC 9(02)  OCCURS 44 TIMES.
01  CONTADORES-COMP-NOMBRE.01  CONTADORES-COMP-NOMBRE.03 KPIC 9(04) VALUE ZERO.03 KPIC 9(04) VALUE ZERO.03 NOMBRE-BIENPIC 9     VALUE ZERO.03 NOMBRE-BIENPIC 9     VALUE ZERO.
01  VEC-MAESTRO-UNO.01  VEC-MAESTRO-UNO.03 LETRA-MAESTRO-UNOPIC X  OCCURS 45 TIMES.03 LETRA-MAESTRO-UNOPIC X  OCCURS 45 TIMES.
01  VEC-DANE-UNO.01  VEC-DANE-UNO.03 LETRA-DANE-UNOPIC X  OCCURS 45 TIMES.03 LETRA-DANE-UNOPIC X  OCCURS 45 TIMES.
01  VEC-BLOQUES-UNO.01  VEC-BLOQUES-UNO.03 LIM-INF-UNOPIC 99  OCCURS 44 TIMES.03 LIM-INF-UNOPIC 99  OCCURS 44 TIMES.03 LIM-SUP-UNOPIC 99  OCCURS 44 TIMES.03 LIM-SUP-UNOPIC 99  OCCURS 44 TIMES.
01  TITULO-1.01  TITULO-1.03 FILLERPIC X(55) VALUE SPACES.03 FILLERPIC X(55) VALUE SPACES.03 FILLERPIC X(21) VALUE03 FILLERPIC X(21) VALUE"D A T A C R E D I T O"."D A T A C R E D I T O".03 FILLERPIC X(33) VALUE SPACES.03 FILLERPIC X(33) VALUE SPACES.03 DIA-T1PIC X(02).03 DIA-T1PIC X(02).03 FILLERPIC X     VALUE "/".03 FILLERPIC X     VALUE "/".03 MES-T1PIC X(02).03 MES-T1PIC X(02).03 FILLERPIC X     VALUE "/".03 FILLERPIC X     VALUE "/".03 SIG-T1PIC X(02).03 SIG-T1PIC X(02).03 ANO-T1PIC X(02).03 ANO-T1PIC X(02).03 FILLERPIC X(13) VALUE SPACES.03 FILLERPIC X(13) VALUE SPACES.
01  TITULO-2.01  TITULO-2.03 FILLERPIC X(10) VALUE " PESVNOCSV".03 FILLERPIC X(10) VALUE " PESVNOCSV".03 FILLERPIC X(41) VALUE SPACES.03 FILLERPIC X(41) VALUE SPACES.03 FILLERPIC X(37) VALUE03 FILLERPIC X(37) VALUE"ESTADISTICAS DE VALIDACION DE CEDULAS"."ESTADISTICAS DE VALIDACION DE CEDULAS".03 FILLERPIC X(24) VALUE SPACES.03 FILLERPIC X(24) VALUE SPACES.03 HORA-T2PIC 9(02).03 HORA-T2PIC 9(02).03 FILLERPIC X     VALUE ":".03 FILLERPIC X     VALUE ":".03 MIN-T2PIC 9(02).03 MIN-T2PIC 9(02).03 FILLERPIC X(06) VALUE SPACES.03 FILLERPIC X(06) VALUE SPACES.03 FILLERPIC X(06) VALUE "SUSC: ".03 FILLERPIC X(06) VALUE "SUSC: ".03 SUSCRIPTOR-T2PIC 9(06).03 SUSCRIPTOR-T2PIC 9(06).
01  RAYASPIC X(132) VALUE ALL "-".01  RAYASPIC X(132) VALUE ALL "-".
01  LINEA-1.01  LINEA-1.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(32) VALUE03 FILLERPIC X(32) VALUE"REGISTROS LEIDOS:"."REGISTROS LEIDOS:".03 FILLERPIC X(32) VALUE03 FILLERPIC X(32) VALUE"REGISTROS LEIDOS:"."REGISTROS LEIDOS:".03 REG-LEIDOS-L1PIC ZZ,ZZZ,ZZ9.03 REG-LEIDOS-L1PIC ZZ,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-2.01  LINEA-2.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"REGISTROS CORRECTOS:"."REGISTROS CORRECTOS:".03 REG-CORRECTOS-L2PIC Z,ZZZ,ZZ9.03 REG-CORRECTOS-L2PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-3.01  LINEA-3.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO COINCIDEN CON DIAN O DAS:     "."NO COINCIDEN CON DIAN O DAS:     ".03 NO-COINCIDE-DIAN-L3PIC Z,ZZZ,ZZ9.03 NO-COINCIDE-DIAN-L3PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-4.01  LINEA-4.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO COINCIDEN CON REGISTARDURIA:  "."NO COINCIDEN CON REGISTARDURIA:  ".03 NO-COINCIDE-REGIS-L4     PIC Z,ZZZ,ZZ9.03 NO-COINCIDE-REGIS-L4     PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-5.01  LINEA-5.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO EXISTEN EN DIAN O DAS:"."NO EXISTEN EN DIAN O DAS:".03 NO-EXISTE-DIAN-L5PIC Z,ZZZ,ZZ9.03 NO-EXISTE-DIAN-L5PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-6.01  LINEA-6.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO EXISTEN EN REGISTRADURIA:     "."NO EXISTEN EN REGISTRADURIA:     ".03 NO-EXISTE-REGIS-L6PIC Z,ZZZ,ZZ9.03 NO-EXISTE-REGIS-L6PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-7.01  LINEA-7.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"TIPO IDENTIFICACION INVALIDO:    "."TIPO IDENTIFICACION INVALIDO:    ".03 TIPO-ID-INVALIDO-L7PIC Z,ZZZ,ZZ9.03 TIPO-ID-INVALIDO-L7PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  FECHA-2000PIC 9(8).01  FECHA-2000PIC 9(8).
01  FECHA-2000-R  REDEFINES FECHA-2000.01  FECHA-2000-R  REDEFINES FECHA-2000.03 ANO-2000-RPIC 9(4).03 ANO-2000-RPIC 9(4).03 MES-2000-RPIC 9(2).03 MES-2000-RPIC 9(2).03 DIA-2000-RPIC 9(2).03 DIA-2000-RPIC 9(2).
*------------------------------------------------------------------**------------------------------------------------------------------*
01  HACER-MATCHPIC  9(01).01  HACER-MATCHPIC  9(01).
01  CADENA-ENTRAPIC  X(60).01  CADENA-ENTRAPIC  X(60).
01  CADENA-SALEPIC  X(60).01  CADENA-SALEPIC  X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
CQ6271 LINKAGE SECTION.PJV0010CQ6271 LINKAGE SECTION.PJV0010"Ñ"."Ñ".
CQ6271 LINKAGE SECTION.PJV0010CQ6271 LINKAGE SECTION.PJV0010
CQ6271 COPY LOGPESVNO.LKG.PJV0010CQ6271 COPY LOGPESVNO.LKG.PJV0010
**
*=================================================================*=================================================================
$SET CONSTANT HACERMATCH"SI"$SET CONSTANT HACERMATCH"SI"
$SET CONSTANT AMNISTIA21"SI"$SET CONSTANT AMNISTIA21"SI"
*=================================================================*=================================================================PROCEDURE DIVISION.PROCEDURE DIVISION.
************************************************************************************************************************************
*100-PROGRAMA-PRINCIPAL.*100-PROGRAMA-PRINCIPAL.
*RUTINA PRINCIPAL*RUTINA PRINCIPAL
*VALIDA EL CODIGO DEL SUSCRIPTOR DEL ARCHIVO DE ENTRADA*VALIDA EL CODIGO DEL SUSCRIPTOR DEL ARCHIVO DE ENTRADA
*VALIDA LA CLAVE CON QUE SE GRABARAN REGISTROS EN EL ICBTCO*VALIDA LA CLAVE CON QUE SE GRABARAN REGISTROS EN EL ICBTCO
************************************************************************************************************************************
100-PROGRAMA-PRINCIPAL.100-PROGRAMA-PRINCIPAL.PERFORM 150-ABRIR-ARCHIVOSPERFORM 150-ABRIR-ARCHIVOSREAD ENTRADAREAD ENTRADAAT ENDAT ENDMOVE 1 TO FIN-ENTRADAMOVE 1 TO FIN-ENTRADANOT AT ENDNOT AT ENDINSPECT NUMID-X-E REPLACING ALL " " BY "0"INSPECT NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READEND-READ
R7094A     IF NOMBRE-E = "VALIDAR=NO" AND FIN-ENTRADA = 0RMB0009R7094A     IF NOMBRE-E = "VALIDAR=NO" AND FIN-ENTRADA = 0RMB0009
R7094AMOVE 0 TO W-BLOQUESRMB0009R7094AMOVE 0 TO W-BLOQUESRMB0009
R7094ADISPLAY "Registro  control==> 000001 (VALIDAR=NO)"RMB0009R7094ADISPLAY "Registro  control==> 000001 (VALIDAR=NO)"RMB0009
R7094AMOVE 0 TO W-BLOQUESRMB0009R7094AMOVE 0 TO W-BLOQUESRMB0009
R7094AREAD ENTRADARMB0009R7094AREAD ENTRADARMB0009
R7094AAT ENDRMB0009R7094AAT ENDRMB0009
R7094AMOVE 1 TO FIN-ENTRADARMB0009R7094AMOVE 1 TO FIN-ENTRADARMB0009
R7094ANOT AT ENDRMB0009R7094ANOT AT ENDRMB0009
R7094AINSPECT NUMID-X-E REPLACING ALL " " BY "0"RMB0009R7094AINSPECT NUMID-X-E REPLACING ALL " " BY "0"RMB0009
R7094AINSPECT TIPOID-X-E REPLACING ALL "0" BY "1"RMB0009R7094AINSPECT TIPOID-X-E REPLACING ALL "0" BY "1"RMB0009
R7094AEND-READRMB0009R7094AEND-READRMB0009
R7094A     ELSERMB0009R7094A     ELSERMB0009
R7094ADISPLAY "Registro  control==> 000000 (VALIDAR=NO)"RMB0009R7094ADISPLAY "Registro  control==> 000000 (VALIDAR=NO)"RMB0009
R7094A     END-IF.RMB0009R7094A     END-IF.RMB0009CLOSE CLAVE ABD14.CLOSE CLAVE ABD14.MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-RMOVE FUNCTION CURRENT-DATE TO FECHA-PROC-RMOVE DIA-PROC TO DIA-AUXMOVE DIA-PROC TO DIA-AUXMOVE MES-PROC TO MES-AUXMOVE MES-PROC TO MES-AUXMOVE ANO-PROC TO ANO-AUXMOVE ANO-PROC TO ANO-AUXMOVE ANO-HOY  TO W-ANO-ACTUALMOVE ANO-HOY  TO W-ANO-ACTUALPERFORM 400-VALIDAR UNTIL FIN-ENTRADA = 1.PERFORM 400-VALIDAR UNTIL FIN-ENTRADA = 1.IF W-CONT-TIPO-5 >  ZEROS  ORIF W-CONT-TIPO-5 >  ZEROS  ORW-CONT-TIPO-6 >  ZEROS  ORW-CONT-TIPO-6 >  ZEROS  ORW-CONT-TIPO-7 >  ZEROSW-CONT-TIPO-7 >  ZEROSDISPLAY "Registros Tipo 5==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 5==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 6==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7
PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7
PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407
PJV012DISPLAY "*-----------------------------------*"CQ12657PJV012DISPLAY "*-----------------------------------*"CQ12657
PJV012DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSVCQ12657PJV012DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSVCQ12657
PJV012DISPLAY "*------------------------------------*"CQ12657PJV012DISPLAY "*------------------------------------*"CQ12657END-IFEND-IFPERFORM 900-CERRAR-ARCHIVOSPERFORM 900-CERRAR-ARCHIVOS
CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010
CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010
CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010STOP RUN.STOP RUN.************************************************************************************************************************************
*150-ABRIR-ARCHIVOS.*150-ABRIR-ARCHIVOS.
*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU
*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU
*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN
*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE
*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO
************************************************************************************************************************************
150-ABRIR-ARCHIVOS.150-ABRIR-ARCHIVOS.OPEN INPUT BDIIREGI.OPEN INPUT BDIIREGI.
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"
*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"
MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011ACCEPT W-PARAMETROS   FROM COMMAND-LINEACCEPT W-PARAMETROS   FROM COMMAND-LINEUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOW-ENT-NOMBRE,W-ENT-NOMBRE,W-VAL-NOMBRE,W-VAL-NOMBRE,W-INVAL-NOMBRE,W-INVAL-NOMBRE,W-TARIFA,W-TARIFA,W-BLOQUES,W-BLOQUES,W-DERECHOSW-DERECHOSEND-UNSTRINGEND-UNSTRINGIF W-TARIFA= ZEROS  ORIF W-TARIFA= ZEROS  ORW-ENT-NOMBRE   = SPACES ORW-ENT-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-INVAL-NOMBRE = SPACES ORW-INVAL-NOMBRE = SPACES OR
R7094A*(W-BLOQUES < 0 OR > 4)RMB0009R7094A*(W-BLOQUES < 0 OR > 4)RMB0009
R7094AW-BLOQUES > 4RMB0009R7094AW-BLOQUES > 4RMB0009DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "STOP RUNSTOP RUNEND-IFEND-IF
R7094A     IF W-BLOQUES = 0RMB0009R7094A     IF W-BLOQUES = 0RMB0009
R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009
R7094A     END-IFRMB0009R7094A     END-IFRMB0009

PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407
PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407
PJV011".vre"DELIMITED BY SIZECQ11407PJV011".vre"DELIMITED BY SIZECQ11407
PJV011INTO W-VAL-NOMBRE-REPCQ11407PJV011INTO W-VAL-NOMBRE-REPCQ11407
PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407MOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTW-SORT-NOM-SALW-SORT-NOM-SALW-LINEAS-NOM-ENTW-LINEAS-NOM-ENT
*    DISPLAY "============================================"*    DISPLAY "============================================"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"CALL "SYSTEM" USING W-COMANDO-LINEASCALL "SYSTEM" USING W-COMANDO-LINEAS
*    DISPLAY " "*    DISPLAY " "DISPLAY "ARCHIVO: " W-LINEAS-NOM-ENTDISPLAY "ARCHIVO: " W-LINEAS-NOM-ENT
*    DISPLAY " "*    DISPLAY " "CALL "SYSTEM" USING W-COMANDO-SORTCALL "SYSTEM" USING W-COMANDO-SORTIF RETURN-CODE <> 0IF RETURN-CODE <> 0DISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBREDISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBRESTOP RUNSTOP RUNEND-IFEND-IFOPEN INPUT  ENTRADAOPEN INPUT  ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIALEBDIIALEMUNICIPIOSMUNICIPIOSCLAVECLAVEABD14ABD14
XXXXXX*    OPEN I-O    SECUENCIALXXXXXX*    OPEN I-O    SECUENCIAL
XXXXXX     OPEN INPUT  SECUENCIALXXXXXX     OPEN INPUT  SECUENCIALOPEN OUTPUT VALIDASOPEN OUTPUT VALIDASINCONSINCONS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407MOVE 29999999 TO LLAVE-SECMOVE 29999999 TO LLAVE-SECSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-STARTEND-STARTIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEREAD SECUENCIAL PREVIOUS AT ENDREAD SECUENCIAL PREVIOUS AT ENDDISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "DISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "LLAVE-SECLLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-READEND-READIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEMOVE LLAVE-SEC TO LLAVE7MOVE LLAVE-SEC TO LLAVE7IF LLAVE7-1D NOT = 2IF LLAVE7-1D NOT = 2MOVE 2     TO LLAVE7-1DMOVE 2     TO LLAVE7-1DMOVE ZEROS TO LLAVE7-FILLERMOVE ZEROS TO LLAVE7-FILLEREND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.**************************************************************************************************************************************
*400-VALIDAR*400-VALIDAR***************************************************************************************************************************************400-VALIDAR*400-VALIDAR
* DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-* DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-
* TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,* TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,
* NIT O DAS)* NIT O DAS)
* ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION* ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION
* LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA* LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA
**************************************************************************************************************************************
400-VALIDAR.400-VALIDAR.ADD  1 TO REG-LEIDOS.ADD  1 TO REG-LEIDOS.MOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INCMOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INCINITIALIZE REG-INCONS REG-VALIDASINITIALIZE REG-INCONS REG-VALIDASMOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9FILLER6 FILLER7 FILLER8 FILLER9MOVE FILLER-2-E TO FILLER-2-VALMOVE FILLER-2-E TO FILLER-2-VALMOVE FILLER-2-E TO FILLER-2-INCMOVE FILLER-2-E TO FILLER-2-INCIF TIPOID-E < 1 OR > 4IF TIPOID-E < 1 OR > 4MOVE 05 TO CODIGO-ERROR CODERR-INCMOVE 05 TO CODIGO-ERROR CODERR-INCMOVE 1  TO SW-ERRORMOVE 1  TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD  1  TO TIPO-ID-INVALIDOADD  1  TO TIPO-ID-INVALIDOELSEELSEMOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDENUM-ID-WNUM-ID-WMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDEMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDE
R7094A*MOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     |  PJV012MOVE    1TO  SW-VERIFNOM-BDIIVIDECQ12657
R7094A*SW-DIGCHEQUEO-BDIIVIDERMB0009     |  PJV012SW-DIGCHEQUEO-BDIIVIDECQ12657
R7094AIF W-BLOQUES > 0RMB0009     <
R7094AMOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     <
R7094AEND-IFRMB0009     <
R7094DIF TIPOID-E = 2 OR 3RMB0009     <
R7094DMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDERMB0009     <
R7094DEND-IFRMB0009     <MOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEMOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEPERFORM 80100-VALIDAR-IDENTIFICACIONPERFORM 80100-VALIDAR-IDENTIFICACIONMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EINITIALIZE REG-VALIDAS REG-INCONSINITIALIZE REG-VALIDAS REG-INCONS
REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007     <
REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007     <MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9FILLER6 FILLER7 FILLER8 FILLER9
>  REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007
>  REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007IF SW-ID-BDIIVIDE = 1IF SW-ID-BDIIVIDE = 1IF TIPOID-E <> 1IF TIPOID-E <> 1
CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006
CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003
CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003
CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003
CSVCEXMOVE  1TO SW-ERRORGJC0003CSVCEXMOVE  1TO SW-ERRORGJC0003
CSVCEXPERFORM 512-CREE-REGISTROGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003
CSVCEXWRITE REG-INCONSGJC0003CSVCEXWRITE REG-INCONSGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003
CSVCEXWRITE REG-INCONSGJC0003CSVCEXWRITE REG-INCONSGJC0003
CSVCEXADD   1TO  NO-EXISTE-DIANGJC0003CSVCEXADD   1TO  NO-EXISTE-DIANGJC0003
CSVCEXEND-IFGJC0003CSVCEXEND-IFGJC0003ELSEELSEMOVE  ZEROS TO  HACER-MATCHMOVE  ZEROS TO  HACER-MATCH
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006PERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0MOVE 04 TO CODIGO-ERROR CODERR-INCMOVE 04 TO CODIGO-ERROR CODERR-INCMOVE TIPOID-E TO TIP-INCMOVE TIPOID-E TO TIP-INCADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISMOVE 1  TO SW-ERRORMOVE 1  TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSEND-IFEND-IFEND-IFEND-IFELSEELSEIF SW-NOMBRES-BDIIVIDE = 1IF SW-NOMBRES-BDIIVIDE = 1IF TIPOID-E <> 1IF TIPOID-E <> 1MOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE  1 TO SW-ERRORMOVE  1 TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS TO MUN-EXP-INCMOVE NACIO-BDIIDAS TO MUN-EXP-INCEND-IFEND-IFELSEELSEPERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIOMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADESMOVE FECHA-2000 TO FEC-EXP-VALMOVE FECHA-2000 TO FEC-EXP-VALFEC-EXP-INCFEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00"TO VIG-VAL VIG-INCMOVE "00"TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VALMOVE ESTADO-VIG-BDIIREGI TO VIG-VALVIG-INCVIG-INCEND-IFEND-IFMOVE   02 TO CODIGO-ERROR CODERR-INCMOVE   02 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISEND-IFEND-IFELSEELSE
R7094C*IF W-BLOQUES > 1 OR TIPOID-E <> 1RMB0009R7094C*IF W-BLOQUES > 1 OR TIPOID-E <> 1RMB0009
R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009
R7094C*ELSERMB0009R7094C*ELSERMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009
R7094C*ELSERMB0009R7094C*ELSERMB0009
R7094C*MOVE PRIMER-APELLIDO-BDIIVIDE TO NOM-VALRMB0009R7094C*MOVE PRIMER-APELLIDO-BDIIVIDE TO NOM-VALRMB0009
R7094C*END-IFRMB0009R7094C*END-IFRMB0009
R7094CMOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094CMOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009INITIALIZE LLAVE-BDIIALEINITIALIZE LLAVE-BDIIALEMOVE  TIPOID-E TO TIP-IDE-BDIIALEMOVE  TIPOID-E TO TIP-IDE-BDIIALEMOVE  NUMID-E  TO NUM-IDE-BDIIALEMOVE  NUMID-E  TO NUM-IDE-BDIIALEMOVE  990003   TO FUENTE-BDIIALEMOVE  990003   TO FUENTE-BDIIALESTART BDIIALE KEY NOT < LLAVE-BDIIALESTART BDIIALE KEY NOT < LLAVE-BDIIALEINVALID KEY MOVE 1 TO SW-BDIIALEINVALID KEY MOVE 1 TO SW-BDIIALENOT INVALID KEY MOVE 0 TO SW-BDIIALENOT INVALID KEY MOVE 0 TO SW-BDIIALEREAD BDIIALE NEXT RECORDREAD BDIIALE NEXT RECORDAT END MOVE 1 TO SW-BDIIALEAT END MOVE 1 TO SW-BDIIALEEND-READEND-READEND-STARTEND-STARTPERFORM UNTIL SW-BDIIALE = 1 ORPERFORM UNTIL SW-BDIIALE = 1 ORTIPOID-E <> TIP-IDE-BDIIALE ORTIPOID-E <> TIP-IDE-BDIIALE ORNUMID-E <> NUM-IDE-BDIIALENUMID-E <> NUM-IDE-BDIIALEIF FUENTE-BDIIALE = 990003 ANDIF FUENTE-BDIIALE = 990003 ANDFEC-NOV-BDIIALE <= FECHA-PROC-R ANDFEC-NOV-BDIIALE <= FECHA-PROC-R ANDFEC-VEN-BDIIALE >= FECHA-PROC-R ANDFEC-VEN-BDIIALE >= FECHA-PROC-R ANDBLOQUEO-BDIIALE = 0BLOQUEO-BDIIALE = 0MOVE 1 TO SW-BDIIALEMOVE 1 TO SW-BDIIALEEND-IFEND-IFIF SW-BDIIALE = 0IF SW-BDIIALE = 0READ BDIIALE NEXT RECORDREAD BDIIALE NEXT RECORDAT END MOVE 1 TO SW-BDIIALEAT END MOVE 1 TO SW-BDIIALEEND-READEND-READEND-IFEND-IFEND-PERFORMEND-PERFORMIF TIPOID-E = 1IF TIPOID-E = 1IF ESTADO-VIG-BDIIREGI = 12 ANDIF ESTADO-VIG-BDIIREGI = 12 ANDW-DERECHOS = 1W-DERECHOS = 1MOVE  07   TO  CODIGO-ERROR CODERR-INCMOVE  07   TO  CODIGO-ERROR CODERR-INCMOVE   1   TO  SW-ERRORMOVE   1   TO  SW-ERRORMOVE "00"  TO  VIG-INCMOVE "00"  TO  VIG-INCPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSELSEELSEIF ESTADO-VIG-BDIIREGI = 21IF ESTADO-VIG-BDIIREGI = 21MOVE  06  TO CODIGO-ERROR CODERR-INCMOVE  06  TO CODIGO-ERROR CODERR-INCMOVE   1  TO SW-ERRORMOVE   1  TO SW-ERRORMOVE "21" TO VIG-INCMOVE "21" TO VIG-INCPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD   1   TO NO-COINCIDE-REGISADD   1   TO NO-COINCIDE-REGIS
R7094BADD   1   TO CONT-FALLECIDOSRMB0009R7094BADD   1   TO CONT-FALLECIDOSRMB0009ELSEELSEPERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIOMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE FECHA-2000 TO FEC-EXP-VALMOVE FECHA-2000 TO FEC-EXP-VALFEC-EXP-INCFEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00" TO VIG-VAL VIG-INCMOVE "00" TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VALMOVE ESTADO-VIG-BDIIREGI TO VIG-VALVIG-INCVIG-INCEND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADES
PJV012IF ORIGEN-VAL = SPACESCQ12657PJV012IF ORIGEN-VAL = SPACESCQ12657
PJV012MOVE   "O"TO ORIGEN-VALCQ12657PJV012MOVE   "O"TO ORIGEN-VALCQ12657
PJV012END-IFCQ12657PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFELSEELSEIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE ZEROSTO VIG-VALMOVE ZEROSTO VIG-VALEND-IFEND-IFMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE NUMID-ETO CED-VAL CED-INCMOVE NUMID-ETO CED-VAL CED-INC
PJV012IF ORIGEN-VAL = SPACESCQ12657PJV012IF ORIGEN-VAL = SPACESCQ12657
PJV012MOVE    "O"TO ORIGEN-VALCQ12657PJV012MOVE    "O"TO ORIGEN-VALCQ12657
PJV012END-IFCQ12657PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFIF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD  1 TO W-CONT-TIPO-6ADD  1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1  TO W-CONT-TIPO-7ADD 1  TO W-CONT-TIPO-7ELSEELSE
PJV011IF SN-VALREP = "S"CQ11407PJV011IF SN-VALREP = "S"CQ11407
PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407
PJV011ELSECQ11407PJV011ELSECQ11407ADD 1  TO W-CONT-TIPO-5ADD 1  TO W-CONT-TIPO-5
PJV011END-IFCQ11407PJV011END-IFCQ11407
CQ6271IF TIPOID-E = 2 OR 3PJV0010CQ6271IF TIPOID-E = 2 OR 3PJV0010
CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010
CQ6271END-IFPJV0010CQ6271END-IFPJV0010END-IFEND-IFEND-IFEND-IFREAD ENTRADAREAD ENTRADAAT ENDAT ENDMOVE 1 TO FIN-ENTRADAMOVE 1 TO FIN-ENTRADANOT AT ENDNOT AT ENDINSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READ.END-READ.

PJV011 300-GRABA-VALREP.CQ11407PJV011 300-GRABA-VALREP.CQ11407
PJV011     INITIALIZE REG-VALIDAS-REPCQ11407PJV011     INITIALIZE REG-VALIDAS-REPCQ11407
PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDASCQ11407PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDASCQ11407
PJV011     MOVE TIP-VAL TO TIP-KEYVALCQ11407PJV011     MOVE TIP-VAL TO TIP-KEYVALCQ11407
PJV011     MOVE CED-VAL TO NUM-KEYVALCQ11407PJV011     MOVE CED-VAL TO NUM-KEYVALCQ11407
PJV011     ADD 1 TO REG-CORRECTOS-R  .CQ11407PJV011     ADD 1 TO REG-CORRECTOS-R  .CQ11407

PJV011 301-GRABA-LOS-VALIDOS.CQ11407PJV011 301-GRABA-LOS-VALIDOS.CQ11407
PJV011     MOVE "N" TO SN-VALREPCQ11407PJV011     MOVE "N" TO SN-VALREPCQ11407
PJV011     IF TIP-KEYVAL = TIPOID-E ANDCQ11407PJV011     IF TIP-KEYVAL = TIPOID-E ANDCQ11407
PJV011NUM-KEYVAL = NUMID-ECQ11407PJV011NUM-KEYVAL = NUMID-ECQ11407
PJV011MOVE "S" TO SN-VALREPCQ11407PJV011MOVE "S" TO SN-VALREPCQ11407
PJV011PERFORM 300-GRABA-VALREPCQ11407PJV011PERFORM 300-GRABA-VALREPCQ11407
PJV011     ELSECQ11407PJV011     ELSECQ11407
PJV011WRITE REG-VALIDASCQ11407PJV011WRITE REG-VALIDASCQ11407
PJV011MOVE TIP-VAL TO TIP-KEYVALCQ11407PJV011MOVE TIP-VAL TO TIP-KEYVALCQ11407
PJV011MOVE CED-VAL TO NUM-KEYVALCQ11407PJV011MOVE CED-VAL TO NUM-KEYVALCQ11407
PJV011ADD 1 TO REG-CORRECTOSCQ11407PJV011ADD 1 TO REG-CORRECTOSCQ11407
PJV011     END-IF.CQ11407PJV011     END-IF.CQ11407505-RANGO-EDADES.505-RANGO-EDADES.
*--------------------------------------------------**--------------------------------------------------*
*505-RANGO-EDADES.*505-RANGO-EDADES.
*  RANGO MUJERES: 20'000.001 A 70'000.000*  RANGO MUJERES: 20'000.001 A 70'000.000
*  RANGO HOMBRES:1 A 20'000.000*  RANGO HOMBRES:1 A 20'000.000
*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)
*--------------------------------------------------**--------------------------------------------------*MOVE FEC-EXP-VALTO  W-FEC-EXPEMOVE FEC-EXP-VALTO  W-FEC-EXPEMOVE ZEROSTO  W-EDAD-CEDULAMOVE ZEROSTO  W-EDAD-CEDULAIF W-ANO-EXPE >= 1975IF W-ANO-EXPE >= 1975COMPUTE W-EDAD-CEDULA =COMPUTE W-EDAD-CEDULA =((W-ANO-ACTUAL - W-ANO-EXPE) + 18)((W-ANO-ACTUAL - W-ANO-EXPE) + 18)ELSEELSECOMPUTE W-EDAD-CEDULA =COMPUTE W-EDAD-CEDULA =((W-ANO-ACTUAL - W-ANO-EXPE) + 21)((W-ANO-ACTUAL - W-ANO-EXPE) + 21)END-IFEND-IFMOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDADMOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDADMOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.MOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.EVALUATE WS-EDADEVALUATE WS-EDADWHEN 18 THRU 21WHEN 18 THRU 21MOVE "18-21" TO EDAD-RANGOMOVE "18-21" TO EDAD-RANGOWHEN 22 THRU 28WHEN 22 THRU 28MOVE "22-28" TO EDAD-RANGOMOVE "22-28" TO EDAD-RANGOWHEN 29 THRU 35WHEN 29 THRU 35MOVE "29-35" TO EDAD-RANGOMOVE "29-35" TO EDAD-RANGOWHEN 36 THRU 45WHEN 36 THRU 45MOVE "36-45" TO EDAD-RANGOMOVE "36-45" TO EDAD-RANGOWHEN 46 THRU 55WHEN 46 THRU 55MOVE "46-55" TO EDAD-RANGOMOVE "46-55" TO EDAD-RANGOWHEN 56 THRU 65WHEN 56 THRU 65MOVE "56-65" TO EDAD-RANGOMOVE "56-65" TO EDAD-RANGOWHEN 56 THRU 65WHEN 56 THRU 65MOVE "56-65" TO EDAD-RANGOMOVE "56-65" TO EDAD-RANGOWHEN 66 THRU 999WHEN 66 THRU 999MOVE "66+  " TO EDAD-RANGOMOVE "66+  " TO EDAD-RANGOWHEN ANYWHEN ANYMOVE " N/A " TO EDAD-RANGOMOVE " N/A " TO EDAD-RANGOEND-EVALUATE.END-EVALUATE.
********************************************************************************************************************************
*510-ESCRIBIR-INCONS.*510-ESCRIBIR-INCONS.
* BUSCA ERROR* BUSCA ERROR
* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS
********************************************************************************************************************************
510-ESCRIBIR-INCONS.510-ESCRIBIR-INCONS.IF CODIGO-ERROR = 02 AND SW-ERROR = 1IF CODIGO-ERROR = 02 AND SW-ERROR = 1MOVE TIPOID-E TO TIP-INC.MOVE TIPOID-E TO TIP-INC.IF SW-ERROR = 1IF SW-ERROR = 1PERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONS.WRITE REG-INCONS.****************************************************************************************************************************
*512-CREE-REGISTRO.*512-CREE-REGISTRO.
* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC
****************************************************************************************************************************
512-CREE-REGISTRO.512-CREE-REGISTRO.MOVE TIPOID-E TO TIP-INCMOVE TIPOID-E TO TIP-INCMOVE NUMID-E  TO CED-INCFAC0019MOVE NUMID-E  TO CED-INCFAC0019MOVE NOMBRE-E TO NOM1-INCMOVE NOMBRE-E TO NOM1-INCIF CODIGO-ERROR = 02 OR 01 OR 06 OR 07IF CODIGO-ERROR = 02 OR 01 OR 06 OR 07MOVE NOM-VAL-BDIIVIDE TO NOM2-INCMOVE NOM-VAL-BDIIVIDE TO NOM2-INCELSEELSEMOVE SPACESTO NOM2-INCMOVE SPACESTO NOM2-INCMUN-EXP-INCMUN-EXP-INCDEP-EXP-INCDEP-EXP-INCVIG-INCVIG-INCMOVE ZEROSTO FEC-EXP-INCMOVE ZEROSTO FEC-EXP-INCMOVE FILLER-2-E  TO FILLER-2-INCMOVE FILLER-2-E  TO FILLER-2-INCEND-IF.END-IF.****************************************************************************************************************************
*513-VALIDA-EN-CSV.*513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA*    ALTERNA
****************************************************************************************************************************
513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacionREQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEREQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDEREQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-IDREQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROSIF OPEN-DIR = ZEROSOPEN INPUT MAESTRO-DIRECCOPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLIOPEN INPUT BDLCLIOPEN INPUT SUSCRIPTOROPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIRMOVE 1 TO OPEN-DIREND-IFEND-IFMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSMOVE 1 TO HACERMATCH-LEEMSTRS
REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008
REQ609IF TIPOID-E = 1 OR 4LAG0008REQ609IF TIPOID-E = 1 OR 4LAG0008
REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008
REQ609"," BY " ", ";" BY " "LAG0008REQ609"," BY " ", ";" BY " "LAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008
REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008
REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008
REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008
REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008
REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008
REQ609ELSELAG0008REQ609ELSELAG0008
R7094AIF W-BLOQUES > 0RMB0009R7094AIF W-BLOQUES > 0RMB0009
R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009
R7094AEND-IFRMB0009R7094AEND-IFRMB0009
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E  TO CED-VALMOVE NUMID-E  TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS    TO FEC-EXP-VALMOVE ZEROS    TO FEC-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGOMOVE SPACES   TO EDAD-RANGO
PJV012MOVE "A"TO ORIGEN-VALCQ12657PJV012MOVE "A"TO ORIGEN-VALCQ12657
PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407
PJV011ADD 1 TO SI-EXISTE-CSVCQ11407PJV011ADD 1 TO SI-EXISTE-CSVCQ11407END-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
*9800-FILTRAR-ALFABETICO.**9800-FILTRAR-ALFABETICO.*
*    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA**    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
***************************************************************************************************************************************800-GRABAR-SECUENCIAL.*800-GRABAR-SECUENCIAL.
* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL
* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-
* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN
* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION
**************************************************************************************************************************************
800-GRABAR-SECUENCIAL.800-GRABAR-SECUENCIAL.INITIALIZE REG-SECINITIALIZE REG-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE ZEROSTO TIP-ID-SECMOVE ZEROSTO TIP-ID-SECMOVE W-TARIFATO NUM-TERM-SECMOVE W-TARIFATO NUM-TERM-SECMOVE 2TO COBRA-SECMOVE 2TO COBRA-SECMOVE 1TO PRIV-SECMOVE 1TO PRIV-SECMOVE " "TO SBPRIV-SECMOVE " "TO SBPRIV-SECMOVE 2TO PRODU-SECMOVE 2TO PRODU-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZEROSTO TABLA-SCOR-SECMOVE ZEROSTO TABLA-SCOR-SECACCEPT TIEMPO-WFROM TIMEACCEPT TIEMPO-WFROM TIMEMOVE TIEMPO-W(1:6)     TO HORA-SECMOVE TIEMPO-W(1:6)     TO HORA-SECIF W-CONT-TIPO-5>  ZEROSIF W-CONT-TIPO-5>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE 5  TO TIP-CON-SECMOVE 5  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IFEND-IFIF W-CONT-TIPO-6>  ZEROSIF W-CONT-TIPO-6>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-6  TO NUM-ID-SECMOVE W-CONT-TIPO-6  TO NUM-ID-SECMOVE 6  TO TIP-CON-SECMOVE 6  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IFEND-IFIF W-CONT-TIPO-7>  ZEROSIF W-CONT-TIPO-7>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE 7  TO TIP-CON-SECMOVE 7  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IF.END-IF.
**********************************************************************************************************************************
*810-BUSCAR-MUNICIPIO.*810-BUSCAR-MUNICIPIO.
* OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-* OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-
* NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS* NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS
**********************************************************************************************************************************
810-BUSCAR-MUNICIPIO.810-BUSCAR-MUNICIPIO.MOVE DEP-EXP-BDIIREGI TO CODIGO-DEPMOVE DEP-EXP-BDIIREGI TO CODIGO-DEPMOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNIMOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNIREAD MUNICIPIOS INVALID KEYREAD MUNICIPIOS INVALID KEYMOVE SPACES TO NOMBRE-MUNIMOVE SPACES TO NOMBRE-MUNIMOVE 71     TO CODIGO-DEPMOVE 71     TO CODIGO-DEPEND-READEND-READMOVE NOMBRE-MUNITO MUN-EXP-VAL MUN-EXP-INCMOVE NOMBRE-MUNITO MUN-EXP-VAL MUN-EXP-INCMOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.MOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.
**************************************************************************************************************************************
*900-CERRAR-ARCHIVOS.*900-CERRAR-ARCHIVOS.
* CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN* CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN
* ESTAN ABIERTOS* ESTAN ABIERTOS
**********************************************************************************************************************************
900-CERRAR-ARCHIVOS.900-CERRAR-ARCHIVOS.DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS
PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
R7094B     DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSRMB0009R7094B     DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSRMB0009DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDODISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOCLOSE ENTRADACLOSE ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIREGIBDIIREGIMUNICIPIOSMUNICIPIOSSECUENCIALSECUENCIALVALIDASVALIDAS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407INCONS.INCONS.
**********************************************************************************************************************************COPY BDIIVIDE.PROC.COPY BDIIVIDE.PROC.COPY LEEMAESTROS.PROC.COPY LEEMAESTROS.PROC.COPY BDLDIR.PROC.COPY BDLDIR.PROC.
CQ6271     COPY LOGPESVNO.PROC.PJV0010CQ6271     COPY LOGPESVNO.PROC.PJV0010
~
~
~
~COPY BDLDIR.PROC.COPY BDLDIR.PROC.
CQ6271     COPY LOGPESVNO.PROC.PJV0010CQ6271     COPY LOGPESVNO.PROC.PJV0010
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi qqqsdiff -w 170 PESVNOCSV.CBL PESVNOCSVPLUS.CBL > qq>/d/iccol/desarrollo/fuentes>sdiff -w 170 PESVNOSV.CBL PESVNOCSVPLUS.CBL > qqq V.CBL PESVNOCSVPLUS.CBL > qqq .CBL PESVNOCSVPLUS.CBL > qqq .CBL PESVNOCSVPLUS.CBL >| qqq
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 1078 lines, 145764 characters * PESVNOCSV.V.01.0011|* PESVNOCSVPLUS.V.01.0013IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.DATE-COMPILED.
************************************************************************************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE** PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.* EXTRANJERIA.
**
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
**
* Cliente : Datacredito* Cliente : Datacredito
**
* Version : 09/06/2008 09:08:25 a.m.* Version : 09/06/2008 09:08:25 a.m.
************************************************************************************************************************************
*  Validacion especial tomando el archivo de*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final*  Cuentas Sin Validar para poder reportalos en el informe final
**
************************************************************************************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIASREMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNOREMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*REMARK* SEPT. 30/2009*
REMARK*******************************************************************REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**REMARK* GRACIELA JIM.**
REMARK******************************************************************REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **REMARK* G.DESARROLLO **
REMARK******************************************************************REMARK******************************************************************
************************************************************************************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A ** GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.** FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   ** EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS** MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     ** LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1** OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     ** LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA** OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   ** RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
* AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS** AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS*
* GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO ** GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *
*| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     **| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
************************************************************************************************************************************
* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.*
* SEP-01-2012|** SEP-01-2012|*"qqq" 1078 lines, 145764 characters* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** SEP-01-2012|** SEP-01-2012|*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES*
* ABR-02-2013| REPETIDAS VALIDAS.** ABR-02-2013| REPETIDAS VALIDAS.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
>* PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES*
>* JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
>* PEDRO V.   |*
>******************************************************************
>* STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
>* JUL-31-2013|*
>* LUIS GOMEZ |*
>******************************************************************
**
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
CONFIGURATION SECTION.CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.INPUT-OUTPUT SECTION.COPY BDIIDIAN.FS.COPY BDIIDIAN.FS.COPY BDIIREGI.FS.COPY BDIIREGI.FS.COPY BDIIDAS.FS.COPY BDIIDAS.FS.COPY ICBTCO.FS.COPY ICBTCO.FS.COPY ICBCLA0001.FS.COPY ICBCLA0001.FS.COPY ICBCIU.FS.COPY ICBCIU.FS.
CTAST8*    COPY  ICBCHK.FS.GDT0005CTAST8*    COPY  ICBCHK.FS.GDT0005
CTAST8     COPY  ICBCHK0001.FS.GDT0005CTAST8     COPY  ICBCHK0001.FS.GDT0005COPY ICBCRE.FS.COPY ICBCRE.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY BDLCLI.FS.COPY BDLCLI.FS.COPY ICBDIR.FS.COPY ICBDIR.FS.COPY ICMUNI.FS.COPY ICMUNI.FS.COPY BDIIALE.FS.COPY BDIIALE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.COPY DIREST.FS.COPY DIREST.FS.COPY NOAMNISTIA21.FS.COPY NOAMNISTIA21.FS.COPY BDACSV.FS.COPY BDACSV.FS.SELECT ENTRADA  ASSIGN TO DISK W-ENTRADASELECT ENTRADA  ASSIGN TO DISK W-ENTRADAORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.SELECT VALIDAS  ASSIGN TO DISK W-VALIDASSELECT VALIDAS  ASSIGN TO DISK W-VALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.

PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407
PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407
PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407SELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALSELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.DATA DIVISION.DATA DIVISION.
FILE SECTION.FILE SECTION.
COPY ICBCHK.FD.COPY ICBCHK.FD.
COPY ICBSUS.FD.COPY ICBSUS.FD.
COPY BDACSV.FD.COPY BDACSV.FD.
COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.
COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.
COPY DIREST.FD.COPY DIREST.FD.
COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.
COPY NOAMNISTIA21.FD.COPY NOAMNISTIA21.FD.
COPY BDIIDIAN.FD.COPY BDIIDIAN.FD.
COPY BDIIREGI.FD.COPY BDIIREGI.FD.
COPY BDIIDAS.FD.COPY BDIIDAS.FD.
COPY ICBTCO001.FD.COPY ICBTCO001.FD.
COPY ICBCLA.FD.COPY ICBCLA.FD.
COPY ICBCIU.FD.COPY ICBCIU.FD.
COPY ICBCRE.FD.COPY ICBCRE.FD.
COPY BDLCLI.FD.COPY BDLCLI.FD.
COPY ICMUNI.FD.COPY ICMUNI.FD.
COPY BDIIALE.FD.COPY BDIIALE.FD.FD  ENTRADA.FD  ENTRADA.
01  REG-ENTRADA.01  REG-ENTRADA.03 TIPOID-EPIC   9(01).03 TIPOID-EPIC   9(01).03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).03 NUMID-EPIC   9(11).03 NUMID-EPIC   9(11).03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).03 NOMBRE-EPIC   X(45).03 NOMBRE-EPIC   X(45).03 FILLER-2-EPIC   X(60).|  PJV012*    03 FILLER-2-EPIC   X(360).CQ12657
>  STT013     03 FILLER-2-EPIC   X(660).CQ12837FD  VALIDAS.FD  VALIDAS.
01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).
PAM460*    03 ORIGEN-VALPIC X.|  PJV012     03 ORIGEN-VALPIC X.CQ12657
PAM460     03 FILLER-2-VALPIC X(51).|  PJV012*    03 FILLER-2-VALPIC X(350).CQ12657
>  STT013     03 FILLER-2-VALPIC X(650).CQ12837

PJV011 FD  VALIDAS-REP.CQ11407PJV011 FD  VALIDAS-REP.CQ11407
PJV011 01  REG-VALIDAS-REP.CQ11407PJV011 01  REG-VALIDAS-REP.CQ11407
PJV011     03 TIP-VALREPPIC 9.CQ11407PJV011     03 TIP-VALREPPIC 9.CQ11407
PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407
PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407
PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407
PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407
PJV011     03 VIG-VALREPPIC X(02).CQ11407PJV011     03 VIG-VALREPPIC X(02).CQ11407
PJV011     03 GENERO-VALREPPIC X(01).CQ11407PJV011     03 GENERO-VALREPPIC X(01).CQ11407
PJV011     03 EDAD-VALREPPIC X(03).CQ11407PJV011     03 EDAD-VALREPPIC X(03).CQ11407
PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407
PJV011     03 FILLER-2-VALREPPIC X(51).CQ11407     |  PJV012*    03 FILLER-2-VALREPPIC X(651).CQ12837
>  STT013     03 FILLER-2-VALREPPIC X(651).CQ12657FD  INCONS.FD  INCONS.
01  REG-INCONS.01  REG-INCONS.03 TIP-INCPIC 9.03 TIP-INCPIC 9.
PAM372     03 FILLER1PIC X VALUE ";".PAM372     03 FILLER1PIC X VALUE ";".03 CED-INCPIC 9(11).03 CED-INCPIC 9(11).
PAM372     03 FILLER2PIC X VALUE ";".PAM372     03 FILLER2PIC X VALUE ";".03 NOM1-INCPIC X(45).03 NOM1-INCPIC X(45).
PAM372     03 FILLER3PIC X VALUE ";".PAM372     03 FILLER3PIC X VALUE ";".03 NOM2-INCPIC X(45).03 NOM2-INCPIC X(45).
PAM372     03 FILLER4PIC X VALUE ";".PAM372     03 FILLER4PIC X VALUE ";".03 FEC-EXP-INCPIC 9(08).03 FEC-EXP-INCPIC 9(08).
PAM372     03 FILLER5PIC X VALUE ";".PAM372     03 FILLER5PIC X VALUE ";".03 MUN-EXP-INCPIC X(15).03 MUN-EXP-INCPIC X(15).
PAM372     03 FILLER6PIC X VALUE ";".PAM372     03 FILLER6PIC X VALUE ";".03 DEP-EXP-INCPIC X(15).03 DEP-EXP-INCPIC X(15).
PAM372     03 FILLER7PIC X VALUE ";".PAM372     03 FILLER7PIC X VALUE ";".03 VIG-INCPIC X(02).03 VIG-INCPIC X(02).
PAM372     03 FILLER8PIC X VALUE ";".PAM372     03 FILLER8PIC X VALUE ";".03 CODERR-INCPIC 9(02).03 CODERR-INCPIC 9(02).
PAM372     03 FILLER9PIC X VALUE ";".PAM372     03 FILLER9PIC X VALUE ";".03 FILLER-2-INCPIC X(60).03 FILLER-2-INCPIC X(60).********************************************************************************************************
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
******************************************************************************************************
CQ6271 COPY LOGPESVNO.WS.PJV0010CQ6271 COPY LOGPESVNO.WS.PJV0010
01 W-COMANDO-LINEAS.01 W-COMANDO-LINEAS.03 FILLERPIC X(06) VALUE "wc -l ".03 FILLERPIC X(06) VALUE "wc -l ".03 ENTRADA-LINEAS.03 ENTRADA-LINEAS.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 FILLERPIC X(30)05 FILLERPIC X(30)VALUE " | awk '{ print ($1) }'".VALUE " | awk '{ print ($1) }'".03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
01 W-COMANDO-SORT.01 W-COMANDO-SORT.03 FILLERPIC X(13) VALUE "sort -u ".03 FILLERPIC X(13) VALUE "sort -u ".03 ENTRADA-SORT.03 ENTRADA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.03 FILLERPIC X(13) VALUE " -o ".03 FILLERPIC X(13) VALUE " -o ".03 SALIDA-SORT.03 SALIDA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
*--------------------------------------------------------------**--------------------------------------------------------------*
01  W-ENTRADA.01  W-ENTRADA.03 W-ENT-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-ENT-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-ENT-NOMBREPIC X(30) VALUE SPACES.03 W-ENT-NOMBREPIC X(30) VALUE SPACES.
01  W-VALIDAS.01  W-VALIDAS.03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-VAL-NOMBREPIC X(30) VALUE SPACES.03 W-VAL-NOMBREPIC X(30) VALUE SPACES.
01  W-INVALIDAS.01  W-INVALIDAS.03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".03 W-INVAL-NOMBREPIC X(30) VALUE SPACES.03 W-INVAL-NOMBREPIC X(30) VALUE SPACES.
PJV011 01  W-VALIDAS-REP.CQ11407PJV011 01  W-VALIDAS-REP.CQ11407
PJV011     03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".     CQ11407PJV011     03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".     CQ11407
PJV011     03 W-VAL-NOMBRE-REPPIC X(30) VALUE SPACES.CQ11407PJV011     03 W-VAL-NOMBRE-REPPIC X(30) VALUE SPACES.CQ11407

PJV011 01  W-KEYVAL-GRA.CQ11407PJV011 01  W-KEYVAL-GRA.CQ11407
PJV011     03 TIP-KEYVALPIC 9(01) VALUE ZEROS.CQ11407PJV011     03 TIP-KEYVALPIC 9(01) VALUE ZEROS.CQ11407
PJV011     03 NUM-KEYVALPIC 9(11) VALUE ZEROS.CQ11407PJV011     03 NUM-KEYVALPIC 9(11) VALUE ZEROS.CQ11407
PJV011     03 SN-VALREPPIC X(01) VALUE SPACES.CQ11407PJV011     03 SN-VALREPPIC X(01) VALUE SPACES.CQ1140701  W-PARAMETROSPIC X(94) VALUE SPACES.01  W-PARAMETROSPIC X(94) VALUE SPACES.
01  W-TARIFAPIC 9(04) VALUE ZEROS.01  W-TARIFAPIC 9(04) VALUE ZEROS.
01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  W-BLOQUESPIC 9(01) VALUE ZEROS.
01  SW-BDIIALEPIC 9(01) VALUE ZEROS.01  SW-BDIIALEPIC 9(01) VALUE ZEROS.
01  W-DERECHOSPIC 9     VALUE ZEROS.01  W-DERECHOSPIC 9     VALUE ZEROS.
01  OPEN-DIRPIC 9     VALUE ZEROS.01  OPEN-DIRPIC 9     VALUE ZEROS.
01  FIN-ENTRADAPIC 9     VALUE 0.01  FIN-ENTRADAPIC 9     VALUE 0.
01  FINSPIC 9     VALUE 0.01  FINSPIC 9     VALUE 0.
01  LLAVE7PIC 9(8)  VALUE ZEROS.01  LLAVE7PIC 9(8)  VALUE ZEROS.
01  LLAVE7-R  REDEFINES LLAVE7.01  LLAVE7-R  REDEFINES LLAVE7.03 LLAVE7-1DPIC 9.03 LLAVE7-1DPIC 9.03 LLAVE7-FILLERPIC 9(7).03 LLAVE7-FILLERPIC 9(7).
01  TOPE-INI-LLAVE7PIC 9(8)  VALUE 20000000.01  TOPE-INI-LLAVE7PIC 9(8)  VALUE 20000000.
01  FECHA-PROC.01  FECHA-PROC.03 ANO-HOY.03 ANO-HOY.05 SIG-PROCPIC X(2).05 SIG-PROCPIC X(2).05 ANO-PROCPIC X(2).05 ANO-PROCPIC X(2).03 MES-PROCPIC X(2).03 MES-PROCPIC X(2).03 DIA-PROCPIC X(2).03 DIA-PROCPIC X(2).
01  FECHA-PROC-R  REDEFINES FECHA-PROC01  FECHA-PROC-R  REDEFINES FECHA-PROCPIC X(8).PIC X(8).
01  FECHA-AUX.01  FECHA-AUX.03 DIA-AUXPIC 9(2).03 DIA-AUXPIC 9(2).03 MES-AUXPIC 9(2).03 MES-AUXPIC 9(2).03 ANO-AUXPIC 9(2).03 ANO-AUXPIC 9(2).
01  FECHA-AUX-R  REDEFINES FECHA-AUX01  FECHA-AUX-R  REDEFINES FECHA-AUXPIC 9(6).PIC 9(6).
01  TIEMPO-SIS.01  TIEMPO-SIS.03 HORA-SISPIC 9(02).03 HORA-SISPIC 9(02).03 MIN-SISPIC 9(02).03 MIN-SISPIC 9(02).03 FILLERPIC 9(04).03 FILLERPIC 9(04).
01  TIEMPO-SIS-R  REDEFINES TIEMPO-SIS01  TIEMPO-SIS-R  REDEFINES TIEMPO-SISPIC 9(08).PIC 9(08).
01  TIEMPO-WPIC 9(8).01  TIEMPO-WPIC 9(8).
01  W-CONTADORES.01  W-CONTADORES.01  TIEMPO-WPIC 9(8).01  TIEMPO-WPIC 9(8).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(06) VALUE ZEROS.
CQ6271     03  W-CONT-TIPO-5-PJPIC 9(06) VALUE ZEROS.PJV0010CQ6271     03  W-CONT-TIPO-5-PJPIC 9(06) VALUE ZEROS.PJV0010
PJV011     03  W-CONT-TIPO-5-REPPIC 9(06) VALUE ZEROS.CQ11407PJV011     03  W-CONT-TIPO-5-REPPIC 9(06) VALUE ZEROS.CQ11407
**
01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
R7094B 01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.RMB0009R7094B 01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.RMB0009
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
PJV011 01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.CQ11407PJV011 01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.CQ11407
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.
01  NIT-BUENOPIC 9.01  NIT-BUENOPIC 9.
01  NUM-ID-WPIC 9(11).01  NUM-ID-WPIC 9(11).
*------------------------------------------------------------------**------------------------------------------------------------------*
COPY  ICFILE.WS.COPY  ICFILE.WS.
COPY  BDIIALE.WS.COPY  BDIIALE.WS.
COPY  DEPTOS.WS.COPY  DEPTOS.WS.
COPY  BDIIVIDE.WS.COPY  BDIIVIDE.WS.
COPY  BDLDIR.WS.COPY  BDLDIR.WS.
COPY  LEEMAESTROS.WS.COPY  LEEMAESTROS.WS.
*------------------------------------------------------------------**------------------------------------------------------------------*
01  CODIGO-ERRORPIC 9(02) VALUE ZERO.01  CODIGO-ERRORPIC 9(02) VALUE ZERO.
01  PRIMER-APELLIDOPIC X(16) VALUE SPACES.01  PRIMER-APELLIDOPIC X(16) VALUE SPACES.
01  SEGUNDO-APELLIDOPIC X(16) VALUE SPACES.01  SEGUNDO-APELLIDOPIC X(16) VALUE SPACES.
01  PRIMER-NOMBREPIC X(16) VALUE SPACES.01  PRIMER-NOMBREPIC X(16) VALUE SPACES.
01  SEGUNDO-NOMBREPIC X(16) VALUE SPACES.01  SEGUNDO-NOMBREPIC X(16) VALUE SPACES.
01  NOMBRE-DANE.01  NOMBRE-DANE.03 PR-APELLIDO-ABD05PIC X(15).03 PR-APELLIDO-ABD05PIC X(15).03 NOMBRES-ABD05PIC X(30).03 NOMBRES-ABD05PIC X(30).
01  NOMBRE-DANE-AUXPIC X(45).01  NOMBRE-DANE-AUXPIC X(45).
01  NOM-VAL-AUX.01  NOM-VAL-AUX.03 PR-APELLIDO-AUXPIC X(15).03 PR-APELLIDO-AUXPIC X(15).03 SG-APELLIDO-AUXPIC X(15).03 SG-APELLIDO-AUXPIC X(15).03 NOMBRE-AUXPIC X(15).03 NOMBRE-AUXPIC X(15).
01  CONTADORES.01  CONTADORES.03 JLPIC 9(02) VALUE ZERO.03 JLPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 SW-ERRORPIC 9     VALUE ZERO.03 SW-ERRORPIC 9     VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 BLOC-IGUALPIC 9(02) VALUE ZERO.03 BLOC-IGUALPIC 9(02) VALUE ZERO.03 BLOQUESPIC 9(02) VALUE ZERO.03 BLOQUESPIC 9(02) VALUE ZERO.03 ENCONTRADOPIC 9     VALUE ZERO.03 ENCONTRADOPIC 9     VALUE ZERO.03 SUPPIC 9(02) VALUE ZERO.03 SUPPIC 9(02) VALUE ZERO.03 INFPIC 9(02) VALUE ZERO.03 INFPIC 9(02) VALUE ZERO.03 JJPIC 9(02) VALUE ZERO.03 JJPIC 9(02) VALUE ZERO.
*------------------------------------------------------------------**------------------------------------------------------------------*
01  W-VARIABLES.01  W-VARIABLES.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.01  W-VARIABLES.01  W-VARIABLES.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-EDAD-CEDULAPIC 9(03) VALUE ZEROS.03 W-EDAD-CEDULAPIC 9(03) VALUE ZEROS.03 W-FEC-EXPEPIC 9(08) VALUE ZEROS.03 W-FEC-EXPEPIC 9(08) VALUE ZEROS.03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.05 W-ANO-EXPEPIC 9(04).05 W-ANO-EXPEPIC 9(04).05 W-MES-EXPEPIC 9(02).05 W-MES-EXPEPIC 9(02).05 W-DIA-EXPEPIC 9(02).05 W-DIA-EXPEPIC 9(02).03 WS-EDADPIC 9(03).03 WS-EDADPIC 9(03).
*------------------------------------------------------------------**------------------------------------------------------------------*
01  VEC-MAESTRO.01  VEC-MAESTRO.03 LETRA-MAESTROPIC X  OCCURS 65 TIMES.03 LETRA-MAESTROPIC X  OCCURS 65 TIMES.
01  VEC-DANE.01  VEC-DANE.03 LETRA-DANEPIC X  OCCURS 65 TIMES.03 LETRA-DANEPIC X  OCCURS 65 TIMES.
01  VEC-BLOQUES.01  VEC-BLOQUES.03 LIM-INFPIC 9(02)  OCCURS 44 TIMES.03 LIM-INFPIC 9(02)  OCCURS 44 TIMES.03 LIM-SUPPIC 9(02)  OCCURS 44 TIMES.03 LIM-SUPPIC 9(02)  OCCURS 44 TIMES.
01  CONTADORES-COMP-NOMBRE.01  CONTADORES-COMP-NOMBRE.03 KPIC 9(04) VALUE ZERO.03 KPIC 9(04) VALUE ZERO.03 NOMBRE-BIENPIC 9     VALUE ZERO.03 NOMBRE-BIENPIC 9     VALUE ZERO.
01  VEC-MAESTRO-UNO.01  VEC-MAESTRO-UNO.03 LETRA-MAESTRO-UNOPIC X  OCCURS 45 TIMES.03 LETRA-MAESTRO-UNOPIC X  OCCURS 45 TIMES.
01  VEC-DANE-UNO.01  VEC-DANE-UNO.03 LETRA-DANE-UNOPIC X  OCCURS 45 TIMES.03 LETRA-DANE-UNOPIC X  OCCURS 45 TIMES.
01  VEC-BLOQUES-UNO.01  VEC-BLOQUES-UNO.03 LIM-INF-UNOPIC 99  OCCURS 44 TIMES.03 LIM-INF-UNOPIC 99  OCCURS 44 TIMES.03 LIM-SUP-UNOPIC 99  OCCURS 44 TIMES.03 LIM-SUP-UNOPIC 99  OCCURS 44 TIMES.
01  TITULO-1.01  TITULO-1.03 FILLERPIC X(55) VALUE SPACES.03 FILLERPIC X(55) VALUE SPACES.03 FILLERPIC X(21) VALUE03 FILLERPIC X(21) VALUE"D A T A C R E D I T O"."D A T A C R E D I T O".03 FILLERPIC X(33) VALUE SPACES.03 FILLERPIC X(33) VALUE SPACES.03 DIA-T1PIC X(02).03 DIA-T1PIC X(02).03 FILLERPIC X     VALUE "/".03 FILLERPIC X     VALUE "/".03 MES-T1PIC X(02).03 MES-T1PIC X(02).03 FILLERPIC X     VALUE "/".03 FILLERPIC X     VALUE "/".03 SIG-T1PIC X(02).03 SIG-T1PIC X(02).03 ANO-T1PIC X(02).03 ANO-T1PIC X(02).03 FILLERPIC X(13) VALUE SPACES.03 FILLERPIC X(13) VALUE SPACES.
01  TITULO-2.01  TITULO-2.03 FILLERPIC X(10) VALUE " PESVNOCSV".03 FILLERPIC X(10) VALUE " PESVNOCSV".03 FILLERPIC X(41) VALUE SPACES.03 FILLERPIC X(41) VALUE SPACES.03 FILLERPIC X(37) VALUE03 FILLERPIC X(37) VALUE"ESTADISTICAS DE VALIDACION DE CEDULAS"."ESTADISTICAS DE VALIDACION DE CEDULAS".03 FILLERPIC X(24) VALUE SPACES.03 FILLERPIC X(24) VALUE SPACES.03 HORA-T2PIC 9(02).03 HORA-T2PIC 9(02).03 FILLERPIC X     VALUE ":".03 FILLERPIC X     VALUE ":".03 MIN-T2PIC 9(02).03 MIN-T2PIC 9(02).03 FILLERPIC X(06) VALUE SPACES.03 FILLERPIC X(06) VALUE SPACES.03 FILLERPIC X(06) VALUE "SUSC: ".03 FILLERPIC X(06) VALUE "SUSC: ".03 SUSCRIPTOR-T2PIC 9(06).03 SUSCRIPTOR-T2PIC 9(06).
01  RAYASPIC X(132) VALUE ALL "-".01  RAYASPIC X(132) VALUE ALL "-".
01  LINEA-1.01  LINEA-1.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(32) VALUE03 FILLERPIC X(32) VALUE"REGISTROS LEIDOS:"."REGISTROS LEIDOS:".03 FILLERPIC X(32) VALUE03 FILLERPIC X(32) VALUE"REGISTROS LEIDOS:"."REGISTROS LEIDOS:".03 REG-LEIDOS-L1PIC ZZ,ZZZ,ZZ9.03 REG-LEIDOS-L1PIC ZZ,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-2.01  LINEA-2.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"REGISTROS CORRECTOS:"."REGISTROS CORRECTOS:".03 REG-CORRECTOS-L2PIC Z,ZZZ,ZZ9.03 REG-CORRECTOS-L2PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-3.01  LINEA-3.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO COINCIDEN CON DIAN O DAS:     "."NO COINCIDEN CON DIAN O DAS:     ".03 NO-COINCIDE-DIAN-L3PIC Z,ZZZ,ZZ9.03 NO-COINCIDE-DIAN-L3PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-4.01  LINEA-4.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO COINCIDEN CON REGISTARDURIA:  "."NO COINCIDEN CON REGISTARDURIA:  ".03 NO-COINCIDE-REGIS-L4     PIC Z,ZZZ,ZZ9.03 NO-COINCIDE-REGIS-L4     PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-5.01  LINEA-5.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO EXISTEN EN DIAN O DAS:"."NO EXISTEN EN DIAN O DAS:".03 NO-EXISTE-DIAN-L5PIC Z,ZZZ,ZZ9.03 NO-EXISTE-DIAN-L5PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-6.01  LINEA-6.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO EXISTEN EN REGISTRADURIA:     "."NO EXISTEN EN REGISTRADURIA:     ".03 NO-EXISTE-REGIS-L6PIC Z,ZZZ,ZZ9.03 NO-EXISTE-REGIS-L6PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-7.01  LINEA-7.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"TIPO IDENTIFICACION INVALIDO:    "."TIPO IDENTIFICACION INVALIDO:    ".03 TIPO-ID-INVALIDO-L7PIC Z,ZZZ,ZZ9.03 TIPO-ID-INVALIDO-L7PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  FECHA-2000PIC 9(8).01  FECHA-2000PIC 9(8).
01  FECHA-2000-R  REDEFINES FECHA-2000.01  FECHA-2000-R  REDEFINES FECHA-2000.03 ANO-2000-RPIC 9(4).03 ANO-2000-RPIC 9(4).03 MES-2000-RPIC 9(2).03 MES-2000-RPIC 9(2).03 DIA-2000-RPIC 9(2).03 DIA-2000-RPIC 9(2).
*------------------------------------------------------------------**------------------------------------------------------------------*
01  HACER-MATCHPIC  9(01).01  HACER-MATCHPIC  9(01).
01  CADENA-ENTRAPIC  X(60).01  CADENA-ENTRAPIC  X(60).
01  CADENA-SALEPIC  X(60).01  CADENA-SALEPIC  X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
CQ6271 LINKAGE SECTION.PJV0010CQ6271 LINKAGE SECTION.PJV0010"Ñ"."Ñ".
CQ6271 LINKAGE SECTION.PJV0010CQ6271 LINKAGE SECTION.PJV0010
CQ6271 COPY LOGPESVNO.LKG.PJV0010CQ6271 COPY LOGPESVNO.LKG.PJV0010
**
*=================================================================*=================================================================
$SET CONSTANT HACERMATCH"SI"$SET CONSTANT HACERMATCH"SI"
$SET CONSTANT AMNISTIA21"SI"$SET CONSTANT AMNISTIA21"SI"
*=================================================================*=================================================================PROCEDURE DIVISION.PROCEDURE DIVISION.
************************************************************************************************************************************
*100-PROGRAMA-PRINCIPAL.*100-PROGRAMA-PRINCIPAL.
*RUTINA PRINCIPAL*RUTINA PRINCIPAL
*VALIDA EL CODIGO DEL SUSCRIPTOR DEL ARCHIVO DE ENTRADA*VALIDA EL CODIGO DEL SUSCRIPTOR DEL ARCHIVO DE ENTRADA
*VALIDA LA CLAVE CON QUE SE GRABARAN REGISTROS EN EL ICBTCO*VALIDA LA CLAVE CON QUE SE GRABARAN REGISTROS EN EL ICBTCO
************************************************************************************************************************************
100-PROGRAMA-PRINCIPAL.100-PROGRAMA-PRINCIPAL.PERFORM 150-ABRIR-ARCHIVOSPERFORM 150-ABRIR-ARCHIVOSREAD ENTRADAREAD ENTRADAAT ENDAT ENDMOVE 1 TO FIN-ENTRADAMOVE 1 TO FIN-ENTRADANOT AT ENDNOT AT ENDINSPECT NUMID-X-E REPLACING ALL " " BY "0"INSPECT NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READEND-READ
R7094A     IF NOMBRE-E = "VALIDAR=NO" AND FIN-ENTRADA = 0RMB0009R7094A     IF NOMBRE-E = "VALIDAR=NO" AND FIN-ENTRADA = 0RMB0009
R7094AMOVE 0 TO W-BLOQUESRMB0009R7094AMOVE 0 TO W-BLOQUESRMB0009
R7094ADISPLAY "Registro  control==> 000001 (VALIDAR=NO)"RMB0009R7094ADISPLAY "Registro  control==> 000001 (VALIDAR=NO)"RMB0009
R7094AMOVE 0 TO W-BLOQUESRMB0009R7094AMOVE 0 TO W-BLOQUESRMB0009
R7094AREAD ENTRADARMB0009R7094AREAD ENTRADARMB0009
R7094AAT ENDRMB0009R7094AAT ENDRMB0009
R7094AMOVE 1 TO FIN-ENTRADARMB0009R7094AMOVE 1 TO FIN-ENTRADARMB0009
R7094ANOT AT ENDRMB0009R7094ANOT AT ENDRMB0009
R7094AINSPECT NUMID-X-E REPLACING ALL " " BY "0"RMB0009R7094AINSPECT NUMID-X-E REPLACING ALL " " BY "0"RMB0009
R7094AINSPECT TIPOID-X-E REPLACING ALL "0" BY "1"RMB0009R7094AINSPECT TIPOID-X-E REPLACING ALL "0" BY "1"RMB0009
R7094AEND-READRMB0009R7094AEND-READRMB0009
R7094A     ELSERMB0009R7094A     ELSERMB0009
R7094ADISPLAY "Registro  control==> 000000 (VALIDAR=NO)"RMB0009R7094ADISPLAY "Registro  control==> 000000 (VALIDAR=NO)"RMB0009
R7094A     END-IF.RMB0009R7094A     END-IF.RMB0009CLOSE CLAVE ABD14.CLOSE CLAVE ABD14.MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-RMOVE FUNCTION CURRENT-DATE TO FECHA-PROC-RMOVE DIA-PROC TO DIA-AUXMOVE DIA-PROC TO DIA-AUXMOVE MES-PROC TO MES-AUXMOVE MES-PROC TO MES-AUXMOVE ANO-PROC TO ANO-AUXMOVE ANO-PROC TO ANO-AUXMOVE ANO-HOY  TO W-ANO-ACTUALMOVE ANO-HOY  TO W-ANO-ACTUALPERFORM 400-VALIDAR UNTIL FIN-ENTRADA = 1.PERFORM 400-VALIDAR UNTIL FIN-ENTRADA = 1.IF W-CONT-TIPO-5 >  ZEROS  ORIF W-CONT-TIPO-5 >  ZEROS  ORW-CONT-TIPO-6 >  ZEROS  ORW-CONT-TIPO-6 >  ZEROS  ORW-CONT-TIPO-7 >  ZEROSW-CONT-TIPO-7 >  ZEROSDISPLAY "Registros Tipo 5==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 5==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 6==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7
PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7
PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407
*DISPLAY "*-----------------------------------*"|  PJV012DISPLAY "*-----------------------------------*"CQ12657
*DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSV|  PJV012DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSVCQ12657
*DISPLAY "*------------------------------------*"|  PJV012DISPLAY "*------------------------------------*"CQ12657END-IFEND-IFPERFORM 900-CERRAR-ARCHIVOSPERFORM 900-CERRAR-ARCHIVOS
CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010
CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010
CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010STOP RUN.STOP RUN.************************************************************************************************************************************
*150-ABRIR-ARCHIVOS.*150-ABRIR-ARCHIVOS.
*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU
*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU
*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN
*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE
*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO
************************************************************************************************************************************
150-ABRIR-ARCHIVOS.150-ABRIR-ARCHIVOS.OPEN INPUT BDIIREGI.OPEN INPUT BDIIREGI.
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"
*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"
MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011ACCEPT W-PARAMETROS   FROM COMMAND-LINEACCEPT W-PARAMETROS   FROM COMMAND-LINEUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOW-ENT-NOMBRE,W-ENT-NOMBRE,W-VAL-NOMBRE,W-VAL-NOMBRE,W-INVAL-NOMBRE,W-INVAL-NOMBRE,W-TARIFA,W-TARIFA,W-BLOQUES,W-BLOQUES,W-DERECHOSW-DERECHOSEND-UNSTRINGEND-UNSTRINGIF W-TARIFA= ZEROS  ORIF W-TARIFA= ZEROS  ORW-ENT-NOMBRE   = SPACES ORW-ENT-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-INVAL-NOMBRE = SPACES ORW-INVAL-NOMBRE = SPACES OR
R7094A*(W-BLOQUES < 0 OR > 4)RMB0009R7094A*(W-BLOQUES < 0 OR > 4)RMB0009
R7094AW-BLOQUES > 4RMB0009R7094AW-BLOQUES > 4RMB0009DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "STOP RUNSTOP RUNEND-IFEND-IF
R7094A     IF W-BLOQUES = 0RMB0009R7094A     IF W-BLOQUES = 0RMB0009
R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009
R7094A     END-IFRMB0009R7094A     END-IFRMB0009

PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407
PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407
PJV011".vre"DELIMITED BY SIZECQ11407PJV011".vre"DELIMITED BY SIZECQ11407
PJV011INTO W-VAL-NOMBRE-REPCQ11407PJV011INTO W-VAL-NOMBRE-REPCQ11407
PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407MOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTW-SORT-NOM-SALW-SORT-NOM-SALW-LINEAS-NOM-ENTW-LINEAS-NOM-ENT
*    DISPLAY "============================================"*    DISPLAY "============================================"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"CALL "SYSTEM" USING W-COMANDO-LINEASCALL "SYSTEM" USING W-COMANDO-LINEAS
*    DISPLAY " "*    DISPLAY " "DISPLAY "ARCHIVO: " W-LINEAS-NOM-ENTDISPLAY "ARCHIVO: " W-LINEAS-NOM-ENT
*    DISPLAY " "*    DISPLAY " "CALL "SYSTEM" USING W-COMANDO-SORTCALL "SYSTEM" USING W-COMANDO-SORTIF RETURN-CODE <> 0IF RETURN-CODE <> 0DISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBREDISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBRESTOP RUNSTOP RUNEND-IFEND-IFOPEN INPUT  ENTRADAOPEN INPUT  ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIALEBDIIALEMUNICIPIOSMUNICIPIOSCLAVECLAVEABD14ABD14
XXXXXX*    OPEN I-O    SECUENCIALXXXXXX*    OPEN I-O    SECUENCIAL
XXXXXX     OPEN INPUT  SECUENCIALXXXXXX     OPEN INPUT  SECUENCIALOPEN OUTPUT VALIDASOPEN OUTPUT VALIDASINCONSINCONS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407MOVE 29999999 TO LLAVE-SECMOVE 29999999 TO LLAVE-SECSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-STARTEND-STARTIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEREAD SECUENCIAL PREVIOUS AT ENDREAD SECUENCIAL PREVIOUS AT ENDDISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "DISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "LLAVE-SECLLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-READEND-READIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEMOVE LLAVE-SEC TO LLAVE7MOVE LLAVE-SEC TO LLAVE7IF LLAVE7-1D NOT = 2IF LLAVE7-1D NOT = 2MOVE 2     TO LLAVE7-1DMOVE 2     TO LLAVE7-1DMOVE ZEROS TO LLAVE7-FILLERMOVE ZEROS TO LLAVE7-FILLEREND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.**************************************************************************************************************************************
*400-VALIDAR*400-VALIDARDISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7
PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407
*DISPLAY "*-----------------------------------*"|  PJV012DISPLAY "*-----------------------------------*"CQ12657
*DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSV|  PJV012DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSVCQ12657
*DISPLAY "*------------------------------------*"|  PJV012DISPLAY "*------------------------------------*"CQ12657END-IFEND-IFPERFORM 900-CERRAR-ARCHIVOSPERFORM 900-CERRAR-ARCHIVOS
CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010
CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010
CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010STOP RUN.STOP RUN.************************************************************************************************************************************
*150-ABRIR-ARCHIVOS.*150-ABRIR-ARCHIVOS.
*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU
*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU
*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN
*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE
*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO
************************************************************************************************************************************
150-ABRIR-ARCHIVOS.150-ABRIR-ARCHIVOS.OPEN INPUT BDIIREGI.OPEN INPUT BDIIREGI.
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"
*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"
MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011ACCEPT W-PARAMETROS   FROM COMMAND-LINEACCEPT W-PARAMETROS   FROM COMMAND-LINEUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOW-ENT-NOMBRE,W-ENT-NOMBRE,W-VAL-NOMBRE,W-VAL-NOMBRE,W-INVAL-NOMBRE,W-INVAL-NOMBRE,W-TARIFA,W-TARIFA,W-BLOQUES,W-BLOQUES,W-DERECHOSW-DERECHOSEND-UNSTRINGEND-UNSTRINGIF W-TARIFA= ZEROS  ORIF W-TARIFA= ZEROS  ORW-ENT-NOMBRE   = SPACES ORW-ENT-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-INVAL-NOMBRE = SPACES ORW-INVAL-NOMBRE = SPACES OR
R7094A*(W-BLOQUES < 0 OR > 4)RMB0009R7094A*(W-BLOQUES < 0 OR > 4)RMB0009
R7094AW-BLOQUES > 4RMB0009R7094AW-BLOQUES > 4RMB0009DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "STOP RUNSTOP RUNEND-IFEND-IF
R7094A     IF W-BLOQUES = 0RMB0009R7094A     IF W-BLOQUES = 0RMB0009
R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009
R7094A     END-IFRMB0009R7094A     END-IFRMB0009

PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407
PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407
PJV011".vre"DELIMITED BY SIZECQ11407PJV011".vre"DELIMITED BY SIZECQ11407
PJV011INTO W-VAL-NOMBRE-REPCQ11407PJV011INTO W-VAL-NOMBRE-REPCQ11407
PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407
PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407MOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTW-SORT-NOM-SALW-SORT-NOM-SALW-LINEAS-NOM-ENTW-LINEAS-NOM-ENT
*    DISPLAY "============================================"*    DISPLAY "============================================"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"CALL "SYSTEM" USING W-COMANDO-LINEASCALL "SYSTEM" USING W-COMANDO-LINEAS
*    DISPLAY " "*    DISPLAY " "DISPLAY "ARCHIVO: " W-LINEAS-NOM-ENTDISPLAY "ARCHIVO: " W-LINEAS-NOM-ENT
*    DISPLAY " "*    DISPLAY " "CALL "SYSTEM" USING W-COMANDO-SORTCALL "SYSTEM" USING W-COMANDO-SORTIF RETURN-CODE <> 0IF RETURN-CODE <> 0DISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBREDISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBRESTOP RUNSTOP RUNEND-IFEND-IFOPEN INPUT  ENTRADAOPEN INPUT  ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIALEBDIIALEMUNICIPIOSMUNICIPIOSCLAVECLAVEABD14ABD14
XXXXXX*    OPEN I-O    SECUENCIALXXXXXX*    OPEN I-O    SECUENCIAL
XXXXXX     OPEN INPUT  SECUENCIALXXXXXX     OPEN INPUT  SECUENCIALOPEN OUTPUT VALIDASOPEN OUTPUT VALIDASINCONSINCONS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407MOVE 29999999 TO LLAVE-SECMOVE 29999999 TO LLAVE-SECSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-STARTEND-STARTIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEREAD SECUENCIAL PREVIOUS AT ENDREAD SECUENCIAL PREVIOUS AT ENDDISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "DISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "LLAVE-SECLLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-READEND-READIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEMOVE LLAVE-SEC TO LLAVE7MOVE LLAVE-SEC TO LLAVE7IF LLAVE7-1D NOT = 2IF LLAVE7-1D NOT = 2MOVE 2     TO LLAVE7-1DMOVE 2     TO LLAVE7-1DMOVE ZEROS TO LLAVE7-FILLERMOVE ZEROS TO LLAVE7-FILLEREND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.**************************************************************************************************************************************
*400-VALIDAR*400-VALIDAR***************************************************************************************************************************************400-VALIDAR*400-VALIDAR
* DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-* DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-
* TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,* TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,
* NIT O DAS)* NIT O DAS)
* ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION* ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION
* LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA* LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA
**************************************************************************************************************************************
400-VALIDAR.400-VALIDAR.ADD  1 TO REG-LEIDOS.ADD  1 TO REG-LEIDOS.MOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INCMOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INCINITIALIZE REG-INCONS REG-VALIDASINITIALIZE REG-INCONS REG-VALIDASMOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9FILLER6 FILLER7 FILLER8 FILLER9MOVE FILLER-2-E TO FILLER-2-VALMOVE FILLER-2-E TO FILLER-2-VALMOVE FILLER-2-E TO FILLER-2-INCMOVE FILLER-2-E TO FILLER-2-INCIF TIPOID-E < 1 OR > 4IF TIPOID-E < 1 OR > 4MOVE 05 TO CODIGO-ERROR CODERR-INCMOVE 05 TO CODIGO-ERROR CODERR-INCMOVE 1  TO SW-ERRORMOVE 1  TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD  1  TO TIPO-ID-INVALIDOADD  1  TO TIPO-ID-INVALIDOELSEELSEMOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDENUM-ID-WNUM-ID-WMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDEMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDE
R7094A*MOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     |  PJV012MOVE    1TO  SW-VERIFNOM-BDIIVIDECQ12657
R7094A*SW-DIGCHEQUEO-BDIIVIDERMB0009     |  PJV012SW-DIGCHEQUEO-BDIIVIDECQ12657
R7094AIF W-BLOQUES > 0RMB0009     <
R7094AMOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     <
R7094AEND-IFRMB0009     <
R7094DIF TIPOID-E = 2 OR 3RMB0009     <
R7094DMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDERMB0009     <
R7094DEND-IFRMB0009     <MOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEMOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEPERFORM 80100-VALIDAR-IDENTIFICACIONPERFORM 80100-VALIDAR-IDENTIFICACIONMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EINITIALIZE REG-VALIDAS REG-INCONSINITIALIZE REG-VALIDAS REG-INCONS
REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007     <
REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007     <MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9FILLER6 FILLER7 FILLER8 FILLER9
>  REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007
>  REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007IF SW-ID-BDIIVIDE = 1IF SW-ID-BDIIVIDE = 1IF TIPOID-E <> 1IF TIPOID-E <> 1
CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006
CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003
CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003
CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003
CSVCEXMOVE  1TO SW-ERRORGJC0003CSVCEXMOVE  1TO SW-ERRORGJC0003
CSVCEXPERFORM 512-CREE-REGISTROGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003
CSVCEXWRITE REG-INCONSGJC0003CSVCEXWRITE REG-INCONSGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003
CSVCEXWRITE REG-INCONSGJC0003CSVCEXWRITE REG-INCONSGJC0003
CSVCEXADD   1TO  NO-EXISTE-DIANGJC0003CSVCEXADD   1TO  NO-EXISTE-DIANGJC0003
CSVCEXEND-IFGJC0003CSVCEXEND-IFGJC0003ELSEELSEMOVE  ZEROS TO  HACER-MATCHMOVE  ZEROS TO  HACER-MATCH
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006PERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0MOVE 04 TO CODIGO-ERROR CODERR-INCMOVE 04 TO CODIGO-ERROR CODERR-INCMOVE TIPOID-E TO TIP-INCMOVE TIPOID-E TO TIP-INCADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISMOVE 1  TO SW-ERRORMOVE 1  TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSEND-IFEND-IFEND-IFEND-IFELSEELSEIF SW-NOMBRES-BDIIVIDE = 1IF SW-NOMBRES-BDIIVIDE = 1IF TIPOID-E <> 1IF TIPOID-E <> 1MOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE  1 TO SW-ERRORMOVE  1 TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS TO MUN-EXP-INCMOVE NACIO-BDIIDAS TO MUN-EXP-INCEND-IFEND-IFELSEELSEPERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIOMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADESMOVE FECHA-2000 TO FEC-EXP-VALMOVE FECHA-2000 TO FEC-EXP-VALFEC-EXP-INCFEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00"TO VIG-VAL VIG-INCMOVE "00"TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VALMOVE ESTADO-VIG-BDIIREGI TO VIG-VALVIG-INCVIG-INCEND-IFEND-IFMOVE   02 TO CODIGO-ERROR CODERR-INCMOVE   02 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISEND-IFEND-IFELSEELSE
R7094C*IF W-BLOQUES > 1 OR TIPOID-E <> 1RMB0009R7094C*IF W-BLOQUES > 1 OR TIPOID-E <> 1RMB0009
R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009
R7094C*ELSERMB0009R7094C*ELSERMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009
R7094C*ELSERMB0009R7094C*ELSERMB0009
R7094C*MOVE PRIMER-APELLIDO-BDIIVIDE TO NOM-VALRMB0009R7094C*MOVE PRIMER-APELLIDO-BDIIVIDE TO NOM-VALRMB0009
R7094C*END-IFRMB0009R7094C*END-IFRMB0009
R7094CMOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094CMOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009INITIALIZE LLAVE-BDIIALEINITIALIZE LLAVE-BDIIALEMOVE  TIPOID-E TO TIP-IDE-BDIIALEMOVE  TIPOID-E TO TIP-IDE-BDIIALEMOVE  NUMID-E  TO NUM-IDE-BDIIALEMOVE  NUMID-E  TO NUM-IDE-BDIIALEMOVE  990003   TO FUENTE-BDIIALEMOVE  990003   TO FUENTE-BDIIALESTART BDIIALE KEY NOT < LLAVE-BDIIALESTART BDIIALE KEY NOT < LLAVE-BDIIALEINVALID KEY MOVE 1 TO SW-BDIIALEINVALID KEY MOVE 1 TO SW-BDIIALENOT INVALID KEY MOVE 0 TO SW-BDIIALENOT INVALID KEY MOVE 0 TO SW-BDIIALEREAD BDIIALE NEXT RECORDREAD BDIIALE NEXT RECORDAT END MOVE 1 TO SW-BDIIALEAT END MOVE 1 TO SW-BDIIALEEND-READEND-READEND-STARTEND-STARTPERFORM UNTIL SW-BDIIALE = 1 ORPERFORM UNTIL SW-BDIIALE = 1 ORTIPOID-E <> TIP-IDE-BDIIALE ORTIPOID-E <> TIP-IDE-BDIIALE ORNUMID-E <> NUM-IDE-BDIIALENUMID-E <> NUM-IDE-BDIIALEIF FUENTE-BDIIALE = 990003 ANDIF FUENTE-BDIIALE = 990003 ANDFEC-NOV-BDIIALE <= FECHA-PROC-R ANDFEC-NOV-BDIIALE <= FECHA-PROC-R ANDFEC-VEN-BDIIALE >= FECHA-PROC-R ANDFEC-VEN-BDIIALE >= FECHA-PROC-R ANDBLOQUEO-BDIIALE = 0BLOQUEO-BDIIALE = 0MOVE 1 TO SW-BDIIALEMOVE 1 TO SW-BDIIALEEND-IFEND-IFIF SW-BDIIALE = 0IF SW-BDIIALE = 0READ BDIIALE NEXT RECORDREAD BDIIALE NEXT RECORDAT END MOVE 1 TO SW-BDIIALEAT END MOVE 1 TO SW-BDIIALEEND-READEND-READEND-IFEND-IFEND-PERFORMEND-PERFORMIF TIPOID-E = 1IF TIPOID-E = 1IF ESTADO-VIG-BDIIREGI = 12 ANDIF ESTADO-VIG-BDIIREGI = 12 ANDW-DERECHOS = 1W-DERECHOS = 1MOVE  07   TO  CODIGO-ERROR CODERR-INCMOVE  07   TO  CODIGO-ERROR CODERR-INCMOVE   1   TO  SW-ERRORMOVE   1   TO  SW-ERRORMOVE "00"  TO  VIG-INCMOVE "00"  TO  VIG-INCPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSELSEELSEIF ESTADO-VIG-BDIIREGI = 21IF ESTADO-VIG-BDIIREGI = 21MOVE  06  TO CODIGO-ERROR CODERR-INCMOVE  06  TO CODIGO-ERROR CODERR-INCMOVE   1  TO SW-ERRORMOVE   1  TO SW-ERRORMOVE "21" TO VIG-INCMOVE "21" TO VIG-INCPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD   1   TO NO-COINCIDE-REGISADD   1   TO NO-COINCIDE-REGIS
R7094BADD   1   TO CONT-FALLECIDOSRMB0009R7094BADD   1   TO CONT-FALLECIDOSRMB0009ELSEELSEPERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIOMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE FECHA-2000 TO FEC-EXP-VALMOVE FECHA-2000 TO FEC-EXP-VALFEC-EXP-INCFEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00" TO VIG-VAL VIG-INCMOVE "00" TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VALMOVE ESTADO-VIG-BDIIREGI TO VIG-VALVIG-INCVIG-INCEND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADES
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE   "O"TO ORIGEN-VAL|  PJV012MOVE   "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFELSEELSEIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE ZEROSTO VIG-VALMOVE ZEROSTO VIG-VALEND-IFEND-IFMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE NUMID-ETO CED-VAL CED-INCMOVE NUMID-ETO CED-VAL CED-INC
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE    "O"TO ORIGEN-VAL|  PJV012MOVE    "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFIF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD  1 TO W-CONT-TIPO-6ADD  1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1  TO W-CONT-TIPO-7ADD 1  TO W-CONT-TIPO-7ELSEELSE
PJV011IF SN-VALREP = "S"CQ11407PJV011IF SN-VALREP = "S"CQ11407
PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407
PJV011ELSECQ11407PJV011ELSECQ11407ADD 1  TO W-CONT-TIPO-5ADD 1  TO W-CONT-TIPO-5
PJV011END-IFCQ11407PJV011END-IFCQ11407
CQ6271IF TIPOID-E = 2 OR 3PJV0010CQ6271IF TIPOID-E = 2 OR 3PJV0010
CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010
CQ6271END-IFPJV0010CQ6271END-IFPJV0010END-IFEND-IFEND-IFEND-IFREAD ENTRADAREAD ENTRADAAT ENDAT ENDMOVE 1 TO FIN-ENTRADAMOVE 1 TO FIN-ENTRADANOT AT ENDNOT AT ENDINSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READ.END-READ.

PJV011 300-GRABA-VALREP.CQ11407PJV011 300-GRABA-VALREP.CQ11407
PJV011     INITIALIZE REG-VALIDAS-REPCQ11407PJV011     INITIALIZE REG-VALIDAS-REPCQ11407
PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDASCQ11407PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDASCQ11407
PJV011     MOVE TIP-VAL TO TIP-KEYVALCQ11407PJV011     MOVE TIP-VAL TO TIP-KEYVALCQ11407
PJV011     MOVE CED-VAL TO NUM-KEYVALCQ11407PJV011     MOVE CED-VAL TO NUM-KEYVALCQ11407
PJV011     ADD 1 TO REG-CORRECTOS-R  .CQ11407PJV011     ADD 1 TO REG-CORRECTOS-R  .CQ11407

PJV011 301-GRABA-LOS-VALIDOS.CQ11407PJV011 301-GRABA-LOS-VALIDOS.CQ11407
PJV011     MOVE "N" TO SN-VALREPCQ11407PJV011     MOVE "N" TO SN-VALREPCQ11407
PJV011     IF TIP-KEYVAL = TIPOID-E ANDCQ11407PJV011     IF TIP-KEYVAL = TIPOID-E ANDCQ11407
PJV011NUM-KEYVAL = NUMID-ECQ11407PJV011NUM-KEYVAL = NUMID-ECQ11407
PJV011MOVE "S" TO SN-VALREPCQ11407PJV011MOVE "S" TO SN-VALREPCQ11407
PJV011PERFORM 300-GRABA-VALREPCQ11407PJV011PERFORM 300-GRABA-VALREPCQ11407
PJV011     ELSECQ11407PJV011     ELSECQ11407
PJV011WRITE REG-VALIDASCQ11407PJV011WRITE REG-VALIDASCQ11407
PJV011MOVE TIP-VAL TO TIP-KEYVALCQ11407PJV011MOVE TIP-VAL TO TIP-KEYVALCQ11407
PJV011MOVE CED-VAL TO NUM-KEYVALCQ11407PJV011MOVE CED-VAL TO NUM-KEYVALCQ11407
PJV011ADD 1 TO REG-CORRECTOSCQ11407PJV011ADD 1 TO REG-CORRECTOSCQ11407
PJV011     END-IF.CQ11407PJV011     END-IF.CQ11407505-RANGO-EDADES.505-RANGO-EDADES.
*--------------------------------------------------**--------------------------------------------------*
*505-RANGO-EDADES.*505-RANGO-EDADES.
*  RANGO MUJERES: 20'000.001 A 70'000.000*  RANGO MUJERES: 20'000.001 A 70'000.000
*  RANGO HOMBRES:1 A 20'000.000*  RANGO HOMBRES:1 A 20'000.000
*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)
*--------------------------------------------------**--------------------------------------------------*MOVE FEC-EXP-VALTO  W-FEC-EXPEMOVE FEC-EXP-VALTO  W-FEC-EXPEMOVE ZEROSTO  W-EDAD-CEDULAMOVE ZEROSTO  W-EDAD-CEDULAIF W-ANO-EXPE >= 1975IF W-ANO-EXPE >= 1975COMPUTE W-EDAD-CEDULA =COMPUTE W-EDAD-CEDULA =((W-ANO-ACTUAL - W-ANO-EXPE) + 18)((W-ANO-ACTUAL - W-ANO-EXPE) + 18)ELSEELSECOMPUTE W-EDAD-CEDULA =COMPUTE W-EDAD-CEDULA =((W-ANO-ACTUAL - W-ANO-EXPE) + 21)((W-ANO-ACTUAL - W-ANO-EXPE) + 21)END-IFEND-IFMOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDADMOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDADMOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.MOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.EVALUATE WS-EDADEVALUATE WS-EDADWHEN 18 THRU 21WHEN 18 THRU 21MOVE "18-21" TO EDAD-RANGOMOVE "18-21" TO EDAD-RANGOWHEN 22 THRU 28WHEN 22 THRU 28MOVE "22-28" TO EDAD-RANGOMOVE "22-28" TO EDAD-RANGOWHEN 29 THRU 35WHEN 29 THRU 35MOVE "29-35" TO EDAD-RANGOMOVE "29-35" TO EDAD-RANGOWHEN 36 THRU 45WHEN 36 THRU 45MOVE "36-45" TO EDAD-RANGOMOVE "36-45" TO EDAD-RANGOWHEN 46 THRU 55WHEN 46 THRU 55MOVE "46-55" TO EDAD-RANGOMOVE "46-55" TO EDAD-RANGOWHEN 56 THRU 65WHEN 56 THRU 65MOVE "56-65" TO EDAD-RANGOMOVE "56-65" TO EDAD-RANGOWHEN 56 THRU 65WHEN 56 THRU 65MOVE "56-65" TO EDAD-RANGOMOVE "56-65" TO EDAD-RANGOWHEN 66 THRU 999WHEN 66 THRU 999MOVE "66+  " TO EDAD-RANGOMOVE "66+  " TO EDAD-RANGOWHEN ANYWHEN ANYMOVE " N/A " TO EDAD-RANGOMOVE " N/A " TO EDAD-RANGOEND-EVALUATE.END-EVALUATE.
********************************************************************************************************************************
*510-ESCRIBIR-INCONS.*510-ESCRIBIR-INCONS.
* BUSCA ERROR* BUSCA ERROR
* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS
********************************************************************************************************************************
510-ESCRIBIR-INCONS.510-ESCRIBIR-INCONS.IF CODIGO-ERROR = 02 AND SW-ERROR = 1IF CODIGO-ERROR = 02 AND SW-ERROR = 1MOVE TIPOID-E TO TIP-INC.MOVE TIPOID-E TO TIP-INC.IF SW-ERROR = 1IF SW-ERROR = 1PERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONS.WRITE REG-INCONS.****************************************************************************************************************************
*512-CREE-REGISTRO.*512-CREE-REGISTRO.
* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC
****************************************************************************************************************************
512-CREE-REGISTRO.512-CREE-REGISTRO.MOVE TIPOID-E TO TIP-INCMOVE TIPOID-E TO TIP-INCMOVE NUMID-E  TO CED-INCFAC0019MOVE NUMID-E  TO CED-INCFAC0019MOVE NOMBRE-E TO NOM1-INCMOVE NOMBRE-E TO NOM1-INCIF CODIGO-ERROR = 02 OR 01 OR 06 OR 07IF CODIGO-ERROR = 02 OR 01 OR 06 OR 07MOVE NOM-VAL-BDIIVIDE TO NOM2-INCMOVE NOM-VAL-BDIIVIDE TO NOM2-INCELSEELSEMOVE SPACESTO NOM2-INCMOVE SPACESTO NOM2-INCMUN-EXP-INCMUN-EXP-INCDEP-EXP-INCDEP-EXP-INCVIG-INCVIG-INCMOVE ZEROSTO FEC-EXP-INCMOVE ZEROSTO FEC-EXP-INCMOVE FILLER-2-E  TO FILLER-2-INCMOVE FILLER-2-E  TO FILLER-2-INCEND-IF.END-IF.****************************************************************************************************************************
*513-VALIDA-EN-CSV.*513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA*    ALTERNA
****************************************************************************************************************************
513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacionREQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEREQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDEREQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-IDREQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROSIF OPEN-DIR = ZEROSOPEN INPUT MAESTRO-DIRECCOPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLIOPEN INPUT BDLCLIOPEN INPUT SUSCRIPTOROPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIRMOVE 1 TO OPEN-DIREND-IFEND-IFMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSMOVE 1 TO HACERMATCH-LEEMSTRS
REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008
REQ609IF TIPOID-E = 1 OR 4LAG0008REQ609IF TIPOID-E = 1 OR 4LAG0008
REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008
REQ609"," BY " ", ";" BY " "LAG0008REQ609"," BY " ", ";" BY " "LAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008
REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008
REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008
REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008
REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008
REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008
REQ609ELSELAG0008REQ609ELSELAG0008
R7094AIF W-BLOQUES > 0RMB0009R7094AIF W-BLOQUES > 0RMB0009
R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009
R7094AEND-IFRMB0009R7094AEND-IFRMB0009
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E  TO CED-VALMOVE NUMID-E  TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS    TO FEC-EXP-VALMOVE ZEROS    TO FEC-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGOMOVE SPACES   TO EDAD-RANGO
PAM460*MOVE "A"TO ORIGEN-VAL|  PJV012MOVE "A"TO ORIGEN-VALCQ12657
PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407
PJV011ADD 1 TO SI-EXISTE-CSVCQ11407PJV011ADD 1 TO SI-EXISTE-CSVCQ11407END-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
*9800-FILTRAR-ALFABETICO.**9800-FILTRAR-ALFABETICO.*
*    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA**    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
***************************************************************************************************************************************800-GRABAR-SECUENCIAL.*800-GRABAR-SECUENCIAL.
* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL
* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-
* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN
* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION
**************************************************************************************************************************************
800-GRABAR-SECUENCIAL.800-GRABAR-SECUENCIAL.INITIALIZE REG-SECINITIALIZE REG-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE ZEROSTO TIP-ID-SECMOVE ZEROSTO TIP-ID-SECMOVE W-TARIFATO NUM-TERM-SECMOVE W-TARIFATO NUM-TERM-SECMOVE 2TO COBRA-SECMOVE 2TO COBRA-SECMOVE 1TO PRIV-SECMOVE 1TO PRIV-SECMOVE " "TO SBPRIV-SECMOVE " "TO SBPRIV-SECMOVE 2TO PRODU-SECMOVE 2TO PRODU-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZEROSTO TABLA-SCOR-SECMOVE ZEROSTO TABLA-SCOR-SECACCEPT TIEMPO-WFROM TIMEACCEPT TIEMPO-WFROM TIMEMOVE TIEMPO-W(1:6)     TO HORA-SECMOVE TIEMPO-W(1:6)     TO HORA-SECIF W-CONT-TIPO-5>  ZEROSIF W-CONT-TIPO-5>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE 5  TO TIP-CON-SECMOVE 5  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IFEND-IFIF W-CONT-TIPO-6>  ZEROSIF W-CONT-TIPO-6>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-6  TO NUM-ID-SECMOVE W-CONT-TIPO-6  TO NUM-ID-SECMOVE 6  TO TIP-CON-SECMOVE 6  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IFEND-IFIF W-CONT-TIPO-7>  ZEROSIF W-CONT-TIPO-7>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE 7  TO TIP-CON-SECMOVE 7  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IF.END-IF.
**********************************************************************************************************************************
*810-BUSCAR-MUNICIPIO.*810-BUSCAR-MUNICIPIO.
* OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-* OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-
* NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS* NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS
**********************************************************************************************************************************
810-BUSCAR-MUNICIPIO.810-BUSCAR-MUNICIPIO.MOVE DEP-EXP-BDIIREGI TO CODIGO-DEPMOVE DEP-EXP-BDIIREGI TO CODIGO-DEPMOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNIMOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNIREAD MUNICIPIOS INVALID KEYREAD MUNICIPIOS INVALID KEYMOVE SPACES TO NOMBRE-MUNIMOVE SPACES TO NOMBRE-MUNIMOVE 71     TO CODIGO-DEPMOVE 71     TO CODIGO-DEPEND-READEND-READMOVE NOMBRE-MUNITO MUN-EXP-VAL MUN-EXP-INCMOVE NOMBRE-MUNITO MUN-EXP-VAL MUN-EXP-INCMOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.MOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.
**************************************************************************************************************************************
*900-CERRAR-ARCHIVOS.*900-CERRAR-ARCHIVOS.
* CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN* CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN
* ESTAN ABIERTOS* ESTAN ABIERTOS
**********************************************************************************************************************************
900-CERRAR-ARCHIVOS.900-CERRAR-ARCHIVOS.DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS
PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
R7094B     DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSRMB0009R7094B     DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSRMB0009DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDODISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOCLOSE ENTRADACLOSE ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIREGIBDIIREGIMUNICIPIOSMUNICIPIOSSECUENCIALSECUENCIALVALIDASVALIDAS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407INCONS.INCONS.
**********************************************************************************************************************************COPY BDIIVIDE.PROC.COPY BDIIVIDE.PROC.COPY LEEMAESTROS.PROC.COPY LEEMAESTROS.PROC.COPY BDLDIR.PROC.COPY BDLDIR.PROC.
CQ6271     COPY LOGPESVNO.PROC.PJV0010CQ6271     COPY LOGPESVNO.PROC.PJV0010
~
~
~
~COPY BDLDIR.PROC.COPY BDLDIR.PROC.
CQ6271     COPY LOGPESVNO.PROC.PJV0010CQ6271     COPY LOGPESVNO.PROC.PJV0010
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~* PESVNOCSV.V.01.0011|* PESVNOCSVPLUS.V.01.0013IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.DATE-COMPILED.
************************************************************************************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE** PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.* EXTRANJERIA.
**
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
**
* Cliente : Datacredito* Cliente : Datacredito
**
* Version : 09/06/2008 09:08:25 a.m.* Version : 09/06/2008 09:08:25 a.m.
************************************************************************************************************************************
*  Validacion especial tomando el archivo de*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final*  Cuentas Sin Validar para poder reportalos en el informe final
**
************************************************************************************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIASREMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNOREMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*REMARK* SEPT. 30/2009*
REMARK*******************************************************************REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**REMARK* GRACIELA JIM.**
REMARK******************************************************************REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **REMARK* G.DESARROLLO **
REMARK******************************************************************REMARK******************************************************************
************************************************************************************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A ** GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.** FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   ** EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS** MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     ** LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1** OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     ** LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA** OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   ** RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
* AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS** AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS*
* GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO ** GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *
*| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     **| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
************************************************************************************************************************************
* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.*
* SEP-01-2012|** SEP-01-2012|** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** SEP-01-2012|** SEP-01-2012|*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES*
* ABR-02-2013| REPETIDAS VALIDAS.** ABR-02-2013| REPETIDAS VALIDAS.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
>* PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES*
>* JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
>* PEDRO V.   |*
>******************************************************************
>* STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
>* JUL-31-2013|*
>* LUIS GOMEZ |*
>******************************************************************
**
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
CONFIGURATION SECTION.CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.INPUT-OUTPUT SECTION.COPY BDIIDIAN.FS.COPY BDIIDIAN.FS.COPY BDIIREGI.FS.COPY BDIIREGI.FS.COPY BDIIDAS.FS.COPY BDIIDAS.FS.COPY ICBTCO.FS.COPY ICBTCO.FS.COPY ICBCLA0001.FS.COPY ICBCLA0001.FS.COPY ICBCIU.FS.COPY ICBCIU.FS.
CTAST8*    COPY  ICBCHK.FS.GDT0005CTAST8*    COPY  ICBCHK.FS.GDT0005
CTAST8     COPY  ICBCHK0001.FS.GDT0005CTAST8     COPY  ICBCHK0001.FS.GDT0005COPY ICBCRE.FS.COPY ICBCRE.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY BDLCLI.FS.COPY BDLCLI.FS.COPY ICBDIR.FS.COPY ICBDIR.FS.COPY ICMUNI.FS.COPY ICMUNI.FS.COPY BDIIALE.FS.COPY BDIIALE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.COPY DIREST.FS.COPY DIREST.FS.COPY NOAMNISTIA21.FS.COPY NOAMNISTIA21.FS.COPY BDACSV.FS.COPY BDACSV.FS.SELECT ENTRADA  ASSIGN TO DISK W-ENTRADASELECT ENTRADA  ASSIGN TO DISK W-ENTRADAORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.SELECT VALIDAS  ASSIGN TO DISK W-VALIDASSELECT VALIDAS  ASSIGN TO DISK W-VALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.

PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407
PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407
PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407SELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALSELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.DATA DIVISION.DATA DIVISION.
FILE SECTION.FILE SECTION.
COPY ICBCHK.FD.COPY ICBCHK.FD.
COPY ICBSUS.FD.COPY ICBSUS.FD.
COPY BDACSV.FD.COPY BDACSV.FD.
COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.
COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.
COPY DIREST.FD.COPY DIREST.FD.
COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.
COPY NOAMNISTIA21.FD.COPY NOAMNISTIA21.FD.
COPY BDIIDIAN.FD.COPY BDIIDIAN.FD.
COPY BDIIREGI.FD.COPY BDIIREGI.FD.
COPY BDIIDAS.FD.COPY BDIIDAS.FD.
COPY ICBTCO001.FD.COPY ICBTCO001.FD.
COPY ICBCLA.FD.COPY ICBCLA.FD.
COPY ICBCIU.FD.COPY ICBCIU.FD.
COPY ICBCRE.FD.COPY ICBCRE.FD.
COPY BDLCLI.FD.COPY BDLCLI.FD.
COPY ICMUNI.FD.COPY ICMUNI.FD.
COPY BDIIALE.FD.COPY BDIIALE.FD.FD  ENTRADA.FD  ENTRADA.
01  REG-ENTRADA.01  REG-ENTRADA.03 TIPOID-EPIC   9(01).03 TIPOID-EPIC   9(01).03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).03 NUMID-EPIC   9(11).03 NUMID-EPIC   9(11).03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).03 NOMBRE-EPIC   X(45).03 NOMBRE-EPIC   X(45).03 FILLER-2-EPIC   X(60).|  PJV012*    03 FILLER-2-EPIC   X(360).CQ12657
>  STT013     03 FILLER-2-EPIC   X(660).CQ12837FD  VALIDAS.FD  VALIDAS.
01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).
PAM460*    03 ORIGEN-VALPIC X.|  PJV012     03 ORIGEN-VALPIC X.CQ12657
PAM460     03 FILLER-2-VALPIC X(51).|  PJV012*    03 FILLER-2-VALPIC X(350).CQ12657
>  STT013     03 FILLER-2-VALPIC X(650).CQ12837

PJV011 FD  VALIDAS-REP.CQ11407PJV011 FD  VALIDAS-REP.CQ11407
PJV011 01  REG-VALIDAS-REP.CQ11407PJV011 01  REG-VALIDAS-REP.CQ11407
PJV011     03 TIP-VALREPPIC 9.CQ11407PJV011     03 TIP-VALREPPIC 9.CQ11407
PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407
PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407
PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407
PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407
PJV011     03 VIG-VALREPPIC X(02).CQ11407PJV011     03 VIG-VALREPPIC X(02).CQ11407
PJV011     03 GENERO-VALREPPIC X(01).CQ11407PJV011     03 GENERO-VALREPPIC X(01).CQ11407
PJV011     03 EDAD-VALREPPIC X(03).CQ11407PJV011     03 EDAD-VALREPPIC X(03).CQ11407
PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407
PJV011     03 FILLER-2-VALREPPIC X(51).CQ11407     |  PJV012*    03 FILLER-2-VALREPPIC X(651).CQ12837
>  STT013     03 FILLER-2-VALREPPIC X(651).CQ12657FD  INCONS.FD  INCONS.
01  REG-INCONS.01  REG-INCONS.03 TIP-INCPIC 9.03 TIP-INCPIC 9.
PAM372     03 FILLER1PIC X VALUE ";".PAM372     03 FILLER1PIC X VALUE ";".03 CED-INCPIC 9(11).03 CED-INCPIC 9(11).
PAM372     03 FILLER2PIC X VALUE ";".PAM372     03 FILLER2PIC X VALUE ";".03 NOM1-INCPIC X(45).03 NOM1-INCPIC X(45).
PAM372     03 FILLER3PIC X VALUE ";".PAM372     03 FILLER3PIC X VALUE ";".03 NOM2-INCPIC X(45).03 NOM2-INCPIC X(45).
PAM372     03 FILLER4PIC X VALUE ";".PAM372     03 FILLER4PIC X VALUE ";".03 FEC-EXP-INCPIC 9(08).03 FEC-EXP-INCPIC 9(08).
PAM372     03 FILLER5PIC X VALUE ";".PAM372     03 FILLER5PIC X VALUE ";".03 MUN-EXP-INCPIC X(15).03 MUN-EXP-INCPIC X(15).
PAM372     03 FILLER6PIC X VALUE ";".PAM372     03 FILLER6PIC X VALUE ";".03 DEP-EXP-INCPIC X(15).03 DEP-EXP-INCPIC X(15).
PAM372     03 FILLER7PIC X VALUE ";".PAM372     03 FILLER7PIC X VALUE ";".03 VIG-INCPIC X(02).03 VIG-INCPIC X(02).
PAM372     03 FILLER8PIC X VALUE ";".PAM372     03 FILLER8PIC X VALUE ";".03 CODERR-INCPIC 9(02).03 CODERR-INCPIC 9(02).
PAM372     03 FILLER9PIC X VALUE ";".PAM372     03 FILLER9PIC X VALUE ";".03 FILLER-2-INCPIC X(60).03 FILLER-2-INCPIC X(60).********************************************************************************************************
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
******************************************************************************************************
CQ6271 COPY LOGPESVNO.WS.PJV0010CQ6271 COPY LOGPESVNO.WS.PJV0010
01 W-COMANDO-LINEAS.01 W-COMANDO-LINEAS.03 FILLERPIC X(06) VALUE "wc -l ".03 FILLERPIC X(06) VALUE "wc -l ".03 ENTRADA-LINEAS.03 ENTRADA-LINEAS.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 FILLERPIC X(30)05 FILLERPIC X(30)VALUE " | awk '{ print ($1) }'".VALUE " | awk '{ print ($1) }'".03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
01 W-COMANDO-SORT.01 W-COMANDO-SORT.03 FILLERPIC X(13) VALUE "sort -u ".03 FILLERPIC X(13) VALUE "sort -u ".03 ENTRADA-SORT.03 ENTRADA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.03 FILLERPIC X(13) VALUE " -o ".03 FILLERPIC X(13) VALUE " -o ".03 SALIDA-SORT.03 SALIDA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.SELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.DATA DIVISION.DATA DIVISION.
FILE SECTION.FILE SECTION.
COPY ICBCHK.FD.COPY ICBCHK.FD.
COPY ICBSUS.FD.COPY ICBSUS.FD.
COPY BDACSV.FD.COPY BDACSV.FD.
COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.
COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.
COPY DIREST.FD.COPY DIREST.FD.
COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.
COPY NOAMNISTIA21.FD.COPY NOAMNISTIA21.FD.
COPY BDIIDIAN.FD.COPY BDIIDIAN.FD.
COPY BDIIREGI.FD.COPY BDIIREGI.FD.
COPY BDIIDAS.FD.COPY BDIIDAS.FD.
COPY ICBTCO001.FD.COPY ICBTCO001.FD.
COPY ICBCLA.FD.COPY ICBCLA.FD.
COPY ICBCIU.FD.COPY ICBCIU.FD.
COPY ICBCRE.FD.COPY ICBCRE.FD.
COPY BDLCLI.FD.COPY BDLCLI.FD.
COPY ICMUNI.FD.COPY ICMUNI.FD.
COPY BDIIALE.FD.COPY BDIIALE.FD.FD  ENTRADA.FD  ENTRADA.
01  REG-ENTRADA.01  REG-ENTRADA.03 TIPOID-EPIC   9(01).03 TIPOID-EPIC   9(01).03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).03 TIPOID-X-E REDEFINES TIPOID-E PIC   X(01).03 NUMID-EPIC   9(11).03 NUMID-EPIC   9(11).03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).03 NUMID-X-E REDEFINES NUMID-E   PIC   X(11).03 NOMBRE-EPIC   X(45).03 NOMBRE-EPIC   X(45).03 FILLER-2-EPIC   X(60).|  PJV012*    03 FILLER-2-EPIC   X(360).CQ12657
>  STT013     03 FILLER-2-EPIC   X(660).CQ12837FD  VALIDAS.FD  VALIDAS.
01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).
PAM460*    03 ORIGEN-VALPIC X.|  PJV012     03 ORIGEN-VALPIC X.CQ12657
PAM460     03 FILLER-2-VALPIC X(51).|  PJV012*    03 FILLER-2-VALPIC X(350).CQ12657
>  STT013     03 FILLER-2-VALPIC X(650).CQ12837

PJV011 FD  VALIDAS-REP.CQ11407PJV011 FD  VALIDAS-REP.CQ11407
PJV011 01  REG-VALIDAS-REP.CQ11407PJV011 01  REG-VALIDAS-REP.CQ11407
PJV011     03 TIP-VALREPPIC 9.CQ11407PJV011     03 TIP-VALREPPIC 9.CQ11407
PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407PJV011     03 CED-VALREPPIC 9(11).CQ11407
PJV011     03 NOM-VALREPPIC X(45).CQ11407PJV011     03 NOM-VALREPPIC X(45).CQ11407
PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407PJV011     03 FEC-EXP-VALREPPIC 9(08).CQ11407
PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407PJV011     03 MUN-EXP-VALREPPIC X(15).CQ11407
PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407PJV011     03 DEP-EXP-VALREPPIC X(15).CQ11407
PJV011     03 VIG-VALREPPIC X(02).CQ11407PJV011     03 VIG-VALREPPIC X(02).CQ11407
PJV011     03 GENERO-VALREPPIC X(01).CQ11407PJV011     03 GENERO-VALREPPIC X(01).CQ11407
PJV011     03 EDAD-VALREPPIC X(03).CQ11407PJV011     03 EDAD-VALREPPIC X(03).CQ11407
PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407PJV011     03 EDAD-RANGO-VALREPPIC X(05).CQ11407
PJV011     03 FILLER-2-VALREPPIC X(51).CQ11407     |  PJV012*    03 FILLER-2-VALREPPIC X(651).CQ12837
>  STT013     03 FILLER-2-VALREPPIC X(651).CQ12657FD  INCONS.FD  INCONS.
01  REG-INCONS.01  REG-INCONS.03 TIP-INCPIC 9.03 TIP-INCPIC 9.
PAM372     03 FILLER1PIC X VALUE ";".PAM372     03 FILLER1PIC X VALUE ";".03 CED-INCPIC 9(11).03 CED-INCPIC 9(11).
PAM372     03 FILLER2PIC X VALUE ";".PAM372     03 FILLER2PIC X VALUE ";".03 NOM1-INCPIC X(45).03 NOM1-INCPIC X(45).
PAM372     03 FILLER3PIC X VALUE ";".PAM372     03 FILLER3PIC X VALUE ";".03 NOM2-INCPIC X(45).03 NOM2-INCPIC X(45).
PAM372     03 FILLER4PIC X VALUE ";".PAM372     03 FILLER4PIC X VALUE ";".03 FEC-EXP-INCPIC 9(08).03 FEC-EXP-INCPIC 9(08).
PAM372     03 FILLER5PIC X VALUE ";".PAM372     03 FILLER5PIC X VALUE ";".03 MUN-EXP-INCPIC X(15).03 MUN-EXP-INCPIC X(15).
PAM372     03 FILLER6PIC X VALUE ";".PAM372     03 FILLER6PIC X VALUE ";".03 DEP-EXP-INCPIC X(15).03 DEP-EXP-INCPIC X(15).
PAM372     03 FILLER7PIC X VALUE ";".PAM372     03 FILLER7PIC X VALUE ";".03 VIG-INCPIC X(02).03 VIG-INCPIC X(02).
PAM372     03 FILLER8PIC X VALUE ";".PAM372     03 FILLER8PIC X VALUE ";".03 CODERR-INCPIC 9(02).03 CODERR-INCPIC 9(02).
PAM372     03 FILLER9PIC X VALUE ";".PAM372     03 FILLER9PIC X VALUE ";".03 FILLER-2-INCPIC X(60).03 FILLER-2-INCPIC X(60).********************************************************************************************************
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
******************************************************************************************************
CQ6271 COPY LOGPESVNO.WS.PJV0010CQ6271 COPY LOGPESVNO.WS.PJV0010
01 W-COMANDO-LINEAS.01 W-COMANDO-LINEAS.03 FILLERPIC X(06) VALUE "wc -l ".03 FILLERPIC X(06) VALUE "wc -l ".03 ENTRADA-LINEAS.03 ENTRADA-LINEAS.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 W-LINEAS-NOM-ENTPIC X(30) VALUE SPACES.05 FILLERPIC X(30)05 FILLERPIC X(30)VALUE " | awk '{ print ($1) }'".VALUE " | awk '{ print ($1) }'".03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
01 W-COMANDO-SORT.01 W-COMANDO-SORT.03 FILLERPIC X(13) VALUE "sort -u ".03 FILLERPIC X(13) VALUE "sort -u ".03 ENTRADA-SORT.03 ENTRADA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.05 W-SORT-NOM-ENTPIC X(30) VALUE SPACES.03 FILLERPIC X(13) VALUE " -o ".03 FILLERPIC X(13) VALUE " -o ".03 SALIDA-SORT.03 SALIDA-SORT.05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 FILLERPIC X(12) VALUE "$TEMPORALES/".05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.05 W-SORT-NOM-SALPIC X(30) VALUE SPACES.03 FILLERPIC X(01) VALUE LOW-VALUE.03 FILLERPIC X(01) VALUE LOW-VALUE.
*--------------------------------------------------------------**--------------------------------------------------------------*
01  W-ENTRADA.01  W-ENTRADA.03 W-ENT-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-ENT-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-ENT-NOMBREPIC X(30) VALUE SPACES.03 W-ENT-NOMBREPIC X(30) VALUE SPACES.
01  W-VALIDAS.01  W-VALIDAS.03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".03 W-VAL-NOMBREPIC X(30) VALUE SPACES.03 W-VAL-NOMBREPIC X(30) VALUE SPACES.
01  W-INVALIDAS.01  W-INVALIDAS.03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".03 W-INVAL-DIRECTORIO    PIC X(12) VALUE "$TEMPORALES/".03 W-INVAL-NOMBREPIC X(30) VALUE SPACES.03 W-INVAL-NOMBREPIC X(30) VALUE SPACES.
PJV011 01  W-VALIDAS-REP.CQ11407PJV011 01  W-VALIDAS-REP.CQ11407
PJV011     03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".     CQ11407PJV011     03 W-VAL-DIRECTORIOPIC X(12) VALUE "$TEMPORALES/".     CQ11407
PJV011     03 W-VAL-NOMBRE-REPPIC X(30) VALUE SPACES.CQ11407PJV011     03 W-VAL-NOMBRE-REPPIC X(30) VALUE SPACES.CQ11407

PJV011 01  W-KEYVAL-GRA.CQ11407PJV011 01  W-KEYVAL-GRA.CQ11407
PJV011     03 TIP-KEYVALPIC 9(01) VALUE ZEROS.CQ11407PJV011     03 TIP-KEYVALPIC 9(01) VALUE ZEROS.CQ11407
PJV011     03 NUM-KEYVALPIC 9(11) VALUE ZEROS.CQ11407PJV011     03 NUM-KEYVALPIC 9(11) VALUE ZEROS.CQ11407
PJV011     03 SN-VALREPPIC X(01) VALUE SPACES.CQ11407PJV011     03 SN-VALREPPIC X(01) VALUE SPACES.CQ1140701  W-PARAMETROSPIC X(94) VALUE SPACES.01  W-PARAMETROSPIC X(94) VALUE SPACES.
01  W-TARIFAPIC 9(04) VALUE ZEROS.01  W-TARIFAPIC 9(04) VALUE ZEROS.
01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  W-BLOQUESPIC 9(01) VALUE ZEROS.
01  SW-BDIIALEPIC 9(01) VALUE ZEROS.01  SW-BDIIALEPIC 9(01) VALUE ZEROS.
01  W-DERECHOSPIC 9     VALUE ZEROS.01  W-DERECHOSPIC 9     VALUE ZEROS.
01  OPEN-DIRPIC 9     VALUE ZEROS.01  OPEN-DIRPIC 9     VALUE ZEROS.
01  FIN-ENTRADAPIC 9     VALUE 0.01  FIN-ENTRADAPIC 9     VALUE 0.
01  FINSPIC 9     VALUE 0.01  FINSPIC 9     VALUE 0.
01  LLAVE7PIC 9(8)  VALUE ZEROS.01  LLAVE7PIC 9(8)  VALUE ZEROS.
01  LLAVE7-R  REDEFINES LLAVE7.01  LLAVE7-R  REDEFINES LLAVE7.03 LLAVE7-1DPIC 9.03 LLAVE7-1DPIC 9.03 LLAVE7-FILLERPIC 9(7).03 LLAVE7-FILLERPIC 9(7).
01  TOPE-INI-LLAVE7PIC 9(8)  VALUE 20000000.01  TOPE-INI-LLAVE7PIC 9(8)  VALUE 20000000.
01  FECHA-PROC.01  FECHA-PROC.03 ANO-HOY.03 ANO-HOY.05 SIG-PROCPIC X(2).05 SIG-PROCPIC X(2).05 ANO-PROCPIC X(2).05 ANO-PROCPIC X(2).03 MES-PROCPIC X(2).03 MES-PROCPIC X(2).03 DIA-PROCPIC X(2).03 DIA-PROCPIC X(2).
01  FECHA-PROC-R  REDEFINES FECHA-PROC01  FECHA-PROC-R  REDEFINES FECHA-PROCPIC X(8).PIC X(8).
01  FECHA-AUX.01  FECHA-AUX.03 DIA-AUXPIC 9(2).03 DIA-AUXPIC 9(2).03 MES-AUXPIC 9(2).03 MES-AUXPIC 9(2).03 ANO-AUXPIC 9(2).03 ANO-AUXPIC 9(2).
01  FECHA-AUX-R  REDEFINES FECHA-AUX01  FECHA-AUX-R  REDEFINES FECHA-AUXPIC 9(6).PIC 9(6).
01  TIEMPO-SIS.01  TIEMPO-SIS.03 HORA-SISPIC 9(02).03 HORA-SISPIC 9(02).03 MIN-SISPIC 9(02).03 MIN-SISPIC 9(02).03 FILLERPIC 9(04).03 FILLERPIC 9(04).
01  TIEMPO-SIS-R  REDEFINES TIEMPO-SIS01  TIEMPO-SIS-R  REDEFINES TIEMPO-SISPIC 9(08).PIC 9(08).
01  TIEMPO-WPIC 9(8).01  TIEMPO-WPIC 9(8).
01  W-CONTADORES.01  W-CONTADORES.01  TIEMPO-WPIC 9(8).01  TIEMPO-WPIC 9(8).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(06) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(06) VALUE ZEROS.
CQ6271     03  W-CONT-TIPO-5-PJPIC 9(06) VALUE ZEROS.PJV0010CQ6271     03  W-CONT-TIPO-5-PJPIC 9(06) VALUE ZEROS.PJV0010
PJV011     03  W-CONT-TIPO-5-REPPIC 9(06) VALUE ZEROS.CQ11407PJV011     03  W-CONT-TIPO-5-REPPIC 9(06) VALUE ZEROS.CQ11407
**
01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
R7094B 01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.RMB0009R7094B 01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.RMB0009
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
PJV011 01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.CQ11407PJV011 01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.CQ11407
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.
01  NIT-BUENOPIC 9.01  NIT-BUENOPIC 9.
01  NUM-ID-WPIC 9(11).01  NUM-ID-WPIC 9(11).
*------------------------------------------------------------------**------------------------------------------------------------------*
COPY  ICFILE.WS.COPY  ICFILE.WS.
COPY  BDIIALE.WS.COPY  BDIIALE.WS.
COPY  DEPTOS.WS.COPY  DEPTOS.WS.
COPY  BDIIVIDE.WS.COPY  BDIIVIDE.WS.
COPY  BDLDIR.WS.COPY  BDLDIR.WS.
COPY  LEEMAESTROS.WS.COPY  LEEMAESTROS.WS.
*------------------------------------------------------------------**------------------------------------------------------------------*
01  CODIGO-ERRORPIC 9(02) VALUE ZERO.01  CODIGO-ERRORPIC 9(02) VALUE ZERO.
01  PRIMER-APELLIDOPIC X(16) VALUE SPACES.01  PRIMER-APELLIDOPIC X(16) VALUE SPACES.
01  SEGUNDO-APELLIDOPIC X(16) VALUE SPACES.01  SEGUNDO-APELLIDOPIC X(16) VALUE SPACES.
01  PRIMER-NOMBREPIC X(16) VALUE SPACES.01  PRIMER-NOMBREPIC X(16) VALUE SPACES.
01  SEGUNDO-NOMBREPIC X(16) VALUE SPACES.01  SEGUNDO-NOMBREPIC X(16) VALUE SPACES.
01  NOMBRE-DANE.01  NOMBRE-DANE.03 PR-APELLIDO-ABD05PIC X(15).03 PR-APELLIDO-ABD05PIC X(15).03 NOMBRES-ABD05PIC X(30).03 NOMBRES-ABD05PIC X(30).
01  NOMBRE-DANE-AUXPIC X(45).01  NOMBRE-DANE-AUXPIC X(45).
01  NOM-VAL-AUX.01  NOM-VAL-AUX.03 PR-APELLIDO-AUXPIC X(15).03 PR-APELLIDO-AUXPIC X(15).03 SG-APELLIDO-AUXPIC X(15).03 SG-APELLIDO-AUXPIC X(15).03 NOMBRE-AUXPIC X(15).03 NOMBRE-AUXPIC X(15).
01  CONTADORES.01  CONTADORES.03 JLPIC 9(02) VALUE ZERO.03 JLPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 SW-ERRORPIC 9     VALUE ZERO.03 SW-ERRORPIC 9     VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 BLOC-IGUALPIC 9(02) VALUE ZERO.03 BLOC-IGUALPIC 9(02) VALUE ZERO.03 BLOQUESPIC 9(02) VALUE ZERO.03 BLOQUESPIC 9(02) VALUE ZERO.03 ENCONTRADOPIC 9     VALUE ZERO.03 ENCONTRADOPIC 9     VALUE ZERO.03 SUPPIC 9(02) VALUE ZERO.03 SUPPIC 9(02) VALUE ZERO.03 INFPIC 9(02) VALUE ZERO.03 INFPIC 9(02) VALUE ZERO.03 JJPIC 9(02) VALUE ZERO.03 JJPIC 9(02) VALUE ZERO.
*------------------------------------------------------------------**------------------------------------------------------------------*
01  W-VARIABLES.01  W-VARIABLES.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.01  W-VARIABLES.01  W-VARIABLES.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-ANO-ACTUALPIC 9(04) VALUE ZEROS.03 W-EDAD-CEDULAPIC 9(03) VALUE ZEROS.03 W-EDAD-CEDULAPIC 9(03) VALUE ZEROS.03 W-FEC-EXPEPIC 9(08) VALUE ZEROS.03 W-FEC-EXPEPIC 9(08) VALUE ZEROS.03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.05 W-ANO-EXPEPIC 9(04).05 W-ANO-EXPEPIC 9(04).05 W-MES-EXPEPIC 9(02).05 W-MES-EXPEPIC 9(02).05 W-DIA-EXPEPIC 9(02).05 W-DIA-EXPEPIC 9(02).03 WS-EDADPIC 9(03).03 WS-EDADPIC 9(03).
*------------------------------------------------------------------**------------------------------------------------------------------*
01  VEC-MAESTRO.01  VEC-MAESTRO.03 LETRA-MAESTROPIC X  OCCURS 65 TIMES.03 LETRA-MAESTROPIC X  OCCURS 65 TIMES.
01  VEC-DANE.01  VEC-DANE.03 LETRA-DANEPIC X  OCCURS 65 TIMES.03 LETRA-DANEPIC X  OCCURS 65 TIMES.
01  VEC-BLOQUES.01  VEC-BLOQUES.03 LIM-INFPIC 9(02)  OCCURS 44 TIMES.03 LIM-INFPIC 9(02)  OCCURS 44 TIMES.03 LIM-SUPPIC 9(02)  OCCURS 44 TIMES.03 LIM-SUPPIC 9(02)  OCCURS 44 TIMES.
01  CONTADORES-COMP-NOMBRE.01  CONTADORES-COMP-NOMBRE.03 KPIC 9(04) VALUE ZERO.03 KPIC 9(04) VALUE ZERO.03 NOMBRE-BIENPIC 9     VALUE ZERO.03 NOMBRE-BIENPIC 9     VALUE ZERO.
01  VEC-MAESTRO-UNO.01  VEC-MAESTRO-UNO.03 LETRA-MAESTRO-UNOPIC X  OCCURS 45 TIMES.03 LETRA-MAESTRO-UNOPIC X  OCCURS 45 TIMES.
01  VEC-DANE-UNO.01  VEC-DANE-UNO.03 LETRA-DANE-UNOPIC X  OCCURS 45 TIMES.03 LETRA-DANE-UNOPIC X  OCCURS 45 TIMES.
01  VEC-BLOQUES-UNO.01  VEC-BLOQUES-UNO.03 LIM-INF-UNOPIC 99  OCCURS 44 TIMES.03 LIM-INF-UNOPIC 99  OCCURS 44 TIMES.03 LIM-SUP-UNOPIC 99  OCCURS 44 TIMES.03 LIM-SUP-UNOPIC 99  OCCURS 44 TIMES.
01  TITULO-1.01  TITULO-1.03 FILLERPIC X(55) VALUE SPACES.03 FILLERPIC X(55) VALUE SPACES.03 FILLERPIC X(21) VALUE03 FILLERPIC X(21) VALUE"D A T A C R E D I T O"."D A T A C R E D I T O".03 FILLERPIC X(33) VALUE SPACES.03 FILLERPIC X(33) VALUE SPACES.03 DIA-T1PIC X(02).03 DIA-T1PIC X(02).03 FILLERPIC X     VALUE "/".03 FILLERPIC X     VALUE "/".03 MES-T1PIC X(02).03 MES-T1PIC X(02).03 FILLERPIC X     VALUE "/".03 FILLERPIC X     VALUE "/".03 SIG-T1PIC X(02).03 SIG-T1PIC X(02).03 ANO-T1PIC X(02).03 ANO-T1PIC X(02).03 FILLERPIC X(13) VALUE SPACES.03 FILLERPIC X(13) VALUE SPACES.
01  TITULO-2.01  TITULO-2.03 FILLERPIC X(10) VALUE " PESVNOCSV".03 FILLERPIC X(10) VALUE " PESVNOCSV".03 FILLERPIC X(41) VALUE SPACES.03 FILLERPIC X(41) VALUE SPACES.03 FILLERPIC X(37) VALUE03 FILLERPIC X(37) VALUE"ESTADISTICAS DE VALIDACION DE CEDULAS"."ESTADISTICAS DE VALIDACION DE CEDULAS".03 FILLERPIC X(24) VALUE SPACES.03 FILLERPIC X(24) VALUE SPACES.03 HORA-T2PIC 9(02).03 HORA-T2PIC 9(02).03 FILLERPIC X     VALUE ":".03 FILLERPIC X     VALUE ":".03 MIN-T2PIC 9(02).03 MIN-T2PIC 9(02).03 FILLERPIC X(06) VALUE SPACES.03 FILLERPIC X(06) VALUE SPACES.03 FILLERPIC X(06) VALUE "SUSC: ".03 FILLERPIC X(06) VALUE "SUSC: ".03 SUSCRIPTOR-T2PIC 9(06).03 SUSCRIPTOR-T2PIC 9(06).
01  RAYASPIC X(132) VALUE ALL "-".01  RAYASPIC X(132) VALUE ALL "-".
01  LINEA-1.01  LINEA-1.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(32) VALUE03 FILLERPIC X(32) VALUE"REGISTROS LEIDOS:"."REGISTROS LEIDOS:".03 FILLERPIC X(32) VALUE03 FILLERPIC X(32) VALUE"REGISTROS LEIDOS:"."REGISTROS LEIDOS:".03 REG-LEIDOS-L1PIC ZZ,ZZZ,ZZ9.03 REG-LEIDOS-L1PIC ZZ,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-2.01  LINEA-2.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"REGISTROS CORRECTOS:"."REGISTROS CORRECTOS:".03 REG-CORRECTOS-L2PIC Z,ZZZ,ZZ9.03 REG-CORRECTOS-L2PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-3.01  LINEA-3.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO COINCIDEN CON DIAN O DAS:     "."NO COINCIDEN CON DIAN O DAS:     ".03 NO-COINCIDE-DIAN-L3PIC Z,ZZZ,ZZ9.03 NO-COINCIDE-DIAN-L3PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-4.01  LINEA-4.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO COINCIDEN CON REGISTARDURIA:  "."NO COINCIDEN CON REGISTARDURIA:  ".03 NO-COINCIDE-REGIS-L4     PIC Z,ZZZ,ZZ9.03 NO-COINCIDE-REGIS-L4     PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-5.01  LINEA-5.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO EXISTEN EN DIAN O DAS:"."NO EXISTEN EN DIAN O DAS:".03 NO-EXISTE-DIAN-L5PIC Z,ZZZ,ZZ9.03 NO-EXISTE-DIAN-L5PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-6.01  LINEA-6.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"NO EXISTEN EN REGISTRADURIA:     "."NO EXISTEN EN REGISTRADURIA:     ".03 NO-EXISTE-REGIS-L6PIC Z,ZZZ,ZZ9.03 NO-EXISTE-REGIS-L6PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  LINEA-7.01  LINEA-7.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(33) VALUE03 FILLERPIC X(33) VALUE"TIPO IDENTIFICACION INVALIDO:    "."TIPO IDENTIFICACION INVALIDO:    ".03 TIPO-ID-INVALIDO-L7PIC Z,ZZZ,ZZ9.03 TIPO-ID-INVALIDO-L7PIC Z,ZZZ,ZZ9.03 FILLERPIC X(45) VALUE SPACES.03 FILLERPIC X(45) VALUE SPACES.
01  FECHA-2000PIC 9(8).01  FECHA-2000PIC 9(8).
01  FECHA-2000-R  REDEFINES FECHA-2000.01  FECHA-2000-R  REDEFINES FECHA-2000.03 ANO-2000-RPIC 9(4).03 ANO-2000-RPIC 9(4).03 MES-2000-RPIC 9(2).03 MES-2000-RPIC 9(2).03 DIA-2000-RPIC 9(2).03 DIA-2000-RPIC 9(2).
*------------------------------------------------------------------**------------------------------------------------------------------*
01  HACER-MATCHPIC  9(01).01  HACER-MATCHPIC  9(01).
01  CADENA-ENTRAPIC  X(60).01  CADENA-ENTRAPIC  X(60).
01  CADENA-SALEPIC  X(60).01  CADENA-SALEPIC  X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
CQ6271 LINKAGE SECTION.PJV0010CQ6271 LINKAGE SECTION.PJV0010"Ñ"."Ñ".
CQ6271 LINKAGE SECTION.PJV0010CQ6271 LINKAGE SECTION.PJV0010
CQ6271 COPY LOGPESVNO.LKG.PJV0010CQ6271 COPY LOGPESVNO.LKG.PJV0010
**
*=================================================================*=================================================================
$SET CONSTANT HACERMATCH"SI"$SET CONSTANT HACERMATCH"SI"
$SET CONSTANT AMNISTIA21"SI"$SET CONSTANT AMNISTIA21"SI"
*=================================================================*=================================================================PROCEDURE DIVISION.PROCEDURE DIVISION.
************************************************************************************************************************************
*100-PROGRAMA-PRINCIPAL.*100-PROGRAMA-PRINCIPAL.
*RUTINA PRINCIPAL*RUTINA PRINCIPAL
*VALIDA EL CODIGO DEL SUSCRIPTOR DEL ARCHIVO DE ENTRADA*VALIDA EL CODIGO DEL SUSCRIPTOR DEL ARCHIVO DE ENTRADA
*VALIDA LA CLAVE CON QUE SE GRABARAN REGISTROS EN EL ICBTCO*VALIDA LA CLAVE CON QUE SE GRABARAN REGISTROS EN EL ICBTCO
************************************************************************************************************************************
100-PROGRAMA-PRINCIPAL.100-PROGRAMA-PRINCIPAL.PERFORM 150-ABRIR-ARCHIVOSPERFORM 150-ABRIR-ARCHIVOSREAD ENTRADAREAD ENTRADAAT ENDAT ENDMOVE 1 TO FIN-ENTRADAMOVE 1 TO FIN-ENTRADANOT AT ENDNOT AT ENDINSPECT NUMID-X-E REPLACING ALL " " BY "0"INSPECT NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READEND-READ
R7094A     IF NOMBRE-E = "VALIDAR=NO" AND FIN-ENTRADA = 0RMB0009R7094A     IF NOMBRE-E = "VALIDAR=NO" AND FIN-ENTRADA = 0RMB0009
R7094AMOVE 0 TO W-BLOQUESRMB0009R7094AMOVE 0 TO W-BLOQUESRMB0009
R7094ADISPLAY "Registro  control==> 000001 (VALIDAR=NO)"RMB0009R7094ADISPLAY "Registro  control==> 000001 (VALIDAR=NO)"RMB0009
R7094AMOVE 0 TO W-BLOQUESRMB0009R7094AMOVE 0 TO W-BLOQUESRMB0009
R7094AREAD ENTRADARMB0009R7094AREAD ENTRADARMB0009
R7094AAT ENDRMB0009R7094AAT ENDRMB0009
R7094AMOVE 1 TO FIN-ENTRADARMB0009R7094AMOVE 1 TO FIN-ENTRADARMB0009
R7094ANOT AT ENDRMB0009R7094ANOT AT ENDRMB0009
R7094AINSPECT NUMID-X-E REPLACING ALL " " BY "0"RMB0009R7094AINSPECT NUMID-X-E REPLACING ALL " " BY "0"RMB0009
R7094AINSPECT TIPOID-X-E REPLACING ALL "0" BY "1"RMB0009R7094AINSPECT TIPOID-X-E REPLACING ALL "0" BY "1"RMB0009
R7094AEND-READRMB0009R7094AEND-READRMB0009
R7094A     ELSERMB0009R7094A     ELSERMB0009
R7094ADISPLAY "Registro  control==> 000000 (VALIDAR=NO)"RMB0009R7094ADISPLAY "Registro  control==> 000000 (VALIDAR=NO)"RMB0009
R7094A     END-IF.RMB0009R7094A     END-IF.RMB0009CLOSE CLAVE ABD14.CLOSE CLAVE ABD14.MOVE FUNCTION CURRENT-DATE TO FECHA-PROC-RMOVE FUNCTION CURRENT-DATE TO FECHA-PROC-RMOVE DIA-PROC TO DIA-AUXMOVE DIA-PROC TO DIA-AUXMOVE MES-PROC TO MES-AUXMOVE MES-PROC TO MES-AUXMOVE ANO-PROC TO ANO-AUXMOVE ANO-PROC TO ANO-AUXMOVE ANO-HOY  TO W-ANO-ACTUALMOVE ANO-HOY  TO W-ANO-ACTUALPERFORM 400-VALIDAR UNTIL FIN-ENTRADA = 1.PERFORM 400-VALIDAR UNTIL FIN-ENTRADA = 1.IF W-CONT-TIPO-5 >  ZEROS  ORIF W-CONT-TIPO-5 >  ZEROS  ORW-CONT-TIPO-6 >  ZEROS  ORW-CONT-TIPO-6 >  ZEROS  ORW-CONT-TIPO-7 >  ZEROSW-CONT-TIPO-7 >  ZEROSDISPLAY "Registros Tipo 5==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 5==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 6==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7
PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7
PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407
*DISPLAY "*-----------------------------------*"|  PJV012DISPLAY "*-----------------------------------*"CQ12657
*DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSV|  PJV012DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSVCQ12657
*DISPLAY "*------------------------------------*"|  PJV012DISPLAY "*------------------------------------*"CQ12657END-IFEND-IFPERFORM 900-CERRAR-ARCHIVOSPERFORM 900-CERRAR-ARCHIVOS
CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010
CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010
CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010STOP RUN.STOP RUN.************************************************************************************************************************************
*150-ABRIR-ARCHIVOS.*150-ABRIR-ARCHIVOS.
*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU
*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU
*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN
*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE
*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO
************************************************************************************************************************************
150-ABRIR-ARCHIVOS.150-ABRIR-ARCHIVOS.OPEN INPUT BDIIREGI.OPEN INPUT BDIIREGI.
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"
*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"
MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011ACCEPT W-PARAMETROS   FROM COMMAND-LINEACCEPT W-PARAMETROS   FROM COMMAND-LINEUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOW-ENT-NOMBRE,W-ENT-NOMBRE,W-VAL-NOMBRE,W-VAL-NOMBRE,W-INVAL-NOMBRE,W-INVAL-NOMBRE,W-TARIFA,W-TARIFA,W-BLOQUES,W-BLOQUES,W-DERECHOSW-DERECHOSEND-UNSTRINGEND-UNSTRINGIF W-TARIFA= ZEROS  ORIF W-TARIFA= ZEROS  ORW-ENT-NOMBRE   = SPACES ORW-ENT-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-INVAL-NOMBRE = SPACES ORW-INVAL-NOMBRE = SPACES OR
R7094A*(W-BLOQUES < 0 OR > 4)RMB0009R7094A*(W-BLOQUES < 0 OR > 4)RMB0009
R7094AW-BLOQUES > 4RMB0009R7094AW-BLOQUES > 4RMB0009DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "STOP RUNSTOP RUNEND-IFEND-IF
R7094A     IF W-BLOQUES = 0RMB0009R7094A     IF W-BLOQUES = 0RMB0009
R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009
R7094A     END-IFRMB0009R7094A     END-IFRMB0009

PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407
PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407
PJV011".vre"DELIMITED BY SIZECQ11407PJV011".vre"DELIMITED BY SIZECQ11407
PJV011INTO W-VAL-NOMBRE-REPCQ11407PJV011INTO W-VAL-NOMBRE-REPCQ11407
PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407MOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTW-SORT-NOM-SALW-SORT-NOM-SALW-LINEAS-NOM-ENTW-LINEAS-NOM-ENT
*    DISPLAY "============================================"*    DISPLAY "============================================"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"CALL "SYSTEM" USING W-COMANDO-LINEASCALL "SYSTEM" USING W-COMANDO-LINEAS
*    DISPLAY " "*    DISPLAY " "DISPLAY "ARCHIVO: " W-LINEAS-NOM-ENTDISPLAY "ARCHIVO: " W-LINEAS-NOM-ENT
*    DISPLAY " "*    DISPLAY " "CALL "SYSTEM" USING W-COMANDO-SORTCALL "SYSTEM" USING W-COMANDO-SORTIF RETURN-CODE <> 0IF RETURN-CODE <> 0DISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBREDISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBRESTOP RUNSTOP RUNEND-IFEND-IFOPEN INPUT  ENTRADAOPEN INPUT  ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIALEBDIIALEMUNICIPIOSMUNICIPIOSCLAVECLAVEABD14ABD14
XXXXXX*    OPEN I-O    SECUENCIALXXXXXX*    OPEN I-O    SECUENCIAL
XXXXXX     OPEN INPUT  SECUENCIALXXXXXX     OPEN INPUT  SECUENCIALOPEN OUTPUT VALIDASOPEN OUTPUT VALIDASINCONSINCONS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407MOVE 29999999 TO LLAVE-SECMOVE 29999999 TO LLAVE-SECSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-STARTEND-STARTIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEREAD SECUENCIAL PREVIOUS AT ENDREAD SECUENCIAL PREVIOUS AT ENDDISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "DISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "LLAVE-SECLLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-READEND-READIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEMOVE LLAVE-SEC TO LLAVE7MOVE LLAVE-SEC TO LLAVE7IF LLAVE7-1D NOT = 2IF LLAVE7-1D NOT = 2MOVE 2     TO LLAVE7-1DMOVE 2     TO LLAVE7-1DMOVE ZEROS TO LLAVE7-FILLERMOVE ZEROS TO LLAVE7-FILLEREND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.**************************************************************************************************************************************
*400-VALIDAR*400-VALIDAR***************************************************************************************************************************************400-VALIDAR*400-VALIDAR
* DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-* DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-
* TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,* TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,
* NIT O DAS)* NIT O DAS)
* ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION* ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION
* LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA* LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA
**************************************************************************************************************************************
400-VALIDAR.400-VALIDAR.ADD  1 TO REG-LEIDOS.ADD  1 TO REG-LEIDOS.MOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INCMOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INCINITIALIZE REG-INCONS REG-VALIDASINITIALIZE REG-INCONS REG-VALIDASMOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9FILLER6 FILLER7 FILLER8 FILLER9MOVE FILLER-2-E TO FILLER-2-VALMOVE FILLER-2-E TO FILLER-2-VALMOVE FILLER-2-E TO FILLER-2-INCMOVE FILLER-2-E TO FILLER-2-INCIF TIPOID-E < 1 OR > 4IF TIPOID-E < 1 OR > 4MOVE 05 TO CODIGO-ERROR CODERR-INCMOVE 05 TO CODIGO-ERROR CODERR-INCMOVE 1  TO SW-ERRORMOVE 1  TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD  1  TO TIPO-ID-INVALIDOADD  1  TO TIPO-ID-INVALIDOELSEELSEMOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDENUM-ID-WNUM-ID-WMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDEMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDE
R7094A*MOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     |  PJV012MOVE    1TO  SW-VERIFNOM-BDIIVIDECQ12657
R7094A*SW-DIGCHEQUEO-BDIIVIDERMB0009     |  PJV012SW-DIGCHEQUEO-BDIIVIDECQ12657
R7094AIF W-BLOQUES > 0RMB0009     <
R7094AMOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     <
R7094AEND-IFRMB0009     <
R7094DIF TIPOID-E = 2 OR 3RMB0009     <
R7094DMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDERMB0009     <
R7094DEND-IFRMB0009     <MOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEMOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEPERFORM 80100-VALIDAR-IDENTIFICACIONPERFORM 80100-VALIDAR-IDENTIFICACIONMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EINITIALIZE REG-VALIDAS REG-INCONSINITIALIZE REG-VALIDAS REG-INCONS
REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007     <
REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007     <MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9FILLER6 FILLER7 FILLER8 FILLER9
>  REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007
>  REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007IF SW-ID-BDIIVIDE = 1IF SW-ID-BDIIVIDE = 1IF TIPOID-E <> 1IF TIPOID-E <> 1
CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006
CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003
CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003
CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003
CSVCEXMOVE  1TO SW-ERRORGJC0003CSVCEXMOVE  1TO SW-ERRORGJC0003
CSVCEXPERFORM 512-CREE-REGISTROGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003
CSVCEXWRITE REG-INCONSGJC0003CSVCEXWRITE REG-INCONSGJC0003PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407MOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTW-SORT-NOM-SALW-SORT-NOM-SALW-LINEAS-NOM-ENTW-LINEAS-NOM-ENT
*    DISPLAY "============================================"*    DISPLAY "============================================"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"CALL "SYSTEM" USING W-COMANDO-LINEASCALL "SYSTEM" USING W-COMANDO-LINEAS
*    DISPLAY " "*    DISPLAY " "DISPLAY "ARCHIVO: " W-LINEAS-NOM-ENTDISPLAY "ARCHIVO: " W-LINEAS-NOM-ENT
*    DISPLAY " "*    DISPLAY " "CALL "SYSTEM" USING W-COMANDO-SORTCALL "SYSTEM" USING W-COMANDO-SORTIF RETURN-CODE <> 0IF RETURN-CODE <> 0DISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBREDISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBRESTOP RUNSTOP RUNEND-IFEND-IFOPEN INPUT  ENTRADAOPEN INPUT  ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIALEBDIIALEMUNICIPIOSMUNICIPIOSCLAVECLAVEABD14ABD14
XXXXXX*    OPEN I-O    SECUENCIALXXXXXX*    OPEN I-O    SECUENCIAL
XXXXXX     OPEN INPUT  SECUENCIALXXXXXX     OPEN INPUT  SECUENCIALOPEN OUTPUT VALIDASOPEN OUTPUT VALIDASINCONSINCONS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407MOVE 29999999 TO LLAVE-SECMOVE 29999999 TO LLAVE-SECSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-STARTEND-STARTIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEREAD SECUENCIAL PREVIOUS AT ENDREAD SECUENCIAL PREVIOUS AT ENDDISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "DISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "LLAVE-SECLLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-READEND-READIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEMOVE LLAVE-SEC TO LLAVE7MOVE LLAVE-SEC TO LLAVE7IF LLAVE7-1D NOT = 2IF LLAVE7-1D NOT = 2MOVE 2     TO LLAVE7-1DMOVE 2     TO LLAVE7-1DMOVE ZEROS TO LLAVE7-FILLERMOVE ZEROS TO LLAVE7-FILLEREND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.**************************************************************************************************************************************
*400-VALIDAR*400-VALIDARDISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 7==> " W-CONT-TIPO-7
PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407PJV011DISPLAY "Registros Tipo 5 repetidos ==> " W-CONT-TIPO-5-REP CQ11407
*DISPLAY "*-----------------------------------*"|  PJV012DISPLAY "*-----------------------------------*"CQ12657
*DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSV|  PJV012DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSVCQ12657
*DISPLAY "*------------------------------------*"|  PJV012DISPLAY "*------------------------------------*"CQ12657END-IFEND-IFPERFORM 900-CERRAR-ARCHIVOSPERFORM 900-CERRAR-ARCHIVOS
CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010CQ6271     MOVE "V"TO TIPPRO-LOGPESVNO-WKPJV0010
CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010CQ6271     MOVE "PESVNO"TO PROGRAM-LOGPESVNO-WKPJV0010
CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010CQ6271     PERFORM 1000-UPDATE-LOGPESVNOPJV0010STOP RUN.STOP RUN.************************************************************************************************************************************
*150-ABRIR-ARCHIVOS.*150-ABRIR-ARCHIVOS.
*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU*SE ABRE CADA UNO DE LOS ARCHIVOS QUE REQUIERE EL PROGRAMA PARA SU
*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU*EJECUCION: ICDIAN,CEDULAS,REG01, REG02,ICDAS,ICBTCO,ICBCLA,ICBCIU
*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN*ICT40D.DAT,DCVAL,DCINIC,ICMUNI,ICI40N.PRN
*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE*PREPARA EL LA LLAVE DEL ARCHIVO ICBTCO PARA IDENTIFICAR CON QUE
*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO*LLAVE MAYOR QUE 20000000 INICIA LA ESCRITURA DEL MISMO
************************************************************************************************************************************
150-ABRIR-ARCHIVOS.150-ABRIR-ARCHIVOS.OPEN INPUT BDIIREGI.OPEN INPUT BDIIREGI.
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"
*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"*    DISPLAY "|  PROCESO VALIDACION USANDO CUENTAS SIN VALIDAR  |"
*    DISPLAY "*-------------------------------------------------*"*    DISPLAY "*-------------------------------------------------*"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"DISPLAY "!!........EL ORDEN DE LOS PARAMETROS ES ........!!"
MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011MODBD2     DISPLAY "!!..ENTRADA CORRECTOS INCORRECTOS TARIFA BLOQUES.!!"FAC0011ACCEPT W-PARAMETROS   FROM COMMAND-LINEACCEPT W-PARAMETROS   FROM COMMAND-LINEUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOUNSTRING W-PARAMETROS DELIMITED BY SPACES INTOW-ENT-NOMBRE,W-ENT-NOMBRE,W-VAL-NOMBRE,W-VAL-NOMBRE,W-INVAL-NOMBRE,W-INVAL-NOMBRE,W-TARIFA,W-TARIFA,W-BLOQUES,W-BLOQUES,W-DERECHOSW-DERECHOSEND-UNSTRINGEND-UNSTRINGIF W-TARIFA= ZEROS  ORIF W-TARIFA= ZEROS  ORW-ENT-NOMBRE   = SPACES ORW-ENT-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-VAL-NOMBRE   = SPACES ORW-INVAL-NOMBRE = SPACES ORW-INVAL-NOMBRE = SPACES OR
R7094A*(W-BLOQUES < 0 OR > 4)RMB0009R7094A*(W-BLOQUES < 0 OR > 4)RMB0009
R7094AW-BLOQUES > 4RMB0009R7094AW-BLOQUES > 4RMB0009DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "DISPLAY "!!!!!!    FALTA ALGUN PARAMETRO  !!!!!!! "STOP RUNSTOP RUNEND-IFEND-IF
R7094A     IF W-BLOQUES = 0RMB0009R7094A     IF W-BLOQUES = 0RMB0009
R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009R7094ADISPLAY "!!..EJECUCION SIN VALIDAR NOMBRES.....!!" RMB0009
R7094A     END-IFRMB0009R7094A     END-IFRMB0009

PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407PJV011     INITIALIZE W-VAL-NOMBRE-REPCQ11407
PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407PJV011     STRING W-VAL-NOMBRE DELIMITED BY "."CQ11407
PJV011".vre"DELIMITED BY SIZECQ11407PJV011".vre"DELIMITED BY SIZECQ11407
PJV011INTO W-VAL-NOMBRE-REPCQ11407PJV011INTO W-VAL-NOMBRE-REPCQ11407
PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407
PJV011     END-STRINGCQ11407PJV011     END-STRINGCQ11407MOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTMOVE W-ENT-NOMBRETO W-SORT-NOM-ENTW-SORT-NOM-SALW-SORT-NOM-SALW-LINEAS-NOM-ENTW-LINEAS-NOM-ENT
*    DISPLAY "============================================"*    DISPLAY "============================================"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"DISPLAY "REGISTROS RECIBIDOS ORIGINALMENTE:"CALL "SYSTEM" USING W-COMANDO-LINEASCALL "SYSTEM" USING W-COMANDO-LINEAS
*    DISPLAY " "*    DISPLAY " "DISPLAY "ARCHIVO: " W-LINEAS-NOM-ENTDISPLAY "ARCHIVO: " W-LINEAS-NOM-ENT
*    DISPLAY " "*    DISPLAY " "CALL "SYSTEM" USING W-COMANDO-SORTCALL "SYSTEM" USING W-COMANDO-SORTIF RETURN-CODE <> 0IF RETURN-CODE <> 0DISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBREDISPLAY "ERROR ORDENANDO UNICOS " W-ENT-NOMBRESTOP RUNSTOP RUNEND-IFEND-IFOPEN INPUT  ENTRADAOPEN INPUT  ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIALEBDIIALEMUNICIPIOSMUNICIPIOSCLAVECLAVEABD14ABD14
XXXXXX*    OPEN I-O    SECUENCIALXXXXXX*    OPEN I-O    SECUENCIAL
XXXXXX     OPEN INPUT  SECUENCIALXXXXXX     OPEN INPUT  SECUENCIALOPEN OUTPUT VALIDASOPEN OUTPUT VALIDASINCONSINCONS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407MOVE 29999999 TO LLAVE-SECMOVE 29999999 TO LLAVE-SECSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYSTART SECUENCIAL KEY < LLAVE-SEC INVALID KEYDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECDISPLAY " ERROR EN START DE ICBTCO  " LLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-STARTEND-STARTIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEREAD SECUENCIAL PREVIOUS AT ENDREAD SECUENCIAL PREVIOUS AT ENDDISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "DISPLAY " ERROR LEYENDO REGISTRO PREVIO DE ICBTCO  "LLAVE-SECLLAVE-SECMOVE 1 TO FINSMOVE 1 TO FINSEND-READEND-READIF FINS = 1IF FINS = 1MOVE TOPE-INI-LLAVE7 TO LLAVE7MOVE TOPE-INI-LLAVE7 TO LLAVE7ELSEELSEMOVE LLAVE-SEC TO LLAVE7MOVE LLAVE-SEC TO LLAVE7IF LLAVE7-1D NOT = 2IF LLAVE7-1D NOT = 2MOVE 2     TO LLAVE7-1DMOVE 2     TO LLAVE7-1DMOVE ZEROS TO LLAVE7-FILLERMOVE ZEROS TO LLAVE7-FILLEREND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.**************************************************************************************************************************************
*400-VALIDAR*400-VALIDAR***************************************************************************************************************************************400-VALIDAR*400-VALIDAR
* DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-* DEPENDIENDO DEL TIPO DE IDENTIFICACION LEIDO EN EL ARCHIVO DE EN-
* TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,* TRADA LLAMA A LA CORRESPONDIENTE RUTINA DE VALIDACION (CEDULA,
* NIT O DAS)* NIT O DAS)
* ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION* ACUMULA EN CONTADORES DEPENDIENDO DEL RESULTADO DE LA VALIDACION
* LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA* LEE SECUENCIALMENTE EL ARCHIVO DE ENTRADA
**************************************************************************************************************************************
400-VALIDAR.400-VALIDAR.ADD  1 TO REG-LEIDOS.ADD  1 TO REG-LEIDOS.MOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INCMOVE 0 TO SW-ERROR CODIGO-ERROR CODERR-INCINITIALIZE REG-INCONS REG-VALIDASINITIALIZE REG-INCONS REG-VALIDASMOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9FILLER6 FILLER7 FILLER8 FILLER9MOVE FILLER-2-E TO FILLER-2-VALMOVE FILLER-2-E TO FILLER-2-VALMOVE FILLER-2-E TO FILLER-2-INCMOVE FILLER-2-E TO FILLER-2-INCIF TIPOID-E < 1 OR > 4IF TIPOID-E < 1 OR > 4MOVE 05 TO CODIGO-ERROR CODERR-INCMOVE 05 TO CODIGO-ERROR CODERR-INCMOVE 1  TO SW-ERRORMOVE 1  TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD  1  TO TIPO-ID-INVALIDOADD  1  TO TIPO-ID-INVALIDOELSEELSEMOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDENUM-ID-WNUM-ID-WMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDEMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDE
R7094A*MOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     |  PJV012MOVE    1TO  SW-VERIFNOM-BDIIVIDECQ12657
R7094A*SW-DIGCHEQUEO-BDIIVIDERMB0009     |  PJV012SW-DIGCHEQUEO-BDIIVIDECQ12657
R7094AIF W-BLOQUES > 0RMB0009     <
R7094AMOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     <
R7094AEND-IFRMB0009     <
R7094DIF TIPOID-E = 2 OR 3RMB0009     <
R7094DMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDERMB0009     <
R7094DEND-IFRMB0009     <MOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEMOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEPERFORM 80100-VALIDAR-IDENTIFICACIONPERFORM 80100-VALIDAR-IDENTIFICACIONMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EINITIALIZE REG-VALIDAS REG-INCONSINITIALIZE REG-VALIDAS REG-INCONS
REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007     <
REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007     <MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9FILLER6 FILLER7 FILLER8 FILLER9
>  REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007
>  REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007IF SW-ID-BDIIVIDE = 1IF SW-ID-BDIIVIDE = 1IF TIPOID-E <> 1IF TIPOID-E <> 1
CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006
CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003
CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003
CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003
CSVCEXMOVE  1TO SW-ERRORGJC0003CSVCEXMOVE  1TO SW-ERRORGJC0003
CSVCEXPERFORM 512-CREE-REGISTROGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003
CSVCEXWRITE REG-INCONSGJC0003CSVCEXWRITE REG-INCONSGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003CSVCEXPERFORM 512-CREE-REGISTROGJC0003
CSVCEXWRITE REG-INCONSGJC0003CSVCEXWRITE REG-INCONSGJC0003
CSVCEXADD   1TO  NO-EXISTE-DIANGJC0003CSVCEXADD   1TO  NO-EXISTE-DIANGJC0003
CSVCEXEND-IFGJC0003CSVCEXEND-IFGJC0003ELSEELSEMOVE  ZEROS TO  HACER-MATCHMOVE  ZEROS TO  HACER-MATCH
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006PERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0MOVE 04 TO CODIGO-ERROR CODERR-INCMOVE 04 TO CODIGO-ERROR CODERR-INCMOVE TIPOID-E TO TIP-INCMOVE TIPOID-E TO TIP-INCADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISMOVE 1  TO SW-ERRORMOVE 1  TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSEND-IFEND-IFEND-IFEND-IFELSEELSEIF SW-NOMBRES-BDIIVIDE = 1IF SW-NOMBRES-BDIIVIDE = 1IF TIPOID-E <> 1IF TIPOID-E <> 1MOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE  1 TO SW-ERRORMOVE  1 TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS TO MUN-EXP-INCMOVE NACIO-BDIIDAS TO MUN-EXP-INCEND-IFEND-IFELSEELSEPERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIOMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADESMOVE FECHA-2000 TO FEC-EXP-VALMOVE FECHA-2000 TO FEC-EXP-VALFEC-EXP-INCFEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00"TO VIG-VAL VIG-INCMOVE "00"TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VALMOVE ESTADO-VIG-BDIIREGI TO VIG-VALVIG-INCVIG-INCEND-IFEND-IFMOVE   02 TO CODIGO-ERROR CODERR-INCMOVE   02 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISEND-IFEND-IFELSEELSE
R7094C*IF W-BLOQUES > 1 OR TIPOID-E <> 1RMB0009R7094C*IF W-BLOQUES > 1 OR TIPOID-E <> 1RMB0009
R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009
R7094C*ELSERMB0009R7094C*ELSERMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094C*MOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009
R7094C*ELSERMB0009R7094C*ELSERMB0009
R7094C*MOVE PRIMER-APELLIDO-BDIIVIDE TO NOM-VALRMB0009R7094C*MOVE PRIMER-APELLIDO-BDIIVIDE TO NOM-VALRMB0009
R7094C*END-IFRMB0009R7094C*END-IFRMB0009
R7094CMOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009R7094CMOVE NOM-VAL-BDIIVIDETO NOM-VALRMB0009INITIALIZE LLAVE-BDIIALEINITIALIZE LLAVE-BDIIALEMOVE  TIPOID-E TO TIP-IDE-BDIIALEMOVE  TIPOID-E TO TIP-IDE-BDIIALEMOVE  NUMID-E  TO NUM-IDE-BDIIALEMOVE  NUMID-E  TO NUM-IDE-BDIIALEMOVE  990003   TO FUENTE-BDIIALEMOVE  990003   TO FUENTE-BDIIALESTART BDIIALE KEY NOT < LLAVE-BDIIALESTART BDIIALE KEY NOT < LLAVE-BDIIALEINVALID KEY MOVE 1 TO SW-BDIIALEINVALID KEY MOVE 1 TO SW-BDIIALENOT INVALID KEY MOVE 0 TO SW-BDIIALENOT INVALID KEY MOVE 0 TO SW-BDIIALEREAD BDIIALE NEXT RECORDREAD BDIIALE NEXT RECORDAT END MOVE 1 TO SW-BDIIALEAT END MOVE 1 TO SW-BDIIALEEND-READEND-READEND-STARTEND-STARTPERFORM UNTIL SW-BDIIALE = 1 ORPERFORM UNTIL SW-BDIIALE = 1 ORTIPOID-E <> TIP-IDE-BDIIALE ORTIPOID-E <> TIP-IDE-BDIIALE ORNUMID-E <> NUM-IDE-BDIIALENUMID-E <> NUM-IDE-BDIIALEIF FUENTE-BDIIALE = 990003 ANDIF FUENTE-BDIIALE = 990003 ANDFEC-NOV-BDIIALE <= FECHA-PROC-R ANDFEC-NOV-BDIIALE <= FECHA-PROC-R ANDFEC-VEN-BDIIALE >= FECHA-PROC-R ANDFEC-VEN-BDIIALE >= FECHA-PROC-R ANDBLOQUEO-BDIIALE = 0BLOQUEO-BDIIALE = 0MOVE 1 TO SW-BDIIALEMOVE 1 TO SW-BDIIALEEND-IFEND-IFIF SW-BDIIALE = 0IF SW-BDIIALE = 0READ BDIIALE NEXT RECORDREAD BDIIALE NEXT RECORDAT END MOVE 1 TO SW-BDIIALEAT END MOVE 1 TO SW-BDIIALEEND-READEND-READEND-IFEND-IFEND-PERFORMEND-PERFORMIF TIPOID-E = 1IF TIPOID-E = 1IF ESTADO-VIG-BDIIREGI = 12 ANDIF ESTADO-VIG-BDIIREGI = 12 ANDW-DERECHOS = 1W-DERECHOS = 1MOVE  07   TO  CODIGO-ERROR CODERR-INCMOVE  07   TO  CODIGO-ERROR CODERR-INCMOVE   1   TO  SW-ERRORMOVE   1   TO  SW-ERRORMOVE "00"  TO  VIG-INCMOVE "00"  TO  VIG-INCPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSELSEELSEIF ESTADO-VIG-BDIIREGI = 21IF ESTADO-VIG-BDIIREGI = 21MOVE  06  TO CODIGO-ERROR CODERR-INCMOVE  06  TO CODIGO-ERROR CODERR-INCMOVE   1  TO SW-ERRORMOVE   1  TO SW-ERRORMOVE "21" TO VIG-INCMOVE "21" TO VIG-INCPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD   1   TO NO-COINCIDE-REGISADD   1   TO NO-COINCIDE-REGIS
R7094BADD   1   TO CONT-FALLECIDOSRMB0009R7094BADD   1   TO CONT-FALLECIDOSRMB0009ELSEELSEPERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIOMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE FECHA-2000 TO FEC-EXP-VALMOVE FECHA-2000 TO FEC-EXP-VALFEC-EXP-INCFEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00" TO VIG-VAL VIG-INCMOVE "00" TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VALMOVE ESTADO-VIG-BDIIREGI TO VIG-VALVIG-INCVIG-INCEND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADES
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE   "O"TO ORIGEN-VAL|  PJV012MOVE   "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFELSEELSEIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE ZEROSTO VIG-VALMOVE ZEROSTO VIG-VALEND-IFEND-IFMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE NUMID-ETO CED-VAL CED-INCMOVE NUMID-ETO CED-VAL CED-INC
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE    "O"TO ORIGEN-VAL|  PJV012MOVE    "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFIF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD  1 TO W-CONT-TIPO-6ADD  1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1  TO W-CONT-TIPO-7ADD 1  TO W-CONT-TIPO-7ELSEELSE
PJV011IF SN-VALREP = "S"CQ11407PJV011IF SN-VALREP = "S"CQ11407
PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407
PJV011ELSECQ11407PJV011ELSECQ11407ADD 1  TO W-CONT-TIPO-5ADD 1  TO W-CONT-TIPO-5
PJV011END-IFCQ11407PJV011END-IFCQ11407
CQ6271IF TIPOID-E = 2 OR 3PJV0010CQ6271IF TIPOID-E = 2 OR 3PJV0010
CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010
CQ6271END-IFPJV0010CQ6271END-IFPJV0010END-IFEND-IFEND-IFEND-IFREAD ENTRADAREAD ENTRADAAT ENDAT ENDMOVE 1 TO FIN-ENTRADAMOVE 1 TO FIN-ENTRADANOT AT ENDNOT AT ENDINSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"
INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READ.END-READ.

PJV011 300-GRABA-VALREP.CQ11407PJV011 300-GRABA-VALREP.CQ11407
PJV011     INITIALIZE REG-VALIDAS-REPCQ11407PJV011     INITIALIZE REG-VALIDAS-REPCQ11407
PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDASCQ11407PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDASCQ11407
PJV011     MOVE TIP-VAL TO TIP-KEYVALCQ11407PJV011     MOVE TIP-VAL TO TIP-KEYVALCQ11407
PJV011     MOVE CED-VAL TO NUM-KEYVALCQ11407PJV011     MOVE CED-VAL TO NUM-KEYVALCQ11407
PJV011     ADD 1 TO REG-CORRECTOS-R  .CQ11407PJV011     ADD 1 TO REG-CORRECTOS-R  .CQ11407

PJV011 301-GRABA-LOS-VALIDOS.CQ11407PJV011 301-GRABA-LOS-VALIDOS.CQ11407
PJV011     MOVE "N" TO SN-VALREPCQ11407PJV011     MOVE "N" TO SN-VALREPCQ11407
PJV011     IF TIP-KEYVAL = TIPOID-E ANDCQ11407PJV011     IF TIP-KEYVAL = TIPOID-E ANDCQ11407
PJV011NUM-KEYVAL = NUMID-ECQ11407PJV011NUM-KEYVAL = NUMID-ECQ11407
PJV011MOVE "S" TO SN-VALREPCQ11407PJV011MOVE "S" TO SN-VALREPCQ11407
PJV011PERFORM 300-GRABA-VALREPCQ11407PJV011PERFORM 300-GRABA-VALREPCQ11407
PJV011     ELSECQ11407PJV011     ELSECQ11407
PJV011WRITE REG-VALIDASCQ11407PJV011WRITE REG-VALIDASCQ11407
PJV011MOVE TIP-VAL TO TIP-KEYVALCQ11407PJV011MOVE TIP-VAL TO TIP-KEYVALCQ11407
PJV011MOVE CED-VAL TO NUM-KEYVALCQ11407PJV011MOVE CED-VAL TO NUM-KEYVALCQ11407
PJV011ADD 1 TO REG-CORRECTOSCQ11407PJV011ADD 1 TO REG-CORRECTOSCQ11407
PJV011     END-IF.CQ11407PJV011     END-IF.CQ11407505-RANGO-EDADES.505-RANGO-EDADES.
*--------------------------------------------------**--------------------------------------------------*
*505-RANGO-EDADES.*505-RANGO-EDADES.
*  RANGO MUJERES: 20'000.001 A 70'000.000*  RANGO MUJERES: 20'000.001 A 70'000.000
*  RANGO HOMBRES:1 A 20'000.000*  RANGO HOMBRES:1 A 20'000.000
*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)
*--------------------------------------------------**--------------------------------------------------*MOVE FEC-EXP-VALTO  W-FEC-EXPEMOVE FEC-EXP-VALTO  W-FEC-EXPEMOVE ZEROSTO  W-EDAD-CEDULAMOVE ZEROSTO  W-EDAD-CEDULAIF W-ANO-EXPE >= 1975IF W-ANO-EXPE >= 1975COMPUTE W-EDAD-CEDULA =COMPUTE W-EDAD-CEDULA =((W-ANO-ACTUAL - W-ANO-EXPE) + 18)((W-ANO-ACTUAL - W-ANO-EXPE) + 18)ELSEELSECOMPUTE W-EDAD-CEDULA =COMPUTE W-EDAD-CEDULA =((W-ANO-ACTUAL - W-ANO-EXPE) + 21)((W-ANO-ACTUAL - W-ANO-EXPE) + 21)END-IFEND-IFMOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDADMOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDADMOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.MOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.EVALUATE WS-EDADEVALUATE WS-EDADWHEN 18 THRU 21WHEN 18 THRU 21MOVE "18-21" TO EDAD-RANGOMOVE "18-21" TO EDAD-RANGOWHEN 22 THRU 28WHEN 22 THRU 28MOVE "22-28" TO EDAD-RANGOMOVE "22-28" TO EDAD-RANGOWHEN 29 THRU 35WHEN 29 THRU 35MOVE "29-35" TO EDAD-RANGOMOVE "29-35" TO EDAD-RANGOWHEN 36 THRU 45WHEN 36 THRU 45MOVE "36-45" TO EDAD-RANGOMOVE "36-45" TO EDAD-RANGOWHEN 46 THRU 55WHEN 46 THRU 55MOVE "46-55" TO EDAD-RANGOMOVE "46-55" TO EDAD-RANGOWHEN 56 THRU 65WHEN 56 THRU 65MOVE "56-65" TO EDAD-RANGOMOVE "56-65" TO EDAD-RANGOWHEN 56 THRU 65WHEN 56 THRU 65MOVE "56-65" TO EDAD-RANGOMOVE "56-65" TO EDAD-RANGOWHEN 66 THRU 999WHEN 66 THRU 999MOVE "66+  " TO EDAD-RANGOMOVE "66+  " TO EDAD-RANGOWHEN ANYWHEN ANYMOVE " N/A " TO EDAD-RANGOMOVE " N/A " TO EDAD-RANGOEND-EVALUATE.END-EVALUATE.
********************************************************************************************************************************
*510-ESCRIBIR-INCONS.*510-ESCRIBIR-INCONS.
* BUSCA ERROR* BUSCA ERROR
* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS
********************************************************************************************************************************
510-ESCRIBIR-INCONS.510-ESCRIBIR-INCONS.IF CODIGO-ERROR = 02 AND SW-ERROR = 1IF CODIGO-ERROR = 02 AND SW-ERROR = 1MOVE TIPOID-E TO TIP-INC.MOVE TIPOID-E TO TIP-INC.IF SW-ERROR = 1IF SW-ERROR = 1PERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONS.WRITE REG-INCONS.****************************************************************************************************************************
*512-CREE-REGISTRO.*512-CREE-REGISTRO.
* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC
****************************************************************************************************************************
512-CREE-REGISTRO.512-CREE-REGISTRO.MOVE TIPOID-E TO TIP-INCMOVE TIPOID-E TO TIP-INCMOVE NUMID-E  TO CED-INCFAC0019MOVE NUMID-E  TO CED-INCFAC0019MOVE NOMBRE-E TO NOM1-INCMOVE NOMBRE-E TO NOM1-INCIF CODIGO-ERROR = 02 OR 01 OR 06 OR 07IF CODIGO-ERROR = 02 OR 01 OR 06 OR 07MOVE NOM-VAL-BDIIVIDE TO NOM2-INCMOVE NOM-VAL-BDIIVIDE TO NOM2-INCELSEELSEMOVE SPACESTO NOM2-INCMOVE SPACESTO NOM2-INCMUN-EXP-INCMUN-EXP-INCDEP-EXP-INCDEP-EXP-INCVIG-INCVIG-INCMOVE ZEROSTO FEC-EXP-INCMOVE ZEROSTO FEC-EXP-INCMOVE FILLER-2-E  TO FILLER-2-INCMOVE FILLER-2-E  TO FILLER-2-INCEND-IF.END-IF.****************************************************************************************************************************
*513-VALIDA-EN-CSV.*513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA*    ALTERNA
****************************************************************************************************************************
513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacionREQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEREQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDEREQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-IDREQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROSIF OPEN-DIR = ZEROSOPEN INPUT MAESTRO-DIRECCOPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLIOPEN INPUT BDLCLIOPEN INPUT SUSCRIPTOROPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIRMOVE 1 TO OPEN-DIREND-IFEND-IFMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSMOVE 1 TO HACERMATCH-LEEMSTRS
REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008
REQ609IF TIPOID-E = 1 OR 4LAG0008REQ609IF TIPOID-E = 1 OR 4LAG0008
REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008
REQ609"," BY " ", ";" BY " "LAG0008REQ609"," BY " ", ";" BY " "LAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008
REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008
REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008
REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008
REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008
REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008
REQ609ELSELAG0008REQ609ELSELAG0008
R7094AIF W-BLOQUES > 0RMB0009R7094AIF W-BLOQUES > 0RMB0009
R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009
R7094AEND-IFRMB0009R7094AEND-IFRMB0009
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E  TO CED-VALMOVE NUMID-E  TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS    TO FEC-EXP-VALMOVE ZEROS    TO FEC-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGOMOVE SPACES   TO EDAD-RANGO
PAM460*MOVE "A"TO ORIGEN-VAL|  PJV012MOVE "A"TO ORIGEN-VALCQ12657
PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407
PJV011ADD 1 TO SI-EXISTE-CSVCQ11407PJV011ADD 1 TO SI-EXISTE-CSVCQ11407END-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
*9800-FILTRAR-ALFABETICO.**9800-FILTRAR-ALFABETICO.*
*    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA**    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
***************************************************************************************************************************************800-GRABAR-SECUENCIAL.*800-GRABAR-SECUENCIAL.
* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL
* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-
* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN
* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION
**************************************************************************************************************************************
800-GRABAR-SECUENCIAL.800-GRABAR-SECUENCIAL.INITIALIZE REG-SECINITIALIZE REG-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE ZEROSTO TIP-ID-SECMOVE ZEROSTO TIP-ID-SECMOVE W-TARIFATO NUM-TERM-SECMOVE W-TARIFATO NUM-TERM-SECMOVE 2TO COBRA-SECMOVE 2TO COBRA-SECMOVE 1TO PRIV-SECMOVE 1TO PRIV-SECMOVE " "TO SBPRIV-SECMOVE " "TO SBPRIV-SECMOVE 2TO PRODU-SECMOVE 2TO PRODU-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZEROSTO TABLA-SCOR-SECMOVE ZEROSTO TABLA-SCOR-SECACCEPT TIEMPO-WFROM TIMEACCEPT TIEMPO-WFROM TIMEMOVE TIEMPO-W(1:6)     TO HORA-SECMOVE TIEMPO-W(1:6)     TO HORA-SECIF W-CONT-TIPO-5>  ZEROSIF W-CONT-TIPO-5>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE 5  TO TIP-CON-SECMOVE 5  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IFEND-IFIF W-CONT-TIPO-6>  ZEROSIF W-CONT-TIPO-6>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-6  TO NUM-ID-SECMOVE W-CONT-TIPO-6  TO NUM-ID-SECMOVE 6  TO TIP-CON-SECMOVE 6  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IFEND-IFIF W-CONT-TIPO-7>  ZEROSIF W-CONT-TIPO-7>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE 7  TO TIP-CON-SECMOVE 7  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IF.END-IF.
**********************************************************************************************************************************
*810-BUSCAR-MUNICIPIO.*810-BUSCAR-MUNICIPIO.
* OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-* OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-
* NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS* NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS
**********************************************************************************************************************************
810-BUSCAR-MUNICIPIO.810-BUSCAR-MUNICIPIO.MOVE DEP-EXP-BDIIREGI TO CODIGO-DEPMOVE DEP-EXP-BDIIREGI TO CODIGO-DEPMOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNIMOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNIREAD MUNICIPIOS INVALID KEYREAD MUNICIPIOS INVALID KEYMOVE SPACES TO NOMBRE-MUNIMOVE SPACES TO NOMBRE-MUNIMOVE 71     TO CODIGO-DEPMOVE 71     TO CODIGO-DEPEND-READEND-READMOVE NOMBRE-MUNITO MUN-EXP-VAL MUN-EXP-INCMOVE NOMBRE-MUNITO MUN-EXP-VAL MUN-EXP-INCMOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.MOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.
**************************************************************************************************************************************
*900-CERRAR-ARCHIVOS.*900-CERRAR-ARCHIVOS.
* CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN* CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN
* ESTAN ABIERTOS* ESTAN ABIERTOS
**********************************************************************************************************************************
900-CERRAR-ARCHIVOS.900-CERRAR-ARCHIVOS.DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS
PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
R7094B     DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSRMB0009R7094B     DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSRMB0009DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDODISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOCLOSE ENTRADACLOSE ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIREGIBDIIREGIMUNICIPIOSMUNICIPIOSSECUENCIALSECUENCIALVALIDASVALIDAS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407INCONS.INCONS.
**********************************************************************************************************************************COPY BDIIVIDE.PROC.COPY BDIIVIDE.PROC.COPY LEEMAESTROS.PROC.COPY LEEMAESTROS.PROC.COPY BDLDIR.PROC.COPY BDLDIR.PROC.
CQ6271     COPY LOGPESVNO.PROC.PJV0010CQ6271     COPY LOGPESVNO.PROC.PJV0010
~
~
~
~COPY BDLDIR.PROC.COPY BDLDIR.PROC.
CQ6271     COPY LOGPESVNO.PROC.PJV0010CQ6271     COPY LOGPESVNO.PROC.PJV0010
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IFEND-IFIF W-CONT-TIPO-7>  ZEROSIF W-CONT-TIPO-7>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE W-CONT-TIPO-7  TO NUM-ID-SECMOVE 7  TO TIP-CON-SECMOVE 7  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IF.END-IF.
**********************************************************************************************************************************
*810-BUSCAR-MUNICIPIO.*810-BUSCAR-MUNICIPIO.
* OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-* OBTIENE EL NOMBRE DEL MUNICIPIO Y EL DEPARTAMENTO AL QUE PERTE-
* NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS* NECE CON EL FIN DE ALIMENTAR EL ARCHIVO DE VALIDAS
**********************************************************************************************************************************
810-BUSCAR-MUNICIPIO.810-BUSCAR-MUNICIPIO.MOVE DEP-EXP-BDIIREGI TO CODIGO-DEPMOVE DEP-EXP-BDIIREGI TO CODIGO-DEPMOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNIMOVE MUNIC-EXP-BDIIREGI TO CODIGO-MUNIREAD MUNICIPIOS INVALID KEYREAD MUNICIPIOS INVALID KEYMOVE SPACES TO NOMBRE-MUNIMOVE SPACES TO NOMBRE-MUNIMOVE 71     TO CODIGO-DEPMOVE 71     TO CODIGO-DEPEND-READEND-READMOVE NOMBRE-MUNITO MUN-EXP-VAL MUN-EXP-INCMOVE NOMBRE-MUNITO MUN-EXP-VAL MUN-EXP-INCMOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.MOVE T-NOM-DEP(CODIGO-DEP) TO DEP-EXP-VAL DEP-EXP-INC.
**************************************************************************************************************************************
*900-CERRAR-ARCHIVOS.*900-CERRAR-ARCHIVOS.
* CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN* CIERRA CADA UNO DE LOS ARCHIVO UTILIZADOS EN EL PROGRMA QUE AUN
* ESTAN ABIERTOS* ESTAN ABIERTOS
**********************************************************************************************************************************
900-CERRAR-ARCHIVOS.900-CERRAR-ARCHIVOS.DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS
PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407PJV011     DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R  CQ11407DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
R7094B     DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSRMB0009R7094B     DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSRMB0009DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDODISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOCLOSE ENTRADACLOSE ENTRADABDIIDIANBDIIDIANBDIIDASBDIIDASBDIIREGIBDIIREGIMUNICIPIOSMUNICIPIOSSECUENCIALSECUENCIALVALIDASVALIDAS
PJV011VALIDAS-REPCQ11407PJV011VALIDAS-REPCQ11407INCONS.INCONS.
**********************************************************************************************************************************COPY BDIIVIDE.PROC.COPY BDIIVIDE.PROC.COPY LEEMAESTROS.PROC.COPY LEEMAESTROS.PROC.*************************************************************************************************************************************9800-FILTRAR-ALFABETICO.**9800-FILTRAR-ALFABETICO.*
*    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA**    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
***************************************************************************************************************************************800-GRABAR-SECUENCIAL.*800-GRABAR-SECUENCIAL.
* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL
* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-
* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN
* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION
**************************************************************************************************************************************
800-GRABAR-SECUENCIAL.800-GRABAR-SECUENCIAL.INITIALIZE REG-SECINITIALIZE REG-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE ZEROSTO TIP-ID-SECMOVE ZEROSTO TIP-ID-SECMOVE W-TARIFATO NUM-TERM-SECMOVE W-TARIFATO NUM-TERM-SECMOVE 2TO COBRA-SECMOVE 2TO COBRA-SECMOVE 1TO PRIV-SECMOVE 1TO PRIV-SECMOVE " "TO SBPRIV-SECMOVE " "TO SBPRIV-SECMOVE 2TO PRODU-SECMOVE 2TO PRODU-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZEROSTO TABLA-SCOR-SECMOVE ZEROSTO TABLA-SCOR-SECACCEPT TIEMPO-WFROM TIMEACCEPT TIEMPO-WFROM TIMEMOVE TIEMPO-W(1:6)     TO HORA-SECMOVE TIEMPO-W(1:6)     TO HORA-SECIF W-CONT-TIPO-5>  ZEROSIF W-CONT-TIPO-5>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE 5  TO TIP-CON-SECMOVE 5  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SEC
XXXXXX*END-WRITEXXXXXX*END-WRITEEND-IFEND-IFIF W-CONT-TIPO-6>  ZEROSIF W-CONT-TIPO-6>  ZEROSADD 1 TO LLAVE7ADD 1 TO LLAVE7MOVE LLAVE7 TO LLAVE-SECMOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-6  TO NUM-ID-SECMOVE W-CONT-TIPO-6  TO NUM-ID-SECMOVE 6  TO TIP-CON-SECMOVE 6  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEYXXXXXX*WRITE REG-SEC INVALID KEY
XXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECXXXXXX*DISPLAY " ERROR ESCRIBIENDO ICBTCO:  " LLAVE-SECREQ550     IF SW-TID-BDIIVIDE = 0REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROSIF OPEN-DIR = ZEROSOPEN INPUT MAESTRO-DIRECCOPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLIOPEN INPUT BDLCLIOPEN INPUT SUSCRIPTOROPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIRMOVE 1 TO OPEN-DIREND-IFEND-IFMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSMOVE 1 TO HACERMATCH-LEEMSTRS
REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008
REQ609IF TIPOID-E = 1 OR 4LAG0008REQ609IF TIPOID-E = 1 OR 4LAG0008
REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008
REQ609"," BY " ", ";" BY " "LAG0008REQ609"," BY " ", ";" BY " "LAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008
REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008
REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008
REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008
REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008
REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008
REQ609ELSELAG0008REQ609ELSELAG0008
R7094AIF W-BLOQUES > 0RMB0009R7094AIF W-BLOQUES > 0RMB0009
R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009
R7094AEND-IFRMB0009R7094AEND-IFRMB0009
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E  TO CED-VALMOVE NUMID-E  TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS    TO FEC-EXP-VALMOVE ZEROS    TO FEC-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGOMOVE SPACES   TO EDAD-RANGO
PAM460*MOVE "A"TO ORIGEN-VAL|  PJV012MOVE "A"TO ORIGEN-VALCQ12657
PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407
PJV011ADD 1 TO SI-EXISTE-CSVCQ11407PJV011ADD 1 TO SI-EXISTE-CSVCQ11407END-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
*9800-FILTRAR-ALFABETICO.**9800-FILTRAR-ALFABETICO.*WHEN 29 THRU 35WHEN 29 THRU 35MOVE "29-35" TO EDAD-RANGOMOVE "29-35" TO EDAD-RANGOWHEN 36 THRU 45WHEN 36 THRU 45MOVE "36-45" TO EDAD-RANGOMOVE "36-45" TO EDAD-RANGOWHEN 46 THRU 55WHEN 46 THRU 55MOVE "46-55" TO EDAD-RANGOMOVE "46-55" TO EDAD-RANGOWHEN 56 THRU 65WHEN 56 THRU 65MOVE "56-65" TO EDAD-RANGOMOVE "56-65" TO EDAD-RANGOWHEN 66 THRU 999WHEN 66 THRU 999MOVE "66+  " TO EDAD-RANGOMOVE "66+  " TO EDAD-RANGOWHEN ANYWHEN ANYMOVE " N/A " TO EDAD-RANGOMOVE " N/A " TO EDAD-RANGOEND-EVALUATE.END-EVALUATE.
********************************************************************************************************************************
*510-ESCRIBIR-INCONS.*510-ESCRIBIR-INCONS.
* BUSCA ERROR* BUSCA ERROR
* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS* CREAR REGISTRO EN EL ARCHIVO DE INCONSISTENCIAS
********************************************************************************************************************************
510-ESCRIBIR-INCONS.510-ESCRIBIR-INCONS.IF CODIGO-ERROR = 02 AND SW-ERROR = 1IF CODIGO-ERROR = 02 AND SW-ERROR = 1MOVE TIPOID-E TO TIP-INC.MOVE TIPOID-E TO TIP-INC.IF SW-ERROR = 1IF SW-ERROR = 1PERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONS.WRITE REG-INCONS.****************************************************************************************************************************
*512-CREE-REGISTRO.*512-CREE-REGISTRO.
* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC
****************************************************************************************************************************
512-CREE-REGISTRO.512-CREE-REGISTRO.MOVE TIPOID-E TO TIP-INCMOVE TIPOID-E TO TIP-INCMOVE NUMID-E  TO CED-INCFAC0019MOVE NUMID-E  TO CED-INCFAC0019MOVE NOMBRE-E TO NOM1-INCMOVE NOMBRE-E TO NOM1-INCIF CODIGO-ERROR = 02 OR 01 OR 06 OR 07IF CODIGO-ERROR = 02 OR 01 OR 06 OR 07MOVE NOM-VAL-BDIIVIDE TO NOM2-INCMOVE NOM-VAL-BDIIVIDE TO NOM2-INCELSEELSEMOVE SPACESTO NOM2-INCMOVE SPACESTO NOM2-INCMUN-EXP-INCMUN-EXP-INCDEP-EXP-INCDEP-EXP-INCVIG-INCVIG-INCMOVE ZEROSTO FEC-EXP-INCMOVE ZEROSTO FEC-EXP-INCMOVE FILLER-2-E  TO FILLER-2-INCMOVE FILLER-2-E  TO FILLER-2-INCEND-IF.END-IF.****************************************************************************************************************************
*513-VALIDA-EN-CSV.*513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA*    ALTERNA
****************************************************************************************************************************
513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacionREQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEREQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDEREQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-IDREQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSEND-IFEND-IFEND-IFEND-IFREAD ENTRADAREAD ENTRADAAT ENDAT ENDMOVE 1 TO FIN-ENTRADAMOVE 1 TO FIN-ENTRADANOT AT ENDNOT AT ENDINSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READ.END-READ.

PJV011 300-GRABA-VALREP.CQ11407PJV011 300-GRABA-VALREP.CQ11407
PJV011     INITIALIZE REG-VALIDAS-REPCQ11407PJV011     INITIALIZE REG-VALIDAS-REPCQ11407
PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDASCQ11407PJV011     WRITE REG-VALIDAS-REP FROM REG-VALIDASCQ11407
PJV011     MOVE TIP-VAL TO TIP-KEYVALCQ11407PJV011     MOVE TIP-VAL TO TIP-KEYVALCQ11407
PJV011     MOVE CED-VAL TO NUM-KEYVALCQ11407PJV011     MOVE CED-VAL TO NUM-KEYVALCQ11407
PJV011     ADD 1 TO REG-CORRECTOS-R  .CQ11407PJV011     ADD 1 TO REG-CORRECTOS-R  .CQ11407

PJV011 301-GRABA-LOS-VALIDOS.CQ11407PJV011 301-GRABA-LOS-VALIDOS.CQ11407
PJV011     MOVE "N" TO SN-VALREPCQ11407PJV011     MOVE "N" TO SN-VALREPCQ11407
PJV011     IF TIP-KEYVAL = TIPOID-E ANDCQ11407PJV011     IF TIP-KEYVAL = TIPOID-E ANDCQ11407
PJV011NUM-KEYVAL = NUMID-ECQ11407PJV011NUM-KEYVAL = NUMID-ECQ11407
PJV011MOVE "S" TO SN-VALREPCQ11407PJV011MOVE "S" TO SN-VALREPCQ11407
PJV011PERFORM 300-GRABA-VALREPCQ11407PJV011PERFORM 300-GRABA-VALREPCQ11407
PJV011     ELSECQ11407PJV011     ELSECQ11407
PJV011WRITE REG-VALIDASCQ11407PJV011WRITE REG-VALIDASCQ11407
PJV011MOVE TIP-VAL TO TIP-KEYVALCQ11407PJV011MOVE TIP-VAL TO TIP-KEYVALCQ11407
PJV011MOVE CED-VAL TO NUM-KEYVALCQ11407PJV011MOVE CED-VAL TO NUM-KEYVALCQ11407
PJV011ADD 1 TO REG-CORRECTOSCQ11407PJV011ADD 1 TO REG-CORRECTOSCQ11407
PJV011     END-IF.CQ11407PJV011     END-IF.CQ11407505-RANGO-EDADES.505-RANGO-EDADES.
*--------------------------------------------------**--------------------------------------------------*
*505-RANGO-EDADES.*505-RANGO-EDADES.
*  RANGO MUJERES: 20'000.001 A 70'000.000*  RANGO MUJERES: 20'000.001 A 70'000.000
*  RANGO HOMBRES:1 A 20'000.000*  RANGO HOMBRES:1 A 20'000.000
*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)*MAYOR  : > 70'000.000 < 1000'000.000 (NUIPS)
*--------------------------------------------------**--------------------------------------------------*MOVE FEC-EXP-VALTO  W-FEC-EXPEMOVE FEC-EXP-VALTO  W-FEC-EXPEMOVE ZEROSTO  W-EDAD-CEDULAMOVE ZEROSTO  W-EDAD-CEDULAIF W-ANO-EXPE >= 1975IF W-ANO-EXPE >= 1975COMPUTE W-EDAD-CEDULA =COMPUTE W-EDAD-CEDULA =((W-ANO-ACTUAL - W-ANO-EXPE) + 18)((W-ANO-ACTUAL - W-ANO-EXPE) + 18)ELSEELSECOMPUTE W-EDAD-CEDULA =COMPUTE W-EDAD-CEDULA =((W-ANO-ACTUAL - W-ANO-EXPE) + 21)((W-ANO-ACTUAL - W-ANO-EXPE) + 21)END-IFEND-IFMOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDADMOVE  W-EDAD-CEDULA    TO  EDAD-VAL WS-EDADMOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.MOVE  FILLER-2-E TO FILLER-2-VAL FILLER-2-INC.EVALUATE WS-EDADEVALUATE WS-EDADWHEN 18 THRU 21WHEN 18 THRU 21MOVE "18-21" TO EDAD-RANGOMOVE "18-21" TO EDAD-RANGOWHEN 22 THRU 28WHEN 22 THRU 28MOVE "22-28" TO EDAD-RANGOMOVE "22-28" TO EDAD-RANGOWHEN 29 THRU 35WHEN 29 THRU 35MOVE "29-35" TO EDAD-RANGOMOVE "29-35" TO EDAD-RANGOMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE TIPOID-E TO TIP-VAL TIP-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE NUMID-E  TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE FECHA-2000 TO FEC-EXP-VALMOVE FECHA-2000 TO FEC-EXP-VALFEC-EXP-INCFEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00" TO VIG-VAL VIG-INCMOVE "00" TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VALMOVE ESTADO-VIG-BDIIREGI TO VIG-VALVIG-INCVIG-INCEND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADES
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE   "O"TO ORIGEN-VAL|  PJV012MOVE   "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFELSEELSEIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE ZEROSTO VIG-VALMOVE ZEROSTO VIG-VALEND-IFEND-IFMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE NUMID-ETO CED-VAL CED-INCMOVE NUMID-ETO CED-VAL CED-INC
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE    "O"TO ORIGEN-VAL|  PJV012MOVE    "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFIF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD  1 TO W-CONT-TIPO-6ADD  1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1  TO W-CONT-TIPO-7ADD 1  TO W-CONT-TIPO-7ELSEELSE
PJV011IF SN-VALREP = "S"CQ11407PJV011IF SN-VALREP = "S"CQ11407
PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407
PJV011ELSECQ11407PJV011ELSECQ11407ADD 1  TO W-CONT-TIPO-5ADD 1  TO W-CONT-TIPO-5
PJV011END-IFCQ11407PJV011END-IFCQ11407
CQ6271IF TIPOID-E = 2 OR 3PJV0010CQ6271IF TIPOID-E = 2 OR 3PJV0010
CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010
CQ6271END-IFPJV0010CQ6271END-IFPJV0010END-IFEND-IFEND-IFEND-IF
/cq12657REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008
REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008
REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008
REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008
REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008
REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008
REQ609ELSELAG0008REQ609ELSELAG0008
R7094AIF W-BLOQUES > 0RMB0009R7094AIF W-BLOQUES > 0RMB0009
R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009R7094AMOVE 0 TO IDE-TIPO-BDAMATCHRMB0009
R7094AEND-IFRMB0009R7094AEND-IFRMB0009
REQ609END-IFLAG0008REQ609END-IFLAG0008
REQ609END-IFLAG0008REQ609END-IFLAG0008IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E  TO CED-VALMOVE NUMID-E  TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS    TO FEC-EXP-VALMOVE ZEROS    TO FEC-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGOMOVE SPACES   TO EDAD-RANGO
PAM460*MOVE "A"TO ORIGEN-VAL|  PJV012MOVE "A"TO ORIGEN-VALCQ12657
PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM  301-GRABA-LOS-VALIDOSCQ11407
PJV011ADD 1 TO SI-EXISTE-CSVCQ11407PJV011ADD 1 TO SI-EXISTE-CSVCQ11407END-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
*9800-FILTRAR-ALFABETICO.**9800-FILTRAR-ALFABETICO.*
*    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA**    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
***************************************************************************************************************************************800-GRABAR-SECUENCIAL.*800-GRABAR-SECUENCIAL.
* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL
* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-
* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN
* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION
**************************************************************************************************************************************?END-IFEND-IFMOVE FECHA-2000 TO FEC-EXP-VALMOVE FECHA-2000 TO FEC-EXP-VALFEC-EXP-INCFEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00" TO VIG-VAL VIG-INCMOVE "00" TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VALMOVE ESTADO-VIG-BDIIREGI TO VIG-VALVIG-INCVIG-INCEND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADES
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE   "O"TO ORIGEN-VAL|  PJV012MOVE   "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFELSEELSEIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE NACIO-BDIIDAS   TO MUN-EXP-VALMOVE ZEROSTO VIG-VALMOVE ZEROSTO VIG-VALEND-IFEND-IFMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE NOM-VAL-BDIIVIDE TO NOM-VALMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE TIPOID-ETO TIP-VAL TIP-INCMOVE NUMID-ETO CED-VAL CED-INCMOVE NUMID-ETO CED-VAL CED-INC
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE    "O"TO ORIGEN-VAL|  PJV012MOVE    "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407PJV011PERFORM 301-GRABA-LOS-VALIDOSCQ11407END-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFEND-IFIF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD  1 TO W-CONT-TIPO-6ADD  1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1  TO W-CONT-TIPO-7ADD 1  TO W-CONT-TIPO-7ELSEELSE
PJV011IF SN-VALREP = "S"CQ11407PJV011IF SN-VALREP = "S"CQ11407
PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407PJV011ADD 1  TO W-CONT-TIPO-5-REPCQ11407
PJV011ELSECQ11407PJV011ELSECQ11407ADD 1  TO W-CONT-TIPO-5ADD 1  TO W-CONT-TIPO-5
PJV011END-IFCQ11407PJV011END-IFCQ11407
CQ6271IF TIPOID-E = 2 OR 3PJV0010CQ6271IF TIPOID-E = 2 OR 3PJV0010
CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010CQ6271ADD 1 TO W-CONT-TIPO-5-PJPJV0010
CQ6271END-IFPJV0010CQ6271END-IFPJV0010END-IFEND-IFEND-IFEND-IFREAD ENTRADAREAD ENTRADAAT ENDAT ENDMOVE 1 TO FIN-ENTRADAMOVE 1 TO FIN-ENTRADANOT AT ENDNOT AT ENDINSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT  NUMID-X-E REPLACING ALL " " BY "0"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"INSPECT TIPOID-X-E REPLACING ALL "0" BY "1"END-READ.END-READ.* PESVNOCSV.V.01.0011|* PESVNOCSVPLUS.V.01.0013IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.DATE-COMPILED.
************************************************************************************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE** PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.* EXTRANJERIA.
**
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
**
* Cliente : Datacredito* Cliente : Datacredito
**
* Version : 09/06/2008 09:08:25 a.m.* Version : 09/06/2008 09:08:25 a.m.
************************************************************************************************************************************
*  Validacion especial tomando el archivo de*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final*  Cuentas Sin Validar para poder reportalos en el informe final
**
************************************************************************************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIASREMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNOREMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*REMARK* SEPT. 30/2009*
REMARK*******************************************************************REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**REMARK* GRACIELA JIM.**
REMARK******************************************************************REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **REMARK* G.DESARROLLO **
REMARK******************************************************************REMARK******************************************************************
************************************************************************************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A ** GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.** FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   ** EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS** MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     ** LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1** OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     ** LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA** OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   ** RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
* AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS** AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS*
* GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO ** GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *
*| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     **| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
************************************************************************************************************************************
* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.*
* SEP-01-2012|** SEP-01-2012|*/* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES*
* ABR-02-2013| REPETIDAS VALIDAS.** ABR-02-2013| REPETIDAS VALIDAS.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
>* PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES*
>* JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
>* PEDRO V.   |*
>******************************************************************
>* STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
>* JUL-31-2013|*
>* LUIS GOMEZ |*
>******************************************************************
**
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
CONFIGURATION SECTION.CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.OBJECT-COMPUTER. MICROFOCUS.INPUT-OUTPUT SECTION.INPUT-OUTPUT SECTION.:q/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi qqqsdiff -w 170 PESVNO.CBL PESVNOCSVPLUS.CBL >| qqq/d/iccol/desarrollo/fuentes>                                                /d/iccol/desarrollo/fuentes>ls -l PASVNO*      ESVNO*
-rw-rw-r--   1 1368     icdatacr   47036 Sep 19  2007 PESVNO-1.CBL
-rw-rw-r--   1 icjdld   icdatacr   57581 Mar 11  2010 PESVNO-20090602.CBL
-rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL
-rw-rw-r--   1 iccavd   icdatacr   44911 Jul 11  2012 PESVNO-CV.CBL
-rw-rw-r--   1 iccavd   icdatacr   45386 Jul 10  2012 PESVNO-DIGITO.CBL
-rw-rw-r--   1 icfacd   icdatacr   43588 Mar  7  2005 PESVNO-ECU.CBL
-rw-rw-r--   1 icjdld   icdatacr   57587 Mar 11  2010 PESVNO-NOCSV.CBL
-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL
-rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL
-rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL
-rw-rw-r--   1 1381     icdatacr   43331 Oct 14  2010 PESVNO.CBL-20101014
-rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO.CBL-lag
-rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL
-rw-rw-r--   1 1395     icdatacr   45379 Jul 12  2012 PESVNO64.CBL
-rw-rw-r--   1 1366     icdatacr   35713 Oct  7  2009 PESVNOCE.CBL
-rw-rw-r--   1 1395     icdatacr   59253 Sep 10  2012 PESVNOCITI.CBL
-rw-rw-r--   1 icjdld   icdatacr   53372 Mar 11  2010 PESVNOconICBTCO.CBL
-rw-rw-r--   1 1395     icdatacr   43503 Jul  9  2012 PESVNOCSV_cg.CBL
-rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL
-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
-rw-rw-r--   1 icjdld   icdatacr   40962 Mar 11  2010 PESVNOCSV.CBL-lag
-rw-rw-r--   1 1366     icdatacr   39435 Jun  9  2008 PESVNOCSV.CBL-ORI
-rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
-rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
-rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
-rw-rw-r--   1 1395     icdatacr  141824 May 28  2013 PESVNOCSVBCS.int
-rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
-rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL
-rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL
-rw-rw-r--   1 icjdld   icdatacr   42921 Mar 11  2010 PESVNOCSVFNG.CBL-lag
-rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL
-rw-rw-r--   1 icjdld   icdatacr   40771 Mar 11  2010 PESVNOCSVPLUS.CBL-lag
-rw-rw-r--   1 1395     icdatacr   48311 Jun 25  2013 PESVNOCSVPLUSc.CBL
-rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL
-rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
-rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL
-rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL
-rw-rw-r--   1 1395     icdatacr  361326 Sep 10  2012 PESVNOCSVSEGE.CBL
-rw-rw-r--   1 1381     icdatacr  344103 Mar 16  2011 PESVNOCSVSEGE.CBL-bckup
-rw-rw-r--   1 1381     icdatacr  282678 Nov 19  2010 PESVNOCSVSEGE.CBL-V01
-rw-rw-r--   1 1381     icdatacr  149760 Mar 23  2011 PESVNOCSVSEGE.int
-rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL
-rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
-rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL
-rw-rw-r--   1 icjdld   icdatacr   41290 Mar 11  2010 PESVNOGJ.CBL
-rw-rw-r--   1 icjdld   icdatacr   53516 Mar 11  2010 PESVNONEWNOM.CBL
-rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
-rw-rw-r--   1 1366     icdatacr   45867 Apr 16  2007 PESVNOPE.CBL
-rw-rw-r--   1 icrmbd   icdatacr   47985 Aug 15  2012 PESVNOPEO.CBL
-rw-rw-r--   1 icrmbd   icdatacr   84480 Aug  6  2012 PESVNOPEO.int
-rw-rw-r--   1 icjdld   icdatacr   57587 Mar 11  2010 PESVNOPLUS.CBL
-rw-rw-r--   1 1395     icdatacr   45379 Aug 14  2012 PESVNOpv.CBL
-rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL
-rw-rw-r--   1 1381     icdatacr  182116 Aug  8  2010 PESVNORMB.CBL-bckup
-rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
-rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
-rw-rw-r--   1 1381     icdatacr  187463 Aug 13  2010 PESVNORMBNW.CBL-20100813
-rw-rw-r--   1 1381     icdatacr  184036 Aug 12  2010 PESVNORMBNW.CBL-bckup
-rw-rw-r--   1 1381     icdatacr  184307 Aug 13  2010 PESVNORMBNW.CBL-bckupM
-rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW.CBL-bk-20100812
-rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
-rw-rw-r--   1 icjdld   icdatacr   63180 Mar 11  2010 PESVNOSGESTDO.CBL
-rw-rw-r--   1 1381     icdatacr   60693 May  7  2009 PESVNOSGESTDO.CBL-lag2
-rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL
-rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL
-rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>ls -l PESVNO*ls -l PESVNO*- .CBL
-rw-rw-r--   1 1368     icdatacr   47036 Sep 19  2007 PESVNO-1.CBL
-rw-rw-r--   1 icjdld   icdatacr   57581 Mar 11  2010 PESVNO-20090602.CBL
-rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL
-rw-rw-r--   1 iccavd   icdatacr   44911 Jul 11  2012 PESVNO-CV.CBL
-rw-rw-r--   1 iccavd   icdatacr   45386 Jul 10  2012 PESVNO-DIGITO.CBL
-rw-rw-r--   1 icfacd   icdatacr   43588 Mar  7  2005 PESVNO-ECU.CBL
-rw-rw-r--   1 icjdld   icdatacr   57587 Mar 11  2010 PESVNO-NOCSV.CBL
-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL
-rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL
-rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL
-rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL
-rw-rw-r--   1 1395     icdatacr   45379 Jul 12  2012 PESVNO64.CBL
-rw-rw-r--   1 1366     icdatacr   35713 Oct  7  2009 PESVNOCE.CBL
-rw-rw-r--   1 1395     icdatacr   59253 Sep 10  2012 PESVNOCITI.CBL
-rw-rw-r--   1 icjdld   icdatacr   53372 Mar 11  2010 PESVNOconICBTCO.CBL
-rw-rw-r--   1 1395     icdatacr   43503 Jul  9  2012 PESVNOCSV_cg.CBL
-rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL
-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
-rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
-rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
-rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
-rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
-rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL
-rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL
-rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL
-rw-rw-r--   1 1395     icdatacr   48311 Jun 25  2013 PESVNOCSVPLUSc.CBL
-rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL
-rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
-rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL
-rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL
-rw-rw-r--   1 1395     icdatacr  361326 Sep 10  2012 PESVNOCSVSEGE.CBL
-rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL
-rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
-rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL
-rw-rw-r--   1 icjdld   icdatacr   41290 Mar 11  2010 PESVNOGJ.CBL
-rw-rw-r--   1 icjdld   icdatacr   53516 Mar 11  2010 PESVNONEWNOM.CBL
-rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
-rw-rw-r--   1 1366     icdatacr   45867 Apr 16  2007 PESVNOPE.CBL
-rw-rw-r--   1 icrmbd   icdatacr   47985 Aug 15  2012 PESVNOPEO.CBL
-rw-rw-r--   1 icjdld   icdatacr   57587 Mar 11  2010 PESVNOPLUS.CBL
-rw-rw-r--   1 1395     icdatacr   45379 Aug 14  2012 PESVNOpv.CBL
-rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL
-rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
-rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
-rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
-rw-rw-r--   1 icjdld   icdatacr   63180 Mar 11  2010 PESVNOSGESTDO.CBL
-rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL
-rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL
-rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>ls -l PESVNO*.CBLls -l PESVNO*    vi qqq       sdiff -w 170 PESVNO.CBL PESVNOCSVPLUS.CBL >| qqq/d/iccol/desarrollo/fuentes>vi qqq                                          /d/iccol/desarrollo/fuentes>ls -l PESVNO*vi qqq       
"qqq" 1078 lines, 145764 characters * PESVNOCSV.V.01.0011|* PESVNOCSVPLUS.V.01.0013IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.DATE-COMPILED.
************************************************************************************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE** PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.* EXTRANJERIA.
**
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
**
* Cliente : Datacredito* Cliente : Datacredito
**
* Version : 09/06/2008 09:08:25 a.m.* Version : 09/06/2008 09:08:25 a.m.
************************************************************************************************************************************
*  Validacion especial tomando el archivo de*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final*  Cuentas Sin Validar para poder reportalos en el informe final
**
************************************************************************************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIASREMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNOREMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*REMARK* SEPT. 30/2009*
REMARK*******************************************************************REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**REMARK* GRACIELA JIM.**
REMARK******************************************************************REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **REMARK* G.DESARROLLO **
REMARK******************************************************************REMARK******************************************************************
************************************************************************************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A ** GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.** FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   ** EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS** MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     ** LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1** OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     ** LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA** OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   ** RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
* AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS** AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS*
* GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO ** GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *
*| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     **| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
************************************************************************************************************************************
* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.*
* SEP-01-2012|** SEP-01-2012|*"qqq" 1078 lines, 145764 characters
OPEN MODE* GER.DESARR.|** GER.DESARR.|** PESVNOCSV.V.01.0011|* PESVNOCSVPLUS.V.01.0013
* GER.DESARR.|** GER.DESARR.|*

************************************************************************************************************************************


/........................................................................          

/
/* PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES************************************************************************************************************************************** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES*
* ABR-02-2013| REPETIDAS VALIDAS.** ABR-02-2013| REPETIDAS VALIDAS.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
>* PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES*
>* JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
>* PEDRO V.   |*
>******************************************************************
>* STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
>* JUL-31-2013|*
>* LUIS GOMEZ |*
>******************************************************************
**
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
CONFIGURATION SECTION.CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.INPUT-OUTPUT SECTION.COPY BDIIDIAN.FS.COPY BDIIDIAN.FS.COPY BDIIREGI.FS.COPY BDIIREGI.FS.COPY BDIIDAS.FS.COPY BDIIDAS.FS.COPY ICBTCO.FS.COPY ICBTCO.FS.COPY ICBCLA0001.FS.COPY ICBCLA0001.FS.COPY ICBCIU.FS.COPY ICBCIU.FS.
CTAST8*    COPY  ICBCHK.FS.GDT0005CTAST8*    COPY  ICBCHK.FS.GDT0005
CTAST8     COPY  ICBCHK0001.FS.GDT0005CTAST8     COPY  ICBCHK0001.FS.GDT0005COPY ICBCRE.FS.COPY ICBCRE.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY BDLCLI.FS.COPY BDLCLI.FS.COPY ICBDIR.FS.COPY ICBDIR.FS.COPY ICMUNI.FS.COPY ICMUNI.FS.COPY BDIIALE.FS.COPY BDIIALE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.COPY DIREST.FS.COPY DIREST.FS.COPY NOAMNISTIA21.FS.COPY NOAMNISTIA21.FS.COPY BDACSV.FS.COPY BDACSV.FS.SELECT ENTRADA  ASSIGN TO DISK W-ENTRADASELECT ENTRADA  ASSIGN TO DISK W-ENTRADAORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.SELECT VALIDAS  ASSIGN TO DISK W-VALIDASSELECT VALIDAS  ASSIGN TO DISK W-VALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.

PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407
PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407
PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407SELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.DATA DIVISION.DATA DIVISION./
/

/


////
           * FEB.09-2010|    FORMATO TIPO 8.** FEB.09-2010|    FORMATO TIPO 8.** GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   ** EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS** MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     ** LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1** OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     ** LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA** OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   ** RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
* AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS** AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS*
* GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO ** GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *
*| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     **| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
************************************************************************************************************************************
* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.*
* SEP-01-2012|** SEP-01-2012|*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES*
* ABR-02-2013| REPETIDAS VALIDAS.** ABR-02-2013| REPETIDAS VALIDAS.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
>* PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES*
>* JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
>* PEDRO V.   |*
>******************************************************************
>* STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
>* JUL-31-2013|*
>* LUIS GOMEZ |*
>******************************************************************
**
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
CONFIGURATION SECTION.CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.INPUT-OUTPUT SECTION.COPY BDIIDIAN.FS.COPY BDIIDIAN.FS.COPY BDIIREGI.FS.COPY BDIIREGI.FS.COPY BDIIDAS.FS.COPY BDIIDAS.FS.COPY ICBTCO.FS.COPY ICBTCO.FS.COPY ICBCLA0001.FS.COPY ICBCLA0001.FS.COPY ICBCIU.FS.COPY ICBCIU.FS.
CTAST8*    COPY  ICBCHK.FS.GDT0005CTAST8*    COPY  ICBCHK.FS.GDT0005
CTAST8     COPY  ICBCHK0001.FS.GDT0005CTAST8     COPY  ICBCHK0001.FS.GDT0005COPY ICBCRE.FS.COPY ICBCRE.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY BDLCLI.FS.COPY BDLCLI.FS.COPY ICBDIR.FS.COPY ICBDIR.FS.COPY ICMUNI.FS.COPY ICMUNI.FS.COPY BDIIALE.FS.COPY BDIIALE.FS.************************************************************************************************************************************* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE** PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.* EXTRANJERIA.
**
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
**
* Cliente : Datacredito* Cliente : Datacredito
**
* Version : 09/06/2008 09:08:25 a.m.* Version : 09/06/2008 09:08:25 a.m.
************************************************************************************************************************************
*  Validacion especial tomando el archivo de*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final*  Cuentas Sin Validar para poder reportalos en el informe final
**
************************************************************************************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIASREMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNOREMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*REMARK* SEPT. 30/2009*
REMARK*******************************************************************REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**REMARK* GRACIELA JIM.**
REMARK******************************************************************REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **REMARK* G.DESARROLLO **
REMARK******************************************************************REMARK******************************************************************
************************************************************************************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A ** GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.** FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   ** EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS** MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     ** LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1** OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     ** LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA** OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   ** RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
* AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS** AGO-06-2012| R7094B - DESPLEGAR CONTADOR DE FALLECIDOS*
* GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO ** GER.DESARR.| R7094C - SI BLOQUES = 1 NO SACAR SOLO EL APELLIDO *
*| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     **| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
************************************************************************************************************************************
* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.*
* SEP-01-2012|** SEP-01-2012|*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
* PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES*
* ABR-02-2013| REPETIDAS VALIDAS.** ABR-02-2013| REPETIDAS VALIDAS.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************DATE-COMPILED.DATE-COMPILED.DATE-WRITTEN. MAYO/2001.DATE-WRITTEN. MAYO/2001.AUTHOR. DATACREDITO.AUTHOR. DATACREDITO.PROGRAM-ID. PESVNO.PROGRAM-ID. PESVNO.IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.* PESVNOCSV.V.01.0011|* PESVNOCSVPLUS.V.01.0013

* GER.DESARR.|** GER.DESARR.|*

************************************************************************************************************************************


/..................................................................................         * PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** ABR-02-2013| REPETIDAS VALIDAS.** ABR-02-2013| REPETIDAS VALIDAS.*
* GER.DESARR.|** GER.DESARR.|*
************************************************************************************************************************************
>* PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES*
>* JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
>* PEDRO V.   |*
>******************************************************************
>* STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
>* JUL-31-2013|*
>* LUIS GOMEZ |*
>******************************************************************
**
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
CONFIGURATION SECTION.CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.INPUT-OUTPUT SECTION.COPY BDIIDIAN.FS.COPY BDIIDIAN.FS.COPY BDIIREGI.FS.COPY BDIIREGI.FS.COPY BDIIDAS.FS.COPY BDIIDAS.FS.COPY ICBTCO.FS.COPY ICBTCO.FS.COPY ICBCLA0001.FS.COPY ICBCLA0001.FS.COPY ICBCIU.FS.COPY ICBCIU.FS.
CTAST8*    COPY  ICBCHK.FS.GDT0005CTAST8*    COPY  ICBCHK.FS.GDT0005
CTAST8     COPY  ICBCHK0001.FS.GDT0005CTAST8     COPY  ICBCHK0001.FS.GDT0005COPY ICBCRE.FS.COPY ICBCRE.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY BDLCLI.FS.COPY BDLCLI.FS.COPY ICBDIR.FS.COPY ICBDIR.FS.COPY ICMUNI.FS.COPY ICMUNI.FS.COPY BDIIALE.FS.COPY BDIIALE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.COPY DIREST.FS.COPY DIREST.FS.COPY NOAMNISTIA21.FS.COPY NOAMNISTIA21.FS.COPY BDACSV.FS.COPY BDACSV.FS.SELECT ENTRADA  ASSIGN TO DISK W-ENTRADASELECT ENTRADA  ASSIGN TO DISK W-ENTRADAORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.SELECT VALIDAS  ASSIGN TO DISK W-VALIDASSELECT VALIDAS  ASSIGN TO DISK W-VALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.

PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407PJV011     SELECT VALIDAS-REP  ASSIGN TO DISK W-VALIDAS-REPCQ11407
PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407PJV011ORGANIZATION IS LINE SEQUENTIALCQ11407
PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407PJV011ACCESS MODE  IS SEQUENTIAL.CQ11407SELECT INCONS   ASSIGN TO DISK W-INVALIDASSELECT INCONS   ASSIGN TO DISK W-INVALIDASORGANIZATION IS LINE SEQUENTIALORGANIZATION IS LINE SEQUENTIALACCESS MODE  IS SEQUENTIAL.ACCESS MODE  IS SEQUENTIAL.DATA DIVISION.DATA DIVISION.
FILE SECTION.FILE SECTION.


//    [|><] :v//d>  STT013     03 FILLER-2-VALPIC X(650).CQ12837
PJV011     03 FILLER-2-VALREPPIC X(51).CQ11407     |  PJV012*    03 FILLER-2-VALREPPIC X(651).CQ12837
>  STT013     03 FILLER-2-VALREPPIC X(651).CQ12657
*DISPLAY "*-----------------------------------*"|  PJV012DISPLAY "*-----------------------------------*"CQ12657
*DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSV|  PJV012DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSVCQ12657
*DISPLAY "*------------------------------------*"|  PJV012DISPLAY "*------------------------------------*"CQ12657
R7094A*MOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     |  PJV012MOVE    1TO  SW-VERIFNOM-BDIIVIDECQ12657
R7094A*SW-DIGCHEQUEO-BDIIVIDERMB0009     |  PJV012SW-DIGCHEQUEO-BDIIVIDECQ12657
R7094AIF W-BLOQUES > 0RMB0009     <
R7094AMOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     <
R7094AEND-IFRMB0009     <
R7094DIF TIPOID-E = 2 OR 3RMB0009     <
R7094DMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDERMB0009     <
R7094DEND-IFRMB0009     <
REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007     <
REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007     <
>  REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007
>  REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE   "O"TO ORIGEN-VAL|  PJV012MOVE   "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE    "O"TO ORIGEN-VAL|  PJV012MOVE    "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PAM460*MOVE "A"TO ORIGEN-VAL|  PJV012MOVE "A"TO ORIGEN-VALCQ12657IF W-CONT-TIPO-5>  ZEROSIF W-CONT-TIPO-5>  ZEROSIF W-CONT-TIPO-6>  ZEROSIF W-CONT-TIPO-6>  ZEROSIF W-CONT-TIPO-7>  ZEROSIF W-CONT-TIPO-7>  ZEROS
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1029 fewer lines* PESVNOCSV.V.01.0011|* PESVNOCSVPLUS.V.01.0013* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A ** GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   ** EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     ** LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     ** LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   ** RMB0009    | R7094A - OPCION DE NO VALIDAR NOMBRE VALIDAR=NO   *
*| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     **| R7094D - QUITAR DIGITO DE CHEQUEO SOLO A NITS     *
* PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.** PJV0010    | CQ6271 - LOG DE REGISTROS PROCESADOS.*
* PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES** PJV011     | CQ11407 - HACE CONTROL DE IDENTIFICACIONES*
>* PJV012     | CQ12657 - CONTROL DE ORIGEN DE VALIDACIONES*
>* JUN-20-2013| PARA NITS - CAMBIO A PARTIR DEL PESNVO ESTANDAR   *
>* PEDRO V.   |*
>******************************************************************
>* STT013     | CQ12837 - SE AGRANDA A 650 EL FILLER DE RELLENO   *
>* JUL-31-2013|*
>* LUIS GOMEZ |*
>******************************************************************03 FILLER-2-EPIC   X(60).|  PJV012*    03 FILLER-2-EPIC   X(360).CQ12657
>  STT013     03 FILLER-2-EPIC   X(660).CQ12837
PAM460*    03 ORIGEN-VALPIC X.|  PJV012     03 ORIGEN-VALPIC X.CQ12657
PAM460     03 FILLER-2-VALPIC X(51).|  PJV012*    03 FILLER-2-VALPIC X(350).CQ12657
>  STT013     03 FILLER-2-VALPIC X(650).CQ12837
PJV011     03 FILLER-2-VALREPPIC X(51).CQ11407     |  PJV012*    03 FILLER-2-VALREPPIC X(651).CQ12837
>  STT013     03 FILLER-2-VALREPPIC X(651).CQ12657
*DISPLAY "*-----------------------------------*"|  PJV012DISPLAY "*-----------------------------------*"CQ12657
*DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSV|  PJV012DISPLAY "Registros validados en BDACSV:" SI-EXISTE-CSVCQ12657
*DISPLAY "*------------------------------------*"|  PJV012DISPLAY "*------------------------------------*"CQ12657
R7094A*MOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     |  PJV012MOVE    1TO  SW-VERIFNOM-BDIIVIDECQ12657
R7094A*SW-DIGCHEQUEO-BDIIVIDERMB0009     |  PJV012SW-DIGCHEQUEO-BDIIVIDECQ12657
R7094AIF W-BLOQUES > 0RMB0009     <
R7094AMOVE    1TO  SW-VERIFNOM-BDIIVIDERMB0009     <
R7094AEND-IFRMB0009     <
R7094DIF TIPOID-E = 2 OR 3RMB0009     <
R7094DMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDERMB0009     <
R7094DEND-IFRMB0009     <
REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007     <
REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007     <
>  REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007
>  REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE   "O"TO ORIGEN-VAL|  PJV012MOVE   "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PAM460*IF ORIGEN-VAL = SPACES|  PJV012IF ORIGEN-VAL = SPACESCQ12657
PAM460*MOVE    "O"TO ORIGEN-VAL|  PJV012MOVE    "O"TO ORIGEN-VALCQ12657
PAM460*END-IF|  PJV012END-IFCQ12657
PAM460*MOVE "A"TO ORIGEN-VAL|  PJV012MOVE "A"TO ORIGEN-VALCQ12657IF W-CONT-TIPO-5>  ZEROSIF W-CONT-TIPO-5>  ZEROSIF W-CONT-TIPO-6>  ZEROSIF W-CONT-TIPO-6>  ZEROSIF W-CONT-TIPO-7>  ZEROSIF W-CONT-TIPO-7>  ZEROS
~
~
~
~
~
~
~:q!/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi qqqls -l PESVNO*.CBLls -l PESVNO*    vi qqq       sdiff -w 170 PESVNO.CBL PESVNOCSVPLUS.CBL >| qqq/d/iccol/desarrollo/fuentes>vi qqq                                          /d/iccol/desarrollo/fuentes> qqq  r qqqm qqq
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>ma
/d/iccol/desarrollo/macros>ls sh-CARGAJU*
sh-CARGAJUR      sh-CARGAJUR.old
/d/iccol/desarrollo/macros>clear
/d/iccol/desarrollo/macros>cat sh-CARGAJUR
#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:      DATACREDITO                                *
#SHELL-ID:     sh-CARGAJUR                                *
#DATE-WRITTEN: MAY/2014                                   *
#AUTHOR:       GLOBANT                                    *
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO                  *
# Globant.   |                                                    *
#******************************************************************
#
#*========================================================*
#*          DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="000001"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "                D A T A C R E D I T O"
    echo " "
    echo "              Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo
    echo $raya
    echo "              PROCESO REAL O EN FALSO"
    echo $raya
    P_REAL_FALSO="#";
    endLoop=0
    while [ $endLoop == 0 ]
    do
#             ---------------------------------------------------
        echo " "
        echo "        1) Proceso en falso"
        echo " "
        echo "        2) Proceso real"
        echo " "
        echo "        3) Salir"
        echo " "
        echo "             opción (123)   ---> \c"
        read P_REAL_FALSO 
        if [ $P_REAL_FALSO != "1" ] && [ $P_REAL_FALSO != "2" ] && [ $P_REAL_FALSO != "3" ] 
        then
            echo "\n\tlas opciones válidas son 1, 2 o 3"
        else
            endLoop=1
        fi
    done
}

GetTipoDeProceso()
{
#*-----------------------------------------------------------------------------*
# Averigua el tipo de proceso: carga inicial, actualización, refresque total ...
#*-----------------------------------------------------------------------------*
    echo
    echo $raya
    echo "                  TIPO DE PROCESO"
    echo $raya
    endLoop=0
    P_PROCESO="##"
    while [ $endLoop == 0 ]
    do
#             ---------------------------------------------------
        echo " "
        echo "      01) Envio Original  - Carga TOTAL 1a vez"
        echo " "
        echo "      02) Archivo Semanal - Carga PARCIAL"
        echo " "
        echo "      03) Archivo Mensual - Carga PARCIAL"
        echo " "
        echo "      04) Refresque Total - Carga TOTAL"
        echo " "
        echo "      00) Salir"
        echo " "
        echo "           opción (01 02 03 04 00)   ---> \c"
        read P_PROCESO
        if [ -z "$P_PROCESO" ] 
        then
            echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"
        else
            if [ $P_PROCESO != "01" ] && [ $P_PROCESO != "02" ] && [ $P_PROCESO != "03" ] && [ $P_PROCESO != "04" ] && [ $P_PROCESO != "00" ] 
            then
                echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"
            else
                endLoop=1
            fi
        fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo
    echo $raya
    echo "                NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#             ---------------------------------------------------
        echo " "
        echo " Ingrese el nombre del archivo o enter para salir:"
        echo "      "$codsus"100ddmmaa01"$P_PROCESO".txt"
#                   JJJJJJaaaDDMMAAbbXX.txt
        echo " ---> \c"
        read P_NombreArchivo
        if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
        then
            endLoop=1
        else
            if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]
            then
                echo "no se encuentra el archivo " $P_NombreArchivo
            else
#               el tipo de proceso 01/02/03/04 debe coincidir con el que
#               está en el nombre del arch
#               separa los dos caractares justo antes de la extensión ".txt"
                auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#               echo $auxTxt " debería ser " $P_PROCESO
                if [ $P_PROCESO == $auxTxt ]
                then
#                   el código de suscriptor al principio del nombre del 
#                   archivo debe ser el de JURAD
                    auxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#                   echo $auxTxt " debería ser " $codsus
                    if [ $codsus == $auxTxt ]
                    then
                        endLoop=1
                    else
                        echo "El código de suscriptor en el nombre del archivo no coincide"
                    fi
                else
                    echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESO
                fi
            fi
        fi
    done
}


#*========================================================*
#*                    PROCESO                             *
#*========================================================*
#*              FASE 1: PIDE PARAMETROS                   *
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
    exit
fi
GetTipoDeProceso
if [ $P_PROCESO -eq 00 ]
then
    exit
fi
GetNombreDelArchivo
if [ -z "$P_NombreArchivo" ]
then
    exit
fi

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|                 SEGUNDA FASE: PROCESO                       |"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" $P_REAL_FALSO " tipo de proceso:" $P_PROCESO
    nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $TEMPORALES/$P_NombreArchivo.log 2>| $TEMPORALES/$P_NombreArchivo.log
    echo $raya
    echo "             RESULTADOS DEL PROCESO"
    echo " "
    cat $TEMPORALES/$P_NombreArchivo.log 
    echo " "
    cd $TEMPORALES
        echo "Archivos en \$TEMPORALES:"
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
        cd - > /dev/null
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

/d/iccol/desarrollo/macros>
shell will timeout in 60 seconds due to inactivity

/d/iccol/desarrollo/macros>echo "PVNO$$.prn"
PVNO25760.prn
/d/iccol/desarrollo/macros>man cut
Reformatting page.  Please Wait... done

User Commands                                              cut(1)

NAME
     cut - cut out selected fields of each line of a file

SYNOPSIS
     cut -b list [-n] [file...]

     cut -c list [file...]

     cut -f list [-d delim] [-s] [file...]

DESCRIPTION
     Use the cut utility to cut  out  columns  from  a  table  or
     fields  from  each line of a file; in data base parlance, it
     implements the projection  of  a  relation.  The  fields  as
     specified  by  list  can be fixed length, that is, character
     positions as on a punched card (-c option) or the length can
     vary  from line to line and be marked with a field delimiter
     character like <TAB> (-f option).  cut  can  be  used  as  a
     filter.

     Either the -b, -c, or -f option must be specified.

     Use grep(1) to make horizontal ``cuts'' (by context) through
     a  file, or paste(1) to put files together column-wise (that
     is, horizontally). To reorder columns in a  table,  use  cut
     and paste.

OPTIONS
     The following options are supported:

     list            A   comma-separated   or    blank-character-
                     separated  list of integer field numbers (in
                     increasing order), with optional - to  indi-
                     cate  ranges  (for  instance,  1,4,7; 1-3,8;
                     -5,10 (short for 1-5,10); or 3-  (short  for
                     third through last field)).

     -b list         The list following -b specifies  byte  posi-
                     tions  (for  instance, -b1-72 would pass the
                     first 72 bytes of each line). When -b and -n
                     are  used together, list is adjusted so that
                     no multi-byte character is split.

     -c list         The list following  -c  specifies  character
                     positions  (for  instance, -c1-72 would pass
--More--(29%)                     the first 72 characters of each line).

SunOS 5.10          Last change: 29 Apr 1999                    1

User Commands                                              cut(1)

     -d delim        The character following -d is the field del-
                     imiter  (-f  option  only).  Default is tab.
                     Space or other characters with special mean-
                     ing  to  the shell must be quoted. delim can
                     be a multi-byte character.

     -f list         The list following -f is a  list  of  fields
                     assumed  to  be  separated  in the file by a
                     delimiter character (see -d ); for instance,
                     -f1,7  copies  the  first  and seventh field
                     only. Lines with no field delimiters will be
                     passed through intact (useful for table sub-
                     headings), unless -s is specified.

     -n              Do not split characters. When -b list and -n
                     are  used together, list is adjusted so that
                     no multi-byte character is split.

     -s              Suppresses lines with no  delimiter  charac-
                     ters in case of -f option. Unless specified,
                     lines with  no  delimiters  will  be  passed
                     through untouched.

OPERANDS
     The following operands are supported:

     file            A path name of an input  file.  If  no  file
                     operands are specified, or if a file operand
                     is -, the standard input will be used.

USAGE
     See largefile(5) for the description of the behavior of  cut
     when  encountering files greater than or equal to 2 Gbyte (2
    **31 bytes).

EXAMPLES
     Example 1: Mapping user IDs

     A mapping of user IDs to names follows:

     example% cut -d: -f1,5 /etc/passwd

--More--(59%)
...back 1 page

     Use grep(1) to make horizontal ``cuts'' (by context) through
     a  file, or paste(1) to put files together column-wise (that
     is, horizontally). To reorder columns in a  table,  use  cut
     and paste.

OPTIONS
     The following options are supported:

     list            A   comma-separated   or    blank-character-
                     separated  list of integer field numbers (in
                     increasing order), with optional - to  indi-
                     cate  ranges  (for  instance,  1,4,7; 1-3,8;
                     -5,10 (short for 1-5,10); or 3-  (short  for
                     third through last field)).

     -b list         The list following -b specifies  byte  posi-
                     tions  (for  instance, -b1-72 would pass the
                     first 72 bytes of each line). When -b and -n
                     are  used together, list is adjusted so that
                     no multi-byte character is split.

     -c list         The list following  -c  specifies  character
                     positions  (for  instance, -c1-72 would pass
                     the first 72 characters of each line).

SunOS 5.10          Last change: 29 Apr 1999                    1

User Commands                                              cut(1)

     -d delim        The character following -d is the field del-
                     imiter  (-f  option  only).  Default is tab.
                     Space or other characters with special mean-
                     ing  to  the shell must be quoted. delim can
                     be a multi-byte character.

     -f list         The list following -f is a  list  of  fields
                     assumed  to  be  separated  in the file by a
                     delimiter character (see -d ); for instance,
                     -f1,7  copies  the  first  and seventh field
                     only. Lines with no field delimiters will be
                     passed through intact (useful for table sub-
                     headings), unless -s is specified.

     -n              Do not split characters. When -b list and -n
                     are  used together, list is adjusted so that
                     no multi-byte character is split.

     -s              Suppresses lines with no  delimiter  charac-
                     ters in case of -f option. Unless specified,
--More--(49%)                     lines with  no  delimiters  will  be  passed
                     through untouched.

OPERANDS
     The following operands are supported:

     file            A path name of an input  file.  If  no  file
                     operands are specified, or if a file operand
                     is -, the standard input will be used.

USAGE
     See largefile(5) for the description of the behavior of  cut
     when  encountering files greater than or equal to 2 Gbyte (2
    **31 bytes).

EXAMPLES
     Example 1: Mapping user IDs

     A mapping of user IDs to names follows:

     example% cut -d: -f1,5 /etc/passwd

SunOS 5.10          Last change: 29 Apr 1999                    2

User Commands                                              cut(1)

     Example 2: Setting current login name

     To set name to current login name:

     example$ name=`who am i | cut -f1 -d' '`

ENVIRONMENT VARIABLES
     See environ(5) for descriptions of the following environment
     variables  that  affect  the execution of cut: LANG, LC_ALL,
     LC_CTYPE, LC_MESSAGES, and NLSPATH.

EXIT STATUS
     The following exit values are returned:

     0        All input files were output successfully.

     >0       An error occurred.

ATTRIBUTES
     See attributes(5) for descriptions of the  following  attri-
     butes:

--More--(69%)     ____________________________________________________________
    |       ATTRIBUTE TYPE        |       ATTRIBUTE VALUE       |
    |_____________________________|_____________________________|
    | Availability                | SUNWcsu                     |
    |_____________________________|_____________________________|
    | CSI                         | Enabled                     |
    |_____________________________|_____________________________|
    | Interface Stability         | Standard                    |
    |_____________________________|_____________________________|

SEE ALSO
     grep(1), paste(1), attributes(5), environ(5),  largefile(5),
     standards(5)

DIAGNOSTICS
     cut: -n may only be used with -b

     cut: -d may only be used with -f

     cut: -s may only be used with -f

SunOS 5.10          Last change: 29 Apr 1999                    3

User Commands                                              cut(1)

     cut: cannot open <file>                 Either  file  cannot
                                             be  read or does not
                                             exist.  If  multiple
                                             files  are  present,
                                             processing   contin-
                                             ues.

     cut: no delimiter specified             Missing delim on  -d
                                             option.

     cut: invalid delimiter

     cut: no list specified                  Missing list on  -b,
                                             -c, or -f option.

     cut: invalid range specifier

     cut: too many ranges specified

     cut: range must be increasing

     cut: invalid character in range

--More--(96%)     cut: internal error processing input

     cut: invalid multibyte character

     cut: unable to allocate enough memory

SunOS 5.10          Last change: 29 Apr 1999                    4

/d/iccol/desarrollo/macros> 
/d/iccol/desarrollo/macros>
/d/iccol/desarrollo/macros>