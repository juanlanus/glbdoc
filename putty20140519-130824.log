=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.05.19 13:08:24 =~=~=~=~=~=~=~=~=~=~=~=
login as: icsgd   dgd
Using keyboard-interactive authentication.
Password: 
Last login: Mon May 19 11:00:20 2014 from 172.16.10.7
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icdgd@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>ls -la CARGAJ*
CARGAJ*: No such file or directory
/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fuls -la CARGAJ*
-rw-rw-r--   1 icdgd    icdatacr   52027 May 16 12:17 CARGAJUR-GB.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   53302 May 15 18:19 CARGAJUR.gnt
-rw-rw-r--   1 icdgd    icdatacr  136960 May 15 18:19 CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr   30464 May 15 18:19 CARGAJUR.int
-rw-rw-r--   1 icdgd    icdatacr  153269 May 15 18:19 CARGAJUR.lst
-rw-rw-r--   1 icdgd    icdatacr  382842 May 15 18:19 CARGAJUR.s
/d/iccol/desarrollo/fuentes>who
icjdld     pts/38       May 16 11:37    (10.98.2.123)
icjdld     pts/37       May 13 08:54    (10.98.2.123)
ichdd      pts/35       May 19 10:08    (172.16.10.1)
icjcad     pts/15       May 19 10:34    (10.98.2.128)
icrmbd     pts/36       May  9 07:45    (10.98.2.10)
icimsd     pts/40       May 15 10:12    (10.98.2.71)
icrmbd     pts/41       May 16 17:07    (10.98.2.10)
icgjcd     pts/2        May 15 10:26    (10.98.2.220)
icjdld     pts/3        May 12 14:48    (10.98.2.123)
icdgd      pts/6        May 19 09:33    (172.16.10.126)
icrmbd     pts/7        May 19 09:41    (10.98.2.127)
icjcld     pts/9        May 15 15:37    (10.98.2.188)
icrmbd     pts/13       May 19 10:28    (10.98.2.10)
icrmbd     pts/5        May 16 16:22    (10.98.2.10)
iclagd     pts/53       May 19 10:13    (172.16.10.2)
ichdd      pts/52       May 19 10:10    (172.16.10.1)
iclagd     pts/54       May 19 10:14    (172.16.10.2)
icjdld     pts/8        May 19 09:43    (10.98.2.123)
iccavd     pts/44       May 19 09:49    (10.98.2.125)
icjmld     pts/55       May 19 11:03    (10.98.2.118)
icfacd     pts/4        May 13 16:24    (10.98.2.108)
icrmbd     pts/62       May 19 09:48    (10.98.2.127)
icimsd     pts/18       May 16 11:56    (10.98.2.122)
icimsd     pts/19       May 16 12:19    (10.98.2.122)
iccavd     pts/58       May 19 09:49    (10.98.2.125)
icimsd     pts/60       May 16 12:20    (10.98.2.122)
icdgd      pts/33       May 19 11:08    (172.16.10.7)
icvhfd     pts/14       May 19 10:33    (10.98.2.120)
icehad     pts/59       May 19 08:45    (10.98.2.124)
/d/iccol/desarrollo/fuentes>write icdgd pts/33

        Message from icdgd on codes (pts/33) [ Mon May 19 11:10:31 ] ...
hola!
hola!
^C<EOT>
/d/iccol/desarrollo/fuentes>write icdgd pts/6
hola Pedro! Ya estoy conectado ... pls pásame el nombre^?^?          path del shell

^C/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cp 9999991000905140101.txt.orig 99999910009051401>/d/iccol/desarrollo/fuentes>ls -lrt *txt*                                     /d/iccol/desarrollo/fuentes>sh-CARGAJUR  write icdgd pts/6sh-CARGAJUR      ls -lrt *txt*cp 9999991000905140101.txt.orig 99999910009051401>/d/iccol/desarrollo/fuentes>                                                  /d/iccol/desarrollo/fuentes> q^?   kkk    
/d/iccol/desarrollo/fuentes>vi sh-CARGAJUR
"sh-CARGAJUR" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"sh-CARGAJUR" [New file]:q/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi sh-CARGAJUR sh-CARGAJUR  w sh-CARGAJURh sh-CARGAJURi sh-CARGAJURc sh-CARGAJURh sh-CARGAJUR
/d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo/fuentes>vi /d/iccol/desarrollo/macros/sh-CARGAJUR
"/d/iccol/desarrollo/macros/sh-CARGAJUR" 229 lines, 8414 characters #sh-CARGAJUR.v.01.0001
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
#| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# 16-may-2014|*
# Globant.   |*
#|*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES*
#*========================================================*
#
GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# ACTUALIZA FECHA ACTUAL DEL SISTEMA
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    echo "MAQUINA: " $P_MAQUINA
    echo "+-------------------------------------------------------------+"
    echo "|     Fecha de Ejecucion    :" $FECHOY_A4MMDD
    echo "|     Hora de Ejecucion     :" $HoraHoy
    echo "|-------------------------------------------------------------+"
}

GetProceso()
{
#*-----------------------------------------------------------------------------*
# PREGUNTA SI EL PROCESO SE REALIZA
#
#*-----------------------------------------------------------------------------*
    P_FCORTE=$FECHOY_ANOMES
    P_PROCESO="#";
    while [ $P_PROCESO != "S" ] && [ $P_PROCESO != "N" ] ; doecho
echo "*--------------------------------------------------------*"echo "     **  DEFINICION DE LA BASE DATOS PARA PROCESO **     "echo "*--------------------------------------------------------*"echo "<S>   Proceso Real""/d/iccol/desarrollo/macros/sh-CARGAJUR" 229 lines, 8414 characters[1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo/fuentes>echo `who am i | cut -c 39-50`
172.16.10.7)
/d/iccol/desarrollo/fuentes>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR
#sh-CARGAJUR.v.01.0001
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
#| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# 16-may-2014|*
# Globant.   |*
#|*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES*
#*========================================================*
#
GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# ACTUALIZA FECHA ACTUAL DEL SISTEMA
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    echo "MAQUINA: " $P_MAQUINA
    echo "+-------------------------------------------------------------+"
    echo "|     Fecha de Ejecucion    :" $FECHOY_A4MMDD
    echo "|     Hora de Ejecucion     :" $HoraHoy
    echo "|-------------------------------------------------------------+"
}

GetProceso()
{
#*-----------------------------------------------------------------------------*
# PREGUNTA SI EL PROCESO SE REALIZA
#
#*-----------------------------------------------------------------------------*
    P_FCORTE=$FECHOY_ANOMES
    P_PROCESO="#";
    while [ $P_PROCESO != "S" ] && [ $P_PROCESO != "N" ] ; doecho
echo "*--------------------------------------------------------*"echo "     **  DEFINICION DE LA BASE DATOS PARA PROCESO **     "echo "*--------------------------------------------------------*"echo "<S>   Proceso Real"[1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo/fuentes>echo `date '+%Y%m%d' | cut -c 1-6`
201405
/d/iccol/desarrollo/fuentes>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR
#sh-CARGAJUR.v.01.0001
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
#| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# 16-may-2014|*
# Globant.   |*
#|*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES*
#*========================================================*
#
GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# ACTUALIZA FECHA ACTUAL DEL SISTEMA
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    echo "MAQUINA: " $P_MAQUINA
    echo "+-------------------------------------------------------------+"
    echo "|     Fecha de Ejecucion    :" $FECHOY_A4MMDD
    echo "|     Hora de Ejecucion     :" $HoraHoy
    echo "|-------------------------------------------------------------+"
}

GetProceso()
{
#*-----------------------------------------------------------------------------*
# PREGUNTA SI EL PROCESO SE REALIZA
#
#*-----------------------------------------------------------------------------*
    P_FCORTE=$FECHOY_ANOMES
    P_PROCESO="#";
    while [ $P_PROCESO != "S" ] && [ $P_PROCESO != "N" ] ; doecho
echo "*--------------------------------------------------------*"echo "     **  DEFINICION DE LA BASE DATOS PARA PROCESO **     "echo "*--------------------------------------------------------*"echo "<S>   Proceso Real"

[1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo/fuentes>echo `date '+%Y%m%d'`
20140519
/d/iccol/desarrollo/fuentes>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR
#sh-CARGAJUR.v.01.0001
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
#| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# 16-may-2014|*
# Globant.   |*
#|*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES*
#*========================================================*
#
GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# ACTUALIZA FECHA ACTUAL DEL SISTEMA
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    echo "MAQUINA: " $P_MAQUINA
    echo "+-------------------------------------------------------------+"
    echo "|     Fecha de Ejecucion    :" $FECHOY_A4MMDD
    echo "|     Hora de Ejecucion     :" $HoraHoy
    echo "|-------------------------------------------------------------+"
}

GetProceso()
{
#*-----------------------------------------------------------------------------*
# PREGUNTA SI EL PROCESO SE REALIZA
#
#*-----------------------------------------------------------------------------*
    P_FCORTE=$FECHOY_ANOMES
    P_PROCESO="#";
    while [ $P_PROCESO != "S" ] && [ $P_PROCESO != "N" ] ; doecho
echo "*--------------------------------------------------------*"echo "     **  DEFINICION DE LA BASE DATOS PARA PROCESO **     "echo "*--------------------------------------------------------*"echo "<S>   Proceso Real"    P_FCORTE=$FECHOY_ANOMESP_MAQUINA=`who am i | cut -c 39-50`
    echo "MAQUINA: " $P_MAQUINA
    echo "+-------------------------------------------------------------+"
    echo "|     Fecha de Ejecucion    :" $FECHOY_A4MMDD
    echo "|     Hora de Ejecucion     :" $HoraHoy
    echo "|-------------------------------------------------------------+"
}

GetProceso()
{
#*-----------------------------------------------------------------------------*
# PREGUNTA SI EL PROCESO SE REALIZA
#
#*-----------------------------------------------------------------------------*
    P_FCORTE=$FECHOY_ANOMES
    P_PROCESO="#";
    while [ $P_PROCESO != "S" ] && [ $P_PROCESO != "N" ] ; doecho
echo "*--------------------------------------------------------*"echo "     **  DEFINICION DE LA BASE DATOS PARA PROCESO **     "echo "*--------------------------------------------------------*"echo "<S>   Proceso Real"echo "<N>   Proceso En Falso"echo "*--------------------------------------------------------*"echo "Digite opcion  (S/N)   ---> \c"read P_PROCESOif [ -z "$P_PROCESO" ] ; thenP_PROCESO="N"else
 if [ $P_PROCESO == "S" ] || [ $P_PROCESO == "s" ] ; thenP_PROCESO="S"else
if [ $P_PROCESO == "N" ] || [ $P_PROCESO == "n" ] ; thenP_PROCESO="N"
else
echo "\n\t*ERRROR* OPCION NO VALIDA! <ENTER>\c"GetEnter
fi
fi
fi
    done
}

GetPeriodoSanata()
{
#*-----------------------------------------------------------------------------*
# PREGUNTAR POR EL PERIODO DEL SANATA Y EFECTUAR EL CAMBIO
GetPeriodoSanata()
{
#*-----------------------------------------------------------------------------*
# PREGUNTAR POR EL PERIODO DEL SANATA Y EFECTUAR EL CAMBIO
#*-----------------------------------------------------------------------------*
    echo "     Digite Fecha de la Base de Datos (AAAAMMDD) a Procesar  ---> \c"
    read FECHIS_ANOMESDIA
    longitud=`echo $FECHIS_ANOMESDIA | tr -d '[:alpha:]' | awk '{printf("%d\n", length($0))}'`
    if [ $longitud -ne 8 ] && [ $longitud -ne 0 ] ; thenecho "\t *ERROR*  Periodo Historico NO válida. La Fecha debe ser (AAAAMMDD) -Proceso cancelado-"
GetEnter
exit
    else
if [ $longitud -eq 0 ] ; thenP_FCORTE=$FECHOY_ANOMESFECHIS_ANOMESDIA=`echo $FECHOY_ANOMES`
else
 cd $DATOS
FECHIS_ANOMES=`echo $FECHIS_ANOMESDIA | cut -c 1-6`sanata=`grep $FECHIS_ANOMES ICSANATA.DAT | cut -f2 -d"/"|cut -f3 -d"_"`cd $TEMPORALES
echo "Sanata para Fecha " $FECHIS_ANOMESDIA "  es " $sanataif test -z "$sanata" ; thenP_FCORTE=$FECHOY_ANOMESecho "\n !!!! *ERROR*  sanata de $FECHIS_ANOMESDIA NO Existe !!! \n "echo "**** PROCESO CANCELADO **** "GetEnter
exit
else
 P_FCORTE=$FECHIS_ANOMESCambiarSanatafi
fi
    fi
}

CambiarSanata()
{
#*-----------------------------------------------------------------------------*
# VERIFICAR Y CAMBIAR AL SANATA CORRESPONDIENTE
#*-----------------------------------------------------------------------------*
   if [ $FECHOY_ANOMES -ne $FECHIS_ANOMES ] ; then
echo "\n\tSe Procesa con fecha $FECHIS_ANOMESDIA \n". /san_ata_$sanata/$FECHIS_ANOMES/sh-$FECHIS_ANOMESecho $DATABASEP_FCORTE=$FECHIS_ANOMES
   else
   P_FCORTE=$FECHOY_ANOMES   fi
CambiarSanata()
{
#*-----------------------------------------------------------------------------*
# VERIFICAR Y CAMBIAR AL SANATA CORRESPONDIENTE
#*-----------------------------------------------------------------------------*
   if [ $FECHOY_ANOMES -ne $FECHIS_ANOMES ] ; then
echo "\n\tSe Procesa con fecha $FECHIS_ANOMESDIA \n". /san_ata_$sanata/$FECHIS_ANOMES/sh-$FECHIS_ANOMESecho $DATABASEP_FCORTE=$FECHIS_ANOMES
   else
   P_FCORTE=$FECHOY_ANOMES
   fi
}


#* PARAMETROS:
fechab=0;
codsus=0;
nomsus={};
opcion="A";
vector=48;
numeroreg=0;
cadena01={};
cadena02={};
cadena03={};
cadena04={};
cadena05={};
cadena06={};
cadena07={};
cadena08={};
cadena09={};
cadena10={};
cadena11={};
#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
#*-----------------------------------------------------------------------------*
#MENU PRINCIPAL DE EJECUCION
#*-----------------------------------------------------------------------------*
clear
GetFechaSistema
GetProceso


loop=0
while [ $loop != 1 ]loop=0
while [ $loop != 1 ]
 do
echo "     Digite Codigo Suscriptor  ---> \c"
  read codsus
  if [ $codsus -eq 999999 ]
   then
loop=1
  else
cd $DATABASE
   nomsus=`grep ^"$codsus" ICBSUS | cut -c9-48`
   echo "Codigo suscriptor: " $codsus  "   Suscriptor: " $nomsus
   if test -z "$nomsus"
    then
echo "suscriptor errado"
   else
echo "si correcto digite ENTER, si va a modificar digite N  ---> \c"read loopdif test -z "$loopd"
then
loop=1fi
fi
fi
done
echo "     Digite nombre del archivo     ---> \c"
read archivo
cd $TEMPORALES
if test -s $archivo
then
echo
echo "Procesando archivo-----> "$archivo
else
echo "!!!...Archivo $archivo  no existe proceso termina ....!!!"
   echo
echo "(ENTER) Continuar !!!  "
   read xxx
   exit
fi
echo
echo "+-------------------------------------------------------------+"
echo "+-------------------------------------------------------------+"
echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
fechab=$P_FCORTE
echo "+-------------------------------------------------------------+"
numeroreg=`wc -l < $archivo`
echo
echo "+-------------------------------------------------------------+"
echo "| Registros iniciales archivo de entrada : " $numeroreg
echo "+-------------------------------------------------------------+"cadena00=$archivo.origmv $archivo $cadena00cut -c1-12 $cadena00 >| $archivoecho#echo "+-------------------------------------------------------------+"#echo "|SEGUNDA FASE: PROCESO|"#echo "+-------------------------------------------------------------+"#*========================================================*#*  EXECUTE PROGRAM: icestdatVEC-NORMAL*#*========================================================*#echoecho "+------------------------------------------------------+"echo "|  Programa CARGAJUR|"echo "||"echo "|  Procesando archivo --> "  $archivoecho "+------------------------------------------------------+"nohup x CARGAJUR $archivo $P_PROCESO $codsus >| $archivo.log 2>| $archivo.logecho "+-------------------------------------------------------------+"echo "|     *********  RESULTADOS DEL PROCESO**********|"echo "||"


ls -lrt $archivo* >> $archivo.log

tail -20 $archivo.log
echo "+-------------------------------------------------------------+"echo "+-------------------------------------------------------------+"

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~echo "     Digite nombre del archivo     ---> \c"
read archivo
cd $TEMPORALES
if test -s $archivo
then
echo
echo "Procesando archivo-----> "$archivo
else
echo "!!!...Archivo $archivo  no existe proceso termina ....!!!"
   echo
echo "(ENTER) Continuar !!!  "
   read xxx
   exit
fi
echo
echo "+-------------------------------------------------------------+"
echo "+-------------------------------------------------------------+"
echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
fechab=$P_FCORTE
echo "+-------------------------------------------------------------+"
numeroreg=`wc -l < $archivo`
echo
echo "+-------------------------------------------------------------+"
echo "| Registros iniciales archivo de entrada : " $numeroreg
echo "+-------------------------------------------------------------+"
cadena00=$archivo.orig
mv $archivo $cadena00
cut -c1-12 $cadena00 >| $archivo
echo
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
#*========================================================*
#*  EXECUTE PROGRAM: icestdatVEC-NORMAL*
#*========================================================*
#
echo
echo "+------------------------------------------------------+"
echo "|  Programa CARGAJUR|"
echo "||"
echo "|  Procesando archivo --> "  $archivo
echo "+------------------------------------------------------+"
nohup x CARGAJUR $archivo $P_PROCESO $codsus >| $archivo.log 2>| $archivo.log
echo "+-------------------------------------------------------------+"
echo "|     *********  RESULTADOS DEL PROCESO**********|"
echo "||"
ls -lrt $archivo* >> $archivo.log
tail -20 $archivo.log
echo "+-------------------------------------------------------------+"cadena02={};
cadena03={};
cadena04={};
cadena05={};
cadena06={};
cadena07={};
cadena08={};
cadena09={};
cadena10={};
cadena11={};
#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
#*-----------------------------------------------------------------------------*
#MENU PRINCIPAL DE EJECUCION
#*-----------------------------------------------------------------------------*
clear
GetFechaSistema
GetProceso


loop=0
while [ $loop != 1 ]
 do
echo "     Digite Codigo Suscriptor  ---> \c"
  read codsus
  if [ $codsus -eq 999999 ]
   then
loop=1
  else
cd $DATABASE
   nomsus=`grep ^"$codsus" ICBSUS | cut -c9-48`
   echo "Codigo suscriptor: " $codsus  "   Suscriptor: " $nomsus
   if test -z "$nomsus"
    then
echo "suscriptor errado"
   else
echo "si correcto digite ENTER, si va a modificar digite N  ---> \c"read loopdif test -z "$loopd"
then
loop=1fi
fi
fi
done
echo "     Digite nombre del archivo     ---> \c"#sh-CARGAJUR.v.01.0001
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
#| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# 16-may-2014|*
# Globant.   |*
#|*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES*
#*========================================================*
#
GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# ACTUALIZA FECHA ACTUAL DEL SISTEMA
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    echo "MAQUINA: " $P_MAQUINA
    echo "+-------------------------------------------------------------+"
    echo "|     Fecha de Ejecucion    :" $FECHOY_A4MMDD
    echo "|     Hora de Ejecucion     :" $HoraHoy
    echo "|-------------------------------------------------------------+"
}

GetProceso()
{
#*-----------------------------------------------------------------------------*
# PREGUNTA SI EL PROCESO SE REALIZA
#
#*-----------------------------------------------------------------------------*
    P_FCORTE=$FECHOY_ANOMES
    P_PROCESO="#";
    while [ $P_PROCESO != "S" ] && [ $P_PROCESO != "N" ] ; doecho
echo "*--------------------------------------------------------*"echo "     **  DEFINICION DE LA BASE DATOS PARA PROCESO **     "echo "*--------------------------------------------------------*"echo "<S>   Proceso Real"
echo "<N>   Proceso En Falso"echo "<N>   Proceso En Falso"echo "*--------------------------------------------------------*"echo "Digite opcion  (S/N)   ---> \c"read P_PROCESOif [ -z "$P_PROCESO" ] ; thenP_PROCESO="N"else
 if [ $P_PROCESO == "S" ] || [ $P_PROCESO == "s" ] ; thenP_PROCESO="S"else
if [ $P_PROCESO == "N" ] || [ $P_PROCESO == "n" ] ; thenP_PROCESO="N"
else
echo "\n\t*ERRROR* OPCION NO VALIDA! <ENTER>\c"GetEnter
fi
fi
fi
    done
}

GetPeriodoSanata()
{
#*-----------------------------------------------------------------------------*
# PREGUNTAR POR EL PERIODO DEL SANATA Y EFECTUAR EL CAMBIO
#*-----------------------------------------------------------------------------*
    echo "     Digite Fecha de la Base de Datos (AAAAMMDD) a Procesar  ---> \c"
    read FECHIS_ANOMESDIA
    longitud=`echo $FECHIS_ANOMESDIA | tr -d '[:alpha:]' | awk '{printf("%d\n", length($0))}'`
    if [ $longitud -ne 8 ] && [ $longitud -ne 0 ] ; thenecho "\t *ERROR*  Periodo Historico NO válida. La Fecha debe ser (AAAAMMDD) -Proceso cancelado-"
GetEnter
exit
    else
if [ $longitud -eq 0 ] ; thenP_FCORTE=$FECHOY_ANOMESFECHIS_ANOMESDIA=`echo $FECHOY_ANOMES`
else
 cd $DATOS
FECHIS_ANOMES=`echo $FECHIS_ANOMESDIA | cut -c 1-6`sanata=`grep $FECHIS_ANOMES ICSANATA.DAT | cut -f2 -d"/"|cut -f3 -d"_"`cd $TEMPORALES
echo "Sanata para Fecha " $FECHIS_ANOMESDIA "  es " $sanataif test -z "$sanata" ; thenP_FCORTE=$FECHOY_ANOMESecho "\n !!!! *ERROR*  sanata de $FECHIS_ANOMESDIA NO Existe !!! \n "echo "**** PROCESO CANCELADO **** "GetEnter
exitexit
else
 P_FCORTE=$FECHIS_ANOMESCambiarSanatafi
fi
    fi
}

CambiarSanata()
{
#*-----------------------------------------------------------------------------*
# VERIFICAR Y CAMBIAR AL SANATA CORRESPONDIENTE
#*-----------------------------------------------------------------------------*
   if [ $FECHOY_ANOMES -ne $FECHIS_ANOMES ] ; then
echo "\n\tSe Procesa con fecha $FECHIS_ANOMESDIA \n". /san_ata_$sanata/$FECHIS_ANOMES/sh-$FECHIS_ANOMESecho $DATABASEP_FCORTE=$FECHIS_ANOMES
   else
   P_FCORTE=$FECHOY_ANOMES
   fi
}


#* PARAMETROS:
fechab=0;
codsus=0;
nomsus={};
opcion="A";
vector=48;
numeroreg=0;
cadena01={};
cadena02={};
cadena03={};
cadena04={};
cadena05={};
cadena06={};
cadena07={};
cadena08={};
cadena09={};
cadena10={};
cadena11={};
#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
#*-----------------------------------------------------------------------------*
#MENU PRINCIPAL DE EJECUCION#MENU PRINCIPAL DE EJECUCION
#*-----------------------------------------------------------------------------*
clear
GetFechaSistema
GetProceso


loop=0
while [ $loop != 1 ]
 do
echo "     Digite Codigo Suscriptor  ---> \c"
  read codsus
  if [ $codsus -eq 999999 ]
   then
loop=1
  else
cd $DATABASE
   nomsus=`grep ^"$codsus" ICBSUS | cut -c9-48`
   echo "Codigo suscriptor: " $codsus  "   Suscriptor: " $nomsus
   if test -z "$nomsus"
    then
echo "suscriptor errado"
   else
echo "si correcto digite ENTER, si va a modificar digite N  ---> \c"read loopdif test -z "$loopd"
then
loop=1fi
fi
fi
done
echo "     Digite nombre del archivo     ---> \c"
read archivo
cd $TEMPORALES
if test -s $archivo
then
echo
echo "Procesando archivo-----> "$archivo
else
echo "!!!...Archivo $archivo  no existe proceso termina ....!!!"
   echo
echo "(ENTER) Continuar !!!  "
   read xxx
   exit
fi
echo
echo "+-------------------------------------------------------------+"
echo "+-------------------------------------------------------------+"
echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
fechab=$P_FCORTE
echo "+-------------------------------------------------------------+"
numeroreg=`wc -l < $archivo`
echo
echo "+-------------------------------------------------------------+"
echo "| Registros iniciales archivo de entrada : " $numeroreg
echo "+-------------------------------------------------------------+"
cadena00=$archivo.orig
mv $archivo $cadena00
cut -c1-12 $cadena00 >| $archivo
echo
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
#*========================================================*
#*  EXECUTE PROGRAM: icestdatVEC-NORMAL*
#*========================================================*
#
echo
echo "+------------------------------------------------------+"
echo "|  Programa CARGAJUR|"
echo "||"
echo "|  Procesando archivo --> "  $archivo
echo "+------------------------------------------------------+"
nohup x CARGAJUR $archivo $P_PROCESO $codsus >| $archivo.log 2>| $archivo.log
echo "+-------------------------------------------------------------+"
echo "|     *********  RESULTADOS DEL PROCESO**********|"
echo "||"
ls -lrt $archivo* >> $archivo.log
tail -20 $archivo.log
echo "+-------------------------------------------------------------+"

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>tailsh-CARGAJURtail       more 9999991000905140101.txt.log/d/iccol/desarrollo/fuentes>sh-CARGAJUR                     /d/iccol/desarrollo/fuentes>fg         echo `date '+%Y%m%d'`fg                   echo `date '+%Y%m%d' | cut -c 1-6`/d/iccol/desarrollo/fuentes>fg                                /d/iccol/desarrollo/fuentes>echo `who am i | cut -c 39-50`/d/iccol/desarrollo/fuentes>cp 9999991000905140101.txt.orig 99999910009051401>/d/iccol/desarrollo/fuentes>vi /d/iccol/desarrollo/macros/sh-CARGAJUR         /d/iccol/desarrollo/fuentes>which sh-CARGAJUR                        /d/iccol/desarrollo/fuentes>vi /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes> /d/iccol/desarrollo/macros/sh-CARGAJUR  /d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes>ls /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes>ls  /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes>ls - /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes>ls -l /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes>ls -la /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes>ls -la
-rwxrwxr-x   1 icdgd    icdatacr    8380 May 19 11:15 /d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo/fuentes>if ^?con      config
usage: ifconfig <interface> | -a[ 4 | 6 | D ][ u | d ][ Z ]
        [ <addr_family> ]
        [ <address>[/<prefix_length>] [ <dest_address> ] ]
        [ set [ <address>][/<prefix_length>] ] [ <address>/<prefix_length>] ]
        [ destination <dest_address> ]
        [ addif <address>[/<prefix_length>]  [ <dest_address> ] ]
        [ removeif <address>[/<prefix_length>] ]
        [ arp | -arp ]
        [ auto-revarp ]
        [ broadcast <broad_addr> ]
        [ index <if_index> ]
        [ metric <n> ] [ mtu <n> ]
        [ netmask <mask> ]
        [ plumb ] [ unplumb ]
        [ preferred | -preferred ]
        [ private | -private ]
        [ local | -local ]
        [ router | -router ]
        [ subnet <subnet_address>]
        [ trailers | -trailers ]
        [ token <address>/<prefix_length> ]
        [ tsrc <tunnel_src_address> ]
        [ tdst <tunnel_dest_address> ]
        [ auth_algs <tunnel_AH_authentication_algorithm> ]
        [ encr_algs <tunnel_ESP_encryption_algorithm> ]
        [ encr_auth_algs <tunnel_ESP_authentication_algorithm> ]
        [ up ] [ down ]
        [ xmit | -xmit ]
        [ modlist ]
        [ modinsert <module_name@position> ]
        [ modremove <module_name@position> ]
        [ group <groupname>] | [ group ""]
        [ deprecated | -deprecated ]
        [ standby | -standby ]
        [ failover | -failover ]
        [ zone <zonename> | -zone ]
        [ usesrc <interface> ]
        [ all-zones ]
or
        ifconfig <interface> |  -a[ 4 | 6 | D ] [ u | d ]
        auto-dhcp | dhcp
        [ wait <time> | forever ]
        [ primary ]
        start | drop | ping | release | status | inform
/d/iccol/desarrollo/fuentes>ifconfig local
ifconfig: status: SIOCGLIFFLAGS: local: no such interface
/d/iccol/desarrollo/fuentes>ifconfig primary
ifconfig: status: SIOCGLIFFLAGS: primary: no such interface
/d/iccol/desarrollo/fuentes>ifconfig inform
ifconfig: status: SIOCGLIFFLAGS: inform: no such interface
/d/iccol/desarrollo/fuentes>cls
/d/iccol/desarrollo/fuentes>who
icjdld     pts/38       May 16 11:37    (10.98.2.123)
icjdld     pts/37       May 13 08:54    (10.98.2.123)
ichdd      pts/35       May 19 10:08    (172.16.10.1)
icjcad     pts/15       May 19 10:34    (10.98.2.128)
icrmbd     pts/36       May  9 07:45    (10.98.2.10)
icimsd     pts/40       May 15 10:12    (10.98.2.71)
icrmbd     pts/41       May 16 17:07    (10.98.2.10)
icgjcd     pts/2        May 15 10:26    (10.98.2.220)
icjdld     pts/3        May 12 14:48    (10.98.2.123)
icdgd      pts/6        May 19 09:33    (172.16.10.126)
icjcld     pts/9        May 15 15:37    (10.98.2.188)
icrmbd     pts/13       May 19 10:28    (10.98.2.10)
icrmbd     pts/5        May 16 16:22    (10.98.2.10)
iclagd     pts/53       May 19 10:13    (172.16.10.2)
ichdd      pts/52       May 19 10:10    (172.16.10.1)
iclagd     pts/54       May 19 10:14    (172.16.10.2)
icjdld     pts/8        May 19 09:43    (10.98.2.123)
icdgd      pts/51       May 19 11:22    (172.16.10.5)
iccavd     pts/44       May 19 11:14    (10.98.2.125)
icfacd     pts/4        May 13 16:24    (10.98.2.108)
icimsd     pts/18       May 16 11:56    (10.98.2.122)
icimsd     pts/19       May 16 12:19    (10.98.2.122)
iccavd     pts/58       May 19 11:14    (10.98.2.125)
icimsd     pts/60       May 16 12:20    (10.98.2.122)
icdgd      pts/33       May 19 11:08    (172.16.10.7)
icfard     pts/14       May 19 11:14    (10.98.2.121)
icehad     pts/59       May 19 08:45    (10.98.2.124)
/d/iccol/desarrollo/fuentes>who | grep icdgd
icdgd      pts/6        May 19 09:33    (172.16.10.126)
icdgd      pts/51       May 19 11:22    (172.16.10.5)
icdgd      pts/33       May 19 11:08    (172.16.10.7)
/d/iccol/desarrollo/fuentes>ls -la CARGAJ*
-rw-rw-r--   1 icdgd    icdatacr   52027 May 16 12:17 CARGAJUR-GB.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   53302 May 15 18:19 CARGAJUR.gnt
-rw-rw-r--   1 icdgd    icdatacr  136960 May 15 18:19 CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr   30464 May 15 18:19 CARGAJUR.int
-rw-rw-r--   1 icdgd    icdatacr  153269 May 15 18:19 CARGAJUR.lst
-rw-rw-r--   1 icdgd    icdatacr  382842 May 15 18:19 CARGAJUR.s
/d/iccol/desarrollo/fuentes>sdiff -w 156 CARGAJUR.CBL CARGAJUR-GB- .CBL
      $SET LIST SETTING                                                               $SET LIST SETTING 
       IDENTIFICATION DIVISION.                                                        IDENTIFICATION DIVISION.
       PROGRAM-ID.    ACTALEJUR.                                                       PROGRAM-ID.    ACTALEJUR.
      ******************************************************************              ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos                  * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad                                                                     * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa                * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en               * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.                                                              * el archivo ERRS.
      ******************************************************************              ******************************************************************
       AUTHOR.        GLOBANT JL.                                            |         AUTHOR.        Globant JL.
       DATE-WRITTEN.                                                                   DATE-WRITTEN.
       DATE-COMPILED.                                                                  DATE-COMPILED.
       CONFIGURATION SECTION.                                                |         CONFIGURATION section.
       SOURCE-COMPUTER. MICROFOCUS.                                          |         SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. MICROFOCUS.                                          |         OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT SECTION.                                                 |         INPUT-OUTPUT section.
       FILE-CONTROL.                                                                   FILE-CONTROL.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
       SELECT JURAD ASSIGN TO P-FILE-PATH                                    |         select JURAD assign to P-file-name
           ORGANIZATION IS LINE SEQUENTIAL                                   |             organization is line sequential
           FILE STATUS IS JURAD-FS.                                          |             file status is JURAD-fs.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
       SELECT ERRS ASSIGN TO ERRS-FILE-NAME                                  |         select ERRS assign to ERRS-file-name
           ORGANIZATION IS LINE SEQUENTIAL                                   |             organization is line sequential
           FILE STATUS IS ERRS-FS.                                           |             file status is ERRS-fs.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
           COPY BDIIREGI.FS.                                                 |             copy BDIIREGI.FS.
                                                                             >        * TODO: debe compilar con file status

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
           COPY BDIIDIAN.FS.                                                 |         copy BDIIDIAN.FS.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
           COPY BDIIDAS.FS.                                                  |         copy BDIIDAS.FS.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
           COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD         |             copy BDIIALE.FS replacing == on record.== by == on record
              FILE STATUS IS EST-BDIIALE.==.                                 |                file status is EST-BDIIALE.==.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
       DATA DIVISION.                                                                  DATA DIVISION.
       FILE SECTION.                                                         |         FILE section.

      ******************************************************************              ******************************************************************
      * Archivo de entrada con los datos de demandas y embargos de JURAD              * Archivo de entrada con los datos de demandas y embargos de JURAD
      ******************************************************************              ******************************************************************
       FD JURAD.                                                                       FD JURAD.
       01  JURAD-REG.                                                        |         01  JURAD-reg.
      * Registros de movimientos I, M, E                                              * Registros de movimientos I, M, E
      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim                                 *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
           03 JURAD-TIPO-NOVEDAD        PIC X.                               |             03 JURAD-tipo-novedad        pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                 *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 JURAD-ID-TIPO             PIC X.                               |             03 JURAD-id-tipo             pic x.
      *    Numero de identificacion                                                   *    Numero de identificacion
           03 JURAD-ID-NUMEROX          PIC X(11).                           |             03 JURAD-id-numeroX          pic x(11).
           03 JURAD-ID-NUMERO           REDEFINES JURAD-ID-NUMEROX           |             03 JURAD-id-numero           redefines JURAD-id-numeroX
                                        PIC 9(11).                           |                                          pic 9(11).
      *    Nombres y Apellidos                                                        *    Nombres y Apellidos
           03 JURAD-NOMBRE              PIC X(45).                           |             03 JURAD-nombre              pic x(45).
      *    Numero de demandas vigentes                                                *    Numero de demandas vigentes
           03 JURAD-DEMANDAS-VIGENTES   PIC 999.                             |             03 JURAD-demandas-vigentes   pic 999.
      *    Numero de demandas terminadas                                              *    Numero de demandas terminadas
           03 JURAD-DEMANDAS-TERMINADAS PIC 999.                             |             03 JURAD-demandas-terminadas pic 999.
      *    Fecha ultima demanda vigente YYYYMMDD                                      *    Fecha ultima demanda vigente YYYYMMDD
           03 JURAD-DEMANDAS-FECHA-ULTIMA PIC X(8).                          |             03 JURAD-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes                                                *    Numero de embargos vigentes
           03 JURAD-EMBARGOS-VIGENTES   PIC 999.                             |             03 JURAD-embargos-vigentes   pic 999.
      *    Numero de embargos terminados                                              *    Numero de embargos terminados
           03 JURAD-EMBARGOS-TERMINADOS PIC 999.                             |             03 JURAD-embargos-terminados pic 999.
      *    Fecha ultimo embargo vigente YYYYMMDD                                      *    Fecha ultimo embargo vigente YYYYMMDD
           03 JURAD-EMBARGOS-FECHA-ULTIMO PIC X(8).                          |             03 JURAD-embargos-fecha-ultimo pic x(8).

       01  JURADT-REG.                                                       |         01  JURADT-reg.
      * Registro de totales de control T                                              * Registro de totales de control T
      *    TIPO DE NOVEDAD = "T"                                             |        *    Tipo de Novedad = "T"
           03 JURADT-TIPO-NOVEDAD       PIC X.                               |             03 JURADT-tipo-novedad       pic x.
           03                           PIC X.                               |             03                           pic x.
      *    Cantidad de registros                                                      *    Cantidad de registros
           03 JURADT-REGISTROS          PIC 9(11).                           |             03 JURADT-registros          pic 9(11).
           03                           PIC X.                               |             03                           pic x.
      *    Total numero de demandas vigentes                                          *    Total numero de demandas vigentes
           03 JURADT-DEMANDAS-VIGENTES  PIC 9(7).                            |             03 JURADT-demandas-vigentes  pic 9(7).
           03                           PIC X.                               |             03                           pic x.
      *    Total numero de demandas terminadas                                        *    Total numero de demandas terminadas
           03 JURADT-DEMANDAS-TERMINADAS PIC 9(7).                           |             03 JURADT-demandas-terminadas pic 9(7).
           03                           PIC X.                               |             03                           pic x.
      *    Total numero de embargos vigentes                                          *    Total numero de embargos vigentes
           03 JURADT-EMBARGOS-VIGENTES  PIC 9(7).                            |             03 JURADT-embargos-vigentes  pic 9(7).
           03                           PIC X.                               |             03                           pic x.
      *    Total numero de embargos terminados                                        *    Total numero de embargos terminados
           03 JURADT-EMBARGOS-TERMINADOS PIC 9(7).                           |             03 JURADT-embargos-terminados pic 9(7).
           03                           PIC X(41).                           |             03                           pic x(41).

      ******************************************************************              ******************************************************************
      * Archivo de salida con los registros defectuosos del arch JURAD                * Archivo de salida con los registros defectuosos del arch JURAD
      ******************************************************************              ******************************************************************
       FD ERRS.                                                                        FD ERRS.
       01  ERRS-REG.                                                         |         01  ERRS-reg.
      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales                      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
           03 ERRS-TIPO-NOVEDAD         PIC X.                               |             03 ERRS-tipo-novedad         pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                 *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 ERRS-ID-TIPO              PIC X.                               |             03 ERRS-id-tipo              pic x.
      *    Numero de identificacion                                                   *    Numero de identificacion
           03 ERRS-ID-NUMERO            PIC X(11).                           |             03 ERRS-id-numero            pic x(11).
      *    Nombres y Apellidos                                                        *    Nombres y Apellidos
           03 ERRS-NOMBRE               PIC X(45).                           |             03 ERRS-nombre               pic x(45).
      *    Numero de demandas vigentes                                                *    Numero de demandas vigentes
           03 ERRS-DEMANDAS-VIGENTES    PIC 999.                             |             03 ERRS-demandas-vigentes    pic 999.
      *    Numero de demandas terminadas                                              *    Numero de demandas terminadas
           03 ERRS-DEMANDAS-TERMINADAS  PIC 999.                             |             03 ERRS-demandas-terminadas  pic 999.
      *    Fecha ultima demanda vigente YYMMDD                                        *    Fecha ultima demanda vigente YYMMDD
           03 ERRS-DEMANDAS-FECHA-ULTIMA PIC X(8).                           |             03 ERRS-demandas-fecha-ultima pic x(6).
      *    Numero de embargos vigentes                                                *    Numero de embargos vigentes
           03 ERRS-EMBARGOS-VIGENTES    PIC 999.                             |             03 ERRS-embargos-vigentes    pic 999.
      *    Numero de embargos terminados                                              *    Numero de embargos terminados
           03 ERRS-EMBARGOS-TERMINADOS  PIC 999.                             |             03 ERRS-embargos-terminados  pic 999.
      *    Fecha ultimo embargo vigente YYMMDD                                        *    Fecha ultimo embargo vigente YYMMDD
           03 ERRS-EMBARGOS-FECHA-ULTIMO PIC X(8).                           |             03 ERRS-embargos-fecha-ultimo pic x(6).
      *    Causa del rechazo                                                          *    Causa del rechazo
           03 ERRS-CAUSA-RECHAZO        PIC X(100).                          |             03 ERRS-causa-rechazo        pic x(100).

      ******************************************************************              ******************************************************************
      * Contiene los ids y nombres de personas                                        * Contiene los ids y nombres de personas
      ******************************************************************              ******************************************************************
       COPY BDIIREGI.FD.                                                     |         copy BDIIREGI.FD.

      ******************************************************************              ******************************************************************
      * Maestro de personas juridicas nacionales y extranjeras reportada              * Maestro de personas juridicas nacionales y extranjeras reportada
      * por la DIAN                                                                   * por la DIAN
      ******************************************************************              ******************************************************************
       COPY BDIIDIAN.FD.                                                     |         copy BDIIDIAN.FD.

      ******************************************************************              ******************************************************************
      * Archivo maestro de cedulas de extranjeria suministrado por DAS                * Archivo maestro de cedulas de extranjeria suministrado por DAS
      ******************************************************************              ******************************************************************
       COPY BDIIDAS.FD.                                                      |         copy BDIIDAS.FD.

      ******************************************************************              ******************************************************************
      * Maestro de alertas reportadas por suscriptores                                * Maestro de alertas reportadas por suscriptores
      ******************************************************************              ******************************************************************
       COPY BDIIALE.FD.                                                      |         copy BDIIALE.FD.

      ******************************************************************              ******************************************************************
       WORKING-STORAGE SECTION.                                              |         WORKING-STORAGE section.
      ******************************************************************              ******************************************************************
      * Nombre del programa                                                           * Nombre del programa
       01  PGM                          PIC X(10) VALUE "CARGAJUR".          |         01  pgm                          pic x(10) value "CARGAJUR".

      ******************************************************************              ******************************************************************
      * Variables para rutina de validacion de identificaciones                       * Variables para rutina de validacion de identificaciones
      ******************************************************************              ******************************************************************
       COPY BDIIVIDE.WS.                                                     |         copy BDIIVIDE.WS.

      ******************************************************************              ******************************************************************
      * Variables relacionadas con las alertas del sistema                            * Variables relacionadas con las alertas del sistema
      ******************************************************************              ******************************************************************
       COPY BDIIALE.WS.                                                      |         copy BDIIALE.WS.

      ******************************************************************              ******************************************************************
      * Datos para las rutinas de validacion de nombres de VALNOM.PROC                * Datos para las rutinas de validacion de nombres de VALNOM.PROC
      ******************************************************************              ******************************************************************
       COPY VALNOM.WS.                                                       |         copy VALNOM.WS.

      *****************************************************************               *****************************************************************
      * Direcciones de los archivos en el file system                                 * Direcciones de los archivos en el file system
      *****************************************************************               *****************************************************************
       COPY ICFILE.WS.                                                       |         copy ICFILE.WS.

      ******************************************************************              ******************************************************************
      * Indica que se termino el proceso, por agotamiento del archivo                 * Indica que se termino el proceso, por agotamiento del archivo
      * de entrada (normal) o alguna otra condicion (error)                           * de entrada (normal) o alguna otra condicion (error)
       01  IND-FIN-PROCESO              PIC XX VALUE "NO".                   |         01  IND-fin-proceso              pic xx value "NO".

      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)                   * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
       01  JURAD-REG-ANTERIOR           PIC X(100) VALUE "(vacio)".          |         01  JURAD-reg-anterior           pic x(100) value "(vacio)".
       01  JURAD-FS                     PIC XX VALUE SPACES.                 |         01  JURAD-fs                     pic xx value spaces.

       01  ERRS-FS                      PIC XX VALUE SPACES.                 |         01  ERRS-fs                      pic xx value spaces.

      * Datos de demandas o embargos que van en el registro BDIIALE                   * Datos de demandas o embargos que van en el registro BDIIALE
       01 D-DATAHOST.                                                        |         01 D-datahost.
           05 D-VIGENTES                PIC 9(5).                            |             05 D-vigentes                pic 9(5).
           05 D-TERMINADOS              PIC 9(5).                            |             05 D-terminados              pic 9(5).
           05 D-FECHA-ULTIMA            PIC X(8).                            |             05 D-fecha-ultima            pic x(8).
      ******************************************************************              ******************************************************************
      * Parametros iniciales, de la linea de comando                                  * Parametros iniciales, de la linea de comando
      * La linea de comando que contiene los parametros                               * La linea de comando que contiene los parametros
       01 P-COMMAND-LINE                PIC X(80) VALUE SPACES.              |         01 P-command-line                pic x(80) value spaces.
       01 P-PARAMETROS.                                                      |         01 P-parametros.
      *    PROCESO REAL: CONTIENE "S" PARA ACTIVAR                           |        *    Proceso real: contiene "SI" para activar 
      * TODO: FIJO EN "N" PARA PRUEBAS                                       |        * TODO: fijo en "NO" para pruebas
           03 P-PROCESO-REAL            PIC X VALUE "N".                     |             03 P-proceso-real            pic xx value "NO".
           88 PROCESO-REAL              VALUE "S".                           |             88 PROCESO-REAL              value "SI".

      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt                      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
           03 P-FILE-NAME               PIC X(80) VALUE SPACES.              |             03 P-file-name               pic x(80) value spaces.
           03 P-FILE-NAME-R             REDEFINES P-FILE-NAME.               |             03 P-file-name-R             redefines P-file-name.
      *        JJJJJJ = Codigo de suscriptor JURAD en Experian                        *        JJJJJJ = Codigo de suscriptor JURAD en Experian
               05 P-COD-SUSCRIPTOR      PIC 9(6).                            |                 05 P-cod-suscriptor      pic 9(6).
      *        AAA = CODIFICACION DEL PRODUCTO ("100")                       |        *        aaa = Codificacion del producto ("100")
               05 P-PRODUCTO            PIC XXX.                             |                 05 P-producto            pic xxx.
      *        DDMMAA = Fecha de proceso                                              *        DDMMAA = Fecha de proceso
               05 P-FECHA-PROCESO       PIC X(6).                            |                 05 P-fecha-proceso       pic x(6).
      *        bb =  01 a CI                                                          *        bb =  01 a CI
               05 P-CI-BI               PIC XX.                              |                 05 P-ci-bi               pic xx.
      *        XX = Tipo de proceso                                                   *        XX = Tipo de proceso
      *        01 Envio Original - Carga TOTAL - primera vez                          *        01 Envio Original - Carga TOTAL - primera vez
      *        02 Archivo Semanal - Carga PARCIAL                                     *        02 Archivo Semanal - Carga PARCIAL
      *        03 Archivo Mensual - Carga PARCIAL                                     *        03 Archivo Mensual - Carga PARCIAL
      *        04 Refresque Total - Carga TOTAL                                       *        04 Refresque Total - Carga TOTAL
               05 P-TIPO-PROCESO        PIC XX.                              |                 05 P-tipo-proceso        pic xx.
      *        EXTENSION DEL ARCHIVO ".txt"                                  |        *        extension del archivo ".txt"
               05 P-EXTENSION           PIC X(4).                            |                 05 P-extension           pic x(4).
               05                       PIC X(57).                           |                 05                       pic x(57).
           03 P-FILE-PATH               PIC X(80) VALUE SPACES.              <  
      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt                 * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt
          03 ERRS-FILE-NAME             PIC X(80) VALUE SPACES.              |            03 ERRS-file-name             pic x(80) value spaces.

      * Fecha de proceso editada YYYYMMDD                                             * Fecha de proceso editada YYYYMMDD
       01 P-FECHA-PROCESO-YYYYMMDD      PIC X(8).                            |         01 P-fecha-proceso-YYYYMMDD      pic x(8).
      * Fecha de proceso + 50 aÃ±os                                                   * Fecha de proceso + 50 aÃ±os
       01 P-FECHA-PROCESO-50.                                                |         01 P-fecha-proceso-50.
           03  P-FECHA-PROCESO-50YYYY   PIC 9999.                            |             03  P-fecha-proceso-50YYYY   pic 9999.
           03                           PIC X(4).                            |             03                           pic x(4).
      ******************************************************************              ******************************************************************
      * Datos para el reporte final                                                   * Datos para el reporte final
       01 W-TIEMPO.                                                          |         01 W-tiempo.
           03 W-HORA-INICIO             PIC 9(8).                            |             03 W-hora-inicio             pic 9(8).
           03 W-HORA-FIN                PIC 9(8).                            |             03 W-hora-fin                pic 9(8).
       01 N-EDIT                        PIC Z(8)B.                           |         01 N-edit                        pic z(8)B.
       01 N-CONTADORES.                                                      |         01 N-contadores.
      *    Registros en el archivo de entrada                                         *    Registros en el archivo de entrada
           03 N-REG-LEIDOS              PIC 9(8) VALUE ZERO.                 |             03 N-reg-leidos              pic 9(8) value zero.
      *    Registros procesados sin error                                             *    Registros procesados sin error
           03 N-REG-OK                  PIC 9(8) VALUE ZERO.                 |             03 N-reg-OK                  pic 9(8) value zero.
      *    Registros con error                                                        *    Registros con error
           03 N-REG-CON-ERROR           PIC 9(8) VALUE ZERO.                 |             03 N-reg-con-error           pic 9(8) value zero.

      *    Cantidades de registros por tipo de novedad                                *    Cantidades de registros por tipo de novedad
           03 N-REG-TIPO-I-OK           PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-I-OK           pic 9(8) value zero.
           03 N-REG-TIPO-M-OK           PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-M-OK           pic 9(8) value zero.
           03 N-REG-TIPO-E-OK           PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-E-OK           pic 9(8) value zero.
           03 N-REG-TIPO-I-ERR          PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-I-err          pic 9(8) value zero.
           03 N-REG-TIPO-M-ERR          PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-M-err          pic 9(8) value zero.
           03 N-REG-TIPO-E-ERR          PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-E-err          pic 9(8) value zero.

      *    Alertas borradas previo al refresque total                                 *    Alertas borradas previo al refresque total
           03 N-ALE-BORRADAS            PIC 9(8) VALUE ZERO.                 |             03 N-ale-borradas            pic 9(8) value zero.
      *    Alertas insertadas                                                         *    Alertas insertadas
           03 N-ALE-INSERTADAS          PIC 9(8) VALUE ZERO.                 |             03 N-ale-insertadas          pic 9(8) value zero.
      *    Alertas modificadas                                                        *    Alertas modificadas
           03 N-ALE-MODIFICADAS         PIC 9(8) VALUE ZERO.                 |             03 N-ale-modificadas         pic 9(8) value zero.
      *    Alertas eliminadas                                                         *    Alertas eliminadas
           03 N-ALE-ELIMINADAS          PIC 9(8) VALUE ZERO.                 |             03 N-ale-eliminadas          pic 9(8) value zero.
      *    Insercion de alerta existente                                              *    Insercion de alerta existente
           03 N-ALE-YA-EXISTE           PIC 9(8) VALUE ZERO.                 |             03 N-ale-ya-existe           pic 9(8) value zero.
      *    Modificacion o eliminacion de alerta inexistente                           *    Modificacion o eliminacion de alerta inexistente
           03 N-ALE-NO-EXISTE           PIC 9(8) VALUE ZERO.                 |             03 N-ale-no-existe           pic 9(8) value zero.

      ******************************************************************              ******************************************************************
      * Armado de las lineas de alerta                                                * Armado de las lineas de alerta
       01 LA-LINEAS-ALERTA.                                                  |         01 LA-lineas-alerta.
      *    Los modelos a continuacion deberan obtenerse de un                         *    Los modelos a continuacion deberan obtenerse de un 
      *    archivo, como BDIIALE-ALERTAS                                              *    archivo, como BDIIALE-ALERTAS
           03 LAEND                     PIC 999 COMP VALUE 0.                |             03 LAend                     pic 999 comp value 0.
           03 LA-MODELOS.                                                    |             03 LA-modelos.
      *         12345678901234567890123456789012345678901234567890                    *         12345678901234567890123456789012345678901234567890
               05 PIC X(50) VALUE                                            |                 05 pic x(50) value
               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".                           "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".
               05 PIC X(50) VALUE                                            |                 05 pic x(50) value
               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".                            "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
               05 PIC X(50) VALUE                                            |                 05 pic x(50) value
               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".                           "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".
               05 PIC X(50) VALUE                                            |                 05 pic x(50) value
               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".                           "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
               05 PIC X(50) VALUE HIGH-VALUES. *> END MARKER                 |                 05 pic x(50) value high-values. *> end marker
           03 LA-MODELOS2               REDEFINES LA-MODELOS.                |             03 LA-modelos2               redefines LA-modelos.
               05 LA-MODELO             PIC X(50) OCCURS 5                   |                 05 LA-modelo             pic x(50) occurs 5 
                                        INDEXED LAM.                         |                                          indexed LAm.
      *    Funcionamiento de los templates.                                           *    Funcionamiento de los templates.
      *    Hay dos templates por de alerta, uno por linea.                            *    Hay dos templates por de alerta, uno por linea.
      *    Cada template consiste en hasta 10 frases fijas con                        *    Cada template consiste en hasta 10 frases fijas con
      *    ampersands (&) donde se van a reemplazar los valores.                      *    ampersands (&) donde se van a reemplazar los valores.
      *    Por ejemplo:                                                               *    Por ejemplo: 
      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS                                 *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
      *    tiene 3 frases fijas y 2 reemplazos.                                       *    tiene 3 frases fijas y 2 reemplazos. 
      *    La cantidad de ampersands es irrelevante, pero parece                      *    La cantidad de ampersands es irrelevante, pero parece
      *    conveniente que informe sobre el tamanio del contenido.                    *    conveniente que informe sobre el tamanio del contenido.
           03 LA-TEMPLATES.                                                  |             03 LA-templates.
               05 LA-TEMPLATE           OCCURS 4 INDEXED LAX.                |                 05 LA-template           occurs 4 indexed LAx.
                   07 LA-PARTE          PIC X(50)                            |                     07 LA-parte          pic x(50)
                                        OCCURS 10 INDEXED LAY.               |                                          occurs 10 indexed LAy.
      *    Las dos lineas armadas                                                     *    Las dos lineas armadas
           03 LA-LINEAS.                                                     |             03 LA-lineas.
               05 LA-LINEA1             PIC X(50).                           |                 05 LA-linea1             pic x(50).
               05 LA-LINEA2             PIC X(50).                           |                 05 LA-linea2             pic x(50).
      *    Los valores a insertar en una linea                                        *    Los valores a insertar en una linea
           03 LA-VALORES.                                                    |             03 LA-valores.
               05 LA-VALOR              PIC X(50)                            |                 05 LA-valor              pic x(50) 
                                        OCCURS 10 INDEXED LAV.               |                                          occurs 10 indexed LAv.
      *    Datos para editar valores a insertar                                       *    Datos para editar valores a insertar
           03 LA-NUM                    PIC -(11)0.                          |             03 LA-num                    pic -(11)0.
           03 LA-NUMX                   REDEFINES LA-NUM                     |             03 LA-numX                   redefines LA-num
                                        PIC X(12).                           |                                          pic x(12).
           03 LA-DESCARTE               PIC X(50).                           |             03 LA-descarte               pic x(50).


      ******************************************************************              ******************************************************************
      * Errores de consistencia del input                                             * Errores de consistencia del input
      * Cada error tiene un codigo de 2 digitos, un espacio, contador                 * Cada error tiene un codigo de 2 digitos, un espacio, contador
      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59                  * de ocurrencias de 7 digitos, un espacio, y descripcion de 59
       01 E-ERRORES.                                                         |         01 E-errores.
      *    indica si el registro actual tiene error                                   *    indica si el registro actual tiene error
           03 E-HAY-ERROR               PIC XX VALUE "NO".                   |             03 E-hay-error               pic xx value "NO".
      *    errores del registro actual                                                *    errores del registro actual
           03 E-ERRORES-REG             PIC X(100) VALUE SPACES.             |             03 E-errores-reg             pic x(100) value spaces.
      *    contador de registros con error                                            *    contador de registros con error
           03 E-CONT-REGS-CON-ERROR     PIC 9(8) VALUE ZERO.                 |             03 E-cont-regs-con-error     pic 9(8) value zero.
      *    tabla de errores                                                           *    tabla de errores
           03 PIC X(11) VALUE "01 0000000 ".                                 |             03 pic x(11) value "01 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Tipo de movimiento invalido, debe ser I M E T".                                "Tipo de movimiento invalido, debe ser I M E T".
           03 PIC X(11) VALUE "02 0000000 ".                                 |             03 pic x(11) value "02 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Tipo de identificacion invalido, debe ser 1 2 3 4".                            "Tipo de identificacion invalido, debe ser 1 2 3 4".
           03 PIC X(11) VALUE "03 0000000 ".                                 |             03 pic x(11) value "03 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de identificacion invalido, debe ser numerico".                         "Numero de identificacion invalido, debe ser numerico".
           03 PIC X(11) VALUE "04 0000000 ".                                 |             03 pic x(11) value "04 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Tipo de identificacion debe ser mayor que cero".                               "Tipo de identificacion debe ser mayor que cero".
           03 PIC X(11) VALUE "05 0000000 ".                                 |             03 pic x(11) value "05 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Falta el nombre o denominacion".                                               "Falta el nombre o denominacion".
           03 PIC X(11) VALUE "06 0000000 ".                                 |             03 pic x(11) value "06 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de demandas vigentes: debe ser numerico".                               "Numero de demandas vigentes: debe ser numerico".
           03 PIC X(11) VALUE "07 0000000 ".                                 |             03 pic x(11) value "07 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de demandas terminadas: debe ser numerico".                             "Numero de demandas terminadas: debe ser numerico".
           03 PIC X(11) VALUE "08 0000000 ".                                 |             03 pic x(11) value "08 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".                     "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
           03 PIC X(11) VALUE "09 0000000 ".                                 |             03 pic x(11) value "09 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".                        "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
           03 PIC X(11) VALUE "10 0000000 ".                                 |             03 pic x(11) value "10 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de embargos vigentes: debe ser numerico".                               "Numero de embargos vigentes: debe ser numerico".
           03 PIC X(11) VALUE "11 0000000 ".                                 |             03 pic x(11) value "11 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de embargos terminados: debe ser numerico".                             "Numero de embargos terminados: debe ser numerico".
           03 PIC X(11) VALUE "12 0000000 ".                                 |             03 pic x(11) value "12 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".                     "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
           03 PIC X(11) VALUE "13 0000000 ".                                 |             03 pic x(11) value "13 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".                        "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
           03 PIC X(11) VALUE "14 0000000 ".                                 |             03 pic x(11) value "14 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "El numero de id no se encuentra en el archivo maestro".                        "El numero de id no se encuentra en el archivo maestro".
           03 PIC X(11) VALUE "15 0000000 ".                                 |             03 pic x(11) value "15 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "El nombre en el input no coincide con el registrado".                          "El nombre en el input no coincide con el registrado".
           03 PIC X(11) VALUE "16 0000000 ".                                 |             03 pic x(11) value "16 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de id fuera del rango del tipo de id informado".                        "Numero de id fuera del rango del tipo de id informado".
      *----------------- insertar nuevos items aqui -------------------               *----------------- insertar nuevos items aqui -------------------
           03 PIC X(11) VALUE "00 0000000 ".                                 |             03 pic x(11) value "00 0000000 ".
           03 PIC X(59) VALUE "--- fin de la lista (cod 00) ---".            |             03 pic x(59) value "--- fin de la lista (cod 00) ---".
           03                           PIC X(3500). *> LOS 50 ITEMS         |             03                           pic x(3500). *> los 50 items
       01 E-ERRORES-2                   REDEFINES E-ERRORES.                 |         01 E-errores-2                   redefines E-errores.
           03                           PIC XX.                              |             03                           pic xx.
           03                           PIC X(100).                          |             03                           pic x(100).
           03                           PIC 9(8).                            |             03                           pic 9(8).
           03 E-ERROR                   OCCURS 50 INDEXED EX.                |             03 E-error                   occurs 50 indexed Ex.
               05 E-CODIGO              PIC XX.                              |                 05 E-codigo              pic xx.
               05                       PIC X.                               |                 05                       pic x.
               05 E-CONTADOR            PIC 9(7).                            |                 05 E-contador            pic 9(7).
               05                       PIC X.                               |                 05                       pic x.
               05 E-DESCRIPCION         PIC X(59).                           |                 05 E-descripcion         pic x(59).
       01 E-EDIT                        PIC Z(8)B.                           |         01 E-edit                        pic z(8)B.

      ******************************************************************              ******************************************************************
      * Control de rangos de valores de las fechas del input                          * Control de rangos de valores de las fechas del input
       01 VALIDACIONES-FECHAS.                                                         01 VALIDACIONES-FECHAS.
           02 ANO-VAL-X                 PIC 9(04).                           |             02 ANO-VAL-X                 pic 9(04).
              88 ANO-VAL                VALUE 1900 THRU 2050.                |                88 ANO-VAL                value 1900 thru 2050.
           02 MES-VAL-X                 PIC 9(02).                           |             02 MES-VAL-X                 pic 9(02).
              88 MES-VAL                VALUE 01   THRU 12.                  |                88 MES-VAL                value 01   thru 12.
           02 DIA-VAL-X                 PIC 9(02).                           |             02 DIA-VAL-X                 pic 9(02).
              88 DIA-VAL                VALUE 01   THRU 31.                  |                88 DIA-VAL                value 01   thru 31.

      /*****************************************************************              /*****************************************************************
      ******************************************************************              ******************************************************************
       PROCEDURE DIVISION.                                                             PROCEDURE DIVISION.
      *    0000-PROGRAMA-PRINCIPAL                                                    *    0000-PROGRAMA-PRINCIPAL
      *    4000-PROCESAR-REGISTRO                                                     *    4000-PROCESAR-REGISTRO
      *    4000-PROCESAR-REGISTRO-2                                                   *    4000-PROCESAR-REGISTRO-2
      *    4100-VALIDACION-FORMAL                                                     *    4100-VALIDACION-FORMAL
      *    4200-VALIDACION-SEMANTICA                                                  *    4200-VALIDACION-SEMANTICA
      *    4300-MODIFICAR-BDIIALE                                                     *    4300-MODIFICAR-BDIIALE
      *    4300-MODIFICAR-BDIIALE-DATOS                                               *    4300-MODIFICAR-BDIIALE-DATOS
      *    4300-MODIFICAR-BDIIALE-I                                                   *    4300-MODIFICAR-BDIIALE-I
      *    4300-MODIFICAR-BDIIALE-M                                                   *    4300-MODIFICAR-BDIIALE-M
      *    4300-MODIFICAR-BDIIALE-E                                                   *    4300-MODIFICAR-BDIIALE-E
      *    4333-LEER-BDIIALE-RANDOM                                                   *    4333-LEER-BDIIALE-RANDOM
      *    4333-GRABAR-BDIIALE                                                        *    4333-GRABAR-BDIIALE
      *    4333-REGRABAR-BDIIALE                                                      *    4333-REGRABAR-BDIIALE
      *    4333-ELIMINAR-BDIIALE                                                      *    4333-ELIMINAR-BDIIALE
      *    4900-GRABAR-ERROR                                                          *    4900-GRABAR-ERROR
      *    4320-ARMAR-TEXTO-ALERTA                                                    *    4320-ARMAR-TEXTO-ALERTA
      *    1000-RUTINA-INICIAL                                                        *    1000-RUTINA-INICIAL
      *    1001-ELIMINAR-TODO                                                         *    1001-ELIMINAR-TODO
      *    7000-RUTINA-FINAL                                                          *    7000-RUTINA-FINAL
      *    9000-CANCELAR-PROGRAMA                                                     *    9000-CANCELAR-PROGRAMA


       0000-PROGRAMA-PRINCIPAL.                                                        0000-PROGRAMA-PRINCIPAL.
      ******************************************************************              ******************************************************************
      *    inicializa el ambiente y abre los archivos                                 *    inicializa el ambiente y abre los archivos
           PERFORM 1000-RUTINA-INICIAL                                       |             perform 1000-RUTINA-INICIAL
      *    procesa cada uno de los registros del archivo JURAD hasta                  *    procesa cada uno de los registros del archivo JURAD hasta
      *    ENCONTRAR EL REGISTRO "T" DE TOTALES                              |        *    encontrar el registro "T" de totales
           PERFORM 4000-PROCESAR-REGISTRO UNTIL IND-FIN-PROCESO = "SI"       |             perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
      *    cierra archivos y produce el reporte final                                 *    cierra archivos y produce el reporte final
           PERFORM 7000-RUTINA-FINAL                                         |             perform 7000-RUTINA-FINAL
           GOBACK.                                                           |             goback.

       4000-PROCESAR-REGISTRO.                                                         4000-PROCESAR-REGISTRO.
      ****************************************************************                ****************************************************************
      * Proceso de un registro del archivo de entrada JURAD                           * Proceso de un registro del archivo de entrada JURAD
      * Lectura y control del file status del archivo                                 * Lectura y control del file status del archivo
      ****************************************************************                ****************************************************************
      *    lectura del proximo registro                                               *    lectura del proximo registro
           READ JURAD                                                        |             read JURAD
           EVALUATE JURAD-FS                                                 |             evaluate JURAD-fs
           WHEN "00"                                                         |             when "00"
      *        controla el reg y lo aplica si es OK                                   *        controla el reg y lo aplica si es OK
               PERFORM 4000-PROCESAR-REGISTRO-2                              |                 perform 4000-PROCESAR-REGISTRO-2
               MOVE JURAD-REG TO JURAD-REG-ANTERIOR                          |                 move JURAD-reg to JURAD-reg-anterior
           WHEN "10"                                                         |             when "10"
      *        fin del archivo de input:                                              *        fin del archivo de input:
      *        ESTO ES UN ERROR, NO SE ENCONTRO EL REGISTRO "T" ANTES        |        *        esto es un error, no se encontro el registro "T" antes
      *        de que se terminara el archivo                                         *        de que se terminara el archivo
               DISPLAY "Falta el reg de totales del archivo JURAD "          |                 display "Falta el reg de totales del archivo JURAD "
               DISPLAY "Nombre del archivo: " P-FILE-NAME                    |                 display "Nombre del archivo: " P-file-name
               DISPLAY "File status: " JURAD-FS                              |                 display "File status: " JURAD-fs
               DISPLAY "Ultimo registro leido: " N-REG-LEIDOS                |                 display "Ultimo registro leido: " N-reg-leidos
               DISPLAY JURAD-REG-ANTERIOR                                    |                 display JURAD-reg-anterior
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           WHEN OTHER                                                        |             when other
      *        error de lectura: cancelacion del proceso                              *        error de lectura: cancelacion del proceso
               DISPLAY "Error en lectura del archivo JURAD "                 |                 display "Error en lectura del archivo JURAD "
               DISPLAY "Nombre del archivo: " P-FILE-NAME                    |                 display "Nombre del archivo: " P-file-name
               DISPLAY "File status: " JURAD-FS                              |                 display "File status: " JURAD-fs
               DISPLAY "Ultimo registro leido: " N-REG-LEIDOS                |                 display "Ultimo registro leido: " N-reg-leidos
               DISPLAY JURAD-REG-ANTERIOR                                    |                 display JURAD-reg-anterior
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4000-PROCESAR-REGISTRO-2.                                                       4000-PROCESAR-REGISTRO-2.
      ****************************************************************                ****************************************************************
      * Controla los datos de un registro de JURAD y si es OK lo usa                  * Controla los datos de un registro de JURAD y si es OK lo usa
      * para actualizar el archivo de alertas en linea                                * para actualizar el archivo de alertas en linea
      * La informacion esta leida en JURAD-reg                                        * La informacion esta leida en JURAD-reg
      ****************************************************************                ****************************************************************
           MOVE "NO" TO E-HAY-ERROR                                          |             move "NO" to E-hay-error

      *    validacion del tipo de movimiento                                          *    validacion del tipo de movimiento
           IF JURAD-TIPO-NOVEDAD NOT = "I" and "M" and "E" and "T"           |             if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 
               CALL "PONERR" using "01" JURAD-REG E-ERRORES                  |                 call "PONERR" using "01" JURAD-reg E-errores
           END-IF                                                            |             end-if

      *    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESO          |        *    si es el registro "T" hay que senialar el fin de proceso
           IF JURAD-TIPO-NOVEDAD = "T"                                       |             if JURAD-tipo-novedad = "T" 
               MOVE "SI" TO IND-FIN-PROCESO                                  |                 move "SI" to IND-fin-proceso
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if

           ADD 1 TO N-REG-LEIDOS                                             |             add 1 to N-reg-leidos

      *    validacion formal de los datos                                             *    validacion formal de los datos
           PERFORM 4100-VALIDACION-FORMAL                                    |             perform 4100-VALIDACION-FORMAL
           IF E-HAY-ERROR = "SI"                                             |             if E-hay-error = "SI"
               PERFORM 4900-GRABAR-ERROR                                     |                 exit paragraph
               EXIT PARAGRAPH                                                |             end-if
           END-IF                                                            <  

      *    si la validacion formal dio OK se hace validacion semantica                *    si la validacion formal dio OK se hace validacion semantica
           PERFORM 4200-VALIDACION-SEMANTICA                                 |             perform 4200-VALIDACION-SEMANTICA
           IF E-HAY-ERROR = "SI"                                             |             if E-hay-error = "SI"
               PERFORM 4900-GRABAR-ERROR                                     |                 exit paragraph
               EXIT PARAGRAPH                                                |             end-if
           END-IF                                                            <  

      *    intento de actualizacion de BDIIALE                               |        *    actualizacion de BDIIALE o grabacion en arch ERRS de defectos
           PERFORM 4300-MODIFICAR-BDIIALE                                    |             if E-hay-error = "SI"
           ADD 1 TO N-REG-OK.                                                |                 perform 4900-GRABAR-ERROR
                                                                             >                 add 1 to N-reg-con-error
                                                                             >             else
                                                                             >                 perform 4300-MODIFICAR-BDIIALE
                                                                             >                 add 1 to N-reg-OK
                                                                             >             end-if.



       4100-VALIDACION-FORMAL.                                                         4100-VALIDACION-FORMAL.
      ******************************************************************              ******************************************************************
      * Validacion formal de los datos del input                                      * Validacion formal de los datos del input
      ******************************************************************              ******************************************************************
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                 *    Tipo de identificacion Numero {1, 2, 3, 4}
           IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"                |             if JURAD-id-tipo not = "1" and "2" and "3" and "4"
               CALL "PONERR" USING "02" JURAD-REG E-ERRORES                  |                 call "PONERR" using "02" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de identificacion                                                   *    Numero de identificacion
           IF JURAD-ID-NUMEROX IS NOT NUMERIC                                |             if JURAD-id-numeroX is not numeric
               CALL "PONERR" USING "03" JURAD-REG E-ERRORES                  |                 call "PONERR" using "03" JURAD-reg E-errores
           END-IF                                                            |             end-if
           IF JURAD-ID-NUMERO NOT > 0                                        |             if JURAD-id-numero not > 0
               CALL "PONERR" USING "04" JURAD-REG E-ERRORES                  |                 call "PONERR" using "04" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    si el movimiento es una eliminacion los datos subsiguientes                *    si el movimiento es una eliminacion los datos subsiguientes
      *    no se controlan                                                            *    no se controlan
           IF JURAD-TIPO-NOVEDAD = "E"                                       |             if JURAD-tipo-novedad = "E"
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if
      *    Nombres y Apellidos                                                        *    Nombres y Apellidos
           IF JURAD-NOMBRE = SPACES                                          |             if JURAD-nombre = spaces
               CALL "PONERR" USING "05" JURAD-REG E-ERRORES                  |                 call "PONERR" using "05" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de demandas vigentes                                                *    Numero de demandas vigentes
           IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC                         |             if JURAD-demandas-vigentes is not numeric
               CALL "PONERR" USING "06" JURAD-REG E-ERRORES                  |                 call "PONERR" using "06" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de demandas terminadas                                              *    Numero de demandas terminadas
           IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC                       |             if JURAD-demandas-terminadas is not numeric
               CALL "PONERR" USING "07" JURAD-REG E-ERRORES                  |                 call "PONERR" using "07" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Fecha ultima demanda vigente YYMMDD                                        *    Fecha ultima demanda vigente YYMMDD
           IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC                     |             if JURAD-demandas-fecha-ultima is not numeric
               CALL "PONERR" USING "08" JURAD-REG E-ERRORES                  |                 call "PONERR" using "08" JURAD-reg E-errores
           END-IF                                                            |             end-if
           MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS           |             move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS
           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL                      |             if not ANO-VAL or not MES-VAL or not DIA-VAL
               CALL "PONERR" USING "09" JURAD-REG E-ERRORES                  |                 call "PONERR" using "09" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de embargos vigentes                                                *    Numero de embargos vigentes
           IF JURAD-EMBARGOS-VIGENTES NOT NUMERIC                            |             if JURAD-embargos-vigentes not numeric
               CALL "PONERR" USING "10" JURAD-REG E-ERRORES                  |                 call "PONERR" using "10" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de embargos terminados                                              *    Numero de embargos terminados
           IF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC                          |             if JURAD-embargos-terminados not numeric
               CALL "PONERR" USING "11" JURAD-REG E-ERRORES                  |                 call "PONERR" using "11" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Fecha ultimo embargo vigente YYMMDD                                        *    Fecha ultimo embargo vigente YYMMDD
           IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC                     |             if JURAD-embargos-fecha-ultimo is not numeric
               CALL "PONERR" USING "12" JURAD-REG E-ERRORES                  |                 call "PONERR" using "12" JURAD-reg E-errores
           END-IF                                                            |             end-if
           MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS           |             move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS
           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL                      |             if not ANO-VAL or not MES-VAL or not DIA-VAL
               CALL "PONERR" USING "13" JURAD-REG E-ERRORES                  |                 call "PONERR" using "13" JURAD-reg E-errores
           END-IF.                                                           |             end-if.


       4200-VALIDACION-SEMANTICA.                                                      4200-VALIDACION-SEMANTICA.
      ****************************************************************                ****************************************************************
      * Validacion del numero de identificacion y de su relacion con                  * Validacion del numero de identificacion y de su relacion con
      * el nombre                                                                     * el nombre
      ****************************************************************                ****************************************************************
           MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE                            |             move JURAD-id-tipo to TIP-IDE-BDIIVIDE
           MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE-R                        |             move JURAD-id-numero to NUM-IDE-BDIIVIDE-R
           MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE                              |             move JURAD-nombre to NOMBRE-BDIIVIDE
           MOVE 1 TO SW-VERIFNOM-BDIIVIDE                                    |             move 1 to SW-VERIFNOM-BDIIVIDE
           MOVE 0 TO SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE             |             move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE
           PERFORM 80100-VALIDAR-IDENTIFICACION                              |             perform 80100-VALIDAR-IDENTIFICACION
      *    a ver si la validacion cambio el tipo de ide                               *    a ver si la validacion cambio el tipo de ide
           IF JURAD-ID-TIPO NOT = TIP-IDE-BDIIVIDE                           |             if JURAD-id-tipo not = TIP-IDE-BDIIVIDE
               CALL "PONERR" USING "16" JURAD-REG E-ERRORES                  |                 call "PONERR" using "16" JURAD-reg E-errores
               DISPLAY "Tipo ide cambiado de " JURAD-id-tipo " a "           |                 display "Tipo ide cambiado de " JURAD-id-tipo " a " 
               TIP-IDE-BDIIVIDE " num ide: " JURAD-ID-NUMERO                 |                 TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero
           END-IF                                                            |             end-if
      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe                          *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe
           IF SW-ID-BDIIVIDE = 1                                             |             if SW-ID-BDIIVIDE = 1
               CALL "PONERR" USING "14" JURAD-REG E-ERRORES                  |                 call "PONERR" using "14" JURAD-reg E-errores
           ELSE                                                              |             else
      *        existe id, a ver si el nombre coincide                                 *        existe id, a ver si el nombre coincide
               IF SW-NOMBRES-BDIIVIDE = 1    *> NOMBRE NO COINCIDE           |                 if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide
                   CALL "PONERR" USING "15" JURAD-REG E-ERRORES              |                     call "PONERR" using "15" JURAD-reg E-errores
                   DISPLAY "novedad:  " JURAD-NOMBRE                         |                     display "novedad:  " JURAD-nombre
                   DISPLAY "registro: " NOM-LEIDO-BDIIVIDE                   |                     display "registro: " NOM-LEIDO-BDIIVIDE
               END-IF                                                        |                 end-if
           END-IF.                                                           |             end-if.


       4300-MODIFICAR-BDIIALE.                                                         4300-MODIFICAR-BDIIALE.
      ******************************************************************              ******************************************************************
      * Se impacta el archivo BDIIALE con una o dos inserciones,                      * Se impacta el archivo BDIIALE con una o dos inserciones, 
      * modificaciones o eliminaciones segun haya o no demandas y                     * modificaciones o eliminaciones segun haya o no demandas y 
      * embargos                                                                      * embargos
      ******************************************************************              ******************************************************************
           INITIALIZE REG-BDIIALE                                            |             initialize REG-BDIIALE

      *    si hay demandas                                                            *    si hay demandas
           IF JURAD-DEMANDAS-VIGENTES > ZERO                                 |             if JURAD-demandas-vigentes > zero
           OR JURAD-DEMANDAS-TERMINADAS > ZERO                               |             or JURAD-demandas-terminadas > zero 
               MOVE "J001" TO LLASEC-BDIIALE                                 |                 move "J001" to LLASEC-BDIIALE
      *        arma datos de demandas                                                 *        arma datos de demandas
               MOVE JURAD-DEMANDAS-VIGENTES TO D-VIGENTES                    |                 move JURAD-demandas-vigentes to D-vigentes
               MOVE JURAD-DEMANDAS-TERMINADAS TO D-TERMINADOS                |                 move JURAD-demandas-terminadas to D-terminados
               STRING "20" JURAD-DEMANDAS-FECHA-ULTIMA                       |                 string "20" JURAD-demandas-fecha-ultima 
               DELIMITED SIZE INTO D-FECHA-ULTIMA                            |                 delimited size into D-fecha-ultima
               PERFORM 4300-MODIFICAR-BDIIALE-DATOS                          |                 perform 4300-MODIFICAR-BDIIALE-DATOS 
           END-IF.                                                           |             end-if.

      *    si hay embargos                                                            *    si hay embargos
           IF JURAD-EMBARGOS-VIGENTES > ZERO                                 |             if JURAD-embargos-vigentes > zero
           OR JURAD-EMBARGOS-TERMINADOS > ZERO                               |             or JURAD-embargos-terminados > zero 
               MOVE "J002" TO LLASEC-BDIIALE                                 |                 move "J002" to LLASEC-BDIIALE
      *        arma datos de embargos                                                 *        arma datos de embargos
               MOVE JURAD-EMBARGOS-VIGENTES TO D-VIGENTES                    |                 move JURAD-embargos-vigentes to D-vigentes
               MOVE JURAD-EMBARGOS-TERMINADOS TO D-TERMINADOS                |                 move JURAD-embargos-terminados to D-terminados
               STRING "20" JURAD-EMBARGOS-FECHA-ULTIMO                       |                 string "20" JURAD-embargos-fecha-ultimo
               DELIMITED SIZE INTO D-FECHA-ULTIMA                            |                 delimited size into D-fecha-ultima
               PERFORM 4300-MODIFICAR-BDIIALE-DATOS                          |                 perform 4300-MODIFICAR-BDIIALE-DATOS 
           END-IF.                                                           |             end-if.



       4300-MODIFICAR-BDIIALE-DATOS.                                                   4300-MODIFICAR-BDIIALE-DATOS.
      ******************************************************************              ******************************************************************
      * Parte de la carga de datos en el registro BDIIALE y grabacion                 * Parte de la carga de datos en el registro BDIIALE y grabacion
      * del mismo que es comun a demandas y embargos                                  * del mismo que es comun a demandas y embargos
      * EL DATO LLASEC-BDIIALE YA TIENE "J001" o "J002"                      |        * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
      ******************************************************************              ******************************************************************
      *    completa la clave e intenta leer la alerta, si se leyo OK                  *    completa la clave e intenta leer la alerta, si se leyo OK
      *    EL FILE STATUS DE BDIIALE QUEDA CON "00"                          |        *    el file status de BDIIALE queda con "00"
           PERFORM 4333-LEER-BDIIALE-RANDOM                                  |             perform 4333-LEER-BDIIALE-RANDOM

      *    procesa segun el tipo de novedad I M E                                     *    procesa segun el tipo de novedad I M E
           EVALUATE JURAD-TIPO-NOVEDAD                                       |             evaluate JURAD-tipo-novedad
           WHEN "I"                                                          |             when "I"
               ADD 1 TO N-REG-TIPO-I-OK                                      |                 add 1 to N-reg-tipo-I-OK
               PERFORM 4300-MODIFICAR-BDIIALE-I                              |                 perform 4300-MODIFICAR-BDIIALE-I
           WHEN "M"                                                          |             when "M"
               ADD 1 TO N-REG-TIPO-M-OK                                      |                 add 1 to N-reg-tipo-M-OK
               PERFORM 4300-MODIFICAR-BDIIALE-M                              |                 perform 4300-MODIFICAR-BDIIALE-M
           WHEN "E"                                                          |             when "E"
               ADD 1 TO N-REG-TIPO-E-OK                                      |                 add 1 to N-reg-tipo-E-OK
               PERFORM 4300-MODIFICAR-BDIIALE-E                              |                 perform 4300-MODIFICAR-BDIIALE-E
           WHEN OTHER                                                        |             when other
      *        ESTO ES "imposible" POR CONTROL DE CONSISTENCIA ANTERIOR      |        *        esto es "imposible" por control de consistencia anterior
               DISPLAY "error de logica: tipo-novedad="                      |                 display "error de logica: tipo-novedad="
               JURAD-TIPO-NOVEDAD " reg nÂ°: " N-REG-LEIDOS                  |                 JURAD-tipo-novedad " reg nÃÂ°: " N-reg-leidos
               DISPLAY "Registro de JURAD: " DISPLAY JURAD-REG               |                 display "Registro de JURAD: " display JURAD-reg
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4300-MODIFICAR-BDIIALE-I.                                                       4300-MODIFICAR-BDIIALE-I.
      ******************************************************************              ******************************************************************
      * Insercion de una alerta nueva                                                 * Insercion de una alerta nueva
      * Si ya existia muestra un mensaje y continua                                   * Si ya existia muestra un mensaje y continua
      ******************************************************************              ******************************************************************
      *    si el registro existia es un error                                         *    si el registro existia es un error
           IF EST-BDIIALE = "00"                                             |             if EST-BDIIALE = "00"
               DISPLAY "Insercion de alerta nueva que ya existe "            |                 display "Insercion de alerta nueva que ya existe "
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro de input: "                                 |                 display "Registro de input: "
               DISPLAY JURAD-REG                                             |                 display JURAD-reg
               DISPLAY "Datos en la alerta: " INF-DATAHOST-BDIIALE           |                 display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               ADD 1 TO N-ALE-YA-EXISTE                                      |                 add 1 to N-ale-ya-existe
           END-IF                                                            |             end-if

      *    completa los datos del registro                                            *    completa los datos del registro
           INITIALIZE ENCABEZADO-BDIIALE                                     |             initialize ENCABEZADO-BDIIALE
           MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-NOV-BDIIALE                  |             move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE
           FEC-REP-BDIIALE                                                                 FEC-REP-BDIIALE 
           MOVE P-FECHA-PROCESO-50 TO FEC-VEN-BDIIALE                        |             move P-fecha-proceso-50 to FEC-VEN-BDIIALE
           MOVE 0 TO BLOQUEO-BDIIALE                                         |             move 0 to BLOQUEO-BDIIALE
           MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE                           |             move D-datahost to INF-DATAHOST-BDIIALE
           PERFORM 4320-ARMAR-TEXTO-ALERTA                                   |             perform 4320-ARMAR-TEXTO-ALERTA
           IF EST-BDIIALE = "00"                                             |             if EST-BDIIALE = "00"
               PERFORM 4333-REGRABAR-BDIIALE                                 |                 perform 4333-REGRABAR-BDIIALE
           ELSE                                                              |             else
               PERFORM 4333-GRABAR-BDIIALE                                   |                 perform 4333-GRABAR-BDIIALE
           END-IF.                                                           |             end-if.


       4300-MODIFICAR-BDIIALE-M.                                                       4300-MODIFICAR-BDIIALE-M.
      ******************************************************************              ******************************************************************
      * Modificacion de una alerta existente                                          * Modificacion de una alerta existente
      * Si no existia muestra un mensaje y continua                                   * Si no existia muestra un mensaje y continua
      ******************************************************************              ******************************************************************
      *    si el registro no existia es un error                                      *    si el registro no existia es un error
           IF EST-BDIIALE NOT = "00"                                         |             if EST-BDIIALE not = "00"
               DISPLAY "Modificacion de alerta inexistente "                 |                 display "Modificacion de alerta inexistente "
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro de input: "                                 |                 display "Registro de input: "
               DISPLAY JURAD-REG                                             |                 display JURAD-reg
               DISPLAY "Datos en la alerta: " INF-DATAHOST-BDIIALE           |                 display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               ADD 1 TO N-ALE-NO-EXISTE                                      |                 add 1 to N-ale-no-existe
           END-IF                                                            |             end-if
      *    reemplaza la fecha de reporte y los valores                                *    reemplaza la fecha de reporte y los valores
           MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-REP-BDIIALE                  |             move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 
           MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE                           |             move D-datahost to INF-DATAHOST-BDIIALE
           PERFORM 4320-ARMAR-TEXTO-ALERTA                                   |             perform 4320-ARMAR-TEXTO-ALERTA
           IF EST-BDIIALE = "00"                                             |             if EST-BDIIALE = "00"
               PERFORM 4333-REGRABAR-BDIIALE                                 |                 perform 4333-REGRABAR-BDIIALE
           ELSE                                                              |             else
               PERFORM 4333-GRABAR-BDIIALE                                   |                 perform 4333-GRABAR-BDIIALE
           END-IF.                                                           |             end-if.


       4300-MODIFICAR-BDIIALE-E.                                                       4300-MODIFICAR-BDIIALE-E.
      ******************************************************************              ******************************************************************
      * Eliminacion de una alerta                                                     * Eliminacion de una alerta
      * Si no existia muestra un mensaje y continua                                   * Si no existia muestra un mensaje y continua
      ******************************************************************              ******************************************************************
      *    elimina el registro                                                        *    elimina el registro
           IF EST-BDIIALE = "00"                                             |             if EST-BDIIALE = "00"
               PERFORM 4333-ELIMINAR-BDIIALE                                 |                 perform 4333-ELIMINAR-BDIIALE
           ELSE                                                              |             else
               DISPLAY "Eliminacion de alerta inexistente "                  |                 display "Eliminacion de alerta inexistente "
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro de input: "                                 |                 display "Registro de input: "
               DISPLAY JURAD-REG                                             |                 display JURAD-reg
               ADD 1 TO N-ALE-NO-EXISTE                                      |                 add 1 to N-ale-no-existe
           END-IF.                                                           |             end-if.


       4333-LEER-BDIIALE-RANDOM.                                                       4333-LEER-BDIIALE-RANDOM.
      ******************************************************************              ******************************************************************
      * Arma clave exacta y lee un registro de BDIIALE                                * Arma clave exacta y lee un registro de BDIIALE
      * Usa los datos del reg input, excepto LLASEC que esta precargado               * Usa los datos del reg input, excepto LLASEC que esta precargado
      * CUANDO PUDO LEER OK EL FILE STATUS EST-BDIIALE QUEDA CON "00"        |        * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
      ******************************************************************              ******************************************************************
           MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIALE                             |             move JURAD-id-tipo to TIP-IDE-BDIIALE
           MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIALE                           |             move JURAD-id-numero to NUM-IDE-BDIIALE
           MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE                           |             move P-cod-suscriptor to FUENTE-BDIIALE
           MOVE 000 TO COD-ALERTA-BDIIALE                                    |             move 000 to COD-ALERTA-BDIIALE

           READ BDIIALE                                                      |             read BDIIALE
           EVALUATE EST-BDIIALE                                              |             evaluate EST-BDIIALE
           WHEN "00"                                                         |             when "00"
               CONTINUE                                                      |                 continue
           WHEN "20" thru "29"                                               |             when "20" thru "29"
               CONTINUE                                                      |                 continue
           WHEN OTHER                                                        |             when other
               DISPLAY "Error al leer BDIIALE fs: " EST-BDIIALE              |                 display "Error al leer BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Ultimo registro procesado: "                         |                 display "Ultimo registro procesado: "
               DISPLAY JURAD-REG-ANTERIOR                                    |                 display JURAD-reg-anterior
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4333-GRABAR-BDIIALE.                                                            4333-GRABAR-BDIIALE.
      ******************************************************************              ******************************************************************
      * Inserta un registro nuevo en BDIIALE                                          * Inserta un registro nuevo en BDIIALE
      ******************************************************************              ******************************************************************
           IF NOT PROCESO-REAL                                               |             if not PROCESO-REAL
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if
           WRITE REG-BDIIALE                                                 |             write REG-BDIIALE
           EVALUATE EST-BDIIALE                                              |             evaluate EST-BDIIALE
           WHEN "00"                                                         |             when "00"
               ADD 1 TO N-ALE-INSERTADAS                                     |                 add 1 to N-ale-insertadas
           WHEN OTHER                                                        |             when other
               DISPLAY "Error al grabar BDIIALE fs: " EST-BDIIALE            |                 display "Error al grabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro BDIIALE: "                                  |                 display "Registro BDIIALE: "
               DISPLAY REG-BDIIALE                                           |                 display REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4333-REGRABAR-BDIIALE.                                                          4333-REGRABAR-BDIIALE.
      ******************************************************************              ******************************************************************
      * Regraba un registro modificado en BDIIALE                                     * Regraba un registro modificado en BDIIALE
      ******************************************************************              ******************************************************************
           IF NOT PROCESO-REAL                                               |             if not PROCESO-REAL
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if
           REWRITE REG-BDIIALE                                               |             rewrite REG-BDIIALE
           EVALUATE EST-BDIIALE                                              |             evaluate EST-BDIIALE
           WHEN "00"                                                         |             when "00"
               ADD 1 TO N-ALE-MODIFICADAS                                    |                 add 1 to N-ale-modificadas
           WHEN OTHER                                                        |             when other
               DISPLAY "Error al regrabar BDIIALE fs: " EST-BDIIALE          |                 display "Error al regrabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro BDIIALE: "                                  |                 display "Registro BDIIALE: "
               DISPLAY REG-BDIIALE                                           |                 display REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4333-ELIMINAR-BDIIALE.                                                          4333-ELIMINAR-BDIIALE.
      ******************************************************************              ******************************************************************
      * Elimina un registro de BDIIALE                                                * Elimina un registro de BDIIALE
      ******************************************************************              ******************************************************************
           IF NOT PROCESO-REAL                                               |             if not PROCESO-REAL
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if
           DELETE BDIIALE                                                    |             delete BDIIALE
           EVALUATE EST-BDIIALE                                              |             evaluate EST-BDIIALE
           WHEN "00"                                                         |             when "00"
               ADD 1 TO N-ALE-ELIMINADAS                                     |                 add 1 to N-ale-eliminadas
           WHEN OTHER                                                        |             when other
               DISPLAY "Error al regrabar BDIIALE fs: " EST-BDIIALE          |                 display "Error al regrabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro BDIIALE: "                                  |                 display "Registro BDIIALE: "
               DISPLAY REG-BDIIALE                                           |                 display REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4900-GRABAR-ERROR.                                                              4900-GRABAR-ERROR.
      ******************************************************************              ******************************************************************
      * El registro de JURAD tiene error: se graba en el archivo ERRS                 * El registro de JURAD tiene error: se graba en el archivo ERRS
      * con indicacion del error detectado                                            * con indicacion del error detectado
      ******************************************************************              ******************************************************************
           MOVE JURAD-REG TO ERRS-REG                                        |             move JURAD-reg to ERRS-reg
      *    lista de los codigos de los errores del registro                           *    lista de los codigos de los errores del registro
           DISPLAY "Errores del reg: " E-ERRORES-REG                         |             move E-errores-reg to ERRS-causa-rechazo
           MOVE E-ERRORES-REG TO ERRS-CAUSA-RECHAZO                          |             write ERRS-reg
           WRITE ERRS-REG                                                    |             evaluate ERRS-fs
           EVALUATE ERRS-FS                                                  |                 when "00"
           WHEN "00"                                                         |                     continue
               CONTINUE                                                      |                 when other
           WHEN OTHER                                                        |                     display "Error al grabar el archivo de errores "
               DISPLAY "Error al grabar el archivo de errores "              |                     display "Nombre del archivo: " ERRS-file-name
               DISPLAY "Nombre del archivo: " ERRS-FILE-NAME                 |                     display "File status: " ERRS-fs
               DISPLAY "File status: " ERRS-FS                               |                     perform 9000-CANCELAR-PROGRAMA
               PERFORM 9000-CANCELAR-PROGRAMA                                |                     goback
               GOBACK                                                        |             end-evaluate.
           END-EVALUATE.                                                     <  


       4320-ARMAR-TEXTO-ALERTA.                                                        4320-ARMAR-TEXTO-ALERTA.
      ****************************************************************                ****************************************************************
      * Hace el reemplazo de los valores adecuados en los templates                   * Hace el reemplazo de los valores adecuados en los templates
      * de las linea de alerta que corresponde                                        * de las linea de alerta que corresponde
      ****************************************************************                ****************************************************************
      *    segun se trate de demandas o embargos                                      *    segun se trate de demandas o embargos
           IF JURAD-DEMANDAS-VIGENTES NOT = 0                                |             if JURAD-demandas-vigentes not = 0 
           OR JURAD-DEMANDAS-TERMINADAS NOT = 0                              |             or JURAD-demandas-terminadas not = 0
               SET LAX TO 1                                                  |                 set LAx to 1
               MOVE HIGH-VALUES TO LA-VALORES                                |                 move high-values to LA-valores
               MOVE JURAD-DEMANDAS-VIGENTES TO LA-NUM                        |                 move JURAD-demandas-vigentes to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile             * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(1)                          *        unstring LA-numX into LA-descarte LA-valor(1)
      *        delimited by all space                                                 *        delimited by all space
               MOVE LA-NUMX(9:12) TO LA-VALOR(1)                             |                 move LA-numx(9:12) to LA-valor(1)
               MOVE JURAD-DEMANDAS-TERMINADAS TO LA-NUM                      |                 move JURAD-demandas-terminadas to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile             * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(2)                          *        unstring LA-numX into LA-descarte LA-valor(2)
      *        delimited by all space                                                 *        delimited by all space
               MOVE LA-NUMX(9:12) TO LA-VALOR(2)                             |                 move LA-numx(9:12) to LA-valor(2)

      * >>>> esto esta anulado x que no se como hacer para que lo compile             * >>>> esto esta anulado x que no se como hacer para que lo compile
      * >>>> da error en el end-if                                                    * >>>> da error en el end-if
      *        string LA-parte(LAx, 1) LA-valor(1)                                    *        string LA-parte(LAx, 1) LA-valor(1)
      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)              *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)              *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)              *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)              *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
      *        LA-parte(LAx, 10) LA-valor(10)                                         *        LA-parte(LAx, 10) LA-valor(10)
      *        delimited by high-value                                                *        delimited by high-value
           END-IF.                                                           |             end-if.


       1000-RUTINA-INICIAL.                                                            1000-RUTINA-INICIAL.
      ******************************************************************              ******************************************************************
      * Todas las operaciones que se realizan una sola vez, al comienzo               * Todas las operaciones que se realizan una sola vez, al comienzo
      * del programa:                                                                 * del programa:
      *   - obtencion de los parametros                                               *   - obtencion de los parametros
      *   - apertura del archivo de entrada                                           *   - apertura del archivo de entrada
      *   - apertura de todos los demas archivos                                      *   - apertura de todos los demas archivos
      *   - eliminacion de datos existentes si es refresque completo                  *   - eliminacion de datos existentes si es refresque completo
      ******************************************************************              ******************************************************************
      * Registra hora de inicio                                                       * Registra hora de inicio
           ACCEPT W-HORA-INICIO FROM TIME                                    |             accept W-hora-inicio from time

      * Obtiene informacion sobre la corrida de la linea de comando: el               * Obtiene informacion sobre la corrida de la linea de comando: el
      * nombre del archivo de entrada (que contiene el tipo de proceso),              * nombre del archivo de entrada (que contiene el tipo de proceso),
      * el indicador de proceso real o en falso (default)                             * el indicador de proceso real o en falso (default)
           ACCEPT P-COMMAND-LINE FROM COMMAND-LINE                           |             accept P-command-line from COMMAND-LINE
           DISPLAY "Parametros: " P-COMMAND-LINE                             |             display "Parametros: " P-command-line
           UNSTRING P-COMMAND-LINE DELIMITED BY ALL " " INTO                 |             unstring P-command-line delimited by all " " into
           P-FILE-NAME P-PROCESO-REAL                                        |             P-file-name P-proceso-real

      * El programa se anuncia en la consola                                          * El programa se anuncia en la consola
      * TODO: se usa un anuncio mas vistoso                                           * TODO: se usa un anuncio mas vistoso
           IF PROCESO-REAL                                                   |             if PROCESO-REAL
               DISPLAY PGM " Carga de archivo JURAD - proceso REAL"          |                 display pgm " Carga de archivo JURAD - proceso REAL"
           ELSE                                                              |             else
               DISPLAY PGM " Carga de archivo JURAD - proceso en falso"      |                 display pgm " Carga de archivo JURAD - proceso en falso"
           END-IF                                                            |             end-if

      * El indicador de proceso real debe ser S|si|N|no                      |        * El indicador de proceso real debe ser SI|si|NO|no
           IF P-PROCESO-REAL NOT = "S" AND "N"                               |             if P-proceso-real not = "SI" and "NO"
               DISPLAY "El indicador de proceso real es invalido"            |                 display "El indicador de proceso real es invalido"
               DISPLAY "debe ser S o N"                                      |                 display "debe ser SI o NO"
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-IF                                                            |             end-if

      * TODO: controlar los componentes del filename                                  * TODO: controlar los componentes del filename
           EVALUATE P-TIPO-PROCESO                                           |             evaluate P-tipo-proceso
           WHEN "01"                                                         |             when "01"
               DISPLAY "01 Envio Original - Carga TOTAL 1a vez"              |                 display "01 Envio Original - Carga TOTAL 1a vez"
           WHEN "02"                                                         |             when "02"
               DISPLAY "02 Archivo Semanal - Carga PARCIAL"                  |                 display "02 Archivo Semanal - Carga PARCIAL"
           WHEN "03"                                                         |             when "03"
               DISPLAY "03 Archivo Mensual - Carga PARCIAL"                  |                 display "03 Archivo Mensual - Carga PARCIAL"
           WHEN "04"                                                         |             when "04"
               DISPLAY "04 Refresque Total - Carga TOTAL"                    |                 display "04 Refresque Total - Carga TOTAL"
           WHEN OTHER                                                        |             when other
      *        valor invalido                                                         *        valor invalido
               DISPLAY "El tipo de proceso " P-TIPO-PROCESO                  |                 display "El tipo de proceso " P-tipo-proceso
               " es invalido (debe ser 01 02 03 o 04)"                                         " es invalido (debe ser 01 02 03 o 04)"
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.

      * Edita la fecha de proceso DDMMAA del parametro en formato                     * Edita la fecha de proceso DDMMAA del parametro en formato
      * YYYYMMDD                                                                      * YYYYMMDD 
           STRING "20" P-FECHA-PROCESO(5:6) P-FECHA-PROCESO(3:4)             |             string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)
           P-FECHA-PROCESO(1:2) DELIMITED SIZE                               |             P-fecha-proceso(1:2) delimited size 
           INTO P-FECHA-PROCESO-YYYYMMDD                                     |             into P-fecha-proceso-YYYYMMDD
           DISPLAY "Fecha de proceso: " P-FECHA-PROCESO-YYYYMMDD             |             display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

      * Calcula una fecha 50 anios posterior a la de proceso                          * Calcula una fecha 50 anios posterior a la de proceso
           MOVE P-FECHA-PROCESO-YYYYMMDD TO P-FECHA-PROCESO-50               |             move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50
           ADD 50 TO P-FECHA-PROCESO-50YYYY                                  |             add 50 to P-fecha-proceso-50YYYY

      * Apertura del archivo de entrada                                               * Apertura del archivo de entrada
           STRING "$TEMPORALES/" P-FILE-NAME INTO P-FILE-PATH                |             open input JURAD
           OPEN INPUT JURAD                                                  |             evaluate JURAD-fs
           EVALUATE JURAD-FS                                                 |                 when "00"
               WHEN "00"                                                     |                      continue
                    CONTINUE                                                 |                 when other
               WHEN OTHER                                                    |                     display "Error en open del archivo jurad "
                   DISPLAY "Error en open del archivo JURAD "                |                     display "Nombre del archivo: " P-file-name
                   DISPLAY "Path del archivo: " P-FILE-PATH                  |                     display "File status: " JURAD-fs
                   DISPLAY "File status: " JURAD-FS                          |                     perform 9000-CANCELAR-PROGRAMA *> no retorna
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA              |                     goback
                   GOBACK                                                    |             end-evaluate.
           END-EVALUATE.                                                     <  

      * Apertura del archivo de errores                                               * Apertura del archivo de errores
           STRING "$TEMPORALES/" P-FILE-NAME(1:19) "_ERRORES.txt"            |             string P-file-name(1:19) "_ERRORES.txt" into
           INTO ERRS-FILE-NAME                                               |             ERRS-file-name
           OPEN OUTPUT ERRS                                                  |             open output ERRS
           EVALUATE ERRS-FS                                                  |             evaluate ERRS-fs
               WHEN "00"                                                     |                 when "00"
                    CONTINUE                                                 |                      continue
               WHEN OTHER                                                    |                 when other
                   DISPLAY "Error en open del archivo de errores "           |                     display "Error en open del archivo de errores "
                   DISPLAY "Nombre del archivo: " ERRS-FILE-NAME             |                     display "Nombre del archivo: " ERRS-file-name
                   DISPLAY "File status: " ERRS-FS                           |                     display "File status: " ERRS-fs
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA              |                     perform 9000-CANCELAR-PROGRAMA *> no retorna
                   GOBACK                                                    |                     goback
           END-EVALUATE.                                                     |             end-evaluate.

      * Apertura de los archivos maestros                                             * Apertura de los archivos maestros
      * TODO: falta capturar el status de estas operaciones?                          * TODO: falta capturar el status de estas operaciones?
           OPEN INPUT BDIIREGI                                               |             open input BDIIREGI
           OPEN INPUT BDIIDIAN                                               |             open input BDIIDIAN
           OPEN INPUT BDIIDAS.                                               |             open input BDIIDAS.

      * Apertura del archivo de alertas en linea                                      * Apertura del archivo de alertas en linea
           IF PROCESO-REAL                                                   |             if PROCESO-REAL
               OPEN I-O BDIIALE                                              |                 open i-o BDIIALE
           ELSE                                                              |             else
               OPEN INPUT BDIIALE                                            |                 open input BDIIALE
           END-IF.                                                           |             end-if.

      * Si es un refresque total (codigo 04) se eliminan los registros                * Si es un refresque total (codigo 04) se eliminan los registros
      * de Jurad existentes                                                           * de Jurad existentes
           IF P-TIPO-PROCESO = "04" AND PROCESO-REAL                         |             if P-tipo-proceso = "04" and PROCESO-REAL
               PERFORM 1001-ELIMINAR-TODO                                    |                 perform 1001-ELIMINAR-TODO
           END-IF.                                                           |             end-if.

       1000-NOT-USED.                                                                  1000-NOT-USED.
      * >>>> esto da un error de compilacion que no puedo resolver                    * >>>> esto da un error de compilacion que no puedo resolver
      * >>>> por ahora esta anulado                                                   * >>>> por ahora esta anulado
      ******************************************************************              ******************************************************************
      * Carga de los templates para armar el texto de alertas                         * Carga de los templates para armar el texto de alertas
      * TODO: por ahora los templates son literales                                   * TODO: por ahora los templates son literales
           SET LAX TO 0                                                      |             set LAx to 0
           MOVE HIGH-VALUES TO LA-TEMPLATES                                  |             move high-values to LA-templates
           PERFORM VARYING LAM FROM 1 BY 1                                   |             perform varying LAm from 1 by 1 
           UNTIL LA-MODELO(LAM) = HIGH-VALUES                                |             until LA-modelo(LAm) = high-values
               SET LAX UP BY 1                                               |                 set LAx up by 1
      *        separa las partes de la linea                                          *        separa las partes de la linea
      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)                          *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)
      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)                     *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)                     *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)                    *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
      *        DELIMITED BY ALL "&"                                          |        *        delimited by all "&"
      *        prepara para omitir los espacios al final de c/parte                   *        prepara para omitir los espacios al final de c/parte
               PERFORM VARYING LAY FROM 1 BY 1 UNTIL LAY > 10                |                 perform varying LAy from 1 by 1 until LAy > 10
                   INSPECT LA-PARTE(LAX, LAY) REPLACING TRAILING             |                     inspect LA-parte(LAx, LAy) replacing trailing
                   SPACES BY HIGH-VALUES                                     |                     spaces by high-values
                   INSPECT LA-PARTE(LAX, LAY) REPLACING FIRST                |                     inspect LA-parte(LAx, LAy) replacing first
                   HIGH-VALUE BY SPACE                                       |                     high-value by space
               END-PERFORM                                                   |                 end-perform
           END-PERFORM.                                                      |             end-perform.



       1001-ELIMINAR-TODO.                                                             1001-ELIMINAR-TODO.
      ******************************************************************              ******************************************************************
      * Elimina los registros de alertas existentes en el archivo de                  * Elimina los registros de alertas existentes en el archivo de
      * alertas en linea, previo a un refresque total                                 * alertas en linea, previo a un refresque total
      ******************************************************************              ******************************************************************
           DISPLAY "Eliminando toda la informacion con fuente JURAD"         |             display "Eliminando toda la informacion con fuente JURAD"
      *    posiciona en el primer reg de JURAD                                        *    posiciona en el primer reg de JURAD
           MOVE ZERO TO TIP-IDE-BDIIALE                                      |             move zero to TIP-IDE-BDIIALE
           MOVE ZERO TO NUM-IDE-BDIIALE                                      |             move zero to NUM-IDE-BDIIALE
           MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE                           |             move P-cod-suscriptor to FUENTE-BDIIALE
           MOVE ZEROS TO COD-ALERTA-BDIIALE                                  |             move zeros to COD-ALERTA-BDIIALE
           MOVE LOW-VALUES TO LLASEC-BDIIALE                                 |             move low-values to LLASEC-BDIIALE
           START BDIIALE KEY > LLAVE-BDIIALE INVALID KEY                     |             start BDIIALE key > LLAVE-BDIIALE invalid key
      *        no hay registros                                                       *        no hay registros
               EXIT PARAGRAPH                                                |                 exit paragraph

      *    lee secuencialmente y elimina los registros de JURAD                       *    lee secuencialmente y elimina los registros de JURAD
      *    hasta el fin del archivo                                                   *    hasta el fin del archivo
           PERFORM UNTIL EST-BDIIALE NOT = "00"                              |             perform until EST-BDIIALE not = "00"
               READ BDIIALE NEXT RECORD                                      |                 read BDIIALE next record
               EVALUATE EST-BDIIALE                                          |                 evaluate EST-BDIIALE
               WHEN "00"                                                     |                 when "00"
                   IF FUENTE-BDIIALE = P-COD-SUSCRIPTOR                      |                     if FUENTE-BDIIALE = P-cod-suscriptor
      *                es un alerta de JURAD                                          *                es un alerta de JURAD
                       DELETE BDIIALE                                        |                         delete BDIIALE
                       IF EST-BDIIALE = "00"                                 |                         if EST-BDIIALE = "00"
                           ADD 1 TO N-ALE-BORRADAS                           |                             add 1 to N-ale-borradas
                       ELSE                                                  |                         else
      *                    error en la eliminacion                                    *                    error en la eliminacion
                           DISPLAY "Error al eliminar un registro de "       |                             display "Error al eliminar un registro de "
                           "BDIIALE vaciando los datos"                                                    "BDIIALE vaciando los datos"
                           DISPLAY "Clave: " LLAVE-BDIIALE                   |                             display "Clave: " LLAVE-BDIIALE
                           DISPLAY "Reg borrados: " N-ALE-BORRADAS           |                             display "Reg borrados: " N-ale-borradas
                           PERFORM 9000-CANCELAR-PROGRAMA                    |                             perform 9000-CANCELAR-PROGRAMA
                       END-IF                                                |                         end-if
                   END-IF                                                    |                     end-if
               WHEN "10"                                                     |                 when "10"
      *            fin de archivo: sale normalmente                                   *            fin de archivo: sale normalmente
                   CONTINUE                                                  |                     continue
               WHEN OTHER                                                    |                 when other
      *            lectura anormal: cancelacion del programa                          *            lectura anormal: cancelacion del programa
                   DISPLAY "Error en lectura del archivo de alertas "        |                     display "Error en lectura del archivo de alertas "
                   "online"                                                                        "online"
                   DISPLAY "File status: " EST-BDIIALE                       |                     display "File status: " EST-BDIIALE
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA              |                     perform 9000-CANCELAR-PROGRAMA *> no retorna
               END-EVALUATE                                                  |                 end-evaluate
           END-PERFORM.                                                      |             end-perform.
           DISPLAY "Termino la eliminacion total de JURAD"                   |             display "Termino la eliminacion total de JURAD"
           DISPLAY "Reg borrados: " N-ALE-BORRADAS.                          |             display "Reg borrados: " N-ale-borradas. 


       7000-RUTINA-FINAL.                                                              7000-RUTINA-FINAL.
      ******************************************************************              ******************************************************************
      * Registra hora de finalizacion                                                 * Registra hora de finalizacion
           ACCEPT W-HORA-FIN FROM TIME                                       |             accept W-hora-fin from time

      * LEER JURAD A VER SI HAY REGISTROS DESPUES DEL "T"                    |        * Leer JURAD a ver si hay registros despues del "T"

      * Close todos los archivos                                                      * Close todos los archivos
           CLOSE JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.               |             close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

      * Emision de contadores de registros                                            * Emision de contadores de registros
           DISPLAY " "                                                       |             display " "
           DISPLAY "Totales de registros:"                                   |             display "Totales de registros:"
           MOVE N-REG-LEIDOS TO N-EDIT                                       |             move N-reg-leidos to N-edit 
           DISPLAY N-EDIT "Registros IME en el archivo de entrada"           |             display N-edit "Registros IME en el archivo de entrada"
           MOVE N-REG-OK TO N-EDIT                                           |             move N-reg-OK to N-edit 
           DISPLAY N-EDIT "Registros procesados sin error"                   |             display N-edit "Registros procesados sin error"

      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la                * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
      * definicion de estos contadores                                                * definicion de estos contadores
      *    move N-reg-tipo-I-OK to N-edit                                             *    move N-reg-tipo-I-OK to N-edit
      *    DISPLAY N-EDIT "Registros tipo I aceptados"                       |        *    display N-edit "Registros tipo I aceptados"
      *    move N-reg-tipo-M-OK to N-edit                                             *    move N-reg-tipo-M-OK to N-edit
      *    DISPLAY N-EDIT "Registros tipo M aceptados"                       |        *    display N-edit "Registros tipo M aceptados"
      *    move N-reg-tipo-E-OK to N-edit                                             *    move N-reg-tipo-E-OK to N-edit
      *    DISPLAY N-EDIT "Registros tipo E aceptados"                       |        *    display N-edit "Registros tipo E aceptados"

           MOVE E-CONT-REGS-CON-ERROR TO N-REG-CON-ERROR                     |             move E-cont-regs-con-error to N-reg-con-error
           MOVE N-REG-CON-ERROR TO N-EDIT                                    |             move N-reg-con-error to N-edit 
           DISPLAY N-EDIT "Registros con error"                              |             display N-edit "Registros con error"
           MOVE N-ALE-BORRADAS TO N-EDIT                                     |             move N-ale-borradas to N-edit 
           DISPLAY N-EDIT "Alertas borradas previo al refresque total"       |             display N-edit "Alertas borradas previo al refresque total"
           MOVE N-ALE-INSERTADAS TO N-EDIT                                   |             move N-ale-insertadas to N-edit 
           DISPLAY N-EDIT "Alertas insertadas"                               |             display N-edit "Alertas insertadas"
           MOVE N-ALE-MODIFICADAS TO N-EDIT                                  |             move N-ale-modificadas to N-edit 
           DISPLAY N-EDIT "Alertas modificadas"                              |             display N-edit "Alertas modificadas"
           MOVE N-ALE-ELIMINADAS TO N-EDIT                                   |             move N-ale-eliminadas to N-edit 
           DISPLAY N-EDIT "Alertas eliminadas"                               |             display N-edit "Alertas eliminadas"
           MOVE N-ALE-YA-EXISTE TO N-EDIT                                    |             move N-ale-ya-existe to N-edit 
           DISPLAY N-EDIT "Insercion de alerta existente"                    |             display N-edit "Insercion de alerta existente"
           MOVE N-ALE-NO-EXISTE TO N-EDIT                                    |             move N-ale-no-existe to N-edit 
           DISPLAY N-EDIT "Modif o elim de alerta inexistente".              |             display N-edit "Modif o elim de alerta inexistente".

      * Emision del reporte de errores                                                * Emision del reporte de errores
           DISPLAY " "                                                       |             display " "
           DISPLAY "Totales por tipo de error detectado:"                    |             display "Totales por tipo de error detectado:"
           PERFORM VARYING EX FROM 1 BY 1 UNTIL EX > 50                      |             perform varying Ex from 1 by 1 until Ex > 50
           OR E-CODIGO(EX) = "00"                                            |             or E-codigo(Ex) = "00"
               IF E-CONTADOR(EX) NOT = 0                                     |                 if E-contador(Ex) not = 0 
                   MOVE E-CONTADOR(EX) TO E-EDIT                             |                     move E-contador(ex) to E-edit
                   DISPLAY E-EDIT E-CODIGO(EX) "-" E-DESCRIPCION(EX)         |                     display E-edit E-codigo(Ex) "-" E-descripcion(Ex)
               END-IF                                                        |                 end-if
           END-PERFORM.                                                      |             end-perform.


       9000-CANCELAR-PROGRAMA.                                                         9000-CANCELAR-PROGRAMA.
      ******************************************************************              ******************************************************************
      * Procedimiento standard de cancelacion de programa batch                       * Procedimiento standard de cancelacion de programa batch
      ******************************************************************              ******************************************************************
      * TODO: hay un standard para comunicar una cancelacion de proceso?              * TODO: hay un standard para comunicar una cancelacion de proceso?
           DISPLAY " "                                                       |             display " "
           DISPLAY PGM " - proceso cancelado"                                |             display pgm " - proceso cancelado"
           GOBACK RETURNING 99.                                              |             goback returning 99.


           COPY BDIIVIDE.PROC.                                               |             copy BDIIVIDE.PROC.


           COPY VALNOM.PROC.                                                 |             copy VALNOM.PROC.


      /                                                                               /
       IDENTIFICATION DIVISION.                                                        IDENTIFICATION DIVISION.
       PROGRAM-ID. PONERR.                                                             PROGRAM-ID. PONERR.
      ******************************************************************              ******************************************************************
      * Rutina de conveniencia para procesar un error detectado en un                 * Rutina de conveniencia para procesar un error detectado en un
      * registro de input                                                             * registro de input
      * Contabiliza el error en la tabla de errores, activa el indicador              * Contabiliza el error en la tabla de errores, activa el indicador
      * de registro con error, muestra el mensaje en la pantalla, cuenta              * de registro con error, muestra el mensaje en la pantalla, cuenta
      * el registro erroneo                                                           * el registro erroneo
      ******************************************************************              ******************************************************************
       ENVIRONMENT DIVISION.                                                           ENVIRONMENT DIVISION.
       DATA DIVISION.                                                                  DATA DIVISION.
       WORKING-STORAGE SECTION.                                                        WORKING-STORAGE SECTION.
      ******************************************************************              ******************************************************************
      * Registro de input (primeros 86 caracteres)                                    * Registro de input (primeros 86 caracteres)
       01  REG-INPUT-ANTERIOR           PIC X(86) VALUE LOW-VALUES.          |         01  reg-input-anterior           pic x(86) value low-values.
      * Posicion del proximo error en la lista de errores del reg                     * Posicion del proximo error en la lista de errores del reg
       01  ERRINDEX                     PIC 999 COMP.                        |         01  errIndex                     pic 999 comp.
      ******************************************************************              ******************************************************************

       LINKAGE SECTION.                                                                LINKAGE SECTION.
      ******************************************************************              ******************************************************************
      * Codigo del error detectado                                                    * Codigo del error detectado
       01  COD-ERROR                    PIC XX.                              |         01  cod-error                    pic xx.
      ******************************************************************              ******************************************************************
      * Registro de input (primeros 86 caracteres)                                    * Registro de input (primeros 86 caracteres)
       01  REG-INPUT                    PIC X(86).                           |         01  reg-input                    pic x(86).
      ******************************************************************              ******************************************************************
      * Tabla de errores de consistencia del input                                    * Tabla de errores de consistencia del input
       01 E-ERRORES.                                                         |         01 E-errores.
      *    indica si el registro actual tiene error                                   *    indica si el registro actual tiene error
           03 E-HAY-ERROR               PIC XX.                              |             03 E-hay-error               pic xx.
      *    errores del registro actual                                                *    errores del registro actual
           03 E-ERRORES-REG             PIC X(100).                          |             03 E-errores-reg             pic x(100).
      *    contador de registros con error                                            *    contador de registros con error
           03 E-CONT-REGS-CON-ERROR     PIC 9(8).                            |             03 E-cont-regs-con-error     pic 9(8).
      *    tabla de errores                                                           *    tabla de errores
           03 E-ERROR                   OCCURS 50 INDEXED EX.                |             03 E-error                   occurs 50 indexed Ex.
               05 E-CODIGO              PIC XX.                              |                 05 E-codigo              pic xx.
               05                       PIC X.                               |                 05                       pic x.
               05 E-CONTADOR            PIC 9(7).                            |                 05 E-contador            pic 9(7).
               05                       PIC X.                               |                 05                       pic x.
               05 E-DESCRIPCION         PIC X(59).                           |                 05 E-descripcion         pic x(59).

      ******************************************************************              ******************************************************************

       PROCEDURE DIVISION USING COD-ERROR REG-INPUT E-ERRORES.               |         PROCEDURE DIVISION using cod-error reg-input E-errores.
       00.                                                                             00.
      *    marca al reg actual como erroneo                                           *    marca al reg actual como erroneo
           MOVE "SI" TO E-HAY-ERROR                                          |             move "SI" to E-hay-error

      *    cuenta y muestra el registro de input                                      *    cuenta y muestra el registro de input
           IF REG-INPUT(1:86) NOT = REG-INPUT-ANTERIOR                       |             if reg-input(1:86) not = reg-input-anterior
               ADD 1 TO E-CONT-REGS-CON-ERROR                                |                 add 1 to E-cont-regs-con-error
               DISPLAY " "                                                   |                 display " "
               DISPLAY REG-INPUT(1:86)                                       |                 display reg-input(1:86)
               MOVE REG-INPUT(1:86) TO REG-INPUT-ANTERIOR                    |                 move reg-input(1:86) to reg-input-anterior
               MOVE SPACES TO E-ERRORES-REG                                  |                 move spaces to E-errores-reg
               MOVE 2 TO ERRINDEX                                            |             end-if
           END-IF                                                            <  

      *    contabiliza el error en la tabla de errores                                *    contabiliza el error en la tabla de errores
           SET EX TO 1                                                       |             set Ex to 1
           SEARCH E-ERROR VARYING EX                                         |             search E-error varying Ex
           AT END                                                            |             at end
               DISPLAY "--- falla en la tabla de errores ---" COD-ERROR      |                 display "--- falla en la tabla de errores ---" cod-error
           WHEN E-CODIGO(EX) = "00"                                          |             when E-codigo(Ex) = "00"
               ADD 1 TO E-CONTADOR(EX)                                       |                 add 1 to E-contador(Ex)
               DISPLAY "--- error tipo exotico: " COD-ERROR                  |                 display "--- error tipo exotico: " cod-error
           WHEN E-CODIGO(EX) = COD-ERROR                                     |             when E-codigo(Ex) = cod-error
               ADD 1 TO E-CONTADOR(EX)                                       |                 add 1 to E-contador(Ex)
               DISPLAY "Error " COD-ERROR " " E-DESCRIPCION(EX)              |                 display "Error " cod-error " " E-descripcion(Ex)
           END-SEARCH                                                        |             end-search

      *    agrega a la lista de errores del registro                                  *    agrega a la lista de errores del registro
           IF ERRINDEX < 99                                                  |             if errIndex < 99
               MOVE COD-ERROR TO E-ERRORES-REG(ERRINDEX:2)                   |                 move cod-error to E-errores-reg(errIndex:2)
               ADD 3 TO ERRINDEX                                             |                 add 3 to errindex
           END-IF                                                            |             end-if

           EXIT PROGRAM.                                                     |             exit program.


       END PROGRAM PONERR.                                                   |         end program PONERR.

       END PROGRAM ACTALEJUR.                                                |         end program ACTALEJUR.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************

/d/iccol/desarrollo/fuentes>cls
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>clssdiff -w 156 CARGAJUR.CBL CARGAJUR-GB.CBL/d/iccol/desarrollo/fuentes>
      $SET LIST SETTING                                                               $SET LIST SETTING 
       IDENTIFICATION DIVISION.                                                        IDENTIFICATION DIVISION.
       PROGRAM-ID.    ACTALEJUR.                                                       PROGRAM-ID.    ACTALEJUR.
      ******************************************************************              ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos                  * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad                                                                     * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa                * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en               * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.                                                              * el archivo ERRS.
      ******************************************************************              ******************************************************************
       AUTHOR.        GLOBANT JL.                                            |         AUTHOR.        Globant JL.
       DATE-WRITTEN.                                                                   DATE-WRITTEN.
       DATE-COMPILED.                                                                  DATE-COMPILED.
       CONFIGURATION SECTION.                                                |         CONFIGURATION section.
       SOURCE-COMPUTER. MICROFOCUS.                                          |         SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. MICROFOCUS.                                          |         OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT SECTION.                                                 |         INPUT-OUTPUT section.
       FILE-CONTROL.                                                                   FILE-CONTROL.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
       SELECT JURAD ASSIGN TO P-FILE-PATH                                    |         select JURAD assign to P-file-name
           ORGANIZATION IS LINE SEQUENTIAL                                   |             organization is line sequential
           FILE STATUS IS JURAD-FS.                                          |             file status is JURAD-fs.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
       SELECT ERRS ASSIGN TO ERRS-FILE-NAME                                  |         select ERRS assign to ERRS-file-name
           ORGANIZATION IS LINE SEQUENTIAL                                   |             organization is line sequential
           FILE STATUS IS ERRS-FS.                                           |             file status is ERRS-fs.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
           COPY BDIIREGI.FS.                                                 |             copy BDIIREGI.FS.
                                                                             >        * TODO: debe compilar con file status

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
           COPY BDIIDIAN.FS.                                                 |         copy BDIIDIAN.FS.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
           COPY BDIIDAS.FS.                                                  |         copy BDIIDAS.FS.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
           COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD         |             copy BDIIALE.FS replacing == on record.== by == on record
              FILE STATUS IS EST-BDIIALE.==.                                 |                file status is EST-BDIIALE.==.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************
       DATA DIVISION.                                                                  DATA DIVISION.
       FILE SECTION.                                                         |         FILE section.

      ******************************************************************              ******************************************************************
      * Archivo de entrada con los datos de demandas y embargos de JURAD              * Archivo de entrada con los datos de demandas y embargos de JURAD
      ******************************************************************              ******************************************************************
       FD JURAD.                                                                       FD JURAD.
       01  JURAD-REG.                                                        |         01  JURAD-reg.
      * Registros de movimientos I, M, E                                              * Registros de movimientos I, M, E
      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim                                 *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
           03 JURAD-TIPO-NOVEDAD        PIC X.                               |             03 JURAD-tipo-novedad        pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                 *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 JURAD-ID-TIPO             PIC X.                               |             03 JURAD-id-tipo             pic x.
      *    Numero de identificacion                                                   *    Numero de identificacion
           03 JURAD-ID-NUMEROX          PIC X(11).                           |             03 JURAD-id-numeroX          pic x(11).
           03 JURAD-ID-NUMERO           REDEFINES JURAD-ID-NUMEROX           |             03 JURAD-id-numero           redefines JURAD-id-numeroX
                                        PIC 9(11).                           |                                          pic 9(11).
      *    Nombres y Apellidos                                                        *    Nombres y Apellidos
           03 JURAD-NOMBRE              PIC X(45).                           |             03 JURAD-nombre              pic x(45).
      *    Numero de demandas vigentes                                                *    Numero de demandas vigentes
           03 JURAD-DEMANDAS-VIGENTES   PIC 999.                             |             03 JURAD-demandas-vigentes   pic 999.
      *    Numero de demandas terminadas                                              *    Numero de demandas terminadas
           03 JURAD-DEMANDAS-TERMINADAS PIC 999.                             |             03 JURAD-demandas-terminadas pic 999.
      *    Fecha ultima demanda vigente YYYYMMDD                                      *    Fecha ultima demanda vigente YYYYMMDD
           03 JURAD-DEMANDAS-FECHA-ULTIMA PIC X(8).                          |             03 JURAD-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes                                                *    Numero de embargos vigentes
           03 JURAD-EMBARGOS-VIGENTES   PIC 999.                             |             03 JURAD-embargos-vigentes   pic 999.
      *    Numero de embargos terminados                                              *    Numero de embargos terminados
           03 JURAD-EMBARGOS-TERMINADOS PIC 999.                             |             03 JURAD-embargos-terminados pic 999.
      *    Fecha ultimo embargo vigente YYYYMMDD                                      *    Fecha ultimo embargo vigente YYYYMMDD
           03 JURAD-EMBARGOS-FECHA-ULTIMO PIC X(8).                          |             03 JURAD-embargos-fecha-ultimo pic x(8).

       01  JURADT-REG.                                                       |         01  JURADT-reg.
      * Registro de totales de control T                                              * Registro de totales de control T
      *    TIPO DE NOVEDAD = "T"                                             |        *    Tipo de Novedad = "T"
           03 JURADT-TIPO-NOVEDAD       PIC X.                               |             03 JURADT-tipo-novedad       pic x.
           03                           PIC X.                               |             03                           pic x.
      *    Cantidad de registros                                                      *    Cantidad de registros
           03 JURADT-REGISTROS          PIC 9(11).                           |             03 JURADT-registros          pic 9(11).
           03                           PIC X.                               |             03                           pic x.
      *    Total numero de demandas vigentes                                          *    Total numero de demandas vigentes
           03 JURADT-DEMANDAS-VIGENTES  PIC 9(7).                            |             03 JURADT-demandas-vigentes  pic 9(7).
           03                           PIC X.                               |             03                           pic x.
      *    Total numero de demandas terminadas                                        *    Total numero de demandas terminadas
           03 JURADT-DEMANDAS-TERMINADAS PIC 9(7).                           |             03 JURADT-demandas-terminadas pic 9(7).
           03                           PIC X.                               |             03                           pic x.
      *    Total numero de embargos vigentes                                          *    Total numero de embargos vigentes
           03 JURADT-EMBARGOS-VIGENTES  PIC 9(7).                            |             03 JURADT-embargos-vigentes  pic 9(7).
           03                           PIC X.                               |             03                           pic x.
      *    Total numero de embargos terminados                                        *    Total numero de embargos terminados
           03 JURADT-EMBARGOS-TERMINADOS PIC 9(7).                           |             03 JURADT-embargos-terminados pic 9(7).
           03                           PIC X(41).                           |             03                           pic x(41).

      ******************************************************************              ******************************************************************
      * Archivo de salida con los registros defectuosos del arch JURAD                * Archivo de salida con los registros defectuosos del arch JURAD
      ******************************************************************              ******************************************************************
       FD ERRS.                                                                        FD ERRS.
       01  ERRS-REG.                                                         |         01  ERRS-reg.
      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales                      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
           03 ERRS-TIPO-NOVEDAD         PIC X.                               |             03 ERRS-tipo-novedad         pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                 *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 ERRS-ID-TIPO              PIC X.                               |             03 ERRS-id-tipo              pic x.
      *    Numero de identificacion                                                   *    Numero de identificacion
           03 ERRS-ID-NUMERO            PIC X(11).                           |             03 ERRS-id-numero            pic x(11).
      *    Nombres y Apellidos                                                        *    Nombres y Apellidos
           03 ERRS-NOMBRE               PIC X(45).                           |             03 ERRS-nombre               pic x(45).
      *    Numero de demandas vigentes                                                *    Numero de demandas vigentes
           03 ERRS-DEMANDAS-VIGENTES    PIC 999.                             |             03 ERRS-demandas-vigentes    pic 999.
      *    Numero de demandas terminadas                                              *    Numero de demandas terminadas
           03 ERRS-DEMANDAS-TERMINADAS  PIC 999.                             |             03 ERRS-demandas-terminadas  pic 999.
      *    Fecha ultima demanda vigente YYMMDD                                        *    Fecha ultima demanda vigente YYMMDD
           03 ERRS-DEMANDAS-FECHA-ULTIMA PIC X(8).                           |             03 ERRS-demandas-fecha-ultima pic x(6).
      *    Numero de embargos vigentes                                                *    Numero de embargos vigentes
           03 ERRS-EMBARGOS-VIGENTES    PIC 999.                             |             03 ERRS-embargos-vigentes    pic 999.
      *    Numero de embargos terminados                                              *    Numero de embargos terminados
           03 ERRS-EMBARGOS-TERMINADOS  PIC 999.                             |             03 ERRS-embargos-terminados  pic 999.
      *    Fecha ultimo embargo vigente YYMMDD                                        *    Fecha ultimo embargo vigente YYMMDD
           03 ERRS-EMBARGOS-FECHA-ULTIMO PIC X(8).                           |             03 ERRS-embargos-fecha-ultimo pic x(6).
      *    Causa del rechazo                                                          *    Causa del rechazo
           03 ERRS-CAUSA-RECHAZO        PIC X(100).                          |             03 ERRS-causa-rechazo        pic x(100).

      ******************************************************************              ******************************************************************
      * Contiene los ids y nombres de personas                                        * Contiene los ids y nombres de personas
      ******************************************************************              ******************************************************************
       COPY BDIIREGI.FD.                                                     |         copy BDIIREGI.FD.

      ******************************************************************              ******************************************************************
      * Maestro de personas juridicas nacionales y extranjeras reportada              * Maestro de personas juridicas nacionales y extranjeras reportada
      * por la DIAN                                                                   * por la DIAN
      ******************************************************************              ******************************************************************
       COPY BDIIDIAN.FD.                                                     |         copy BDIIDIAN.FD.

      ******************************************************************              ******************************************************************
      * Archivo maestro de cedulas de extranjeria suministrado por DAS                * Archivo maestro de cedulas de extranjeria suministrado por DAS
      ******************************************************************              ******************************************************************
       COPY BDIIDAS.FD.                                                      |         copy BDIIDAS.FD.

      ******************************************************************              ******************************************************************
      * Maestro de alertas reportadas por suscriptores                                * Maestro de alertas reportadas por suscriptores
      ******************************************************************              ******************************************************************
       COPY BDIIALE.FD.                                                      |         copy BDIIALE.FD.

      ******************************************************************              ******************************************************************
       WORKING-STORAGE SECTION.                                              |         WORKING-STORAGE section.
      ******************************************************************              ******************************************************************
      * Nombre del programa                                                           * Nombre del programa
       01  PGM                          PIC X(10) VALUE "CARGAJUR".          |         01  pgm                          pic x(10) value "CARGAJUR".

      ******************************************************************              ******************************************************************
      * Variables para rutina de validacion de identificaciones                       * Variables para rutina de validacion de identificaciones
      ******************************************************************              ******************************************************************
       COPY BDIIVIDE.WS.                                                     |         copy BDIIVIDE.WS.

      ******************************************************************              ******************************************************************
      * Variables relacionadas con las alertas del sistema                            * Variables relacionadas con las alertas del sistema
      ******************************************************************              ******************************************************************
       COPY BDIIALE.WS.                                                      |         copy BDIIALE.WS.

      ******************************************************************              ******************************************************************
      * Datos para las rutinas de validacion de nombres de VALNOM.PROC                * Datos para las rutinas de validacion de nombres de VALNOM.PROC
      ******************************************************************              ******************************************************************
       COPY VALNOM.WS.                                                       |         copy VALNOM.WS.

      *****************************************************************               *****************************************************************
      * Direcciones de los archivos en el file system                                 * Direcciones de los archivos en el file system
      *****************************************************************               *****************************************************************
       COPY ICFILE.WS.                                                       |         copy ICFILE.WS.

      ******************************************************************              ******************************************************************
      * Indica que se termino el proceso, por agotamiento del archivo                 * Indica que se termino el proceso, por agotamiento del archivo
      * de entrada (normal) o alguna otra condicion (error)                           * de entrada (normal) o alguna otra condicion (error)
       01  IND-FIN-PROCESO              PIC XX VALUE "NO".                   |         01  IND-fin-proceso              pic xx value "NO".

      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)                   * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
       01  JURAD-REG-ANTERIOR           PIC X(100) VALUE "(vacio)".          |         01  JURAD-reg-anterior           pic x(100) value "(vacio)".
       01  JURAD-FS                     PIC XX VALUE SPACES.                 |         01  JURAD-fs                     pic xx value spaces.

       01  ERRS-FS                      PIC XX VALUE SPACES.                 |         01  ERRS-fs                      pic xx value spaces.

      * Datos de demandas o embargos que van en el registro BDIIALE                   * Datos de demandas o embargos que van en el registro BDIIALE
       01 D-DATAHOST.                                                        |         01 D-datahost.
           05 D-VIGENTES                PIC 9(5).                            |             05 D-vigentes                pic 9(5).
           05 D-TERMINADOS              PIC 9(5).                            |             05 D-terminados              pic 9(5).
           05 D-FECHA-ULTIMA            PIC X(8).                            |             05 D-fecha-ultima            pic x(8).
      ******************************************************************              ******************************************************************
      * Parametros iniciales, de la linea de comando                                  * Parametros iniciales, de la linea de comando
      * La linea de comando que contiene los parametros                               * La linea de comando que contiene los parametros
       01 P-COMMAND-LINE                PIC X(80) VALUE SPACES.              |         01 P-command-line                pic x(80) value spaces.
       01 P-PARAMETROS.                                                      |         01 P-parametros.
      *    PROCESO REAL: CONTIENE "S" PARA ACTIVAR                           |        *    Proceso real: contiene "SI" para activar 
      * TODO: FIJO EN "N" PARA PRUEBAS                                       |        * TODO: fijo en "NO" para pruebas
           03 P-PROCESO-REAL            PIC X VALUE "N".                     |             03 P-proceso-real            pic xx value "NO".
           88 PROCESO-REAL              VALUE "S".                           |             88 PROCESO-REAL              value "SI".

      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt                      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
           03 P-FILE-NAME               PIC X(80) VALUE SPACES.              |             03 P-file-name               pic x(80) value spaces.
           03 P-FILE-NAME-R             REDEFINES P-FILE-NAME.               |             03 P-file-name-R             redefines P-file-name.
      *        JJJJJJ = Codigo de suscriptor JURAD en Experian                        *        JJJJJJ = Codigo de suscriptor JURAD en Experian
               05 P-COD-SUSCRIPTOR      PIC 9(6).                            |                 05 P-cod-suscriptor      pic 9(6).
      *        AAA = CODIFICACION DEL PRODUCTO ("100")                       |        *        aaa = Codificacion del producto ("100")
               05 P-PRODUCTO            PIC XXX.                             |                 05 P-producto            pic xxx.
      *        DDMMAA = Fecha de proceso                                              *        DDMMAA = Fecha de proceso
               05 P-FECHA-PROCESO       PIC X(6).                            |                 05 P-fecha-proceso       pic x(6).
      *        bb =  01 a CI                                                          *        bb =  01 a CI
               05 P-CI-BI               PIC XX.                              |                 05 P-ci-bi               pic xx.
      *        XX = Tipo de proceso                                                   *        XX = Tipo de proceso
      *        01 Envio Original - Carga TOTAL - primera vez                          *        01 Envio Original - Carga TOTAL - primera vez
      *        02 Archivo Semanal - Carga PARCIAL                                     *        02 Archivo Semanal - Carga PARCIAL
      *        03 Archivo Mensual - Carga PARCIAL                                     *        03 Archivo Mensual - Carga PARCIAL
      *        04 Refresque Total - Carga TOTAL                                       *        04 Refresque Total - Carga TOTAL
               05 P-TIPO-PROCESO        PIC XX.                              |                 05 P-tipo-proceso        pic xx.
      *        EXTENSION DEL ARCHIVO ".txt"                                  |        *        extension del archivo ".txt"
               05 P-EXTENSION           PIC X(4).                            |                 05 P-extension           pic x(4).
               05                       PIC X(57).                           |                 05                       pic x(57).
           03 P-FILE-PATH               PIC X(80) VALUE SPACES.              <  
      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt                 * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt
          03 ERRS-FILE-NAME             PIC X(80) VALUE SPACES.              |            03 ERRS-file-name             pic x(80) value spaces.

      * Fecha de proceso editada YYYYMMDD                                             * Fecha de proceso editada YYYYMMDD
       01 P-FECHA-PROCESO-YYYYMMDD      PIC X(8).                            |         01 P-fecha-proceso-YYYYMMDD      pic x(8).
      * Fecha de proceso + 50 aÃ±os                                                   * Fecha de proceso + 50 aÃ±os
       01 P-FECHA-PROCESO-50.                                                |         01 P-fecha-proceso-50.
           03  P-FECHA-PROCESO-50YYYY   PIC 9999.                            |             03  P-fecha-proceso-50YYYY   pic 9999.
           03                           PIC X(4).                            |             03                           pic x(4).
      ******************************************************************              ******************************************************************
      * Datos para el reporte final                                                   * Datos para el reporte final
       01 W-TIEMPO.                                                          |         01 W-tiempo.
           03 W-HORA-INICIO             PIC 9(8).                            |             03 W-hora-inicio             pic 9(8).
           03 W-HORA-FIN                PIC 9(8).                            |             03 W-hora-fin                pic 9(8).
       01 N-EDIT                        PIC Z(8)B.                           |         01 N-edit                        pic z(8)B.
       01 N-CONTADORES.                                                      |         01 N-contadores.
      *    Registros en el archivo de entrada                                         *    Registros en el archivo de entrada
           03 N-REG-LEIDOS              PIC 9(8) VALUE ZERO.                 |             03 N-reg-leidos              pic 9(8) value zero.
      *    Registros procesados sin error                                             *    Registros procesados sin error
           03 N-REG-OK                  PIC 9(8) VALUE ZERO.                 |             03 N-reg-OK                  pic 9(8) value zero.
      *    Registros con error                                                        *    Registros con error
           03 N-REG-CON-ERROR           PIC 9(8) VALUE ZERO.                 |             03 N-reg-con-error           pic 9(8) value zero.

      *    Cantidades de registros por tipo de novedad                                *    Cantidades de registros por tipo de novedad
           03 N-REG-TIPO-I-OK           PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-I-OK           pic 9(8) value zero.
           03 N-REG-TIPO-M-OK           PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-M-OK           pic 9(8) value zero.
           03 N-REG-TIPO-E-OK           PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-E-OK           pic 9(8) value zero.
           03 N-REG-TIPO-I-ERR          PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-I-err          pic 9(8) value zero.
           03 N-REG-TIPO-M-ERR          PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-M-err          pic 9(8) value zero.
           03 N-REG-TIPO-E-ERR          PIC 9(8) VALUE ZERO.                 |             03 N-reg-tipo-E-err          pic 9(8) value zero.

      *    Alertas borradas previo al refresque total                                 *    Alertas borradas previo al refresque total
           03 N-ALE-BORRADAS            PIC 9(8) VALUE ZERO.                 |             03 N-ale-borradas            pic 9(8) value zero.
      *    Alertas insertadas                                                         *    Alertas insertadas
           03 N-ALE-INSERTADAS          PIC 9(8) VALUE ZERO.                 |             03 N-ale-insertadas          pic 9(8) value zero.
      *    Alertas modificadas                                                        *    Alertas modificadas
           03 N-ALE-MODIFICADAS         PIC 9(8) VALUE ZERO.                 |             03 N-ale-modificadas         pic 9(8) value zero.
      *    Alertas eliminadas                                                         *    Alertas eliminadas
           03 N-ALE-ELIMINADAS          PIC 9(8) VALUE ZERO.                 |             03 N-ale-eliminadas          pic 9(8) value zero.
      *    Insercion de alerta existente                                              *    Insercion de alerta existente
           03 N-ALE-YA-EXISTE           PIC 9(8) VALUE ZERO.                 |             03 N-ale-ya-existe           pic 9(8) value zero.
      *    Modificacion o eliminacion de alerta inexistente                           *    Modificacion o eliminacion de alerta inexistente
           03 N-ALE-NO-EXISTE           PIC 9(8) VALUE ZERO.                 |             03 N-ale-no-existe           pic 9(8) value zero.

      ******************************************************************              ******************************************************************
      * Armado de las lineas de alerta                                                * Armado de las lineas de alerta
       01 LA-LINEAS-ALERTA.                                                  |         01 LA-lineas-alerta.
      *    Los modelos a continuacion deberan obtenerse de un                         *    Los modelos a continuacion deberan obtenerse de un 
      *    archivo, como BDIIALE-ALERTAS                                              *    archivo, como BDIIALE-ALERTAS
           03 LAEND                     PIC 999 COMP VALUE 0.                |             03 LAend                     pic 999 comp value 0.
           03 LA-MODELOS.                                                    |             03 LA-modelos.
      *         12345678901234567890123456789012345678901234567890                    *         12345678901234567890123456789012345678901234567890
               05 PIC X(50) VALUE                                            |                 05 pic x(50) value
               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".                           "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".
               05 PIC X(50) VALUE                                            |                 05 pic x(50) value
               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".                            "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
               05 PIC X(50) VALUE                                            |                 05 pic x(50) value
               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".                           "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".
               05 PIC X(50) VALUE                                            |                 05 pic x(50) value
               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".                           "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
               05 PIC X(50) VALUE HIGH-VALUES. *> END MARKER                 |                 05 pic x(50) value high-values. *> end marker
           03 LA-MODELOS2               REDEFINES LA-MODELOS.                |             03 LA-modelos2               redefines LA-modelos.
               05 LA-MODELO             PIC X(50) OCCURS 5                   |                 05 LA-modelo             pic x(50) occurs 5 
                                        INDEXED LAM.                         |                                          indexed LAm.
      *    Funcionamiento de los templates.                                           *    Funcionamiento de los templates.
      *    Hay dos templates por de alerta, uno por linea.                            *    Hay dos templates por de alerta, uno por linea.
      *    Cada template consiste en hasta 10 frases fijas con                        *    Cada template consiste en hasta 10 frases fijas con
      *    ampersands (&) donde se van a reemplazar los valores.                      *    ampersands (&) donde se van a reemplazar los valores.
      *    Por ejemplo:                                                               *    Por ejemplo: 
      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS                                 *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
      *    tiene 3 frases fijas y 2 reemplazos.                                       *    tiene 3 frases fijas y 2 reemplazos. 
      *    La cantidad de ampersands es irrelevante, pero parece                      *    La cantidad de ampersands es irrelevante, pero parece
      *    conveniente que informe sobre el tamanio del contenido.                    *    conveniente que informe sobre el tamanio del contenido.
           03 LA-TEMPLATES.                                                  |             03 LA-templates.
               05 LA-TEMPLATE           OCCURS 4 INDEXED LAX.                |                 05 LA-template           occurs 4 indexed LAx.
                   07 LA-PARTE          PIC X(50)                            |                     07 LA-parte          pic x(50)
                                        OCCURS 10 INDEXED LAY.               |                                          occurs 10 indexed LAy.
      *    Las dos lineas armadas                                                     *    Las dos lineas armadas
           03 LA-LINEAS.                                                     |             03 LA-lineas.
               05 LA-LINEA1             PIC X(50).                           |                 05 LA-linea1             pic x(50).
               05 LA-LINEA2             PIC X(50).                           |                 05 LA-linea2             pic x(50).
      *    Los valores a insertar en una linea                                        *    Los valores a insertar en una linea
           03 LA-VALORES.                                                    |             03 LA-valores.
               05 LA-VALOR              PIC X(50)                            |                 05 LA-valor              pic x(50) 
                                        OCCURS 10 INDEXED LAV.               |                                          occurs 10 indexed LAv.
      *    Datos para editar valores a insertar                                       *    Datos para editar valores a insertar
           03 LA-NUM                    PIC -(11)0.                          |             03 LA-num                    pic -(11)0.
           03 LA-NUMX                   REDEFINES LA-NUM                     |             03 LA-numX                   redefines LA-num
                                        PIC X(12).                           |                                          pic x(12).
           03 LA-DESCARTE               PIC X(50).                           |             03 LA-descarte               pic x(50).


      ******************************************************************              ******************************************************************
      * Errores de consistencia del input                                             * Errores de consistencia del input
      * Cada error tiene un codigo de 2 digitos, un espacio, contador                 * Cada error tiene un codigo de 2 digitos, un espacio, contador
      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59                  * de ocurrencias de 7 digitos, un espacio, y descripcion de 59
       01 E-ERRORES.                                                         |         01 E-errores.
      *    indica si el registro actual tiene error                                   *    indica si el registro actual tiene error
           03 E-HAY-ERROR               PIC XX VALUE "NO".                   |             03 E-hay-error               pic xx value "NO".
      *    errores del registro actual                                                *    errores del registro actual
           03 E-ERRORES-REG             PIC X(100) VALUE SPACES.             |             03 E-errores-reg             pic x(100) value spaces.
      *    contador de registros con error                                            *    contador de registros con error
           03 E-CONT-REGS-CON-ERROR     PIC 9(8) VALUE ZERO.                 |             03 E-cont-regs-con-error     pic 9(8) value zero.
      *    tabla de errores                                                           *    tabla de errores
           03 PIC X(11) VALUE "01 0000000 ".                                 |             03 pic x(11) value "01 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Tipo de movimiento invalido, debe ser I M E T".                                "Tipo de movimiento invalido, debe ser I M E T".
           03 PIC X(11) VALUE "02 0000000 ".                                 |             03 pic x(11) value "02 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Tipo de identificacion invalido, debe ser 1 2 3 4".                            "Tipo de identificacion invalido, debe ser 1 2 3 4".
           03 PIC X(11) VALUE "03 0000000 ".                                 |             03 pic x(11) value "03 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de identificacion invalido, debe ser numerico".                         "Numero de identificacion invalido, debe ser numerico".
           03 PIC X(11) VALUE "04 0000000 ".                                 |             03 pic x(11) value "04 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Tipo de identificacion debe ser mayor que cero".                               "Tipo de identificacion debe ser mayor que cero".
           03 PIC X(11) VALUE "05 0000000 ".                                 |             03 pic x(11) value "05 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Falta el nombre o denominacion".                                               "Falta el nombre o denominacion".
           03 PIC X(11) VALUE "06 0000000 ".                                 |             03 pic x(11) value "06 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de demandas vigentes: debe ser numerico".                               "Numero de demandas vigentes: debe ser numerico".
           03 PIC X(11) VALUE "07 0000000 ".                                 |             03 pic x(11) value "07 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de demandas terminadas: debe ser numerico".                             "Numero de demandas terminadas: debe ser numerico".
           03 PIC X(11) VALUE "08 0000000 ".                                 |             03 pic x(11) value "08 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".                     "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
           03 PIC X(11) VALUE "09 0000000 ".                                 |             03 pic x(11) value "09 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".                        "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
           03 PIC X(11) VALUE "10 0000000 ".                                 |             03 pic x(11) value "10 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de embargos vigentes: debe ser numerico".                               "Numero de embargos vigentes: debe ser numerico".
           03 PIC X(11) VALUE "11 0000000 ".                                 |             03 pic x(11) value "11 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de embargos terminados: debe ser numerico".                             "Numero de embargos terminados: debe ser numerico".
           03 PIC X(11) VALUE "12 0000000 ".                                 |             03 pic x(11) value "12 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".                     "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
           03 PIC X(11) VALUE "13 0000000 ".                                 |             03 pic x(11) value "13 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".                        "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
           03 PIC X(11) VALUE "14 0000000 ".                                 |             03 pic x(11) value "14 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "El numero de id no se encuentra en el archivo maestro".                        "El numero de id no se encuentra en el archivo maestro".
           03 PIC X(11) VALUE "15 0000000 ".                                 |             03 pic x(11) value "15 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "El nombre en el input no coincide con el registrado".                          "El nombre en el input no coincide con el registrado".
           03 PIC X(11) VALUE "16 0000000 ".                                 |             03 pic x(11) value "16 0000000 ".
           03 PIC X(59) VALUE                                                |             03 pic x(59) value
           "Numero de id fuera del rango del tipo de id informado".                        "Numero de id fuera del rango del tipo de id informado".
      *----------------- insertar nuevos items aqui -------------------               *----------------- insertar nuevos items aqui -------------------
           03 PIC X(11) VALUE "00 0000000 ".                                 |             03 pic x(11) value "00 0000000 ".
           03 PIC X(59) VALUE "--- fin de la lista (cod 00) ---".            |             03 pic x(59) value "--- fin de la lista (cod 00) ---".
           03                           PIC X(3500). *> LOS 50 ITEMS         |             03                           pic x(3500). *> los 50 items
       01 E-ERRORES-2                   REDEFINES E-ERRORES.                 |         01 E-errores-2                   redefines E-errores.
           03                           PIC XX.                              |             03                           pic xx.
           03                           PIC X(100).                          |             03                           pic x(100).
           03                           PIC 9(8).                            |             03                           pic 9(8).
           03 E-ERROR                   OCCURS 50 INDEXED EX.                |             03 E-error                   occurs 50 indexed Ex.
               05 E-CODIGO              PIC XX.                              |                 05 E-codigo              pic xx.
               05                       PIC X.                               |                 05                       pic x.
               05 E-CONTADOR            PIC 9(7).                            |                 05 E-contador            pic 9(7).
               05                       PIC X.                               |                 05                       pic x.
               05 E-DESCRIPCION         PIC X(59).                           |                 05 E-descripcion         pic x(59).
       01 E-EDIT                        PIC Z(8)B.                           |         01 E-edit                        pic z(8)B.

      ******************************************************************              ******************************************************************
      * Control de rangos de valores de las fechas del input                          * Control de rangos de valores de las fechas del input
       01 VALIDACIONES-FECHAS.                                                         01 VALIDACIONES-FECHAS.
           02 ANO-VAL-X                 PIC 9(04).                           |             02 ANO-VAL-X                 pic 9(04).
              88 ANO-VAL                VALUE 1900 THRU 2050.                |                88 ANO-VAL                value 1900 thru 2050.
           02 MES-VAL-X                 PIC 9(02).                           |             02 MES-VAL-X                 pic 9(02).
              88 MES-VAL                VALUE 01   THRU 12.                  |                88 MES-VAL                value 01   thru 12.
           02 DIA-VAL-X                 PIC 9(02).                           |             02 DIA-VAL-X                 pic 9(02).
              88 DIA-VAL                VALUE 01   THRU 31.                  |                88 DIA-VAL                value 01   thru 31.

      /*****************************************************************              /*****************************************************************
      ******************************************************************              ******************************************************************
       PROCEDURE DIVISION.                                                             PROCEDURE DIVISION.
      *    0000-PROGRAMA-PRINCIPAL                                                    *    0000-PROGRAMA-PRINCIPAL
      *    4000-PROCESAR-REGISTRO                                                     *    4000-PROCESAR-REGISTRO
      *    4000-PROCESAR-REGISTRO-2                                                   *    4000-PROCESAR-REGISTRO-2
      *    4100-VALIDACION-FORMAL                                                     *    4100-VALIDACION-FORMAL
      *    4200-VALIDACION-SEMANTICA                                                  *    4200-VALIDACION-SEMANTICA
      *    4300-MODIFICAR-BDIIALE                                                     *    4300-MODIFICAR-BDIIALE
      *    4300-MODIFICAR-BDIIALE-DATOS                                               *    4300-MODIFICAR-BDIIALE-DATOS
      *    4300-MODIFICAR-BDIIALE-I                                                   *    4300-MODIFICAR-BDIIALE-I
      *    4300-MODIFICAR-BDIIALE-M                                                   *    4300-MODIFICAR-BDIIALE-M
      *    4300-MODIFICAR-BDIIALE-E                                                   *    4300-MODIFICAR-BDIIALE-E
      *    4333-LEER-BDIIALE-RANDOM                                                   *    4333-LEER-BDIIALE-RANDOM
      *    4333-GRABAR-BDIIALE                                                        *    4333-GRABAR-BDIIALE
      *    4333-REGRABAR-BDIIALE                                                      *    4333-REGRABAR-BDIIALE
      *    4333-ELIMINAR-BDIIALE                                                      *    4333-ELIMINAR-BDIIALE
      *    4900-GRABAR-ERROR                                                          *    4900-GRABAR-ERROR
      *    4320-ARMAR-TEXTO-ALERTA                                                    *    4320-ARMAR-TEXTO-ALERTA
      *    1000-RUTINA-INICIAL                                                        *    1000-RUTINA-INICIAL
      *    1001-ELIMINAR-TODO                                                         *    1001-ELIMINAR-TODO
      *    7000-RUTINA-FINAL                                                          *    7000-RUTINA-FINAL
      *    9000-CANCELAR-PROGRAMA                                                     *    9000-CANCELAR-PROGRAMA


       0000-PROGRAMA-PRINCIPAL.                                                        0000-PROGRAMA-PRINCIPAL.
      ******************************************************************              ******************************************************************
      *    inicializa el ambiente y abre los archivos                                 *    inicializa el ambiente y abre los archivos
           PERFORM 1000-RUTINA-INICIAL                                       |             perform 1000-RUTINA-INICIAL
      *    procesa cada uno de los registros del archivo JURAD hasta                  *    procesa cada uno de los registros del archivo JURAD hasta
      *    ENCONTRAR EL REGISTRO "T" DE TOTALES                              |        *    encontrar el registro "T" de totales
           PERFORM 4000-PROCESAR-REGISTRO UNTIL IND-FIN-PROCESO = "SI"       |             perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
      *    cierra archivos y produce el reporte final                                 *    cierra archivos y produce el reporte final
           PERFORM 7000-RUTINA-FINAL                                         |             perform 7000-RUTINA-FINAL
           GOBACK.                                                           |             goback.

       4000-PROCESAR-REGISTRO.                                                         4000-PROCESAR-REGISTRO.
      ****************************************************************                ****************************************************************
      * Proceso de un registro del archivo de entrada JURAD                           * Proceso de un registro del archivo de entrada JURAD
      * Lectura y control del file status del archivo                                 * Lectura y control del file status del archivo
      ****************************************************************                ****************************************************************
      *    lectura del proximo registro                                               *    lectura del proximo registro
           READ JURAD                                                        |             read JURAD
           EVALUATE JURAD-FS                                                 |             evaluate JURAD-fs
           WHEN "00"                                                         |             when "00"
      *        controla el reg y lo aplica si es OK                                   *        controla el reg y lo aplica si es OK
               PERFORM 4000-PROCESAR-REGISTRO-2                              |                 perform 4000-PROCESAR-REGISTRO-2
               MOVE JURAD-REG TO JURAD-REG-ANTERIOR                          |                 move JURAD-reg to JURAD-reg-anterior
           WHEN "10"                                                         |             when "10"
      *        fin del archivo de input:                                              *        fin del archivo de input:
      *        ESTO ES UN ERROR, NO SE ENCONTRO EL REGISTRO "T" ANTES        |        *        esto es un error, no se encontro el registro "T" antes
      *        de que se terminara el archivo                                         *        de que se terminara el archivo
               DISPLAY "Falta el reg de totales del archivo JURAD "          |                 display "Falta el reg de totales del archivo JURAD "
               DISPLAY "Nombre del archivo: " P-FILE-NAME                    |                 display "Nombre del archivo: " P-file-name
               DISPLAY "File status: " JURAD-FS                              |                 display "File status: " JURAD-fs
               DISPLAY "Ultimo registro leido: " N-REG-LEIDOS                |                 display "Ultimo registro leido: " N-reg-leidos
               DISPLAY JURAD-REG-ANTERIOR                                    |                 display JURAD-reg-anterior
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           WHEN OTHER                                                        |             when other
      *        error de lectura: cancelacion del proceso                              *        error de lectura: cancelacion del proceso
               DISPLAY "Error en lectura del archivo JURAD "                 |                 display "Error en lectura del archivo JURAD "
               DISPLAY "Nombre del archivo: " P-FILE-NAME                    |                 display "Nombre del archivo: " P-file-name
               DISPLAY "File status: " JURAD-FS                              |                 display "File status: " JURAD-fs
               DISPLAY "Ultimo registro leido: " N-REG-LEIDOS                |                 display "Ultimo registro leido: " N-reg-leidos
               DISPLAY JURAD-REG-ANTERIOR                                    |                 display JURAD-reg-anterior
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4000-PROCESAR-REGISTRO-2.                                                       4000-PROCESAR-REGISTRO-2.
      ****************************************************************                ****************************************************************
      * Controla los datos de un registro de JURAD y si es OK lo usa                  * Controla los datos de un registro de JURAD y si es OK lo usa
      * para actualizar el archivo de alertas en linea                                * para actualizar el archivo de alertas en linea
      * La informacion esta leida en JURAD-reg                                        * La informacion esta leida en JURAD-reg
      ****************************************************************                ****************************************************************
           MOVE "NO" TO E-HAY-ERROR                                          |             move "NO" to E-hay-error

      *    validacion del tipo de movimiento                                          *    validacion del tipo de movimiento
           IF JURAD-TIPO-NOVEDAD NOT = "I" and "M" and "E" and "T"           |             if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 
               CALL "PONERR" using "01" JURAD-REG E-ERRORES                  |                 call "PONERR" using "01" JURAD-reg E-errores
           END-IF                                                            |             end-if

      *    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESO          |        *    si es el registro "T" hay que senialar el fin de proceso
           IF JURAD-TIPO-NOVEDAD = "T"                                       |             if JURAD-tipo-novedad = "T" 
               MOVE "SI" TO IND-FIN-PROCESO                                  |                 move "SI" to IND-fin-proceso
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if

           ADD 1 TO N-REG-LEIDOS                                             |             add 1 to N-reg-leidos

      *    validacion formal de los datos                                             *    validacion formal de los datos
           PERFORM 4100-VALIDACION-FORMAL                                    |             perform 4100-VALIDACION-FORMAL
           IF E-HAY-ERROR = "SI"                                             |             if E-hay-error = "SI"
               PERFORM 4900-GRABAR-ERROR                                     |                 exit paragraph
               EXIT PARAGRAPH                                                |             end-if
           END-IF                                                            <  

      *    si la validacion formal dio OK se hace validacion semantica                *    si la validacion formal dio OK se hace validacion semantica
           PERFORM 4200-VALIDACION-SEMANTICA                                 |             perform 4200-VALIDACION-SEMANTICA
           IF E-HAY-ERROR = "SI"                                             |             if E-hay-error = "SI"
               PERFORM 4900-GRABAR-ERROR                                     |                 exit paragraph
               EXIT PARAGRAPH                                                |             end-if
           END-IF                                                            <  

      *    intento de actualizacion de BDIIALE                               |        *    actualizacion de BDIIALE o grabacion en arch ERRS de defectos
           PERFORM 4300-MODIFICAR-BDIIALE                                    |             if E-hay-error = "SI"
           ADD 1 TO N-REG-OK.                                                |                 perform 4900-GRABAR-ERROR
                                                                             >                 add 1 to N-reg-con-error
                                                                             >             else
                                                                             >                 perform 4300-MODIFICAR-BDIIALE
                                                                             >                 add 1 to N-reg-OK
                                                                             >             end-if.



       4100-VALIDACION-FORMAL.                                                         4100-VALIDACION-FORMAL.
      ******************************************************************              ******************************************************************
      * Validacion formal de los datos del input                                      * Validacion formal de los datos del input
      ******************************************************************              ******************************************************************
      *    Tipo de identificacion Numero {1, 2, 3, 4}                                 *    Tipo de identificacion Numero {1, 2, 3, 4}
           IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"                |             if JURAD-id-tipo not = "1" and "2" and "3" and "4"
               CALL "PONERR" USING "02" JURAD-REG E-ERRORES                  |                 call "PONERR" using "02" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de identificacion                                                   *    Numero de identificacion
           IF JURAD-ID-NUMEROX IS NOT NUMERIC                                |             if JURAD-id-numeroX is not numeric
               CALL "PONERR" USING "03" JURAD-REG E-ERRORES                  |                 call "PONERR" using "03" JURAD-reg E-errores
           END-IF                                                            |             end-if
           IF JURAD-ID-NUMERO NOT > 0                                        |             if JURAD-id-numero not > 0
               CALL "PONERR" USING "04" JURAD-REG E-ERRORES                  |                 call "PONERR" using "04" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    si el movimiento es una eliminacion los datos subsiguientes                *    si el movimiento es una eliminacion los datos subsiguientes
      *    no se controlan                                                            *    no se controlan
           IF JURAD-TIPO-NOVEDAD = "E"                                       |             if JURAD-tipo-novedad = "E"
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if
      *    Nombres y Apellidos                                                        *    Nombres y Apellidos
           IF JURAD-NOMBRE = SPACES                                          |             if JURAD-nombre = spaces
               CALL "PONERR" USING "05" JURAD-REG E-ERRORES                  |                 call "PONERR" using "05" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de demandas vigentes                                                *    Numero de demandas vigentes
           IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC                         |             if JURAD-demandas-vigentes is not numeric
               CALL "PONERR" USING "06" JURAD-REG E-ERRORES                  |                 call "PONERR" using "06" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de demandas terminadas                                              *    Numero de demandas terminadas
           IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC                       |             if JURAD-demandas-terminadas is not numeric
               CALL "PONERR" USING "07" JURAD-REG E-ERRORES                  |                 call "PONERR" using "07" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Fecha ultima demanda vigente YYMMDD                                        *    Fecha ultima demanda vigente YYMMDD
           IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC                     |             if JURAD-demandas-fecha-ultima is not numeric
               CALL "PONERR" USING "08" JURAD-REG E-ERRORES                  |                 call "PONERR" using "08" JURAD-reg E-errores
           END-IF                                                            |             end-if
           MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS           |             move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS
           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL                      |             if not ANO-VAL or not MES-VAL or not DIA-VAL
               CALL "PONERR" USING "09" JURAD-REG E-ERRORES                  |                 call "PONERR" using "09" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de embargos vigentes                                                *    Numero de embargos vigentes
           IF JURAD-EMBARGOS-VIGENTES NOT NUMERIC                            |             if JURAD-embargos-vigentes not numeric
               CALL "PONERR" USING "10" JURAD-REG E-ERRORES                  |                 call "PONERR" using "10" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Numero de embargos terminados                                              *    Numero de embargos terminados
           IF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC                          |             if JURAD-embargos-terminados not numeric
               CALL "PONERR" USING "11" JURAD-REG E-ERRORES                  |                 call "PONERR" using "11" JURAD-reg E-errores
           END-IF                                                            |             end-if
      *    Fecha ultimo embargo vigente YYMMDD                                        *    Fecha ultimo embargo vigente YYMMDD
           IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC                     |             if JURAD-embargos-fecha-ultimo is not numeric
               CALL "PONERR" USING "12" JURAD-REG E-ERRORES                  |                 call "PONERR" using "12" JURAD-reg E-errores
           END-IF                                                            |             end-if
           MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS           |             move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS
           IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL                      |             if not ANO-VAL or not MES-VAL or not DIA-VAL
               CALL "PONERR" USING "13" JURAD-REG E-ERRORES                  |                 call "PONERR" using "13" JURAD-reg E-errores
           END-IF.                                                           |             end-if.


       4200-VALIDACION-SEMANTICA.                                                      4200-VALIDACION-SEMANTICA.
      ****************************************************************                ****************************************************************
      * Validacion del numero de identificacion y de su relacion con                  * Validacion del numero de identificacion y de su relacion con
      * el nombre                                                                     * el nombre
      ****************************************************************                ****************************************************************
           MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE                            |             move JURAD-id-tipo to TIP-IDE-BDIIVIDE
           MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE-R                        |             move JURAD-id-numero to NUM-IDE-BDIIVIDE-R
           MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE                              |             move JURAD-nombre to NOMBRE-BDIIVIDE
           MOVE 1 TO SW-VERIFNOM-BDIIVIDE                                    |             move 1 to SW-VERIFNOM-BDIIVIDE
           MOVE 0 TO SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE             |             move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE
           PERFORM 80100-VALIDAR-IDENTIFICACION                              |             perform 80100-VALIDAR-IDENTIFICACION
      *    a ver si la validacion cambio el tipo de ide                               *    a ver si la validacion cambio el tipo de ide
           IF JURAD-ID-TIPO NOT = TIP-IDE-BDIIVIDE                           |             if JURAD-id-tipo not = TIP-IDE-BDIIVIDE
               CALL "PONERR" USING "16" JURAD-REG E-ERRORES                  |                 call "PONERR" using "16" JURAD-reg E-errores
               DISPLAY "Tipo ide cambiado de " JURAD-id-tipo " a "           |                 display "Tipo ide cambiado de " JURAD-id-tipo " a " 
               TIP-IDE-BDIIVIDE " num ide: " JURAD-ID-NUMERO                 |                 TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero
           END-IF                                                            |             end-if
      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe                          *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe
           IF SW-ID-BDIIVIDE = 1                                             |             if SW-ID-BDIIVIDE = 1
               CALL "PONERR" USING "14" JURAD-REG E-ERRORES                  |                 call "PONERR" using "14" JURAD-reg E-errores
           ELSE                                                              |             else
      *        existe id, a ver si el nombre coincide                                 *        existe id, a ver si el nombre coincide
               IF SW-NOMBRES-BDIIVIDE = 1    *> NOMBRE NO COINCIDE           |                 if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide
                   CALL "PONERR" USING "15" JURAD-REG E-ERRORES              |                     call "PONERR" using "15" JURAD-reg E-errores
                   DISPLAY "novedad:  " JURAD-NOMBRE                         |                     display "novedad:  " JURAD-nombre
                   DISPLAY "registro: " NOM-LEIDO-BDIIVIDE                   |                     display "registro: " NOM-LEIDO-BDIIVIDE
               END-IF                                                        |                 end-if
           END-IF.                                                           |             end-if.


       4300-MODIFICAR-BDIIALE.                                                         4300-MODIFICAR-BDIIALE.
      ******************************************************************              ******************************************************************
      * Se impacta el archivo BDIIALE con una o dos inserciones,                      * Se impacta el archivo BDIIALE con una o dos inserciones, 
      * modificaciones o eliminaciones segun haya o no demandas y                     * modificaciones o eliminaciones segun haya o no demandas y 
      * embargos                                                                      * embargos
      ******************************************************************              ******************************************************************
           INITIALIZE REG-BDIIALE                                            |             initialize REG-BDIIALE

      *    si hay demandas                                                            *    si hay demandas
           IF JURAD-DEMANDAS-VIGENTES > ZERO                                 |             if JURAD-demandas-vigentes > zero
           OR JURAD-DEMANDAS-TERMINADAS > ZERO                               |             or JURAD-demandas-terminadas > zero 
               MOVE "J001" TO LLASEC-BDIIALE                                 |                 move "J001" to LLASEC-BDIIALE
      *        arma datos de demandas                                                 *        arma datos de demandas
               MOVE JURAD-DEMANDAS-VIGENTES TO D-VIGENTES                    |                 move JURAD-demandas-vigentes to D-vigentes
               MOVE JURAD-DEMANDAS-TERMINADAS TO D-TERMINADOS                |                 move JURAD-demandas-terminadas to D-terminados
               STRING "20" JURAD-DEMANDAS-FECHA-ULTIMA                       |                 string "20" JURAD-demandas-fecha-ultima 
               DELIMITED SIZE INTO D-FECHA-ULTIMA                            |                 delimited size into D-fecha-ultima
               PERFORM 4300-MODIFICAR-BDIIALE-DATOS                          |                 perform 4300-MODIFICAR-BDIIALE-DATOS 
           END-IF.                                                           |             end-if.

      *    si hay embargos                                                            *    si hay embargos
           IF JURAD-EMBARGOS-VIGENTES > ZERO                                 |             if JURAD-embargos-vigentes > zero
           OR JURAD-EMBARGOS-TERMINADOS > ZERO                               |             or JURAD-embargos-terminados > zero 
               MOVE "J002" TO LLASEC-BDIIALE                                 |                 move "J002" to LLASEC-BDIIALE
      *        arma datos de embargos                                                 *        arma datos de embargos
               MOVE JURAD-EMBARGOS-VIGENTES TO D-VIGENTES                    |                 move JURAD-embargos-vigentes to D-vigentes
               MOVE JURAD-EMBARGOS-TERMINADOS TO D-TERMINADOS                |                 move JURAD-embargos-terminados to D-terminados
               STRING "20" JURAD-EMBARGOS-FECHA-ULTIMO                       |                 string "20" JURAD-embargos-fecha-ultimo
               DELIMITED SIZE INTO D-FECHA-ULTIMA                            |                 delimited size into D-fecha-ultima
               PERFORM 4300-MODIFICAR-BDIIALE-DATOS                          |                 perform 4300-MODIFICAR-BDIIALE-DATOS 
           END-IF.                                                           |             end-if.



       4300-MODIFICAR-BDIIALE-DATOS.                                                   4300-MODIFICAR-BDIIALE-DATOS.
      ******************************************************************              ******************************************************************
      * Parte de la carga de datos en el registro BDIIALE y grabacion                 * Parte de la carga de datos en el registro BDIIALE y grabacion
      * del mismo que es comun a demandas y embargos                                  * del mismo que es comun a demandas y embargos
      * EL DATO LLASEC-BDIIALE YA TIENE "J001" o "J002"                      |        * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
      ******************************************************************              ******************************************************************
      *    completa la clave e intenta leer la alerta, si se leyo OK                  *    completa la clave e intenta leer la alerta, si se leyo OK
      *    EL FILE STATUS DE BDIIALE QUEDA CON "00"                          |        *    el file status de BDIIALE queda con "00"
           PERFORM 4333-LEER-BDIIALE-RANDOM                                  |             perform 4333-LEER-BDIIALE-RANDOM

      *    procesa segun el tipo de novedad I M E                                     *    procesa segun el tipo de novedad I M E
           EVALUATE JURAD-TIPO-NOVEDAD                                       |             evaluate JURAD-tipo-novedad
           WHEN "I"                                                          |             when "I"
               ADD 1 TO N-REG-TIPO-I-OK                                      |                 add 1 to N-reg-tipo-I-OK
               PERFORM 4300-MODIFICAR-BDIIALE-I                              |                 perform 4300-MODIFICAR-BDIIALE-I
           WHEN "M"                                                          |             when "M"
               ADD 1 TO N-REG-TIPO-M-OK                                      |                 add 1 to N-reg-tipo-M-OK
               PERFORM 4300-MODIFICAR-BDIIALE-M                              |                 perform 4300-MODIFICAR-BDIIALE-M
           WHEN "E"                                                          |             when "E"
               ADD 1 TO N-REG-TIPO-E-OK                                      |                 add 1 to N-reg-tipo-E-OK
               PERFORM 4300-MODIFICAR-BDIIALE-E                              |                 perform 4300-MODIFICAR-BDIIALE-E
           WHEN OTHER                                                        |             when other
      *        ESTO ES "imposible" POR CONTROL DE CONSISTENCIA ANTERIOR      |        *        esto es "imposible" por control de consistencia anterior
               DISPLAY "error de logica: tipo-novedad="                      |                 display "error de logica: tipo-novedad="
               JURAD-TIPO-NOVEDAD " reg nÂ°: " N-REG-LEIDOS                  |                 JURAD-tipo-novedad " reg nÃÂ°: " N-reg-leidos
               DISPLAY "Registro de JURAD: " DISPLAY JURAD-REG               |                 display "Registro de JURAD: " display JURAD-reg
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4300-MODIFICAR-BDIIALE-I.                                                       4300-MODIFICAR-BDIIALE-I.
      ******************************************************************              ******************************************************************
      * Insercion de una alerta nueva                                                 * Insercion de una alerta nueva
      * Si ya existia muestra un mensaje y continua                                   * Si ya existia muestra un mensaje y continua
      ******************************************************************              ******************************************************************
      *    si el registro existia es un error                                         *    si el registro existia es un error
           IF EST-BDIIALE = "00"                                             |             if EST-BDIIALE = "00"
               DISPLAY "Insercion de alerta nueva que ya existe "            |                 display "Insercion de alerta nueva que ya existe "
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro de input: "                                 |                 display "Registro de input: "
               DISPLAY JURAD-REG                                             |                 display JURAD-reg
               DISPLAY "Datos en la alerta: " INF-DATAHOST-BDIIALE           |                 display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               ADD 1 TO N-ALE-YA-EXISTE                                      |                 add 1 to N-ale-ya-existe
           END-IF                                                            |             end-if

      *    completa los datos del registro                                            *    completa los datos del registro
           INITIALIZE ENCABEZADO-BDIIALE                                     |             initialize ENCABEZADO-BDIIALE
           MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-NOV-BDIIALE                  |             move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE
           FEC-REP-BDIIALE                                                                 FEC-REP-BDIIALE 
           MOVE P-FECHA-PROCESO-50 TO FEC-VEN-BDIIALE                        |             move P-fecha-proceso-50 to FEC-VEN-BDIIALE
           MOVE 0 TO BLOQUEO-BDIIALE                                         |             move 0 to BLOQUEO-BDIIALE
           MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE                           |             move D-datahost to INF-DATAHOST-BDIIALE
           PERFORM 4320-ARMAR-TEXTO-ALERTA                                   |             perform 4320-ARMAR-TEXTO-ALERTA
           IF EST-BDIIALE = "00"                                             |             if EST-BDIIALE = "00"
               PERFORM 4333-REGRABAR-BDIIALE                                 |                 perform 4333-REGRABAR-BDIIALE
           ELSE                                                              |             else
               PERFORM 4333-GRABAR-BDIIALE                                   |                 perform 4333-GRABAR-BDIIALE
           END-IF.                                                           |             end-if.


       4300-MODIFICAR-BDIIALE-M.                                                       4300-MODIFICAR-BDIIALE-M.
      ******************************************************************              ******************************************************************
      * Modificacion de una alerta existente                                          * Modificacion de una alerta existente
      * Si no existia muestra un mensaje y continua                                   * Si no existia muestra un mensaje y continua
      ******************************************************************              ******************************************************************
      *    si el registro no existia es un error                                      *    si el registro no existia es un error
           IF EST-BDIIALE NOT = "00"                                         |             if EST-BDIIALE not = "00"
               DISPLAY "Modificacion de alerta inexistente "                 |                 display "Modificacion de alerta inexistente "
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro de input: "                                 |                 display "Registro de input: "
               DISPLAY JURAD-REG                                             |                 display JURAD-reg
               DISPLAY "Datos en la alerta: " INF-DATAHOST-BDIIALE           |                 display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               ADD 1 TO N-ALE-NO-EXISTE                                      |                 add 1 to N-ale-no-existe
           END-IF                                                            |             end-if
      *    reemplaza la fecha de reporte y los valores                                *    reemplaza la fecha de reporte y los valores
           MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-REP-BDIIALE                  |             move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 
           MOVE D-DATAHOST TO INF-DATAHOST-BDIIALE                           |             move D-datahost to INF-DATAHOST-BDIIALE
           PERFORM 4320-ARMAR-TEXTO-ALERTA                                   |             perform 4320-ARMAR-TEXTO-ALERTA
           IF EST-BDIIALE = "00"                                             |             if EST-BDIIALE = "00"
               PERFORM 4333-REGRABAR-BDIIALE                                 |                 perform 4333-REGRABAR-BDIIALE
           ELSE                                                              |             else
               PERFORM 4333-GRABAR-BDIIALE                                   |                 perform 4333-GRABAR-BDIIALE
           END-IF.                                                           |             end-if.


       4300-MODIFICAR-BDIIALE-E.                                                       4300-MODIFICAR-BDIIALE-E.
      ******************************************************************              ******************************************************************
      * Eliminacion de una alerta                                                     * Eliminacion de una alerta
      * Si no existia muestra un mensaje y continua                                   * Si no existia muestra un mensaje y continua
      ******************************************************************              ******************************************************************
      *    elimina el registro                                                        *    elimina el registro
           IF EST-BDIIALE = "00"                                             |             if EST-BDIIALE = "00"
               PERFORM 4333-ELIMINAR-BDIIALE                                 |                 perform 4333-ELIMINAR-BDIIALE
           ELSE                                                              |             else
               DISPLAY "Eliminacion de alerta inexistente "                  |                 display "Eliminacion de alerta inexistente "
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro de input: "                                 |                 display "Registro de input: "
               DISPLAY JURAD-REG                                             |                 display JURAD-reg
               ADD 1 TO N-ALE-NO-EXISTE                                      |                 add 1 to N-ale-no-existe
           END-IF.                                                           |             end-if.


       4333-LEER-BDIIALE-RANDOM.                                                       4333-LEER-BDIIALE-RANDOM.
      ******************************************************************              ******************************************************************
      * Arma clave exacta y lee un registro de BDIIALE                                * Arma clave exacta y lee un registro de BDIIALE
      * Usa los datos del reg input, excepto LLASEC que esta precargado               * Usa los datos del reg input, excepto LLASEC que esta precargado
      * CUANDO PUDO LEER OK EL FILE STATUS EST-BDIIALE QUEDA CON "00"        |        * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
      ******************************************************************              ******************************************************************
           MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIALE                             |             move JURAD-id-tipo to TIP-IDE-BDIIALE
           MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIALE                           |             move JURAD-id-numero to NUM-IDE-BDIIALE
           MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE                           |             move P-cod-suscriptor to FUENTE-BDIIALE
           MOVE 000 TO COD-ALERTA-BDIIALE                                    |             move 000 to COD-ALERTA-BDIIALE

           READ BDIIALE                                                      |             read BDIIALE
           EVALUATE EST-BDIIALE                                              |             evaluate EST-BDIIALE
           WHEN "00"                                                         |             when "00"
               CONTINUE                                                      |                 continue
           WHEN "20" thru "29"                                               |             when "20" thru "29"
               CONTINUE                                                      |                 continue
           WHEN OTHER                                                        |             when other
               DISPLAY "Error al leer BDIIALE fs: " EST-BDIIALE              |                 display "Error al leer BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Ultimo registro procesado: "                         |                 display "Ultimo registro procesado: "
               DISPLAY JURAD-REG-ANTERIOR                                    |                 display JURAD-reg-anterior
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4333-GRABAR-BDIIALE.                                                            4333-GRABAR-BDIIALE.
      ******************************************************************              ******************************************************************
      * Inserta un registro nuevo en BDIIALE                                          * Inserta un registro nuevo en BDIIALE
      ******************************************************************              ******************************************************************
           IF NOT PROCESO-REAL                                               |             if not PROCESO-REAL
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if
           WRITE REG-BDIIALE                                                 |             write REG-BDIIALE
           EVALUATE EST-BDIIALE                                              |             evaluate EST-BDIIALE
           WHEN "00"                                                         |             when "00"
               ADD 1 TO N-ALE-INSERTADAS                                     |                 add 1 to N-ale-insertadas
           WHEN OTHER                                                        |             when other
               DISPLAY "Error al grabar BDIIALE fs: " EST-BDIIALE            |                 display "Error al grabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro BDIIALE: "                                  |                 display "Registro BDIIALE: "
               DISPLAY REG-BDIIALE                                           |                 display REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4333-REGRABAR-BDIIALE.                                                          4333-REGRABAR-BDIIALE.
      ******************************************************************              ******************************************************************
      * Regraba un registro modificado en BDIIALE                                     * Regraba un registro modificado en BDIIALE
      ******************************************************************              ******************************************************************
           IF NOT PROCESO-REAL                                               |             if not PROCESO-REAL
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if
           REWRITE REG-BDIIALE                                               |             rewrite REG-BDIIALE
           EVALUATE EST-BDIIALE                                              |             evaluate EST-BDIIALE
           WHEN "00"                                                         |             when "00"
               ADD 1 TO N-ALE-MODIFICADAS                                    |                 add 1 to N-ale-modificadas
           WHEN OTHER                                                        |             when other
               DISPLAY "Error al regrabar BDIIALE fs: " EST-BDIIALE          |                 display "Error al regrabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro BDIIALE: "                                  |                 display "Registro BDIIALE: "
               DISPLAY REG-BDIIALE                                           |                 display REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4333-ELIMINAR-BDIIALE.                                                          4333-ELIMINAR-BDIIALE.
      ******************************************************************              ******************************************************************
      * Elimina un registro de BDIIALE                                                * Elimina un registro de BDIIALE
      ******************************************************************              ******************************************************************
           IF NOT PROCESO-REAL                                               |             if not PROCESO-REAL
               EXIT PARAGRAPH                                                |                 exit paragraph
           END-IF                                                            |             end-if
           DELETE BDIIALE                                                    |             delete BDIIALE
           EVALUATE EST-BDIIALE                                              |             evaluate EST-BDIIALE
           WHEN "00"                                                         |             when "00"
               ADD 1 TO N-ALE-ELIMINADAS                                     |                 add 1 to N-ale-eliminadas
           WHEN OTHER                                                        |             when other
               DISPLAY "Error al regrabar BDIIALE fs: " EST-BDIIALE          |                 display "Error al regrabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE                                                          " key: " LLAVE-BDIIALE
               DISPLAY "Registro BDIIALE: "                                  |                 display "Registro BDIIALE: "
               DISPLAY REG-BDIIALE                                           |                 display REG-BDIIALE
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.


       4900-GRABAR-ERROR.                                                              4900-GRABAR-ERROR.
      ******************************************************************              ******************************************************************
      * El registro de JURAD tiene error: se graba en el archivo ERRS                 * El registro de JURAD tiene error: se graba en el archivo ERRS
      * con indicacion del error detectado                                            * con indicacion del error detectado
      ******************************************************************              ******************************************************************
           MOVE JURAD-REG TO ERRS-REG                                        |             move JURAD-reg to ERRS-reg
      *    lista de los codigos de los errores del registro                           *    lista de los codigos de los errores del registro
           DISPLAY "Errores del reg: " E-ERRORES-REG                         |             move E-errores-reg to ERRS-causa-rechazo
           MOVE E-ERRORES-REG TO ERRS-CAUSA-RECHAZO                          |             write ERRS-reg
           WRITE ERRS-REG                                                    |             evaluate ERRS-fs
           EVALUATE ERRS-FS                                                  |                 when "00"
           WHEN "00"                                                         |                     continue
               CONTINUE                                                      |                 when other
           WHEN OTHER                                                        |                     display "Error al grabar el archivo de errores "
               DISPLAY "Error al grabar el archivo de errores "              |                     display "Nombre del archivo: " ERRS-file-name
               DISPLAY "Nombre del archivo: " ERRS-FILE-NAME                 |                     display "File status: " ERRS-fs
               DISPLAY "File status: " ERRS-FS                               |                     perform 9000-CANCELAR-PROGRAMA
               PERFORM 9000-CANCELAR-PROGRAMA                                |                     goback
               GOBACK                                                        |             end-evaluate.
           END-EVALUATE.                                                     <  


       4320-ARMAR-TEXTO-ALERTA.                                                        4320-ARMAR-TEXTO-ALERTA.
      ****************************************************************                ****************************************************************
      * Hace el reemplazo de los valores adecuados en los templates                   * Hace el reemplazo de los valores adecuados en los templates
      * de las linea de alerta que corresponde                                        * de las linea de alerta que corresponde
      ****************************************************************                ****************************************************************
      *    segun se trate de demandas o embargos                                      *    segun se trate de demandas o embargos
           IF JURAD-DEMANDAS-VIGENTES NOT = 0                                |             if JURAD-demandas-vigentes not = 0 
           OR JURAD-DEMANDAS-TERMINADAS NOT = 0                              |             or JURAD-demandas-terminadas not = 0
               SET LAX TO 1                                                  |                 set LAx to 1
               MOVE HIGH-VALUES TO LA-VALORES                                |                 move high-values to LA-valores
               MOVE JURAD-DEMANDAS-VIGENTES TO LA-NUM                        |                 move JURAD-demandas-vigentes to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile             * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(1)                          *        unstring LA-numX into LA-descarte LA-valor(1)
      *        delimited by all space                                                 *        delimited by all space
               MOVE LA-NUMX(9:12) TO LA-VALOR(1)                             |                 move LA-numx(9:12) to LA-valor(1)
               MOVE JURAD-DEMANDAS-TERMINADAS TO LA-NUM                      |                 move JURAD-demandas-terminadas to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile             * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(2)                          *        unstring LA-numX into LA-descarte LA-valor(2)
      *        delimited by all space                                                 *        delimited by all space
               MOVE LA-NUMX(9:12) TO LA-VALOR(2)                             |                 move LA-numx(9:12) to LA-valor(2)

      * >>>> esto esta anulado x que no se como hacer para que lo compile             * >>>> esto esta anulado x que no se como hacer para que lo compile
      * >>>> da error en el end-if                                                    * >>>> da error en el end-if
      *        string LA-parte(LAx, 1) LA-valor(1)                                    *        string LA-parte(LAx, 1) LA-valor(1)
      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)              *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)              *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)              *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)              *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
      *        LA-parte(LAx, 10) LA-valor(10)                                         *        LA-parte(LAx, 10) LA-valor(10)
      *        delimited by high-value                                                *        delimited by high-value
           END-IF.                                                           |             end-if.


       1000-RUTINA-INICIAL.                                                            1000-RUTINA-INICIAL.
      ******************************************************************              ******************************************************************
      * Todas las operaciones que se realizan una sola vez, al comienzo               * Todas las operaciones que se realizan una sola vez, al comienzo
      * del programa:                                                                 * del programa:
      *   - obtencion de los parametros                                               *   - obtencion de los parametros
      *   - apertura del archivo de entrada                                           *   - apertura del archivo de entrada
      *   - apertura de todos los demas archivos                                      *   - apertura de todos los demas archivos
      *   - eliminacion de datos existentes si es refresque completo                  *   - eliminacion de datos existentes si es refresque completo
      ******************************************************************              ******************************************************************
      * Registra hora de inicio                                                       * Registra hora de inicio
           ACCEPT W-HORA-INICIO FROM TIME                                    |             accept W-hora-inicio from time

      * Obtiene informacion sobre la corrida de la linea de comando: el               * Obtiene informacion sobre la corrida de la linea de comando: el
      * nombre del archivo de entrada (que contiene el tipo de proceso),              * nombre del archivo de entrada (que contiene el tipo de proceso),
      * el indicador de proceso real o en falso (default)                             * el indicador de proceso real o en falso (default)
           ACCEPT P-COMMAND-LINE FROM COMMAND-LINE                           |             accept P-command-line from COMMAND-LINE
           DISPLAY "Parametros: " P-COMMAND-LINE                             |             display "Parametros: " P-command-line
           UNSTRING P-COMMAND-LINE DELIMITED BY ALL " " INTO                 |             unstring P-command-line delimited by all " " into
           P-FILE-NAME P-PROCESO-REAL                                        |             P-file-name P-proceso-real

      * El programa se anuncia en la consola                                          * El programa se anuncia en la consola
      * TODO: se usa un anuncio mas vistoso                                           * TODO: se usa un anuncio mas vistoso
           IF PROCESO-REAL                                                   |             if PROCESO-REAL
               DISPLAY PGM " Carga de archivo JURAD - proceso REAL"          |                 display pgm " Carga de archivo JURAD - proceso REAL"
           ELSE                                                              |             else
               DISPLAY PGM " Carga de archivo JURAD - proceso en falso"      |                 display pgm " Carga de archivo JURAD - proceso en falso"
           END-IF                                                            |             end-if

      * El indicador de proceso real debe ser S|si|N|no                      |        * El indicador de proceso real debe ser SI|si|NO|no
           IF P-PROCESO-REAL NOT = "S" AND "N"                               |             if P-proceso-real not = "SI" and "NO"
               DISPLAY "El indicador de proceso real es invalido"            |                 display "El indicador de proceso real es invalido"
               DISPLAY "debe ser S o N"                                      |                 display "debe ser SI o NO"
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-IF                                                            |             end-if

      * TODO: controlar los componentes del filename                                  * TODO: controlar los componentes del filename
           EVALUATE P-TIPO-PROCESO                                           |             evaluate P-tipo-proceso
           WHEN "01"                                                         |             when "01"
               DISPLAY "01 Envio Original - Carga TOTAL 1a vez"              |                 display "01 Envio Original - Carga TOTAL 1a vez"
           WHEN "02"                                                         |             when "02"
               DISPLAY "02 Archivo Semanal - Carga PARCIAL"                  |                 display "02 Archivo Semanal - Carga PARCIAL"
           WHEN "03"                                                         |             when "03"
               DISPLAY "03 Archivo Mensual - Carga PARCIAL"                  |                 display "03 Archivo Mensual - Carga PARCIAL"
           WHEN "04"                                                         |             when "04"
               DISPLAY "04 Refresque Total - Carga TOTAL"                    |                 display "04 Refresque Total - Carga TOTAL"
           WHEN OTHER                                                        |             when other
      *        valor invalido                                                         *        valor invalido
               DISPLAY "El tipo de proceso " P-TIPO-PROCESO                  |                 display "El tipo de proceso " P-tipo-proceso
               " es invalido (debe ser 01 02 03 o 04)"                                         " es invalido (debe ser 01 02 03 o 04)"
               PERFORM 9000-CANCELAR-PROGRAMA                                |                 perform 9000-CANCELAR-PROGRAMA
           END-EVALUATE.                                                     |             end-evaluate.

      * Edita la fecha de proceso DDMMAA del parametro en formato                     * Edita la fecha de proceso DDMMAA del parametro en formato
      * YYYYMMDD                                                                      * YYYYMMDD 
           STRING "20" P-FECHA-PROCESO(5:6) P-FECHA-PROCESO(3:4)             |             string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)
           P-FECHA-PROCESO(1:2) DELIMITED SIZE                               |             P-fecha-proceso(1:2) delimited size 
           INTO P-FECHA-PROCESO-YYYYMMDD                                     |             into P-fecha-proceso-YYYYMMDD
           DISPLAY "Fecha de proceso: " P-FECHA-PROCESO-YYYYMMDD             |             display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

      * Calcula una fecha 50 anios posterior a la de proceso                          * Calcula una fecha 50 anios posterior a la de proceso
           MOVE P-FECHA-PROCESO-YYYYMMDD TO P-FECHA-PROCESO-50               |             move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50
           ADD 50 TO P-FECHA-PROCESO-50YYYY                                  |             add 50 to P-fecha-proceso-50YYYY

      * Apertura del archivo de entrada                                               * Apertura del archivo de entrada
           STRING "$TEMPORALES/" P-FILE-NAME INTO P-FILE-PATH                |             open input JURAD
           OPEN INPUT JURAD                                                  |             evaluate JURAD-fs
           EVALUATE JURAD-FS                                                 |                 when "00"
               WHEN "00"                                                     |                      continue
                    CONTINUE                                                 |                 when other
               WHEN OTHER                                                    |                     display "Error en open del archivo jurad "
                   DISPLAY "Error en open del archivo JURAD "                |                     display "Nombre del archivo: " P-file-name
                   DISPLAY "Path del archivo: " P-FILE-PATH                  |                     display "File status: " JURAD-fs
                   DISPLAY "File status: " JURAD-FS                          |                     perform 9000-CANCELAR-PROGRAMA *> no retorna
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA              |                     goback
                   GOBACK                                                    |             end-evaluate.
           END-EVALUATE.                                                     <  

      * Apertura del archivo de errores                                               * Apertura del archivo de errores
           STRING "$TEMPORALES/" P-FILE-NAME(1:19) "_ERRORES.txt"            |             string P-file-name(1:19) "_ERRORES.txt" into
           INTO ERRS-FILE-NAME                                               |             ERRS-file-name
           OPEN OUTPUT ERRS                                                  |             open output ERRS
           EVALUATE ERRS-FS                                                  |             evaluate ERRS-fs
               WHEN "00"                                                     |                 when "00"
                    CONTINUE                                                 |                      continue
               WHEN OTHER                                                    |                 when other
                   DISPLAY "Error en open del archivo de errores "           |                     display "Error en open del archivo de errores "
                   DISPLAY "Nombre del archivo: " ERRS-FILE-NAME             |                     display "Nombre del archivo: " ERRS-file-name
                   DISPLAY "File status: " ERRS-FS                           |                     display "File status: " ERRS-fs
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA              |                     perform 9000-CANCELAR-PROGRAMA *> no retorna
                   GOBACK                                                    |                     goback
           END-EVALUATE.                                                     |             end-evaluate.

      * Apertura de los archivos maestros                                             * Apertura de los archivos maestros
      * TODO: falta capturar el status de estas operaciones?                          * TODO: falta capturar el status de estas operaciones?
           OPEN INPUT BDIIREGI                                               |             open input BDIIREGI
           OPEN INPUT BDIIDIAN                                               |             open input BDIIDIAN
           OPEN INPUT BDIIDAS.                                               |             open input BDIIDAS.

      * Apertura del archivo de alertas en linea                                      * Apertura del archivo de alertas en linea
           IF PROCESO-REAL                                                   |             if PROCESO-REAL
               OPEN I-O BDIIALE                                              |                 open i-o BDIIALE
           ELSE                                                              |             else
               OPEN INPUT BDIIALE                                            |                 open input BDIIALE
           END-IF.                                                           |             end-if.

      * Si es un refresque total (codigo 04) se eliminan los registros                * Si es un refresque total (codigo 04) se eliminan los registros
      * de Jurad existentes                                                           * de Jurad existentes
           IF P-TIPO-PROCESO = "04" AND PROCESO-REAL                         |             if P-tipo-proceso = "04" and PROCESO-REAL
               PERFORM 1001-ELIMINAR-TODO                                    |                 perform 1001-ELIMINAR-TODO
           END-IF.                                                           |             end-if.

       1000-NOT-USED.                                                                  1000-NOT-USED.
      * >>>> esto da un error de compilacion que no puedo resolver                    * >>>> esto da un error de compilacion que no puedo resolver
      * >>>> por ahora esta anulado                                                   * >>>> por ahora esta anulado
      ******************************************************************              ******************************************************************
      * Carga de los templates para armar el texto de alertas                         * Carga de los templates para armar el texto de alertas
      * TODO: por ahora los templates son literales                                   * TODO: por ahora los templates son literales
           SET LAX TO 0                                                      |             set LAx to 0
           MOVE HIGH-VALUES TO LA-TEMPLATES                                  |             move high-values to LA-templates
           PERFORM VARYING LAM FROM 1 BY 1                                   |             perform varying LAm from 1 by 1 
           UNTIL LA-MODELO(LAM) = HIGH-VALUES                                |             until LA-modelo(LAm) = high-values
               SET LAX UP BY 1                                               |                 set LAx up by 1
      *        separa las partes de la linea                                          *        separa las partes de la linea
      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)                          *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)
      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)                     *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)                     *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)                    *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
      *        DELIMITED BY ALL "&"                                          |        *        delimited by all "&"
      *        prepara para omitir los espacios al final de c/parte                   *        prepara para omitir los espacios al final de c/parte
               PERFORM VARYING LAY FROM 1 BY 1 UNTIL LAY > 10                |                 perform varying LAy from 1 by 1 until LAy > 10
                   INSPECT LA-PARTE(LAX, LAY) REPLACING TRAILING             |                     inspect LA-parte(LAx, LAy) replacing trailing
                   SPACES BY HIGH-VALUES                                     |                     spaces by high-values
                   INSPECT LA-PARTE(LAX, LAY) REPLACING FIRST                |                     inspect LA-parte(LAx, LAy) replacing first
                   HIGH-VALUE BY SPACE                                       |                     high-value by space
               END-PERFORM                                                   |                 end-perform
           END-PERFORM.                                                      |             end-perform.



       1001-ELIMINAR-TODO.                                                             1001-ELIMINAR-TODO.
      ******************************************************************              ******************************************************************
      * Elimina los registros de alertas existentes en el archivo de                  * Elimina los registros de alertas existentes en el archivo de
      * alertas en linea, previo a un refresque total                                 * alertas en linea, previo a un refresque total
      ******************************************************************              ******************************************************************
           DISPLAY "Eliminando toda la informacion con fuente JURAD"         |             display "Eliminando toda la informacion con fuente JURAD"
      *    posiciona en el primer reg de JURAD                                        *    posiciona en el primer reg de JURAD
           MOVE ZERO TO TIP-IDE-BDIIALE                                      |             move zero to TIP-IDE-BDIIALE
           MOVE ZERO TO NUM-IDE-BDIIALE                                      |             move zero to NUM-IDE-BDIIALE
           MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE                           |             move P-cod-suscriptor to FUENTE-BDIIALE
           MOVE ZEROS TO COD-ALERTA-BDIIALE                                  |             move zeros to COD-ALERTA-BDIIALE
           MOVE LOW-VALUES TO LLASEC-BDIIALE                                 |             move low-values to LLASEC-BDIIALE
           START BDIIALE KEY > LLAVE-BDIIALE INVALID KEY                     |             start BDIIALE key > LLAVE-BDIIALE invalid key
      *        no hay registros                                                       *        no hay registros
               EXIT PARAGRAPH                                                |                 exit paragraph

      *    lee secuencialmente y elimina los registros de JURAD                       *    lee secuencialmente y elimina los registros de JURAD
      *    hasta el fin del archivo                                                   *    hasta el fin del archivo
           PERFORM UNTIL EST-BDIIALE NOT = "00"                              |             perform until EST-BDIIALE not = "00"
               READ BDIIALE NEXT RECORD                                      |                 read BDIIALE next record
               EVALUATE EST-BDIIALE                                          |                 evaluate EST-BDIIALE
               WHEN "00"                                                     |                 when "00"
                   IF FUENTE-BDIIALE = P-COD-SUSCRIPTOR                      |                     if FUENTE-BDIIALE = P-cod-suscriptor
      *                es un alerta de JURAD                                          *                es un alerta de JURAD
                       DELETE BDIIALE                                        |                         delete BDIIALE
                       IF EST-BDIIALE = "00"                                 |                         if EST-BDIIALE = "00"
                           ADD 1 TO N-ALE-BORRADAS                           |                             add 1 to N-ale-borradas
                       ELSE                                                  |                         else
      *                    error en la eliminacion                                    *                    error en la eliminacion
                           DISPLAY "Error al eliminar un registro de "       |                             display "Error al eliminar un registro de "
                           "BDIIALE vaciando los datos"                                                    "BDIIALE vaciando los datos"
                           DISPLAY "Clave: " LLAVE-BDIIALE                   |                             display "Clave: " LLAVE-BDIIALE
                           DISPLAY "Reg borrados: " N-ALE-BORRADAS           |                             display "Reg borrados: " N-ale-borradas
                           PERFORM 9000-CANCELAR-PROGRAMA                    |                             perform 9000-CANCELAR-PROGRAMA
                       END-IF                                                |                         end-if
                   END-IF                                                    |                     end-if
               WHEN "10"                                                     |                 when "10"
      *            fin de archivo: sale normalmente                                   *            fin de archivo: sale normalmente
                   CONTINUE                                                  |                     continue
               WHEN OTHER                                                    |                 when other
      *            lectura anormal: cancelacion del programa                          *            lectura anormal: cancelacion del programa
                   DISPLAY "Error en lectura del archivo de alertas "        |                     display "Error en lectura del archivo de alertas "
                   "online"                                                                        "online"
                   DISPLAY "File status: " EST-BDIIALE                       |                     display "File status: " EST-BDIIALE
                   PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA              |                     perform 9000-CANCELAR-PROGRAMA *> no retorna
               END-EVALUATE                                                  |                 end-evaluate
           END-PERFORM.                                                      |             end-perform.
           DISPLAY "Termino la eliminacion total de JURAD"                   |             display "Termino la eliminacion total de JURAD"
           DISPLAY "Reg borrados: " N-ALE-BORRADAS.                          |             display "Reg borrados: " N-ale-borradas. 


       7000-RUTINA-FINAL.                                                              7000-RUTINA-FINAL.
      ******************************************************************              ******************************************************************
      * Registra hora de finalizacion                                                 * Registra hora de finalizacion
           ACCEPT W-HORA-FIN FROM TIME                                       |             accept W-hora-fin from time

      * LEER JURAD A VER SI HAY REGISTROS DESPUES DEL "T"                    |        * Leer JURAD a ver si hay registros despues del "T"

      * Close todos los archivos                                                      * Close todos los archivos
           CLOSE JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.               |             close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

      * Emision de contadores de registros                                            * Emision de contadores de registros
           DISPLAY " "                                                       |             display " "
           DISPLAY "Totales de registros:"                                   |             display "Totales de registros:"
           MOVE N-REG-LEIDOS TO N-EDIT                                       |             move N-reg-leidos to N-edit 
           DISPLAY N-EDIT "Registros IME en el archivo de entrada"           |             display N-edit "Registros IME en el archivo de entrada"
           MOVE N-REG-OK TO N-EDIT                                           |             move N-reg-OK to N-edit 
           DISPLAY N-EDIT "Registros procesados sin error"                   |             display N-edit "Registros procesados sin error"

      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la                * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
      * definicion de estos contadores                                                * definicion de estos contadores
      *    move N-reg-tipo-I-OK to N-edit                                             *    move N-reg-tipo-I-OK to N-edit
      *    DISPLAY N-EDIT "Registros tipo I aceptados"                       |        *    display N-edit "Registros tipo I aceptados"
      *    move N-reg-tipo-M-OK to N-edit                                             *    move N-reg-tipo-M-OK to N-edit
      *    DISPLAY N-EDIT "Registros tipo M aceptados"                       |        *    display N-edit "Registros tipo M aceptados"
      *    move N-reg-tipo-E-OK to N-edit                                             *    move N-reg-tipo-E-OK to N-edit
      *    DISPLAY N-EDIT "Registros tipo E aceptados"                       |        *    display N-edit "Registros tipo E aceptados"

           MOVE E-CONT-REGS-CON-ERROR TO N-REG-CON-ERROR                     |             move E-cont-regs-con-error to N-reg-con-error
           MOVE N-REG-CON-ERROR TO N-EDIT                                    |             move N-reg-con-error to N-edit 
           DISPLAY N-EDIT "Registros con error"                              |             display N-edit "Registros con error"
           MOVE N-ALE-BORRADAS TO N-EDIT                                     |             move N-ale-borradas to N-edit 
           DISPLAY N-EDIT "Alertas borradas previo al refresque total"       |             display N-edit "Alertas borradas previo al refresque total"
           MOVE N-ALE-INSERTADAS TO N-EDIT                                   |             move N-ale-insertadas to N-edit 
           DISPLAY N-EDIT "Alertas insertadas"                               |             display N-edit "Alertas insertadas"
           MOVE N-ALE-MODIFICADAS TO N-EDIT                                  |             move N-ale-modificadas to N-edit 
           DISPLAY N-EDIT "Alertas modificadas"                              |             display N-edit "Alertas modificadas"
           MOVE N-ALE-ELIMINADAS TO N-EDIT                                   |             move N-ale-eliminadas to N-edit 
           DISPLAY N-EDIT "Alertas eliminadas"                               |             display N-edit "Alertas eliminadas"
           MOVE N-ALE-YA-EXISTE TO N-EDIT                                    |             move N-ale-ya-existe to N-edit 
           DISPLAY N-EDIT "Insercion de alerta existente"                    |             display N-edit "Insercion de alerta existente"
           MOVE N-ALE-NO-EXISTE TO N-EDIT                                    |             move N-ale-no-existe to N-edit 
           DISPLAY N-EDIT "Modif o elim de alerta inexistente".              |             display N-edit "Modif o elim de alerta inexistente".

      * Emision del reporte de errores                                                * Emision del reporte de errores
           DISPLAY " "                                                       |             display " "
           DISPLAY "Totales por tipo de error detectado:"                    |             display "Totales por tipo de error detectado:"
           PERFORM VARYING EX FROM 1 BY 1 UNTIL EX > 50                      |             perform varying Ex from 1 by 1 until Ex > 50
           OR E-CODIGO(EX) = "00"                                            |             or E-codigo(Ex) = "00"
               IF E-CONTADOR(EX) NOT = 0                                     |                 if E-contador(Ex) not = 0 
                   MOVE E-CONTADOR(EX) TO E-EDIT                             |                     move E-contador(ex) to E-edit
                   DISPLAY E-EDIT E-CODIGO(EX) "-" E-DESCRIPCION(EX)         |                     display E-edit E-codigo(Ex) "-" E-descripcion(Ex)
               END-IF                                                        |                 end-if
           END-PERFORM.                                                      |             end-perform.


       9000-CANCELAR-PROGRAMA.                                                         9000-CANCELAR-PROGRAMA.
      ******************************************************************              ******************************************************************
      * Procedimiento standard de cancelacion de programa batch                       * Procedimiento standard de cancelacion de programa batch
      ******************************************************************              ******************************************************************
      * TODO: hay un standard para comunicar una cancelacion de proceso?              * TODO: hay un standard para comunicar una cancelacion de proceso?
           DISPLAY " "                                                       |             display " "
           DISPLAY PGM " - proceso cancelado"                                |             display pgm " - proceso cancelado"
           GOBACK RETURNING 99.                                              |             goback returning 99.


           COPY BDIIVIDE.PROC.                                               |             copy BDIIVIDE.PROC.


           COPY VALNOM.PROC.                                                 |             copy VALNOM.PROC.


      /                                                                               /
       IDENTIFICATION DIVISION.                                                        IDENTIFICATION DIVISION.
       PROGRAM-ID. PONERR.                                                             PROGRAM-ID. PONERR.
      ******************************************************************              ******************************************************************
      * Rutina de conveniencia para procesar un error detectado en un                 * Rutina de conveniencia para procesar un error detectado en un
      * registro de input                                                             * registro de input
      * Contabiliza el error en la tabla de errores, activa el indicador              * Contabiliza el error en la tabla de errores, activa el indicador
      * de registro con error, muestra el mensaje en la pantalla, cuenta              * de registro con error, muestra el mensaje en la pantalla, cuenta
      * el registro erroneo                                                           * el registro erroneo
      ******************************************************************              ******************************************************************
       ENVIRONMENT DIVISION.                                                           ENVIRONMENT DIVISION.
       DATA DIVISION.                                                                  DATA DIVISION.
       WORKING-STORAGE SECTION.                                                        WORKING-STORAGE SECTION.
      ******************************************************************              ******************************************************************
      * Registro de input (primeros 86 caracteres)                                    * Registro de input (primeros 86 caracteres)
       01  REG-INPUT-ANTERIOR           PIC X(86) VALUE LOW-VALUES.          |         01  reg-input-anterior           pic x(86) value low-values.
      * Posicion del proximo error en la lista de errores del reg                     * Posicion del proximo error en la lista de errores del reg
       01  ERRINDEX                     PIC 999 COMP.                        |         01  errIndex                     pic 999 comp.
      ******************************************************************              ******************************************************************

       LINKAGE SECTION.                                                                LINKAGE SECTION.
      ******************************************************************              ******************************************************************
      * Codigo del error detectado                                                    * Codigo del error detectado
       01  COD-ERROR                    PIC XX.                              |         01  cod-error                    pic xx.
      ******************************************************************              ******************************************************************
      * Registro de input (primeros 86 caracteres)                                    * Registro de input (primeros 86 caracteres)
       01  REG-INPUT                    PIC X(86).                           |         01  reg-input                    pic x(86).
      ******************************************************************              ******************************************************************
      * Tabla de errores de consistencia del input                                    * Tabla de errores de consistencia del input
       01 E-ERRORES.                                                         |         01 E-errores.
      *    indica si el registro actual tiene error                                   *    indica si el registro actual tiene error
           03 E-HAY-ERROR               PIC XX.                              |             03 E-hay-error               pic xx.
      *    errores del registro actual                                                *    errores del registro actual
           03 E-ERRORES-REG             PIC X(100).                          |             03 E-errores-reg             pic x(100).
      *    contador de registros con error                                            *    contador de registros con error
           03 E-CONT-REGS-CON-ERROR     PIC 9(8).                            |             03 E-cont-regs-con-error     pic 9(8).
      *    tabla de errores                                                           *    tabla de errores
           03 E-ERROR                   OCCURS 50 INDEXED EX.                |             03 E-error                   occurs 50 indexed Ex.
               05 E-CODIGO              PIC XX.                              |                 05 E-codigo              pic xx.
               05                       PIC X.                               |                 05                       pic x.
               05 E-CONTADOR            PIC 9(7).                            |                 05 E-contador            pic 9(7).
               05                       PIC X.                               |                 05                       pic x.
               05 E-DESCRIPCION         PIC X(59).                           |                 05 E-descripcion         pic x(59).

      ******************************************************************              ******************************************************************

       PROCEDURE DIVISION USING COD-ERROR REG-INPUT E-ERRORES.               |         PROCEDURE DIVISION using cod-error reg-input E-errores.
       00.                                                                             00.
      *    marca al reg actual como erroneo                                           *    marca al reg actual como erroneo
           MOVE "SI" TO E-HAY-ERROR                                          |             move "SI" to E-hay-error

      *    cuenta y muestra el registro de input                                      *    cuenta y muestra el registro de input
           IF REG-INPUT(1:86) NOT = REG-INPUT-ANTERIOR                       |             if reg-input(1:86) not = reg-input-anterior
               ADD 1 TO E-CONT-REGS-CON-ERROR                                |                 add 1 to E-cont-regs-con-error
               DISPLAY " "                                                   |                 display " "
               DISPLAY REG-INPUT(1:86)                                       |                 display reg-input(1:86)
               MOVE REG-INPUT(1:86) TO REG-INPUT-ANTERIOR                    |                 move reg-input(1:86) to reg-input-anterior
               MOVE SPACES TO E-ERRORES-REG                                  |                 move spaces to E-errores-reg
               MOVE 2 TO ERRINDEX                                            |             end-if
           END-IF                                                            <  

      *    contabiliza el error en la tabla de errores                                *    contabiliza el error en la tabla de errores
           SET EX TO 1                                                       |             set Ex to 1
           SEARCH E-ERROR VARYING EX                                         |             search E-error varying Ex
           AT END                                                            |             at end
               DISPLAY "--- falla en la tabla de errores ---" COD-ERROR      |                 display "--- falla en la tabla de errores ---" cod-error
           WHEN E-CODIGO(EX) = "00"                                          |             when E-codigo(Ex) = "00"
               ADD 1 TO E-CONTADOR(EX)                                       |                 add 1 to E-contador(Ex)
               DISPLAY "--- error tipo exotico: " COD-ERROR                  |                 display "--- error tipo exotico: " cod-error
           WHEN E-CODIGO(EX) = COD-ERROR                                     |             when E-codigo(Ex) = cod-error
               ADD 1 TO E-CONTADOR(EX)                                       |                 add 1 to E-contador(Ex)
               DISPLAY "Error " COD-ERROR " " E-DESCRIPCION(EX)              |                 display "Error " cod-error " " E-descripcion(Ex)
           END-SEARCH                                                        |             end-search

      *    agrega a la lista de errores del registro                                  *    agrega a la lista de errores del registro
           IF ERRINDEX < 99                                                  |             if errIndex < 99
               MOVE COD-ERROR TO E-ERRORES-REG(ERRINDEX:2)                   |                 move cod-error to E-errores-reg(errIndex:2)
               ADD 3 TO ERRINDEX                                             |                 add 3 to errindex
           END-IF                                                            |             end-if

           EXIT PROGRAM.                                                     |             exit program.


       END PROGRAM PONERR.                                                   |         end program PONERR.

       END PROGRAM ACTALEJUR.                                                |         end program ACTALEJUR.

      ******************************************************************              ******************************************************************
      ******************************************************************              ******************************************************************

/d/iccol/desarrollo/fuentes>man sdiff
Reformatting page.  Please Wait... done

User Commands                                            sdiff(1)

NAME
     sdiff - print differences between two files side-by-side

SYNOPSIS
     sdiff [-l] [-s] [-o output] [-w n] filename1 filename2

DESCRIPTION
     sdiff uses the output of  the  diff  command  to  produce  a
     side-by-side  listing of two files indicating lines that are
     different. Lines of the two files are printed with  a  blank
     gutter  between  them if the lines are identical, a < in the
     gutter if the line appears only in filename1,  a  >  in  the
     gutter  if  the  line appears only in filename2, and a | for
     lines that are different. (See the EXAMPLES section below.)

OPTIONS
     -l              Print only the left side of any  lines  that
                     are identical.to

     -s              Do not print identical lines.

     -o output       Use the argument output as  the  name  of  a
                     third  file  that  is  created  as  a  user-
                     controlled merge of filename1 and filename2.
                     Identical  lines  of filename1 and filename2
                     are copied to output. Sets  of  differences,
                     as  produced  by  diff, are printed; where a
                     set of differences  share  a  common  gutter
                     character.   After   printing  each  set  of
                     differences, sdiff prompts the user with a %
                     and  waits  for  one  of the following user-
                     typed commands:

                     l        Append the left column to the  out-
                              put file.

                     r        Append the right column to the out-
                              put file.

                     s        Turn on silent mode; do  not  print
                              identical lines.

SunOS 5.10          Last change: 20 Dec 1996                    1

User Commands                                            sdiff(1)

                     v        Turn off silent mode.

                     e l      Call  the  editor  with  the   left
                              column.

                     e r      Call  the  editor  with  the  right
--More--(48%)                              column.

                     e b      Call the editor with the concatena-
                              tion of left and right.

                     e        Call the editor with a zero  length
                              file.

                     q        Exit from the program.

                     On exit from the editor, the resulting  file
                     is  concatenated  to  the  end of the output
                     file.

     -w n            Use the argument n as the width of the  out-
                     put  line.  The  default  line length is 130
                     characters.

USAGE
     See largefile(5) for the  description  of  the  behavior  of
     sdiff  when  encountering  files  greater than or equal to 2
     Gbyte ( 2**31 bytes).

EXAMPLES
     Example 1: An example of the sdiff command.

     A sample output of sdiff follows.

     x   |   y
     a       a
     b   <
     c   <

SunOS 5.10          Last change: 20 Dec 1996                    2

User Commands                                            sdiff(1)

     d       d
         >   c

ENVIRONMENT VARIABLES
     If any  of  the  LC_*  variables  (  LC_CTYPE,  LC_MESSAGES,
     LC_TIME, LC_COLLATE, LC_NUMERIC,
      and LC_MONETARY ) (see  environ(5))  are  not  set  in  the
     environment,  the  operational  behavior  of  sdiff for each
     corresponding locale category is determined by the value  of
     the  LANG  environment variable.  If LC_ALL is set, its con-
     tents are used to override both the LANG and the other  LC_*
     variables.   If  none  of  the above variables is set in the
     environment, the "C" locale determines how sdiff behaves.

     LC_CTYPE        Determines  how  sdiff  handles  characters.
                     When LC_CTYPE is set to a valid value, sdiff
                     can display and handle  text  and  filenames
                     containing valid characters for that locale.
--More--(88%)
ATTRIBUTES
     See attributes(5) for descriptions of the  following  attri-
     butes:

     ____________________________________________________________
    |       ATTRIBUTE TYPE        |       ATTRIBUTE VALUE       |
    | Availability                | SUNWesu                     |
    | CSI                         | Enabled                     |
    |_____________________________|_____________________________|

SEE ALSO
     diff(1), ed(1), attributes(5), environ(5), largefile(5)

SunOS 5.10          Last change: 20 Dec 1996                    3

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>man sdiffsdiff -w 156 CARGAJUR.CBL CARGAJUR-GB.CBL/d/iccol/desarrollo/fuentes>sdiff -w 156 CARGAJUR.CBL CARGAJUR-GB.CBL > CARGA/d/iccol/desarrollo/fuentes> CARGAJUR-GB.CBL > CARGAJ                        <UR.CBL.diff
/d/iccol/desarrollo/fuentes>vi CARJ GAJUR.CBL.diff
"CARGAJUR.CBL.diff" 1235 lines, 140985 characters $SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.PROGRAM-ID.    ACTALEJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.GLOBANT JL.|AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION SECTION.|CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS.|SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. MICROFOCUS.|OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT SECTION.|INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
SELECT JURAD ASSIGN TO P-FILE-PATH|select JURAD assign to P-file-nameORGANIZATION IS LINE SEQUENTIAL|organization is line sequentialFILE STATUS IS JURAD-FS.|file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
SELECT ERRS ASSIGN TO ERRS-FILE-NAME|select ERRS assign to ERRS-file-nameORGANIZATION IS LINE SEQUENTIAL|organization is line sequentialFILE STATUS IS ERRS-FS.|file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIREGI.FS.|copy BDIIREGI.FS.
>* TODO: debe compilar con file status************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDIAN.FS.|copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDAS.FS.|copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD|copy BDIIALE.FS replacing == on record.== by == on recordFILE STATUS IS EST-BDIIALE.==.|file status is EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE SECTION.|FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD"CARGAJUR.CBL.diff" 1235 lines, 140985 characters
 

:%s/.*/\L&1235 substitutions set ex to 1|set ex to 1search e-error varying ex|search e-error varying exat end|at enddisplay "--- falla en la tabla de errores ---" cod-error|display "--- falla en la tabla de errores ---" cod-errorwhen e-codigo(ex) = "00"|when e-codigo(ex) = "00"add 1 to e-contador(ex)|add 1 to e-contador(ex)display "--- error tipo exotico: " cod-error|display "--- error tipo exotico: " cod-errorwhen e-codigo(ex) = cod-error|when e-codigo(ex) = cod-erroradd 1 to e-contador(ex)|add 1 to e-contador(ex)display "error " cod-error " " e-descripcion(ex)|display "error " cod-error " " e-descripcion(ex)end-search|end-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errindex < 99|if errindex < 99move cod-error to e-errores-reg(errindex:2)|move cod-error to e-errores-reg(errindex:2)add 3 to errindex|add 3 to errindexend-if|end-ifexit program.|exit program.end program ponerr.|end program ponerr.end program actalejur.|end program actalejur.************************************************************************************************************************************
************************************************************************************************************************************

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~$set list setting$set list settingidentification division.identification division.
program-id.    actalejur.program-id.    actalejur.
************************************************************************************************************************************
* actualizacion del archivo de alertas con los datos provistos* actualizacion del archivo de alertas con los datos provistos
* por jurad* por jurad
* procesa el archivo jurad. controla cada registro: si es ok usa* procesa el archivo jurad. controla cada registro: si es ok usa
* los datos para actualizar bdiiale, si tiene defecto lo graba en* los datos para actualizar bdiiale, si tiene defecto lo graba en
* el archivo errs.* el archivo errs.
************************************************************************************************************************************
author.globant jl.|author.globant jl.
date-written.date-written.
date-compiled.date-compiled.
configuration section.|configuration section.
source-computer. microfocus.|source-computer. microfocus.
object-computer. microfocus.|object-computer. microfocus.
input-output section.|input-output section.
file-control.file-control.************************************************************************************************************************************
************************************************************************************************************************************
select jurad assign to p-file-path|select jurad assign to p-file-nameorganization is line sequential|organization is line sequentialfile status is jurad-fs.|file status is jurad-fs.************************************************************************************************************************************
************************************************************************************************************************************
select errs assign to errs-file-name|select errs assign to errs-file-nameorganization is line sequential|organization is line sequentialfile status is errs-fs.|file status is errs-fs.************************************************************************************************************************************
************************************************************************************************************************************copy bdiiregi.fs.|copy bdiiregi.fs.
>* todo: debe compilar con file status************************************************************************************************************************************
************************************************************************************************************************************copy bdiidian.fs.|copy bdiidian.fs.************************************************************************************************************************************
************************************************************************************************************************************copy bdiidas.fs.|copy bdiidas.fs.************************************************************************************************************************************
************************************************************************************************************************************copy bdiiale.fs replacing == on record.== by == on record|copy bdiiale.fs replacing == on record.== by == on recordfile status is est-bdiiale.==.|file status is est-bdiiale.==.************************************************************************************************************************************
************************************************************************************************************************************
data division.data division.
file section.|file section.************************************************************************************************************************************
* archivo de entrada con los datos de demandas y embargos de jurad* archivo de entrada con los datos de demandas y embargos de jurad$SET LIST SETTINGSET LIST SETTINGIDENTIFICATION DIVISIONIDENTIFICATION DIVISION
PROGRAM-ID.    ACTALEJURPROGRAM-ID.    ACTALEJURAAJJ
PJURAD. COKPJURAD. COKBDIIALEBDIIALEERRSERRSAUTHORGLOBANT JLAUTHORGJL
DATE-WRITTENDATE-WRITTEN
DATE-COMPILEDDATE-COMPILED
CONFIGURATION SECTIONCONFIGURATION
SOURCE-COMPUTER. MICROFOCUSSOURCE-COMPUTER
OBJECT-COMPUTER. MICROFOCUSOBJECT-COMPUTER
INPUT-OUTPUT SECTIONINPUT-OUTPUT
FILE-CONTROLFILE-CONTROLSELECT JURAD ASSIGN TO P-FILE-PATHJURADPORGANIZATION IS LINE SEQUENTIALFILE STATUS IS JURAD-FSJURADSELECT ERRS ASSIGN TO ERRS-FILE-NAMEERRSERRSORGANIZATION IS LINE SEQUENTIALFILE STATUS IS ERRS-FSERRSCOPY BDIIREGI.FSBDIIREGI.FS
TODOCOPY BDIIDIAN.FSBDIIDIAN.FSCOPY BDIIDAS.FSBDIIDAS.FSCOPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORDBDIIALE.FSFILE STATUS IS EST-BDIIALEEST-BDIIALEDATA DIVISIONDATA DIVISION
FILE SECTIONFILEAJURADAJURAD::%s/.*/\U&1235 substitutions SET EX TO 1|SET EX TO 1SEARCH E-ERROR VARYING EX|SEARCH E-ERROR VARYING EXAT END|AT ENDDISPLAY "--- FALLA EN LA TABLA DE ERRORES ---" COD-ERROR|DISPLAY "--- FALLA EN LA TABLA DE ERRORES ---" COD-ERRORWHEN E-CODIGO(EX) = "00"|WHEN E-CODIGO(EX) = "00"ADD 1 TO E-CONTADOR(EX)|ADD 1 TO E-CONTADOR(EX)DISPLAY "--- ERROR TIPO EXOTICO: " COD-ERROR|DISPLAY "--- ERROR TIPO EXOTICO: " COD-ERRORWHEN E-CODIGO(EX) = COD-ERROR|WHEN E-CODIGO(EX) = COD-ERRORADD 1 TO E-CONTADOR(EX)|ADD 1 TO E-CONTADOR(EX)DISPLAY "ERROR " COD-ERROR " " E-DESCRIPCION(EX)|DISPLAY "ERROR " COD-ERROR " " E-DESCRIPCION(EX)END-SEARCH|END-SEARCH*    AGREGA A LA LISTA DE ERRORES DEL REGISTRO*    AGREGA A LA LISTA DE ERRORES DEL REGISTROIF ERRINDEX < 99|IF ERRINDEX < 99MOVE COD-ERROR TO E-ERRORES-REG(ERRINDEX:2)|MOVE COD-ERROR TO E-ERRORES-REG(ERRINDEX:2)ADD 3 TO ERRINDEX|ADD 3 TO ERRINDEXEND-IF|END-IFEXIT PROGRAM.|EXIT PROGRAM.END PROGRAM PONERR.|END PROGRAM PONERR.END PROGRAM ACTALEJUR.|END PROGRAM ACTALEJUR.************************************************************************************************************************************
************************************************************************************************************************************

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~$SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.PROGRAM-ID.    ACTALEJUR.
************************************************************************************************************************************
* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS
* POR JURAD* POR JURAD
* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA
* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN
* EL ARCHIVO ERRS.* EL ARCHIVO ERRS.
************************************************************************************************************************************
AUTHOR.GLOBANT JL.|AUTHOR.GLOBANT JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION SECTION.|CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.|SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.|OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.|INPUT-OUTPUT SECTION.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
SELECT JURAD ASSIGN TO P-FILE-PATH|SELECT JURAD ASSIGN TO P-FILE-NAMEORGANIZATION IS LINE SEQUENTIAL|ORGANIZATION IS LINE SEQUENTIALFILE STATUS IS JURAD-FS.|FILE STATUS IS JURAD-FS.************************************************************************************************************************************
************************************************************************************************************************************
SELECT ERRS ASSIGN TO ERRS-FILE-NAME|SELECT ERRS ASSIGN TO ERRS-FILE-NAMEORGANIZATION IS LINE SEQUENTIAL|ORGANIZATION IS LINE SEQUENTIALFILE STATUS IS ERRS-FS.|FILE STATUS IS ERRS-FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIREGI.FS.|COPY BDIIREGI.FS.
>* TODO: DEBE COMPILAR CON FILE STATUS************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDIAN.FS.|COPY BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDAS.FS.|COPY BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD|COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORDFILE STATUS IS EST-BDIIALE.==.|FILE STATUS IS EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE SECTION.|FILE SECTION.************************************************************************************************************************************
* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD
 








 /^ /\(.*\)(.*\) *\| *\(.*\)(.*\)$Badly formed address////:g//d~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1112 fewer lines$SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.PROGRAM-ID.    ACTALEJUR.
************************************************************************************************************************************
* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS
* POR JURAD* POR JURAD
* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA
* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN
* EL ARCHIVO ERRS.* EL ARCHIVO ERRS.
************************************************************************************************************************************
AUTHOR.GLOBANT JL.|AUTHOR.GLOBANT JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION SECTION.|CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.|SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.|OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.|INPUT-OUTPUT SECTION.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
SELECT JURAD ASSIGN TO P-FILE-PATH|SELECT JURAD ASSIGN TO P-FILE-NAMEORGANIZATION IS LINE SEQUENTIAL|ORGANIZATION IS LINE SEQUENTIALFILE STATUS IS JURAD-FS.|FILE STATUS IS JURAD-FS.************************************************************************************************************************************
************************************************************************************************************************************
SELECT ERRS ASSIGN TO ERRS-FILE-NAME|SELECT ERRS ASSIGN TO ERRS-FILE-NAMEORGANIZATION IS LINE SEQUENTIAL|ORGANIZATION IS LINE SEQUENTIALFILE STATUS IS ERRS-FS.|FILE STATUS IS ERRS-FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIREGI.FS.|COPY BDIIREGI.FS.
>* TODO: DEBE COMPILAR CON FILE STATUS************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDIAN.FS.|COPY BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDAS.FS.|COPY BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD|COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORDFILE STATUS IS EST-BDIIALE.==.|FILE STATUS IS EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE SECTION.|FILE SECTION.************************************************************************************************************************************
* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD
1112 more linesREPLACE 1 CHARw:g//d~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1112 fewer lines$SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.PROGRAM-ID.    ACTALEJUR.
************************************************************************************************************************************
* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS
* POR JURAD* POR JURAD
* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA
* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN
* EL ARCHIVO ERRS.* EL ARCHIVO ERRS.
************************************************************************************************************************************
AUTHOR.GLOBANT JL.|AUTHOR.GLOBANT JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
wONFIGURATION SECTION.|CONFIGURATION SECTION.
SOURCE-COMPUTER. MICROFOCUS.|SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. MICROFOCUS.|OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT SECTION.|INPUT-OUTPUT SECTION.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
SELECT JURAD ASSIGN TO P-FILE-PATH|SELECT JURAD ASSIGN TO P-FILE-NAMEORGANIZATION IS LINE SEQUENTIAL|ORGANIZATION IS LINE SEQUENTIALFILE STATUS IS JURAD-FS.|FILE STATUS IS JURAD-FS.************************************************************************************************************************************
************************************************************************************************************************************
SELECT ERRS ASSIGN TO ERRS-FILE-NAME|SELECT ERRS ASSIGN TO ERRS-FILE-NAMEORGANIZATION IS LINE SEQUENTIAL|ORGANIZATION IS LINE SEQUENTIALFILE STATUS IS ERRS-FS.|FILE STATUS IS ERRS-FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIREGI.FS.|COPY BDIIREGI.FS.
>* TODO: DEBE COMPILAR CON FILE STATUS************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDIAN.FS.|COPY BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIDAS.FS.|COPY BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORD|COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORDFILE STATUS IS EST-BDIIALE.==.|FILE STATUS IS EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE SECTION.|FILE SECTION.************************************************************************************************************************************
* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD
1112 more lines/w/\(.*\)/\(.*\) *\| *\(.*\)(.*\)$
????/^^ /\(.*\)(.*\) *\| *\(.*\)(.*\)$Address search hit BOTTOM without matching pattern
/^ /\(.*\)(.*\) *\| *\(.*\)(.*\)$Badly formed address






APPEND MODE^ /\(.*\) *\| *\(.*\)$
APPEND MODE^ REPLACE 1 CHAR*/^ *\(.*\)(.*\) *\| *\(.*\)(.*\)$///???/
************************************************************************************************************************************
* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-REG.|01  JURAD-REG.
* REGISTROS DE MOVIMIENTOS I, M, E* REGISTROS DE MOVIMIENTOS I, M, E
*    TIPO DE NOVEDAD {I, M, E} INSER/MODIF/ELIM*    TIPO DE NOVEDAD {I, M, E} INSER/MODIF/ELIM03 JURAD-TIPO-NOVEDADPIC X.|03 JURAD-TIPO-NOVEDADPIC X.
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}03 JURAD-ID-TIPOPIC X.|03 JURAD-ID-TIPOPIC X.
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACION03 JURAD-ID-NUMEROXPIC X(11).|03 JURAD-ID-NUMEROXPIC X(11).03 JURAD-ID-NUMEROREDEFINES JURAD-ID-NUMEROX|03 JURAD-ID-NUMEROREDEFINES JURAD-ID-NUMEROXPIC 9(11).|PIC 9(11).
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOS03 JURAD-NOMBREPIC X(45).|03 JURAD-NOMBREPIC X(45).
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTES03 JURAD-DEMANDAS-VIGENTES   PIC 999.|03 JURAD-DEMANDAS-VIGENTES   PIC 999.
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADAS03 JURAD-DEMANDAS-TERMINADAS PIC 999.|03 JURAD-DEMANDAS-TERMINADAS PIC 999.
*    FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD03 JURAD-DEMANDAS-FECHA-ULTIMA PIC X(8).|03 JURAD-DEMANDAS-FECHA-ULTIMA PIC X(8).
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTES03 JURAD-EMBARGOS-VIGENTES   PIC 999.|03 JURAD-EMBARGOS-VIGENTES   PIC 999.
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOS03 JURAD-EMBARGOS-TERMINADOS PIC 999.|03 JURAD-EMBARGOS-TERMINADOS PIC 999.
*    FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD03 JURAD-EMBARGOS-FECHA-ULTIMO PIC X(8).|03 JURAD-EMBARGOS-FECHA-ULTIMO PIC X(8).01  JURADT-REG.|01  JURADT-REG.
* REGISTRO DE TOTALES DE CONTROL T* REGISTRO DE TOTALES DE CONTROL T
*    TIPO DE NOVEDAD = "T"|*    TIPO DE NOVEDAD = "T"03 JURADT-TIPO-NOVEDADPIC X.|03 JURADT-TIPO-NOVEDADPIC X.03PIC X.|03PIC X.
*    CANTIDAD DE REGISTROS*    CANTIDAD DE REGISTROS03 JURADT-REGISTROSPIC 9(11).|03 JURADT-REGISTROSPIC 9(11).03PIC X.|03PIC X.
*    TOTAL NUMERO DE DEMANDAS VIGENTES*    TOTAL NUMERO DE DEMANDAS VIGENTES03 JURADT-DEMANDAS-VIGENTES  PIC 9(7).|03 JURADT-DEMANDAS-VIGENTES  PIC 9(7).03PIC X.|03PIC X.
*    TOTAL NUMERO DE DEMANDAS TERMINADAS*    TOTAL NUMERO DE DEMANDAS TERMINADAS03 JURADT-DEMANDAS-TERMINADAS PIC 9(7).|03 JURADT-DEMANDAS-TERMINADAS PIC 9(7).03PIC X.|03PIC X.
*    TOTAL NUMERO DE EMBARGOS VIGENTES*    TOTAL NUMERO DE EMBARGOS VIGENTES03 JURADT-EMBARGOS-VIGENTES  PIC 9(7).|03 JURADT-EMBARGOS-VIGENTES  PIC 9(7).03PIC X.|03PIC X.
*    TOTAL NUMERO DE EMBARGOS TERMINADOS*    TOTAL NUMERO DE EMBARGOS TERMINADOS03 JURADT-EMBARGOS-TERMINADOS PIC 9(7).|03 JURADT-EMBARGOS-TERMINADOS PIC 9(7).03PIC X(41).|03PIC X(41).************************************************************************************************************************************
* ARCHIVO DE SALIDA CON LOS REGISTROS DEFECTUOSOS DEL ARCH JURAD* ARCHIVO DE SALIDA CON LOS REGISTROS DEFECTUOSOS DEL ARCH JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-REG.|01  ERRS-REG.FD ERRS.FD ERRS.01  ERRS-REG.|01  ERRS-REG.
*    TIPO DE NOVEDAD {I, M, E, T} INSER/MODIF/ELIM/TOTALES*    TIPO DE NOVEDAD {I, M, E, T} INSER/MODIF/ELIM/TOTALES03 ERRS-TIPO-NOVEDADPIC X.|03 ERRS-TIPO-NOVEDADPIC X.
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}03 ERRS-ID-TIPOPIC X.|03 ERRS-ID-TIPOPIC X.
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACION03 ERRS-ID-NUMEROPIC X(11).|03 ERRS-ID-NUMEROPIC X(11).
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOS03 ERRS-NOMBREPIC X(45).|03 ERRS-NOMBREPIC X(45).
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTES03 ERRS-DEMANDAS-VIGENTES    PIC 999.|03 ERRS-DEMANDAS-VIGENTES    PIC 999.
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADAS03 ERRS-DEMANDAS-TERMINADAS  PIC 999.|03 ERRS-DEMANDAS-TERMINADAS  PIC 999.
*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD03 ERRS-DEMANDAS-FECHA-ULTIMA PIC X(8).|03 ERRS-DEMANDAS-FECHA-ULTIMA PIC X(6).
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTES03 ERRS-EMBARGOS-VIGENTES    PIC 999.|03 ERRS-EMBARGOS-VIGENTES    PIC 999.
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOS03 ERRS-EMBARGOS-TERMINADOS  PIC 999.|03 ERRS-EMBARGOS-TERMINADOS  PIC 999.
*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD03 ERRS-EMBARGOS-FECHA-ULTIMO PIC X(8).|03 ERRS-EMBARGOS-FECHA-ULTIMO PIC X(6).
*    CAUSA DEL RECHAZO*    CAUSA DEL RECHAZO03 ERRS-CAUSA-RECHAZOPIC X(100).|03 ERRS-CAUSA-RECHAZOPIC X(100).************************************************************************************************************************************
* CONTIENE LOS IDS Y NOMBRES DE PERSONAS* CONTIENE LOS IDS Y NOMBRES DE PERSONAS
************************************************************************************************************************************
COPY BDIIREGI.FD.|COPY BDIIREGI.FD.************************************************************************************************************************************
* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADA* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADA
* POR LA DIAN* POR LA DIAN
************************************************************************************************************************************
COPY BDIIDIAN.FD.|COPY BDIIDIAN.FD.************************************************************************************************************************************
* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA SUMINISTRADO POR DAS* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA SUMINISTRADO POR DAS
************************************************************************************************************************************
COPY BDIIDAS.FD.|COPY BDIIDAS.FD.************************************************************************************************************************************
* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTORES* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTORES
************************************************************************************************************************************
COPY BDIIALE.FD.|COPY BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE SECTION.|WORKING-STORAGE SECTION.
************************************************************************************************************************************
* NOMBRE DEL PROGRAMA* NOMBRE DEL PROGRAMA
01  PGMPIC X(10) VALUE "CARGAJUR".|01  PGMPIC X(10) VALUE "CARGAJUR".************************************************************************************************************************************
* VARIABLES PARA RUTINA DE VALIDACION DE IDENTIFICACIONES* VARIABLES PARA RUTINA DE VALIDACION DE IDENTIFICACIONES
************************************************************************************************************************************
COPY BDIIVIDE.WS.|COPY BDIIVIDE.WS.************************************************************************************************************************************COPY BDIIVIDE.WS.|COPY BDIIVIDE.WS.************************************************************************************************************************************
* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA
************************************************************************************************************************************
COPY BDIIALE.WS.|COPY BDIIALE.WS.************************************************************************************************************************************
* DATOS PARA LAS RUTINAS DE VALIDACION DE NOMBRES DE VALNOM.PROC* DATOS PARA LAS RUTINAS DE VALIDACION DE NOMBRES DE VALNOM.PROC
************************************************************************************************************************************
COPY VALNOM.WS.|COPY VALNOM.WS.**********************************************************************************************************************************
* DIRECCIONES DE LOS ARCHIVOS EN EL FILE SYSTEM* DIRECCIONES DE LOS ARCHIVOS EN EL FILE SYSTEM
**********************************************************************************************************************************
COPY ICFILE.WS.|COPY ICFILE.WS.************************************************************************************************************************************
* INDICA QUE SE TERMINO EL PROCESO, POR AGOTAMIENTO DEL ARCHIVO* INDICA QUE SE TERMINO EL PROCESO, POR AGOTAMIENTO DEL ARCHIVO
* DE ENTRADA (NORMAL) O ALGUNA OTRA CONDICION (ERROR)* DE ENTRADA (NORMAL) O ALGUNA OTRA CONDICION (ERROR)
01  IND-FIN-PROCESOPIC XX VALUE "NO".|01  IND-FIN-PROCESOPIC XX VALUE "NO".* COPIA DEL ULTIMO REG DE INPUT, PARA MENSAJES (ULT REG: ...)* COPIA DEL ULTIMO REG DE INPUT, PARA MENSAJES (ULT REG: ...)
01  JURAD-REG-ANTERIORPIC X(100) VALUE "(VACIO)".|01  JURAD-REG-ANTERIORPIC X(100) VALUE "(VACIO)".
01  JURAD-FSPIC XX VALUE SPACES.|01  JURAD-FSPIC XX VALUE SPACES.01  ERRS-FSPIC XX VALUE SPACES.|01  ERRS-FSPIC XX VALUE SPACES.* DATOS DE DEMANDAS O EMBARGOS QUE VAN EN EL REGISTRO BDIIALE* DATOS DE DEMANDAS O EMBARGOS QUE VAN EN EL REGISTRO BDIIALE
01 D-DATAHOST.|01 D-DATAHOST.05 D-VIGENTESPIC 9(5).|05 D-VIGENTESPIC 9(5).05 D-TERMINADOSPIC 9(5).|05 D-TERMINADOSPIC 9(5).05 D-FECHA-ULTIMAPIC X(8).|05 D-FECHA-ULTIMAPIC X(8).
************************************************************************************************************************************
* PARAMETROS INICIALES, DE LA LINEA DE COMANDO* PARAMETROS INICIALES, DE LA LINEA DE COMANDO
* LA LINEA DE COMANDO QUE CONTIENE LOS PARAMETROS* LA LINEA DE COMANDO QUE CONTIENE LOS PARAMETROS
01 P-COMMAND-LINEPIC X(80) VALUE SPACES.|01 P-COMMAND-LINEPIC X(80) VALUE SPACES.
01 P-PARAMETROS.|01 P-PARAMETROS.
*    PROCESO REAL: CONTIENE "S" PARA ACTIVAR|*    PROCESO REAL: CONTIENE "SI" PARA ACTIVAR
* TODO: FIJO EN "N" PARA PRUEBAS|* TODO: FIJO EN "NO" PARA PRUEBAS03 P-PROCESO-REALPIC X VALUE "N".|03 P-PROCESO-REALPIC XX VALUE "NO".88 PROCESO-REALVALUE "S".|88 PROCESO-REALVALUE "SI".*    NOMBRE DEL ARCHIVO DE ENTRADA JJJJJJAAADDMMAABBXX.TXT*    NOMBRE DEL ARCHIVO DE ENTRADA JJJJJJAAADDMMAABBXX.TXT03 P-FILE-NAMEPIC X(80) VALUE SPACES.|03 P-FILE-NAMEPIC X(80) VALUE SPACES.03 P-FILE-NAME-RREDEFINES P-FILE-NAME.|03 P-FILE-NAME-RREDEFINES P-FILE-NAME.
*JJJJJJ = CODIGO DE SUSCRIPTOR JURAD EN EXPERIAN*JJJJJJ = CODIGO DE SUSCRIPTOR JURAD EN EXPERIAN05 P-COD-SUSCRIPTORPIC 9(6).|05 P-COD-SUSCRIPTORPIC 9(6).
*AAA = CODIFICACION DEL PRODUCTO ("100")|*AAA = CODIFICACION DEL PRODUCTO ("100")05 P-PRODUCTOPIC XXX.|05 P-PRODUCTOPIC XXX.
*DDMMAA = FECHA DE PROCESO*DDMMAA = FECHA DE PROCESO05 P-FECHA-PROCESOPIC X(6).|05 P-FECHA-PROCESOPIC X(6).
*BB =  01 A CI*BB =  01 A CI05 P-CI-BIPIC XX.|05 P-CI-BIPIC XX.
*XX = TIPO DE PROCESO*XX = TIPO DE PROCESO05 P-CI-BIPIC XX.|05 P-CI-BIPIC XX.*XX = TIPO DE PROCESO*XX = TIPO DE PROCESO
*01 ENVIO ORIGINAL - CARGA TOTAL - PRIMERA VEZ*01 ENVIO ORIGINAL - CARGA TOTAL - PRIMERA VEZ
*02 ARCHIVO SEMANAL - CARGA PARCIAL*02 ARCHIVO SEMANAL - CARGA PARCIAL
*03 ARCHIVO MENSUAL - CARGA PARCIAL*03 ARCHIVO MENSUAL - CARGA PARCIAL
*04 REFRESQUE TOTAL - CARGA TOTAL*04 REFRESQUE TOTAL - CARGA TOTAL05 P-TIPO-PROCESOPIC XX.|05 P-TIPO-PROCESOPIC XX.
*EXTENSION DEL ARCHIVO ".TXT"|*EXTENSION DEL ARCHIVO ".TXT"05 P-EXTENSIONPIC X(4).|05 P-EXTENSIONPIC X(4).05PIC X(57).|05PIC X(57).03 P-FILE-PATHPIC X(80) VALUE SPACES.<
* NOMBRE DEL ARCHIVO DE ERRORES JJJJJJAAADDMMAABBXX_ERRORES.TXT* NOMBRE DEL ARCHIVO DE ERRORES JJJJJJAAADDMMAABBXX_ERRORES.TXT03 ERRS-FILE-NAMEPIC X(80) VALUE SPACES.|03 ERRS-FILE-NAMEPIC X(80) VALUE SPACES.* FECHA DE PROCESO EDITADA YYYYMMDD* FECHA DE PROCESO EDITADA YYYYMMDD
01 P-FECHA-PROCESO-YYYYMMDDPIC X(8).|01 P-FECHA-PROCESO-YYYYMMDDPIC X(8).
* FECHA DE PROCESO + 50 AÃ±OS* FECHA DE PROCESO + 50 AÃ±OS
01 P-FECHA-PROCESO-50.|01 P-FECHA-PROCESO-50.03  P-FECHA-PROCESO-50YYYY   PIC 9999.|03  P-FECHA-PROCESO-50YYYY   PIC 9999.03PIC X(4).|03PIC X(4).
************************************************************************************************************************************
* DATOS PARA EL REPORTE FINAL* DATOS PARA EL REPORTE FINAL
01 W-TIEMPO.|01 W-TIEMPO.03 W-HORA-INICIOPIC 9(8).|03 W-HORA-INICIOPIC 9(8).03 W-HORA-FINPIC 9(8).|03 W-HORA-FINPIC 9(8).
01 N-EDITPIC Z(8)B.|01 N-EDITPIC Z(8)B.
01 N-CONTADORES.|01 N-CONTADORES.
*    REGISTROS EN EL ARCHIVO DE ENTRADA*    REGISTROS EN EL ARCHIVO DE ENTRADA03 N-REG-LEIDOSPIC 9(8) VALUE ZERO.|03 N-REG-LEIDOSPIC 9(8) VALUE ZERO.
*    REGISTROS PROCESADOS SIN ERROR*    REGISTROS PROCESADOS SIN ERROR03 N-REG-OKPIC 9(8) VALUE ZERO.|03 N-REG-OKPIC 9(8) VALUE ZERO.
*    REGISTROS CON ERROR*    REGISTROS CON ERROR03 N-REG-CON-ERRORPIC 9(8) VALUE ZERO.|03 N-REG-CON-ERRORPIC 9(8) VALUE ZERO.*    CANTIDADES DE REGISTROS POR TIPO DE NOVEDAD*    CANTIDADES DE REGISTROS POR TIPO DE NOVEDAD03 N-REG-TIPO-I-OKPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-I-OKPIC 9(8) VALUE ZERO.03 N-REG-TIPO-M-OKPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-M-OKPIC 9(8) VALUE ZERO.03 N-REG-TIPO-E-OKPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-E-OKPIC 9(8) VALUE ZERO.03 N-REG-TIPO-I-ERRPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-I-ERRPIC 9(8) VALUE ZERO.03 N-REG-TIPO-M-ERRPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-M-ERRPIC 9(8) VALUE ZERO.03 N-REG-TIPO-E-ERRPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-E-ERRPIC 9(8) VALUE ZERO.*    ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL*    ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL03 N-ALE-BORRADASPIC 9(8) VALUE ZERO.|03 N-ALE-BORRADASPIC 9(8) VALUE ZERO.
*    ALERTAS INSERTADAS*    ALERTAS INSERTADAS03 N-ALE-INSERTADASPIC 9(8) VALUE ZERO.|03 N-ALE-INSERTADASPIC 9(8) VALUE ZERO.
*    ALERTAS MODIFICADAS*    ALERTAS MODIFICADAS03 N-ALE-MODIFICADASPIC 9(8) VALUE ZERO.|03 N-ALE-MODIFICADASPIC 9(8) VALUE ZERO.
*    ALERTAS ELIMINADAS*    ALERTAS ELIMINADAS03 N-ALE-ELIMINADASPIC 9(8) VALUE ZERO.|03 N-ALE-ELIMINADASPIC 9(8) VALUE ZERO.
*    INSERCION DE ALERTA EXISTENTE*    INSERCION DE ALERTA EXISTENTE03 N-ALE-YA-EXISTEPIC 9(8) VALUE ZERO.|03 N-ALE-YA-EXISTEPIC 9(8) VALUE ZERO.
*    MODIFICACION O ELIMINACION DE ALERTA INEXISTENTE*    MODIFICACION O ELIMINACION DE ALERTA INEXISTENTE03 N-ALE-NO-EXISTEPIC 9(8) VALUE ZERO.|03 N-ALE-NO-EXISTEPIC 9(8) VALUE ZERO.************************************************************************************************************************************************************************************************************************************************************************COPY BDIIVIDE.WS.|COPY BDIIVIDE.WS.************************************************************************************************************************************
* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA
************************************************************************************************************************************
COPY BDIIALE.WS.|COPY BDIIALE.WS.************************************************************************************************************************************
* DATOS PARA LAS RUTINAS DE VALIDACION DE NOMBRES DE VALNOM.PROC* DATOS PARA LAS RUTINAS DE VALIDACION DE NOMBRES DE VALNOM.PROC
************************************************************************************************************************************
COPY VALNOM.WS.|COPY VALNOM.WS.**********************************************************************************************************************************
* DIRECCIONES DE LOS ARCHIVOS EN EL FILE SYSTEM* DIRECCIONES DE LOS ARCHIVOS EN EL FILE SYSTEM
**********************************************************************************************************************************
COPY ICFILE.WS.|COPY ICFILE.WS.************************************************************************************************************************************
* INDICA QUE SE TERMINO EL PROCESO, POR AGOTAMIENTO DEL ARCHIVO* INDICA QUE SE TERMINO EL PROCESO, POR AGOTAMIENTO DEL ARCHIVO
* DE ENTRADA (NORMAL) O ALGUNA OTRA CONDICION (ERROR)* DE ENTRADA (NORMAL) O ALGUNA OTRA CONDICION (ERROR)
01  IND-FIN-PROCESOPIC XX VALUE "NO".|01  IND-FIN-PROCESOPIC XX VALUE "NO".* COPIA DEL ULTIMO REG DE INPUT, PARA MENSAJES (ULT REG: ...)* COPIA DEL ULTIMO REG DE INPUT, PARA MENSAJES (ULT REG: ...)
01  JURAD-REG-ANTERIORPIC X(100) VALUE "(VACIO)".|01  JURAD-REG-ANTERIORPIC X(100) VALUE "(VACIO)".
01  JURAD-FSPIC XX VALUE SPACES.|01  JURAD-FSPIC XX VALUE SPACES.01  ERRS-FSPIC XX VALUE SPACES.|01  ERRS-FSPIC XX VALUE SPACES.* DATOS DE DEMANDAS O EMBARGOS QUE VAN EN EL REGISTRO BDIIALE* DATOS DE DEMANDAS O EMBARGOS QUE VAN EN EL REGISTRO BDIIALE
01 D-DATAHOST.|01 D-DATAHOST.05 D-VIGENTESPIC 9(5).|05 D-VIGENTESPIC 9(5).05 D-TERMINADOSPIC 9(5).|05 D-TERMINADOSPIC 9(5).05 D-FECHA-ULTIMAPIC X(8).|05 D-FECHA-ULTIMAPIC X(8).
************************************************************************************************************************************
* PARAMETROS INICIALES, DE LA LINEA DE COMANDO* PARAMETROS INICIALES, DE LA LINEA DE COMANDO
* LA LINEA DE COMANDO QUE CONTIENE LOS PARAMETROS* LA LINEA DE COMANDO QUE CONTIENE LOS PARAMETROS
01 P-COMMAND-LINEPIC X(80) VALUE SPACES.|01 P-COMMAND-LINEPIC X(80) VALUE SPACES.
01 P-PARAMETROS.|01 P-PARAMETROS.
*    PROCESO REAL: CONTIENE "S" PARA ACTIVAR|*    PROCESO REAL: CONTIENE "SI" PARA ACTIVAR
* TODO: FIJO EN "N" PARA PRUEBAS|* TODO: FIJO EN "NO" PARA PRUEBAS03 P-PROCESO-REALPIC X VALUE "N".|03 P-PROCESO-REALPIC XX VALUE "NO".88 PROCESO-REALVALUE "S".|88 PROCESO-REALVALUE "SI".*    NOMBRE DEL ARCHIVO DE ENTRADA JJJJJJAAADDMMAABBXX.TXT*    NOMBRE DEL ARCHIVO DE ENTRADA JJJJJJAAADDMMAABBXX.TXT03 P-FILE-NAMEPIC X(80) VALUE SPACES.|03 P-FILE-NAMEPIC X(80) VALUE SPACES.03 P-FILE-NAME-RREDEFINES P-FILE-NAME.|03 P-FILE-NAME-RREDEFINES P-FILE-NAME.
*JJJJJJ = CODIGO DE SUSCRIPTOR JURAD EN EXPERIAN*JJJJJJ = CODIGO DE SUSCRIPTOR JURAD EN EXPERIAN05 P-COD-SUSCRIPTORPIC 9(6).|05 P-COD-SUSCRIPTORPIC 9(6).
*AAA = CODIFICACION DEL PRODUCTO ("100")|*AAA = CODIFICACION DEL PRODUCTO ("100")05 P-PRODUCTOPIC XXX.|05 P-PRODUCTOPIC XXX.
*DDMMAA = FECHA DE PROCESO*DDMMAA = FECHA DE PROCESO05 P-FECHA-PROCESOPIC X(6).|05 P-FECHA-PROCESOPIC X(6).
*BB =  01 A CI*BB =  01 A CI05 P-CI-BIPIC XX.|05 P-CI-BIPIC XX.
*XX = TIPO DE PROCESO*XX = TIPO DE PROCESO05 P-CI-BIPIC XX.|05 P-CI-BIPIC XX.*XX = TIPO DE PROCESO*XX = TIPO DE PROCESO
*01 ENVIO ORIGINAL - CARGA TOTAL - PRIMERA VEZ*01 ENVIO ORIGINAL - CARGA TOTAL - PRIMERA VEZ
*02 ARCHIVO SEMANAL - CARGA PARCIAL*02 ARCHIVO SEMANAL - CARGA PARCIAL
*03 ARCHIVO MENSUAL - CARGA PARCIAL*03 ARCHIVO MENSUAL - CARGA PARCIAL
*04 REFRESQUE TOTAL - CARGA TOTAL*04 REFRESQUE TOTAL - CARGA TOTAL05 P-TIPO-PROCESOPIC XX.|05 P-TIPO-PROCESOPIC XX.
*EXTENSION DEL ARCHIVO ".TXT"|*EXTENSION DEL ARCHIVO ".TXT"05 P-EXTENSIONPIC X(4).|05 P-EXTENSIONPIC X(4).05PIC X(57).|05PIC X(57).03 P-FILE-PATHPIC X(80) VALUE SPACES.<
* NOMBRE DEL ARCHIVO DE ERRORES JJJJJJAAADDMMAABBXX_ERRORES.TXT* NOMBRE DEL ARCHIVO DE ERRORES JJJJJJAAADDMMAABBXX_ERRORES.TXT03 ERRS-FILE-NAMEPIC X(80) VALUE SPACES.|03 ERRS-FILE-NAMEPIC X(80) VALUE SPACES.* FECHA DE PROCESO EDITADA YYYYMMDD* FECHA DE PROCESO EDITADA YYYYMMDD
01 P-FECHA-PROCESO-YYYYMMDDPIC X(8).|01 P-FECHA-PROCESO-YYYYMMDDPIC X(8).
* FECHA DE PROCESO + 50 AÃ±OS* FECHA DE PROCESO + 50 AÃ±OS
01 P-FECHA-PROCESO-50.|01 P-FECHA-PROCESO-50.03  P-FECHA-PROCESO-50YYYY   PIC 9999.|03  P-FECHA-PROCESO-50YYYY   PIC 9999.03PIC X(4).|03PIC X(4).
************************************************************************************************************************************
* DATOS PARA EL REPORTE FINAL* DATOS PARA EL REPORTE FINAL
01 W-TIEMPO.|01 W-TIEMPO.03 W-HORA-INICIOPIC 9(8).|03 W-HORA-INICIOPIC 9(8).03 W-HORA-FINPIC 9(8).|03 W-HORA-FINPIC 9(8).
01 N-EDITPIC Z(8)B.|01 N-EDITPIC Z(8)B.
01 N-CONTADORES.|01 N-CONTADORES.
*    REGISTROS EN EL ARCHIVO DE ENTRADA*    REGISTROS EN EL ARCHIVO DE ENTRADA03 N-REG-LEIDOSPIC 9(8) VALUE ZERO.|03 N-REG-LEIDOSPIC 9(8) VALUE ZERO.
*    REGISTROS PROCESADOS SIN ERROR*    REGISTROS PROCESADOS SIN ERROR03 N-REG-OKPIC 9(8) VALUE ZERO.|03 N-REG-OKPIC 9(8) VALUE ZERO.
*    REGISTROS CON ERROR*    REGISTROS CON ERROR03 N-REG-CON-ERRORPIC 9(8) VALUE ZERO.|03 N-REG-CON-ERRORPIC 9(8) VALUE ZERO.*    CANTIDADES DE REGISTROS POR TIPO DE NOVEDAD*    CANTIDADES DE REGISTROS POR TIPO DE NOVEDAD03 N-REG-TIPO-I-OKPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-I-OKPIC 9(8) VALUE ZERO.03 N-REG-TIPO-M-OKPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-M-OKPIC 9(8) VALUE ZERO.03 N-REG-TIPO-E-OKPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-E-OKPIC 9(8) VALUE ZERO.03 N-REG-TIPO-I-ERRPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-I-ERRPIC 9(8) VALUE ZERO.03 N-REG-TIPO-M-ERRPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-M-ERRPIC 9(8) VALUE ZERO.03 N-REG-TIPO-E-ERRPIC 9(8) VALUE ZERO.|03 N-REG-TIPO-E-ERRPIC 9(8) VALUE ZERO.*    ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL*    ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL03 N-ALE-BORRADASPIC 9(8) VALUE ZERO.|03 N-ALE-BORRADASPIC 9(8) VALUE ZERO.
*    ALERTAS INSERTADAS*    ALERTAS INSERTADAS03 N-ALE-INSERTADASPIC 9(8) VALUE ZERO.|03 N-ALE-INSERTADASPIC 9(8) VALUE ZERO.
*    ALERTAS MODIFICADAS*    ALERTAS MODIFICADAS03 N-ALE-MODIFICADASPIC 9(8) VALUE ZERO.|03 N-ALE-MODIFICADASPIC 9(8) VALUE ZERO.
*    ALERTAS ELIMINADAS*    ALERTAS ELIMINADAS03 N-ALE-ELIMINADASPIC 9(8) VALUE ZERO.|03 N-ALE-ELIMINADASPIC 9(8) VALUE ZERO.
*    INSERCION DE ALERTA EXISTENTE*    INSERCION DE ALERTA EXISTENTE03 N-ALE-YA-EXISTEPIC 9(8) VALUE ZERO.|03 N-ALE-YA-EXISTEPIC 9(8) VALUE ZERO.
*    MODIFICACION O ELIMINACION DE ALERTA INEXISTENTE*    MODIFICACION O ELIMINACION DE ALERTA INEXISTENTE03 N-ALE-NO-EXISTEPIC 9(8) VALUE ZERO.|03 N-ALE-NO-EXISTEPIC 9(8) VALUE ZERO.************************************************************************************************************************************
************************************************************************************************************************************
* ARMADO DE LAS LINEAS DE ALERTA* ARMADO DE LAS LINEAS DE ALERTA
01 LA-LINEAS-ALERTA.|01 LA-LINEAS-ALERTA.
*    LOS MODELOS A CONTINUACION DEBERAN OBTENERSE DE UN*    LOS MODELOS A CONTINUACION DEBERAN OBTENERSE DE UN
*    ARCHIVO, COMO BDIIALE-ALERTAS*    ARCHIVO, COMO BDIIALE-ALERTAS03 LAENDPIC 999 COMP VALUE 0.|03 LAENDPIC 999 COMP VALUE 0.03 LA-MODELOS.|03 LA-MODELOS.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 PIC X(50) VALUE|05 PIC X(50) VALUE"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 PIC X(50) VALUE|05 PIC X(50) VALUE"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 PIC X(50) VALUE|05 PIC X(50) VALUE"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 PIC X(50) VALUE|05 PIC X(50) VALUE"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 PIC X(50) VALUE HIGH-VALUES. *> END MARKER|05 PIC X(50) VALUE HIGH-VALUES. *> END MARKER03 LA-MODELOS2REDEFINES LA-MODELOS.|03 LA-MODELOS2REDEFINES LA-MODELOS.05 LA-MODELOPIC X(50) OCCURS 5|05 LA-MODELOPIC X(50) OCCURS 5INDEXED LAM.|INDEXED LAM.
*    FUNCIONAMIENTO DE LOS TEMPLATES.*    FUNCIONAMIENTO DE LOS TEMPLATES.
*    HAY DOS TEMPLATES POR DE ALERTA, UNO POR LINEA.*    HAY DOS TEMPLATES POR DE ALERTA, UNO POR LINEA.
*    CADA TEMPLATE CONSISTE EN HASTA 10 FRASES FIJAS CON*    CADA TEMPLATE CONSISTE EN HASTA 10 FRASES FIJAS CON
*    AMPERSANDS (&) DONDE SE VAN A REEMPLAZAR LOS VALORES.*    AMPERSANDS (&) DONDE SE VAN A REEMPLAZAR LOS VALORES.
*    POR EJEMPLO:*    POR EJEMPLO:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    TIENE 3 FRASES FIJAS Y 2 REEMPLAZOS.*    TIENE 3 FRASES FIJAS Y 2 REEMPLAZOS.
*    LA CANTIDAD DE AMPERSANDS ES IRRELEVANTE, PERO PARECE*    LA CANTIDAD DE AMPERSANDS ES IRRELEVANTE, PERO PARECE
*    CONVENIENTE QUE INFORME SOBRE EL TAMANIO DEL CONTENIDO.*    CONVENIENTE QUE INFORME SOBRE EL TAMANIO DEL CONTENIDO.03 LA-TEMPLATES.|03 LA-TEMPLATES.05 LA-TEMPLATEOCCURS 4 INDEXED LAX.|05 LA-TEMPLATEOCCURS 4 INDEXED LAX.07 LA-PARTEPIC X(50)|07 LA-PARTEPIC X(50)OCCURS 10 INDEXED LAY.|OCCURS 10 INDEXED LAY.
*    LAS DOS LINEAS ARMADAS*    LAS DOS LINEAS ARMADAS03 LA-LINEAS.|03 LA-LINEAS.05 LA-LINEA1PIC X(50).|05 LA-LINEA1PIC X(50).05 LA-LINEA2PIC X(50).|05 LA-LINEA2PIC X(50).
*    LOS VALORES A INSERTAR EN UNA LINEA*    LOS VALORES A INSERTAR EN UNA LINEA03 LA-VALORES.|03 LA-VALORES.05 LA-VALORPIC X(50)|05 LA-VALORPIC X(50)OCCURS 10 INDEXED LAV.|OCCURS 10 INDEXED LAV.
*    DATOS PARA EDITAR VALORES A INSERTAR*    DATOS PARA EDITAR VALORES A INSERTAR03 LA-NUMPIC -(11)0.|03 LA-NUMPIC -(11)0.03 LA-NUMXREDEFINES LA-NUM|03 LA-NUMXREDEFINES LA-NUMPIC X(12).|PIC X(12).03 LA-DESCARTEPIC X(50).|03 LA-DESCARTEPIC X(50).************************************************************************************************************************************
* ERRORES DE CONSISTENCIA DEL INPUT* ERRORES DE CONSISTENCIA DEL INPUT
* CADA ERROR TIENE UN CODIGO DE 2 DIGITOS, UN ESPACIO, CONTADOR* CADA ERROR TIENE UN CODIGO DE 2 DIGITOS, UN ESPACIO, CONTADOR
* DE OCURRENCIAS DE 7 DIGITOS, UN ESPACIO, Y DESCRIPCION DE 59* DE OCURRENCIAS DE 7 DIGITOS, UN ESPACIO, Y DESCRIPCION DE 59
01 E-ERRORES.|01 E-ERRORES.
*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR03 E-HAY-ERRORPIC XX VALUE "NO".|03 E-HAY-ERRORPIC XX VALUE "NO".*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR03 E-HAY-ERRORPIC XX VALUE "NO".|03 E-HAY-ERRORPIC XX VALUE "NO".
*    ERRORES DEL REGISTRO ACTUAL*    ERRORES DEL REGISTRO ACTUAL03 E-ERRORES-REGPIC X(100) VALUE SPACES.|03 E-ERRORES-REGPIC X(100) VALUE SPACES.
*    CONTADOR DE REGISTROS CON ERROR*    CONTADOR DE REGISTROS CON ERROR03 E-CONT-REGS-CON-ERROR     PIC 9(8) VALUE ZERO.|03 E-CONT-REGS-CON-ERROR     PIC 9(8) VALUE ZERO.
*    TABLA DE ERRORES*    TABLA DE ERRORES03 PIC X(11) VALUE "01 0000000 ".|03 PIC X(11) VALUE "01 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"TIPO DE MOVIMIENTO INVALIDO, DEBE SER I M E T"."TIPO DE MOVIMIENTO INVALIDO, DEBE SER I M E T".03 PIC X(11) VALUE "02 0000000 ".|03 PIC X(11) VALUE "02 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"TIPO DE IDENTIFICACION INVALIDO, DEBE SER 1 2 3 4"."TIPO DE IDENTIFICACION INVALIDO, DEBE SER 1 2 3 4".03 PIC X(11) VALUE "03 0000000 ".|03 PIC X(11) VALUE "03 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"NUMERO DE IDENTIFICACION INVALIDO, DEBE SER NUMERICO"."NUMERO DE IDENTIFICACION INVALIDO, DEBE SER NUMERICO".03 PIC X(11) VALUE "04 0000000 ".|03 PIC X(11) VALUE "04 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"TIPO DE IDENTIFICACION DEBE SER MAYOR QUE CERO"."TIPO DE IDENTIFICACION DEBE SER MAYOR QUE CERO".03 PIC X(11) VALUE "05 0000000 ".|03 PIC X(11) VALUE "05 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"FALTA EL NOMBRE O DENOMINACION"."FALTA EL NOMBRE O DENOMINACION".03 PIC X(11) VALUE "06 0000000 ".|03 PIC X(11) VALUE "06 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"NUMERO DE DEMANDAS VIGENTES: DEBE SER NUMERICO"."NUMERO DE DEMANDAS VIGENTES: DEBE SER NUMERICO".03 PIC X(11) VALUE "07 0000000 ".|03 PIC X(11) VALUE "07 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"NUMERO DE DEMANDAS TERMINADAS: DEBE SER NUMERICO"."NUMERO DE DEMANDAS TERMINADAS: DEBE SER NUMERICO".03 PIC X(11) VALUE "08 0000000 ".|03 PIC X(11) VALUE "08 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD: DEBE SER NUMERICA"."FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD: DEBE SER NUMERICA".03 PIC X(11) VALUE "09 0000000 ".|03 PIC X(11) VALUE "09 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD: FUERA DE RANGO"."FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD: FUERA DE RANGO".03 PIC X(11) VALUE "10 0000000 ".|03 PIC X(11) VALUE "10 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"NUMERO DE EMBARGOS VIGENTES: DEBE SER NUMERICO"."NUMERO DE EMBARGOS VIGENTES: DEBE SER NUMERICO".03 PIC X(11) VALUE "11 0000000 ".|03 PIC X(11) VALUE "11 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"NUMERO DE EMBARGOS TERMINADOS: DEBE SER NUMERICO"."NUMERO DE EMBARGOS TERMINADOS: DEBE SER NUMERICO".03 PIC X(11) VALUE "12 0000000 ".|03 PIC X(11) VALUE "12 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD: DEBE SER NUMERICA"."FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD: DEBE SER NUMERICA".03 PIC X(11) VALUE "13 0000000 ".|03 PIC X(11) VALUE "13 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD: FUERA DE RANGO"."FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD: FUERA DE RANGO".03 PIC X(11) VALUE "14 0000000 ".|03 PIC X(11) VALUE "14 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"EL NUMERO DE ID NO SE ENCUENTRA EN EL ARCHIVO MAESTRO"."EL NUMERO DE ID NO SE ENCUENTRA EN EL ARCHIVO MAESTRO".03 PIC X(11) VALUE "15 0000000 ".|03 PIC X(11) VALUE "15 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"EL NOMBRE EN EL INPUT NO COINCIDE CON EL REGISTRADO"."EL NOMBRE EN EL INPUT NO COINCIDE CON EL REGISTRADO".03 PIC X(11) VALUE "16 0000000 ".|03 PIC X(11) VALUE "16 0000000 ".03 PIC X(59) VALUE|03 PIC X(59) VALUE"NUMERO DE ID FUERA DEL RANGO DEL TIPO DE ID INFORMADO"."NUMERO DE ID FUERA DEL RANGO DEL TIPO DE ID INFORMADO".
*----------------- INSERTAR NUEVOS ITEMS AQUI -------------------*----------------- INSERTAR NUEVOS ITEMS AQUI -------------------"NUMERO DE ID FUERA DEL RANGO DEL TIPO DE ID INFORMADO"."NUMERO DE ID FUERA DEL RANGO DEL TIPO DE ID INFORMADO".*----------------- INSERTAR NUEVOS ITEMS AQUI -------------------*----------------- INSERTAR NUEVOS ITEMS AQUI -------------------03 PIC X(11) VALUE "00 0000000 ".|03 PIC X(11) VALUE "00 0000000 ".03 PIC X(59) VALUE "--- FIN DE LA LISTA (COD 00) ---".|03 PIC X(59) VALUE "--- FIN DE LA LISTA (COD 00) ---".03PIC X(3500). *> LOS 50 ITEMS|03PIC X(3500). *> LOS 50 ITEMS
01 E-ERRORES-2REDEFINES E-ERRORES.|01 E-ERRORES-2REDEFINES E-ERRORES.03PIC XX.|03PIC XX.03PIC X(100).|03PIC X(100).03PIC 9(8).|03PIC 9(8).03 E-ERROROCCURS 50 INDEXED EX.|03 E-ERROROCCURS 50 INDEXED EX.05 E-CODIGOPIC XX.|05 E-CODIGOPIC XX.05PIC X.|05PIC X.05 E-CONTADORPIC 9(7).|05 E-CONTADORPIC 9(7).05PIC X.|05PIC X.05 E-DESCRIPCIONPIC X(59).|05 E-DESCRIPCIONPIC X(59).
01 E-EDITPIC Z(8)B.|01 E-EDITPIC Z(8)B.************************************************************************************************************************************
* CONTROL DE RANGOS DE VALORES DE LAS FECHAS DEL INPUT* CONTROL DE RANGOS DE VALORES DE LAS FECHAS DEL INPUT
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-XPIC 9(04).|02 ANO-VAL-XPIC 9(04).88 ANO-VALVALUE 1900 THRU 2050.|88 ANO-VALVALUE 1900 THRU 2050.02 MES-VAL-XPIC 9(02).|02 MES-VAL-XPIC 9(02).88 MES-VALVALUE 01   THRU 12.|88 MES-VALVALUE 01   THRU 12.02 DIA-VAL-XPIC 9(02).|02 DIA-VAL-XPIC 9(02).88 DIA-VALVALUE 01   THRU 31.|88 DIA-VALVALUE 01   THRU 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.
*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    INICIALIZA EL AMBIENTE Y ABRE LOS ARCHIVOS*    INICIALIZA EL AMBIENTE Y ABRE LOS ARCHIVOSPERFORM 1000-RUTINA-INICIAL|PERFORM 1000-RUTINA-INICIAL*    INICIALIZA EL AMBIENTE Y ABRE LOS ARCHIVOS*    INICIALIZA EL AMBIENTE Y ABRE LOS ARCHIVOSPERFORM 1000-RUTINA-INICIAL|PERFORM 1000-RUTINA-INICIAL
*    PROCESA CADA UNO DE LOS REGISTROS DEL ARCHIVO JURAD HASTA*    PROCESA CADA UNO DE LOS REGISTROS DEL ARCHIVO JURAD HASTA
*    ENCONTRAR EL REGISTRO "T" DE TOTALES|*    ENCONTRAR EL REGISTRO "T" DE TOTALESPERFORM 4000-PROCESAR-REGISTRO UNTIL IND-FIN-PROCESO = "SI"|PERFORM 4000-PROCESAR-REGISTRO UNTIL IND-FIN-PROCESO = "SI"
*    CIERRA ARCHIVOS Y PRODUCE EL REPORTE FINAL*    CIERRA ARCHIVOS Y PRODUCE EL REPORTE FINALPERFORM 7000-RUTINA-FINAL|PERFORM 7000-RUTINA-FINALGOBACK.|GOBACK.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* PROCESO DE UN REGISTRO DEL ARCHIVO DE ENTRADA JURAD* PROCESO DE UN REGISTRO DEL ARCHIVO DE ENTRADA JURAD
* LECTURA Y CONTROL DEL FILE STATUS DEL ARCHIVO* LECTURA Y CONTROL DEL FILE STATUS DEL ARCHIVO
********************************************************************************************************************************
*    LECTURA DEL PROXIMO REGISTRO*    LECTURA DEL PROXIMO REGISTROREAD JURAD|READ JURADEVALUATE JURAD-FS|EVALUATE JURAD-FSWHEN "00"|WHEN "00"
*CONTROLA EL REG Y LO APLICA SI ES OK*CONTROLA EL REG Y LO APLICA SI ES OKPERFORM 4000-PROCESAR-REGISTRO-2|PERFORM 4000-PROCESAR-REGISTRO-2MOVE JURAD-REG TO JURAD-REG-ANTERIOR|MOVE JURAD-REG TO JURAD-REG-ANTERIORWHEN "10"|WHEN "10"
*FIN DEL ARCHIVO DE INPUT:*FIN DEL ARCHIVO DE INPUT:
*ESTO ES UN ERROR, NO SE ENCONTRO EL REGISTRO "T" ANTES|*ESTO ES UN ERROR, NO SE ENCONTRO EL REGISTRO "T" ANTES
*DE QUE SE TERMINARA EL ARCHIVO*DE QUE SE TERMINARA EL ARCHIVODISPLAY "FALTA EL REG DE TOTALES DEL ARCHIVO JURAD "|DISPLAY "FALTA EL REG DE TOTALES DEL ARCHIVO JURAD "DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME|DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAMEDISPLAY "FILE STATUS: " JURAD-FS|DISPLAY "FILE STATUS: " JURAD-FSDISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS|DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOSDISPLAY JURAD-REG-ANTERIOR|DISPLAY JURAD-REG-ANTERIORPERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAWHEN OTHER|WHEN OTHER
*ERROR DE LECTURA: CANCELACION DEL PROCESO*ERROR DE LECTURA: CANCELACION DEL PROCESODISPLAY "ERROR EN LECTURA DEL ARCHIVO JURAD "|DISPLAY "ERROR EN LECTURA DEL ARCHIVO JURAD "DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAME|DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAMEDISPLAY "FILE STATUS: " JURAD-FS|DISPLAY "FILE STATUS: " JURAD-FSDISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOS|DISPLAY "ULTIMO REGISTRO LEIDO: " N-REG-LEIDOSDISPLAY JURAD-REG-ANTERIOR|DISPLAY JURAD-REG-ANTERIORPERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-EVALUATE.|END-EVALUATE.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* CONTROLA LOS DATOS DE UN REGISTRO DE JURAD Y SI ES OK LO USA* CONTROLA LOS DATOS DE UN REGISTRO DE JURAD Y SI ES OK LO USA
* PARA ACTUALIZAR EL ARCHIVO DE ALERTAS EN LINEA* PARA ACTUALIZAR EL ARCHIVO DE ALERTAS EN LINEA
* LA INFORMACION ESTA LEIDA EN JURAD-REG* LA INFORMACION ESTA LEIDA EN JURAD-REG
********************************************************************************************************************************MOVE "NO" TO E-HAY-ERROR|MOVE "NO" TO E-HAY-ERROR*    VALIDACION DEL TIPO DE MOVIMIENTO*    VALIDACION DEL TIPO DE MOVIMIENTOIF JURAD-TIPO-NOVEDAD NOT = "I" AND "M" AND "E" AND "T"|IF JURAD-TIPO-NOVEDAD NOT = "I" AND "M" AND "E" AND "T"CALL "PONERR" USING "01" JURAD-REG E-ERRORES|CALL "PONERR" USING "01" JURAD-REG E-ERRORESEND-IF|END-IF*    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESO|*    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESO
*    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESO|*    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESOIF JURAD-TIPO-NOVEDAD = "T"|IF JURAD-TIPO-NOVEDAD = "T"MOVE "SI" TO IND-FIN-PROCESO|MOVE "SI" TO IND-FIN-PROCESOEXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IFADD 1 TO N-REG-LEIDOS|ADD 1 TO N-REG-LEIDOS*    VALIDACION FORMAL DE LOS DATOS*    VALIDACION FORMAL DE LOS DATOSPERFORM 4100-VALIDACION-FORMAL|PERFORM 4100-VALIDACION-FORMALIF E-HAY-ERROR = "SI"|IF E-HAY-ERROR = "SI"PERFORM 4900-GRABAR-ERROR|EXIT PARAGRAPHEXIT PARAGRAPH|END-IFEND-IF<*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICA*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICAPERFORM 4200-VALIDACION-SEMANTICA|PERFORM 4200-VALIDACION-SEMANTICAIF E-HAY-ERROR = "SI"|IF E-HAY-ERROR = "SI"PERFORM 4900-GRABAR-ERROR|EXIT PARAGRAPHEXIT PARAGRAPH|END-IFEND-IF<*    INTENTO DE ACTUALIZACION DE BDIIALE|*    ACTUALIZACION DE BDIIALE O GRABACION EN ARCH ERRS DE DEFECTOSPERFORM 4300-MODIFICAR-BDIIALE|IF E-HAY-ERROR = "SI"ADD 1 TO N-REG-OK.|PERFORM 4900-GRABAR-ERROR
>ADD 1 TO N-REG-CON-ERROR
>ELSE
>PERFORM 4300-MODIFICAR-BDIIALE
>ADD 1 TO N-REG-OK
>END-IF.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* VALIDACION FORMAL DE LOS DATOS DEL INPUT* VALIDACION FORMAL DE LOS DATOS DEL INPUT
************************************************************************************************************************************
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"|IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"CALL "PONERR" USING "02" JURAD-REG E-ERRORES|CALL "PONERR" USING "02" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACIONIF JURAD-ID-NUMEROX IS NOT NUMERIC|IF JURAD-ID-NUMEROX IS NOT NUMERICCALL "PONERR" USING "03" JURAD-REG E-ERRORES|CALL "PONERR" USING "03" JURAD-REG E-ERRORESEND-IF|END-IFIF JURAD-ID-NUMERO NOT > 0|IF JURAD-ID-NUMERO NOT > 0CALL "PONERR" USING "04" JURAD-REG E-ERRORES|CALL "PONERR" USING "04" JURAD-REG E-ERRORESEND-IF|END-IF
*    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES*    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES
*    NO SE CONTROLAN*    NO SE CONTROLANIF JURAD-TIPO-NOVEDAD = "E"|IF JURAD-TIPO-NOVEDAD = "E"EXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IF
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOSIF JURAD-NOMBRE = SPACES|IF JURAD-NOMBRE = SPACES*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOSIF JURAD-NOMBRE = SPACES|IF JURAD-NOMBRE = SPACESCALL "PONERR" USING "05" JURAD-REG E-ERRORES|CALL "PONERR" USING "05" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTESIF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC|IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERICCALL "PONERR" USING "06" JURAD-REG E-ERRORES|CALL "PONERR" USING "06" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADASIF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC|IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERICCALL "PONERR" USING "07" JURAD-REG E-ERRORES|CALL "PONERR" USING "07" JURAD-REG E-ERRORESEND-IF|END-IF
*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYMMDDIF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC|IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERICCALL "PONERR" USING "08" JURAD-REG E-ERRORES|CALL "PONERR" USING "08" JURAD-REG E-ERRORESEND-IF|END-IFMOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS|MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHASIF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL|IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VALCALL "PONERR" USING "09" JURAD-REG E-ERRORES|CALL "PONERR" USING "09" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTESIF JURAD-EMBARGOS-VIGENTES NOT NUMERIC|IF JURAD-EMBARGOS-VIGENTES NOT NUMERICCALL "PONERR" USING "10" JURAD-REG E-ERRORES|CALL "PONERR" USING "10" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOSIF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC|IF JURAD-EMBARGOS-TERMINADOS NOT NUMERICCALL "PONERR" USING "11" JURAD-REG E-ERRORES|CALL "PONERR" USING "11" JURAD-REG E-ERRORESEND-IF|END-IF
*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYMMDDIF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC|IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERICCALL "PONERR" USING "12" JURAD-REG E-ERRORES|CALL "PONERR" USING "12" JURAD-REG E-ERRORESEND-IF|END-IFMOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS|MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHASIF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL|IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VALCALL "PONERR" USING "13" JURAD-REG E-ERRORES|CALL "PONERR" USING "13" JURAD-REG E-ERRORESEND-IF.|END-IF.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON* VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON
* EL NOMBRE* EL NOMBRE
********************************************************************************************************************************MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE|MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDEMOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE-R|MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE-RMOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE|MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDEMOVE 1 TO SW-VERIFNOM-BDIIVIDE|MOVE 1 TO SW-VERIFNOM-BDIIVIDEMOVE 0 TO SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE|MOVE 0 TO SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEPERFORM 80100-VALIDAR-IDENTIFICACION|PERFORM 80100-VALIDAR-IDENTIFICACION
*    A VER SI LA VALIDACION CAMBIO EL TIPO DE IDE*    A VER SI LA VALIDACION CAMBIO EL TIPO DE IDEIF JURAD-ID-TIPO NOT = TIP-IDE-BDIIVIDE|IF JURAD-ID-TIPO NOT = TIP-IDE-BDIIVIDECALL "PONERR" USING "16" JURAD-REG E-ERRORES|CALL "PONERR" USING "16" JURAD-REG E-ERRORESDISPLAY "TIPO IDE CAMBIADO DE " JURAD-ID-TIPO " A "|DISPLAY "TIPO IDE CAMBIADO DE " JURAD-ID-TIPO " A "TIP-IDE-BDIIVIDE " NUM IDE: " JURAD-ID-NUMERO|TIP-IDE-BDIIVIDE " NUM IDE: " JURAD-ID-NUMEROEND-IF|END-IF
*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE
*    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESO|*    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESOIF JURAD-TIPO-NOVEDAD = "T"|IF JURAD-TIPO-NOVEDAD = "T"MOVE "SI" TO IND-FIN-PROCESO|MOVE "SI" TO IND-FIN-PROCESOEXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IFADD 1 TO N-REG-LEIDOS|ADD 1 TO N-REG-LEIDOS*    VALIDACION FORMAL DE LOS DATOS*    VALIDACION FORMAL DE LOS DATOSPERFORM 4100-VALIDACION-FORMAL|PERFORM 4100-VALIDACION-FORMALIF E-HAY-ERROR = "SI"|IF E-HAY-ERROR = "SI"PERFORM 4900-GRABAR-ERROR|EXIT PARAGRAPHEXIT PARAGRAPH|END-IFEND-IF<*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICA*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICAPERFORM 4200-VALIDACION-SEMANTICA|PERFORM 4200-VALIDACION-SEMANTICAIF E-HAY-ERROR = "SI"|IF E-HAY-ERROR = "SI"PERFORM 4900-GRABAR-ERROR|EXIT PARAGRAPHEXIT PARAGRAPH|END-IFEND-IF<*    INTENTO DE ACTUALIZACION DE BDIIALE|*    ACTUALIZACION DE BDIIALE O GRABACION EN ARCH ERRS DE DEFECTOSPERFORM 4300-MODIFICAR-BDIIALE|IF E-HAY-ERROR = "SI"ADD 1 TO N-REG-OK.|PERFORM 4900-GRABAR-ERROR
>ADD 1 TO N-REG-CON-ERROR
>ELSE
>PERFORM 4300-MODIFICAR-BDIIALE
>ADD 1 TO N-REG-OK
>END-IF.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* VALIDACION FORMAL DE LOS DATOS DEL INPUT* VALIDACION FORMAL DE LOS DATOS DEL INPUT
************************************************************************************************************************************
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"|IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"CALL "PONERR" USING "02" JURAD-REG E-ERRORES|CALL "PONERR" USING "02" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACIONIF JURAD-ID-NUMEROX IS NOT NUMERIC|IF JURAD-ID-NUMEROX IS NOT NUMERICCALL "PONERR" USING "03" JURAD-REG E-ERRORES|CALL "PONERR" USING "03" JURAD-REG E-ERRORESEND-IF|END-IFIF JURAD-ID-NUMERO NOT > 0|IF JURAD-ID-NUMERO NOT > 0CALL "PONERR" USING "04" JURAD-REG E-ERRORES|CALL "PONERR" USING "04" JURAD-REG E-ERRORESEND-IF|END-IF
*    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES*    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES
*    NO SE CONTROLAN*    NO SE CONTROLANIF JURAD-TIPO-NOVEDAD = "E"|IF JURAD-TIPO-NOVEDAD = "E"EXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IF
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOSIF JURAD-NOMBRE = SPACES|IF JURAD-NOMBRE = SPACES*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOSIF JURAD-NOMBRE = SPACES|IF JURAD-NOMBRE = SPACESCALL "PONERR" USING "05" JURAD-REG E-ERRORES|CALL "PONERR" USING "05" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTESIF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC|IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERICCALL "PONERR" USING "06" JURAD-REG E-ERRORES|CALL "PONERR" USING "06" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADASIF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC|IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERICCALL "PONERR" USING "07" JURAD-REG E-ERRORES|CALL "PONERR" USING "07" JURAD-REG E-ERRORESEND-IF|END-IF
*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYMMDDIF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC|IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERICCALL "PONERR" USING "08" JURAD-REG E-ERRORES|CALL "PONERR" USING "08" JURAD-REG E-ERRORESEND-IF|END-IFMOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS|MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHASIF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL|IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VALCALL "PONERR" USING "09" JURAD-REG E-ERRORES|CALL "PONERR" USING "09" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTESIF JURAD-EMBARGOS-VIGENTES NOT NUMERIC|IF JURAD-EMBARGOS-VIGENTES NOT NUMERICCALL "PONERR" USING "10" JURAD-REG E-ERRORES|CALL "PONERR" USING "10" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOSIF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC|IF JURAD-EMBARGOS-TERMINADOS NOT NUMERICCALL "PONERR" USING "11" JURAD-REG E-ERRORES|CALL "PONERR" USING "11" JURAD-REG E-ERRORESEND-IF|END-IF
*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYMMDDIF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC|IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERICCALL "PONERR" USING "12" JURAD-REG E-ERRORES|CALL "PONERR" USING "12" JURAD-REG E-ERRORESEND-IF|END-IFMOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS|MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHASIF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL|IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VALCALL "PONERR" USING "13" JURAD-REG E-ERRORES|CALL "PONERR" USING "13" JURAD-REG E-ERRORESEND-IF.|END-IF.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON* VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON
* EL NOMBRE* EL NOMBRE
********************************************************************************************************************************MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE|MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDEMOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE-R|MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE-RMOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE|MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDEMOVE 1 TO SW-VERIFNOM-BDIIVIDE|MOVE 1 TO SW-VERIFNOM-BDIIVIDEMOVE 0 TO SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE|MOVE 0 TO SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEPERFORM 80100-VALIDAR-IDENTIFICACION|PERFORM 80100-VALIDAR-IDENTIFICACION
*    A VER SI LA VALIDACION CAMBIO EL TIPO DE IDE*    A VER SI LA VALIDACION CAMBIO EL TIPO DE IDEIF JURAD-ID-TIPO NOT = TIP-IDE-BDIIVIDE|IF JURAD-ID-TIPO NOT = TIP-IDE-BDIIVIDECALL "PONERR" USING "16" JURAD-REG E-ERRORES|CALL "PONERR" USING "16" JURAD-REG E-ERRORESDISPLAY "TIPO IDE CAMBIADO DE " JURAD-ID-TIPO " A "|DISPLAY "TIPO IDE CAMBIADO DE " JURAD-ID-TIPO " A "TIP-IDE-BDIIVIDE " NUM IDE: " JURAD-ID-NUMERO|TIP-IDE-BDIIVIDE " NUM IDE: " JURAD-ID-NUMEROEND-IF|END-IF
*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE
*    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESO|*    SI ES EL REGISTRO "T" HAY QUE SENIALAR EL FIN DE PROCESOIF JURAD-TIPO-NOVEDAD = "T"|IF JURAD-TIPO-NOVEDAD = "T"MOVE "SI" TO IND-FIN-PROCESO|MOVE "SI" TO IND-FIN-PROCESOEXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IFADD 1 TO N-REG-LEIDOS|ADD 1 TO N-REG-LEIDOS*    VALIDACION FORMAL DE LOS DATOS*    VALIDACION FORMAL DE LOS DATOSPERFORM 4100-VALIDACION-FORMAL|PERFORM 4100-VALIDACION-FORMALIF E-HAY-ERROR = "SI"|IF E-HAY-ERROR = "SI"PERFORM 4900-GRABAR-ERROR|EXIT PARAGRAPHEXIT PARAGRAPH|END-IFEND-IF<*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICA*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICAPERFORM 4200-VALIDACION-SEMANTICA|PERFORM 4200-VALIDACION-SEMANTICAIF E-HAY-ERROR = "SI"|IF E-HAY-ERROR = "SI"PERFORM 4900-GRABAR-ERROR|EXIT PARAGRAPHEXIT PARAGRAPH|END-IFEND-IF<*    INTENTO DE ACTUALIZACION DE BDIIALE|*    ACTUALIZACION DE BDIIALE O GRABACION EN ARCH ERRS DE DEFECTOSPERFORM 4300-MODIFICAR-BDIIALE|IF E-HAY-ERROR = "SI"ADD 1 TO N-REG-OK.|PERFORM 4900-GRABAR-ERROR
>ADD 1 TO N-REG-CON-ERROR
>ELSE
>PERFORM 4300-MODIFICAR-BDIIALE
>ADD 1 TO N-REG-OK
>END-IF.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* VALIDACION FORMAL DE LOS DATOS DEL INPUT* VALIDACION FORMAL DE LOS DATOS DEL INPUT
************************************************************************************************************************************
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"|IF JURAD-ID-TIPO NOT = "1" AND "2" AND "3" AND "4"CALL "PONERR" USING "02" JURAD-REG E-ERRORES|CALL "PONERR" USING "02" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACIONIF JURAD-ID-NUMEROX IS NOT NUMERIC|IF JURAD-ID-NUMEROX IS NOT NUMERICCALL "PONERR" USING "03" JURAD-REG E-ERRORES|CALL "PONERR" USING "03" JURAD-REG E-ERRORESEND-IF|END-IFIF JURAD-ID-NUMERO NOT > 0|IF JURAD-ID-NUMERO NOT > 0CALL "PONERR" USING "04" JURAD-REG E-ERRORES|CALL "PONERR" USING "04" JURAD-REG E-ERRORESEND-IF|END-IF
*    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES*    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES
*    NO SE CONTROLAN*    NO SE CONTROLANIF JURAD-TIPO-NOVEDAD = "E"|IF JURAD-TIPO-NOVEDAD = "E"EXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IF
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOSIF JURAD-NOMBRE = SPACES|IF JURAD-NOMBRE = SPACES*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOSIF JURAD-NOMBRE = SPACES|IF JURAD-NOMBRE = SPACESCALL "PONERR" USING "05" JURAD-REG E-ERRORES|CALL "PONERR" USING "05" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTESIF JURAD-DEMANDAS-VIGENTES IS NOT NUMERIC|IF JURAD-DEMANDAS-VIGENTES IS NOT NUMERICCALL "PONERR" USING "06" JURAD-REG E-ERRORES|CALL "PONERR" USING "06" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADASIF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERIC|IF JURAD-DEMANDAS-TERMINADAS IS NOT NUMERICCALL "PONERR" USING "07" JURAD-REG E-ERRORES|CALL "PONERR" USING "07" JURAD-REG E-ERRORESEND-IF|END-IF
*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYMMDDIF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERIC|IF JURAD-DEMANDAS-FECHA-ULTIMA IS NOT NUMERICCALL "PONERR" USING "08" JURAD-REG E-ERRORES|CALL "PONERR" USING "08" JURAD-REG E-ERRORESEND-IF|END-IFMOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHAS|MOVE JURAD-DEMANDAS-FECHA-ULTIMA TO VALIDACIONES-FECHASIF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL|IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VALCALL "PONERR" USING "09" JURAD-REG E-ERRORES|CALL "PONERR" USING "09" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTESIF JURAD-EMBARGOS-VIGENTES NOT NUMERIC|IF JURAD-EMBARGOS-VIGENTES NOT NUMERICCALL "PONERR" USING "10" JURAD-REG E-ERRORES|CALL "PONERR" USING "10" JURAD-REG E-ERRORESEND-IF|END-IF
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOSIF JURAD-EMBARGOS-TERMINADOS NOT NUMERIC|IF JURAD-EMBARGOS-TERMINADOS NOT NUMERICCALL "PONERR" USING "11" JURAD-REG E-ERRORES|CALL "PONERR" USING "11" JURAD-REG E-ERRORESEND-IF|END-IF
*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYMMDDIF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERIC|IF JURAD-EMBARGOS-FECHA-ULTIMO IS NOT NUMERICCALL "PONERR" USING "12" JURAD-REG E-ERRORES|CALL "PONERR" USING "12" JURAD-REG E-ERRORESEND-IF|END-IFMOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHAS|MOVE JURAD-EMBARGOS-FECHA-ULTIMO TO VALIDACIONES-FECHASIF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VAL|IF NOT ANO-VAL OR NOT MES-VAL OR NOT DIA-VALCALL "PONERR" USING "13" JURAD-REG E-ERRORES|CALL "PONERR" USING "13" JURAD-REG E-ERRORESEND-IF.|END-IF.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON* VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON
* EL NOMBRE* EL NOMBRE
********************************************************************************************************************************MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDE|MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIVIDEMOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE-R|MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIVIDE-RMOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDE|MOVE JURAD-NOMBRE TO NOMBRE-BDIIVIDEMOVE 1 TO SW-VERIFNOM-BDIIVIDE|MOVE 1 TO SW-VERIFNOM-BDIIVIDEMOVE 0 TO SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE|MOVE 0 TO SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEPERFORM 80100-VALIDAR-IDENTIFICACION|PERFORM 80100-VALIDAR-IDENTIFICACION
*    A VER SI LA VALIDACION CAMBIO EL TIPO DE IDE*    A VER SI LA VALIDACION CAMBIO EL TIPO DE IDEIF JURAD-ID-TIPO NOT = TIP-IDE-BDIIVIDE|IF JURAD-ID-TIPO NOT = TIP-IDE-BDIIVIDECALL "PONERR" USING "16" JURAD-REG E-ERRORES|CALL "PONERR" USING "16" JURAD-REG E-ERRORESDISPLAY "TIPO IDE CAMBIADO DE " JURAD-ID-TIPO " A "|DISPLAY "TIPO IDE CAMBIADO DE " JURAD-ID-TIPO " A "TIP-IDE-BDIIVIDE " NUM IDE: " JURAD-ID-NUMERO|TIP-IDE-BDIIVIDE " NUM IDE: " JURAD-ID-NUMEROEND-IF|END-IF
*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTEEND-IF|END-IF*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTEIF SW-ID-BDIIVIDE = 1|IF SW-ID-BDIIVIDE = 1CALL "PONERR" USING "14" JURAD-REG E-ERRORES|CALL "PONERR" USING "14" JURAD-REG E-ERRORESELSE|ELSE
*EXISTE ID, A VER SI EL NOMBRE COINCIDE*EXISTE ID, A VER SI EL NOMBRE COINCIDEIF SW-NOMBRES-BDIIVIDE = 1    *> NOMBRE NO COINCIDE|IF SW-NOMBRES-BDIIVIDE = 1    *> NOMBRE NO COINCIDECALL "PONERR" USING "15" JURAD-REG E-ERRORES|CALL "PONERR" USING "15" JURAD-REG E-ERRORESDISPLAY "NOVEDAD:  " JURAD-NOMBRE|DISPLAY "NOVEDAD:  " JURAD-NOMBREDISPLAY "REGISTRO: " NOM-LEIDO-BDIIVIDE|DISPLAY "REGISTRO: " NOM-LEIDO-BDIIVIDEEND-IF|END-IFEND-IF.|END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* SE IMPACTA EL ARCHIVO BDIIALE CON UNA O DOS INSERCIONES,* SE IMPACTA EL ARCHIVO BDIIALE CON UNA O DOS INSERCIONES,
* MODIFICACIONES O ELIMINACIONES SEGUN HAYA O NO DEMANDAS Y* MODIFICACIONES O ELIMINACIONES SEGUN HAYA O NO DEMANDAS Y
* EMBARGOS* EMBARGOS
************************************************************************************************************************************INITIALIZE REG-BDIIALE|INITIALIZE REG-BDIIALE*    SI HAY DEMANDAS*    SI HAY DEMANDASIF JURAD-DEMANDAS-VIGENTES > ZERO|IF JURAD-DEMANDAS-VIGENTES > ZEROOR JURAD-DEMANDAS-TERMINADAS > ZERO|OR JURAD-DEMANDAS-TERMINADAS > ZEROMOVE "J001" TO LLASEC-BDIIALE|MOVE "J001" TO LLASEC-BDIIALE
*ARMA DATOS DE DEMANDAS*ARMA DATOS DE DEMANDASMOVE JURAD-DEMANDAS-VIGENTES TO D-VIGENTES|MOVE JURAD-DEMANDAS-VIGENTES TO D-VIGENTESMOVE JURAD-DEMANDAS-TERMINADAS TO D-TERMINADOS|MOVE JURAD-DEMANDAS-TERMINADAS TO D-TERMINADOSSTRING "20" JURAD-DEMANDAS-FECHA-ULTIMA|STRING "20" JURAD-DEMANDAS-FECHA-ULTIMADELIMITED SIZE INTO D-FECHA-ULTIMA|DELIMITED SIZE INTO D-FECHA-ULTIMAPERFORM 4300-MODIFICAR-BDIIALE-DATOS|PERFORM 4300-MODIFICAR-BDIIALE-DATOSEND-IF.|END-IF.*    SI HAY EMBARGOS*    SI HAY EMBARGOSIF JURAD-EMBARGOS-VIGENTES > ZERO|IF JURAD-EMBARGOS-VIGENTES > ZEROOR JURAD-EMBARGOS-TERMINADOS > ZERO|OR JURAD-EMBARGOS-TERMINADOS > ZEROMOVE "J002" TO LLASEC-BDIIALE|MOVE "J002" TO LLASEC-BDIIALE
*ARMA DATOS DE EMBARGOS*ARMA DATOS DE EMBARGOSMOVE JURAD-EMBARGOS-VIGENTES TO D-VIGENTES|MOVE JURAD-EMBARGOS-VIGENTES TO D-VIGENTESMOVE JURAD-EMBARGOS-TERMINADOS TO D-TERMINADOS|MOVE JURAD-EMBARGOS-TERMINADOS TO D-TERMINADOSSTRING "20" JURAD-EMBARGOS-FECHA-ULTIMO|STRING "20" JURAD-EMBARGOS-FECHA-ULTIMODELIMITED SIZE INTO D-FECHA-ULTIMA|DELIMITED SIZE INTO D-FECHA-ULTIMAPERFORM 4300-MODIFICAR-BDIIALE-DATOS|PERFORM 4300-MODIFICAR-BDIIALE-DATOSEND-IF.|END-IF.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* PARTE DE LA CARGA DE DATOS EN EL REGISTRO BDIIALE Y GRABACION* PARTE DE LA CARGA DE DATOS EN EL REGISTRO BDIIALE Y GRABACION
* DEL MISMO QUE ES COMUN A DEMANDAS Y EMBARGOS* DEL MISMO QUE ES COMUN A DEMANDAS Y EMBARGOS
* EL DATO LLASEC-BDIIALE YA TIENE "J001" O "J002"|* EL DATO LLASEC-BDIIALE YA TIENE "J001" O "J002"
************************************************************************************************************************************
*    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK*    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK
*    EL FILE STATUS DE BDIIALE QUEDA CON "00"|*    EL FILE STATUS DE BDIIALE QUEDA CON "00"*    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK*    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK*    EL FILE STATUS DE BDIIALE QUEDA CON "00"|*    EL FILE STATUS DE BDIIALE QUEDA CON "00"PERFORM 4333-LEER-BDIIALE-RANDOM|PERFORM 4333-LEER-BDIIALE-RANDOM*    PROCESA SEGUN EL TIPO DE NOVEDAD I M E*    PROCESA SEGUN EL TIPO DE NOVEDAD I M EEVALUATE JURAD-TIPO-NOVEDAD|EVALUATE JURAD-TIPO-NOVEDADWHEN "I"|WHEN "I"ADD 1 TO N-REG-TIPO-I-OK|ADD 1 TO N-REG-TIPO-I-OKPERFORM 4300-MODIFICAR-BDIIALE-I|PERFORM 4300-MODIFICAR-BDIIALE-IWHEN "M"|WHEN "M"ADD 1 TO N-REG-TIPO-M-OK|ADD 1 TO N-REG-TIPO-M-OKPERFORM 4300-MODIFICAR-BDIIALE-M|PERFORM 4300-MODIFICAR-BDIIALE-MWHEN "E"|WHEN "E"ADD 1 TO N-REG-TIPO-E-OK|ADD 1 TO N-REG-TIPO-E-OKPERFORM 4300-MODIFICAR-BDIIALE-E|PERFORM 4300-MODIFICAR-BDIIALE-EWHEN OTHER|WHEN OTHER
*ESTO ES "IMPOSIBLE" POR CONTROL DE CONSISTENCIA ANTERIOR|*ESTO ES "IMPOSIBLE" POR CONTROL DE CONSISTENCIA ANTERIORDISPLAY "ERROR DE LOGICA: TIPO-NOVEDAD="|DISPLAY "ERROR DE LOGICA: TIPO-NOVEDAD="JURAD-TIPO-NOVEDAD " REG NÂ°: " N-REG-LEIDOS|JURAD-TIPO-NOVEDAD " REG NÃ\202Â°: " N-REG-LEIDOSDISPLAY "REGISTRO DE JURAD: " DISPLAY JURAD-REG|DISPLAY "REGISTRO DE JURAD: " DISPLAY JURAD-REGPERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-EVALUATE.|END-EVALUATE.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* INSERCION DE UNA ALERTA NUEVA* INSERCION DE UNA ALERTA NUEVA
* SI YA EXISTIA MUESTRA UN MENSAJE Y CONTINUA* SI YA EXISTIA MUESTRA UN MENSAJE Y CONTINUA
************************************************************************************************************************************
*    SI EL REGISTRO EXISTIA ES UN ERROR*    SI EL REGISTRO EXISTIA ES UN ERRORIF EST-BDIIALE = "00"|IF EST-BDIIALE = "00"DISPLAY "INSERCION DE ALERTA NUEVA QUE YA EXISTE "|DISPLAY "INSERCION DE ALERTA NUEVA QUE YA EXISTE "" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALEDISPLAY "REGISTRO DE INPUT: "|DISPLAY "REGISTRO DE INPUT: "DISPLAY JURAD-REG|DISPLAY JURAD-REGDISPLAY "DATOS EN LA ALERTA: " INF-DATAHOST-BDIIALE|DISPLAY "DATOS EN LA ALERTA: " INF-DATAHOST-BDIIALEADD 1 TO N-ALE-YA-EXISTE|ADD 1 TO N-ALE-YA-EXISTEEND-IF|END-IF*    COMPLETA LOS DATOS DEL REGISTRO*    COMPLETA LOS DATOS DEL REGISTROINITIALIZE ENCABEZADO-BDIIALE|INITIALIZE ENCABEZADO-BDIIALEMOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-NOV-BDIIALE|MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEMOVE P-FECHA-PROCESO-50 TO FEC-VEN-BDIIALE|MOVE P-FECHA-PROCESO-50 TO FEC-VEN-BDIIALEMOVE 0 TO BLOQUEO-BDIIALE|MOVE 0 TO BLOQUEO-BDIIALEMOVE D-DATAHOST TO INF-DATAHOST-BDIIALE|MOVE D-DATAHOST TO INF-DATAHOST-BDIIALEPERFORM 4320-ARMAR-TEXTO-ALERTA|PERFORM 4320-ARMAR-TEXTO-ALERTAIF EST-BDIIALE = "00"|IF EST-BDIIALE = "00"PERFORM 4333-REGRABAR-BDIIALE|PERFORM 4333-REGRABAR-BDIIALEELSE|ELSEPERFORM 4333-GRABAR-BDIIALE|PERFORM 4333-GRABAR-BDIIALEEND-IF.|END-IF.4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.************************************************************************************************************************************
* MODIFICACION DE UNA ALERTA EXISTENTE* MODIFICACION DE UNA ALERTA EXISTENTE
* SI NO EXISTIA MUESTRA UN MENSAJE Y CONTINUA* SI NO EXISTIA MUESTRA UN MENSAJE Y CONTINUA
************************************************************************************************************************************
*    SI EL REGISTRO NO EXISTIA ES UN ERROR*    SI EL REGISTRO NO EXISTIA ES UN ERRORIF EST-BDIIALE NOT = "00"|IF EST-BDIIALE NOT = "00"DISPLAY "MODIFICACION DE ALERTA INEXISTENTE "|DISPLAY "MODIFICACION DE ALERTA INEXISTENTE "" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALEDISPLAY "REGISTRO DE INPUT: "|DISPLAY "REGISTRO DE INPUT: "DISPLAY JURAD-REG|DISPLAY JURAD-REGDISPLAY "DATOS EN LA ALERTA: " INF-DATAHOST-BDIIALE|DISPLAY "DATOS EN LA ALERTA: " INF-DATAHOST-BDIIALEADD 1 TO N-ALE-NO-EXISTE|ADD 1 TO N-ALE-NO-EXISTEEND-IF|END-IF
*    REEMPLAZA LA FECHA DE REPORTE Y LOS VALORES*    REEMPLAZA LA FECHA DE REPORTE Y LOS VALORESMOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-REP-BDIIALE|MOVE P-FECHA-PROCESO-YYYYMMDD TO FEC-REP-BDIIALEMOVE D-DATAHOST TO INF-DATAHOST-BDIIALE|MOVE D-DATAHOST TO INF-DATAHOST-BDIIALEPERFORM 4320-ARMAR-TEXTO-ALERTA|PERFORM 4320-ARMAR-TEXTO-ALERTAIF EST-BDIIALE = "00"|IF EST-BDIIALE = "00"PERFORM 4333-REGRABAR-BDIIALE|PERFORM 4333-REGRABAR-BDIIALEELSE|ELSEPERFORM 4333-GRABAR-BDIIALE|PERFORM 4333-GRABAR-BDIIALEEND-IF.|END-IF.4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* ELIMINACION DE UNA ALERTA* ELIMINACION DE UNA ALERTA
* SI NO EXISTIA MUESTRA UN MENSAJE Y CONTINUA* SI NO EXISTIA MUESTRA UN MENSAJE Y CONTINUA
************************************************************************************************************************************
*    ELIMINA EL REGISTRO*    ELIMINA EL REGISTROIF EST-BDIIALE = "00"|IF EST-BDIIALE = "00"PERFORM 4333-ELIMINAR-BDIIALE|PERFORM 4333-ELIMINAR-BDIIALEELSE|ELSEDISPLAY "ELIMINACION DE ALERTA INEXISTENTE "|DISPLAY "ELIMINACION DE ALERTA INEXISTENTE "" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALEDISPLAY "REGISTRO DE INPUT: "|DISPLAY "REGISTRO DE INPUT: "DISPLAY JURAD-REG|DISPLAY JURAD-REGADD 1 TO N-ALE-NO-EXISTE|ADD 1 TO N-ALE-NO-EXISTEEND-IF.|END-IF.4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* ARMA CLAVE EXACTA Y LEE UN REGISTRO DE BDIIALE* ARMA CLAVE EXACTA Y LEE UN REGISTRO DE BDIIALE
* USA LOS DATOS DEL REG INPUT, EXCEPTO LLASEC QUE ESTA PRECARGADO* USA LOS DATOS DEL REG INPUT, EXCEPTO LLASEC QUE ESTA PRECARGADO
* CUANDO PUDO LEER OK EL FILE STATUS EST-BDIIALE QUEDA CON "00"|* CUANDO PUDO LEER OK EL FILE STATUS EST-BDIIALE QUEDA CON "00"
************************************************************************************************************************************MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIALE|MOVE JURAD-ID-TIPO TO TIP-IDE-BDIIALEMOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIALE|MOVE JURAD-ID-NUMERO TO NUM-IDE-BDIIALEMOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE|MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALEMOVE 000 TO COD-ALERTA-BDIIALE|MOVE 000 TO COD-ALERTA-BDIIALEREAD BDIIALE|READ BDIIALEEVALUATE EST-BDIIALE|EVALUATE EST-BDIIALEWHEN "00"|WHEN "00"EVALUATE EST-BDIIALE|EVALUATE EST-BDIIALEWHEN "00"|WHEN "00"CONTINUE|CONTINUEWHEN "20" THRU "29"|WHEN "20" THRU "29"CONTINUE|CONTINUEWHEN OTHER|WHEN OTHERDISPLAY "ERROR AL LEER BDIIALE FS: " EST-BDIIALE|DISPLAY "ERROR AL LEER BDIIALE FS: " EST-BDIIALE" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALEDISPLAY "ULTIMO REGISTRO PROCESADO: "|DISPLAY "ULTIMO REGISTRO PROCESADO: "DISPLAY JURAD-REG-ANTERIOR|DISPLAY JURAD-REG-ANTERIORPERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-EVALUATE.|END-EVALUATE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* INSERTA UN REGISTRO NUEVO EN BDIIALE* INSERTA UN REGISTRO NUEVO EN BDIIALE
************************************************************************************************************************************IF NOT PROCESO-REAL|IF NOT PROCESO-REALEXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IFWRITE REG-BDIIALE|WRITE REG-BDIIALEEVALUATE EST-BDIIALE|EVALUATE EST-BDIIALEWHEN "00"|WHEN "00"ADD 1 TO N-ALE-INSERTADAS|ADD 1 TO N-ALE-INSERTADASWHEN OTHER|WHEN OTHERDISPLAY "ERROR AL GRABAR BDIIALE FS: " EST-BDIIALE|DISPLAY "ERROR AL GRABAR BDIIALE FS: " EST-BDIIALE" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALEDISPLAY "REGISTRO BDIIALE: "|DISPLAY "REGISTRO BDIIALE: "DISPLAY REG-BDIIALE|DISPLAY REG-BDIIALEPERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-EVALUATE.|END-EVALUATE.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* REGRABA UN REGISTRO MODIFICADO EN BDIIALE* REGRABA UN REGISTRO MODIFICADO EN BDIIALE
************************************************************************************************************************************IF NOT PROCESO-REAL|IF NOT PROCESO-REALEXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IFREWRITE REG-BDIIALE|REWRITE REG-BDIIALEEVALUATE EST-BDIIALE|EVALUATE EST-BDIIALEWHEN "00"|WHEN "00"ADD 1 TO N-ALE-MODIFICADAS|ADD 1 TO N-ALE-MODIFICADASWHEN OTHER|WHEN OTHERDISPLAY "ERROR AL REGRABAR BDIIALE FS: " EST-BDIIALE|DISPLAY "ERROR AL REGRABAR BDIIALE FS: " EST-BDIIALE" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALEDISPLAY "REGISTRO BDIIALE: "|DISPLAY "REGISTRO BDIIALE: "DISPLAY REG-BDIIALE|DISPLAY REG-BDIIALEPERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-EVALUATE.|END-EVALUATE.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.************************************************************************************************************************************
* ELIMINA UN REGISTRO DE BDIIALE* ELIMINA UN REGISTRO DE BDIIALE
************************************************************************************************************************************IF NOT PROCESO-REAL|IF NOT PROCESO-REALEXIT PARAGRAPH|EXIT PARAGRAPHEND-IF|END-IFDELETE BDIIALE|DELETE BDIIALEEVALUATE EST-BDIIALE|EVALUATE EST-BDIIALEWHEN "00"|WHEN "00"ADD 1 TO N-ALE-ELIMINADAS|ADD 1 TO N-ALE-ELIMINADASWHEN OTHER|WHEN OTHERDISPLAY "ERROR AL REGRABAR BDIIALE FS: " EST-BDIIALE|DISPLAY "ERROR AL REGRABAR BDIIALE FS: " EST-BDIIALE" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALEDISPLAY "REGISTRO BDIIALE: "|DISPLAY "REGISTRO BDIIALE: "DISPLAY REG-BDIIALE|DISPLAY REG-BDIIALEPERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-EVALUATE.|END-EVALUATE.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* EL REGISTRO DE JURAD TIENE ERROR: SE GRABA EN EL ARCHIVO ERRS* EL REGISTRO DE JURAD TIENE ERROR: SE GRABA EN EL ARCHIVO ERRS
* CON INDICACION DEL ERROR DETECTADO* CON INDICACION DEL ERROR DETECTADO
************************************************************************************************************************************MOVE JURAD-REG TO ERRS-REG|MOVE JURAD-REG TO ERRS-REG
*    LISTA DE LOS CODIGOS DE LOS ERRORES DEL REGISTRO*    LISTA DE LOS CODIGOS DE LOS ERRORES DEL REGISTRODISPLAY "ERRORES DEL REG: " E-ERRORES-REG|MOVE E-ERRORES-REG TO ERRS-CAUSA-RECHAZOMOVE E-ERRORES-REG TO ERRS-CAUSA-RECHAZO|WRITE ERRS-REGWRITE ERRS-REG|EVALUATE ERRS-FSEVALUATE ERRS-FS|WHEN "00"WHEN "00"|CONTINUECONTINUE|WHEN OTHERWHEN OTHER|DISPLAY "ERROR AL GRABAR EL ARCHIVO DE ERRORES "DISPLAY "ERROR AL GRABAR EL ARCHIVO DE ERRORES "|DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAMEDISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME|DISPLAY "FILE STATUS: " ERRS-FSDISPLAY "FILE STATUS: " ERRS-FS|PERFORM 9000-CANCELAR-PROGRAMAPERFORM 9000-CANCELAR-PROGRAMA|GOBACKGOBACK|END-EVALUATE.END-EVALUATE.<4320-ARMAR-TEXTO-ALERTA.4320-ARMAR-TEXTO-ALERTA.
********************************************************************************************************************************
* HACE EL REEMPLAZO DE LOS VALORES ADECUADOS EN LOS TEMPLATES* HACE EL REEMPLAZO DE LOS VALORES ADECUADOS EN LOS TEMPLATES
* DE LAS LINEA DE ALERTA QUE CORRESPONDE* DE LAS LINEA DE ALERTA QUE CORRESPONDE
********************************************************************************************************************************
*    SEGUN SE TRATE DE DEMANDAS O EMBARGOS*    SEGUN SE TRATE DE DEMANDAS O EMBARGOSIF JURAD-DEMANDAS-VIGENTES NOT = 0|IF JURAD-DEMANDAS-VIGENTES NOT = 0OR JURAD-DEMANDAS-TERMINADAS NOT = 0|OR JURAD-DEMANDAS-TERMINADAS NOT = 0SET LAX TO 1|SET LAX TO 1MOVE HIGH-VALUES TO LA-VALORES|MOVE HIGH-VALUES TO LA-VALORESMOVE JURAD-DEMANDAS-VIGENTES TO LA-NUM|MOVE JURAD-DEMANDAS-VIGENTES TO LA-NUM
* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE
*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(1)*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(1)
*DELIMITED BY ALL SPACE*DELIMITED BY ALL SPACE*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(1)*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(1)*DELIMITED BY ALL SPACE*DELIMITED BY ALL SPACEMOVE LA-NUMX(9:12) TO LA-VALOR(1)|MOVE LA-NUMX(9:12) TO LA-VALOR(1)MOVE JURAD-DEMANDAS-TERMINADAS TO LA-NUM|MOVE JURAD-DEMANDAS-TERMINADAS TO LA-NUM
* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE
*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(2)*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(2)
*DELIMITED BY ALL SPACE*DELIMITED BY ALL SPACEMOVE LA-NUMX(9:12) TO LA-VALOR(2)|MOVE LA-NUMX(9:12) TO LA-VALOR(2)* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE
* >>>> DA ERROR EN EL END-IF* >>>> DA ERROR EN EL END-IF
*STRING LA-PARTE(LAX, 1) LA-VALOR(1)*STRING LA-PARTE(LAX, 1) LA-VALOR(1)
*LA-PARTE(LAX, 2) LA-VALOR(2) LA-PARTE(LAX, 3) LA-VALOR(3)*LA-PARTE(LAX, 2) LA-VALOR(2) LA-PARTE(LAX, 3) LA-VALOR(3)
*LA-PARTE(LAX, 4) LA-VALOR(4) LA-PARTE(LAX, 5) LA-VALOR(5)*LA-PARTE(LAX, 4) LA-VALOR(4) LA-PARTE(LAX, 5) LA-VALOR(5)
*LA-PARTE(LAX, 6) LA-VALOR(6) LA-PARTE(LAX, 7) LA-VALOR(7)*LA-PARTE(LAX, 6) LA-VALOR(6) LA-PARTE(LAX, 7) LA-VALOR(7)
*LA-PARTE(LAX, 8) LA-VALOR(8) LA-PARTE(LAX, 9) LA-VALOR(9)*LA-PARTE(LAX, 8) LA-VALOR(8) LA-PARTE(LAX, 9) LA-VALOR(9)
*LA-PARTE(LAX, 10) LA-VALOR(10)*LA-PARTE(LAX, 10) LA-VALOR(10)
*DELIMITED BY HIGH-VALUE*DELIMITED BY HIGH-VALUEEND-IF.|END-IF.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* TODAS LAS OPERACIONES QUE SE REALIZAN UNA SOLA VEZ, AL COMIENZO* TODAS LAS OPERACIONES QUE SE REALIZAN UNA SOLA VEZ, AL COMIENZO
* DEL PROGRAMA:* DEL PROGRAMA:
*   - OBTENCION DE LOS PARAMETROS*   - OBTENCION DE LOS PARAMETROS
*   - APERTURA DEL ARCHIVO DE ENTRADA*   - APERTURA DEL ARCHIVO DE ENTRADA
*   - APERTURA DE TODOS LOS DEMAS ARCHIVOS*   - APERTURA DE TODOS LOS DEMAS ARCHIVOS
*   - ELIMINACION DE DATOS EXISTENTES SI ES REFRESQUE COMPLETO*   - ELIMINACION DE DATOS EXISTENTES SI ES REFRESQUE COMPLETO
************************************************************************************************************************************
* REGISTRA HORA DE INICIO* REGISTRA HORA DE INICIOACCEPT W-HORA-INICIO FROM TIME|ACCEPT W-HORA-INICIO FROM TIME* OBTIENE INFORMACION SOBRE LA CORRIDA DE LA LINEA DE COMANDO: EL* OBTIENE INFORMACION SOBRE LA CORRIDA DE LA LINEA DE COMANDO: EL
* NOMBRE DEL ARCHIVO DE ENTRADA (QUE CONTIENE EL TIPO DE PROCESO),* NOMBRE DEL ARCHIVO DE ENTRADA (QUE CONTIENE EL TIPO DE PROCESO),
* EL INDICADOR DE PROCESO REAL O EN FALSO (DEFAULT)* EL INDICADOR DE PROCESO REAL O EN FALSO (DEFAULT)ACCEPT P-COMMAND-LINE FROM COMMAND-LINE|ACCEPT P-COMMAND-LINE FROM COMMAND-LINEDISPLAY "PARAMETROS: " P-COMMAND-LINE|DISPLAY "PARAMETROS: " P-COMMAND-LINEUNSTRING P-COMMAND-LINE DELIMITED BY ALL " " INTO|UNSTRING P-COMMAND-LINE DELIMITED BY ALL " " INTOP-FILE-NAME P-PROCESO-REAL|P-FILE-NAME P-PROCESO-REAL* EL PROGRAMA SE ANUNCIA EN LA CONSOLA* EL PROGRAMA SE ANUNCIA EN LA CONSOLA
* TODO: SE USA UN ANUNCIO MAS VISTOSO* TODO: SE USA UN ANUNCIO MAS VISTOSOIF PROCESO-REAL|IF PROCESO-REALDISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO REAL"|DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO REAL"ELSE|ELSEDISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO EN FALSO"|DISPLAY PGM " CARGA DE ARCHIVO JURAD - PROCESO EN FALSO"END-IF|END-IF* EL INDICADOR DE PROCESO REAL DEBE SER S|SI|N|NO|* EL INDICADOR DE PROCESO REAL DEBE SER SI|SI|NO|NOIF P-PROCESO-REAL NOT = "S" AND "N"|IF P-PROCESO-REAL NOT = "SI" AND "NO"DISPLAY "EL INDICADOR DE PROCESO REAL ES INVALIDO"|DISPLAY "EL INDICADOR DE PROCESO REAL ES INVALIDO"DISPLAY "DEBE SER S O N"|DISPLAY "DEBE SER SI O NO"PERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-IF|END-IFEND-IF|END-IF* TODO: CONTROLAR LOS COMPONENTES DEL FILENAME* TODO: CONTROLAR LOS COMPONENTES DEL FILENAMEEVALUATE P-TIPO-PROCESO|EVALUATE P-TIPO-PROCESOWHEN "01"|WHEN "01"DISPLAY "01 ENVIO ORIGINAL - CARGA TOTAL 1A VEZ"|DISPLAY "01 ENVIO ORIGINAL - CARGA TOTAL 1A VEZ"WHEN "02"|WHEN "02"DISPLAY "02 ARCHIVO SEMANAL - CARGA PARCIAL"|DISPLAY "02 ARCHIVO SEMANAL - CARGA PARCIAL"WHEN "03"|WHEN "03"DISPLAY "03 ARCHIVO MENSUAL - CARGA PARCIAL"|DISPLAY "03 ARCHIVO MENSUAL - CARGA PARCIAL"WHEN "04"|WHEN "04"DISPLAY "04 REFRESQUE TOTAL - CARGA TOTAL"|DISPLAY "04 REFRESQUE TOTAL - CARGA TOTAL"WHEN OTHER|WHEN OTHER
*VALOR INVALIDO*VALOR INVALIDODISPLAY "EL TIPO DE PROCESO " P-TIPO-PROCESO|DISPLAY "EL TIPO DE PROCESO " P-TIPO-PROCESO" ES INVALIDO (DEBE SER 01 02 03 O 04)"" ES INVALIDO (DEBE SER 01 02 03 O 04)"PERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-EVALUATE.|END-EVALUATE.* EDITA LA FECHA DE PROCESO DDMMAA DEL PARAMETRO EN FORMATO* EDITA LA FECHA DE PROCESO DDMMAA DEL PARAMETRO EN FORMATO
* YYYYMMDD* YYYYMMDDSTRING "20" P-FECHA-PROCESO(5:6) P-FECHA-PROCESO(3:4)|STRING "20" P-FECHA-PROCESO(5:6) P-FECHA-PROCESO(3:4)P-FECHA-PROCESO(1:2) DELIMITED SIZE|P-FECHA-PROCESO(1:2) DELIMITED SIZEINTO P-FECHA-PROCESO-YYYYMMDD|INTO P-FECHA-PROCESO-YYYYMMDDDISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD|DISPLAY "FECHA DE PROCESO: " P-FECHA-PROCESO-YYYYMMDD* CALCULA UNA FECHA 50 ANIOS POSTERIOR A LA DE PROCESO* CALCULA UNA FECHA 50 ANIOS POSTERIOR A LA DE PROCESOMOVE P-FECHA-PROCESO-YYYYMMDD TO P-FECHA-PROCESO-50|MOVE P-FECHA-PROCESO-YYYYMMDD TO P-FECHA-PROCESO-50ADD 50 TO P-FECHA-PROCESO-50YYYY|ADD 50 TO P-FECHA-PROCESO-50YYYY* APERTURA DEL ARCHIVO DE ENTRADA* APERTURA DEL ARCHIVO DE ENTRADASTRING "$TEMPORALES/" P-FILE-NAME INTO P-FILE-PATH|OPEN INPUT JURADOPEN INPUT JURAD|EVALUATE JURAD-FSEVALUATE JURAD-FS|WHEN "00"WHEN "00"|CONTINUECONTINUE|WHEN OTHERWHEN OTHER|DISPLAY "ERROR EN OPEN DEL ARCHIVO JURAD "DISPLAY "ERROR EN OPEN DEL ARCHIVO JURAD "|DISPLAY "NOMBRE DEL ARCHIVO: " P-FILE-NAMEDISPLAY "PATH DEL ARCHIVO: " P-FILE-PATH|DISPLAY "FILE STATUS: " JURAD-FSDISPLAY "FILE STATUS: " JURAD-FS|PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNAPERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA|GOBACKGOBACK|END-EVALUATE.END-EVALUATE.<* APERTURA DEL ARCHIVO DE ERRORES* APERTURA DEL ARCHIVO DE ERRORESSTRING "$TEMPORALES/" P-FILE-NAME(1:19) "_ERRORES.TXT"|STRING P-FILE-NAME(1:19) "_ERRORES.TXT" INTOINTO ERRS-FILE-NAME|ERRS-FILE-NAMEOPEN OUTPUT ERRS|OPEN OUTPUT ERRSEVALUATE ERRS-FS|EVALUATE ERRS-FSWHEN "00"|WHEN "00"CONTINUE|CONTINUEWHEN OTHER|WHEN OTHERDISPLAY "ERROR EN OPEN DEL ARCHIVO DE ERRORES "|DISPLAY "ERROR EN OPEN DEL ARCHIVO DE ERRORES "DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAME|DISPLAY "NOMBRE DEL ARCHIVO: " ERRS-FILE-NAMEDISPLAY "FILE STATUS: " ERRS-FS|DISPLAY "FILE STATUS: " ERRS-FSPERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA|PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNADISPLAY "FILE STATUS: " ERRS-FS|DISPLAY "FILE STATUS: " ERRS-FSPERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA|PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNAGOBACK|GOBACKEND-EVALUATE.|END-EVALUATE.* APERTURA DE LOS ARCHIVOS MAESTROS* APERTURA DE LOS ARCHIVOS MAESTROS
* TODO: FALTA CAPTURAR EL STATUS DE ESTAS OPERACIONES?* TODO: FALTA CAPTURAR EL STATUS DE ESTAS OPERACIONES?OPEN INPUT BDIIREGI|OPEN INPUT BDIIREGIOPEN INPUT BDIIDIAN|OPEN INPUT BDIIDIANOPEN INPUT BDIIDAS.|OPEN INPUT BDIIDAS.* APERTURA DEL ARCHIVO DE ALERTAS EN LINEA* APERTURA DEL ARCHIVO DE ALERTAS EN LINEAIF PROCESO-REAL|IF PROCESO-REALOPEN I-O BDIIALE|OPEN I-O BDIIALEELSE|ELSEOPEN INPUT BDIIALE|OPEN INPUT BDIIALEEND-IF.|END-IF.* SI ES UN REFRESQUE TOTAL (CODIGO 04) SE ELIMINAN LOS REGISTROS* SI ES UN REFRESQUE TOTAL (CODIGO 04) SE ELIMINAN LOS REGISTROS
* DE JURAD EXISTENTES* DE JURAD EXISTENTESIF P-TIPO-PROCESO = "04" AND PROCESO-REAL|IF P-TIPO-PROCESO = "04" AND PROCESO-REALPERFORM 1001-ELIMINAR-TODO|PERFORM 1001-ELIMINAR-TODOEND-IF.|END-IF.1000-NOT-USED.1000-NOT-USED.
* >>>> ESTO DA UN ERROR DE COMPILACION QUE NO PUEDO RESOLVER* >>>> ESTO DA UN ERROR DE COMPILACION QUE NO PUEDO RESOLVER
* >>>> POR AHORA ESTA ANULADO* >>>> POR AHORA ESTA ANULADO
************************************************************************************************************************************
* CARGA DE LOS TEMPLATES PARA ARMAR EL TEXTO DE ALERTAS* CARGA DE LOS TEMPLATES PARA ARMAR EL TEXTO DE ALERTAS
* TODO: POR AHORA LOS TEMPLATES SON LITERALES* TODO: POR AHORA LOS TEMPLATES SON LITERALESSET LAX TO 0|SET LAX TO 0MOVE HIGH-VALUES TO LA-TEMPLATES|MOVE HIGH-VALUES TO LA-TEMPLATESPERFORM VARYING LAM FROM 1 BY 1|PERFORM VARYING LAM FROM 1 BY 1UNTIL LA-MODELO(LAM) = HIGH-VALUES|UNTIL LA-MODELO(LAM) = HIGH-VALUESSET LAX UP BY 1|SET LAX UP BY 1
*SEPARA LAS PARTES DE LA LINEA*SEPARA LAS PARTES DE LA LINEA
*UNSTRING LA-MODELO(LAM) INTO LA-PARTE(LAX, 1)*UNSTRING LA-MODELO(LAM) INTO LA-PARTE(LAX, 1)
*LA-PARTE(LAX, 2) LA-PARTE(LAX, 3) LA-PARTE(LAX, 4)*LA-PARTE(LAX, 2) LA-PARTE(LAX, 3) LA-PARTE(LAX, 4)
*LA-PARTE(LAX, 5) LA-PARTE(LAX, 6) LA-PARTE(LAX, 7)*LA-PARTE(LAX, 5) LA-PARTE(LAX, 6) LA-PARTE(LAX, 7)
*LA-PARTE(LAX, 8) LA-PARTE(LAX, 9) LA-PARTE(LAX, 10)*LA-PARTE(LAX, 8) LA-PARTE(LAX, 9) LA-PARTE(LAX, 10)
*DELIMITED BY ALL "&"|*DELIMITED BY ALL "&"
*PREPARA PARA OMITIR LOS ESPACIOS AL FINAL DE C/PARTE*PREPARA PARA OMITIR LOS ESPACIOS AL FINAL DE C/PARTEPERFORM VARYING LAY FROM 1 BY 1 UNTIL LAY > 10|PERFORM VARYING LAY FROM 1 BY 1 UNTIL LAY > 10INSPECT LA-PARTE(LAX, LAY) REPLACING TRAILING|INSPECT LA-PARTE(LAX, LAY) REPLACING TRAILINGSPACES BY HIGH-VALUES|SPACES BY HIGH-VALUESINSPECT LA-PARTE(LAX, LAY) REPLACING FIRST|INSPECT LA-PARTE(LAX, LAY) REPLACING FIRSTHIGH-VALUE BY SPACE|HIGH-VALUE BY SPACEEND-PERFORM|END-PERFORMEND-PERFORM.|END-PERFORM.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE* ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE
* ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL* ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL* ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE* ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE* ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL* ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL
************************************************************************************************************************************DISPLAY "ELIMINANDO TODA LA INFORMACION CON FUENTE JURAD"|DISPLAY "ELIMINANDO TODA LA INFORMACION CON FUENTE JURAD"
*    POSICIONA EN EL PRIMER REG DE JURAD*    POSICIONA EN EL PRIMER REG DE JURADMOVE ZERO TO TIP-IDE-BDIIALE|MOVE ZERO TO TIP-IDE-BDIIALEMOVE ZERO TO NUM-IDE-BDIIALE|MOVE ZERO TO NUM-IDE-BDIIALEMOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALE|MOVE P-COD-SUSCRIPTOR TO FUENTE-BDIIALEMOVE ZEROS TO COD-ALERTA-BDIIALE|MOVE ZEROS TO COD-ALERTA-BDIIALEMOVE LOW-VALUES TO LLASEC-BDIIALE|MOVE LOW-VALUES TO LLASEC-BDIIALESTART BDIIALE KEY > LLAVE-BDIIALE INVALID KEY|START BDIIALE KEY > LLAVE-BDIIALE INVALID KEY
*NO HAY REGISTROS*NO HAY REGISTROSEXIT PARAGRAPH|EXIT PARAGRAPH*    LEE SECUENCIALMENTE Y ELIMINA LOS REGISTROS DE JURAD*    LEE SECUENCIALMENTE Y ELIMINA LOS REGISTROS DE JURAD
*    HASTA EL FIN DEL ARCHIVO*    HASTA EL FIN DEL ARCHIVOPERFORM UNTIL EST-BDIIALE NOT = "00"|PERFORM UNTIL EST-BDIIALE NOT = "00"READ BDIIALE NEXT RECORD|READ BDIIALE NEXT RECORDEVALUATE EST-BDIIALE|EVALUATE EST-BDIIALEWHEN "00"|WHEN "00"IF FUENTE-BDIIALE = P-COD-SUSCRIPTOR|IF FUENTE-BDIIALE = P-COD-SUSCRIPTOR
*ES UN ALERTA DE JURAD*ES UN ALERTA DE JURADDELETE BDIIALE|DELETE BDIIALEIF EST-BDIIALE = "00"|IF EST-BDIIALE = "00"ADD 1 TO N-ALE-BORRADAS|ADD 1 TO N-ALE-BORRADASELSE|ELSE
*ERROR EN LA ELIMINACION*ERROR EN LA ELIMINACIONDISPLAY "ERROR AL ELIMINAR UN REGISTRO DE "|DISPLAY "ERROR AL ELIMINAR UN REGISTRO DE ""BDIIALE VACIANDO LOS DATOS""BDIIALE VACIANDO LOS DATOS"DISPLAY "CLAVE: " LLAVE-BDIIALE|DISPLAY "CLAVE: " LLAVE-BDIIALEDISPLAY "REG BORRADOS: " N-ALE-BORRADAS|DISPLAY "REG BORRADOS: " N-ALE-BORRADASPERFORM 9000-CANCELAR-PROGRAMA|PERFORM 9000-CANCELAR-PROGRAMAEND-IF|END-IFEND-IF|END-IFWHEN "10"|WHEN "10"
*FIN DE ARCHIVO: SALE NORMALMENTE*FIN DE ARCHIVO: SALE NORMALMENTECONTINUE|CONTINUEWHEN OTHER|WHEN OTHER
*LECTURA ANORMAL: CANCELACION DEL PROGRAMA*LECTURA ANORMAL: CANCELACION DEL PROGRAMADISPLAY "ERROR EN LECTURA DEL ARCHIVO DE ALERTAS "|DISPLAY "ERROR EN LECTURA DEL ARCHIVO DE ALERTAS ""ONLINE""ONLINE"DISPLAY "FILE STATUS: " EST-BDIIALE|DISPLAY "FILE STATUS: " EST-BDIIALEPERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNA|PERFORM 9000-CANCELAR-PROGRAMA *> NO RETORNAEND-EVALUATE|END-EVALUATEEND-PERFORM.|END-PERFORM.DISPLAY "TERMINO LA ELIMINACION TOTAL DE JURAD"|DISPLAY "TERMINO LA ELIMINACION TOTAL DE JURAD"DISPLAY "REG BORRADOS: " N-ALE-BORRADAS.|DISPLAY "REG BORRADOS: " N-ALE-BORRADAS.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* REGISTRA HORA DE FINALIZACION* REGISTRA HORA DE FINALIZACIONACCEPT W-HORA-FIN FROM TIME|ACCEPT W-HORA-FIN FROM TIME* LEER JURAD A VER SI HAY REGISTROS DESPUES DEL "T"|* LEER JURAD A VER SI HAY REGISTROS DESPUES DEL "T":g/|/dLINKAGE SECTION.LINKAGE SECTION.************************************************************************************************************************************
* CODIGO DEL ERROR DETECTADO* CODIGO DEL ERROR DETECTADO
************************************************************************************************************************************
* REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)* REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)
************************************************************************************************************************************
* TABLA DE ERRORES DE CONSISTENCIA DEL INPUT* TABLA DE ERRORES DE CONSISTENCIA DEL INPUT
*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR
*    ERRORES DEL REGISTRO ACTUAL*    ERRORES DEL REGISTRO ACTUAL
*    CONTADOR DE REGISTROS CON ERROR*    CONTADOR DE REGISTROS CON ERROR
*    TABLA DE ERRORES*    TABLA DE ERRORES************************************************************************************************************************************00.00.
*    MARCA AL REG ACTUAL COMO ERRONEO*    MARCA AL REG ACTUAL COMO ERRONEO*    CUENTA Y MUESTRA EL REGISTRO DE INPUT*    CUENTA Y MUESTRA EL REGISTRO DE INPUTEND-IF<*    CONTABILIZA EL ERROR EN LA TABLA DE ERRORES*    CONTABILIZA EL ERROR EN LA TABLA DE ERRORES*    AGREGA A LA LISTA DE ERRORES DEL REGISTRO*    AGREGA A LA LISTA DE ERRORES DEL REGISTRO************************************************************************************************************************************
************************************************************************************************************************************

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
662 fewer lines$SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.PROGRAM-ID.    ACTALEJUR.
************************************************************************************************************************************
* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS
* POR JURAD* POR JURAD
* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA
* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN
* EL ARCHIVO ERRS.* EL ARCHIVO ERRS.
************************************************************************************************************************************
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************
>* TODO: DEBE COMPILAR CON FILE STATUS************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.************************************************************************************************************************************
* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
* REGISTROS DE MOVIMIENTOS I, M, E* REGISTROS DE MOVIMIENTOS I, M, E
*    TIPO DE NOVEDAD {I, M, E} INSER/MODIF/ELIM*    TIPO DE NOVEDAD {I, M, E} INSER/MODIF/ELIM
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACION
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOS
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTES
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADAS
*    FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTES
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOS
*    FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD* REGISTRO DE TOTALES DE CONTROL T* REGISTRO DE TOTALES DE CONTROL T
*    CANTIDAD DE REGISTROS*    CANTIDAD DE REGISTROS
*    TOTAL NUMERO DE DEMANDAS VIGENTES*    TOTAL NUMERO DE DEMANDAS VIGENTES"CARGAJUR.CBL.diff" [Modified] line 1 of 574 --0%-- 
23 of 574 --4%-- :eset rulerruler: No such option - 'set all' gives all option values:set allnoautoindentnomodelinesshowmodeautoprintnonumbernoslowopennoautowritenonovicetabstop=4nobeautifynooptimizetaglength=0directory=/var/tmpparagraphs=IPLPPPQPP LIpplpipnppplpipbptags=tags /usr/lib/tagsnoedcompatibleprompttagstacknoerrorbellsnoreadonlyterm=vt220noexrcredrawnoterseflashremaptimeouthardtabs=8report=5ttytype=vt220ignorecasescroll=28warnnolispsections=NHSHH HUuhsh+cwindow=56nolistshell=/bin/kshnowrapscanmagicshiftwidth=4wrapmargin=0mesgshowmatchnowriteany[Hit return to continue] $SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.PROGRAM-ID.    ACTALEJUR.
************************************************************************************************************************************
* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS* ACTUALIZACION DEL ARCHIVO DE ALERTAS CON LOS DATOS PROVISTOS
* POR JURAD* POR JURAD
* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA* PROCESA EL ARCHIVO JURAD. CONTROLA CADA REGISTRO: SI ES OK USA
* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN* LOS DATOS PARA ACTUALIZAR BDIIALE, SI TIENE DEFECTO LO GRABA EN
* EL ARCHIVO ERRS.* EL ARCHIVO ERRS.
************************************************************************************************************************************
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************
>* TODO: DEBE COMPILAR CON FILE STATUS************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.************************************************************************************************************************************
* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD* ARCHIVO DE ENTRADA CON LOS DATOS DE DEMANDAS Y EMBARGOS DE JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
* REGISTROS DE MOVIMIENTOS I, M, E* REGISTROS DE MOVIMIENTOS I, M, E
*    TIPO DE NOVEDAD {I, M, E} INSER/MODIF/ELIM*    TIPO DE NOVEDAD {I, M, E} INSER/MODIF/ELIM
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACION
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOS
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTES
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADAS
*    FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTES
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOS
*    FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD* REGISTRO DE TOTALES DE CONTROL T* REGISTRO DE TOTALES DE CONTROL T
*    CANTIDAD DE REGISTROS*    CANTIDAD DE REGISTROS
*    TOTAL NUMERO DE DEMANDAS VIGENTES*    TOTAL NUMERO DE DEMANDAS VIGENTES$CHANGE MODE::set terse*    CANTIDAD DE REGISTROS*    CANTIDAD DE REGISTROS*    TOTAL NUMERO DE DEMANDAS VIGENTES*    TOTAL NUMERO DE DEMANDAS VIGENTES
*    TOTAL NUMERO DE DEMANDAS TERMINADAS*    TOTAL NUMERO DE DEMANDAS TERMINADAS
*    TOTAL NUMERO DE EMBARGOS VIGENTES*    TOTAL NUMERO DE EMBARGOS VIGENTES
*    TOTAL NUMERO DE EMBARGOS TERMINADOS*    TOTAL NUMERO DE EMBARGOS TERMINADOS************************************************************************************************************************************
* ARCHIVO DE SALIDA CON LOS REGISTROS DEFECTUOSOS DEL ARCH JURAD* ARCHIVO DE SALIDA CON LOS REGISTROS DEFECTUOSOS DEL ARCH JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
*    TIPO DE NOVEDAD {I, M, E, T} INSER/MODIF/ELIM/TOTALES*    TIPO DE NOVEDAD {I, M, E, T} INSER/MODIF/ELIM/TOTALES
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACION
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOS
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTES
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADAS
*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTES
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOS
*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD
*    CAUSA DEL RECHAZO*    CAUSA DEL RECHAZO************************************************************************************************************************************
* CONTIENE LOS IDS Y NOMBRES DE PERSONAS* CONTIENE LOS IDS Y NOMBRES DE PERSONAS
************************************************************************************************************************************************************************************************************************************************************************
* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADA* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADA
* POR LA DIAN* POR LA DIAN
************************************************************************************************************************************************************************************************************************************************************************
* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA SUMINISTRADO POR DAS* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA SUMINISTRADO POR DAS
************************************************************************************************************************************************************************************************************************************************************************
* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTORES* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTORES
************************************************************************************************************************************************************************************************************************************************************************
************************************************************************************************************************************
* NOMBRE DEL PROGRAMA* NOMBRE DEL PROGRAMA************************************************************************************************************************************
* VARIABLES PARA RUTINA DE VALIDACION DE IDENTIFICACIONES* VARIABLES PARA RUTINA DE VALIDACION DE IDENTIFICACIONES
************************************************************************************************************************************************************************************************************************************************************************
* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA
************************************************************************************************************************************************************************************************************************************************************************
* DATOS PARA LAS RUTINAS DE VALIDACION DE NOMBRES DE VALNOM.PROC* DATOS PARA LAS RUTINAS DE VALIDACION DE NOMBRES DE VALNOM.PROC
**********************************************************************************************************************************************************************************************************************************************************************
**********************************************************************************************************************************
* DIRECCIONES DE LOS ARCHIVOS EN EL FILE SYSTEM* DIRECCIONES DE LOS ARCHIVOS EN EL FILE SYSTEM
**********************************************************************************************************************************************************************************************************************************************************************
* INDICA QUE SE TERMINO EL PROCESO, POR AGOTAMIENTO DEL ARCHIVO* INDICA QUE SE TERMINO EL PROCESO, POR AGOTAMIENTO DEL ARCHIVO
* DE ENTRADA (NORMAL) O ALGUNA OTRA CONDICION (ERROR)* DE ENTRADA (NORMAL) O ALGUNA OTRA CONDICION (ERROR)* COPIA DEL ULTIMO REG DE INPUT, PARA MENSAJES (ULT REG: ...)* COPIA DEL ULTIMO REG DE INPUT, PARA MENSAJES (ULT REG: ...)* DATOS DE DEMANDAS O EMBARGOS QUE VAN EN EL REGISTRO BDIIALE* DATOS DE DEMANDAS O EMBARGOS QUE VAN EN EL REGISTRO BDIIALE
************************************************************************************************************************************
* PARAMETROS INICIALES, DE LA LINEA DE COMANDO* PARAMETROS INICIALES, DE LA LINEA DE COMANDO
* LA LINEA DE COMANDO QUE CONTIENE LOS PARAMETROS* LA LINEA DE COMANDO QUE CONTIENE LOS PARAMETROS*    NOMBRE DEL ARCHIVO DE ENTRADA JJJJJJAAADDMMAABBXX.TXT*    NOMBRE DEL ARCHIVO DE ENTRADA JJJJJJAAADDMMAABBXX.TXT
*JJJJJJ = CODIGO DE SUSCRIPTOR JURAD EN EXPERIAN*JJJJJJ = CODIGO DE SUSCRIPTOR JURAD EN EXPERIAN
*DDMMAA = FECHA DE PROCESO*DDMMAA = FECHA DE PROCESO
*BB =  01 A CI*BB =  01 A CI
*XX = TIPO DE PROCESO*XX = TIPO DE PROCESO
*01 ENVIO ORIGINAL - CARGA TOTAL - PRIMERA VEZ*01 ENVIO ORIGINAL - CARGA TOTAL - PRIMERA VEZ
*02 ARCHIVO SEMANAL - CARGA PARCIAL*02 ARCHIVO SEMANAL - CARGA PARCIAL
*03 ARCHIVO MENSUAL - CARGA PARCIAL*03 ARCHIVO MENSUAL - CARGA PARCIAL
*04 REFRESQUE TOTAL - CARGA TOTAL*04 REFRESQUE TOTAL - CARGA TOTAL03 P-FILE-PATHPIC X(80) VALUE SPACES.<
* NOMBRE DEL ARCHIVO DE ERRORES JJJJJJAAADDMMAABBXX_ERRORES.TXT* NOMBRE DEL ARCHIVO DE ERRORES JJJJJJAAADDMMAABBXX_ERRORES.TXT* FECHA DE PROCESO EDITADA YYYYMMDD* FECHA DE PROCESO EDITADA YYYYMMDD
* FECHA DE PROCESO + 50 AÃ±OS* FECHA DE PROCESO + 50 AÃ±OS
************************************************************************************************************************************
* DATOS PARA EL REPORTE FINAL* DATOS PARA EL REPORTE FINAL
*    REGISTROS EN EL ARCHIVO DE ENTRADA*    REGISTROS EN EL ARCHIVO DE ENTRADA
*    REGISTROS PROCESADOS SIN ERROR*    REGISTROS PROCESADOS SIN ERROR
*    REGISTROS CON ERROR*    REGISTROS CON ERROR*    CANTIDADES DE REGISTROS POR TIPO DE NOVEDAD*    CANTIDADES DE REGISTROS POR TIPO DE NOVEDAD*    ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL*    ALERTAS BORRADAS PREVIO AL REFRESQUE TOTAL
*    ALERTAS INSERTADAS*    ALERTAS INSERTADAS
*    ALERTAS MODIFICADAS*    ALERTAS MODIFICADAS
*    ALERTAS ELIMINADAS*    ALERTAS ELIMINADAS
*    INSERCION DE ALERTA EXISTENTE*    INSERCION DE ALERTA EXISTENTE
*    MODIFICACION O ELIMINACION DE ALERTA INEXISTENTE*    MODIFICACION O ELIMINACION DE ALERTA INEXISTENTE************************************************************************************************************************************
* ARMADO DE LAS LINEAS DE ALERTA* ARMADO DE LAS LINEAS DE ALERTA
*    LOS MODELOS A CONTINUACION DEBERAN OBTENERSE DE UN*    LOS MODELOS A CONTINUACION DEBERAN OBTENERSE DE UN
*    ARCHIVO, COMO BDIIALE-ALERTAS*    ARCHIVO, COMO BDIIALE-ALERTAS
*12345678901234567890123456789012345678901234567890*12345678901234567890123456789012345678901234567890"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
*    FUNCIONAMIENTO DE LOS TEMPLATES.*    FUNCIONAMIENTO DE LOS TEMPLATES."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".*    FUNCIONAMIENTO DE LOS TEMPLATES.*    FUNCIONAMIENTO DE LOS TEMPLATES.
*    HAY DOS TEMPLATES POR DE ALERTA, UNO POR LINEA.*    HAY DOS TEMPLATES POR DE ALERTA, UNO POR LINEA.
*    CADA TEMPLATE CONSISTE EN HASTA 10 FRASES FIJAS CON*    CADA TEMPLATE CONSISTE EN HASTA 10 FRASES FIJAS CON
*    AMPERSANDS (&) DONDE SE VAN A REEMPLAZAR LOS VALORES.*    AMPERSANDS (&) DONDE SE VAN A REEMPLAZAR LOS VALORES.
*    POR EJEMPLO:*    POR EJEMPLO:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    TIENE 3 FRASES FIJAS Y 2 REEMPLAZOS.*    TIENE 3 FRASES FIJAS Y 2 REEMPLAZOS.
*    LA CANTIDAD DE AMPERSANDS ES IRRELEVANTE, PERO PARECE*    LA CANTIDAD DE AMPERSANDS ES IRRELEVANTE, PERO PARECE
*    CONVENIENTE QUE INFORME SOBRE EL TAMANIO DEL CONTENIDO.*    CONVENIENTE QUE INFORME SOBRE EL TAMANIO DEL CONTENIDO.
*    LAS DOS LINEAS ARMADAS*    LAS DOS LINEAS ARMADAS
*    LOS VALORES A INSERTAR EN UNA LINEA*    LOS VALORES A INSERTAR EN UNA LINEA
*    DATOS PARA EDITAR VALORES A INSERTAR*    DATOS PARA EDITAR VALORES A INSERTAR************************************************************************************************************************************
* ERRORES DE CONSISTENCIA DEL INPUT* ERRORES DE CONSISTENCIA DEL INPUT
* CADA ERROR TIENE UN CODIGO DE 2 DIGITOS, UN ESPACIO, CONTADOR* CADA ERROR TIENE UN CODIGO DE 2 DIGITOS, UN ESPACIO, CONTADOR
* DE OCURRENCIAS DE 7 DIGITOS, UN ESPACIO, Y DESCRIPCION DE 59* DE OCURRENCIAS DE 7 DIGITOS, UN ESPACIO, Y DESCRIPCION DE 59
*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR
*    ERRORES DEL REGISTRO ACTUAL*    ERRORES DEL REGISTRO ACTUAL
*    CONTADOR DE REGISTROS CON ERROR*    CONTADOR DE REGISTROS CON ERROR
*    TABLA DE ERRORES*    TABLA DE ERRORES"TIPO DE MOVIMIENTO INVALIDO, DEBE SER I M E T"."TIPO DE MOVIMIENTO INVALIDO, DEBE SER I M E T"."TIPO DE IDENTIFICACION INVALIDO, DEBE SER 1 2 3 4"."TIPO DE IDENTIFICACION INVALIDO, DEBE SER 1 2 3 4"."NUMERO DE IDENTIFICACION INVALIDO, DEBE SER NUMERICO"."NUMERO DE IDENTIFICACION INVALIDO, DEBE SER NUMERICO"."TIPO DE IDENTIFICACION DEBE SER MAYOR QUE CERO"."TIPO DE IDENTIFICACION DEBE SER MAYOR QUE CERO"."FALTA EL NOMBRE O DENOMINACION"."FALTA EL NOMBRE O DENOMINACION"."NUMERO DE DEMANDAS VIGENTES: DEBE SER NUMERICO"."NUMERO DE DEMANDAS VIGENTES: DEBE SER NUMERICO"."NUMERO DE DEMANDAS TERMINADAS: DEBE SER NUMERICO"."NUMERO DE DEMANDAS TERMINADAS: DEBE SER NUMERICO"."FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD: DEBE SER NUMERICA"."FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD: DEBE SER NUMERICA"."FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD: FUERA DE RANGO"."FECHA ULTIMA DEMANDA VIGENTE YYYYMMDD: FUERA DE RANGO"."NUMERO DE EMBARGOS VIGENTES: DEBE SER NUMERICO"."NUMERO DE EMBARGOS VIGENTES: DEBE SER NUMERICO"."NUMERO DE EMBARGOS TERMINADOS: DEBE SER NUMERICO"."NUMERO DE EMBARGOS TERMINADOS: DEBE SER NUMERICO"."FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD: DEBE SER NUMERICA"."FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD: DEBE SER NUMERICA"."FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD: FUERA DE RANGO"."FECHA ULTIMO EMBARGO VIGENTE YYYYMMDD: FUERA DE RANGO"."EL NUMERO DE ID NO SE ENCUENTRA EN EL ARCHIVO MAESTRO"."EL NUMERO DE ID NO SE ENCUENTRA EN EL ARCHIVO MAESTRO"."EL NOMBRE EN EL INPUT NO COINCIDE CON EL REGISTRADO"."EL NOMBRE EN EL INPUT NO COINCIDE CON EL REGISTRADO"."NUMERO DE ID FUERA DEL RANGO DEL TIPO DE ID INFORMADO"."NUMERO DE ID FUERA DEL RANGO DEL TIPO DE ID INFORMADO".
*----------------- INSERTAR NUEVOS ITEMS AQUI -------------------*----------------- INSERTAR NUEVOS ITEMS AQUI -------------------************************************************************************************************************************************
* CONTROL DE RANGOS DE VALORES DE LAS FECHAS DEL INPUT* CONTROL DE RANGOS DE VALORES DE LAS FECHAS DEL INPUT
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.
*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    INICIALIZA EL AMBIENTE Y ABRE LOS ARCHIVOS*    INICIALIZA EL AMBIENTE Y ABRE LOS ARCHIVOS
*    PROCESA CADA UNO DE LOS REGISTROS DEL ARCHIVO JURAD HASTA*    PROCESA CADA UNO DE LOS REGISTROS DEL ARCHIVO JURAD HASTA
*    CIERRA ARCHIVOS Y PRODUCE EL REPORTE FINAL*    CIERRA ARCHIVOS Y PRODUCE EL REPORTE FINAL4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* PROCESO DE UN REGISTRO DEL ARCHIVO DE ENTRADA JURAD* PROCESO DE UN REGISTRO DEL ARCHIVO DE ENTRADA JURAD
* LECTURA Y CONTROL DEL FILE STATUS DEL ARCHIVO* LECTURA Y CONTROL DEL FILE STATUS DEL ARCHIVO
********************************************************************************************************************************
*    LECTURA DEL PROXIMO REGISTRO*    LECTURA DEL PROXIMO REGISTRO
*CONTROLA EL REG Y LO APLICA SI ES OK*CONTROLA EL REG Y LO APLICA SI ES OK
*FIN DEL ARCHIVO DE INPUT:*FIN DEL ARCHIVO DE INPUT:
*DE QUE SE TERMINARA EL ARCHIVO*DE QUE SE TERMINARA EL ARCHIVO
*ERROR DE LECTURA: CANCELACION DEL PROCESO*ERROR DE LECTURA: CANCELACION DEL PROCESO4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* CONTROLA LOS DATOS DE UN REGISTRO DE JURAD Y SI ES OK LO USA* CONTROLA LOS DATOS DE UN REGISTRO DE JURAD Y SI ES OK LO USA
* PARA ACTUALIZAR EL ARCHIVO DE ALERTAS EN LINEA* PARA ACTUALIZAR EL ARCHIVO DE ALERTAS EN LINEA
* LA INFORMACION ESTA LEIDA EN JURAD-REG* LA INFORMACION ESTA LEIDA EN JURAD-REG
*********************************************************************************************************************************    VALIDACION DEL TIPO DE MOVIMIENTO*    VALIDACION DEL TIPO DE MOVIMIENTO*    VALIDACION FORMAL DE LOS DATOS*    VALIDACION FORMAL DE LOS DATOSEND-IF<*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICA*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICAEND-IF<

>ADD 1 TO N-REG-CON-ERROR
>ELSE
>PERFORM 4300-MODIFICAR-BDIIALE
>ADD 1 TO N-REG-OK
>END-IF.*    VALIDACION DEL TIPO DE MOVIMIENTO*    VALIDACION DEL TIPO DE MOVIMIENTO*    VALIDACION FORMAL DE LOS DATOS*    VALIDACION FORMAL DE LOS DATOSEND-IF<*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICA*    SI LA VALIDACION FORMAL DIO OK SE HACE VALIDACION SEMANTICAEND-IF<

>ADD 1 TO N-REG-CON-ERROR
>ELSE
>PERFORM 4300-MODIFICAR-BDIIALE
>ADD 1 TO N-REG-OK
>END-IF.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* VALIDACION FORMAL DE LOS DATOS DEL INPUT* VALIDACION FORMAL DE LOS DATOS DEL INPUT
************************************************************************************************************************************
*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}*    TIPO DE IDENTIFICACION NUMERO {1, 2, 3, 4}
*    NUMERO DE IDENTIFICACION*    NUMERO DE IDENTIFICACION
*    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES*    SI EL MOVIMIENTO ES UNA ELIMINACION LOS DATOS SUBSIGUIENTES
*    NO SE CONTROLAN*    NO SE CONTROLAN
*    NOMBRES Y APELLIDOS*    NOMBRES Y APELLIDOS
*    NUMERO DE DEMANDAS VIGENTES*    NUMERO DE DEMANDAS VIGENTES
*    NUMERO DE DEMANDAS TERMINADAS*    NUMERO DE DEMANDAS TERMINADAS
*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD*    FECHA ULTIMA DEMANDA VIGENTE YYMMDD
*    NUMERO DE EMBARGOS VIGENTES*    NUMERO DE EMBARGOS VIGENTES
*    NUMERO DE EMBARGOS TERMINADOS*    NUMERO DE EMBARGOS TERMINADOS
*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD*    FECHA ULTIMO EMBARGO VIGENTE YYMMDD4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON* VALIDACION DEL NUMERO DE IDENTIFICACION Y DE SU RELACION CON
* EL NOMBRE* EL NOMBRE
********************************************************************************************************************************
*    A VER SI LA VALIDACION CAMBIO EL TIPO DE IDE*    A VER SI LA VALIDACION CAMBIO EL TIPO DE IDE
*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE*    SW-ID-BDIIVIDE: 0 SI EXISTE EL ID, 1 SI NO EXISTE
*EXISTE ID, A VER SI EL NOMBRE COINCIDE*EXISTE ID, A VER SI EL NOMBRE COINCIDE4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* SE IMPACTA EL ARCHIVO BDIIALE CON UNA O DOS INSERCIONES,* SE IMPACTA EL ARCHIVO BDIIALE CON UNA O DOS INSERCIONES,
* MODIFICACIONES O ELIMINACIONES SEGUN HAYA O NO DEMANDAS Y* MODIFICACIONES O ELIMINACIONES SEGUN HAYA O NO DEMANDAS Y
* EMBARGOS* EMBARGOS
*************************************************************************************************************************************    SI HAY DEMANDAS*    SI HAY DEMANDAS
*ARMA DATOS DE DEMANDAS*ARMA DATOS DE DEMANDAS*    SI HAY EMBARGOS*    SI HAY EMBARGOS
*    SI HAY EMBARGOS*    SI HAY EMBARGOS
*ARMA DATOS DE EMBARGOS*ARMA DATOS DE EMBARGOS4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* PARTE DE LA CARGA DE DATOS EN EL REGISTRO BDIIALE Y GRABACION* PARTE DE LA CARGA DE DATOS EN EL REGISTRO BDIIALE Y GRABACION
* DEL MISMO QUE ES COMUN A DEMANDAS Y EMBARGOS* DEL MISMO QUE ES COMUN A DEMANDAS Y EMBARGOS
************************************************************************************************************************************
*    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK*    COMPLETA LA CLAVE E INTENTA LEER LA ALERTA, SI SE LEYO OK*    PROCESA SEGUN EL TIPO DE NOVEDAD I M E*    PROCESA SEGUN EL TIPO DE NOVEDAD I M E4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* INSERCION DE UNA ALERTA NUEVA* INSERCION DE UNA ALERTA NUEVA
* SI YA EXISTIA MUESTRA UN MENSAJE Y CONTINUA* SI YA EXISTIA MUESTRA UN MENSAJE Y CONTINUA
************************************************************************************************************************************
*    SI EL REGISTRO EXISTIA ES UN ERROR*    SI EL REGISTRO EXISTIA ES UN ERROR" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALE*    COMPLETA LOS DATOS DEL REGISTRO*    COMPLETA LOS DATOS DEL REGISTROFEC-REP-BDIIALEFEC-REP-BDIIALE4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* MODIFICACION DE UNA ALERTA EXISTENTE* MODIFICACION DE UNA ALERTA EXISTENTE
* SI NO EXISTIA MUESTRA UN MENSAJE Y CONTINUA* SI NO EXISTIA MUESTRA UN MENSAJE Y CONTINUA
************************************************************************************************************************************
*    SI EL REGISTRO NO EXISTIA ES UN ERROR*    SI EL REGISTRO NO EXISTIA ES UN ERROR" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALE
*    REEMPLAZA LA FECHA DE REPORTE Y LOS VALORES*    REEMPLAZA LA FECHA DE REPORTE Y LOS VALORES4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* ELIMINACION DE UNA ALERTA* ELIMINACION DE UNA ALERTA
* SI NO EXISTIA MUESTRA UN MENSAJE Y CONTINUA* SI NO EXISTIA MUESTRA UN MENSAJE Y CONTINUA
************************************************************************************************************************************
*    ELIMINA EL REGISTRO*    ELIMINA EL REGISTRO" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALE4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* ARMA CLAVE EXACTA Y LEE UN REGISTRO DE BDIIALE* ARMA CLAVE EXACTA Y LEE UN REGISTRO DE BDIIALE
* USA LOS DATOS DEL REG INPUT, EXCEPTO LLASEC QUE ESTA PRECARGADO* USA LOS DATOS DEL REG INPUT, EXCEPTO LLASEC QUE ESTA PRECARGADO
************************************************************************************************************************************" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALE

4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* INSERTA UN REGISTRO NUEVO EN BDIIALE* INSERTA UN REGISTRO NUEVO EN BDIIALE
************************************************************************************************************************************" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALE4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* REGRABA UN REGISTRO MODIFICADO EN BDIIALE* REGRABA UN REGISTRO MODIFICADO EN BDIIALE
************************************************************************************************************************************" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALE4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* ELIMINA UN REGISTRO DE BDIIALE* ELIMINA UN REGISTRO DE BDIIALE
************************************************************************************************************************************" KEY: " LLAVE-BDIIALE" KEY: " LLAVE-BDIIALE4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* EL REGISTRO DE JURAD TIENE ERROR: SE GRABA EN EL ARCHIVO ERRS* EL REGISTRO DE JURAD TIENE ERROR: SE GRABA EN EL ARCHIVO ERRS
* CON INDICACION DEL ERROR DETECTADO* CON INDICACION DEL ERROR DETECTADO
************************************************************************************************************************************
*    LISTA DE LOS CODIGOS DE LOS ERRORES DEL REGISTRO*    LISTA DE LOS CODIGOS DE LOS ERRORES DEL REGISTROEND-EVALUATE.<4320-ARMAR-TEXTO-ALERTA.4320-ARMAR-TEXTO-ALERTA.
********************************************************************************************************************************
* HACE EL REEMPLAZO DE LOS VALORES ADECUADOS EN LOS TEMPLATES* HACE EL REEMPLAZO DE LOS VALORES ADECUADOS EN LOS TEMPLATES
* DE LAS LINEA DE ALERTA QUE CORRESPONDE* DE LAS LINEA DE ALERTA QUE CORRESPONDE
********************************************************************************************************************************
*    SEGUN SE TRATE DE DEMANDAS O EMBARGOS*    SEGUN SE TRATE DE DEMANDAS O EMBARGOS
* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE
*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(1)*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(1)
*DELIMITED BY ALL SPACE*DELIMITED BY ALL SPACE
* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE
*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(2)*UNSTRING LA-NUMX INTO LA-DESCARTE LA-VALOR(2)
*DELIMITED BY ALL SPACE*DELIMITED BY ALL SPACE* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE* >>>> ESTO ESTA ANULADO X QUE NO SE COMO HACER PARA QUE LO COMPILE
* >>>> DA ERROR EN EL END-IF* >>>> DA ERROR EN EL END-IF
*STRING LA-PARTE(LAX, 1) LA-VALOR(1)*STRING LA-PARTE(LAX, 1) LA-VALOR(1)
*LA-PARTE(LAX, 2) LA-VALOR(2) LA-PARTE(LAX, 3) LA-VALOR(3)*LA-PARTE(LAX, 2) LA-VALOR(2) LA-PARTE(LAX, 3) LA-VALOR(3)
*LA-PARTE(LAX, 4) LA-VALOR(4) LA-PARTE(LAX, 5) LA-VALOR(5)*LA-PARTE(LAX, 4) LA-VALOR(4) LA-PARTE(LAX, 5) LA-VALOR(5)
*LA-PARTE(LAX, 6) LA-VALOR(6) LA-PARTE(LAX, 7) LA-VALOR(7)*LA-PARTE(LAX, 6) LA-VALOR(6) LA-PARTE(LAX, 7) LA-VALOR(7)
*LA-PARTE(LAX, 8) LA-VALOR(8) LA-PARTE(LAX, 9) LA-VALOR(9)*LA-PARTE(LAX, 8) LA-VALOR(8) LA-PARTE(LAX, 9) LA-VALOR(9)
*LA-PARTE(LAX, 10) LA-VALOR(10)*LA-PARTE(LAX, 10) LA-VALOR(10)
*DELIMITED BY HIGH-VALUE*DELIMITED BY HIGH-VALUE

1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* TODAS LAS OPERACIONES QUE SE REALIZAN UNA SOLA VEZ, AL COMIENZO* TODAS LAS OPERACIONES QUE SE REALIZAN UNA SOLA VEZ, AL COMIENZO
* DEL PROGRAMA:* DEL PROGRAMA:
*   - OBTENCION DE LOS PARAMETROS*   - OBTENCION DE LOS PARAMETROS
*   - APERTURA DEL ARCHIVO DE ENTRADA*   - APERTURA DEL ARCHIVO DE ENTRADA
*   - APERTURA DE TODOS LOS DEMAS ARCHIVOS*   - APERTURA DE TODOS LOS DEMAS ARCHIVOS
*   - ELIMINACION DE DATOS EXISTENTES SI ES REFRESQUE COMPLETO*   - ELIMINACION DE DATOS EXISTENTES SI ES REFRESQUE COMPLETO
************************************************************************************************************************************
* REGISTRA HORA DE INICIO* REGISTRA HORA DE INICIO* OBTIENE INFORMACION SOBRE LA CORRIDA DE LA LINEA DE COMANDO: EL* OBTIENE INFORMACION SOBRE LA CORRIDA DE LA LINEA DE COMANDO: EL
* NOMBRE DEL ARCHIVO DE ENTRADA (QUE CONTIENE EL TIPO DE PROCESO),* NOMBRE DEL ARCHIVO DE ENTRADA (QUE CONTIENE EL TIPO DE PROCESO),
* EL INDICADOR DE PROCESO REAL O EN FALSO (DEFAULT)* EL INDICADOR DE PROCESO REAL O EN FALSO (DEFAULT)* EL PROGRAMA SE ANUNCIA EN LA CONSOLA* EL PROGRAMA SE ANUNCIA EN LA CONSOLA
* TODO: SE USA UN ANUNCIO MAS VISTOSO* TODO: SE USA UN ANUNCIO MAS VISTOSO* TODO: CONTROLAR LOS COMPONENTES DEL FILENAME* TODO: CONTROLAR LOS COMPONENTES DEL FILENAME
*VALOR INVALIDO*VALOR INVALIDO" ES INVALIDO (DEBE SER 01 02 03 O 04)"" ES INVALIDO (DEBE SER 01 02 03 O 04)"* EDITA LA FECHA DE PROCESO DDMMAA DEL PARAMETRO EN FORMATO* EDITA LA FECHA DE PROCESO DDMMAA DEL PARAMETRO EN FORMATO
* YYYYMMDD* YYYYMMDD* CALCULA UNA FECHA 50 ANIOS POSTERIOR A LA DE PROCESO* CALCULA UNA FECHA 50 ANIOS POSTERIOR A LA DE PROCESO* APERTURA DEL ARCHIVO DE ENTRADA* APERTURA DEL ARCHIVO DE ENTRADAEND-EVALUATE.<* APERTURA DEL ARCHIVO DE ERRORES* APERTURA DEL ARCHIVO DE ERRORES* APERTURA DE LOS ARCHIVOS MAESTROS* APERTURA DE LOS ARCHIVOS MAESTROS
* TODO: FALTA CAPTURAR EL STATUS DE ESTAS OPERACIONES?* TODO: FALTA CAPTURAR EL STATUS DE ESTAS OPERACIONES?* APERTURA DEL ARCHIVO DE ALERTAS EN LINEA* APERTURA DEL ARCHIVO DE ALERTAS EN LINEA* SI ES UN REFRESQUE TOTAL (CODIGO 04) SE ELIMINAN LOS REGISTROS* SI ES UN REFRESQUE TOTAL (CODIGO 04) SE ELIMINAN LOS REGISTROS
* DE JURAD EXISTENTES* DE JURAD EXISTENTES1000-NOT-USED.1000-NOT-USED.
* >>>> ESTO DA UN ERROR DE COMPILACION QUE NO PUEDO RESOLVER* >>>> ESTO DA UN ERROR DE COMPILACION QUE NO PUEDO RESOLVER
* >>>> POR AHORA ESTA ANULADO* >>>> POR AHORA ESTA ANULADO
************************************************************************************************************************************
* CARGA DE LOS TEMPLATES PARA ARMAR EL TEXTO DE ALERTAS* CARGA DE LOS TEMPLATES PARA ARMAR EL TEXTO DE ALERTAS
* TODO: POR AHORA LOS TEMPLATES SON LITERALES* TODO: POR AHORA LOS TEMPLATES SON LITERALES
*SEPARA LAS PARTES DE LA LINEA*SEPARA LAS PARTES DE LA LINEA
*UNSTRING LA-MODELO(LAM) INTO LA-PARTE(LAX, 1)*UNSTRING LA-MODELO(LAM) INTO LA-PARTE(LAX, 1)
*LA-PARTE(LAX, 2) LA-PARTE(LAX, 3) LA-PARTE(LAX, 4)*LA-PARTE(LAX, 2) LA-PARTE(LAX, 3) LA-PARTE(LAX, 4)
*LA-PARTE(LAX, 5) LA-PARTE(LAX, 6) LA-PARTE(LAX, 7)*LA-PARTE(LAX, 5) LA-PARTE(LAX, 6) LA-PARTE(LAX, 7)
*LA-PARTE(LAX, 8) LA-PARTE(LAX, 9) LA-PARTE(LAX, 10)*LA-PARTE(LAX, 8) LA-PARTE(LAX, 9) LA-PARTE(LAX, 10)
*PREPARA PARA OMITIR LOS ESPACIOS AL FINAL DE C/PARTE*PREPARA PARA OMITIR LOS ESPACIOS AL FINAL DE C/PARTE*PREPARA PARA OMITIR LOS ESPACIOS AL FINAL DE C/PARTE*PREPARA PARA OMITIR LOS ESPACIOS AL FINAL DE C/PARTE1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE* ELIMINA LOS REGISTROS DE ALERTAS EXISTENTES EN EL ARCHIVO DE
* ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL* ALERTAS EN LINEA, PREVIO A UN REFRESQUE TOTAL
************************************************************************************************************************************
*    POSICIONA EN EL PRIMER REG DE JURAD*    POSICIONA EN EL PRIMER REG DE JURAD
*NO HAY REGISTROS*NO HAY REGISTROS*    LEE SECUENCIALMENTE Y ELIMINA LOS REGISTROS DE JURAD*    LEE SECUENCIALMENTE Y ELIMINA LOS REGISTROS DE JURAD
*    HASTA EL FIN DEL ARCHIVO*    HASTA EL FIN DEL ARCHIVO
*ES UN ALERTA DE JURAD*ES UN ALERTA DE JURAD
*ERROR EN LA ELIMINACION*ERROR EN LA ELIMINACION"BDIIALE VACIANDO LOS DATOS""BDIIALE VACIANDO LOS DATOS"
*FIN DE ARCHIVO: SALE NORMALMENTE*FIN DE ARCHIVO: SALE NORMALMENTE
*LECTURA ANORMAL: CANCELACION DEL PROGRAMA*LECTURA ANORMAL: CANCELACION DEL PROGRAMA"ONLINE""ONLINE"7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* REGISTRA HORA DE FINALIZACION* REGISTRA HORA DE FINALIZACION* CLOSE TODOS LOS ARCHIVOS* CLOSE TODOS LOS ARCHIVOS* EMISION DE CONTADORES DE REGISTROS* EMISION DE CONTADORES DE REGISTROS* >>>> NOT OK: SUMA PARA J001 Y TAMBIEN J002, HAY QUE CAMBIAR LA* >>>> NOT OK: SUMA PARA J001 Y TAMBIEN J002, HAY QUE CAMBIAR LA
* DEFINICION DE ESTOS CONTADORES* DEFINICION DE ESTOS CONTADORES
*    MOVE N-REG-TIPO-I-OK TO N-EDIT*    MOVE N-REG-TIPO-I-OK TO N-EDIT
*    MOVE N-REG-TIPO-M-OK TO N-EDIT*    MOVE N-REG-TIPO-M-OK TO N-EDIT
*    MOVE N-REG-TIPO-E-OK TO N-EDIT*    MOVE N-REG-TIPO-E-OK TO N-EDIT* EMISION DEL REPORTE DE ERRORES* EMISION DEL REPORTE DE ERRORES9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* PROCEDIMIENTO STANDARD DE CANCELACION DE PROGRAMA BATCH* PROCEDIMIENTO STANDARD DE CANCELACION DE PROGRAMA BATCH
************************************************************************************************************************************
* TODO: HAY UN STANDARD PARA COMUNICAR UNA CANCELACION DE PROCESO?* TODO: HAY UN STANDARD PARA COMUNICAR UNA CANCELACION DE PROCESO?//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.************************************************************************************************************************************
* RUTINA DE CONVENIENCIA PARA PROCESAR UN ERROR DETECTADO EN UN* RUTINA DE CONVENIENCIA PARA PROCESAR UN ERROR DETECTADO EN UN
* REGISTRO DE INPUT* REGISTRO DE INPUT
* CONTABILIZA EL ERROR EN LA TABLA DE ERRORES, ACTIVA EL INDICADOR* CONTABILIZA EL ERROR EN LA TABLA DE ERRORES, ACTIVA EL INDICADOR
* DE REGISTRO CON ERROR, MUESTRA EL MENSAJE EN LA PANTALLA, CUENTA* DE REGISTRO CON ERROR, MUESTRA EL MENSAJE EN LA PANTALLA, CUENTA
* EL REGISTRO ERRONEO* EL REGISTRO ERRONEO
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)* REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)
* POSICION DEL PROXIMO ERROR EN LA LISTA DE ERRORES DEL REG* POSICION DEL PROXIMO ERROR EN LA LISTA DE ERRORES DEL REG
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* CODIGO DEL ERROR DETECTADO* CODIGO DEL ERROR DETECTADO
************************************************************************************************************************************
* REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)* REGISTRO DE INPUT (PRIMEROS 86 CARACTERES)
************************************************************************************************************************************
* TABLA DE ERRORES DE CONSISTENCIA DEL INPUT* TABLA DE ERRORES DE CONSISTENCIA DEL INPUT
*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR*    INDICA SI EL REGISTRO ACTUAL TIENE ERROR
*    ERRORES DEL REGISTRO ACTUAL*    ERRORES DEL REGISTRO ACTUAL
*    CONTADOR DE REGISTROS CON ERROR*    CONTADOR DE REGISTROS CON ERROR
*    TABLA DE ERRORES*    TABLA DE ERRORES************************************************************************************************************************************00.00.
*    MARCA AL REG ACTUAL COMO ERRONEO*    MARCA AL REG ACTUAL COMO ERRONEO*    CUENTA Y MUESTRA EL REGISTRO DE INPUT*    CUENTA Y MUESTRA EL REGISTRO DE INPUTEND-IF<*    CONTABILIZA EL ERROR EN LA TABLA DE ERRORES*    CONTABILIZA EL ERROR EN LA TABLA DE ERRORES*    AGREGA A LA LISTA DE ERRORES DEL REGISTRO*    AGREGA A LA LISTA DE ERRORES DEL REGISTRO************************************************************************************************************************************
************************************************************************************************************************************

~
~
~
~
~
~
~
~
~:qNo write:q!/d/iccol/desarrollo/fuentes>fg
ksh: fg: no such job
/d/iccol/desarrollo/fuentes>who | grep icdgd
icdgd      pts/6        May 19 09:33    (172.16.10.126)
icdgd      pts/33       May 19 11:08    (172.16.10.7)
/d/iccol/desarrollo/fuentes>^[   /d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>fu
/d/iccol/desarrollo/fuentes>echo $PS1
${PWD}>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>echo $PS1fu       who | grep icdgd
icdgd      pts/6        May 19 09:33    (172.16.10.126)
icdgd      pts/33       May 19 11:08    (172.16.10.7)
/d/iccol/desarrollo/fuentes>echo "peeeedro              vo qqq.txt
ksh: vo:  not found
/d/iccol/desarrollo/fuentes>vi qqq.txt
"qqq.txt" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"qqq.txt" [New file]APPEND MODEaaaa áéóíú ññÑÑ 

ÁÉÍÓÚ


test latin1






"qqq.txt" [New file] 4 lines, 36 characters /d/iccol/desarrollo/fuentes>cat qqq.txt
aaaa áéóíú ññÑÑ 
ÁÉÍÓÚ
test latin1

/d/iccol/desarrollo/fuentes>vi qqq.txt
"qqq.txt" 4 lines, 36 characters aaaa áéóíú ññÑÑ
ÁÉÍÓÚ
test latin1

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"qqq.txt" 4 lines, 36 characters:q/d/iccol/desarrollo/fuentes>rm qqq.txt
/d/iccol/desarrollo/fuentes>cd    ech $TEMPORALES
ksh: ech:  not found
/d/iccol/desarrollo/fuentes>echo $TEMPORALES
/d/iccol/desarrollo/temporales
/d/iccol/desarrollo/fuentes>te
/d/iccol/desarrollo/temporales>ls -la 999*
-rw-rw-r--   1 icdgd    icdatacr    1170 May 19 11:17 9999991000905140101_ERRORES.txt
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 11:14 9999991000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    5151 May 19 11:17 9999991000905140101.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 11:17 9999991000905140101.txt.orig
/d/iccol/desarrollo/temporales>vi 9999991000905140101.txt
"9999991000905140101.txt" 28 lines, 2464 characters I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411^M
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406^M
I100000958212LUIS GUILLERMO AVENDAnO RODR0020442013050603302020000406^M
I100001327130GONZALO PATInO MORENO0030062013010604407619984069^M
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406^M
I100002859753ERNESTO RICO0050672013040602206720100435^M
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406^M
I100003044362MANUEL CASTRO MUnETON0070rt2011010605300120130406^M
I100003295380HENRY REY BARBOSA0080452013011123200220110506^M
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806^M
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406^M
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106^M
I200811046741SALUD AXIAL LTDA0440761998406903400219990101^M
I200830067928C I GLOMA S A0110432044040601203220100406^M
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206^M
I200860024151COMPUTEC SA0330332011140604500120110402^M
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411^M
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010^M
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506^M
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106^M
I300600003115xxxxxx0150542014010600400320120406^M
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406^M
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406^M
I400000266423SIMONE MARTINEZ033002201312060070rt20110106^M
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111^M
I400000136711ARIAS NILO RIESCO0110232011041100905720130411^M
I400000163598xxxxxx0330432013101002204520120406^M
T 00000000027772774787861^M
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"9999991000905140101.txt" 28 lines, 2464 characters/n:set noic/nREPLACE 1 CHARÑ/Ñ/Ñ/Address search hit BOTTOM without matching pattern"9999991000905140101.txt" 28 lines, 2464 characters /d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>vi 9999991000905140101.txt 9999991000905140101.txt  d 9999991000905140101.txt 9999991000905140101.txt c 9999991000905140101.txta 9999991000905140101.txtt 9999991000905140101.txt
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
I100002859753ERNESTO RICO                                 0050672013040602206720100435
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
I200830067928C I GLOMA S A                                0110432044040601203220100406
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
I200860024151COMPUTEC SA                                  0330332011140604500120110402
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
I300600003115xxxxxx                                       0150542014010600400320120406
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
I400000163598xxxxxx                                       0330432013101002204520120406
T 00000000027                                             772774        787861        
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>cat 9999991000905140101.txtvi 9999991000905140101.txt ls -la 999*               te         echo $TEMPORALESech $TEMPORALES rm qqq.txt     vi qqq.txtcat qqq.txtvi qqq.txt vo qqq.txtwho | grep icdgdecho $PS1       fu       who | grep icdgdfg              vi CARGAJUR.CBL.diffsdiff -w 156 CARGAJUR.CBL CARGAJUR-GB.CBL > CA>/d/iccol/desarrollo/temporales>man sdiff                                      /d/iccol/desarrollo/temporales>sdiff -w 156 CARGAJUR.CBL CARGAJUR-GB.CBL/d/iccol/desarrollo/temporales>cls                                      /d/iccol/desarrollo/temporales>sdiff -w 156 CARGAJUR.CBL CARGAJUR-GB.CBL/d/iccol/desarrollo/temporales>ls -la CARGAJ*                           /d/iccol/desarrollo/temporales>who | grep icdgdwho             clsifconfig informifconfig primaryifconfig local  ifconfig      ls -la /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/temporales>tail                                         /d/iccol/desarrollo/temporales>sh-CARGAJURtail       more 9999991000905140101.txt.log/d/iccol/desarrollo/temporales>sh-CARGAJUR                     /d/iccol/desarrollo/temporales>fg         echo `date '+%Y%m%d'`fg                   echo `date '+%Y%m%d' | cut -c 1-6`/d/iccol/desarrollo/temporales>fg                                /d/iccol/desarrollo/temporales>echo `who am i | cut -c 39-50`cp 9999991000905140101.txt.orig 99999910009051>/d/iccol/desarrollo/temporales>vi /d/iccol/desarrollo/macros/sh-CARGAJUR      /d/iccol/desarrollo/temporales>which sh-CARGAJUR                        /d/iccol/desarrollo/temporales>sh-CARGAJUR      vi sh-CARGAJURx CARGAJUR 9999991000905140101.txt N/d/iccol/desarrollo/temporales>
Parametros: 9999991000905140101.txt N                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
01 Envio Original - Carga TOTAL 1a vez
Fecha de proceso: 20140101
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
Errores del reg:  14                                                                                                 
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
Errores del reg:  14                                                                                                 
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
Errores del reg:  14                                                                                                 
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Errores del reg:  13                                                                                                 
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Errores del reg:  13                                                                                                 
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Errores del reg:  13                                                                                                 
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
Errores del reg:  07                                                                                                 
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Errores del reg:  13                                                                                                 
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Errores del reg:  09                                                                                                 
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Errores del reg:  09                                                                                                 
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Errores del reg:  09                                                                                                 
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Errores del reg:  09                                                                                                 
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Errores del reg:  09                                                                                                 
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
Errores del reg:  15                                                                                                 
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
Errores del reg:  11                                                                                                 
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
Errores del reg:  14                                                                                                 
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Errores del reg:  15                                                                                                 
 
Totales de registros:
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

real    0m0.05s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/05/19 12:10:30
Fin de Programa:     2014/05/19 12:10:30

/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt N/d/iccol/desarrollo/temporales>cat 9999991000905140101.txt         /d/iccol/desarrollo/temporales>vi 9999991000905140101.txt ls -la 999*               
-rw-rw-r--   1 icdgd    icdatacr    1530 May 19 12:10 9999991000905140101_ERRORES.txt
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 12:09 9999991000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    5151 May 19 11:17 9999991000905140101.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 11:17 9999991000905140101.txt.orig
/d/iccol/desarrollo/temporales>vi 9999991000905140101.txt.orig
"9999991000905140101.txt.orig" 28 lines, 2464 characters I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411^M
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406^M
I100000958212LUIS GUILLERMO AVENDAnO RODR0020442013050603302020000406^M
I100001327130GONZALO PATInO MORENO0030062013010604407619984069^M
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406^M
I100002859753ERNESTO RICO0050672013040602206720100435^M
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406^M
I100003044362MANUEL CASTRO MUnETON0070rt2011010605300120130406^M
I100003295380HENRY REY BARBOSA0080452013011123200220110506^M
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806^M
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406^M
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106^M
I200811046741SALUD AXIAL LTDA0440761998406903400219990101^M
I200830067928C I GLOMA S A0110432044040601203220100406^M
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206^M
I200860024151COMPUTEC SA0330332011140604500120110402^M
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411^M
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010^M
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506^M
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106^M
I300600003115xxxxxx0150542014010600400320120406^M
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406^M
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406^M
I400000266423SIMONE MARTINEZ033002201312060070rt20110106^M
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111^M
I400000136711ARIAS NILO RIESCO0110232011041100905720130411^M
I400000163598xxxxxx0330432013101002204520120406^M
T 00000000027772774787861^M
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"9999991000905140101.txt.orig" 28 lines, 2464 characters/set noicAddress search hit BOTTOM without matching pattern/n/set noicAddress search hit BOTTOM without matching pattern/Address search hit BOTTOM without matching pattern/n:set allnoautoindentnomodelinesshowmodeautoprintnonumbernoslowopennoautowritenonovicetabstop=4nobeautifynooptimizetaglength=0directory=/var/tmpparagraphs=IPLPPPQPP LIpplpipnppplpipbptags=tags /usr/lib/tagsnoedcompatibleprompttagstacknoerrorbellsnoreadonlyterm=vt220noexrcredrawnoterseflashremaptimeouthardtabs=8report=5ttytype=vt220ignorecasescroll=24warnnolispsections=NHSHH HUuhsh+cwindow=49nolistshell=/bin/kshnowrapscanmagicshiftwidth=4wrapmargin=0mesgshowmatchnowriteany[Hit return to continue] I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411^M
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406^M
I100000958212LUIS GUILLERMO AVENDAnO RODR0020442013050603302020000406^M
I100001327130GONZALO PATInO MORENO0030062013010604407619984069^M
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406^M
I100002859753ERNESTO RICO0050672013040602206720100435^M
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406^M
I100003044362MANUEL CASTRO MUnETON0070rt2011010605300120130406^M
I100003295380HENRY REY BARBOSA0080452013011123200220110506^M
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806^M
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406^M
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106^M
I200811046741SALUD AXIAL LTDA0440761998406903400219990101^M
I200830067928C I GLOMA S A0110432044040601203220100406^M
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206^M
I200860024151COMPUTEC SA0330332011140604500120110402^M
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411^M
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010^M
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506^M
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106^M
I300600003115xxxxxx0150542014010600400320120406^M
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406^M
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406^M
I400000266423SIMONE MARTINEZ033002201312060070rt20110106^M
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111^M
I400000136711ARIAS NILO RIESCO0110232011041100905720130411^M
I400000163598xxxxxx0330432013101002204520120406^M
T 00000000027772774787861^M
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:set noic/nREPLACE 1 CHARÑ/Ñ/Ñ"9999991000905140101.txt.orig" 28 lines, 2464 characters /d/iccol/desarrollo/temporales>
/d/iccol/desarrollo/temporales>
shell will timeout in 60 seconds due to inactivity
ksh[2]: timed out waiting for input
